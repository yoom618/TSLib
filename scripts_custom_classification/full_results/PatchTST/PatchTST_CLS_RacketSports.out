Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.0388665199279785
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.149 Vali Acc: 0.566 Test Loss: 1.149 Test Acc: 0.566
Validation loss decreased (inf --> -0.565778).  Saving model ...
Epoch: 2 cost time: 1.744917631149292
Epoch: 2, Steps: 10 | Train Loss: 0.874 Vali Loss: 0.769 Vali Acc: 0.691 Test Loss: 0.769 Test Acc: 0.691
Validation loss decreased (-0.565778 --> -0.690782).  Saving model ...
Epoch: 3 cost time: 1.7874321937561035
Epoch: 3, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
Validation loss decreased (-0.690782 --> -0.782889).  Saving model ...
Epoch: 4 cost time: 1.8220040798187256
Epoch: 4, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 5 cost time: 1.7883257865905762
Epoch: 5, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815785).  Saving model ...
Epoch: 6 cost time: 1.830942153930664
Epoch: 6, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7882194519042969
Epoch: 7, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3322255611419678
Epoch: 8, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.601 Vali Acc: 0.849 Test Loss: 0.601 Test Acc: 0.849
Validation loss decreased (-0.815785 --> -0.848678).  Saving model ...
Epoch: 9 cost time: 1.7613720893859863
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.634 Vali Acc: 0.849 Test Loss: 0.634 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1547720432281494
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.672 Vali Acc: 0.842 Test Loss: 0.672 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.277488946914673
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.695 Vali Acc: 0.836 Test Loss: 0.695 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7334179878234863
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.688 Vali Acc: 0.842 Test Loss: 0.688 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.185194969177246
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.697 Vali Acc: 0.842 Test Loss: 0.697 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.056504726409912
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.842 Test Loss: 0.718 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7448968887329102
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.732 Vali Acc: 0.836 Test Loss: 0.732 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0769050121307373
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.725 Vali Acc: 0.836 Test Loss: 0.725 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8260900974273682
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.836 Test Loss: 0.738 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8193385601043701
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.829 Test Loss: 0.759 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 490116
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.134275674819946
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.290 Vali Acc: 0.362 Test Loss: 1.290 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 1.8698689937591553
Epoch: 2, Steps: 10 | Train Loss: 1.090 Vali Loss: 0.968 Vali Acc: 0.618 Test Loss: 0.968 Test Acc: 0.618
Validation loss decreased (-0.361829 --> -0.618411).  Saving model ...
Epoch: 3 cost time: 2.0969464778900146
Epoch: 3, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.767 Vali Acc: 0.678 Test Loss: 0.767 Test Acc: 0.678
Validation loss decreased (-0.618411 --> -0.677624).  Saving model ...
Epoch: 4 cost time: 1.8967101573944092
Epoch: 4, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.625 Vali Acc: 0.737 Test Loss: 0.625 Test Acc: 0.737
Validation loss decreased (-0.677624 --> -0.736836).  Saving model ...
Epoch: 5 cost time: 1.9606995582580566
Epoch: 5, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 2.2666964530944824
Epoch: 6, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 1.8312947750091553
Epoch: 7, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 8 cost time: 1.8151962757110596
Epoch: 8, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
Validation loss decreased (-0.796047 --> -0.822363).  Saving model ...
Epoch: 9 cost time: 2.180549144744873
Epoch: 9, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.557 Vali Acc: 0.829 Test Loss: 0.557 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 10 cost time: 2.1390092372894287
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.583 Vali Acc: 0.829 Test Loss: 0.583 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9910268783569336
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0293829441070557
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.620 Vali Acc: 0.829 Test Loss: 0.620 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3957619667053223
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.674 Vali Acc: 0.829 Test Loss: 0.674 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7872200012207031
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8710405826568604
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.652 Vali Acc: 0.829 Test Loss: 0.652 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.063228130340576
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.668 Vali Acc: 0.829 Test Loss: 0.668 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9724137783050537
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9484384059906006
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.680 Vali Acc: 0.829 Test Loss: 0.680 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.131974935531616
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.695 Vali Acc: 0.822 Test Loss: 0.695 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 444164
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.227477550506592
Epoch: 1, Steps: 10 | Train Loss: 1.564 Vali Loss: 1.357 Vali Acc: 0.375 Test Loss: 1.357 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.5973241329193115
Epoch: 2, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.071 Vali Acc: 0.605 Test Loss: 1.071 Test Acc: 0.605
Validation loss decreased (-0.374986 --> -0.605252).  Saving model ...
Epoch: 3 cost time: 1.5021097660064697
Epoch: 3, Steps: 10 | Train Loss: 0.901 Vali Loss: 0.844 Vali Acc: 0.618 Test Loss: 0.844 Test Acc: 0.618
Validation loss decreased (-0.605252 --> -0.618413).  Saving model ...
Epoch: 4 cost time: 1.279906988143921
Epoch: 4, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.679 Vali Acc: 0.704 Test Loss: 0.679 Test Acc: 0.704
Validation loss decreased (-0.618413 --> -0.703941).  Saving model ...
Epoch: 5 cost time: 1.0953667163848877
Epoch: 5, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.585 Vali Acc: 0.743 Test Loss: 0.585 Test Acc: 0.743
Validation loss decreased (-0.703941 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 1.1540355682373047
Epoch: 6, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
Validation loss decreased (-0.743415 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 1.6224250793457031
Epoch: 7, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809206).  Saving model ...
Epoch: 8 cost time: 1.4537208080291748
Epoch: 8, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.483 Vali Acc: 0.816 Test Loss: 0.483 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 9 cost time: 1.5228745937347412
Epoch: 9, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6292991638183594
Epoch: 10, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3001492023468018
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4736859798431396
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8640687465667725
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4647178649902344
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.544 Vali Acc: 0.829 Test Loss: 0.544 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828942).  Saving model ...
Epoch: 15 cost time: 1.248786211013794
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.556 Vali Acc: 0.829 Test Loss: 0.556 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6180026531219482
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.601 Vali Acc: 0.816 Test Loss: 0.601 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.291487216949463
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.605 Vali Acc: 0.816 Test Loss: 0.605 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3422496318817139
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4439117908477783
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7858541011810303
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.620 Vali Acc: 0.803 Test Loss: 0.620 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4084994792938232
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.564323902130127
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4113695621490479
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.618 Vali Acc: 0.816 Test Loss: 0.618 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4041728973388672
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 429060
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6346628665924072
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.322 Vali Acc: 0.401 Test Loss: 1.322 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 1.642261266708374
Epoch: 2, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.055 Vali Acc: 0.559 Test Loss: 1.055 Test Acc: 0.559
Validation loss decreased (-0.401303 --> -0.559200).  Saving model ...
Epoch: 3 cost time: 1.7765443325042725
Epoch: 3, Steps: 10 | Train Loss: 0.829 Vali Loss: 0.873 Vali Acc: 0.586 Test Loss: 0.873 Test Acc: 0.586
Validation loss decreased (-0.559200 --> -0.585518).  Saving model ...
Epoch: 4 cost time: 1.7142491340637207
Epoch: 4, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.696 Vali Acc: 0.730 Test Loss: 0.696 Test Acc: 0.730
Validation loss decreased (-0.585518 --> -0.730256).  Saving model ...
Epoch: 5 cost time: 1.5204575061798096
Epoch: 5, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.614 Vali Acc: 0.737 Test Loss: 0.614 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 6 cost time: 1.6109106540679932
Epoch: 6, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
Validation loss decreased (-0.736836 --> -0.789468).  Saving model ...
Epoch: 7 cost time: 1.6617403030395508
Epoch: 7, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.2414677143096924
Epoch: 8, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2049705982208252
Epoch: 9, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2915234565734863
Epoch: 10, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.360973596572876
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.595869541168213
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.628 Vali Acc: 0.809 Test Loss: 0.628 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 13 cost time: 1.2033417224884033
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9860730171203613
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.670 Vali Acc: 0.809 Test Loss: 0.670 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6717760562896729
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.665 Vali Acc: 0.816 Test Loss: 0.665 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 16 cost time: 1.5173680782318115
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.664 Vali Acc: 0.809 Test Loss: 0.664 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.779353380203247
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.696 Vali Acc: 0.803 Test Loss: 0.696 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2985901832580566
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.713 Vali Acc: 0.803 Test Loss: 0.713 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6151299476623535
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.701 Vali Acc: 0.809 Test Loss: 0.701 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3873090744018555
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.705 Vali Acc: 0.816 Test Loss: 0.705 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.979710578918457
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.711 Vali Acc: 0.816 Test Loss: 0.711 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.529282569885254
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.727 Vali Acc: 0.809 Test Loss: 0.727 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.15108323097229
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.730 Vali Acc: 0.816 Test Loss: 0.730 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8995566368103027
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.748 Vali Acc: 0.816 Test Loss: 0.748 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2936503887176514
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.753 Vali Acc: 0.816 Test Loss: 0.753 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 429188
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.854987859725952
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.308 Vali Acc: 0.401 Test Loss: 1.308 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 1.399878978729248
Epoch: 2, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.112 Vali Acc: 0.579 Test Loss: 1.112 Test Acc: 0.579
Validation loss decreased (-0.401303 --> -0.578936).  Saving model ...
Epoch: 3 cost time: 1.5190887451171875
Epoch: 3, Steps: 10 | Train Loss: 0.852 Vali Loss: 0.923 Vali Acc: 0.711 Test Loss: 0.923 Test Acc: 0.711
Validation loss decreased (-0.578936 --> -0.710517).  Saving model ...
Epoch: 4 cost time: 1.4216547012329102
Epoch: 4, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.801 Vali Acc: 0.730 Test Loss: 0.801 Test Acc: 0.730
Validation loss decreased (-0.710517 --> -0.730255).  Saving model ...
Epoch: 5 cost time: 1.5965335369110107
Epoch: 5, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.709 Vali Acc: 0.737 Test Loss: 0.709 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.217463731765747
Epoch: 6, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.655 Vali Acc: 0.743 Test Loss: 0.655 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 7 cost time: 1.2001168727874756
Epoch: 7, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.1489615440368652
Epoch: 8, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.619 Vali Acc: 0.763 Test Loss: 0.619 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.502105951309204
Epoch: 9, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.607 Vali Acc: 0.763 Test Loss: 0.607 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.4197068214416504
Epoch: 10, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.630 Vali Acc: 0.776 Test Loss: 0.630 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776309).  Saving model ...
Epoch: 11 cost time: 1.0373482704162598
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.639 Vali Acc: 0.803 Test Loss: 0.639 Test Acc: 0.803
Validation loss decreased (-0.776309 --> -0.802625).  Saving model ...
Epoch: 12 cost time: 1.5456807613372803
Epoch: 12, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.653 Vali Acc: 0.796 Test Loss: 0.653 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6511335372924805
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.659 Vali Acc: 0.776 Test Loss: 0.659 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5094287395477295
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.685 Vali Acc: 0.776 Test Loss: 0.685 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.529179334640503
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.689 Vali Acc: 0.783 Test Loss: 0.689 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4277849197387695
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.694 Vali Acc: 0.776 Test Loss: 0.694 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.586782693862915
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.707 Vali Acc: 0.789 Test Loss: 0.707 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.078669786453247
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.715 Vali Acc: 0.776 Test Loss: 0.715 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.915346622467041
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.722 Vali Acc: 0.776 Test Loss: 0.722 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.68265962600708
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.738 Vali Acc: 0.776 Test Loss: 0.738 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.586763620376587
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.730 Vali Acc: 0.776 Test Loss: 0.730 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 420228
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.354073762893677
Epoch: 1, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.149 Vali Acc: 0.572 Test Loss: 1.149 Test Acc: 0.572
Validation loss decreased (inf --> -0.572357).  Saving model ...
Epoch: 2 cost time: 1.3570101261138916
Epoch: 2, Steps: 10 | Train Loss: 0.873 Vali Loss: 0.772 Vali Acc: 0.704 Test Loss: 0.772 Test Acc: 0.704
Validation loss decreased (-0.572357 --> -0.703940).  Saving model ...
Epoch: 3 cost time: 1.5948822498321533
Epoch: 3, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
Validation loss decreased (-0.703940 --> -0.736836).  Saving model ...
Epoch: 4 cost time: 1.3985285758972168
Epoch: 4, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.8738429546356201
Epoch: 5, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.298079013824463
Epoch: 6, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
Validation loss decreased (-0.776310 --> -0.809205).  Saving model ...
Epoch: 7 cost time: 1.4208998680114746
Epoch: 7, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.625429391860962
Epoch: 8, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822362).  Saving model ...
Epoch: 9 cost time: 1.632392406463623
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.06152081489563
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.682 Vali Acc: 0.816 Test Loss: 0.682 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8431673049926758
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.691 Vali Acc: 0.829 Test Loss: 0.691 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828940).  Saving model ...
Epoch: 12 cost time: 1.8093135356903076
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.704 Vali Acc: 0.836 Test Loss: 0.704 Test Acc: 0.836
Validation loss decreased (-0.828940 --> -0.835519).  Saving model ...
Epoch: 13 cost time: 1.7583765983581543
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.720 Vali Acc: 0.829 Test Loss: 0.720 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1130290031433105
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.836 Test Loss: 0.724 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7379343509674072
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.829 Test Loss: 0.739 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.207951784133911
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.752 Vali Acc: 0.829 Test Loss: 0.752 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7809462547302246
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.822 Test Loss: 0.786 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9031660556793213
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.836 Test Loss: 0.762 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.709350824356079
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.829 Test Loss: 0.765 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0284876823425293
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.836 Test Loss: 0.773 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9037024974822998
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.829 Test Loss: 0.782 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2774269580841064
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.829 Test Loss: 0.797 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 391428
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.259752035140991
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.265 Vali Acc: 0.447 Test Loss: 1.265 Test Acc: 0.447
Validation loss decreased (inf --> -0.447356).  Saving model ...
Epoch: 2 cost time: 2.0525107383728027
Epoch: 2, Steps: 10 | Train Loss: 1.138 Vali Loss: 0.979 Vali Acc: 0.664 Test Loss: 0.979 Test Acc: 0.664
Validation loss decreased (-0.447356 --> -0.664464).  Saving model ...
Epoch: 3 cost time: 1.9482049942016602
Epoch: 3, Steps: 10 | Train Loss: 0.769 Vali Loss: 0.754 Vali Acc: 0.711 Test Loss: 0.754 Test Acc: 0.711
Validation loss decreased (-0.664464 --> -0.710519).  Saving model ...
Epoch: 4 cost time: 1.6736493110656738
Epoch: 4, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.609 Vali Acc: 0.763 Test Loss: 0.609 Test Acc: 0.763
Validation loss decreased (-0.710519 --> -0.763152).  Saving model ...
Epoch: 5 cost time: 2.1386590003967285
Epoch: 5, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.539 Vali Acc: 0.750 Test Loss: 0.539 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9822971820831299
Epoch: 6, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.521 Vali Acc: 0.757 Test Loss: 0.521 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0281753540039062
Epoch: 7, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
Validation loss decreased (-0.763152 --> -0.796047).  Saving model ...
Epoch: 8 cost time: 1.7813773155212402
Epoch: 8, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 9 cost time: 1.976900339126587
Epoch: 9, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.545 Vali Acc: 0.809 Test Loss: 0.545 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.629237413406372
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6002912521362305
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9041500091552734
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.571 Vali Acc: 0.816 Test Loss: 0.571 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.50681471824646
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 14 cost time: 1.977545976638794
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.624 Vali Acc: 0.829 Test Loss: 0.624 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828941).  Saving model ...
Epoch: 15 cost time: 1.6720843315124512
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7021307945251465
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.637 Vali Acc: 0.829 Test Loss: 0.637 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6620700359344482
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7389678955078125
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6880204677581787
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.684 Vali Acc: 0.829 Test Loss: 0.684 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8616793155670166
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.695 Vali Acc: 0.829 Test Loss: 0.695 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9381370544433594
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.829 Test Loss: 0.704 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8737545013427734
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.816 Test Loss: 0.704 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.659090518951416
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.700 Vali Acc: 0.822 Test Loss: 0.700 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5857391357421875
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.816 Test Loss: 0.705 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 345476
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.249921798706055
Epoch: 1, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.409 Vali Acc: 0.263 Test Loss: 1.409 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.3241283893585205
Epoch: 2, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.102 Vali Acc: 0.572 Test Loss: 1.102 Test Acc: 0.572
Validation loss decreased (-0.263144 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 1.3441014289855957
Epoch: 3, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.858 Vali Acc: 0.678 Test Loss: 0.858 Test Acc: 0.678
Validation loss decreased (-0.572357 --> -0.677623).  Saving model ...
Epoch: 4 cost time: 1.2750940322875977
Epoch: 4, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.724 Vali Acc: 0.684 Test Loss: 0.724 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684203).  Saving model ...
Epoch: 5 cost time: 1.1497483253479004
Epoch: 5, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
Validation loss decreased (-0.684203 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 1.5985960960388184
Epoch: 6, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.461010456085205
Epoch: 7, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796048).  Saving model ...
Epoch: 8 cost time: 1.1621983051300049
Epoch: 8, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 9 cost time: 1.2011513710021973
Epoch: 9, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
Validation loss decreased (-0.802627 --> -0.822364).  Saving model ...
Epoch: 10 cost time: 1.4747402667999268
Epoch: 10, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.471 Vali Acc: 0.829 Test Loss: 0.471 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 11 cost time: 1.2872304916381836
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.495 Vali Acc: 0.829 Test Loss: 0.495 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.321798324584961
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.505 Vali Acc: 0.816 Test Loss: 0.505 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4894614219665527
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.526 Vali Acc: 0.836 Test Loss: 0.526 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835521).  Saving model ...
Epoch: 14 cost time: 1.3350443840026855
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.534 Vali Acc: 0.829 Test Loss: 0.534 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4443585872650146
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.546 Vali Acc: 0.836 Test Loss: 0.546 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4926414489746094
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.562 Vali Acc: 0.829 Test Loss: 0.562 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.511608362197876
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.563 Vali Acc: 0.836 Test Loss: 0.563 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3197202682495117
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6238408088684082
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7011425495147705
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.576 Vali Acc: 0.809 Test Loss: 0.576 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1866743564605713
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.357513189315796
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.608 Vali Acc: 0.829 Test Loss: 0.608 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3150391578674316
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 330372
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.078256130218506
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.369 Vali Acc: 0.342 Test Loss: 1.369 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.483530044555664
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.136 Vali Acc: 0.474 Test Loss: 1.136 Test Acc: 0.474
Validation loss decreased (-0.342092 --> -0.473673).  Saving model ...
Epoch: 3 cost time: 1.2983107566833496
Epoch: 3, Steps: 10 | Train Loss: 0.878 Vali Loss: 0.928 Vali Acc: 0.586 Test Loss: 0.928 Test Acc: 0.586
Validation loss decreased (-0.473673 --> -0.585517).  Saving model ...
Epoch: 4 cost time: 1.454606056213379
Epoch: 4, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.768 Vali Acc: 0.651 Test Loss: 0.768 Test Acc: 0.651
Validation loss decreased (-0.585517 --> -0.651308).  Saving model ...
Epoch: 5 cost time: 1.754054069519043
Epoch: 5, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.672 Vali Acc: 0.737 Test Loss: 0.672 Test Acc: 0.737
Validation loss decreased (-0.651308 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.2886216640472412
Epoch: 6, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.612 Vali Acc: 0.757 Test Loss: 0.612 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.4817259311676025
Epoch: 7, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.570 Vali Acc: 0.763 Test Loss: 0.570 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.5262224674224854
Epoch: 8, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.4464199542999268
Epoch: 9, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.0956621170043945
Epoch: 10, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.541086196899414
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.603 Vali Acc: 0.796 Test Loss: 0.603 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0743179321289062
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.597 Vali Acc: 0.803 Test Loss: 0.597 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 1.5018162727355957
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.603 Vali Acc: 0.796 Test Loss: 0.603 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2993042469024658
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5392212867736816
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.627 Vali Acc: 0.789 Test Loss: 0.627 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.831709384918213
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.634 Vali Acc: 0.816 Test Loss: 0.634 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 17 cost time: 1.654900312423706
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.666 Vali Acc: 0.796 Test Loss: 0.666 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7753362655639648
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.668 Vali Acc: 0.809 Test Loss: 0.668 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7362010478973389
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.669 Vali Acc: 0.809 Test Loss: 0.669 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5152065753936768
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.678 Vali Acc: 0.809 Test Loss: 0.678 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7858631610870361
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.688 Vali Acc: 0.803 Test Loss: 0.688 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7189342975616455
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.701 Vali Acc: 0.803 Test Loss: 0.701 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4594223499298096
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.706 Vali Acc: 0.803 Test Loss: 0.706 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.1205856800079346
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.711 Vali Acc: 0.803 Test Loss: 0.711 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8997936248779297
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.803 Test Loss: 0.716 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.294950246810913
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.715 Vali Acc: 0.803 Test Loss: 0.715 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 330500
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.685657024383545
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.413 Vali Acc: 0.309 Test Loss: 1.413 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 1.4405958652496338
Epoch: 2, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.192 Vali Acc: 0.546 Test Loss: 1.192 Test Acc: 0.546
Validation loss decreased (-0.309196 --> -0.546041).  Saving model ...
Epoch: 3 cost time: 1.342918872833252
Epoch: 3, Steps: 10 | Train Loss: 0.919 Vali Loss: 0.994 Vali Acc: 0.579 Test Loss: 0.994 Test Acc: 0.579
Validation loss decreased (-0.546041 --> -0.578937).  Saving model ...
Epoch: 4 cost time: 1.1238937377929688
Epoch: 4, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.861 Vali Acc: 0.664 Test Loss: 0.861 Test Acc: 0.664
Validation loss decreased (-0.578937 --> -0.664465).  Saving model ...
Epoch: 5 cost time: 1.576535701751709
Epoch: 5, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.758 Vali Acc: 0.684 Test Loss: 0.758 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684203).  Saving model ...
Epoch: 6 cost time: 1.3988096714019775
Epoch: 6, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
Validation loss decreased (-0.684203 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 1.074920415878296
Epoch: 7, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.648 Vali Acc: 0.730 Test Loss: 0.648 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 8 cost time: 1.7203848361968994
Epoch: 8, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 1.3118085861206055
Epoch: 9, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.4469513893127441
Epoch: 10, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.608 Vali Acc: 0.757 Test Loss: 0.608 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.5872890949249268
Epoch: 11, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.1554162502288818
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.616 Vali Acc: 0.770 Test Loss: 0.616 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3218104839324951
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.631 Vali Acc: 0.796 Test Loss: 0.631 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796046).  Saving model ...
Epoch: 14 cost time: 1.557906150817871
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 1.8709275722503662
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.879509449005127
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.676 Vali Acc: 0.796 Test Loss: 0.676 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3428242206573486
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.687 Vali Acc: 0.796 Test Loss: 0.687 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.507359504699707
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.708 Vali Acc: 0.796 Test Loss: 0.708 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4665987491607666
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.719 Vali Acc: 0.796 Test Loss: 0.719 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6555070877075195
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.720 Vali Acc: 0.789 Test Loss: 0.720 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.228043794631958
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.727 Vali Acc: 0.789 Test Loss: 0.727 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.487321376800537
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.740 Vali Acc: 0.789 Test Loss: 0.740 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7484774589538574
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.753 Vali Acc: 0.789 Test Loss: 0.753 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3627614974975586
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.769 Vali Acc: 0.789 Test Loss: 0.769 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 321540
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.413105010986328
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.258 Vali Acc: 0.434 Test Loss: 1.258 Test Acc: 0.434
Validation loss decreased (inf --> -0.434198).  Saving model ...
Epoch: 2 cost time: 1.930553674697876
Epoch: 2, Steps: 10 | Train Loss: 0.918 Vali Loss: 0.796 Vali Acc: 0.678 Test Loss: 0.796 Test Acc: 0.678
Validation loss decreased (-0.434198 --> -0.677624).  Saving model ...
Epoch: 3 cost time: 1.634765625
Epoch: 3, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.647 Vali Acc: 0.763 Test Loss: 0.647 Test Acc: 0.763
Validation loss decreased (-0.677624 --> -0.763151).  Saving model ...
Epoch: 4 cost time: 1.8071401119232178
Epoch: 4, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 5 cost time: 1.6397838592529297
Epoch: 5, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 6 cost time: 1.6946077346801758
Epoch: 6, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.563 Vali Acc: 0.796 Test Loss: 0.563 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 1.6555452346801758
Epoch: 7, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 8 cost time: 1.5497281551361084
Epoch: 8, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.735 Vali Acc: 0.796 Test Loss: 0.735 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.645432949066162
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 10 cost time: 1.63667631149292
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.714 Vali Acc: 0.809 Test Loss: 0.714 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.189878225326538
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.020010471343994
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.700 Vali Acc: 0.842 Test Loss: 0.700 Test Acc: 0.842
Validation loss decreased (-0.822362 --> -0.842098).  Saving model ...
Epoch: 13 cost time: 2.351209878921509
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.809 Test Loss: 0.743 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0166122913360596
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.836 Test Loss: 0.729 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9954280853271484
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.842 Test Loss: 0.727 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0044729709625244
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.752 Vali Acc: 0.836 Test Loss: 0.752 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1058852672576904
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.836 Test Loss: 0.765 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9811978340148926
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.763 Vali Acc: 0.842 Test Loss: 0.763 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6854190826416016
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.842 Test Loss: 0.774 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.771392583847046
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.842 Test Loss: 0.777 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8500349521636963
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.836 Test Loss: 0.785 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.144413948059082
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.836 Test Loss: 0.789 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 342084
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.60344386100769
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.243 Vali Acc: 0.513 Test Loss: 1.243 Test Acc: 0.513
Validation loss decreased (inf --> -0.513145).  Saving model ...
Epoch: 2 cost time: 1.8075282573699951
Epoch: 2, Steps: 10 | Train Loss: 1.115 Vali Loss: 0.966 Vali Acc: 0.592 Test Loss: 0.966 Test Acc: 0.592
Validation loss decreased (-0.513145 --> -0.592096).  Saving model ...
Epoch: 3 cost time: 2.0988543033599854
Epoch: 3, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.721 Vali Acc: 0.724 Test Loss: 0.721 Test Acc: 0.724
Validation loss decreased (-0.592096 --> -0.723677).  Saving model ...
Epoch: 4 cost time: 1.7496519088745117
Epoch: 4, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.613 Vali Acc: 0.711 Test Loss: 0.613 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0776352882385254
Epoch: 5, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.535 Vali Acc: 0.770 Test Loss: 0.535 Test Acc: 0.770
Validation loss decreased (-0.723677 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 1.892956256866455
Epoch: 6, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789469).  Saving model ...
Epoch: 7 cost time: 2.145364284515381
Epoch: 7, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 8 cost time: 2.112426996231079
Epoch: 8, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 9 cost time: 2.137401580810547
Epoch: 9, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.630478620529175
Epoch: 10, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 2.1461009979248047
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.125009536743164
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9941537380218506
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.826488733291626
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.624 Vali Acc: 0.829 Test Loss: 0.624 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828941).  Saving model ...
Epoch: 15 cost time: 2.0002756118774414
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.099688768386841
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.649 Vali Acc: 0.816 Test Loss: 0.649 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.340073585510254
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.829 Test Loss: 0.662 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9931223392486572
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.692 Vali Acc: 0.816 Test Loss: 0.692 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8997397422790527
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.701 Vali Acc: 0.829 Test Loss: 0.701 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9356739521026611
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.693 Vali Acc: 0.836 Test Loss: 0.693 Test Acc: 0.836
Validation loss decreased (-0.828941 --> -0.835519).  Saving model ...
Epoch: 21 cost time: 1.9606993198394775
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.707 Vali Acc: 0.836 Test Loss: 0.707 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9450342655181885
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.738 Vali Acc: 0.822 Test Loss: 0.738 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.901010513305664
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.731 Vali Acc: 0.836 Test Loss: 0.731 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6893854141235352
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.746 Vali Acc: 0.836 Test Loss: 0.746 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0641002655029297
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.739 Vali Acc: 0.842 Test Loss: 0.739 Test Acc: 0.842
Validation loss decreased (-0.835519 --> -0.842098).  Saving model ...
Epoch: 26 cost time: 1.9495015144348145
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.836 Test Loss: 0.738 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7635581493377686
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.762 Vali Acc: 0.842 Test Loss: 0.762 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8806684017181396
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.829 Test Loss: 0.774 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8468151092529297
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.829 Test Loss: 0.780 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.032780170440674
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.770 Vali Acc: 0.836 Test Loss: 0.770 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7766950130462646
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.836 Test Loss: 0.780 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.8436667919158936
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.842 Test Loss: 0.775 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9737563133239746
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.849 Test Loss: 0.778 Test Acc: 0.849
Validation loss decreased (-0.842098 --> -0.848676).  Saving model ...
Epoch: 34 cost time: 1.7755663394927979
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.842 Test Loss: 0.784 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8132328987121582
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.849 Test Loss: 0.789 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8717143535614014
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.849 Test Loss: 0.798 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.892883062362671
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.849 Test Loss: 0.806 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.847764253616333
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.849 Test Loss: 0.812 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.0708870887756348
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.819 Vali Acc: 0.842 Test Loss: 0.819 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.046978712081909
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.836 Test Loss: 0.824 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.353238582611084
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.849 Test Loss: 0.827 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.8183469772338867
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.849 Test Loss: 0.837 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4561724662780762
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.836 Test Loss: 0.845 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 296132
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.368688106536865
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.317 Vali Acc: 0.336 Test Loss: 1.317 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.4393906593322754
Epoch: 2, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.069 Vali Acc: 0.612 Test Loss: 1.069 Test Acc: 0.612
Validation loss decreased (-0.335513 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 1.4869763851165771
Epoch: 3, Steps: 10 | Train Loss: 0.889 Vali Loss: 0.862 Vali Acc: 0.704 Test Loss: 0.862 Test Acc: 0.704
Validation loss decreased (-0.611831 --> -0.703939).  Saving model ...
Epoch: 4 cost time: 1.3171913623809814
Epoch: 4, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.711 Vali Acc: 0.704 Test Loss: 0.711 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 1.3128130435943604
Epoch: 5, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.630 Vali Acc: 0.770 Test Loss: 0.630 Test Acc: 0.770
Validation loss decreased (-0.703940 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 1.6611695289611816
Epoch: 6, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.2304511070251465
Epoch: 7, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.492 Vali Acc: 0.789 Test Loss: 0.492 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 8 cost time: 1.2365624904632568
Epoch: 8, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.464 Vali Acc: 0.816 Test Loss: 0.464 Test Acc: 0.816
Validation loss decreased (-0.789469 --> -0.815785).  Saving model ...
Epoch: 9 cost time: 1.546163558959961
Epoch: 9, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.463 Vali Acc: 0.816 Test Loss: 0.463 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 10 cost time: 1.3155152797698975
Epoch: 10, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.474 Vali Acc: 0.829 Test Loss: 0.474 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 11 cost time: 1.2446620464324951
Epoch: 11, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.482 Vali Acc: 0.816 Test Loss: 0.482 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3288819789886475
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7406089305877686
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5378615856170654
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2493257522583008
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3330638408660889
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.501 Vali Acc: 0.829 Test Loss: 0.501 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6382293701171875
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4719650745391846
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0450255870819092
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2050261497497559
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 281028
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.628736734390259
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.275 Vali Acc: 0.421 Test Loss: 1.275 Test Acc: 0.421
Validation loss decreased (inf --> -0.421040).  Saving model ...
Epoch: 2 cost time: 1.2150413990020752
Epoch: 2, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.421040 --> -0.532884).  Saving model ...
Epoch: 3 cost time: 1.5592074394226074
Epoch: 3, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.852 Vali Acc: 0.678 Test Loss: 0.852 Test Acc: 0.678
Validation loss decreased (-0.532884 --> -0.677623).  Saving model ...
Epoch: 4 cost time: 1.3734395503997803
Epoch: 4, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.736 Vali Acc: 0.684 Test Loss: 0.736 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684203).  Saving model ...
Epoch: 5 cost time: 1.3256745338439941
Epoch: 5, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
Validation loss decreased (-0.684203 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.6920127868652344
Epoch: 6, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 7 cost time: 1.3469915390014648
Epoch: 7, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.2418086528778076
Epoch: 8, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.328650712966919
Epoch: 9, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.2695677280426025
Epoch: 10, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.428443193435669
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.2938120365142822
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.3084394931793213
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.422959327697754
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 15 cost time: 1.5904221534729004
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.626 Vali Acc: 0.822 Test Loss: 0.626 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5792970657348633
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.666 Vali Acc: 0.816 Test Loss: 0.666 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.510739803314209
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.652 Vali Acc: 0.803 Test Loss: 0.652 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3913166522979736
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3054776191711426
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.665 Vali Acc: 0.816 Test Loss: 0.665 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2665677070617676
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.682 Vali Acc: 0.829 Test Loss: 0.682 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828941).  Saving model ...
Epoch: 21 cost time: 1.2681572437286377
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.689 Vali Acc: 0.816 Test Loss: 0.689 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0871353149414062
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.690 Vali Acc: 0.809 Test Loss: 0.690 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1907026767730713
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.699 Vali Acc: 0.803 Test Loss: 0.699 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1720898151397705
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.712 Vali Acc: 0.803 Test Loss: 0.712 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.363982915878296
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.803 Test Loss: 0.717 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1378886699676514
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.721 Vali Acc: 0.809 Test Loss: 0.721 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.235978603363037
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.722 Vali Acc: 0.809 Test Loss: 0.722 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.561323642730713
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.723 Vali Acc: 0.816 Test Loss: 0.723 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2949402332305908
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.822 Test Loss: 0.729 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.351402997970581
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.737 Vali Acc: 0.816 Test Loss: 0.737 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 281156
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.793971538543701
Epoch: 1, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.422 Vali Acc: 0.329 Test Loss: 1.422 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 1.684401512145996
Epoch: 2, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.221 Vali Acc: 0.474 Test Loss: 1.221 Test Acc: 0.474
Validation loss decreased (-0.328933 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 1.5089902877807617
Epoch: 3, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.040 Vali Acc: 0.566 Test Loss: 1.040 Test Acc: 0.566
Validation loss decreased (-0.473672 --> -0.565779).  Saving model ...
Epoch: 4 cost time: 1.3685452938079834
Epoch: 4, Steps: 10 | Train Loss: 0.752 Vali Loss: 0.893 Vali Acc: 0.651 Test Loss: 0.893 Test Acc: 0.651
Validation loss decreased (-0.565779 --> -0.651307).  Saving model ...
Epoch: 5 cost time: 1.4735825061798096
Epoch: 5, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.803 Vali Acc: 0.671 Test Loss: 0.803 Test Acc: 0.671
Validation loss decreased (-0.651307 --> -0.671045).  Saving model ...
Epoch: 6 cost time: 1.6095607280731201
Epoch: 6, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.728 Vali Acc: 0.691 Test Loss: 0.728 Test Acc: 0.691
Validation loss decreased (-0.671045 --> -0.690782).  Saving model ...
Epoch: 7 cost time: 1.771749496459961
Epoch: 7, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.672 Vali Acc: 0.711 Test Loss: 0.672 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710520).  Saving model ...
Epoch: 8 cost time: 1.7227861881256104
Epoch: 8, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.643 Vali Acc: 0.724 Test Loss: 0.643 Test Acc: 0.724
Validation loss decreased (-0.710520 --> -0.723678).  Saving model ...
Epoch: 9 cost time: 1.4727933406829834
Epoch: 9, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.628 Vali Acc: 0.724 Test Loss: 0.628 Test Acc: 0.724
Validation loss decreased (-0.723678 --> -0.723678).  Saving model ...
Epoch: 10 cost time: 1.4656834602355957
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.610 Vali Acc: 0.737 Test Loss: 0.610 Test Acc: 0.737
Validation loss decreased (-0.723678 --> -0.736836).  Saving model ...
Epoch: 11 cost time: 1.2792842388153076
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.3823137283325195
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.629 Vali Acc: 0.783 Test Loss: 0.629 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782888).  Saving model ...
Epoch: 13 cost time: 1.456324577331543
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.638 Vali Acc: 0.783 Test Loss: 0.638 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6483638286590576
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.662 Vali Acc: 0.763 Test Loss: 0.662 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5808312892913818
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.685 Vali Acc: 0.770 Test Loss: 0.685 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8692965507507324
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.684 Vali Acc: 0.796 Test Loss: 0.684 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 17 cost time: 1.643157720565796
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.684 Vali Acc: 0.789 Test Loss: 0.684 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5808842182159424
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.690 Vali Acc: 0.796 Test Loss: 0.690 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.602867603302002
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.708 Vali Acc: 0.789 Test Loss: 0.708 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5682296752929688
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.712 Vali Acc: 0.803 Test Loss: 0.712 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 21 cost time: 1.5197606086730957
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.717 Vali Acc: 0.803 Test Loss: 0.717 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.695587158203125
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.725 Vali Acc: 0.796 Test Loss: 0.725 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3712913990020752
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6596498489379883
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.754 Vali Acc: 0.789 Test Loss: 0.754 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3859624862670898
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.761 Vali Acc: 0.789 Test Loss: 0.761 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7012295722961426
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.772 Vali Acc: 0.789 Test Loss: 0.772 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.348395824432373
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.782 Vali Acc: 0.789 Test Loss: 0.782 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7560157775878906
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.784 Vali Acc: 0.789 Test Loss: 0.784 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7775685787200928
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.780 Vali Acc: 0.776 Test Loss: 0.780 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5575807094573975
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.789 Vali Acc: 0.776 Test Loss: 0.789 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 272196
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.68807315826416
Epoch: 1, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.283 Vali Acc: 0.401 Test Loss: 1.283 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 2.1745753288269043
Epoch: 2, Steps: 10 | Train Loss: 1.111 Vali Loss: 0.974 Vali Acc: 0.678 Test Loss: 0.974 Test Acc: 0.678
Validation loss decreased (-0.401303 --> -0.677622).  Saving model ...
Epoch: 3 cost time: 2.208101272583008
Epoch: 3, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.734 Vali Acc: 0.724 Test Loss: 0.734 Test Acc: 0.724
Validation loss decreased (-0.677622 --> -0.723677).  Saving model ...
Epoch: 4 cost time: 2.0898096561431885
Epoch: 4, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
Validation loss decreased (-0.723677 --> -0.776310).  Saving model ...
Epoch: 5 cost time: 1.826711654663086
Epoch: 5, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796048).  Saving model ...
Epoch: 6 cost time: 2.024864673614502
Epoch: 6, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
Validation loss decreased (-0.796048 --> -0.822364).  Saving model ...
Epoch: 7 cost time: 1.927704095840454
Epoch: 7, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.012744188308716
Epoch: 8, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.512 Vali Acc: 0.829 Test Loss: 0.512 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 9 cost time: 1.7738852500915527
Epoch: 9, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8293495178222656
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3622186183929443
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.548 Vali Acc: 0.836 Test Loss: 0.548 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 12 cost time: 2.0460362434387207
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.550 Vali Acc: 0.836 Test Loss: 0.550 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2241766452789307
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.238448143005371
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.559 Vali Acc: 0.849 Test Loss: 0.559 Test Acc: 0.849
Validation loss decreased (-0.835521 --> -0.848679).  Saving model ...
Epoch: 15 cost time: 2.1434946060180664
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.600 Vali Acc: 0.836 Test Loss: 0.600 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.953000783920288
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.643 Vali Acc: 0.829 Test Loss: 0.643 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0664632320404053
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.622 Vali Acc: 0.836 Test Loss: 0.622 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.011533498764038
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.622 Vali Acc: 0.829 Test Loss: 0.622 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0523886680603027
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.822 Test Loss: 0.655 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.987919569015503
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.647 Vali Acc: 0.836 Test Loss: 0.647 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.270570755004883
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.664 Vali Acc: 0.836 Test Loss: 0.664 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0270750522613525
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.679 Vali Acc: 0.836 Test Loss: 0.679 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9787280559539795
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.667 Vali Acc: 0.836 Test Loss: 0.667 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2119479179382324
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.849 Test Loss: 0.665 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 196292
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.775721549987793
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.356 Vali Acc: 0.270 Test Loss: 1.356 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.0865812301635742
Epoch: 2, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.142 Vali Acc: 0.520 Test Loss: 1.142 Test Acc: 0.520
Validation loss decreased (-0.269723 --> -0.519725).  Saving model ...
Epoch: 3 cost time: 1.343843698501587
Epoch: 3, Steps: 10 | Train Loss: 0.970 Vali Loss: 0.950 Vali Acc: 0.651 Test Loss: 0.950 Test Acc: 0.651
Validation loss decreased (-0.519725 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 1.2865862846374512
Epoch: 4, Steps: 10 | Train Loss: 0.749 Vali Loss: 0.777 Vali Acc: 0.711 Test Loss: 0.777 Test Acc: 0.711
Validation loss decreased (-0.651306 --> -0.710519).  Saving model ...
Epoch: 5 cost time: 1.5610597133636475
Epoch: 5, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.652 Vali Acc: 0.763 Test Loss: 0.652 Test Acc: 0.763
Validation loss decreased (-0.710519 --> -0.763151).  Saving model ...
Epoch: 6 cost time: 1.2933785915374756
Epoch: 6, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
Validation loss decreased (-0.763151 --> -0.789468).  Saving model ...
Epoch: 7 cost time: 1.5112035274505615
Epoch: 7, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 8 cost time: 1.5188212394714355
Epoch: 8, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822364).  Saving model ...
Epoch: 9 cost time: 1.4432871341705322
Epoch: 9, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.489 Vali Acc: 0.809 Test Loss: 0.489 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6488299369812012
Epoch: 10, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.485 Vali Acc: 0.816 Test Loss: 0.485 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5477321147918701
Epoch: 11, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3633670806884766
Epoch: 12, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.484 Vali Acc: 0.829 Test Loss: 0.484 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 13 cost time: 1.2077229022979736
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.485 Vali Acc: 0.829 Test Loss: 0.485 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.460360050201416
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.504 Vali Acc: 0.829 Test Loss: 0.504 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5528945922851562
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.519 Vali Acc: 0.829 Test Loss: 0.519 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.51041579246521
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.509 Vali Acc: 0.836 Test Loss: 0.509 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835521).  Saving model ...
Epoch: 17 cost time: 1.5587213039398193
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.511 Vali Acc: 0.842 Test Loss: 0.511 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 18 cost time: 1.4793856143951416
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5774831771850586
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.536 Vali Acc: 0.842 Test Loss: 0.536 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.408858299255371
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.554 Vali Acc: 0.836 Test Loss: 0.554 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6567187309265137
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6665689945220947
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.573 Vali Acc: 0.829 Test Loss: 0.573 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6447656154632568
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.574 Vali Acc: 0.836 Test Loss: 0.574 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3307974338531494
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.586 Vali Acc: 0.829 Test Loss: 0.586 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.445758581161499
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7316803932189941
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6990022659301758
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 173316
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.712740421295166
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.413 Vali Acc: 0.349 Test Loss: 1.413 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.600600004196167
Epoch: 2, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.225 Vali Acc: 0.526 Test Loss: 1.225 Test Acc: 0.526
Validation loss decreased (-0.348670 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 1.4397552013397217
Epoch: 3, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.041 Vali Acc: 0.586 Test Loss: 1.041 Test Acc: 0.586
Validation loss decreased (-0.526304 --> -0.585516).  Saving model ...
Epoch: 4 cost time: 1.5402629375457764
Epoch: 4, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.862 Vali Acc: 0.671 Test Loss: 0.862 Test Acc: 0.671
Validation loss decreased (-0.585516 --> -0.671044).  Saving model ...
Epoch: 5 cost time: 1.5345594882965088
Epoch: 5, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.761 Vali Acc: 0.704 Test Loss: 0.761 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703940).  Saving model ...
Epoch: 6 cost time: 1.4967100620269775
Epoch: 6, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.665 Vali Acc: 0.717 Test Loss: 0.665 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717099).  Saving model ...
Epoch: 7 cost time: 1.4052064418792725
Epoch: 7, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.587 Vali Acc: 0.750 Test Loss: 0.587 Test Acc: 0.750
Validation loss decreased (-0.717099 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.5650787353515625
Epoch: 8, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.552 Vali Acc: 0.763 Test Loss: 0.552 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.506152629852295
Epoch: 9, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.534 Vali Acc: 0.783 Test Loss: 0.534 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 1.7212233543395996
Epoch: 10, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 11 cost time: 1.5464372634887695
Epoch: 11, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.5727496147155762
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 13 cost time: 1.3624145984649658
Epoch: 13, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 14 cost time: 1.4098589420318604
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
Validation loss decreased (-0.796048 --> -0.822363).  Saving model ...
Epoch: 15 cost time: 1.3715918064117432
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.520 Vali Acc: 0.829 Test Loss: 0.520 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 16 cost time: 1.5091900825500488
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.503 Vali Acc: 0.816 Test Loss: 0.503 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4021077156066895
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4819233417510986
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6329820156097412
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.612281084060669
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.557 Vali Acc: 0.836 Test Loss: 0.557 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 21 cost time: 1.3744208812713623
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5408549308776855
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.570 Vali Acc: 0.829 Test Loss: 0.570 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.974259376525879
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.596 Vali Acc: 0.836 Test Loss: 0.596 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3943428993225098
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4232234954833984
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5581116676330566
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.599 Vali Acc: 0.836 Test Loss: 0.599 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5858802795410156
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.608 Vali Acc: 0.836 Test Loss: 0.608 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3007855415344238
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.618 Vali Acc: 0.836 Test Loss: 0.618 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4771664142608643
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.621 Vali Acc: 0.836 Test Loss: 0.621 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2785687446594238
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.642 Vali Acc: 0.836 Test Loss: 0.642 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 165764
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.3276519775390625
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.457 Vali Acc: 0.355 Test Loss: 1.457 Test Acc: 0.355
Validation loss decreased (inf --> -0.355249).  Saving model ...
Epoch: 2 cost time: 1.5066628456115723
Epoch: 2, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.253 Vali Acc: 0.493 Test Loss: 1.253 Test Acc: 0.493
Validation loss decreased (-0.355249 --> -0.493409).  Saving model ...
Epoch: 3 cost time: 1.4647743701934814
Epoch: 3, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.051 Vali Acc: 0.566 Test Loss: 1.051 Test Acc: 0.566
Validation loss decreased (-0.493409 --> -0.565779).  Saving model ...
Epoch: 4 cost time: 1.2730424404144287
Epoch: 4, Steps: 10 | Train Loss: 0.876 Vali Loss: 0.901 Vali Acc: 0.645 Test Loss: 0.901 Test Acc: 0.645
Validation loss decreased (-0.565779 --> -0.644728).  Saving model ...
Epoch: 5 cost time: 1.7737994194030762
Epoch: 5, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.793 Vali Acc: 0.704 Test Loss: 0.793 Test Acc: 0.704
Validation loss decreased (-0.644728 --> -0.703939).  Saving model ...
Epoch: 6 cost time: 1.4437224864959717
Epoch: 6, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.709 Vali Acc: 0.743 Test Loss: 0.709 Test Acc: 0.743
Validation loss decreased (-0.703939 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 1.3469679355621338
Epoch: 7, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.4282896518707275
Epoch: 8, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.602 Vali Acc: 0.743 Test Loss: 0.602 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.423088788986206
Epoch: 9, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.295731782913208
Epoch: 10, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.543304443359375
Epoch: 11, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.2920067310333252
Epoch: 12, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.545832633972168
Epoch: 13, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.2554690837860107
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3162152767181396
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.536 Vali Acc: 0.809 Test Loss: 0.536 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.4365663528442383
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3739044666290283
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4273200035095215
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4389560222625732
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 20 cost time: 1.3223280906677246
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.581 Vali Acc: 0.803 Test Loss: 0.581 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2685880661010742
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.284071445465088
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4622588157653809
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.599 Vali Acc: 0.796 Test Loss: 0.599 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1995713710784912
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.605 Vali Acc: 0.796 Test Loss: 0.605 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4473235607147217
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1430635452270508
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.611 Vali Acc: 0.816 Test Loss: 0.611 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4526984691619873
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5385360717773438
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.632 Vali Acc: 0.803 Test Loss: 0.632 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3479928970336914
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 165828
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.002539396286011
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.377 Vali Acc: 0.349 Test Loss: 1.377 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.3720831871032715
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.259 Vali Acc: 0.441 Test Loss: 1.259 Test Acc: 0.441
Validation loss decreased (-0.348670 --> -0.440777).  Saving model ...
Epoch: 3 cost time: 1.6289379596710205
Epoch: 3, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.131 Vali Acc: 0.520 Test Loss: 1.131 Test Acc: 0.520
Validation loss decreased (-0.440777 --> -0.519726).  Saving model ...
Epoch: 4 cost time: 1.4629871845245361
Epoch: 4, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.027 Vali Acc: 0.559 Test Loss: 1.027 Test Acc: 0.559
Validation loss decreased (-0.519726 --> -0.559200).  Saving model ...
Epoch: 5 cost time: 1.334951639175415
Epoch: 5, Steps: 10 | Train Loss: 0.816 Vali Loss: 0.937 Vali Acc: 0.605 Test Loss: 0.937 Test Acc: 0.605
Validation loss decreased (-0.559200 --> -0.605254).  Saving model ...
Epoch: 6 cost time: 1.4369914531707764
Epoch: 6, Steps: 10 | Train Loss: 0.691 Vali Loss: 0.844 Vali Acc: 0.645 Test Loss: 0.844 Test Acc: 0.645
Validation loss decreased (-0.605254 --> -0.644728).  Saving model ...
Epoch: 7 cost time: 1.379059076309204
Epoch: 7, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.777 Vali Acc: 0.691 Test Loss: 0.777 Test Acc: 0.691
Validation loss decreased (-0.644728 --> -0.690782).  Saving model ...
Epoch: 8 cost time: 1.277571439743042
Epoch: 8, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.709 Vali Acc: 0.711 Test Loss: 0.709 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 9 cost time: 1.567211627960205
Epoch: 9, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.662 Vali Acc: 0.737 Test Loss: 0.662 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736835).  Saving model ...
Epoch: 10 cost time: 1.338679552078247
Epoch: 10, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 11 cost time: 1.207653284072876
Epoch: 11, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.603 Vali Acc: 0.743 Test Loss: 0.603 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.3858535289764404
Epoch: 12, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.583 Vali Acc: 0.763 Test Loss: 0.583 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.5898706912994385
Epoch: 13, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.584 Vali Acc: 0.763 Test Loss: 0.584 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5393433570861816
Epoch: 14, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.2815442085266113
Epoch: 15, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.567 Vali Acc: 0.770 Test Loss: 0.567 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 1.2650094032287598
Epoch: 16, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.575 Vali Acc: 0.757 Test Loss: 0.575 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4600462913513184
Epoch: 17, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.3404016494750977
Epoch: 18, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.4719669818878174
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.293351411819458
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 1.3904731273651123
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.594 Vali Acc: 0.789 Test Loss: 0.594 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3360285758972168
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 23 cost time: 1.4364030361175537
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6558151245117188
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.514082431793213
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6521680355072021
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.606 Vali Acc: 0.816 Test Loss: 0.606 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 27 cost time: 1.5432076454162598
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.603 Vali Acc: 0.816 Test Loss: 0.603 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 28 cost time: 1.5407321453094482
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.502274990081787
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.626 Vali Acc: 0.803 Test Loss: 0.626 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5145845413208008
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4513237476348877
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8133718967437744
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.642 Vali Acc: 0.809 Test Loss: 0.642 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.966167688369751
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.646 Vali Acc: 0.796 Test Loss: 0.646 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4827487468719482
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.6113615036010742
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.8137500286102295
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.674 Vali Acc: 0.796 Test Loss: 0.674 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2202200889587402
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.672 Vali Acc: 0.789 Test Loss: 0.672 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 161348
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.440855264663696
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.293 Vali Acc: 0.421 Test Loss: 1.293 Test Acc: 0.421
Validation loss decreased (inf --> -0.421040).  Saving model ...
Epoch: 2 cost time: 1.7954869270324707
Epoch: 2, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.002 Vali Acc: 0.638 Test Loss: 1.002 Test Acc: 0.638
Validation loss decreased (-0.421040 --> -0.638148).  Saving model ...
Epoch: 3 cost time: 1.8697609901428223
Epoch: 3, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.782 Vali Acc: 0.671 Test Loss: 0.782 Test Acc: 0.671
Validation loss decreased (-0.638148 --> -0.671045).  Saving model ...
Epoch: 4 cost time: 2.711362361907959
Epoch: 4, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.635 Vali Acc: 0.730 Test Loss: 0.635 Test Acc: 0.730
Validation loss decreased (-0.671045 --> -0.730257).  Saving model ...
Epoch: 5 cost time: 2.0128090381622314
Epoch: 5, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
Validation loss decreased (-0.730257 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 2.3295366764068604
Epoch: 6, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
Validation loss decreased (-0.776310 --> -0.809205).  Saving model ...
Epoch: 7 cost time: 2.433875799179077
Epoch: 7, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.505 Vali Acc: 0.829 Test Loss: 0.505 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828942).  Saving model ...
Epoch: 8 cost time: 2.3618199825286865
Epoch: 8, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.160533905029297
Epoch: 9, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.062248468399048
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.563 Vali Acc: 0.829 Test Loss: 0.563 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7084033489227295
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8369886875152588
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.592 Vali Acc: 0.816 Test Loss: 0.592 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6993348598480225
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9571192264556885
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9257817268371582
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.614 Vali Acc: 0.829 Test Loss: 0.614 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9364378452301025
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6852035522460938
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 146756
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.156993389129639
Epoch: 1, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.352 Vali Acc: 0.388 Test Loss: 1.352 Test Acc: 0.388
Validation loss decreased (inf --> -0.388144).  Saving model ...
Epoch: 2 cost time: 1.3131015300750732
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.170 Vali Acc: 0.566 Test Loss: 1.170 Test Acc: 0.566
Validation loss decreased (-0.388144 --> -0.565778).  Saving model ...
Epoch: 3 cost time: 1.391629695892334
Epoch: 3, Steps: 10 | Train Loss: 1.049 Vali Loss: 0.975 Vali Acc: 0.638 Test Loss: 0.975 Test Acc: 0.638
Validation loss decreased (-0.565778 --> -0.638148).  Saving model ...
Epoch: 4 cost time: 1.8320276737213135
Epoch: 4, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.816 Vali Acc: 0.711 Test Loss: 0.816 Test Acc: 0.711
Validation loss decreased (-0.638148 --> -0.710518).  Saving model ...
Epoch: 5 cost time: 1.2516119480133057
Epoch: 5, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.700 Vali Acc: 0.697 Test Loss: 0.700 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5931334495544434
Epoch: 6, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.609 Vali Acc: 0.750 Test Loss: 0.609 Test Acc: 0.750
Validation loss decreased (-0.710518 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.2023258209228516
Epoch: 7, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.1450788974761963
Epoch: 8, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.410233736038208
Epoch: 9, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.342736005783081
Epoch: 10, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.532 Vali Acc: 0.770 Test Loss: 0.532 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.803961992263794
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.5877807140350342
Epoch: 12, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.506 Vali Acc: 0.816 Test Loss: 0.506 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.7141673564910889
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4370050430297852
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2982423305511475
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.529 Vali Acc: 0.829 Test Loss: 0.529 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828942).  Saving model ...
Epoch: 16 cost time: 1.4247076511383057
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2490637302398682
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5709903240203857
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.624321460723877
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5797312259674072
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4787659645080566
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.571 Vali Acc: 0.829 Test Loss: 0.571 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4131569862365723
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.598 Vali Acc: 0.829 Test Loss: 0.598 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5177569389343262
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5274193286895752
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3330776691436768
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 123780
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.576524972915649
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.377 Vali Acc: 0.250 Test Loss: 1.377 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.4124770164489746
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
Validation loss decreased (-0.249986 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 1.3765218257904053
Epoch: 3, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.026 Vali Acc: 0.605 Test Loss: 1.026 Test Acc: 0.605
Validation loss decreased (-0.467093 --> -0.605253).  Saving model ...
Epoch: 4 cost time: 1.5920634269714355
Epoch: 4, Steps: 10 | Train Loss: 0.875 Vali Loss: 0.865 Vali Acc: 0.678 Test Loss: 0.865 Test Acc: 0.678
Validation loss decreased (-0.605253 --> -0.677623).  Saving model ...
Epoch: 5 cost time: 1.4382681846618652
Epoch: 5, Steps: 10 | Train Loss: 0.711 Vali Loss: 0.751 Vali Acc: 0.724 Test Loss: 0.751 Test Acc: 0.724
Validation loss decreased (-0.677623 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.291740894317627
Epoch: 6, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.333099603652954
Epoch: 7, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.594 Vali Acc: 0.743 Test Loss: 0.594 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2229914665222168
Epoch: 8, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
Validation loss decreased (-0.749993 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.401759147644043
Epoch: 9, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8467183113098145
Epoch: 10, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5965299606323242
Epoch: 11, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3297944068908691
Epoch: 12, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809206).  Saving model ...
Epoch: 13 cost time: 1.4664709568023682
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4011890888214111
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.480 Vali Acc: 0.816 Test Loss: 0.480 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 15 cost time: 1.3415157794952393
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.483 Vali Acc: 0.822 Test Loss: 0.483 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 16 cost time: 1.161146640777588
Epoch: 16, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4555530548095703
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 18 cost time: 1.5444025993347168
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.510 Vali Acc: 0.829 Test Loss: 0.510 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 19 cost time: 1.919327735900879
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.528 Vali Acc: 0.829 Test Loss: 0.528 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6241044998168945
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.532 Vali Acc: 0.836 Test Loss: 0.532 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 21 cost time: 1.2895116806030273
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4460008144378662
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.544708013534546
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3023619651794434
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3744301795959473
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7779560089111328
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4840431213378906
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3167734146118164
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5304419994354248
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.603 Vali Acc: 0.816 Test Loss: 0.603 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6247220039367676
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.609 Vali Acc: 0.829 Test Loss: 0.609 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 116228
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.159672737121582
Epoch: 1, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.337 Vali Acc: 0.349 Test Loss: 1.337 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.0453920364379883
Epoch: 2, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.188 Vali Acc: 0.513 Test Loss: 1.188 Test Acc: 0.513
Validation loss decreased (-0.348671 --> -0.513146).  Saving model ...
Epoch: 3 cost time: 1.5623600482940674
Epoch: 3, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.051 Vali Acc: 0.618 Test Loss: 1.051 Test Acc: 0.618
Validation loss decreased (-0.513146 --> -0.618411).  Saving model ...
Epoch: 4 cost time: 1.6473617553710938
Epoch: 4, Steps: 10 | Train Loss: 0.898 Vali Loss: 0.914 Vali Acc: 0.671 Test Loss: 0.914 Test Acc: 0.671
Validation loss decreased (-0.618411 --> -0.671043).  Saving model ...
Epoch: 5 cost time: 1.4455268383026123
Epoch: 5, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.794 Vali Acc: 0.730 Test Loss: 0.794 Test Acc: 0.730
Validation loss decreased (-0.671043 --> -0.730255).  Saving model ...
Epoch: 6 cost time: 1.3144967555999756
Epoch: 6, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.722 Vali Acc: 0.743 Test Loss: 0.722 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 1.696523904800415
Epoch: 7, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.653 Vali Acc: 0.796 Test Loss: 0.653 Test Acc: 0.796
Validation loss decreased (-0.743414 --> -0.796046).  Saving model ...
Epoch: 8 cost time: 1.8343307971954346
Epoch: 8, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.607 Vali Acc: 0.789 Test Loss: 0.607 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1742053031921387
Epoch: 9, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.587 Vali Acc: 0.796 Test Loss: 0.587 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.6391446590423584
Epoch: 10, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.698436975479126
Epoch: 11, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.693819284439087
Epoch: 12, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 1.9195976257324219
Epoch: 13, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.4358959197998047
Epoch: 14, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.560 Vali Acc: 0.829 Test Loss: 0.560 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828942).  Saving model ...
Epoch: 15 cost time: 1.299311637878418
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5788540840148926
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3629238605499268
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.514662504196167
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.493584394454956
Epoch: 19, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5601255893707275
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5719656944274902
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4392192363739014
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3591599464416504
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.631 Vali Acc: 0.829 Test Loss: 0.631 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.400874137878418
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.638 Vali Acc: 0.822 Test Loss: 0.638 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 116292
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.366647720336914
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.358 Vali Acc: 0.342 Test Loss: 1.358 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.2819428443908691
Epoch: 2, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.238 Vali Acc: 0.454 Test Loss: 1.238 Test Acc: 0.454
Validation loss decreased (-0.342092 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 1.1277990341186523
Epoch: 3, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.106 Vali Acc: 0.592 Test Loss: 1.106 Test Acc: 0.592
Validation loss decreased (-0.453935 --> -0.592094).  Saving model ...
Epoch: 4 cost time: 1.2148058414459229
Epoch: 4, Steps: 10 | Train Loss: 0.957 Vali Loss: 0.998 Vali Acc: 0.638 Test Loss: 0.998 Test Acc: 0.638
Validation loss decreased (-0.592094 --> -0.638148).  Saving model ...
Epoch: 5 cost time: 1.407172441482544
Epoch: 5, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.906 Vali Acc: 0.671 Test Loss: 0.906 Test Acc: 0.671
Validation loss decreased (-0.638148 --> -0.671044).  Saving model ...
Epoch: 6 cost time: 1.2743728160858154
Epoch: 6, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.830 Vali Acc: 0.691 Test Loss: 0.830 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690781).  Saving model ...
Epoch: 7 cost time: 1.3135278224945068
Epoch: 7, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.777 Vali Acc: 0.717 Test Loss: 0.777 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717097).  Saving model ...
Epoch: 8 cost time: 1.2962753772735596
Epoch: 8, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.734 Vali Acc: 0.711 Test Loss: 0.734 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4447498321533203
Epoch: 9, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.696 Vali Acc: 0.730 Test Loss: 0.696 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 1.4831256866455078
Epoch: 10, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5421898365020752
Epoch: 11, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.644 Vali Acc: 0.724 Test Loss: 0.644 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3357572555541992
Epoch: 12, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.634 Vali Acc: 0.737 Test Loss: 0.634 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 1.4054219722747803
Epoch: 13, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.628 Vali Acc: 0.763 Test Loss: 0.628 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 1.7191238403320312
Epoch: 14, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.616 Vali Acc: 0.750 Test Loss: 0.616 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.515326976776123
Epoch: 15, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.624 Vali Acc: 0.770 Test Loss: 0.624 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 1.3814671039581299
Epoch: 16, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.632 Vali Acc: 0.763 Test Loss: 0.632 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3851063251495361
Epoch: 17, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.633 Vali Acc: 0.743 Test Loss: 0.633 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3026349544525146
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.634 Vali Acc: 0.770 Test Loss: 0.634 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5908308029174805
Epoch: 19, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.634 Vali Acc: 0.776 Test Loss: 0.634 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 20 cost time: 1.1906445026397705
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.636 Vali Acc: 0.776 Test Loss: 0.636 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.633983850479126
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.641 Vali Acc: 0.763 Test Loss: 0.641 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6398606300354004
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.651 Vali Acc: 0.770 Test Loss: 0.651 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3052978515625
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.667 Vali Acc: 0.770 Test Loss: 0.667 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4389801025390625
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.679 Vali Acc: 0.783 Test Loss: 0.679 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 25 cost time: 1.3730745315551758
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.693 Vali Acc: 0.776 Test Loss: 0.693 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7757983207702637
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.888305902481079
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 28 cost time: 1.2612059116363525
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.712 Vali Acc: 0.796 Test Loss: 0.712 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 29 cost time: 1.3008618354797363
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.720 Vali Acc: 0.789 Test Loss: 0.720 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.715428352355957
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.720 Vali Acc: 0.796 Test Loss: 0.720 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5569977760314941
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.714 Vali Acc: 0.796 Test Loss: 0.714 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.598728895187378
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 33 cost time: 1.3287899494171143
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.725 Vali Acc: 0.803 Test Loss: 0.725 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.701228380203247
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.731 Vali Acc: 0.803 Test Loss: 0.731 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.345644235610962
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.746 Vali Acc: 0.803 Test Loss: 0.746 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4739935398101807
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.759 Vali Acc: 0.796 Test Loss: 0.759 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4044713973999023
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.757 Vali Acc: 0.803 Test Loss: 0.757 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.4117059707641602
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.763 Vali Acc: 0.803 Test Loss: 0.763 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3200633525848389
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.778 Vali Acc: 0.803 Test Loss: 0.778 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.330491304397583
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.796 Vali Acc: 0.796 Test Loss: 0.796 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4707388877868652
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.810 Vali Acc: 0.796 Test Loss: 0.810 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2358813285827637
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.801 Vali Acc: 0.796 Test Loss: 0.801 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 111812
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.632563352584839
Epoch: 1, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.245 Vali Acc: 0.461 Test Loss: 1.245 Test Acc: 0.461
Validation loss decreased (inf --> -0.460514).  Saving model ...
Epoch: 2 cost time: 1.5170600414276123
Epoch: 2, Steps: 10 | Train Loss: 1.035 Vali Loss: 0.969 Vali Acc: 0.658 Test Loss: 0.969 Test Acc: 0.658
Validation loss decreased (-0.460514 --> -0.657885).  Saving model ...
Epoch: 3 cost time: 1.4246418476104736
Epoch: 3, Steps: 10 | Train Loss: 0.759 Vali Loss: 0.756 Vali Acc: 0.658 Test Loss: 0.756 Test Acc: 0.658
Validation loss decreased (-0.657885 --> -0.657887).  Saving model ...
Epoch: 4 cost time: 1.3171765804290771
Epoch: 4, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.606 Vali Acc: 0.757 Test Loss: 0.606 Test Acc: 0.757
Validation loss decreased (-0.657887 --> -0.756573).  Saving model ...
Epoch: 5 cost time: 1.4148545265197754
Epoch: 5, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.3888633251190186
Epoch: 6, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802627).  Saving model ...
Epoch: 7 cost time: 1.9142866134643555
Epoch: 7, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 8 cost time: 1.596658706665039
Epoch: 8, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.500 Vali Acc: 0.822 Test Loss: 0.500 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 9 cost time: 1.4015259742736816
Epoch: 9, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 10 cost time: 1.6797151565551758
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.543 Vali Acc: 0.829 Test Loss: 0.543 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6926066875457764
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.554 Vali Acc: 0.829 Test Loss: 0.554 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6043009757995605
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.561 Vali Acc: 0.829 Test Loss: 0.561 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6394050121307373
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.600 Vali Acc: 0.842 Test Loss: 0.600 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842099).  Saving model ...
Epoch: 14 cost time: 1.5994791984558105
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.583 Vali Acc: 0.836 Test Loss: 0.583 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7813103199005127
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.614 Vali Acc: 0.822 Test Loss: 0.614 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7243187427520752
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.615 Vali Acc: 0.836 Test Loss: 0.615 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.557528018951416
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.618 Vali Acc: 0.836 Test Loss: 0.618 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7030229568481445
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.836 Test Loss: 0.636 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8451387882232666
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.643 Vali Acc: 0.836 Test Loss: 0.643 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6060380935668945
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.836 Test Loss: 0.661 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5830299854278564
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.656 Vali Acc: 0.836 Test Loss: 0.656 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4760382175445557
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.660 Vali Acc: 0.842 Test Loss: 0.660 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.243321418762207
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.693 Vali Acc: 0.829 Test Loss: 0.693 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 121988
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.319484710693359
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.359 Vali Acc: 0.349 Test Loss: 1.359 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.4362585544586182
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.194 Vali Acc: 0.467 Test Loss: 1.194 Test Acc: 0.467
Validation loss decreased (-0.348671 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 1.3223927021026611
Epoch: 3, Steps: 10 | Train Loss: 1.029 Vali Loss: 0.995 Vali Acc: 0.612 Test Loss: 0.995 Test Acc: 0.612
Validation loss decreased (-0.467093 --> -0.611832).  Saving model ...
Epoch: 4 cost time: 1.0475614070892334
Epoch: 4, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.832 Vali Acc: 0.678 Test Loss: 0.832 Test Acc: 0.678
Validation loss decreased (-0.611832 --> -0.677623).  Saving model ...
Epoch: 5 cost time: 1.2289912700653076
Epoch: 5, Steps: 10 | Train Loss: 0.602 Vali Loss: 0.725 Vali Acc: 0.711 Test Loss: 0.725 Test Acc: 0.711
Validation loss decreased (-0.677623 --> -0.710519).  Saving model ...
Epoch: 6 cost time: 1.2144801616668701
Epoch: 6, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.635 Vali Acc: 0.730 Test Loss: 0.635 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730257).  Saving model ...
Epoch: 7 cost time: 1.9099576473236084
Epoch: 7, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
Validation loss decreased (-0.730257 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.502645492553711
Epoch: 8, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.2491209506988525
Epoch: 9, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 10 cost time: 1.8047378063201904
Epoch: 10, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4263534545898438
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4823088645935059
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 13 cost time: 1.427774429321289
Epoch: 13, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3636949062347412
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.4537711143493652
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.3649206161499023
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.545 Vali Acc: 0.816 Test Loss: 0.545 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 17 cost time: 1.497551441192627
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4551591873168945
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5820419788360596
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4391052722930908
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.594 Vali Acc: 0.829 Test Loss: 0.594 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828941).  Saving model ...
Epoch: 21 cost time: 1.6748101711273193
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4956471920013428
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.600 Vali Acc: 0.816 Test Loss: 0.600 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2980518341064453
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1343090534210205
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7228918075561523
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.621 Vali Acc: 0.822 Test Loss: 0.621 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6686303615570068
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.623713493347168
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.273266077041626
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.642 Vali Acc: 0.829 Test Loss: 0.642 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1633830070495605
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.829 Test Loss: 0.649 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6407592296600342
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.664 Vali Acc: 0.829 Test Loss: 0.664 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 99012
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6963253021240234
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.426 Vali Acc: 0.263 Test Loss: 1.426 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.2234587669372559
Epoch: 2, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.289 Vali Acc: 0.428 Test Loss: 1.289 Test Acc: 0.428
Validation loss decreased (-0.263144 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 1.518570899963379
Epoch: 3, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.124 Vali Acc: 0.572 Test Loss: 1.124 Test Acc: 0.572
Validation loss decreased (-0.427619 --> -0.572357).  Saving model ...
Epoch: 4 cost time: 1.2373011112213135
Epoch: 4, Steps: 10 | Train Loss: 0.923 Vali Loss: 0.977 Vali Acc: 0.592 Test Loss: 0.977 Test Acc: 0.592
Validation loss decreased (-0.572357 --> -0.592095).  Saving model ...
Epoch: 5 cost time: 1.5643482208251953
Epoch: 5, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.845 Vali Acc: 0.658 Test Loss: 0.845 Test Acc: 0.658
Validation loss decreased (-0.592095 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.273571491241455
Epoch: 6, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.751 Vali Acc: 0.697 Test Loss: 0.751 Test Acc: 0.697
Validation loss decreased (-0.657886 --> -0.697361).  Saving model ...
Epoch: 7 cost time: 1.2523350715637207
Epoch: 7, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.676 Vali Acc: 0.724 Test Loss: 0.676 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.1312153339385986
Epoch: 8, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
Validation loss decreased (-0.723677 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.5055370330810547
Epoch: 9, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.5318951606750488
Epoch: 10, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.3619990348815918
Epoch: 11, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.5255639553070068
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.555 Vali Acc: 0.796 Test Loss: 0.555 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3620340824127197
Epoch: 13, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.3261876106262207
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3103463649749756
Epoch: 15, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 16 cost time: 1.2168769836425781
Epoch: 16, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6622793674468994
Epoch: 17, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3375749588012695
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 19 cost time: 1.188866376876831
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.545 Vali Acc: 0.816 Test Loss: 0.545 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0758793354034424
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3712260723114014
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2283282279968262
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3312909603118896
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2555201053619385
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.586 Vali Acc: 0.809 Test Loss: 0.586 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2023658752441406
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9985702037811279
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.610 Vali Acc: 0.822 Test Loss: 0.610 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.170863389968872
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.230433702468872
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 91460
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5876851081848145
Epoch: 1, Steps: 10 | Train Loss: 1.591 Vali Loss: 1.397 Vali Acc: 0.289 Test Loss: 1.397 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.2282564640045166
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.244 Vali Acc: 0.461 Test Loss: 1.244 Test Acc: 0.461
Validation loss decreased (-0.289460 --> -0.460514).  Saving model ...
Epoch: 3 cost time: 1.272871732711792
Epoch: 3, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.071 Vali Acc: 0.553 Test Loss: 1.071 Test Acc: 0.553
Validation loss decreased (-0.460514 --> -0.552621).  Saving model ...
Epoch: 4 cost time: 1.2098734378814697
Epoch: 4, Steps: 10 | Train Loss: 0.896 Vali Loss: 0.929 Vali Acc: 0.612 Test Loss: 0.929 Test Acc: 0.612
Validation loss decreased (-0.552621 --> -0.611833).  Saving model ...
Epoch: 5 cost time: 1.3681187629699707
Epoch: 5, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.809 Vali Acc: 0.664 Test Loss: 0.809 Test Acc: 0.664
Validation loss decreased (-0.611833 --> -0.664466).  Saving model ...
Epoch: 6 cost time: 1.2898292541503906
Epoch: 6, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.721 Vali Acc: 0.717 Test Loss: 0.721 Test Acc: 0.717
Validation loss decreased (-0.664466 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 1.2760446071624756
Epoch: 7, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.659 Vali Acc: 0.776 Test Loss: 0.659 Test Acc: 0.776
Validation loss decreased (-0.717098 --> -0.776309).  Saving model ...
Epoch: 8 cost time: 1.1090731620788574
Epoch: 8, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.4324290752410889
Epoch: 9, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.138164758682251
Epoch: 10, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.4410345554351807
Epoch: 11, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.3313190937042236
Epoch: 12, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.3849928379058838
Epoch: 13, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5003283023834229
Epoch: 14, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.535 Vali Acc: 0.816 Test Loss: 0.535 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5022423267364502
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5295741558074951
Epoch: 16, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.220362901687622
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2607553005218506
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3355109691619873
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4716484546661377
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4843077659606934
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7268149852752686
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.597 Vali Acc: 0.803 Test Loss: 0.597 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 91524
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.142012119293213
Epoch: 1, Steps: 10 | Train Loss: 1.578 Vali Loss: 1.405 Vali Acc: 0.270 Test Loss: 1.405 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.289348840713501
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.295 Vali Acc: 0.375 Test Loss: 1.295 Test Acc: 0.375
Validation loss decreased (-0.269723 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.607142448425293
Epoch: 3, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.180 Vali Acc: 0.474 Test Loss: 1.180 Test Acc: 0.474
Validation loss decreased (-0.374987 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 1.486917495727539
Epoch: 4, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.062 Vali Acc: 0.559 Test Loss: 1.062 Test Acc: 0.559
Validation loss decreased (-0.473672 --> -0.559200).  Saving model ...
Epoch: 5 cost time: 1.2917656898498535
Epoch: 5, Steps: 10 | Train Loss: 0.893 Vali Loss: 0.961 Vali Acc: 0.599 Test Loss: 0.961 Test Acc: 0.599
Validation loss decreased (-0.559200 --> -0.598675).  Saving model ...
Epoch: 6 cost time: 1.1586694717407227
Epoch: 6, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.877 Vali Acc: 0.625 Test Loss: 0.877 Test Acc: 0.625
Validation loss decreased (-0.598675 --> -0.624991).  Saving model ...
Epoch: 7 cost time: 1.2780115604400635
Epoch: 7, Steps: 10 | Train Loss: 0.603 Vali Loss: 0.797 Vali Acc: 0.664 Test Loss: 0.797 Test Acc: 0.664
Validation loss decreased (-0.624991 --> -0.664466).  Saving model ...
Epoch: 8 cost time: 1.3823628425598145
Epoch: 8, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.736 Vali Acc: 0.704 Test Loss: 0.736 Test Acc: 0.704
Validation loss decreased (-0.664466 --> -0.703940).  Saving model ...
Epoch: 9 cost time: 1.5753159523010254
Epoch: 9, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.692 Vali Acc: 0.697 Test Loss: 0.692 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5467438697814941
Epoch: 10, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717099).  Saving model ...
Epoch: 11 cost time: 1.260366678237915
Epoch: 11, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.632 Vali Acc: 0.730 Test Loss: 0.632 Test Acc: 0.730
Validation loss decreased (-0.717099 --> -0.730257).  Saving model ...
Epoch: 12 cost time: 1.4287595748901367
Epoch: 12, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.620 Vali Acc: 0.743 Test Loss: 0.620 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 13 cost time: 1.3191485404968262
Epoch: 13, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.617 Vali Acc: 0.737 Test Loss: 0.617 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9769220352172852
Epoch: 14, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.616 Vali Acc: 0.743 Test Loss: 0.616 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 1.3762214183807373
Epoch: 15, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.605 Vali Acc: 0.763 Test Loss: 0.605 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.4659557342529297
Epoch: 16, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.603 Vali Acc: 0.770 Test Loss: 0.603 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 17 cost time: 1.5460546016693115
Epoch: 17, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.769731 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.0634775161743164
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.598 Vali Acc: 0.770 Test Loss: 0.598 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3906054496765137
Epoch: 19, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.604 Vali Acc: 0.770 Test Loss: 0.604 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.173814058303833
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.616 Vali Acc: 0.789 Test Loss: 0.616 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.260101079940796
Epoch: 21, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.617 Vali Acc: 0.776 Test Loss: 0.617 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2798092365264893
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3194432258605957
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.622 Vali Acc: 0.796 Test Loss: 0.622 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2678115367889404
Epoch: 24, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1501414775848389
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.354990005493164
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.654 Vali Acc: 0.789 Test Loss: 0.654 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7261574268341064
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.662 Vali Acc: 0.789 Test Loss: 0.662 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 87044
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.766411542892456
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.427 Vali Acc: 0.283 Test Loss: 1.427 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 1.1947412490844727
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.226 Vali Acc: 0.513 Test Loss: 1.226 Test Acc: 0.513
Validation loss decreased (-0.282880 --> -0.513146).  Saving model ...
Epoch: 3 cost time: 1.2565734386444092
Epoch: 3, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.036 Vali Acc: 0.612 Test Loss: 1.036 Test Acc: 0.612
Validation loss decreased (-0.513146 --> -0.611832).  Saving model ...
Epoch: 4 cost time: 1.250176191329956
Epoch: 4, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.855 Vali Acc: 0.664 Test Loss: 0.855 Test Acc: 0.664
Validation loss decreased (-0.611832 --> -0.664465).  Saving model ...
Epoch: 5 cost time: 1.4396066665649414
Epoch: 5, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.713 Vali Acc: 0.724 Test Loss: 0.713 Test Acc: 0.724
Validation loss decreased (-0.664465 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.1484870910644531
Epoch: 6, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.645 Vali Acc: 0.711 Test Loss: 0.645 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4920976161956787
Epoch: 7, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.565 Vali Acc: 0.757 Test Loss: 0.565 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.175856590270996
Epoch: 8, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
Validation loss decreased (-0.756573 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.3195216655731201
Epoch: 9, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802627).  Saving model ...
Epoch: 10 cost time: 1.2617337703704834
Epoch: 10, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 11 cost time: 1.5324928760528564
Epoch: 11, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3816697597503662
Epoch: 12, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3320422172546387
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.188976526260376
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.368473768234253
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.539 Vali Acc: 0.816 Test Loss: 0.539 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 16 cost time: 1.105527400970459
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1562747955322266
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.534 Vali Acc: 0.816 Test Loss: 0.534 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 18 cost time: 1.0790414810180664
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 19 cost time: 1.297649621963501
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0146028995513916
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4171605110168457
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.589 Vali Acc: 0.816 Test Loss: 0.589 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3287270069122314
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6563124656677246
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4391117095947266
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4986579418182373
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.606 Vali Acc: 0.816 Test Loss: 0.606 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4143154621124268
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2674686908721924
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.600 Vali Acc: 0.816 Test Loss: 0.600 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.175497055053711
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 86244
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.756053924560547
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.393 Vali Acc: 0.289 Test Loss: 1.393 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.3164255619049072
Epoch: 2, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.299 Vali Acc: 0.375 Test Loss: 1.299 Test Acc: 0.375
Validation loss decreased (-0.289460 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.4829132556915283
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.169 Vali Acc: 0.507 Test Loss: 1.169 Test Acc: 0.507
Validation loss decreased (-0.374987 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.3272392749786377
Epoch: 4, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.037 Vali Acc: 0.559 Test Loss: 1.037 Test Acc: 0.559
Validation loss decreased (-0.506567 --> -0.559200).  Saving model ...
Epoch: 5 cost time: 1.5643799304962158
Epoch: 5, Steps: 10 | Train Loss: 0.928 Vali Loss: 0.932 Vali Acc: 0.658 Test Loss: 0.932 Test Acc: 0.658
Validation loss decreased (-0.559200 --> -0.657885).  Saving model ...
Epoch: 6 cost time: 1.4546043872833252
Epoch: 6, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.831 Vali Acc: 0.671 Test Loss: 0.831 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671044).  Saving model ...
Epoch: 7 cost time: 1.2988760471343994
Epoch: 7, Steps: 10 | Train Loss: 0.588 Vali Loss: 0.739 Vali Acc: 0.704 Test Loss: 0.739 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703940).  Saving model ...
Epoch: 8 cost time: 1.277355670928955
Epoch: 8, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.662 Vali Acc: 0.730 Test Loss: 0.662 Test Acc: 0.730
Validation loss decreased (-0.703940 --> -0.730257).  Saving model ...
Epoch: 9 cost time: 1.2918765544891357
Epoch: 9, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.617 Vali Acc: 0.757 Test Loss: 0.617 Test Acc: 0.757
Validation loss decreased (-0.730257 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.1590001583099365
Epoch: 10, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.578 Vali Acc: 0.776 Test Loss: 0.578 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.4675889015197754
Epoch: 11, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.312917709350586
Epoch: 12, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.3584239482879639
Epoch: 13, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 14 cost time: 1.3441731929779053
Epoch: 14, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 15 cost time: 1.273789882659912
Epoch: 15, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 16 cost time: 1.3873825073242188
Epoch: 16, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4229927062988281
Epoch: 17, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.164921760559082
Epoch: 18, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5223760604858398
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.241938829421997
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2360107898712158
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3338541984558105
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3087477684020996
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 24 cost time: 1.3491506576538086
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5184829235076904
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3808684349060059
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2813472747802734
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.586 Vali Acc: 0.803 Test Loss: 0.586 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.403855323791504
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.597 Vali Acc: 0.803 Test Loss: 0.597 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.374373435974121
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4355199337005615
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 31 cost time: 1.4071924686431885
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.617 Vali Acc: 0.809 Test Loss: 0.617 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5269508361816406
Epoch: 32, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 33 cost time: 1.3024158477783203
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 34 cost time: 1.3529410362243652
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.290358304977417
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.618 Vali Acc: 0.816 Test Loss: 0.618 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3613128662109375
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.626 Vali Acc: 0.816 Test Loss: 0.626 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.224581241607666
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.628 Vali Acc: 0.809 Test Loss: 0.628 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2931077480316162
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.641 Vali Acc: 0.809 Test Loss: 0.641 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2167136669158936
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.659 Vali Acc: 0.809 Test Loss: 0.659 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.3191022872924805
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.672 Vali Acc: 0.803 Test Loss: 0.672 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2765817642211914
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.682 Vali Acc: 0.809 Test Loss: 0.682 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.3435461521148682
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.684 Vali Acc: 0.809 Test Loss: 0.684 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3326680660247803
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.679 Vali Acc: 0.816 Test Loss: 0.679 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 74756
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.719456672668457
Epoch: 1, Steps: 10 | Train Loss: 1.518 Vali Loss: 1.461 Vali Acc: 0.211 Test Loss: 1.461 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 1.6545436382293701
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.364 Vali Acc: 0.322 Test Loss: 1.364 Test Acc: 0.322
Validation loss decreased (-0.210512 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.485403060913086
Epoch: 3, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.245 Vali Acc: 0.467 Test Loss: 1.245 Test Acc: 0.467
Validation loss decreased (-0.322355 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 1.0166611671447754
Epoch: 4, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.129 Vali Acc: 0.546 Test Loss: 1.129 Test Acc: 0.546
Validation loss decreased (-0.467093 --> -0.546041).  Saving model ...
Epoch: 5 cost time: 1.3680963516235352
Epoch: 5, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.016 Vali Acc: 0.618 Test Loss: 1.016 Test Acc: 0.618
Validation loss decreased (-0.546041 --> -0.618411).  Saving model ...
Epoch: 6 cost time: 1.339341402053833
Epoch: 6, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.918 Vali Acc: 0.664 Test Loss: 0.918 Test Acc: 0.664
Validation loss decreased (-0.618411 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 1.1376214027404785
Epoch: 7, Steps: 10 | Train Loss: 0.735 Vali Loss: 0.828 Vali Acc: 0.704 Test Loss: 0.828 Test Acc: 0.704
Validation loss decreased (-0.664465 --> -0.703939).  Saving model ...
Epoch: 8 cost time: 1.104640245437622
Epoch: 8, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.750 Vali Acc: 0.711 Test Loss: 0.750 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710519).  Saving model ...
Epoch: 9 cost time: 1.034672498703003
Epoch: 9, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.689 Vali Acc: 0.730 Test Loss: 0.689 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 1.2818818092346191
Epoch: 10, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.640 Vali Acc: 0.730 Test Loss: 0.640 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 11 cost time: 1.2743875980377197
Epoch: 11, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 1.4969244003295898
Epoch: 12, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.569 Vali Acc: 0.750 Test Loss: 0.569 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.3056936264038086
Epoch: 13, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.551 Vali Acc: 0.757 Test Loss: 0.551 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.1540861129760742
Epoch: 14, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.1931560039520264
Epoch: 15, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 16 cost time: 1.3416314125061035
Epoch: 16, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.2059853076934814
Epoch: 17, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1917335987091064
Epoch: 18, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 1.2504241466522217
Epoch: 19, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0592210292816162
Epoch: 20, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
Validation loss decreased (-0.789469 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.2717056274414062
Epoch: 21, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1777658462524414
Epoch: 22, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.388751745223999
Epoch: 23, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2544240951538086
Epoch: 24, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2998826503753662
Epoch: 25, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.300086498260498
Epoch: 26, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4219017028808594
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3311216831207275
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4773833751678467
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2502989768981934
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 70980
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.0438456535339355
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.480 Vali Acc: 0.158 Test Loss: 1.480 Test Acc: 0.158
Validation loss decreased (inf --> -0.157880).  Saving model ...
Epoch: 2 cost time: 1.6769678592681885
Epoch: 2, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
Validation loss decreased (-0.157880 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.2033884525299072
Epoch: 3, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.281 Vali Acc: 0.382 Test Loss: 1.281 Test Acc: 0.382
Validation loss decreased (-0.269723 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 1.5217251777648926
Epoch: 4, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.155 Vali Acc: 0.487 Test Loss: 1.155 Test Acc: 0.487
Validation loss decreased (-0.381566 --> -0.486831).  Saving model ...
Epoch: 5 cost time: 1.3030052185058594
Epoch: 5, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.037 Vali Acc: 0.592 Test Loss: 1.037 Test Acc: 0.592
Validation loss decreased (-0.486831 --> -0.592095).  Saving model ...
Epoch: 6 cost time: 1.450737476348877
Epoch: 6, Steps: 10 | Train Loss: 0.833 Vali Loss: 0.928 Vali Acc: 0.658 Test Loss: 0.928 Test Acc: 0.658
Validation loss decreased (-0.592095 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 1.4329376220703125
Epoch: 7, Steps: 10 | Train Loss: 0.720 Vali Loss: 0.842 Vali Acc: 0.691 Test Loss: 0.842 Test Acc: 0.691
Validation loss decreased (-0.657885 --> -0.690781).  Saving model ...
Epoch: 8 cost time: 1.2072455883026123
Epoch: 8, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.757 Vali Acc: 0.743 Test Loss: 0.757 Test Acc: 0.743
Validation loss decreased (-0.690781 --> -0.743413).  Saving model ...
Epoch: 9 cost time: 1.0987904071807861
Epoch: 9, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.693 Vali Acc: 0.763 Test Loss: 0.693 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763151).  Saving model ...
Epoch: 10 cost time: 1.1611378192901611
Epoch: 10, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.644 Vali Acc: 0.757 Test Loss: 0.644 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2560057640075684
Epoch: 11, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.604 Vali Acc: 0.763 Test Loss: 0.604 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.3337430953979492
Epoch: 12, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.1450777053833008
Epoch: 13, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.1773324012756348
Epoch: 14, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 15 cost time: 1.5948503017425537
Epoch: 15, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.1722993850708008
Epoch: 16, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.331803321838379
Epoch: 17, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6022145748138428
Epoch: 18, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 19 cost time: 1.1496920585632324
Epoch: 19, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 20 cost time: 1.2467873096466064
Epoch: 20, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.476 Vali Acc: 0.803 Test Loss: 0.476 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 21 cost time: 1.4725959300994873
Epoch: 21, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.479 Vali Acc: 0.789 Test Loss: 0.479 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3287293910980225
Epoch: 22, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.482 Vali Acc: 0.796 Test Loss: 0.482 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7745141983032227
Epoch: 23, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 24 cost time: 1.356874942779541
Epoch: 24, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3477132320404053
Epoch: 25, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3437132835388184
Epoch: 26, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4170091152191162
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4320604801177979
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2269089221954346
Epoch: 29, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1777684688568115
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 31 cost time: 1.2120847702026367
Epoch: 31, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2645714282989502
Epoch: 32, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.525 Vali Acc: 0.816 Test Loss: 0.525 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5119521617889404
Epoch: 33, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.525 Vali Acc: 0.816 Test Loss: 0.525 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4469776153564453
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2571425437927246
Epoch: 35, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.545 Vali Acc: 0.816 Test Loss: 0.545 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.273902177810669
Epoch: 36, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4555554389953613
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3707332611083984
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.357717514038086
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3747920989990234
Epoch: 40, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 71012
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.530013084411621
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.415 Vali Acc: 0.250 Test Loss: 1.415 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.4808845520019531
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.342 Vali Acc: 0.355 Test Loss: 1.342 Test Acc: 0.355
Validation loss decreased (-0.249986 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.225640058517456
Epoch: 3, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.258 Vali Acc: 0.428 Test Loss: 1.258 Test Acc: 0.428
Validation loss decreased (-0.355250 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 1.316788911819458
Epoch: 4, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.174 Vali Acc: 0.520 Test Loss: 1.174 Test Acc: 0.520
Validation loss decreased (-0.427619 --> -0.519725).  Saving model ...
Epoch: 5 cost time: 1.4230546951293945
Epoch: 5, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.093 Vali Acc: 0.526 Test Loss: 1.093 Test Acc: 0.526
Validation loss decreased (-0.519725 --> -0.526305).  Saving model ...
Epoch: 6 cost time: 1.4986193180084229
Epoch: 6, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.007 Vali Acc: 0.586 Test Loss: 1.007 Test Acc: 0.586
Validation loss decreased (-0.526305 --> -0.585516).  Saving model ...
Epoch: 7 cost time: 1.790308952331543
Epoch: 7, Steps: 10 | Train Loss: 0.810 Vali Loss: 0.929 Vali Acc: 0.625 Test Loss: 0.929 Test Acc: 0.625
Validation loss decreased (-0.585516 --> -0.624991).  Saving model ...
Epoch: 8 cost time: 1.6763248443603516
Epoch: 8, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.856 Vali Acc: 0.658 Test Loss: 0.856 Test Acc: 0.658
Validation loss decreased (-0.624991 --> -0.657886).  Saving model ...
Epoch: 9 cost time: 1.7044734954833984
Epoch: 9, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.796 Vali Acc: 0.678 Test Loss: 0.796 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677624).  Saving model ...
Epoch: 10 cost time: 1.800274133682251
Epoch: 10, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.743 Vali Acc: 0.717 Test Loss: 0.743 Test Acc: 0.717
Validation loss decreased (-0.677624 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.7464613914489746
Epoch: 11, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.702 Vali Acc: 0.730 Test Loss: 0.702 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 12 cost time: 1.6157639026641846
Epoch: 12, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.672 Vali Acc: 0.737 Test Loss: 0.672 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 13 cost time: 1.5834846496582031
Epoch: 13, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.646 Vali Acc: 0.730 Test Loss: 0.646 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4557275772094727
Epoch: 14, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.624 Vali Acc: 0.743 Test Loss: 0.624 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 1.595775842666626
Epoch: 15, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 1.1770575046539307
Epoch: 16, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.594 Vali Acc: 0.743 Test Loss: 0.594 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.229626178741455
Epoch: 17, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.591 Vali Acc: 0.743 Test Loss: 0.591 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5284278392791748
Epoch: 18, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.583 Vali Acc: 0.750 Test Loss: 0.583 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 19 cost time: 1.266944408416748
Epoch: 19, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 20 cost time: 1.529111623764038
Epoch: 20, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.569 Vali Acc: 0.750 Test Loss: 0.569 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5376932621002197
Epoch: 21, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.608442783355713
Epoch: 22, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 23 cost time: 1.4584856033325195
Epoch: 23, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.422394037246704
Epoch: 24, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.578 Vali Acc: 0.770 Test Loss: 0.578 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4249746799468994
Epoch: 25, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 1.7023260593414307
Epoch: 26, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4917333126068115
Epoch: 27, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5310211181640625
Epoch: 28, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7626211643218994
Epoch: 29, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.567 Vali Acc: 0.770 Test Loss: 0.567 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7297801971435547
Epoch: 30, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 31 cost time: 1.38679838180542
Epoch: 31, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6360118389129639
Epoch: 32, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 33 cost time: 1.3502333164215088
Epoch: 33, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 34 cost time: 1.7339606285095215
Epoch: 34, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6577205657958984
Epoch: 35, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3222501277923584
Epoch: 36, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.590 Vali Acc: 0.803 Test Loss: 0.590 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3104023933410645
Epoch: 37, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6050026416778564
Epoch: 38, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4588665962219238
Epoch: 39, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.7990233898162842
Epoch: 40, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.610 Vali Acc: 0.809 Test Loss: 0.610 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.6860013008117676
Epoch: 41, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.6566851139068604
Epoch: 42, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.626 Vali Acc: 0.803 Test Loss: 0.626 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.7169508934020996
Epoch: 43, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.620 Vali Acc: 0.809 Test Loss: 0.620 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 68772
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.224287986755371
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.341 Vali Acc: 0.322 Test Loss: 1.341 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.4975972175598145
Epoch: 2, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.322355 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.2613887786865234
Epoch: 3, Steps: 10 | Train Loss: 1.066 Vali Loss: 0.996 Vali Acc: 0.618 Test Loss: 0.996 Test Acc: 0.618
Validation loss decreased (-0.499988 --> -0.618411).  Saving model ...
Epoch: 4 cost time: 1.6235768795013428
Epoch: 4, Steps: 10 | Train Loss: 0.755 Vali Loss: 0.817 Vali Acc: 0.704 Test Loss: 0.817 Test Acc: 0.704
Validation loss decreased (-0.618411 --> -0.703939).  Saving model ...
Epoch: 5 cost time: 1.410142183303833
Epoch: 5, Steps: 10 | Train Loss: 0.603 Vali Loss: 0.693 Vali Acc: 0.730 Test Loss: 0.693 Test Acc: 0.730
Validation loss decreased (-0.703939 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 1.657388687133789
Epoch: 6, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.5942387580871582
Epoch: 7, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.6860325336456299
Epoch: 8, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 9 cost time: 1.27618408203125
Epoch: 9, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 10 cost time: 1.8862931728363037
Epoch: 10, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 11 cost time: 1.6018106937408447
Epoch: 11, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2834527492523193
Epoch: 12, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 13 cost time: 1.6045117378234863
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.586127758026123
Epoch: 14, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.475 Vali Acc: 0.836 Test Loss: 0.475 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5672194957733154
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4297912120819092
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.495 Vali Acc: 0.829 Test Loss: 0.495 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.22127366065979
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.496 Vali Acc: 0.829 Test Loss: 0.496 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7594261169433594
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.521 Vali Acc: 0.836 Test Loss: 0.521 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7467448711395264
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7476434707641602
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.505 Vali Acc: 0.816 Test Loss: 0.505 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.355736494064331
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.523 Vali Acc: 0.829 Test Loss: 0.523 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.397305965423584
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.525 Vali Acc: 0.829 Test Loss: 0.525 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 61284
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.786141872406006
Epoch: 1, Steps: 10 | Train Loss: 1.595 Vali Loss: 1.511 Vali Acc: 0.197 Test Loss: 1.511 Test Acc: 0.197
Validation loss decreased (inf --> -0.197353).  Saving model ...
Epoch: 2 cost time: 1.2214524745941162
Epoch: 2, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.393 Vali Acc: 0.303 Test Loss: 1.393 Test Acc: 0.303
Validation loss decreased (-0.197353 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.5296061038970947
Epoch: 3, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.264 Vali Acc: 0.447 Test Loss: 1.264 Test Acc: 0.447
Validation loss decreased (-0.302618 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.4111952781677246
Epoch: 4, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.127 Vali Acc: 0.526 Test Loss: 1.127 Test Acc: 0.526
Validation loss decreased (-0.447356 --> -0.526305).  Saving model ...
Epoch: 5 cost time: 1.53499436378479
Epoch: 5, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.011 Vali Acc: 0.586 Test Loss: 1.011 Test Acc: 0.586
Validation loss decreased (-0.526305 --> -0.585516).  Saving model ...
Epoch: 6 cost time: 1.3977653980255127
Epoch: 6, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.882 Vali Acc: 0.658 Test Loss: 0.882 Test Acc: 0.658
Validation loss decreased (-0.585516 --> -0.657886).  Saving model ...
Epoch: 7 cost time: 1.464233636856079
Epoch: 7, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.782 Vali Acc: 0.704 Test Loss: 0.782 Test Acc: 0.704
Validation loss decreased (-0.657886 --> -0.703940).  Saving model ...
Epoch: 8 cost time: 1.2699871063232422
Epoch: 8, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.700 Vali Acc: 0.737 Test Loss: 0.700 Test Acc: 0.737
Validation loss decreased (-0.703940 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 1.4948921203613281
Epoch: 9, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.3582763671875
Epoch: 10, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.597 Vali Acc: 0.776 Test Loss: 0.597 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.5793967247009277
Epoch: 11, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5326683521270752
Epoch: 12, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.4978601932525635
Epoch: 13, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5954077243804932
Epoch: 14, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.3983793258666992
Epoch: 15, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6955616474151611
Epoch: 16, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.465479850769043
Epoch: 17, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.4468824863433838
Epoch: 18, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4898781776428223
Epoch: 19, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5283293724060059
Epoch: 20, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 21 cost time: 1.5758168697357178
Epoch: 21, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5694241523742676
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7870492935180664
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5741019248962402
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6870994567871094
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5085961818695068
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4901368618011475
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7463274002075195
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2926025390625
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.594 Vali Acc: 0.789 Test Loss: 0.594 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3844547271728516
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 49796
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.071585178375244
Epoch: 1, Steps: 10 | Train Loss: 1.544 Vali Loss: 1.443 Vali Acc: 0.270 Test Loss: 1.443 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 1.7730107307434082
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.355 Vali Acc: 0.362 Test Loss: 1.355 Test Acc: 0.362
Validation loss decreased (-0.269722 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.50787353515625
Epoch: 3, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.246 Vali Acc: 0.487 Test Loss: 1.246 Test Acc: 0.487
Validation loss decreased (-0.361829 --> -0.486830).  Saving model ...
Epoch: 4 cost time: 1.3813869953155518
Epoch: 4, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.128 Vali Acc: 0.539 Test Loss: 1.128 Test Acc: 0.539
Validation loss decreased (-0.486830 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 1.3463013172149658
Epoch: 5, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.016 Vali Acc: 0.579 Test Loss: 1.016 Test Acc: 0.579
Validation loss decreased (-0.539462 --> -0.578937).  Saving model ...
Epoch: 6 cost time: 1.369006633758545
Epoch: 6, Steps: 10 | Train Loss: 0.904 Vali Loss: 0.911 Vali Acc: 0.638 Test Loss: 0.911 Test Acc: 0.638
Validation loss decreased (-0.578937 --> -0.638149).  Saving model ...
Epoch: 7 cost time: 1.259777545928955
Epoch: 7, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.828 Vali Acc: 0.671 Test Loss: 0.828 Test Acc: 0.671
Validation loss decreased (-0.638149 --> -0.671044).  Saving model ...
Epoch: 8 cost time: 1.2955517768859863
Epoch: 8, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.752 Vali Acc: 0.711 Test Loss: 0.752 Test Acc: 0.711
Validation loss decreased (-0.671044 --> -0.710519).  Saving model ...
Epoch: 9 cost time: 1.3097467422485352
Epoch: 9, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 1.462876319885254
Epoch: 10, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.4950923919677734
Epoch: 11, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.599059820175171
Epoch: 12, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5213940143585205
Epoch: 13, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
Validation loss decreased (-0.782889 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 1.3307578563690186
Epoch: 14, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.283949375152588
Epoch: 15, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 16 cost time: 1.4559097290039062
Epoch: 16, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.482 Vali Acc: 0.829 Test Loss: 0.482 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828943).  Saving model ...
Epoch: 17 cost time: 1.5974974632263184
Epoch: 17, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2806541919708252
Epoch: 18, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2489559650421143
Epoch: 19, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4239001274108887
Epoch: 20, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6848909854888916
Epoch: 21, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9429147243499756
Epoch: 22, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5202503204345703
Epoch: 23, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.488 Vali Acc: 0.816 Test Loss: 0.488 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4241442680358887
Epoch: 24, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2220606803894043
Epoch: 25, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2848894596099854
Epoch: 26, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 46020
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.983003616333008
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.389 Vali Acc: 0.349 Test Loss: 1.389 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.5548255443572998
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.298 Vali Acc: 0.434 Test Loss: 1.298 Test Acc: 0.434
Validation loss decreased (-0.348670 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 1.5303800106048584
Epoch: 3, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.197 Vali Acc: 0.507 Test Loss: 1.197 Test Acc: 0.507
Validation loss decreased (-0.434198 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.3641586303710938
Epoch: 4, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.098 Vali Acc: 0.566 Test Loss: 1.098 Test Acc: 0.566
Validation loss decreased (-0.506567 --> -0.565778).  Saving model ...
Epoch: 5 cost time: 1.5830798149108887
Epoch: 5, Steps: 10 | Train Loss: 0.972 Vali Loss: 0.992 Vali Acc: 0.605 Test Loss: 0.992 Test Acc: 0.605
Validation loss decreased (-0.565778 --> -0.605253).  Saving model ...
Epoch: 6 cost time: 1.419576644897461
Epoch: 6, Steps: 10 | Train Loss: 0.845 Vali Loss: 0.900 Vali Acc: 0.645 Test Loss: 0.900 Test Acc: 0.645
Validation loss decreased (-0.605253 --> -0.644728).  Saving model ...
Epoch: 7 cost time: 1.8632657527923584
Epoch: 7, Steps: 10 | Train Loss: 0.751 Vali Loss: 0.814 Vali Acc: 0.691 Test Loss: 0.814 Test Acc: 0.691
Validation loss decreased (-0.644728 --> -0.690781).  Saving model ...
Epoch: 8 cost time: 2.1936264038085938
Epoch: 8, Steps: 10 | Train Loss: 0.630 Vali Loss: 0.740 Vali Acc: 0.717 Test Loss: 0.740 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 1.5365633964538574
Epoch: 9, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.685 Vali Acc: 0.724 Test Loss: 0.685 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 1.519810438156128
Epoch: 10, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.647 Vali Acc: 0.730 Test Loss: 0.647 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730257).  Saving model ...
Epoch: 11 cost time: 1.4433796405792236
Epoch: 11, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.624 Vali Acc: 0.743 Test Loss: 0.624 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.780822992324829
Epoch: 12, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.6119911670684814
Epoch: 13, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.6060850620269775
Epoch: 14, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.557 Vali Acc: 0.763 Test Loss: 0.557 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.5609190464019775
Epoch: 15, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.791506290435791
Epoch: 16, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.4355528354644775
Epoch: 17, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.444140911102295
Epoch: 18, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 19 cost time: 1.597747802734375
Epoch: 19, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
Validation loss decreased (-0.782890 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.5617780685424805
Epoch: 20, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6927204132080078
Epoch: 21, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 22 cost time: 1.6726412773132324
Epoch: 22, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3441147804260254
Epoch: 23, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.533400058746338
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7640984058380127
Epoch: 25, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6834936141967773
Epoch: 26, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6112842559814453
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7595853805541992
Epoch: 28, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5396451950073242
Epoch: 29, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4571592807769775
Epoch: 30, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.7589025497436523
Epoch: 31, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.555 Vali Acc: 0.796 Test Loss: 0.555 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 46052
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.054839849472046
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.399 Vali Acc: 0.368 Test Loss: 1.399 Test Acc: 0.368
Validation loss decreased (inf --> -0.368407).  Saving model ...
Epoch: 2 cost time: 1.2439632415771484
Epoch: 2, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.348 Vali Acc: 0.414 Test Loss: 1.348 Test Acc: 0.414
Validation loss decreased (-0.368407 --> -0.414460).  Saving model ...
Epoch: 3 cost time: 1.3248610496520996
Epoch: 3, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.272 Vali Acc: 0.454 Test Loss: 1.272 Test Acc: 0.454
Validation loss decreased (-0.414460 --> -0.453935).  Saving model ...
Epoch: 4 cost time: 1.2423267364501953
Epoch: 4, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
Validation loss decreased (-0.453935 --> -0.532883).  Saving model ...
Epoch: 5 cost time: 1.3583688735961914
Epoch: 5, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.097 Vali Acc: 0.579 Test Loss: 1.097 Test Acc: 0.579
Validation loss decreased (-0.532883 --> -0.578936).  Saving model ...
Epoch: 6 cost time: 1.5106961727142334
Epoch: 6, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.014 Vali Acc: 0.599 Test Loss: 1.014 Test Acc: 0.599
Validation loss decreased (-0.578936 --> -0.598674).  Saving model ...
Epoch: 7 cost time: 1.2599563598632812
Epoch: 7, Steps: 10 | Train Loss: 0.835 Vali Loss: 0.938 Vali Acc: 0.632 Test Loss: 0.938 Test Acc: 0.632
Validation loss decreased (-0.598674 --> -0.631570).  Saving model ...
Epoch: 8 cost time: 1.2840337753295898
Epoch: 8, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.871 Vali Acc: 0.664 Test Loss: 0.871 Test Acc: 0.664
Validation loss decreased (-0.631570 --> -0.664465).  Saving model ...
Epoch: 9 cost time: 1.412541151046753
Epoch: 9, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.810 Vali Acc: 0.697 Test Loss: 0.810 Test Acc: 0.697
Validation loss decreased (-0.664465 --> -0.697360).  Saving model ...
Epoch: 10 cost time: 1.5518770217895508
Epoch: 10, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.749 Vali Acc: 0.717 Test Loss: 0.749 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.549365520477295
Epoch: 11, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.710 Vali Acc: 0.737 Test Loss: 0.710 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 1.3326172828674316
Epoch: 12, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 13 cost time: 1.5369203090667725
Epoch: 13, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.641 Vali Acc: 0.763 Test Loss: 0.641 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 1.3995370864868164
Epoch: 14, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.231757402420044
Epoch: 15, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.1955082416534424
Epoch: 16, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4263060092926025
Epoch: 17, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.350762128829956
Epoch: 18, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.562 Vali Acc: 0.757 Test Loss: 0.562 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5976269245147705
Epoch: 19, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.553 Vali Acc: 0.757 Test Loss: 0.553 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.481503963470459
Epoch: 20, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.552 Vali Acc: 0.763 Test Loss: 0.552 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2619564533233643
Epoch: 21, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.553 Vali Acc: 0.750 Test Loss: 0.553 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5404140949249268
Epoch: 22, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.548 Vali Acc: 0.757 Test Loss: 0.548 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.630406141281128
Epoch: 23, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.744370460510254
Epoch: 24, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.673494815826416
Epoch: 25, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.556 Vali Acc: 0.763 Test Loss: 0.556 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 43812
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.001585960388184
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.366 Vali Acc: 0.263 Test Loss: 1.366 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.322939157485962
Epoch: 2, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.197 Vali Acc: 0.493 Test Loss: 1.197 Test Acc: 0.493
Validation loss decreased (-0.263144 --> -0.493409).  Saving model ...
Epoch: 3 cost time: 1.5261826515197754
Epoch: 3, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.010 Vali Acc: 0.638 Test Loss: 1.010 Test Acc: 0.638
Validation loss decreased (-0.493409 --> -0.638148).  Saving model ...
Epoch: 4 cost time: 1.5093719959259033
Epoch: 4, Steps: 10 | Train Loss: 0.779 Vali Loss: 0.841 Vali Acc: 0.684 Test Loss: 0.841 Test Acc: 0.684
Validation loss decreased (-0.638148 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 1.4513499736785889
Epoch: 5, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.721 Vali Acc: 0.717 Test Loss: 0.721 Test Acc: 0.717
Validation loss decreased (-0.684202 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.4926512241363525
Epoch: 6, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.659 Vali Acc: 0.737 Test Loss: 0.659 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736836).  Saving model ...
Epoch: 7 cost time: 1.4518473148345947
Epoch: 7, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.580 Vali Acc: 0.770 Test Loss: 0.580 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.4771325588226318
Epoch: 8, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.1942322254180908
Epoch: 9, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.503 Vali Acc: 0.789 Test Loss: 0.503 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4221429824829102
Epoch: 10, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802627).  Saving model ...
Epoch: 11 cost time: 1.2256200313568115
Epoch: 11, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.474 Vali Acc: 0.803 Test Loss: 0.474 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 12 cost time: 1.3621456623077393
Epoch: 12, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 13 cost time: 1.233142614364624
Epoch: 13, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 14 cost time: 1.2025818824768066
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
Validation loss decreased (-0.809206 --> -0.828943).  Saving model ...
Epoch: 15 cost time: 1.0823447704315186
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1882379055023193
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9217970371246338
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.504 Vali Acc: 0.822 Test Loss: 0.504 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5290753841400146
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.522 Vali Acc: 0.822 Test Loss: 0.522 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.182302713394165
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.510 Vali Acc: 0.822 Test Loss: 0.510 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1245403289794922
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.510 Vali Acc: 0.822 Test Loss: 0.510 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3241703510284424
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.311126708984375
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2524209022521973
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1962602138519287
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.561 Vali Acc: 0.816 Test Loss: 0.561 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 48804
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.508622407913208
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.477 Vali Acc: 0.224 Test Loss: 1.477 Test Acc: 0.224
Validation loss decreased (inf --> -0.223669).  Saving model ...
Epoch: 2 cost time: 1.773425579071045
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.348 Vali Acc: 0.270 Test Loss: 1.348 Test Acc: 0.270
Validation loss decreased (-0.223669 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.7581558227539062
Epoch: 3, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.214 Vali Acc: 0.493 Test Loss: 1.214 Test Acc: 0.493
Validation loss decreased (-0.269723 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 1.7436535358428955
Epoch: 4, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.081 Vali Acc: 0.572 Test Loss: 1.081 Test Acc: 0.572
Validation loss decreased (-0.493409 --> -0.572358).  Saving model ...
Epoch: 5 cost time: 1.3197193145751953
Epoch: 5, Steps: 10 | Train Loss: 0.924 Vali Loss: 0.949 Vali Acc: 0.625 Test Loss: 0.949 Test Acc: 0.625
Validation loss decreased (-0.572358 --> -0.624991).  Saving model ...
Epoch: 6 cost time: 1.5034582614898682
Epoch: 6, Steps: 10 | Train Loss: 0.784 Vali Loss: 0.861 Vali Acc: 0.658 Test Loss: 0.861 Test Acc: 0.658
Validation loss decreased (-0.624991 --> -0.657886).  Saving model ...
Epoch: 7 cost time: 1.040581226348877
Epoch: 7, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.778 Vali Acc: 0.684 Test Loss: 0.778 Test Acc: 0.684
Validation loss decreased (-0.657886 --> -0.684203).  Saving model ...
Epoch: 8 cost time: 1.5900781154632568
Epoch: 8, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.694 Vali Acc: 0.724 Test Loss: 0.694 Test Acc: 0.724
Validation loss decreased (-0.684203 --> -0.723677).  Saving model ...
Epoch: 9 cost time: 1.4741542339324951
Epoch: 9, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.4895656108856201
Epoch: 10, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.599 Vali Acc: 0.770 Test Loss: 0.599 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.6582155227661133
Epoch: 11, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.3765642642974854
Epoch: 12, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4375731945037842
Epoch: 13, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.3659031391143799
Epoch: 14, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.2582473754882812
Epoch: 15, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.4704034328460693
Epoch: 16, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 1.309063196182251
Epoch: 17, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3764209747314453
Epoch: 18, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6847333908081055
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5773749351501465
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5277009010314941
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2158541679382324
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4152674674987793
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.545 Vali Acc: 0.809 Test Loss: 0.545 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2411582469940186
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3549463748931885
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.541 Vali Acc: 0.816 Test Loss: 0.541 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 26 cost time: 1.1868979930877686
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2198452949523926
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4075324535369873
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5315055847167969
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 30 cost time: 1.4896767139434814
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.581 Vali Acc: 0.809 Test Loss: 0.581 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2459874153137207
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.586 Vali Acc: 0.809 Test Loss: 0.586 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.517441749572754
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.368468999862671
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.478079080581665
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.411957025527954
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2423348426818848
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3100481033325195
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.635 Vali Acc: 0.816 Test Loss: 0.635 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2082421779632568
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.635 Vali Acc: 0.816 Test Loss: 0.635 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.203580617904663
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.637 Vali Acc: 0.816 Test Loss: 0.637 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 37316
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.6329121589660645
Epoch: 1, Steps: 10 | Train Loss: 1.521 Vali Loss: 1.317 Vali Acc: 0.368 Test Loss: 1.317 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 1.245406150817871
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.232 Vali Acc: 0.487 Test Loss: 1.232 Test Acc: 0.487
Validation loss decreased (-0.368408 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.294753074645996
Epoch: 3, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.130 Vali Acc: 0.559 Test Loss: 1.130 Test Acc: 0.559
Validation loss decreased (-0.486830 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.760951042175293
Epoch: 4, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.031 Vali Acc: 0.579 Test Loss: 1.031 Test Acc: 0.579
Validation loss decreased (-0.559199 --> -0.578937).  Saving model ...
Epoch: 5 cost time: 1.3435900211334229
Epoch: 5, Steps: 10 | Train Loss: 0.955 Vali Loss: 0.941 Vali Acc: 0.618 Test Loss: 0.941 Test Acc: 0.618
Validation loss decreased (-0.578937 --> -0.618412).  Saving model ...
Epoch: 6 cost time: 1.801243543624878
Epoch: 6, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.853 Vali Acc: 0.658 Test Loss: 0.853 Test Acc: 0.658
Validation loss decreased (-0.618412 --> -0.657886).  Saving model ...
Epoch: 7 cost time: 1.4428045749664307
Epoch: 7, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.786 Vali Acc: 0.664 Test Loss: 0.786 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664466).  Saving model ...
Epoch: 8 cost time: 1.4648258686065674
Epoch: 8, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.725 Vali Acc: 0.684 Test Loss: 0.725 Test Acc: 0.684
Validation loss decreased (-0.664466 --> -0.684203).  Saving model ...
Epoch: 9 cost time: 1.7593185901641846
Epoch: 9, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.668 Vali Acc: 0.724 Test Loss: 0.668 Test Acc: 0.724
Validation loss decreased (-0.684203 --> -0.723678).  Saving model ...
Epoch: 10 cost time: 1.5737934112548828
Epoch: 10, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.635 Vali Acc: 0.730 Test Loss: 0.635 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 11 cost time: 1.606945514678955
Epoch: 11, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
Validation loss decreased (-0.730257 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 1.4856550693511963
Epoch: 12, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.485323429107666
Epoch: 13, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.558 Vali Acc: 0.770 Test Loss: 0.558 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5616776943206787
Epoch: 14, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.7039525508880615
Epoch: 15, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4769871234893799
Epoch: 16, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.525 Vali Acc: 0.770 Test Loss: 0.525 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6240592002868652
Epoch: 17, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.617966890335083
Epoch: 18, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6779980659484863
Epoch: 19, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.4850568771362305
Epoch: 20, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 1.64217209815979
Epoch: 21, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5550487041473389
Epoch: 22, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 23 cost time: 1.57304048538208
Epoch: 23, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4121108055114746
Epoch: 24, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3870258331298828
Epoch: 25, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7347908020019531
Epoch: 26, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6800739765167236
Epoch: 27, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6105690002441406
Epoch: 28, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 29 cost time: 1.5344016551971436
Epoch: 29, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6443040370941162
Epoch: 30, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5821480751037598
Epoch: 31, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.482537031173706
Epoch: 32, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.372415542602539
Epoch: 33, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.239248514175415
Epoch: 34, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2097582817077637
Epoch: 35, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.226606845855713
Epoch: 36, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.527010440826416
Epoch: 37, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.608 Vali Acc: 0.803 Test Loss: 0.608 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.420795202255249
Epoch: 38, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 33540
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.658182382583618
Epoch: 1, Steps: 10 | Train Loss: 1.542 Vali Loss: 1.441 Vali Acc: 0.296 Test Loss: 1.441 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 1.373856782913208
Epoch: 2, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.373 Vali Acc: 0.355 Test Loss: 1.373 Test Acc: 0.355
Validation loss decreased (-0.296038 --> -0.355249).  Saving model ...
Epoch: 3 cost time: 1.621795654296875
Epoch: 3, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.272 Vali Acc: 0.487 Test Loss: 1.272 Test Acc: 0.487
Validation loss decreased (-0.355249 --> -0.486829).  Saving model ...
Epoch: 4 cost time: 1.2944436073303223
Epoch: 4, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.168 Vali Acc: 0.572 Test Loss: 1.168 Test Acc: 0.572
Validation loss decreased (-0.486829 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 1.6408376693725586
Epoch: 5, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.056 Vali Acc: 0.612 Test Loss: 1.056 Test Acc: 0.612
Validation loss decreased (-0.572357 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 1.4385673999786377
Epoch: 6, Steps: 10 | Train Loss: 0.874 Vali Loss: 0.959 Vali Acc: 0.664 Test Loss: 0.959 Test Acc: 0.664
Validation loss decreased (-0.611832 --> -0.664464).  Saving model ...
Epoch: 7 cost time: 1.242858648300171
Epoch: 7, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.866 Vali Acc: 0.684 Test Loss: 0.866 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684202).  Saving model ...
Epoch: 8 cost time: 1.6055908203125
Epoch: 8, Steps: 10 | Train Loss: 0.685 Vali Loss: 0.789 Vali Acc: 0.691 Test Loss: 0.789 Test Acc: 0.691
Validation loss decreased (-0.684202 --> -0.690782).  Saving model ...
Epoch: 9 cost time: 1.4796159267425537
Epoch: 9, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.731 Vali Acc: 0.711 Test Loss: 0.731 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.6415269374847412
Epoch: 10, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.681 Vali Acc: 0.717 Test Loss: 0.681 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.5022568702697754
Epoch: 11, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.636 Vali Acc: 0.724 Test Loss: 0.636 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723678).  Saving model ...
Epoch: 12 cost time: 1.3110640048980713
Epoch: 12, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.605 Vali Acc: 0.717 Test Loss: 0.605 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4742980003356934
Epoch: 13, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
Validation loss decreased (-0.723678 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.2838046550750732
Epoch: 14, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.572 Vali Acc: 0.757 Test Loss: 0.572 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 1.7010602951049805
Epoch: 15, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.560 Vali Acc: 0.776 Test Loss: 0.560 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.1067018508911133
Epoch: 16, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3996832370758057
Epoch: 17, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2993390560150146
Epoch: 18, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.3411426544189453
Epoch: 19, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4544272422790527
Epoch: 20, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 21 cost time: 1.3156251907348633
Epoch: 21, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 22 cost time: 1.2041709423065186
Epoch: 22, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2873220443725586
Epoch: 23, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.33833646774292
Epoch: 24, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 25 cost time: 1.2736334800720215
Epoch: 25, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.543 Vali Acc: 0.796 Test Loss: 0.543 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.335059404373169
Epoch: 26, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 27 cost time: 2.1521191596984863
Epoch: 27, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9374115467071533
Epoch: 28, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5075335502624512
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5465824604034424
Epoch: 30, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.567 Vali Acc: 0.789 Test Loss: 0.567 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.247406244277954
Epoch: 31, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.936500072479248
Epoch: 32, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.221010684967041
Epoch: 33, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.574 Vali Acc: 0.796 Test Loss: 0.574 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3262763023376465
Epoch: 34, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4835126399993896
Epoch: 35, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5012600421905518
Epoch: 36, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 33572
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.968717098236084
Epoch: 1, Steps: 10 | Train Loss: 1.574 Vali Loss: 1.473 Vali Acc: 0.204 Test Loss: 1.473 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 1.498748779296875
Epoch: 2, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.422 Vali Acc: 0.270 Test Loss: 1.422 Test Acc: 0.270
Validation loss decreased (-0.203933 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.463258981704712
Epoch: 3, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.338 Vali Acc: 0.382 Test Loss: 1.338 Test Acc: 0.382
Validation loss decreased (-0.269723 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 1.4565212726593018
Epoch: 4, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.247 Vali Acc: 0.461 Test Loss: 1.247 Test Acc: 0.461
Validation loss decreased (-0.381566 --> -0.460514).  Saving model ...
Epoch: 5 cost time: 1.1705472469329834
Epoch: 5, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.158 Vali Acc: 0.579 Test Loss: 1.158 Test Acc: 0.579
Validation loss decreased (-0.460514 --> -0.578936).  Saving model ...
Epoch: 6 cost time: 1.2043125629425049
Epoch: 6, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.075 Vali Acc: 0.599 Test Loss: 1.075 Test Acc: 0.599
Validation loss decreased (-0.578936 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 1.4192795753479004
Epoch: 7, Steps: 10 | Train Loss: 0.912 Vali Loss: 0.999 Vali Acc: 0.645 Test Loss: 0.999 Test Acc: 0.645
Validation loss decreased (-0.598673 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 1.3484206199645996
Epoch: 8, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.929 Vali Acc: 0.678 Test Loss: 0.929 Test Acc: 0.678
Validation loss decreased (-0.644727 --> -0.677622).  Saving model ...
Epoch: 9 cost time: 1.2412610054016113
Epoch: 9, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.862 Vali Acc: 0.711 Test Loss: 0.862 Test Acc: 0.711
Validation loss decreased (-0.677622 --> -0.710518).  Saving model ...
Epoch: 10 cost time: 1.2946233749389648
Epoch: 10, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.800 Vali Acc: 0.724 Test Loss: 0.800 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723676).  Saving model ...
Epoch: 11 cost time: 1.3488433361053467
Epoch: 11, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.751 Vali Acc: 0.737 Test Loss: 0.751 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 1.4070751667022705
Epoch: 12, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.711 Vali Acc: 0.757 Test Loss: 0.711 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 13 cost time: 1.423699140548706
Epoch: 13, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.671 Vali Acc: 0.763 Test Loss: 0.671 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 1.5339491367340088
Epoch: 14, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.632 Vali Acc: 0.770 Test Loss: 0.632 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.4067714214324951
Epoch: 15, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5407373905181885
Epoch: 16, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.2113406658172607
Epoch: 17, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.4025914669036865
Epoch: 18, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 1.232795238494873
Epoch: 19, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3098509311676025
Epoch: 20, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1792442798614502
Epoch: 21, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4152557849884033
Epoch: 22, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 1.3715770244598389
Epoch: 23, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3831510543823242
Epoch: 24, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.399895191192627
Epoch: 25, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3628177642822266
Epoch: 26, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.312654733657837
Epoch: 27, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2985692024230957
Epoch: 28, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2027783393859863
Epoch: 29, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.3325088024139404
Epoch: 30, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3369920253753662
Epoch: 31, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1939146518707275
Epoch: 32, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3588597774505615
Epoch: 33, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2359118461608887
Epoch: 34, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.4150967597961426
Epoch: 35, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4158539772033691
Epoch: 36, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3463878631591797
Epoch: 37, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2897999286651611
Epoch: 38, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3908190727233887
Epoch: 39, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 40 cost time: 1.1581754684448242
Epoch: 40, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 41 cost time: 1.4027891159057617
Epoch: 41, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.668686866760254
Epoch: 42, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4448366165161133
Epoch: 43, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3902151584625244
Epoch: 44, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.5614345073699951
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.4164700508117676
Epoch: 46, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.6864655017852783
Epoch: 47, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.5246810913085938
Epoch: 48, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.7087273597717285
Epoch: 49, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.606 Vali Acc: 0.816 Test Loss: 0.606 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.3437330722808838
Epoch: 50, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 31332
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.261715412139893
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.443 Vali Acc: 0.289 Test Loss: 1.443 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 1.2855408191680908
Epoch: 2, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.368 Vali Acc: 0.362 Test Loss: 1.368 Test Acc: 0.362
Validation loss decreased (-0.289459 --> -0.361828).  Saving model ...
Epoch: 3 cost time: 1.2830462455749512
Epoch: 3, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.276 Vali Acc: 0.474 Test Loss: 1.276 Test Acc: 0.474
Validation loss decreased (-0.361828 --> -0.473671).  Saving model ...
Epoch: 4 cost time: 1.6114590167999268
Epoch: 4, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.147 Vali Acc: 0.533 Test Loss: 1.147 Test Acc: 0.533
Validation loss decreased (-0.473671 --> -0.532883).  Saving model ...
Epoch: 5 cost time: 1.382995843887329
Epoch: 5, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.020 Vali Acc: 0.599 Test Loss: 1.020 Test Acc: 0.599
Validation loss decreased (-0.532883 --> -0.598674).  Saving model ...
Epoch: 6 cost time: 1.3997962474822998
Epoch: 6, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.912 Vali Acc: 0.664 Test Loss: 0.912 Test Acc: 0.664
Validation loss decreased (-0.598674 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 1.3336410522460938
Epoch: 7, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.831 Vali Acc: 0.625 Test Loss: 0.831 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5146381855010986
Epoch: 8, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.742 Vali Acc: 0.704 Test Loss: 0.742 Test Acc: 0.704
Validation loss decreased (-0.664465 --> -0.703940).  Saving model ...
Epoch: 9 cost time: 1.5269417762756348
Epoch: 9, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.675 Vali Acc: 0.711 Test Loss: 0.675 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710520).  Saving model ...
Epoch: 10 cost time: 1.4048998355865479
Epoch: 10, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
Validation loss decreased (-0.710520 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.80064058303833
Epoch: 11, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 2.19862699508667
Epoch: 12, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.3425509929656982
Epoch: 13, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.550 Vali Acc: 0.770 Test Loss: 0.550 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1341803073883057
Epoch: 14, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.3488328456878662
Epoch: 15, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.6934804916381836
Epoch: 16, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3802893161773682
Epoch: 17, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.5401432514190674
Epoch: 18, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7131297588348389
Epoch: 19, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.4017541408538818
Epoch: 20, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3484585285186768
Epoch: 21, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3977479934692383
Epoch: 22, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7555792331695557
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8842790126800537
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6190695762634277
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6707744598388672
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 27 cost time: 1.5030789375305176
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7375004291534424
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4948575496673584
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.621056318283081
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.295384407043457
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 32 cost time: 1.3741505146026611
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7099888324737549
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.927581787109375
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7199678421020508
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.9953727722167969
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.625 Vali Acc: 0.816 Test Loss: 0.625 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.8815245628356934
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.602 Vali Acc: 0.816 Test Loss: 0.602 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3813550472259521
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4149737358093262
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.7602169513702393
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.417311668395996
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.640 Vali Acc: 0.816 Test Loss: 0.640 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 40436
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.191577434539795
Epoch: 1, Steps: 10 | Train Loss: 1.586 Vali Loss: 1.478 Vali Acc: 0.184 Test Loss: 1.478 Test Acc: 0.184
Validation loss decreased (inf --> -0.184196).  Saving model ...
Epoch: 2 cost time: 1.5139784812927246
Epoch: 2, Steps: 10 | Train Loss: 1.557 Vali Loss: 1.389 Vali Acc: 0.250 Test Loss: 1.389 Test Acc: 0.250
Validation loss decreased (-0.184196 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.5081586837768555
Epoch: 3, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.295 Vali Acc: 0.401 Test Loss: 1.295 Test Acc: 0.401
Validation loss decreased (-0.249986 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 1.229119062423706
Epoch: 4, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.201 Vali Acc: 0.520 Test Loss: 1.201 Test Acc: 0.520
Validation loss decreased (-0.401303 --> -0.519725).  Saving model ...
Epoch: 5 cost time: 1.3639671802520752
Epoch: 5, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.108 Vali Acc: 0.592 Test Loss: 1.108 Test Acc: 0.592
Validation loss decreased (-0.519725 --> -0.592094).  Saving model ...
Epoch: 6 cost time: 1.4250156879425049
Epoch: 6, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.007 Vali Acc: 0.592 Test Loss: 1.007 Test Acc: 0.592
Validation loss decreased (-0.592094 --> -0.592095).  Saving model ...
Epoch: 7 cost time: 1.208385705947876
Epoch: 7, Steps: 10 | Train Loss: 0.913 Vali Loss: 0.912 Vali Acc: 0.651 Test Loss: 0.912 Test Acc: 0.651
Validation loss decreased (-0.592095 --> -0.651307).  Saving model ...
Epoch: 8 cost time: 1.3547067642211914
Epoch: 8, Steps: 10 | Train Loss: 0.791 Vali Loss: 0.830 Vali Acc: 0.678 Test Loss: 0.830 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 1.1025094985961914
Epoch: 9, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.758 Vali Acc: 0.711 Test Loss: 0.758 Test Acc: 0.711
Validation loss decreased (-0.677623 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.2729594707489014
Epoch: 10, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.697 Vali Acc: 0.724 Test Loss: 0.697 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 1.1848998069763184
Epoch: 11, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.650 Vali Acc: 0.743 Test Loss: 0.650 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.2892935276031494
Epoch: 12, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.603 Vali Acc: 0.776 Test Loss: 0.603 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.4987103939056396
Epoch: 13, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.4882152080535889
Epoch: 14, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.2971796989440918
Epoch: 15, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789469).  Saving model ...
Epoch: 16 cost time: 1.7335715293884277
Epoch: 16, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 17 cost time: 1.4967975616455078
Epoch: 17, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.498 Vali Acc: 0.796 Test Loss: 0.498 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.762709617614746
Epoch: 18, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5548975467681885
Epoch: 19, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.481 Vali Acc: 0.809 Test Loss: 0.481 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 20 cost time: 1.6986777782440186
Epoch: 20, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 21 cost time: 1.451502799987793
Epoch: 21, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3713505268096924
Epoch: 22, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.473 Vali Acc: 0.803 Test Loss: 0.473 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4137167930603027
Epoch: 23, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4983351230621338
Epoch: 24, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 25 cost time: 1.147564172744751
Epoch: 25, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.440988302230835
Epoch: 26, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.452775478363037
Epoch: 27, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822363).  Saving model ...
Epoch: 28 cost time: 1.4291129112243652
Epoch: 28, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3022911548614502
Epoch: 29, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2300167083740234
Epoch: 30, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2439327239990234
Epoch: 31, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3365237712860107
Epoch: 32, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3665976524353027
Epoch: 33, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4665710926055908
Epoch: 34, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.535 Vali Acc: 0.816 Test Loss: 0.535 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.179659128189087
Epoch: 35, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4623706340789795
Epoch: 36, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.3823857307434082
Epoch: 37, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 34692
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.813039541244507
Epoch: 1, Steps: 10 | Train Loss: 1.566 Vali Loss: 1.504 Vali Acc: 0.243 Test Loss: 1.504 Test Acc: 0.243
Validation loss decreased (inf --> -0.243406).  Saving model ...
Epoch: 2 cost time: 1.2975850105285645
Epoch: 2, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.433 Vali Acc: 0.270 Test Loss: 1.433 Test Acc: 0.270
Validation loss decreased (-0.243406 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.3625903129577637
Epoch: 3, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.359 Vali Acc: 0.342 Test Loss: 1.359 Test Acc: 0.342
Validation loss decreased (-0.269723 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.375277042388916
Epoch: 4, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.284 Vali Acc: 0.428 Test Loss: 1.284 Test Acc: 0.428
Validation loss decreased (-0.342092 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 1.775451898574829
Epoch: 5, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.205 Vali Acc: 0.467 Test Loss: 1.205 Test Acc: 0.467
Validation loss decreased (-0.427619 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 1.240750789642334
Epoch: 6, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.130 Vali Acc: 0.539 Test Loss: 1.130 Test Acc: 0.539
Validation loss decreased (-0.467093 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 1.555811882019043
Epoch: 7, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.051 Vali Acc: 0.579 Test Loss: 1.051 Test Acc: 0.579
Validation loss decreased (-0.539462 --> -0.578937).  Saving model ...
Epoch: 8 cost time: 1.319298505783081
Epoch: 8, Steps: 10 | Train Loss: 0.948 Vali Loss: 0.982 Vali Acc: 0.605 Test Loss: 0.982 Test Acc: 0.605
Validation loss decreased (-0.578937 --> -0.605253).  Saving model ...
Epoch: 9 cost time: 1.649411678314209
Epoch: 9, Steps: 10 | Train Loss: 0.831 Vali Loss: 0.915 Vali Acc: 0.658 Test Loss: 0.915 Test Acc: 0.658
Validation loss decreased (-0.605253 --> -0.657886).  Saving model ...
Epoch: 10 cost time: 1.9169909954071045
Epoch: 10, Steps: 10 | Train Loss: 0.766 Vali Loss: 0.847 Vali Acc: 0.691 Test Loss: 0.847 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690781).  Saving model ...
Epoch: 11 cost time: 1.859621524810791
Epoch: 11, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.780 Vali Acc: 0.711 Test Loss: 0.780 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710519).  Saving model ...
Epoch: 12 cost time: 1.8457183837890625
Epoch: 12, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.724 Vali Acc: 0.730 Test Loss: 0.724 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 13 cost time: 1.4598753452301025
Epoch: 13, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.676 Vali Acc: 0.743 Test Loss: 0.676 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 14 cost time: 1.6814961433410645
Epoch: 14, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.637 Vali Acc: 0.757 Test Loss: 0.637 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 1.562211513519287
Epoch: 15, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.600 Vali Acc: 0.776 Test Loss: 0.600 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.555065393447876
Epoch: 16, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.3290503025054932
Epoch: 17, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6981282234191895
Epoch: 18, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 1.237825870513916
Epoch: 19, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 1.5059723854064941
Epoch: 20, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 1.4104230403900146
Epoch: 21, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 1.7165157794952393
Epoch: 22, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.493 Vali Acc: 0.796 Test Loss: 0.493 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 23 cost time: 1.6546814441680908
Epoch: 23, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 24 cost time: 1.4220573902130127
Epoch: 24, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 25 cost time: 1.5615572929382324
Epoch: 25, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.492 Vali Acc: 0.803 Test Loss: 0.492 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5370583534240723
Epoch: 26, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 27 cost time: 1.5758521556854248
Epoch: 27, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 28 cost time: 1.5591859817504883
Epoch: 28, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.478 Vali Acc: 0.809 Test Loss: 0.478 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.743823528289795
Epoch: 29, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 30 cost time: 1.2520132064819336
Epoch: 30, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7572062015533447
Epoch: 31, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.469 Vali Acc: 0.816 Test Loss: 0.469 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 32 cost time: 1.5653283596038818
Epoch: 32, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.471 Vali Acc: 0.829 Test Loss: 0.471 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 33 cost time: 1.6002922058105469
Epoch: 33, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.468 Vali Acc: 0.822 Test Loss: 0.468 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2866296768188477
Epoch: 34, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 35 cost time: 1.3009836673736572
Epoch: 35, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 36 cost time: 1.4121861457824707
Epoch: 36, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.482 Vali Acc: 0.849 Test Loss: 0.482 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848679).  Saving model ...
Epoch: 37 cost time: 1.4237520694732666
Epoch: 37, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3275537490844727
Epoch: 38, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.475 Vali Acc: 0.822 Test Loss: 0.475 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4582228660583496
Epoch: 39, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.463 Vali Acc: 0.829 Test Loss: 0.463 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4294250011444092
Epoch: 40, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.474 Vali Acc: 0.842 Test Loss: 0.474 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3934035301208496
Epoch: 41, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.479 Vali Acc: 0.849 Test Loss: 0.479 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 42 cost time: 1.3746745586395264
Epoch: 42, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.466 Vali Acc: 0.822 Test Loss: 0.466 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3038866519927979
Epoch: 43, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.473 Vali Acc: 0.829 Test Loss: 0.473 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3262312412261963
Epoch: 44, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.46108078956604
Epoch: 45, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.477 Vali Acc: 0.836 Test Loss: 0.477 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3940651416778564
Epoch: 46, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.479 Vali Acc: 0.836 Test Loss: 0.479 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.4336633682250977
Epoch: 47, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.480 Vali Acc: 0.836 Test Loss: 0.480 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3486106395721436
Epoch: 48, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.484 Vali Acc: 0.829 Test Loss: 0.484 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.4629907608032227
Epoch: 49, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.495 Vali Acc: 0.849 Test Loss: 0.495 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.4592390060424805
Epoch: 50, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
Validation loss decreased (-0.848679 --> -0.855258).  Saving model ...
Epoch: 51 cost time: 1.2062046527862549
Epoch: 51, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.488 Vali Acc: 0.836 Test Loss: 0.488 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.317629337310791
Epoch: 52, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.493 Vali Acc: 0.836 Test Loss: 0.493 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.039539098739624
Epoch: 53, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.497 Vali Acc: 0.842 Test Loss: 0.497 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.3885159492492676
Epoch: 54, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.498 Vali Acc: 0.842 Test Loss: 0.498 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.4002685546875
Epoch: 55, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.514 Vali Acc: 0.849 Test Loss: 0.514 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.7278318405151367
Epoch: 56, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.506 Vali Acc: 0.849 Test Loss: 0.506 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.4037818908691406
Epoch: 57, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.505 Vali Acc: 0.836 Test Loss: 0.505 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.51383638381958
Epoch: 58, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.510 Vali Acc: 0.855 Test Loss: 0.510 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.4438683986663818
Epoch: 59, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.517 Vali Acc: 0.849 Test Loss: 0.517 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.9420034885406494
Epoch: 60, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 32804
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.224316358566284
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.370 Vali Acc: 0.309 Test Loss: 1.370 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.4076571464538574
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.311 Vali Acc: 0.349 Test Loss: 1.311 Test Acc: 0.349
Validation loss decreased (-0.309197 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 1.269562005996704
Epoch: 3, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.245 Vali Acc: 0.388 Test Loss: 1.245 Test Acc: 0.388
Validation loss decreased (-0.348671 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 1.0760302543640137
Epoch: 4, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.177 Vali Acc: 0.454 Test Loss: 1.177 Test Acc: 0.454
Validation loss decreased (-0.388145 --> -0.453936).  Saving model ...
Epoch: 5 cost time: 1.395658254623413
Epoch: 5, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.102 Vali Acc: 0.526 Test Loss: 1.102 Test Acc: 0.526
Validation loss decreased (-0.453936 --> -0.526305).  Saving model ...
Epoch: 6 cost time: 1.8230111598968506
Epoch: 6, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.027 Vali Acc: 0.586 Test Loss: 1.027 Test Acc: 0.586
Validation loss decreased (-0.526305 --> -0.585516).  Saving model ...
Epoch: 7 cost time: 1.5921299457550049
Epoch: 7, Steps: 10 | Train Loss: 0.950 Vali Loss: 0.948 Vali Acc: 0.645 Test Loss: 0.948 Test Acc: 0.645
Validation loss decreased (-0.585516 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 1.953115701675415
Epoch: 8, Steps: 10 | Train Loss: 0.837 Vali Loss: 0.882 Vali Acc: 0.678 Test Loss: 0.882 Test Acc: 0.678
Validation loss decreased (-0.644727 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 1.514498233795166
Epoch: 9, Steps: 10 | Train Loss: 0.703 Vali Loss: 0.815 Vali Acc: 0.704 Test Loss: 0.815 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 1.4930529594421387
Epoch: 10, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.764 Vali Acc: 0.730 Test Loss: 0.764 Test Acc: 0.730
Validation loss decreased (-0.703939 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.8298814296722412
Epoch: 11, Steps: 10 | Train Loss: 0.564 Vali Loss: 0.722 Vali Acc: 0.704 Test Loss: 0.722 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3945107460021973
Epoch: 12, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.680 Vali Acc: 0.724 Test Loss: 0.680 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.470259189605713
Epoch: 13, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.641 Vali Acc: 0.730 Test Loss: 0.641 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 14 cost time: 1.613149642944336
Epoch: 14, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.607 Vali Acc: 0.743 Test Loss: 0.607 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 1.3755195140838623
Epoch: 15, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.583 Vali Acc: 0.776 Test Loss: 0.583 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.4506235122680664
Epoch: 16, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.572 Vali Acc: 0.776 Test Loss: 0.572 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.5391325950622559
Epoch: 17, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.590489387512207
Epoch: 18, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.5857791900634766
Epoch: 19, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.2249116897583008
Epoch: 20, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 1.768991470336914
Epoch: 21, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.835599422454834
Epoch: 22, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 23 cost time: 1.7391142845153809
Epoch: 23, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.514 Vali Acc: 0.789 Test Loss: 0.514 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8888804912567139
Epoch: 24, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4927468299865723
Epoch: 25, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5958318710327148
Epoch: 26, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8943922519683838
Epoch: 27, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 28 cost time: 1.6701147556304932
Epoch: 28, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3730034828186035
Epoch: 29, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3016717433929443
Epoch: 30, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2796916961669922
Epoch: 31, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5345017910003662
Epoch: 32, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4665939807891846
Epoch: 33, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6952035427093506
Epoch: 34, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3899896144866943
Epoch: 35, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.282137155532837
Epoch: 36, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.7686986923217773
Epoch: 37, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 38 cost time: 1.1722416877746582
Epoch: 38, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 39 cost time: 1.1882147789001465
Epoch: 39, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1614699363708496
Epoch: 40, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5913140773773193
Epoch: 41, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.6187803745269775
Epoch: 42, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.9855375289916992
Epoch: 43, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5786166191101074
Epoch: 44, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.5045063495635986
Epoch: 45, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.870403528213501
Epoch: 46, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.9238927364349365
Epoch: 47, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.567 Vali Acc: 0.789 Test Loss: 0.567 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.6374449729919434
Epoch: 48, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 32820
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.2553551197052
Epoch: 1, Steps: 10 | Train Loss: 1.600 Vali Loss: 1.530 Vali Acc: 0.224 Test Loss: 1.530 Test Acc: 0.224
Validation loss decreased (inf --> -0.223669).  Saving model ...
Epoch: 2 cost time: 1.608581781387329
Epoch: 2, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.458 Vali Acc: 0.270 Test Loss: 1.458 Test Acc: 0.270
Validation loss decreased (-0.223669 --> -0.269722).  Saving model ...
Epoch: 3 cost time: 1.3260631561279297
Epoch: 3, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.390 Vali Acc: 0.349 Test Loss: 1.390 Test Acc: 0.349
Validation loss decreased (-0.269722 --> -0.348670).  Saving model ...
Epoch: 4 cost time: 1.5748944282531738
Epoch: 4, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.325 Vali Acc: 0.401 Test Loss: 1.325 Test Acc: 0.401
Validation loss decreased (-0.348670 --> -0.401303).  Saving model ...
Epoch: 5 cost time: 1.255044937133789
Epoch: 5, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.261 Vali Acc: 0.454 Test Loss: 1.261 Test Acc: 0.454
Validation loss decreased (-0.401303 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 1.380589246749878
Epoch: 6, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
Validation loss decreased (-0.453935 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.5575485229492188
Epoch: 7, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.150 Vali Acc: 0.513 Test Loss: 1.150 Test Acc: 0.513
Validation loss decreased (-0.499988 --> -0.513146).  Saving model ...
Epoch: 8 cost time: 1.5070443153381348
Epoch: 8, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.091 Vali Acc: 0.592 Test Loss: 1.091 Test Acc: 0.592
Validation loss decreased (-0.513146 --> -0.592094).  Saving model ...
Epoch: 9 cost time: 2.0911731719970703
Epoch: 9, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.037 Vali Acc: 0.618 Test Loss: 1.037 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618411).  Saving model ...
Epoch: 10 cost time: 1.750067949295044
Epoch: 10, Steps: 10 | Train Loss: 0.853 Vali Loss: 0.986 Vali Acc: 0.638 Test Loss: 0.986 Test Acc: 0.638
Validation loss decreased (-0.618411 --> -0.638148).  Saving model ...
Epoch: 11 cost time: 1.706864595413208
Epoch: 11, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.932 Vali Acc: 0.658 Test Loss: 0.932 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657885).  Saving model ...
Epoch: 12 cost time: 1.771012306213379
Epoch: 12, Steps: 10 | Train Loss: 0.722 Vali Loss: 0.887 Vali Acc: 0.664 Test Loss: 0.887 Test Acc: 0.664
Validation loss decreased (-0.657885 --> -0.664465).  Saving model ...
Epoch: 13 cost time: 1.8202464580535889
Epoch: 13, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.842 Vali Acc: 0.678 Test Loss: 0.842 Test Acc: 0.678
Validation loss decreased (-0.664465 --> -0.677623).  Saving model ...
Epoch: 14 cost time: 1.487083911895752
Epoch: 14, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.803 Vali Acc: 0.678 Test Loss: 0.803 Test Acc: 0.678
Validation loss decreased (-0.677623 --> -0.677624).  Saving model ...
Epoch: 15 cost time: 1.834080696105957
Epoch: 15, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.768 Vali Acc: 0.704 Test Loss: 0.768 Test Acc: 0.704
Validation loss decreased (-0.677624 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 2.1651053428649902
Epoch: 16, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.741 Vali Acc: 0.697 Test Loss: 0.741 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5492935180664062
Epoch: 17, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.712 Vali Acc: 0.711 Test Loss: 0.712 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 18 cost time: 1.8272819519042969
Epoch: 18, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.690 Vali Acc: 0.717 Test Loss: 0.690 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 19 cost time: 1.625122308731079
Epoch: 19, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.667 Vali Acc: 0.730 Test Loss: 0.667 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 20 cost time: 1.7491455078125
Epoch: 20, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.650 Vali Acc: 0.743 Test Loss: 0.650 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 21 cost time: 1.7789514064788818
Epoch: 21, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.640 Vali Acc: 0.730 Test Loss: 0.640 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7672932147979736
Epoch: 22, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.636 Vali Acc: 0.737 Test Loss: 0.636 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9685685634613037
Epoch: 23, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.623 Vali Acc: 0.757 Test Loss: 0.623 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 24 cost time: 1.7295453548431396
Epoch: 24, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.606 Vali Acc: 0.757 Test Loss: 0.606 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 25 cost time: 1.718207836151123
Epoch: 25, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.603 Vali Acc: 0.743 Test Loss: 0.603 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4226651191711426
Epoch: 26, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.597 Vali Acc: 0.737 Test Loss: 0.597 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8770720958709717
Epoch: 27, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.604 Vali Acc: 0.730 Test Loss: 0.604 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3792920112609863
Epoch: 28, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.606 Vali Acc: 0.737 Test Loss: 0.606 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.0698866844177246
Epoch: 29, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.598 Vali Acc: 0.737 Test Loss: 0.598 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8438446521759033
Epoch: 30, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.593 Vali Acc: 0.730 Test Loss: 0.593 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4279112815856934
Epoch: 31, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.584 Vali Acc: 0.730 Test Loss: 0.584 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5768203735351562
Epoch: 32, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.583 Vali Acc: 0.737 Test Loss: 0.583 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.633500337600708
Epoch: 33, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.582 Vali Acc: 0.750 Test Loss: 0.582 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.0819766521453857
Epoch: 34, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.756578947368421
model parameter : 31700
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.930558919906616
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.369 Vali Acc: 0.257 Test Loss: 1.369 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.3296692371368408
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.270 Vali Acc: 0.408 Test Loss: 1.270 Test Acc: 0.408
Validation loss decreased (-0.256565 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.3858790397644043
Epoch: 3, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.176 Vali Acc: 0.539 Test Loss: 1.176 Test Acc: 0.539
Validation loss decreased (-0.407882 --> -0.539462).  Saving model ...
Epoch: 4 cost time: 1.794590711593628
Epoch: 4, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.067 Vali Acc: 0.632 Test Loss: 1.067 Test Acc: 0.632
Validation loss decreased (-0.539462 --> -0.631568).  Saving model ...
Epoch: 5 cost time: 1.2497467994689941
Epoch: 5, Steps: 10 | Train Loss: 0.999 Vali Loss: 0.966 Vali Acc: 0.618 Test Loss: 0.966 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.196305274963379
Epoch: 6, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.870 Vali Acc: 0.638 Test Loss: 0.870 Test Acc: 0.638
Validation loss decreased (-0.631568 --> -0.638149).  Saving model ...
Epoch: 7 cost time: 1.5501906871795654
Epoch: 7, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.782 Vali Acc: 0.717 Test Loss: 0.782 Test Acc: 0.717
Validation loss decreased (-0.638149 --> -0.717097).  Saving model ...
Epoch: 8 cost time: 1.3928391933441162
Epoch: 8, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.706 Vali Acc: 0.724 Test Loss: 0.706 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723677).  Saving model ...
Epoch: 9 cost time: 1.400188684463501
Epoch: 9, Steps: 10 | Train Loss: 0.510 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.1138403415679932
Epoch: 10, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.3678319454193115
Epoch: 11, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.2462937831878662
Epoch: 12, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.2020235061645508
Epoch: 13, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.0858149528503418
Epoch: 14, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809206).  Saving model ...
Epoch: 15 cost time: 1.104423999786377
Epoch: 15, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.467 Vali Acc: 0.803 Test Loss: 0.467 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.263594150543213
Epoch: 16, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.482 Vali Acc: 0.789 Test Loss: 0.482 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1478519439697266
Epoch: 17, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.219177007675171
Epoch: 18, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2755162715911865
Epoch: 19, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3550548553466797
Epoch: 20, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 21 cost time: 1.6971931457519531
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7276391983032227
Epoch: 22, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4807374477386475
Epoch: 23, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3748743534088135
Epoch: 24, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2679247856140137
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.642827033996582
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5440373420715332
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4274559020996094
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.238765001296997
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5274648666381836
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 27764
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.196558713912964
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.413 Vali Acc: 0.263 Test Loss: 1.413 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.5136516094207764
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.364 Vali Acc: 0.276 Test Loss: 1.364 Test Acc: 0.276
Validation loss decreased (-0.263144 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 1.1177048683166504
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.297 Vali Acc: 0.395 Test Loss: 1.297 Test Acc: 0.395
Validation loss decreased (-0.276302 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 1.170412540435791
Epoch: 4, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.394724 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.230565071105957
Epoch: 5, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.130 Vali Acc: 0.592 Test Loss: 1.130 Test Acc: 0.592
Validation loss decreased (-0.499988 --> -0.592094).  Saving model ...
Epoch: 6 cost time: 1.2663874626159668
Epoch: 6, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.045 Vali Acc: 0.612 Test Loss: 1.045 Test Acc: 0.612
Validation loss decreased (-0.592094 --> -0.611832).  Saving model ...
Epoch: 7 cost time: 1.0535063743591309
Epoch: 7, Steps: 10 | Train Loss: 0.878 Vali Loss: 0.964 Vali Acc: 0.664 Test Loss: 0.964 Test Acc: 0.664
Validation loss decreased (-0.611832 --> -0.664464).  Saving model ...
Epoch: 8 cost time: 1.2610728740692139
Epoch: 8, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.888 Vali Acc: 0.697 Test Loss: 0.888 Test Acc: 0.697
Validation loss decreased (-0.664464 --> -0.697360).  Saving model ...
Epoch: 9 cost time: 1.367631435394287
Epoch: 9, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.818 Vali Acc: 0.711 Test Loss: 0.818 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710518).  Saving model ...
Epoch: 10 cost time: 1.350151777267456
Epoch: 10, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.755 Vali Acc: 0.724 Test Loss: 0.755 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 1.2730095386505127
Epoch: 11, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.703 Vali Acc: 0.737 Test Loss: 0.703 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 1.3084332942962646
Epoch: 12, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 1.3567695617675781
Epoch: 13, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 14 cost time: 1.3617608547210693
Epoch: 14, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.598 Vali Acc: 0.743 Test Loss: 0.598 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 1.6297378540039062
Epoch: 15, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.3467247486114502
Epoch: 16, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.6777620315551758
Epoch: 17, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769732).  Saving model ...
Epoch: 18 cost time: 1.4150424003601074
Epoch: 18, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.514 Vali Acc: 0.789 Test Loss: 0.514 Test Acc: 0.789
Validation loss decreased (-0.769732 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 1.3296453952789307
Epoch: 19, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 20 cost time: 1.6519408226013184
Epoch: 20, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 21 cost time: 1.3208341598510742
Epoch: 21, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 22 cost time: 1.297053337097168
Epoch: 22, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 23 cost time: 1.1582505702972412
Epoch: 23, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.489 Vali Acc: 0.809 Test Loss: 0.489 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7443106174468994
Epoch: 24, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 25 cost time: 1.2426214218139648
Epoch: 25, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 26 cost time: 1.555725336074829
Epoch: 26, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 27 cost time: 1.4189140796661377
Epoch: 27, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.480 Vali Acc: 0.822 Test Loss: 0.480 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 28 cost time: 1.7560677528381348
Epoch: 28, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4462370872497559
Epoch: 29, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.487 Vali Acc: 0.822 Test Loss: 0.487 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3904595375061035
Epoch: 30, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.487 Vali Acc: 0.822 Test Loss: 0.487 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6182465553283691
Epoch: 31, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.495269775390625
Epoch: 32, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.500 Vali Acc: 0.822 Test Loss: 0.500 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.641972303390503
Epoch: 33, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.510 Vali Acc: 0.829 Test Loss: 0.510 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 34 cost time: 1.5702838897705078
Epoch: 34, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.577260971069336
Epoch: 35, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.360184907913208
Epoch: 36, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.506 Vali Acc: 0.829 Test Loss: 0.506 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 37 cost time: 1.630596399307251
Epoch: 37, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.508 Vali Acc: 0.829 Test Loss: 0.508 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5874109268188477
Epoch: 38, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.820225715637207
Epoch: 39, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.507 Vali Acc: 0.829 Test Loss: 0.507 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7834622859954834
Epoch: 40, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.524 Vali Acc: 0.829 Test Loss: 0.524 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5055718421936035
Epoch: 41, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.534 Vali Acc: 0.829 Test Loss: 0.534 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6784555912017822
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.530 Vali Acc: 0.836 Test Loss: 0.530 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 43 cost time: 1.3072149753570557
Epoch: 43, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.524 Vali Acc: 0.836 Test Loss: 0.524 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 44 cost time: 1.616816520690918
Epoch: 44, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.519 Vali Acc: 0.836 Test Loss: 0.519 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 45 cost time: 1.567230463027954
Epoch: 45, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.531 Vali Acc: 0.836 Test Loss: 0.531 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.421471118927002
Epoch: 46, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.524 Vali Acc: 0.842 Test Loss: 0.524 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 47 cost time: 1.6430118083953857
Epoch: 47, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.533 Vali Acc: 0.836 Test Loss: 0.533 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.627809762954712
Epoch: 48, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.555 Vali Acc: 0.829 Test Loss: 0.555 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.42574143409729
Epoch: 49, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.540 Vali Acc: 0.829 Test Loss: 0.540 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.291156530380249
Epoch: 50, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.538 Vali Acc: 0.829 Test Loss: 0.538 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.5523059368133545
Epoch: 51, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.542 Vali Acc: 0.829 Test Loss: 0.542 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.4465932846069336
Epoch: 52, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.545 Vali Acc: 0.836 Test Loss: 0.545 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.6267979145050049
Epoch: 53, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.559 Vali Acc: 0.829 Test Loss: 0.559 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.4083709716796875
Epoch: 54, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.570 Vali Acc: 0.829 Test Loss: 0.570 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.9634981155395508
Epoch: 55, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.579 Vali Acc: 0.829 Test Loss: 0.579 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.623234748840332
Epoch: 56, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.569 Vali Acc: 0.836 Test Loss: 0.569 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 22020
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4236085414886475
Epoch: 1, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.284 Vali Acc: 0.375 Test Loss: 1.284 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.2959842681884766
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.234 Vali Acc: 0.454 Test Loss: 1.234 Test Acc: 0.454
Validation loss decreased (-0.374987 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 1.2645142078399658
Epoch: 3, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.172 Vali Acc: 0.493 Test Loss: 1.172 Test Acc: 0.493
Validation loss decreased (-0.453935 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 1.436507225036621
Epoch: 4, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.105 Vali Acc: 0.533 Test Loss: 1.105 Test Acc: 0.533
Validation loss decreased (-0.493409 --> -0.532884).  Saving model ...
Epoch: 5 cost time: 1.2363693714141846
Epoch: 5, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.036 Vali Acc: 0.612 Test Loss: 1.036 Test Acc: 0.612
Validation loss decreased (-0.532884 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 1.4699029922485352
Epoch: 6, Steps: 10 | Train Loss: 1.009 Vali Loss: 0.965 Vali Acc: 0.651 Test Loss: 0.965 Test Acc: 0.651
Validation loss decreased (-0.611832 --> -0.651306).  Saving model ...
Epoch: 7 cost time: 1.2654435634613037
Epoch: 7, Steps: 10 | Train Loss: 0.901 Vali Loss: 0.900 Vali Acc: 0.671 Test Loss: 0.900 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671044).  Saving model ...
Epoch: 8 cost time: 1.3464076519012451
Epoch: 8, Steps: 10 | Train Loss: 0.853 Vali Loss: 0.841 Vali Acc: 0.691 Test Loss: 0.841 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690781).  Saving model ...
Epoch: 9 cost time: 1.1134381294250488
Epoch: 9, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.787 Vali Acc: 0.684 Test Loss: 0.787 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.258845329284668
Epoch: 10, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.738 Vali Acc: 0.730 Test Loss: 0.738 Test Acc: 0.730
Validation loss decreased (-0.690781 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.1935415267944336
Epoch: 11, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.694 Vali Acc: 0.743 Test Loss: 0.694 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 1.2981231212615967
Epoch: 12, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.654 Vali Acc: 0.743 Test Loss: 0.654 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 13 cost time: 1.2704899311065674
Epoch: 13, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.621 Vali Acc: 0.757 Test Loss: 0.621 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.493164300918579
Epoch: 14, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.4838166236877441
Epoch: 15, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.3294994831085205
Epoch: 16, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
Validation loss decreased (-0.776310 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 1.3069770336151123
Epoch: 17, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2199344635009766
Epoch: 18, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 19 cost time: 1.2769765853881836
Epoch: 19, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 20 cost time: 1.385831356048584
Epoch: 20, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 21 cost time: 1.3701081275939941
Epoch: 21, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 22 cost time: 1.6621129512786865
Epoch: 22, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5724265575408936
Epoch: 23, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 24 cost time: 1.5739145278930664
Epoch: 24, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.471 Vali Acc: 0.796 Test Loss: 0.471 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6773128509521484
Epoch: 25, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3711879253387451
Epoch: 26, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.460 Vali Acc: 0.809 Test Loss: 0.460 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 27 cost time: 1.2218222618103027
Epoch: 27, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.457 Vali Acc: 0.803 Test Loss: 0.457 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.057966709136963
Epoch: 28, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.457 Vali Acc: 0.809 Test Loss: 0.457 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 29 cost time: 1.3270001411437988
Epoch: 29, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.451 Vali Acc: 0.822 Test Loss: 0.451 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 30 cost time: 1.7471907138824463
Epoch: 30, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 31 cost time: 1.4952733516693115
Epoch: 31, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.442 Vali Acc: 0.822 Test Loss: 0.442 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 32 cost time: 1.7123162746429443
Epoch: 32, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.439 Vali Acc: 0.822 Test Loss: 0.439 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 33 cost time: 1.607301950454712
Epoch: 33, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.439 Vali Acc: 0.803 Test Loss: 0.439 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3771576881408691
Epoch: 34, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.441 Vali Acc: 0.809 Test Loss: 0.441 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2857177257537842
Epoch: 35, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.445 Vali Acc: 0.796 Test Loss: 0.445 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5574793815612793
Epoch: 36, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.449 Vali Acc: 0.809 Test Loss: 0.449 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5648863315582275
Epoch: 37, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.450 Vali Acc: 0.809 Test Loss: 0.450 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3814537525177002
Epoch: 38, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.451 Vali Acc: 0.803 Test Loss: 0.451 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.5159990787506104
Epoch: 39, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2299649715423584
Epoch: 40, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.452 Vali Acc: 0.816 Test Loss: 0.452 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.527540683746338
Epoch: 41, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.4783761501312256
Epoch: 42, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.452 Vali Acc: 0.809 Test Loss: 0.452 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 20132
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6554830074310303
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.360 Vali Acc: 0.368 Test Loss: 1.360 Test Acc: 0.368
Validation loss decreased (inf --> -0.368407).  Saving model ...
Epoch: 2 cost time: 1.6548140048980713
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.318 Vali Acc: 0.388 Test Loss: 1.318 Test Acc: 0.388
Validation loss decreased (-0.368407 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.53410005569458
Epoch: 3, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.269 Vali Acc: 0.401 Test Loss: 1.269 Test Acc: 0.401
Validation loss decreased (-0.388145 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 1.742478847503662
Epoch: 4, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
Validation loss decreased (-0.401303 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.7464485168457031
Epoch: 5, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.148 Vali Acc: 0.513 Test Loss: 1.148 Test Acc: 0.513
Validation loss decreased (-0.499988 --> -0.513146).  Saving model ...
Epoch: 6 cost time: 1.810483455657959
Epoch: 6, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.083 Vali Acc: 0.559 Test Loss: 1.083 Test Acc: 0.559
Validation loss decreased (-0.513146 --> -0.559200).  Saving model ...
Epoch: 7 cost time: 1.789898157119751
Epoch: 7, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.020 Vali Acc: 0.605 Test Loss: 1.020 Test Acc: 0.605
Validation loss decreased (-0.559200 --> -0.605253).  Saving model ...
Epoch: 8 cost time: 1.836442232131958
Epoch: 8, Steps: 10 | Train Loss: 0.879 Vali Loss: 0.956 Vali Acc: 0.625 Test Loss: 0.956 Test Acc: 0.625
Validation loss decreased (-0.605253 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 1.5673542022705078
Epoch: 9, Steps: 10 | Train Loss: 0.769 Vali Loss: 0.896 Vali Acc: 0.638 Test Loss: 0.896 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638149).  Saving model ...
Epoch: 10 cost time: 1.7919046878814697
Epoch: 10, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.835 Vali Acc: 0.671 Test Loss: 0.835 Test Acc: 0.671
Validation loss decreased (-0.638149 --> -0.671044).  Saving model ...
Epoch: 11 cost time: 1.9227993488311768
Epoch: 11, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.776 Vali Acc: 0.691 Test Loss: 0.776 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690782).  Saving model ...
Epoch: 12 cost time: 1.694303274154663
Epoch: 12, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.733 Vali Acc: 0.691 Test Loss: 0.733 Test Acc: 0.691
Validation loss decreased (-0.690782 --> -0.690782).  Saving model ...
Epoch: 13 cost time: 1.5135893821716309
Epoch: 13, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 14 cost time: 1.433769702911377
Epoch: 14, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.655 Vali Acc: 0.711 Test Loss: 0.655 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8465466499328613
Epoch: 15, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.631 Vali Acc: 0.743 Test Loss: 0.631 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743415).  Saving model ...
Epoch: 16 cost time: 1.5527586936950684
Epoch: 16, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.1398234367370605
Epoch: 17, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.657182216644287
Epoch: 18, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.404407262802124
Epoch: 19, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 20 cost time: 1.703223705291748
Epoch: 20, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809205).  Saving model ...
Epoch: 21 cost time: 1.699141025543213
Epoch: 21, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4612390995025635
Epoch: 22, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 23 cost time: 1.259000301361084
Epoch: 23, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 24 cost time: 1.3335492610931396
Epoch: 24, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3497815132141113
Epoch: 25, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 26 cost time: 1.852611780166626
Epoch: 26, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 27 cost time: 1.5187902450561523
Epoch: 27, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 28 cost time: 1.5797195434570312
Epoch: 28, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6569530963897705
Epoch: 29, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1656982898712158
Epoch: 30, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.37969970703125
Epoch: 31, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.618380069732666
Epoch: 32, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.389157772064209
Epoch: 33, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3570914268493652
Epoch: 34, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.501164197921753
Epoch: 35, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3616032600402832
Epoch: 36, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.8362600803375244
Epoch: 37, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.504 Vali Acc: 0.836 Test Loss: 0.504 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 38 cost time: 1.6649420261383057
Epoch: 38, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.504 Vali Acc: 0.836 Test Loss: 0.504 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7142808437347412
Epoch: 39, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.507 Vali Acc: 0.836 Test Loss: 0.507 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3073878288269043
Epoch: 40, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.506 Vali Acc: 0.836 Test Loss: 0.506 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4226610660552979
Epoch: 41, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.510 Vali Acc: 0.829 Test Loss: 0.510 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.4596662521362305
Epoch: 42, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.511 Vali Acc: 0.836 Test Loss: 0.511 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.5229628086090088
Epoch: 43, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.523 Vali Acc: 0.829 Test Loss: 0.523 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.324228048324585
Epoch: 44, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.521 Vali Acc: 0.829 Test Loss: 0.521 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.5586085319519043
Epoch: 45, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.4791572093963623
Epoch: 46, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.518 Vali Acc: 0.822 Test Loss: 0.518 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.4143116474151611
Epoch: 47, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.533 Vali Acc: 0.829 Test Loss: 0.533 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 20148
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7428646087646484
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.483 Vali Acc: 0.270 Test Loss: 1.483 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 1.3043155670166016
Epoch: 2, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.388 Vali Acc: 0.336 Test Loss: 1.388 Test Acc: 0.336
Validation loss decreased (-0.269722 --> -0.335512).  Saving model ...
Epoch: 3 cost time: 1.6299798488616943
Epoch: 3, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.325 Vali Acc: 0.408 Test Loss: 1.325 Test Acc: 0.408
Validation loss decreased (-0.335512 --> -0.407881).  Saving model ...
Epoch: 4 cost time: 1.169396162033081
Epoch: 4, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.269 Vali Acc: 0.480 Test Loss: 1.269 Test Acc: 0.480
Validation loss decreased (-0.407881 --> -0.480250).  Saving model ...
Epoch: 5 cost time: 1.5285708904266357
Epoch: 5, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.480250 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.4516236782073975
Epoch: 6, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.155 Vali Acc: 0.539 Test Loss: 1.155 Test Acc: 0.539
Validation loss decreased (-0.499988 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 1.6401524543762207
Epoch: 7, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.099 Vali Acc: 0.539 Test Loss: 1.099 Test Acc: 0.539
Validation loss decreased (-0.539462 --> -0.539463).  Saving model ...
Epoch: 8 cost time: 1.6299738883972168
Epoch: 8, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.045 Vali Acc: 0.559 Test Loss: 1.045 Test Acc: 0.559
Validation loss decreased (-0.539463 --> -0.559200).  Saving model ...
Epoch: 9 cost time: 1.73115873336792
Epoch: 9, Steps: 10 | Train Loss: 0.860 Vali Loss: 0.993 Vali Acc: 0.579 Test Loss: 0.993 Test Acc: 0.579
Validation loss decreased (-0.559200 --> -0.578937).  Saving model ...
Epoch: 10 cost time: 1.2251393795013428
Epoch: 10, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.942 Vali Acc: 0.592 Test Loss: 0.942 Test Acc: 0.592
Validation loss decreased (-0.578937 --> -0.592096).  Saving model ...
Epoch: 11 cost time: 1.3545973300933838
Epoch: 11, Steps: 10 | Train Loss: 0.741 Vali Loss: 0.896 Vali Acc: 0.632 Test Loss: 0.896 Test Acc: 0.632
Validation loss decreased (-0.592096 --> -0.631570).  Saving model ...
Epoch: 12 cost time: 1.1449909210205078
Epoch: 12, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.851 Vali Acc: 0.645 Test Loss: 0.851 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644728).  Saving model ...
Epoch: 13 cost time: 1.1824183464050293
Epoch: 13, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.813 Vali Acc: 0.645 Test Loss: 0.813 Test Acc: 0.645
Validation loss decreased (-0.644728 --> -0.644729).  Saving model ...
Epoch: 14 cost time: 1.0761749744415283
Epoch: 14, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.775 Vali Acc: 0.651 Test Loss: 0.775 Test Acc: 0.651
Validation loss decreased (-0.644729 --> -0.651308).  Saving model ...
Epoch: 15 cost time: 1.4766483306884766
Epoch: 15, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.750 Vali Acc: 0.658 Test Loss: 0.750 Test Acc: 0.658
Validation loss decreased (-0.651308 --> -0.657887).  Saving model ...
Epoch: 16 cost time: 1.4984095096588135
Epoch: 16, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.725 Vali Acc: 0.671 Test Loss: 0.725 Test Acc: 0.671
Validation loss decreased (-0.657887 --> -0.671045).  Saving model ...
Epoch: 17 cost time: 1.153852939605713
Epoch: 17, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.695 Vali Acc: 0.691 Test Loss: 0.695 Test Acc: 0.691
Validation loss decreased (-0.671045 --> -0.690783).  Saving model ...
Epoch: 18 cost time: 1.2033300399780273
Epoch: 18, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.670 Vali Acc: 0.704 Test Loss: 0.670 Test Acc: 0.704
Validation loss decreased (-0.690783 --> -0.703941).  Saving model ...
Epoch: 19 cost time: 1.2382838726043701
Epoch: 19, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.654 Vali Acc: 0.711 Test Loss: 0.654 Test Acc: 0.711
Validation loss decreased (-0.703941 --> -0.710520).  Saving model ...
Epoch: 20 cost time: 1.267629623413086
Epoch: 20, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.642 Vali Acc: 0.724 Test Loss: 0.642 Test Acc: 0.724
Validation loss decreased (-0.710520 --> -0.723678).  Saving model ...
Epoch: 21 cost time: 1.2245190143585205
Epoch: 21, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.626 Vali Acc: 0.730 Test Loss: 0.626 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 22 cost time: 1.7048938274383545
Epoch: 22, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 23 cost time: 1.1191542148590088
Epoch: 23, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 24 cost time: 1.4517574310302734
Epoch: 24, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 25 cost time: 1.736098289489746
Epoch: 25, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 1.5298230648040771
Epoch: 26, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.579 Vali Acc: 0.763 Test Loss: 0.579 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 27 cost time: 1.3124911785125732
Epoch: 27, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.577 Vali Acc: 0.757 Test Loss: 0.577 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3895611763000488
Epoch: 28, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.571 Vali Acc: 0.757 Test Loss: 0.571 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.360025405883789
Epoch: 29, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.566 Vali Acc: 0.763 Test Loss: 0.566 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 30 cost time: 1.620917797088623
Epoch: 30, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 31 cost time: 1.7561392784118652
Epoch: 31, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 32 cost time: 1.5830926895141602
Epoch: 32, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.555 Vali Acc: 0.763 Test Loss: 0.555 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6374874114990234
Epoch: 33, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.557 Vali Acc: 0.757 Test Loss: 0.557 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7717466354370117
Epoch: 34, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.557 Vali Acc: 0.763 Test Loss: 0.557 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.560060977935791
Epoch: 35, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.8620681762695312
Epoch: 36, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.746617317199707
Epoch: 37, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.558 Vali Acc: 0.763 Test Loss: 0.558 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4666235446929932
Epoch: 38, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.556 Vali Acc: 0.757 Test Loss: 0.556 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4984877109527588
Epoch: 39, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2785711288452148
Epoch: 40, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.561 Vali Acc: 0.757 Test Loss: 0.561 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.329420566558838
Epoch: 41, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.563 Vali Acc: 0.757 Test Loss: 0.563 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 19028
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5342259407043457
Epoch: 1, Steps: 10 | Train Loss: 1.652 Vali Loss: 1.566 Vali Acc: 0.158 Test Loss: 1.566 Test Acc: 0.158
Validation loss decreased (inf --> -0.157879).  Saving model ...
Epoch: 2 cost time: 1.4535934925079346
Epoch: 2, Steps: 10 | Train Loss: 1.526 Vali Loss: 1.476 Vali Acc: 0.230 Test Loss: 1.476 Test Acc: 0.230
Validation loss decreased (-0.157879 --> -0.230248).  Saving model ...
Epoch: 3 cost time: 1.5371241569519043
Epoch: 3, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.354 Vali Acc: 0.329 Test Loss: 1.354 Test Acc: 0.329
Validation loss decreased (-0.230248 --> -0.328934).  Saving model ...
Epoch: 4 cost time: 1.3969073295593262
Epoch: 4, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.217 Vali Acc: 0.513 Test Loss: 1.217 Test Acc: 0.513
Validation loss decreased (-0.328934 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 1.6828243732452393
Epoch: 5, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.086 Vali Acc: 0.605 Test Loss: 1.086 Test Acc: 0.605
Validation loss decreased (-0.513146 --> -0.605252).  Saving model ...
Epoch: 6 cost time: 1.3486216068267822
Epoch: 6, Steps: 10 | Train Loss: 0.899 Vali Loss: 0.971 Vali Acc: 0.658 Test Loss: 0.971 Test Acc: 0.658
Validation loss decreased (-0.605252 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 1.669065237045288
Epoch: 7, Steps: 10 | Train Loss: 0.752 Vali Loss: 0.877 Vali Acc: 0.671 Test Loss: 0.877 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671044).  Saving model ...
Epoch: 8 cost time: 1.4696745872497559
Epoch: 8, Steps: 10 | Train Loss: 0.652 Vali Loss: 0.790 Vali Acc: 0.678 Test Loss: 0.790 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677624).  Saving model ...
Epoch: 9 cost time: 1.6662206649780273
Epoch: 9, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.720 Vali Acc: 0.711 Test Loss: 0.720 Test Acc: 0.711
Validation loss decreased (-0.677624 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.2358620166778564
Epoch: 10, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.661 Vali Acc: 0.717 Test Loss: 0.661 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717099).  Saving model ...
Epoch: 11 cost time: 1.400554895401001
Epoch: 11, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.612 Vali Acc: 0.743 Test Loss: 0.612 Test Acc: 0.743
Validation loss decreased (-0.717099 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.5120487213134766
Epoch: 12, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.4232943058013916
Epoch: 13, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.183046817779541
Epoch: 14, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.4210386276245117
Epoch: 15, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.4259319305419922
Epoch: 16, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.498 Vali Acc: 0.796 Test Loss: 0.498 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4109785556793213
Epoch: 17, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.2612321376800537
Epoch: 18, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3937816619873047
Epoch: 19, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 20 cost time: 1.4248137474060059
Epoch: 20, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2046411037445068
Epoch: 21, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 22 cost time: 1.628340482711792
Epoch: 22, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7730157375335693
Epoch: 23, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.46278715133667
Epoch: 24, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3977692127227783
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6441261768341064
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3847110271453857
Epoch: 27, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3769922256469727
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.510 Vali Acc: 0.822 Test Loss: 0.510 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5674362182617188
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3999252319335938
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5174908638000488
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 21428
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.226184844970703
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.376 Vali Acc: 0.289 Test Loss: 1.376 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.3218626976013184
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.311 Vali Acc: 0.362 Test Loss: 1.311 Test Acc: 0.362
Validation loss decreased (-0.289460 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.3648760318756104
Epoch: 3, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.243 Vali Acc: 0.474 Test Loss: 1.243 Test Acc: 0.474
Validation loss decreased (-0.361829 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 1.5177836418151855
Epoch: 4, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.160 Vali Acc: 0.572 Test Loss: 1.160 Test Acc: 0.572
Validation loss decreased (-0.473672 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 1.291900873184204
Epoch: 5, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.073 Vali Acc: 0.632 Test Loss: 1.073 Test Acc: 0.632
Validation loss decreased (-0.572357 --> -0.631568).  Saving model ...
Epoch: 6 cost time: 1.4084219932556152
Epoch: 6, Steps: 10 | Train Loss: 0.940 Vali Loss: 0.993 Vali Acc: 0.664 Test Loss: 0.993 Test Acc: 0.664
Validation loss decreased (-0.631568 --> -0.664464).  Saving model ...
Epoch: 7 cost time: 1.653644323348999
Epoch: 7, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.914 Vali Acc: 0.684 Test Loss: 0.914 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 8 cost time: 1.596937894821167
Epoch: 8, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.842 Vali Acc: 0.671 Test Loss: 0.842 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5276482105255127
Epoch: 9, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.775 Vali Acc: 0.717 Test Loss: 0.775 Test Acc: 0.717
Validation loss decreased (-0.684201 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 1.4147613048553467
Epoch: 10, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.719 Vali Acc: 0.711 Test Loss: 0.719 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3857476711273193
Epoch: 11, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.661 Vali Acc: 0.717 Test Loss: 0.661 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717099).  Saving model ...
Epoch: 12 cost time: 1.3589229583740234
Epoch: 12, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.617 Vali Acc: 0.737 Test Loss: 0.617 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 1.6090714931488037
Epoch: 13, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.2466058731079102
Epoch: 14, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.3072929382324219
Epoch: 15, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.4910147190093994
Epoch: 16, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.2615580558776855
Epoch: 17, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802627).  Saving model ...
Epoch: 18 cost time: 1.512026071548462
Epoch: 18, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 19 cost time: 1.2886571884155273
Epoch: 19, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4113121032714844
Epoch: 20, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 21 cost time: 1.564499855041504
Epoch: 21, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.481 Vali Acc: 0.809 Test Loss: 0.481 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5535001754760742
Epoch: 22, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7527000904083252
Epoch: 23, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3301560878753662
Epoch: 24, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7510755062103271
Epoch: 25, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3060760498046875
Epoch: 26, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5198867321014404
Epoch: 27, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.9705538749694824
Epoch: 28, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8018991947174072
Epoch: 29, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 30 cost time: 1.6680994033813477
Epoch: 30, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.496 Vali Acc: 0.829 Test Loss: 0.496 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 31 cost time: 1.3175511360168457
Epoch: 31, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7317121028900146
Epoch: 32, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5153470039367676
Epoch: 33, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.513 Vali Acc: 0.822 Test Loss: 0.513 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.998906135559082
Epoch: 34, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.514 Vali Acc: 0.829 Test Loss: 0.514 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4765489101409912
Epoch: 35, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.517 Vali Acc: 0.829 Test Loss: 0.517 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3754785060882568
Epoch: 36, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.459404706954956
Epoch: 37, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.107323169708252
Epoch: 38, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.518 Vali Acc: 0.829 Test Loss: 0.518 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.81315279006958
Epoch: 39, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.5948460102081299
Epoch: 40, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 15684
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.80208158493042
Epoch: 1, Steps: 10 | Train Loss: 1.564 Vali Loss: 1.552 Vali Acc: 0.204 Test Loss: 1.552 Test Acc: 0.204
Validation loss decreased (inf --> -0.203932).  Saving model ...
Epoch: 2 cost time: 1.818171501159668
Epoch: 2, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.506 Vali Acc: 0.224 Test Loss: 1.506 Test Acc: 0.224
Validation loss decreased (-0.203932 --> -0.223669).  Saving model ...
Epoch: 3 cost time: 1.325490951538086
Epoch: 3, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.449 Vali Acc: 0.289 Test Loss: 1.449 Test Acc: 0.289
Validation loss decreased (-0.223669 --> -0.289459).  Saving model ...
Epoch: 4 cost time: 1.1711757183074951
Epoch: 4, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.381 Vali Acc: 0.329 Test Loss: 1.381 Test Acc: 0.329
Validation loss decreased (-0.289459 --> -0.328934).  Saving model ...
Epoch: 5 cost time: 1.2764086723327637
Epoch: 5, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.309 Vali Acc: 0.421 Test Loss: 1.309 Test Acc: 0.421
Validation loss decreased (-0.328934 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 1.4838480949401855
Epoch: 6, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.238 Vali Acc: 0.441 Test Loss: 1.238 Test Acc: 0.441
Validation loss decreased (-0.421040 --> -0.440777).  Saving model ...
Epoch: 7 cost time: 1.6339821815490723
Epoch: 7, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.164 Vali Acc: 0.474 Test Loss: 1.164 Test Acc: 0.474
Validation loss decreased (-0.440777 --> -0.473673).  Saving model ...
Epoch: 8 cost time: 1.70851731300354
Epoch: 8, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.093 Vali Acc: 0.513 Test Loss: 1.093 Test Acc: 0.513
Validation loss decreased (-0.473673 --> -0.513147).  Saving model ...
Epoch: 9 cost time: 1.6612672805786133
Epoch: 9, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.025 Vali Acc: 0.572 Test Loss: 1.025 Test Acc: 0.572
Validation loss decreased (-0.513147 --> -0.572358).  Saving model ...
Epoch: 10 cost time: 1.5218257904052734
Epoch: 10, Steps: 10 | Train Loss: 0.825 Vali Loss: 0.959 Vali Acc: 0.599 Test Loss: 0.959 Test Acc: 0.599
Validation loss decreased (-0.572358 --> -0.598675).  Saving model ...
Epoch: 11 cost time: 1.463801383972168
Epoch: 11, Steps: 10 | Train Loss: 0.767 Vali Loss: 0.900 Vali Acc: 0.645 Test Loss: 0.900 Test Acc: 0.645
Validation loss decreased (-0.598675 --> -0.644728).  Saving model ...
Epoch: 12 cost time: 1.2206411361694336
Epoch: 12, Steps: 10 | Train Loss: 0.650 Vali Loss: 0.840 Vali Acc: 0.691 Test Loss: 0.840 Test Acc: 0.691
Validation loss decreased (-0.644728 --> -0.690781).  Saving model ...
Epoch: 13 cost time: 1.479569673538208
Epoch: 13, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.791 Vali Acc: 0.691 Test Loss: 0.791 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690782).  Saving model ...
Epoch: 14 cost time: 1.373004674911499
Epoch: 14, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.744 Vali Acc: 0.730 Test Loss: 0.744 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 1.8813891410827637
Epoch: 15, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.693 Vali Acc: 0.737 Test Loss: 0.693 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 16 cost time: 1.4741675853729248
Epoch: 16, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.660 Vali Acc: 0.737 Test Loss: 0.660 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 17 cost time: 1.7523059844970703
Epoch: 17, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.628 Vali Acc: 0.763 Test Loss: 0.628 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.6687142848968506
Epoch: 18, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8805193901062012
Epoch: 19, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.583 Vali Acc: 0.757 Test Loss: 0.583 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.80287504196167
Epoch: 20, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 21 cost time: 1.8516476154327393
Epoch: 21, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 1.4862468242645264
Epoch: 22, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.542 Vali Acc: 0.763 Test Loss: 0.542 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9279351234436035
Epoch: 23, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 24 cost time: 1.5445327758789062
Epoch: 24, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 25 cost time: 1.5302772521972656
Epoch: 25, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802627).  Saving model ...
Epoch: 26 cost time: 1.44775390625
Epoch: 26, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3643648624420166
Epoch: 27, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.487 Vali Acc: 0.789 Test Loss: 0.487 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.608126163482666
Epoch: 28, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.486 Vali Acc: 0.796 Test Loss: 0.486 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7604753971099854
Epoch: 29, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 30 cost time: 1.7047789096832275
Epoch: 30, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 31 cost time: 1.737816333770752
Epoch: 31, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.477 Vali Acc: 0.803 Test Loss: 0.477 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 32 cost time: 2.248279094696045
Epoch: 32, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.935748815536499
Epoch: 33, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 34 cost time: 1.7302355766296387
Epoch: 34, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.343456268310547
Epoch: 35, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 36 cost time: 1.6955592632293701
Epoch: 36, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.472 Vali Acc: 0.816 Test Loss: 0.472 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 37 cost time: 2.11181640625
Epoch: 37, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.657850742340088
Epoch: 38, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.637681484222412
Epoch: 39, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.5744092464447021
Epoch: 40, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.483 Vali Acc: 0.816 Test Loss: 0.483 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.7607004642486572
Epoch: 41, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.481 Vali Acc: 0.809 Test Loss: 0.481 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.8224773406982422
Epoch: 42, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.8178229331970215
Epoch: 43, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.7064776420593262
Epoch: 44, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.487 Vali Acc: 0.822 Test Loss: 0.487 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 45 cost time: 1.6233298778533936
Epoch: 45, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.516648769378662
Epoch: 46, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.593411922454834
Epoch: 47, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.8938755989074707
Epoch: 48, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.6873488426208496
Epoch: 49, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.7854487895965576
Epoch: 50, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.6000580787658691
Epoch: 51, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.7929141521453857
Epoch: 52, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.502 Vali Acc: 0.829 Test Loss: 0.502 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 53 cost time: 1.715282917022705
Epoch: 53, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.528245449066162
Epoch: 54, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.7144474983215332
Epoch: 55, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.3925416469573975
Epoch: 56, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.514 Vali Acc: 0.829 Test Loss: 0.514 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.5501821041107178
Epoch: 57, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.517 Vali Acc: 0.829 Test Loss: 0.517 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.7070848941802979
Epoch: 58, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.585413932800293
Epoch: 59, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.4431402683258057
Epoch: 60, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.510 Vali Acc: 0.829 Test Loss: 0.510 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.5042181015014648
Epoch: 61, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.517 Vali Acc: 0.829 Test Loss: 0.517 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.4776372909545898
Epoch: 62, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.521 Vali Acc: 0.829 Test Loss: 0.521 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 13796
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.6259238719940186
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.401 Vali Acc: 0.263 Test Loss: 1.401 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.153059482574463
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.369 Vali Acc: 0.270 Test Loss: 1.369 Test Acc: 0.270
Validation loss decreased (-0.263144 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.1012029647827148
Epoch: 3, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.323 Vali Acc: 0.342 Test Loss: 1.323 Test Acc: 0.342
Validation loss decreased (-0.269723 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.2514803409576416
Epoch: 4, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.269 Vali Acc: 0.414 Test Loss: 1.269 Test Acc: 0.414
Validation loss decreased (-0.342092 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 1.4685580730438232
Epoch: 5, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.213 Vali Acc: 0.461 Test Loss: 1.213 Test Acc: 0.461
Validation loss decreased (-0.414461 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 1.2883522510528564
Epoch: 6, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.157 Vali Acc: 0.507 Test Loss: 1.157 Test Acc: 0.507
Validation loss decreased (-0.460514 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 1.6496260166168213
Epoch: 7, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.102 Vali Acc: 0.539 Test Loss: 1.102 Test Acc: 0.539
Validation loss decreased (-0.506567 --> -0.539463).  Saving model ...
Epoch: 8 cost time: 1.5238773822784424
Epoch: 8, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.046 Vali Acc: 0.599 Test Loss: 1.046 Test Acc: 0.599
Validation loss decreased (-0.539463 --> -0.598674).  Saving model ...
Epoch: 9 cost time: 1.6674256324768066
Epoch: 9, Steps: 10 | Train Loss: 0.889 Vali Loss: 0.989 Vali Acc: 0.612 Test Loss: 0.989 Test Acc: 0.612
Validation loss decreased (-0.598674 --> -0.611832).  Saving model ...
Epoch: 10 cost time: 1.3406329154968262
Epoch: 10, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.930 Vali Acc: 0.632 Test Loss: 0.930 Test Acc: 0.632
Validation loss decreased (-0.611832 --> -0.631570).  Saving model ...
Epoch: 11 cost time: 1.4247407913208008
Epoch: 11, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.875 Vali Acc: 0.651 Test Loss: 0.875 Test Acc: 0.651
Validation loss decreased (-0.631570 --> -0.651307).  Saving model ...
Epoch: 12 cost time: 1.3807346820831299
Epoch: 12, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.825 Vali Acc: 0.658 Test Loss: 0.825 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657886).  Saving model ...
Epoch: 13 cost time: 1.266625165939331
Epoch: 13, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.780 Vali Acc: 0.671 Test Loss: 0.780 Test Acc: 0.671
Validation loss decreased (-0.657886 --> -0.671045).  Saving model ...
Epoch: 14 cost time: 1.5248801708221436
Epoch: 14, Steps: 10 | Train Loss: 0.546 Vali Loss: 0.742 Vali Acc: 0.697 Test Loss: 0.742 Test Acc: 0.697
Validation loss decreased (-0.671045 --> -0.697361).  Saving model ...
Epoch: 15 cost time: 1.6992030143737793
Epoch: 15, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.703 Vali Acc: 0.730 Test Loss: 0.703 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 16 cost time: 1.8023159503936768
Epoch: 16, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.670 Vali Acc: 0.743 Test Loss: 0.670 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 17 cost time: 1.4124860763549805
Epoch: 17, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.647 Vali Acc: 0.743 Test Loss: 0.647 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 18 cost time: 1.274289608001709
Epoch: 18, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.630 Vali Acc: 0.763 Test Loss: 0.630 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 1.176532506942749
Epoch: 19, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.606 Vali Acc: 0.757 Test Loss: 0.606 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6629037857055664
Epoch: 20, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.594 Vali Acc: 0.757 Test Loss: 0.594 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.461289882659912
Epoch: 21, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4340236186981201
Epoch: 22, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.568 Vali Acc: 0.757 Test Loss: 0.568 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3301949501037598
Epoch: 23, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.557 Vali Acc: 0.757 Test Loss: 0.557 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3552169799804688
Epoch: 24, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.552 Vali Acc: 0.757 Test Loss: 0.552 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6012389659881592
Epoch: 25, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.546 Vali Acc: 0.763 Test Loss: 0.546 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 1.2309870719909668
Epoch: 26, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 27 cost time: 1.244046688079834
Epoch: 27, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.535 Vali Acc: 0.776 Test Loss: 0.535 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.2604379653930664
Epoch: 28, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 29 cost time: 1.7552602291107178
Epoch: 29, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.614832878112793
Epoch: 30, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4526002407073975
Epoch: 31, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1825261116027832
Epoch: 32, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 33 cost time: 1.5264832973480225
Epoch: 33, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 34 cost time: 1.2799746990203857
Epoch: 34, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4970371723175049
Epoch: 35, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.589406967163086
Epoch: 36, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2574100494384766
Epoch: 37, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2881512641906738
Epoch: 38, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4559745788574219
Epoch: 39, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1191635131835938
Epoch: 40, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.4970262050628662
Epoch: 41, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.554 Vali Acc: 0.789 Test Loss: 0.554 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.5585978031158447
Epoch: 42, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.6054365634918213
Epoch: 43, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 13812
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.407937288284302
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.432 Vali Acc: 0.270 Test Loss: 1.432 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.3250391483306885
Epoch: 2, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.401 Vali Acc: 0.303 Test Loss: 1.401 Test Acc: 0.303
Validation loss decreased (-0.269723 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.3456921577453613
Epoch: 3, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.366 Vali Acc: 0.322 Test Loss: 1.366 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 1.3629069328308105
Epoch: 4, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.325 Vali Acc: 0.336 Test Loss: 1.325 Test Acc: 0.336
Validation loss decreased (-0.322355 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 1.4293043613433838
Epoch: 5, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.280 Vali Acc: 0.382 Test Loss: 1.280 Test Acc: 0.382
Validation loss decreased (-0.335513 --> -0.381566).  Saving model ...
Epoch: 6 cost time: 1.7373297214508057
Epoch: 6, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.233 Vali Acc: 0.421 Test Loss: 1.233 Test Acc: 0.421
Validation loss decreased (-0.381566 --> -0.421040).  Saving model ...
Epoch: 7 cost time: 1.2884032726287842
Epoch: 7, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.185 Vali Acc: 0.441 Test Loss: 1.185 Test Acc: 0.441
Validation loss decreased (-0.421040 --> -0.440778).  Saving model ...
Epoch: 8 cost time: 1.1594867706298828
Epoch: 8, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.137 Vali Acc: 0.454 Test Loss: 1.137 Test Acc: 0.454
Validation loss decreased (-0.440778 --> -0.453936).  Saving model ...
Epoch: 9 cost time: 1.543898105621338
Epoch: 9, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.453936 --> -0.467094).  Saving model ...
Epoch: 10 cost time: 1.3398184776306152
Epoch: 10, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.467094 --> -0.532884).  Saving model ...
Epoch: 11 cost time: 1.5533452033996582
Epoch: 11, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.006 Vali Acc: 0.572 Test Loss: 1.006 Test Acc: 0.572
Validation loss decreased (-0.532884 --> -0.572358).  Saving model ...
Epoch: 12 cost time: 1.4097259044647217
Epoch: 12, Steps: 10 | Train Loss: 0.830 Vali Loss: 0.962 Vali Acc: 0.599 Test Loss: 0.962 Test Acc: 0.599
Validation loss decreased (-0.572358 --> -0.598675).  Saving model ...
Epoch: 13 cost time: 1.7262253761291504
Epoch: 13, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.920 Vali Acc: 0.612 Test Loss: 0.920 Test Acc: 0.612
Validation loss decreased (-0.598675 --> -0.611833).  Saving model ...
Epoch: 14 cost time: 1.4622397422790527
Epoch: 14, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.882 Vali Acc: 0.625 Test Loss: 0.882 Test Acc: 0.625
Validation loss decreased (-0.611833 --> -0.624991).  Saving model ...
Epoch: 15 cost time: 1.5032780170440674
Epoch: 15, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.847 Vali Acc: 0.638 Test Loss: 0.847 Test Acc: 0.638
Validation loss decreased (-0.624991 --> -0.638149).  Saving model ...
Epoch: 16 cost time: 1.3204593658447266
Epoch: 16, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.812 Vali Acc: 0.658 Test Loss: 0.812 Test Acc: 0.658
Validation loss decreased (-0.638149 --> -0.657887).  Saving model ...
Epoch: 17 cost time: 1.2833576202392578
Epoch: 17, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.780 Vali Acc: 0.671 Test Loss: 0.780 Test Acc: 0.671
Validation loss decreased (-0.657887 --> -0.671045).  Saving model ...
Epoch: 18 cost time: 1.553894281387329
Epoch: 18, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.749 Vali Acc: 0.711 Test Loss: 0.749 Test Acc: 0.711
Validation loss decreased (-0.671045 --> -0.710519).  Saving model ...
Epoch: 19 cost time: 1.3873345851898193
Epoch: 19, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.728 Vali Acc: 0.717 Test Loss: 0.728 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 20 cost time: 1.3323612213134766
Epoch: 20, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.709 Vali Acc: 0.743 Test Loss: 0.709 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 21 cost time: 1.2716283798217773
Epoch: 21, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.689 Vali Acc: 0.757 Test Loss: 0.689 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 22 cost time: 1.417144775390625
Epoch: 22, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.672 Vali Acc: 0.757 Test Loss: 0.672 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 23 cost time: 1.5569977760314941
Epoch: 23, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.652 Vali Acc: 0.763 Test Loss: 0.652 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 24 cost time: 1.3450491428375244
Epoch: 24, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.638 Vali Acc: 0.776 Test Loss: 0.638 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 25 cost time: 1.2909035682678223
Epoch: 25, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.628 Vali Acc: 0.776 Test Loss: 0.628 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 1.2620060443878174
Epoch: 26, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.616 Vali Acc: 0.776 Test Loss: 0.616 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 27 cost time: 1.3114094734191895
Epoch: 27, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.5202727317810059
Epoch: 28, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.597 Vali Acc: 0.776 Test Loss: 0.597 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 29 cost time: 1.3819799423217773
Epoch: 29, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 30 cost time: 1.4495642185211182
Epoch: 30, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.578 Vali Acc: 0.776 Test Loss: 0.578 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 31 cost time: 1.5545105934143066
Epoch: 31, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.521071434020996
Epoch: 32, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 1.5249500274658203
Epoch: 33, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3945684432983398
Epoch: 34, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 35 cost time: 1.152949333190918
Epoch: 35, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2474114894866943
Epoch: 36, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3297514915466309
Epoch: 37, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.566 Vali Acc: 0.770 Test Loss: 0.566 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4120824337005615
Epoch: 38, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3370342254638672
Epoch: 39, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.352027177810669
Epoch: 40, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.560 Vali Acc: 0.796 Test Loss: 0.560 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 41 cost time: 1.4738717079162598
Epoch: 41, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.563 Vali Acc: 0.789 Test Loss: 0.563 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6395938396453857
Epoch: 42, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7110140323638916
Epoch: 43, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6586534976959229
Epoch: 44, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.425260066986084
Epoch: 45, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.606062650680542
Epoch: 46, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.9197614192962646
Epoch: 47, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.522460699081421
Epoch: 48, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.5749456882476807
Epoch: 49, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.8944826126098633
Epoch: 50, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.600 Vali Acc: 0.776 Test Loss: 0.600 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 12692
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.169780492782593
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.163 Vali Acc: 0.461 Test Loss: 1.163 Test Acc: 0.461
Validation loss decreased (inf --> -0.460515).  Saving model ...
Epoch: 2 cost time: 1.285710096359253
Epoch: 2, Steps: 10 | Train Loss: 0.834 Vali Loss: 0.725 Vali Acc: 0.757 Test Loss: 0.725 Test Acc: 0.757
Validation loss decreased (-0.460515 --> -0.756572).  Saving model ...
Epoch: 3 cost time: 1.1595635414123535
Epoch: 3, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 4 cost time: 1.3178997039794922
Epoch: 4, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 5 cost time: 1.3407185077667236
Epoch: 5, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.474721908569336
Epoch: 6, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
Validation loss decreased (-0.789468 --> -0.815784).  Saving model ...
Epoch: 7 cost time: 1.284050703048706
Epoch: 7, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.665 Vali Acc: 0.796 Test Loss: 0.665 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6341331005096436
Epoch: 8, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.597 Vali Acc: 0.829 Test Loss: 0.597 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828941).  Saving model ...
Epoch: 9 cost time: 1.2803115844726562
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.702 Vali Acc: 0.816 Test Loss: 0.702 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4044256210327148
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.648 Vali Acc: 0.809 Test Loss: 0.648 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.58616304397583
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.771 Vali Acc: 0.809 Test Loss: 0.771 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.332705020904541
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.723 Vali Acc: 0.822 Test Loss: 0.723 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4476757049560547
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.751 Vali Acc: 0.822 Test Loss: 0.751 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4931859970092773
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.831 Vali Acc: 0.816 Test Loss: 0.831 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2057359218597412
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.822 Test Loss: 0.778 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2244787216186523
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.797 Vali Acc: 0.822 Test Loss: 0.797 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2443463802337646
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.833 Vali Acc: 0.822 Test Loss: 0.833 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5181961059570312
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.825 Vali Acc: 0.822 Test Loss: 0.825 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 357636
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.456760406494141
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.275 Vali Acc: 0.401 Test Loss: 1.275 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 1.5472521781921387
Epoch: 2, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.017 Vali Acc: 0.605 Test Loss: 1.017 Test Acc: 0.605
Validation loss decreased (-0.401303 --> -0.605253).  Saving model ...
Epoch: 3 cost time: 1.2104671001434326
Epoch: 3, Steps: 10 | Train Loss: 0.735 Vali Loss: 0.794 Vali Acc: 0.671 Test Loss: 0.794 Test Acc: 0.671
Validation loss decreased (-0.605253 --> -0.671045).  Saving model ...
Epoch: 4 cost time: 1.4154484272003174
Epoch: 4, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
Validation loss decreased (-0.671045 --> -0.717099).  Saving model ...
Epoch: 5 cost time: 1.0848238468170166
Epoch: 5, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.595 Vali Acc: 0.743 Test Loss: 0.595 Test Acc: 0.743
Validation loss decreased (-0.717099 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 1.2013111114501953
Epoch: 6, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
Validation loss decreased (-0.743415 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.609389305114746
Epoch: 7, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 8 cost time: 1.4794843196868896
Epoch: 8, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.600470781326294
Epoch: 9, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8292810916900635
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6351981163024902
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 12 cost time: 1.6121103763580322
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.669 Vali Acc: 0.803 Test Loss: 0.669 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.476667881011963
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.657 Vali Acc: 0.809 Test Loss: 0.657 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4148480892181396
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.670 Vali Acc: 0.809 Test Loss: 0.670 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5762267112731934
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.711 Vali Acc: 0.803 Test Loss: 0.711 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.297837257385254
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.699 Vali Acc: 0.816 Test Loss: 0.699 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815782).  Saving model ...
Epoch: 17 cost time: 1.193302869796753
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.695 Vali Acc: 0.809 Test Loss: 0.695 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4888889789581299
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5625996589660645
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.704 Vali Acc: 0.822 Test Loss: 0.704 Test Acc: 0.822
Validation loss decreased (-0.815782 --> -0.822361).  Saving model ...
Epoch: 20 cost time: 1.6255924701690674
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.726 Vali Acc: 0.816 Test Loss: 0.726 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6193428039550781
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.822 Test Loss: 0.744 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5709891319274902
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.753 Vali Acc: 0.822 Test Loss: 0.753 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.568880558013916
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.764 Vali Acc: 0.822 Test Loss: 0.764 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4090192317962646
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.757 Vali Acc: 0.822 Test Loss: 0.757 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.553020715713501
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.822 Test Loss: 0.764 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4802014827728271
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.822 Test Loss: 0.769 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2786664962768555
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.822 Test Loss: 0.776 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6863737106323242
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.829 Test Loss: 0.782 Test Acc: 0.829
Validation loss decreased (-0.822361 --> -0.828940).  Saving model ...
Epoch: 29 cost time: 1.5575637817382812
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.789 Vali Acc: 0.836 Test Loss: 0.789 Test Acc: 0.836
Validation loss decreased (-0.828940 --> -0.835518).  Saving model ...
Epoch: 30 cost time: 1.5441060066223145
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.822 Test Loss: 0.785 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.655839443206787
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.829 Test Loss: 0.791 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5143458843231201
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.795 Vali Acc: 0.829 Test Loss: 0.795 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.614222764968872
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.799 Vali Acc: 0.829 Test Loss: 0.799 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3570778369903564
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.829 Test Loss: 0.803 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.275681734085083
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.829 Test Loss: 0.814 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2138094902038574
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.829 Test Loss: 0.824 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.6167261600494385
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.829 Test Loss: 0.821 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.5043613910675049
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.825 Vali Acc: 0.829 Test Loss: 0.825 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3839361667633057
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.829 Test Loss: 0.832 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 311684
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.020082235336304
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.292 Vali Acc: 0.349 Test Loss: 1.292 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.4671356678009033
Epoch: 2, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.029 Vali Acc: 0.559 Test Loss: 1.029 Test Acc: 0.559
Validation loss decreased (-0.348671 --> -0.559200).  Saving model ...
Epoch: 3 cost time: 1.3844289779663086
Epoch: 3, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.832 Vali Acc: 0.664 Test Loss: 0.832 Test Acc: 0.664
Validation loss decreased (-0.559200 --> -0.664465).  Saving model ...
Epoch: 4 cost time: 1.2761421203613281
Epoch: 4, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.699 Vali Acc: 0.711 Test Loss: 0.699 Test Acc: 0.711
Validation loss decreased (-0.664465 --> -0.710519).  Saving model ...
Epoch: 5 cost time: 1.411269187927246
Epoch: 5, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.628 Vali Acc: 0.730 Test Loss: 0.628 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730257).  Saving model ...
Epoch: 6 cost time: 1.2661919593811035
Epoch: 6, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
Validation loss decreased (-0.730257 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.3321995735168457
Epoch: 7, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.534 Vali Acc: 0.770 Test Loss: 0.534 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 8 cost time: 1.1285772323608398
Epoch: 8, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.769732 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.2998342514038086
Epoch: 9, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.5240166187286377
Epoch: 10, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 1.3103737831115723
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2178142070770264
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1650819778442383
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4804706573486328
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2789831161499023
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5770628452301025
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.593 Vali Acc: 0.816 Test Loss: 0.593 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1704933643341064
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2039241790771484
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4375269412994385
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6700396537780762
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.617 Vali Acc: 0.803 Test Loss: 0.617 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 296580
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.367672443389893
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.319 Vali Acc: 0.375 Test Loss: 1.319 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.3038108348846436
Epoch: 2, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.068 Vali Acc: 0.546 Test Loss: 1.068 Test Acc: 0.546
Validation loss decreased (-0.374987 --> -0.546042).  Saving model ...
Epoch: 3 cost time: 1.0128233432769775
Epoch: 3, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.866 Vali Acc: 0.638 Test Loss: 0.866 Test Acc: 0.638
Validation loss decreased (-0.546042 --> -0.638149).  Saving model ...
Epoch: 4 cost time: 1.3427257537841797
Epoch: 4, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.701 Vali Acc: 0.724 Test Loss: 0.701 Test Acc: 0.724
Validation loss decreased (-0.638149 --> -0.723677).  Saving model ...
Epoch: 5 cost time: 0.9891953468322754
Epoch: 5, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.640 Vali Acc: 0.737 Test Loss: 0.640 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736836).  Saving model ...
Epoch: 6 cost time: 1.3636372089385986
Epoch: 6, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.597 Vali Acc: 0.763 Test Loss: 0.597 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.3830296993255615
Epoch: 7, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.1546943187713623
Epoch: 8, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.7453668117523193
Epoch: 9, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3370006084442139
Epoch: 10, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2077000141143799
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.280468463897705
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.2818796634674072
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.601 Vali Acc: 0.803 Test Loss: 0.601 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.23512601852417
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0645663738250732
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.620 Vali Acc: 0.803 Test Loss: 0.620 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2130472660064697
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.649 Vali Acc: 0.796 Test Loss: 0.649 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4928650856018066
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.661 Vali Acc: 0.803 Test Loss: 0.661 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.392632246017456
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.667 Vali Acc: 0.796 Test Loss: 0.667 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4786772727966309
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.673 Vali Acc: 0.803 Test Loss: 0.673 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.363598346710205
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2756226062774658
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.702 Vali Acc: 0.803 Test Loss: 0.702 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3101508617401123
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.700 Vali Acc: 0.783 Test Loss: 0.700 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6551992893218994
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 296708
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.034121751785278
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.278 Vali Acc: 0.434 Test Loss: 1.278 Test Acc: 0.434
Validation loss decreased (inf --> -0.434198).  Saving model ...
Epoch: 2 cost time: 1.538630485534668
Epoch: 2, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.100 Vali Acc: 0.553 Test Loss: 1.100 Test Acc: 0.553
Validation loss decreased (-0.434198 --> -0.552621).  Saving model ...
Epoch: 3 cost time: 1.2702126502990723
Epoch: 3, Steps: 10 | Train Loss: 0.905 Vali Loss: 0.923 Vali Acc: 0.684 Test Loss: 0.923 Test Acc: 0.684
Validation loss decreased (-0.552621 --> -0.684201).  Saving model ...
Epoch: 4 cost time: 1.2792737483978271
Epoch: 4, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.779 Vali Acc: 0.711 Test Loss: 0.779 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710519).  Saving model ...
Epoch: 5 cost time: 1.2785069942474365
Epoch: 5, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.695 Vali Acc: 0.724 Test Loss: 0.695 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.2232096195220947
Epoch: 6, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.659599781036377
Epoch: 7, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.609 Vali Acc: 0.724 Test Loss: 0.609 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9016187191009521
Epoch: 8, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.589 Vali Acc: 0.743 Test Loss: 0.589 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5235342979431152
Epoch: 9, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.3557345867156982
Epoch: 10, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.577 Vali Acc: 0.757 Test Loss: 0.577 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.610227346420288
Epoch: 11, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7167391777038574
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.606 Vali Acc: 0.776 Test Loss: 0.606 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6440317630767822
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.3489665985107422
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.621 Vali Acc: 0.776 Test Loss: 0.621 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5672056674957275
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796046).  Saving model ...
Epoch: 16 cost time: 1.4921717643737793
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.652 Vali Acc: 0.789 Test Loss: 0.652 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.794206142425537
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.663 Vali Acc: 0.783 Test Loss: 0.663 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5955255031585693
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.682 Vali Acc: 0.783 Test Loss: 0.682 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4073481559753418
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.706 Vali Acc: 0.776 Test Loss: 0.706 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.473177194595337
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.717 Vali Acc: 0.783 Test Loss: 0.717 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5868897438049316
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.731 Vali Acc: 0.770 Test Loss: 0.731 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3612253665924072
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.739 Vali Acc: 0.776 Test Loss: 0.739 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3552711009979248
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.740 Vali Acc: 0.783 Test Loss: 0.740 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.341637134552002
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.746 Vali Acc: 0.776 Test Loss: 0.746 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3697774410247803
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.758 Vali Acc: 0.776 Test Loss: 0.758 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 287748
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.4618494510650635
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.204 Vali Acc: 0.454 Test Loss: 1.204 Test Acc: 0.454
Validation loss decreased (inf --> -0.453935).  Saving model ...
Epoch: 2 cost time: 1.5038821697235107
Epoch: 2, Steps: 10 | Train Loss: 0.894 Vali Loss: 0.764 Vali Acc: 0.671 Test Loss: 0.764 Test Acc: 0.671
Validation loss decreased (-0.453935 --> -0.671045).  Saving model ...
Epoch: 3 cost time: 1.6401679515838623
Epoch: 3, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.655 Vali Acc: 0.770 Test Loss: 0.655 Test Acc: 0.770
Validation loss decreased (-0.671045 --> -0.769730).  Saving model ...
Epoch: 4 cost time: 1.48881196975708
Epoch: 4, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
Validation loss decreased (-0.769730 --> -0.809205).  Saving model ...
Epoch: 5 cost time: 1.5883228778839111
Epoch: 5, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.26884126663208
Epoch: 6, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.698 Vali Acc: 0.783 Test Loss: 0.698 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8557205200195312
Epoch: 7, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.589 Vali Acc: 0.809 Test Loss: 0.589 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7943871021270752
Epoch: 8, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6813552379608154
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.665 Vali Acc: 0.809 Test Loss: 0.665 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5569393634796143
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.652 Vali Acc: 0.829 Test Loss: 0.652 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828941).  Saving model ...
Epoch: 11 cost time: 1.549304723739624
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.696 Vali Acc: 0.829 Test Loss: 0.696 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7586100101470947
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.687 Vali Acc: 0.836 Test Loss: 0.687 Test Acc: 0.836
Validation loss decreased (-0.828941 --> -0.835519).  Saving model ...
Epoch: 13 cost time: 1.3422887325286865
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.719 Vali Acc: 0.816 Test Loss: 0.719 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6377763748168945
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.816 Test Loss: 0.728 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6457281112670898
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.822 Test Loss: 0.728 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6402547359466553
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.822 Test Loss: 0.743 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9374420642852783
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.758 Vali Acc: 0.822 Test Loss: 0.758 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8723034858703613
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.816 Test Loss: 0.776 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5877676010131836
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.816 Test Loss: 0.767 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8094279766082764
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.822 Test Loss: 0.781 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7119061946868896
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.822 Test Loss: 0.790 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4858195781707764
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.802 Vali Acc: 0.822 Test Loss: 0.802 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 291844
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.046874761581421
Epoch: 1, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.240 Vali Acc: 0.395 Test Loss: 1.240 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 1.3663029670715332
Epoch: 2, Steps: 10 | Train Loss: 1.077 Vali Loss: 0.930 Vali Acc: 0.632 Test Loss: 0.930 Test Acc: 0.632
Validation loss decreased (-0.394724 --> -0.631570).  Saving model ...
Epoch: 3 cost time: 1.302570104598999
Epoch: 3, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.712 Vali Acc: 0.724 Test Loss: 0.712 Test Acc: 0.724
Validation loss decreased (-0.631570 --> -0.723677).  Saving model ...
Epoch: 4 cost time: 1.2481231689453125
Epoch: 4, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 1.2171316146850586
Epoch: 5, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.544 Vali Acc: 0.770 Test Loss: 0.544 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 1.5823392868041992
Epoch: 6, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.522 Vali Acc: 0.770 Test Loss: 0.522 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 7 cost time: 1.2220702171325684
Epoch: 7, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 8 cost time: 1.4901022911071777
Epoch: 8, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4488677978515625
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.249500036239624
Epoch: 10, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5450799465179443
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.605 Vali Acc: 0.796 Test Loss: 0.605 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.159311294555664
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815783).  Saving model ...
Epoch: 13 cost time: 1.2610223293304443
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.628 Vali Acc: 0.816 Test Loss: 0.628 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4665031433105469
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.646 Vali Acc: 0.816 Test Loss: 0.646 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3829140663146973
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.671 Vali Acc: 0.822 Test Loss: 0.671 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 16 cost time: 1.687854290008545
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.704 Vali Acc: 0.822 Test Loss: 0.704 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.641653299331665
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.694 Vali Acc: 0.809 Test Loss: 0.694 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.340475082397461
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.822 Test Loss: 0.707 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.276958703994751
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.724 Vali Acc: 0.816 Test Loss: 0.724 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6259493827819824
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.734 Vali Acc: 0.816 Test Loss: 0.734 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5759177207946777
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.744 Vali Acc: 0.809 Test Loss: 0.744 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.59867262840271
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.751 Vali Acc: 0.816 Test Loss: 0.751 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.347996473312378
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.765 Vali Acc: 0.816 Test Loss: 0.765 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2925224304199219
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.760 Vali Acc: 0.809 Test Loss: 0.760 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6814188957214355
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.771 Vali Acc: 0.816 Test Loss: 0.771 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 245892
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5841407775878906
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.336 Vali Acc: 0.355 Test Loss: 1.336 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.3577823638916016
Epoch: 2, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.077 Vali Acc: 0.599 Test Loss: 1.077 Test Acc: 0.599
Validation loss decreased (-0.355250 --> -0.598673).  Saving model ...
Epoch: 3 cost time: 1.4067881107330322
Epoch: 3, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.840 Vali Acc: 0.671 Test Loss: 0.840 Test Acc: 0.671
Validation loss decreased (-0.598673 --> -0.671044).  Saving model ...
Epoch: 4 cost time: 1.5878801345825195
Epoch: 4, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.700 Vali Acc: 0.737 Test Loss: 0.700 Test Acc: 0.737
Validation loss decreased (-0.671044 --> -0.736835).  Saving model ...
Epoch: 5 cost time: 1.4111328125
Epoch: 5, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.3469805717468262
Epoch: 6, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.4205548763275146
Epoch: 7, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802627).  Saving model ...
Epoch: 8 cost time: 1.163832426071167
Epoch: 8, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 9 cost time: 1.058396577835083
Epoch: 9, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1727056503295898
Epoch: 10, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4540696144104004
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3186535835266113
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
Validation loss decreased (-0.802627 --> -0.822363).  Saving model ...
Epoch: 13 cost time: 1.3880302906036377
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.521 Vali Acc: 0.829 Test Loss: 0.521 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 14 cost time: 1.2187106609344482
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4717376232147217
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1077420711517334
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3077104091644287
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1292650699615479
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2951161861419678
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4119372367858887
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.430501937866211
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.592261791229248
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.589 Vali Acc: 0.816 Test Loss: 0.589 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.334895372390747
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.601 Vali Acc: 0.816 Test Loss: 0.601 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 230788
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.24267578125
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.352 Vali Acc: 0.368 Test Loss: 1.352 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 1.2209045886993408
Epoch: 2, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.115 Vali Acc: 0.572 Test Loss: 1.115 Test Acc: 0.572
Validation loss decreased (-0.368408 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 1.2006795406341553
Epoch: 3, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.907 Vali Acc: 0.632 Test Loss: 0.907 Test Acc: 0.632
Validation loss decreased (-0.572357 --> -0.631570).  Saving model ...
Epoch: 4 cost time: 1.551255464553833
Epoch: 4, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.752 Vali Acc: 0.697 Test Loss: 0.752 Test Acc: 0.697
Validation loss decreased (-0.631570 --> -0.697361).  Saving model ...
Epoch: 5 cost time: 1.4621045589447021
Epoch: 5, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.669 Vali Acc: 0.730 Test Loss: 0.669 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 1.0594961643218994
Epoch: 6, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.5103974342346191
Epoch: 7, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.603 Vali Acc: 0.770 Test Loss: 0.603 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.4444141387939453
Epoch: 8, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.590 Vali Acc: 0.750 Test Loss: 0.590 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.500570297241211
Epoch: 9, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.5707361698150635
Epoch: 10, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.591 Vali Acc: 0.796 Test Loss: 0.591 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.6257891654968262
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4705314636230469
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.622 Vali Acc: 0.789 Test Loss: 0.622 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.53251051902771
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.644 Vali Acc: 0.796 Test Loss: 0.644 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3938624858856201
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1948561668395996
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.683 Vali Acc: 0.776 Test Loss: 0.683 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.411137580871582
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.696 Vali Acc: 0.776 Test Loss: 0.696 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.483715534210205
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.702 Vali Acc: 0.796 Test Loss: 0.702 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.919189453125
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.712 Vali Acc: 0.796 Test Loss: 0.712 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4058690071105957
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.714 Vali Acc: 0.789 Test Loss: 0.714 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3700416088104248
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.716 Vali Acc: 0.789 Test Loss: 0.716 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 230916
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7454397678375244
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.395 Vali Acc: 0.322 Test Loss: 1.395 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 1.1593751907348633
Epoch: 2, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.208 Vali Acc: 0.520 Test Loss: 1.208 Test Acc: 0.520
Validation loss decreased (-0.322354 --> -0.519725).  Saving model ...
Epoch: 3 cost time: 1.450796365737915
Epoch: 3, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.029 Vali Acc: 0.586 Test Loss: 1.029 Test Acc: 0.586
Validation loss decreased (-0.519725 --> -0.585516).  Saving model ...
Epoch: 4 cost time: 1.0543725490570068
Epoch: 4, Steps: 10 | Train Loss: 0.755 Vali Loss: 0.886 Vali Acc: 0.625 Test Loss: 0.886 Test Acc: 0.625
Validation loss decreased (-0.585516 --> -0.624991).  Saving model ...
Epoch: 5 cost time: 1.1838297843933105
Epoch: 5, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.783 Vali Acc: 0.664 Test Loss: 0.783 Test Acc: 0.664
Validation loss decreased (-0.624991 --> -0.664466).  Saving model ...
Epoch: 6 cost time: 0.9993629455566406
Epoch: 6, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.726 Vali Acc: 0.697 Test Loss: 0.726 Test Acc: 0.697
Validation loss decreased (-0.664466 --> -0.697361).  Saving model ...
Epoch: 7 cost time: 1.2641947269439697
Epoch: 7, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.676 Vali Acc: 0.724 Test Loss: 0.676 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.3805780410766602
Epoch: 8, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 1.5447893142700195
Epoch: 9, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.9516785144805908
Epoch: 10, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.634 Vali Acc: 0.763 Test Loss: 0.634 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.3130300045013428
Epoch: 11, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.624 Vali Acc: 0.776 Test Loss: 0.624 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.1542623043060303
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789467).  Saving model ...
Epoch: 13 cost time: 1.428908348083496
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.658 Vali Acc: 0.776 Test Loss: 0.658 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.654604196548462
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.675 Vali Acc: 0.776 Test Loss: 0.675 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7149453163146973
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.669 Vali Acc: 0.789 Test Loss: 0.669 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3173301219940186
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.678 Vali Acc: 0.776 Test Loss: 0.678 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6084418296813965
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.693 Vali Acc: 0.783 Test Loss: 0.693 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5965311527252197
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.709 Vali Acc: 0.776 Test Loss: 0.709 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2323405742645264
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.716 Vali Acc: 0.783 Test Loss: 0.716 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4166970252990723
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.729 Vali Acc: 0.776 Test Loss: 0.729 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.350271224975586
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.749 Vali Acc: 0.783 Test Loss: 0.749 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2699401378631592
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.761 Vali Acc: 0.789 Test Loss: 0.761 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 221956
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.44573450088501
Epoch: 1, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.083 Vali Acc: 0.605 Test Loss: 1.083 Test Acc: 0.605
Validation loss decreased (inf --> -0.605252).  Saving model ...
Epoch: 2 cost time: 1.384728193283081
Epoch: 2, Steps: 10 | Train Loss: 0.786 Vali Loss: 0.739 Vali Acc: 0.717 Test Loss: 0.739 Test Acc: 0.717
Validation loss decreased (-0.605252 --> -0.717098).  Saving model ...
Epoch: 3 cost time: 1.473088264465332
Epoch: 3, Steps: 10 | Train Loss: 0.445 Vali Loss: 0.636 Vali Acc: 0.743 Test Loss: 0.636 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743415).  Saving model ...
Epoch: 4 cost time: 1.2877452373504639
Epoch: 4, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.551 Vali Acc: 0.763 Test Loss: 0.551 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 5 cost time: 1.1171469688415527
Epoch: 5, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
Validation loss decreased (-0.763152 --> -0.815784).  Saving model ...
Epoch: 6 cost time: 1.0991308689117432
Epoch: 6, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 7 cost time: 1.6669373512268066
Epoch: 7, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.679 Vali Acc: 0.803 Test Loss: 0.679 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4301750659942627
Epoch: 8, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4326581954956055
Epoch: 9, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.750 Vali Acc: 0.816 Test Loss: 0.750 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3870882987976074
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.688 Vali Acc: 0.829 Test Loss: 0.688 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828940).  Saving model ...
Epoch: 11 cost time: 1.3788518905639648
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.725 Vali Acc: 0.816 Test Loss: 0.725 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1658682823181152
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.722 Vali Acc: 0.809 Test Loss: 0.722 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6138992309570312
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.793 Vali Acc: 0.803 Test Loss: 0.793 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1430037021636963
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.748 Vali Acc: 0.822 Test Loss: 0.748 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1905288696289062
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.822 Test Loss: 0.760 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2510943412780762
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.816 Test Loss: 0.795 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7341365814208984
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.801 Vali Acc: 0.822 Test Loss: 0.801 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3710567951202393
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.817 Vali Acc: 0.822 Test Loss: 0.817 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4012281894683838
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.816 Test Loss: 0.827 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.286804437637329
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.815 Vali Acc: 0.822 Test Loss: 0.815 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 258948
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9111289978027344
Epoch: 1, Steps: 10 | Train Loss: 1.545 Vali Loss: 1.302 Vali Acc: 0.401 Test Loss: 1.302 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 1.400399923324585
Epoch: 2, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.002 Vali Acc: 0.599 Test Loss: 1.002 Test Acc: 0.599
Validation loss decreased (-0.401303 --> -0.598674).  Saving model ...
Epoch: 3 cost time: 1.0062925815582275
Epoch: 3, Steps: 10 | Train Loss: 0.753 Vali Loss: 0.740 Vali Acc: 0.697 Test Loss: 0.740 Test Acc: 0.697
Validation loss decreased (-0.598674 --> -0.697361).  Saving model ...
Epoch: 4 cost time: 1.2354364395141602
Epoch: 4, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.609 Vali Acc: 0.730 Test Loss: 0.609 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730257).  Saving model ...
Epoch: 5 cost time: 1.1525862216949463
Epoch: 5, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.562 Vali Acc: 0.750 Test Loss: 0.562 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.2225005626678467
Epoch: 6, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776311).  Saving model ...
Epoch: 7 cost time: 1.3533034324645996
Epoch: 7, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 8 cost time: 1.2357110977172852
Epoch: 8, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
Validation loss decreased (-0.776311 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.4390292167663574
Epoch: 9, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 1.5139837265014648
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4909801483154297
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.588 Vali Acc: 0.809 Test Loss: 0.588 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7314856052398682
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822362).  Saving model ...
Epoch: 13 cost time: 1.6639556884765625
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4556355476379395
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3397819995880127
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4817428588867188
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.653 Vali Acc: 0.822 Test Loss: 0.653 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6343765258789062
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.673 Vali Acc: 0.816 Test Loss: 0.673 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9229891300201416
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.694 Vali Acc: 0.822 Test Loss: 0.694 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.569352388381958
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7068684101104736
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.708 Vali Acc: 0.829 Test Loss: 0.708 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828940).  Saving model ...
Epoch: 21 cost time: 1.4737541675567627
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.706 Vali Acc: 0.829 Test Loss: 0.706 Test Acc: 0.829
Validation loss decreased (-0.828940 --> -0.828940).  Saving model ...
Epoch: 22 cost time: 1.5793676376342773
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1079578399658203
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.714 Vali Acc: 0.829 Test Loss: 0.714 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5496885776519775
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.726 Vali Acc: 0.829 Test Loss: 0.726 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5411911010742188
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.734 Vali Acc: 0.829 Test Loss: 0.734 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6649072170257568
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.731 Vali Acc: 0.829 Test Loss: 0.731 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5539109706878662
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.736 Vali Acc: 0.829 Test Loss: 0.736 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6837785243988037
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.822 Test Loss: 0.760 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5330767631530762
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.822 Test Loss: 0.772 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.405670166015625
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.755 Vali Acc: 0.836 Test Loss: 0.755 Test Acc: 0.836
Validation loss decreased (-0.828940 --> -0.835519).  Saving model ...
Epoch: 31 cost time: 1.4775066375732422
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.759 Vali Acc: 0.836 Test Loss: 0.759 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5199623107910156
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.836 Test Loss: 0.775 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5911619663238525
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.829 Test Loss: 0.788 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6043100357055664
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.829 Test Loss: 0.790 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.60030198097229
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.829 Test Loss: 0.790 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4423942565917969
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.829 Test Loss: 0.794 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.7478370666503906
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.829 Test Loss: 0.800 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.9021830558776855
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.816 Test Loss: 0.798 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.5242793560028076
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.802 Vali Acc: 0.829 Test Loss: 0.802 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.870133399963379
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.829 Test Loss: 0.820 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 212996
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6839253902435303
Epoch: 1, Steps: 10 | Train Loss: 1.613 Vali Loss: 1.400 Vali Acc: 0.237 Test Loss: 1.400 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.2807254791259766
Epoch: 2, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.159 Vali Acc: 0.487 Test Loss: 1.159 Test Acc: 0.487
Validation loss decreased (-0.236828 --> -0.486831).  Saving model ...
Epoch: 3 cost time: 1.3812158107757568
Epoch: 3, Steps: 10 | Train Loss: 0.957 Vali Loss: 0.893 Vali Acc: 0.638 Test Loss: 0.893 Test Acc: 0.638
Validation loss decreased (-0.486831 --> -0.638149).  Saving model ...
Epoch: 4 cost time: 1.3723852634429932
Epoch: 4, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.734 Vali Acc: 0.697 Test Loss: 0.734 Test Acc: 0.697
Validation loss decreased (-0.638149 --> -0.697361).  Saving model ...
Epoch: 5 cost time: 1.1518044471740723
Epoch: 5, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.627 Vali Acc: 0.704 Test Loss: 0.627 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703941).  Saving model ...
Epoch: 6 cost time: 1.0801985263824463
Epoch: 6, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.703941 --> -0.736837).  Saving model ...
Epoch: 7 cost time: 1.4467737674713135
Epoch: 7, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
Validation loss decreased (-0.736837 --> -0.776311).  Saving model ...
Epoch: 8 cost time: 1.4276185035705566
Epoch: 8, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.515 Vali Acc: 0.770 Test Loss: 0.515 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2885401248931885
Epoch: 9, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2747809886932373
Epoch: 10, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
Validation loss decreased (-0.776311 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.167555332183838
Epoch: 11, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.495 Vali Acc: 0.796 Test Loss: 0.495 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2426888942718506
Epoch: 12, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.1567552089691162
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.144031286239624
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3639135360717773
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6681053638458252
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 17 cost time: 1.467597246170044
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.547 Vali Acc: 0.829 Test Loss: 0.547 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 18 cost time: 1.2059621810913086
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.551 Vali Acc: 0.836 Test Loss: 0.551 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 19 cost time: 1.4199047088623047
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.562 Vali Acc: 0.842 Test Loss: 0.562 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 20 cost time: 1.376739501953125
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.575 Vali Acc: 0.829 Test Loss: 0.575 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3155591487884521
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.583 Vali Acc: 0.836 Test Loss: 0.583 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2263672351837158
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3324146270751953
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2840547561645508
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2938776016235352
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.829 Test Loss: 0.618 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3364336490631104
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.829 Test Loss: 0.624 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.290562629699707
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.632 Vali Acc: 0.829 Test Loss: 0.632 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.480536937713623
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.633 Vali Acc: 0.816 Test Loss: 0.633 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0159821510314941
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 197892
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8638947010040283
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.2434031963348389
Epoch: 2, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.097 Vali Acc: 0.572 Test Loss: 1.097 Test Acc: 0.572
Validation loss decreased (-0.374987 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 1.4076642990112305
Epoch: 3, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.893 Vali Acc: 0.651 Test Loss: 0.893 Test Acc: 0.651
Validation loss decreased (-0.572357 --> -0.651307).  Saving model ...
Epoch: 4 cost time: 1.1738483905792236
Epoch: 4, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.739 Vali Acc: 0.711 Test Loss: 0.739 Test Acc: 0.711
Validation loss decreased (-0.651307 --> -0.710519).  Saving model ...
Epoch: 5 cost time: 1.144402027130127
Epoch: 5, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.647 Vali Acc: 0.743 Test Loss: 0.647 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 1.01503586769104
Epoch: 6, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
Validation loss decreased (-0.743415 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.5126264095306396
Epoch: 7, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.3391294479370117
Epoch: 8, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.0881884098052979
Epoch: 9, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.1611967086791992
Epoch: 10, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.1722967624664307
Epoch: 11, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 1.176680088043213
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0363562107086182
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.225616693496704
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.614 Vali Acc: 0.809 Test Loss: 0.614 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2205259799957275
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1752400398254395
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.626 Vali Acc: 0.796 Test Loss: 0.626 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3267598152160645
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.626 Vali Acc: 0.796 Test Loss: 0.626 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3670966625213623
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.247304916381836
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9877147674560547
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.657 Vali Acc: 0.803 Test Loss: 0.657 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2134473323822021
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 198020
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.049240589141846
Epoch: 1, Steps: 10 | Train Loss: 1.516 Vali Loss: 1.294 Vali Acc: 0.382 Test Loss: 1.294 Test Acc: 0.382
Validation loss decreased (inf --> -0.381566).  Saving model ...
Epoch: 2 cost time: 1.2948088645935059
Epoch: 2, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.101 Vali Acc: 0.553 Test Loss: 1.101 Test Acc: 0.553
Validation loss decreased (-0.381566 --> -0.552621).  Saving model ...
Epoch: 3 cost time: 1.2127809524536133
Epoch: 3, Steps: 10 | Train Loss: 1.031 Vali Loss: 0.924 Vali Acc: 0.638 Test Loss: 0.924 Test Acc: 0.638
Validation loss decreased (-0.552621 --> -0.638149).  Saving model ...
Epoch: 4 cost time: 1.2736225128173828
Epoch: 4, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.811 Vali Acc: 0.678 Test Loss: 0.811 Test Acc: 0.678
Validation loss decreased (-0.638149 --> -0.677623).  Saving model ...
Epoch: 5 cost time: 1.3506269454956055
Epoch: 5, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.722 Vali Acc: 0.691 Test Loss: 0.722 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690782).  Saving model ...
Epoch: 6 cost time: 1.3591759204864502
Epoch: 6, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.670 Vali Acc: 0.717 Test Loss: 0.670 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717099).  Saving model ...
Epoch: 7 cost time: 1.0698387622833252
Epoch: 7, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.620 Vali Acc: 0.730 Test Loss: 0.620 Test Acc: 0.730
Validation loss decreased (-0.717099 --> -0.730257).  Saving model ...
Epoch: 8 cost time: 1.0558054447174072
Epoch: 8, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.595 Vali Acc: 0.730 Test Loss: 0.595 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 9 cost time: 1.1323132514953613
Epoch: 9, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.603 Vali Acc: 0.730 Test Loss: 0.603 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2801272869110107
Epoch: 10, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.596 Vali Acc: 0.737 Test Loss: 0.596 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 11 cost time: 1.3073995113372803
Epoch: 11, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
Validation loss decreased (-0.736836 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.3822259902954102
Epoch: 12, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.371455430984497
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.615 Vali Acc: 0.783 Test Loss: 0.615 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.1382641792297363
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.070007562637329
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5999059677124023
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2832131385803223
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.671 Vali Acc: 0.783 Test Loss: 0.671 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4090321063995361
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.686 Vali Acc: 0.783 Test Loss: 0.686 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2335765361785889
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 20 cost time: 1.1295127868652344
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2195866107940674
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1098613739013672
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.702 Vali Acc: 0.796 Test Loss: 0.702 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 23 cost time: 1.1527950763702393
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.706 Vali Acc: 0.789 Test Loss: 0.706 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1879081726074219
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.710 Vali Acc: 0.796 Test Loss: 0.710 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.190032720565796
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.716 Vali Acc: 0.783 Test Loss: 0.716 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2608122825622559
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.737 Vali Acc: 0.776 Test Loss: 0.737 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.29085111618042
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.742 Vali Acc: 0.776 Test Loss: 0.742 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.517643928527832
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.750 Vali Acc: 0.776 Test Loss: 0.750 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2157371044158936
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.441504716873169
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.46162748336792
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.783 Vali Acc: 0.783 Test Loss: 0.783 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3402740955352783
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.787 Vali Acc: 0.783 Test Loss: 0.787 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 189060
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.400738000869751
Epoch: 1, Steps: 10 | Train Loss: 1.550 Vali Loss: 1.392 Vali Acc: 0.289 Test Loss: 1.392 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.725203514099121
Epoch: 2, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.036 Vali Acc: 0.592 Test Loss: 1.036 Test Acc: 0.592
Validation loss decreased (-0.289460 --> -0.592095).  Saving model ...
Epoch: 3 cost time: 1.7969086170196533
Epoch: 3, Steps: 10 | Train Loss: 0.802 Vali Loss: 0.764 Vali Acc: 0.697 Test Loss: 0.764 Test Acc: 0.697
Validation loss decreased (-0.592095 --> -0.697361).  Saving model ...
Epoch: 4 cost time: 1.9273755550384521
Epoch: 4, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.617 Vali Acc: 0.743 Test Loss: 0.617 Test Acc: 0.743
Validation loss decreased (-0.697361 --> -0.743415).  Saving model ...
Epoch: 5 cost time: 1.4520518779754639
Epoch: 5, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.5202126502990723
Epoch: 6, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796048).  Saving model ...
Epoch: 7 cost time: 1.4719340801239014
Epoch: 7, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5216450691223145
Epoch: 8, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 9 cost time: 1.5930311679840088
Epoch: 9, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7919886112213135
Epoch: 10, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 1.6533277034759521
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6304829120635986
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4561243057250977
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1556425094604492
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 15 cost time: 1.3517193794250488
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6570055484771729
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.628 Vali Acc: 0.809 Test Loss: 0.628 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7827668190002441
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.652 Vali Acc: 0.822 Test Loss: 0.652 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2692782878875732
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.816 Test Loss: 0.662 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3455524444580078
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2047181129455566
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.669 Vali Acc: 0.822 Test Loss: 0.669 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9928817749023438
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.689 Vali Acc: 0.836 Test Loss: 0.689 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835519).  Saving model ...
Epoch: 22 cost time: 1.4838368892669678
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1104905605316162
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.829 Test Loss: 0.706 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1951143741607666
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.829 Test Loss: 0.706 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1933622360229492
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.714 Vali Acc: 0.829 Test Loss: 0.714 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.356917381286621
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.829 Test Loss: 0.727 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2751786708831787
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.741 Vali Acc: 0.822 Test Loss: 0.741 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3329505920410156
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.829 Test Loss: 0.743 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2992229461669922
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.829 Test Loss: 0.749 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.731184720993042
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.761 Vali Acc: 0.829 Test Loss: 0.761 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.424954891204834
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.770 Vali Acc: 0.829 Test Loss: 0.770 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 146308
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.451598644256592
Epoch: 1, Steps: 10 | Train Loss: 1.581 Vali Loss: 1.417 Vali Acc: 0.250 Test Loss: 1.417 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.5161011219024658
Epoch: 2, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.159 Vali Acc: 0.546 Test Loss: 1.159 Test Acc: 0.546
Validation loss decreased (-0.249986 --> -0.546041).  Saving model ...
Epoch: 3 cost time: 1.303018569946289
Epoch: 3, Steps: 10 | Train Loss: 1.018 Vali Loss: 0.965 Vali Acc: 0.605 Test Loss: 0.965 Test Acc: 0.605
Validation loss decreased (-0.546041 --> -0.605254).  Saving model ...
Epoch: 4 cost time: 1.199829339981079
Epoch: 4, Steps: 10 | Train Loss: 0.744 Vali Loss: 0.823 Vali Acc: 0.704 Test Loss: 0.823 Test Acc: 0.704
Validation loss decreased (-0.605254 --> -0.703939).  Saving model ...
Epoch: 5 cost time: 1.2286975383758545
Epoch: 5, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.697 Vali Acc: 0.770 Test Loss: 0.697 Test Acc: 0.770
Validation loss decreased (-0.703939 --> -0.769730).  Saving model ...
Epoch: 6 cost time: 1.6274738311767578
Epoch: 6, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.616 Vali Acc: 0.783 Test Loss: 0.616 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.4495224952697754
Epoch: 7, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.766122817993164
Epoch: 8, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.2950711250305176
Epoch: 9, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.0744242668151855
Epoch: 10, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5198519229888916
Epoch: 11, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 1.1563920974731445
Epoch: 12, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3871326446533203
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1777074337005615
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3097257614135742
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3660378456115723
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.247629165649414
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2469775676727295
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.589 Vali Acc: 0.816 Test Loss: 0.589 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5036299228668213
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2433335781097412
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3712513446807861
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 123332
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.200064420700073
Epoch: 1, Steps: 10 | Train Loss: 1.548 Vali Loss: 1.475 Vali Acc: 0.316 Test Loss: 1.475 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 1.1713159084320068
Epoch: 2, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.281 Vali Acc: 0.421 Test Loss: 1.281 Test Acc: 0.421
Validation loss decreased (-0.315775 --> -0.421040).  Saving model ...
Epoch: 3 cost time: 1.3883519172668457
Epoch: 3, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.094 Vali Acc: 0.526 Test Loss: 1.094 Test Acc: 0.526
Validation loss decreased (-0.421040 --> -0.526305).  Saving model ...
Epoch: 4 cost time: 1.3684866428375244
Epoch: 4, Steps: 10 | Train Loss: 0.908 Vali Loss: 0.933 Vali Acc: 0.618 Test Loss: 0.933 Test Acc: 0.618
Validation loss decreased (-0.526305 --> -0.618412).  Saving model ...
Epoch: 5 cost time: 1.6222145557403564
Epoch: 5, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.819 Vali Acc: 0.664 Test Loss: 0.819 Test Acc: 0.664
Validation loss decreased (-0.618412 --> -0.664465).  Saving model ...
Epoch: 6 cost time: 1.278439998626709
Epoch: 6, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.707 Vali Acc: 0.730 Test Loss: 0.707 Test Acc: 0.730
Validation loss decreased (-0.664465 --> -0.730256).  Saving model ...
Epoch: 7 cost time: 1.6069703102111816
Epoch: 7, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.636 Vali Acc: 0.730 Test Loss: 0.636 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 8 cost time: 1.4037811756134033
Epoch: 8, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.588 Vali Acc: 0.763 Test Loss: 0.588 Test Acc: 0.763
Validation loss decreased (-0.730257 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.1033344268798828
Epoch: 9, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.485180377960205
Epoch: 10, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3704016208648682
Epoch: 11, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 12 cost time: 1.3147938251495361
Epoch: 12, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 13 cost time: 1.2352030277252197
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.492 Vali Acc: 0.789 Test Loss: 0.492 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 14 cost time: 1.3849213123321533
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809206).  Saving model ...
Epoch: 15 cost time: 1.4606797695159912
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.424001693725586
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3302397727966309
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3854854106903076
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.63901948928833
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6728811264038086
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.46636962890625
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 22 cost time: 1.379833698272705
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.396327257156372
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3733537197113037
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 25 cost time: 1.4164187908172607
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.29203462600708
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1439650058746338
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.561 Vali Acc: 0.816 Test Loss: 0.561 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5352764129638672
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.578 Vali Acc: 0.836 Test Loss: 0.578 Test Acc: 0.836
Validation loss decreased (-0.822363 --> -0.835521).  Saving model ...
Epoch: 29 cost time: 1.6088380813598633
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.583 Vali Acc: 0.836 Test Loss: 0.583 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6885778903961182
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.359614372253418
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.591 Vali Acc: 0.829 Test Loss: 0.591 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4966943264007568
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.602 Vali Acc: 0.829 Test Loss: 0.602 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2212507724761963
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.611 Vali Acc: 0.829 Test Loss: 0.611 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5266001224517822
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.621 Vali Acc: 0.829 Test Loss: 0.621 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4014778137207031
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.623 Vali Acc: 0.836 Test Loss: 0.623 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1785998344421387
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.622 Vali Acc: 0.829 Test Loss: 0.622 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3329503536224365
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.632 Vali Acc: 0.829 Test Loss: 0.632 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3950021266937256
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.637 Vali Acc: 0.829 Test Loss: 0.637 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 115780
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.116078853607178
Epoch: 1, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.427 Vali Acc: 0.309 Test Loss: 1.427 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 1.4165849685668945
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.271 Vali Acc: 0.434 Test Loss: 1.271 Test Acc: 0.434
Validation loss decreased (-0.309196 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 1.4715323448181152
Epoch: 3, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.109 Vali Acc: 0.546 Test Loss: 1.109 Test Acc: 0.546
Validation loss decreased (-0.434198 --> -0.546042).  Saving model ...
Epoch: 4 cost time: 1.2215454578399658
Epoch: 4, Steps: 10 | Train Loss: 0.907 Vali Loss: 0.968 Vali Acc: 0.586 Test Loss: 0.968 Test Acc: 0.586
Validation loss decreased (-0.546042 --> -0.585517).  Saving model ...
Epoch: 5 cost time: 1.4614965915679932
Epoch: 5, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.841 Vali Acc: 0.658 Test Loss: 0.841 Test Acc: 0.658
Validation loss decreased (-0.585517 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.3635001182556152
Epoch: 6, Steps: 10 | Train Loss: 0.578 Vali Loss: 0.749 Vali Acc: 0.730 Test Loss: 0.749 Test Acc: 0.730
Validation loss decreased (-0.657886 --> -0.730256).  Saving model ...
Epoch: 7 cost time: 1.258296251296997
Epoch: 7, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.682 Vali Acc: 0.730 Test Loss: 0.682 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.5749218463897705
Epoch: 8, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.636 Vali Acc: 0.750 Test Loss: 0.636 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.2018213272094727
Epoch: 9, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.600 Vali Acc: 0.789 Test Loss: 0.600 Test Acc: 0.789
Validation loss decreased (-0.749994 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.092465877532959
Epoch: 10, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4177510738372803
Epoch: 11, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.3685050010681152
Epoch: 12, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.2643918991088867
Epoch: 13, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.3161778450012207
Epoch: 14, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.5455334186553955
Epoch: 15, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.7169511318206787
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4781084060668945
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6509835720062256
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 19 cost time: 1.2664299011230469
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 20 cost time: 1.2566249370574951
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1802186965942383
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1150524616241455
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0989325046539307
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2981905937194824
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.081294059753418
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3687067031860352
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4091863632202148
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5003330707550049
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.642 Vali Acc: 0.816 Test Loss: 0.642 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3499763011932373
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.650 Vali Acc: 0.809 Test Loss: 0.650 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 115844
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8678879737854004
Epoch: 1, Steps: 10 | Train Loss: 1.565 Vali Loss: 1.451 Vali Acc: 0.250 Test Loss: 1.451 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.2850844860076904
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.329 Vali Acc: 0.362 Test Loss: 1.329 Test Acc: 0.362
Validation loss decreased (-0.249985 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.2722313404083252
Epoch: 3, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.182 Vali Acc: 0.513 Test Loss: 1.182 Test Acc: 0.513
Validation loss decreased (-0.361829 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 1.2107012271881104
Epoch: 4, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.049 Vali Acc: 0.632 Test Loss: 1.049 Test Acc: 0.632
Validation loss decreased (-0.513146 --> -0.631568).  Saving model ...
Epoch: 5 cost time: 1.1706805229187012
Epoch: 5, Steps: 10 | Train Loss: 0.846 Vali Loss: 0.940 Vali Acc: 0.658 Test Loss: 0.940 Test Acc: 0.658
Validation loss decreased (-0.631568 --> -0.657885).  Saving model ...
Epoch: 6 cost time: 1.3793809413909912
Epoch: 6, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.849 Vali Acc: 0.664 Test Loss: 0.849 Test Acc: 0.664
Validation loss decreased (-0.657885 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 1.6181504726409912
Epoch: 7, Steps: 10 | Train Loss: 0.605 Vali Loss: 0.775 Vali Acc: 0.711 Test Loss: 0.775 Test Acc: 0.711
Validation loss decreased (-0.664465 --> -0.710519).  Saving model ...
Epoch: 8 cost time: 1.396876573562622
Epoch: 8, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.722 Vali Acc: 0.717 Test Loss: 0.722 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 1.174396276473999
Epoch: 9, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.684 Vali Acc: 0.724 Test Loss: 0.684 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 1.439453363418579
Epoch: 10, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.647 Vali Acc: 0.730 Test Loss: 0.647 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730257).  Saving model ...
Epoch: 11 cost time: 1.7460341453552246
Epoch: 11, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 12 cost time: 1.7467551231384277
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.616 Vali Acc: 0.737 Test Loss: 0.616 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 1.487483024597168
Epoch: 13, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.607 Vali Acc: 0.743 Test Loss: 0.607 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 14 cost time: 1.1030402183532715
Epoch: 14, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.5460174083709717
Epoch: 15, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3103106021881104
Epoch: 16, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.597 Vali Acc: 0.743 Test Loss: 0.597 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.297605276107788
Epoch: 17, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.594 Vali Acc: 0.776 Test Loss: 0.594 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.518977165222168
Epoch: 18, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3467042446136475
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.607 Vali Acc: 0.763 Test Loss: 0.607 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4946904182434082
Epoch: 20, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.611 Vali Acc: 0.770 Test Loss: 0.611 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3876869678497314
Epoch: 21, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.616 Vali Acc: 0.763 Test Loss: 0.616 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1681451797485352
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.634 Vali Acc: 0.776 Test Loss: 0.634 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4488050937652588
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.643 Vali Acc: 0.783 Test Loss: 0.643 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 24 cost time: 1.460453748703003
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.649 Vali Acc: 0.776 Test Loss: 0.649 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3672757148742676
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.651 Vali Acc: 0.783 Test Loss: 0.651 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0978577136993408
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.897646188735962
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.658 Vali Acc: 0.789 Test Loss: 0.658 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 28 cost time: 1.3925962448120117
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1637108325958252
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.665 Vali Acc: 0.789 Test Loss: 0.665 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2493479251861572
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.673 Vali Acc: 0.789 Test Loss: 0.673 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.423424482345581
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.676 Vali Acc: 0.783 Test Loss: 0.676 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.558516025543213
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.683 Vali Acc: 0.776 Test Loss: 0.683 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7896270751953125
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.685 Vali Acc: 0.776 Test Loss: 0.685 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4188687801361084
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.686 Vali Acc: 0.776 Test Loss: 0.686 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.019869327545166
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.685 Vali Acc: 0.770 Test Loss: 0.685 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3979265689849854
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.690 Vali Acc: 0.770 Test Loss: 0.690 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.640254259109497
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.709 Vali Acc: 0.783 Test Loss: 0.709 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 111364
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.760566234588623
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.274 Vali Acc: 0.428 Test Loss: 1.274 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 1.3075885772705078
Epoch: 2, Steps: 10 | Train Loss: 1.164 Vali Loss: 0.981 Vali Acc: 0.664 Test Loss: 0.981 Test Acc: 0.664
Validation loss decreased (-0.427619 --> -0.664464).  Saving model ...
Epoch: 3 cost time: 1.5241103172302246
Epoch: 3, Steps: 10 | Train Loss: 0.754 Vali Loss: 0.757 Vali Acc: 0.717 Test Loss: 0.757 Test Acc: 0.717
Validation loss decreased (-0.664464 --> -0.717098).  Saving model ...
Epoch: 4 cost time: 1.6228389739990234
Epoch: 4, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.653 Vali Acc: 0.724 Test Loss: 0.653 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723678).  Saving model ...
Epoch: 5 cost time: 1.8864164352416992
Epoch: 5, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
Validation loss decreased (-0.723678 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 1.5961339473724365
Epoch: 6, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.379533052444458
Epoch: 7, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 8 cost time: 1.4021501541137695
Epoch: 8, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
Validation loss decreased (-0.789469 --> -0.815785).  Saving model ...
Epoch: 9 cost time: 1.2366893291473389
Epoch: 9, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.417809009552002
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 1.512692928314209
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7344801425933838
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6330280303955078
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3837921619415283
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.670652151107788
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2042734622955322
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.644 Vali Acc: 0.829 Test Loss: 0.644 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828941).  Saving model ...
Epoch: 17 cost time: 1.2813618183135986
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2908124923706055
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.665 Vali Acc: 0.822 Test Loss: 0.665 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5086023807525635
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4663748741149902
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4291980266571045
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.316551923751831
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.689 Vali Acc: 0.822 Test Loss: 0.689 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.467771291732788
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.822 Test Loss: 0.706 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.505052089691162
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.822 Test Loss: 0.713 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3180351257324219
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.816 Test Loss: 0.713 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1020967960357666
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.822 Test Loss: 0.707 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 113284
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.117790937423706
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.408 Vali Acc: 0.243 Test Loss: 1.408 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.347494125366211
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.217 Vali Acc: 0.454 Test Loss: 1.217 Test Acc: 0.454
Validation loss decreased (-0.243407 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 1.3567352294921875
Epoch: 3, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.007 Vali Acc: 0.586 Test Loss: 1.007 Test Acc: 0.586
Validation loss decreased (-0.453935 --> -0.585516).  Saving model ...
Epoch: 4 cost time: 1.3804357051849365
Epoch: 4, Steps: 10 | Train Loss: 0.783 Vali Loss: 0.830 Vali Acc: 0.678 Test Loss: 0.830 Test Acc: 0.678
Validation loss decreased (-0.585516 --> -0.677623).  Saving model ...
Epoch: 5 cost time: 1.4087915420532227
Epoch: 5, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.701 Vali Acc: 0.724 Test Loss: 0.701 Test Acc: 0.724
Validation loss decreased (-0.677623 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.1524248123168945
Epoch: 6, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.614 Vali Acc: 0.750 Test Loss: 0.614 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.1601836681365967
Epoch: 7, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.3878438472747803
Epoch: 8, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
Validation loss decreased (-0.769731 --> -0.815784).  Saving model ...
Epoch: 9 cost time: 1.7656867504119873
Epoch: 9, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.254664659500122
Epoch: 10, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 1.2070536613464355
Epoch: 11, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.282536506652832
Epoch: 12, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.322411060333252
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.522 Vali Acc: 0.829 Test Loss: 0.522 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828942).  Saving model ...
Epoch: 14 cost time: 1.3884146213531494
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.327815294265747
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2978222370147705
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4670953750610352
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6535255908966064
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.597301959991455
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2164111137390137
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2115960121154785
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2810754776000977
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.163649320602417
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 90308
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.3984456062316895
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.435 Vali Acc: 0.250 Test Loss: 1.435 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.392545223236084
Epoch: 2, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.252 Vali Acc: 0.441 Test Loss: 1.252 Test Acc: 0.441
Validation loss decreased (-0.249986 --> -0.440777).  Saving model ...
Epoch: 3 cost time: 1.2264420986175537
Epoch: 3, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.074 Vali Acc: 0.513 Test Loss: 1.074 Test Acc: 0.513
Validation loss decreased (-0.440777 --> -0.513147).  Saving model ...
Epoch: 4 cost time: 1.4149868488311768
Epoch: 4, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.925 Vali Acc: 0.632 Test Loss: 0.925 Test Acc: 0.632
Validation loss decreased (-0.513147 --> -0.631570).  Saving model ...
Epoch: 5 cost time: 1.1299796104431152
Epoch: 5, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.792 Vali Acc: 0.717 Test Loss: 0.792 Test Acc: 0.717
Validation loss decreased (-0.631570 --> -0.717097).  Saving model ...
Epoch: 6 cost time: 1.4122376441955566
Epoch: 6, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.702 Vali Acc: 0.730 Test Loss: 0.702 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 7 cost time: 1.2244489192962646
Epoch: 7, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.631 Vali Acc: 0.757 Test Loss: 0.631 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.2042100429534912
Epoch: 8, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.593 Vali Acc: 0.770 Test Loss: 0.593 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.582406759262085
Epoch: 9, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.552 Vali Acc: 0.770 Test Loss: 0.552 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.1007790565490723
Epoch: 10, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
Validation loss decreased (-0.769731 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.4296517372131348
Epoch: 11, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.0457286834716797
Epoch: 12, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9340574741363525
Epoch: 13, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 1.3660144805908203
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3410325050354004
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2997095584869385
Epoch: 16, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1659998893737793
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 18 cost time: 1.4195282459259033
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5786182880401611
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4903831481933594
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5448050498962402
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.367279291152954
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.562 Vali Acc: 0.829 Test Loss: 0.562 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 23 cost time: 1.2972381114959717
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.566 Vali Acc: 0.829 Test Loss: 0.566 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.527524709701538
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.506404161453247
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4162557125091553
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.593 Vali Acc: 0.809 Test Loss: 0.593 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4154701232910156
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4869942665100098
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2636754512786865
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.624 Vali Acc: 0.816 Test Loss: 0.624 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4148452281951904
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.636 Vali Acc: 0.822 Test Loss: 0.636 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3120696544647217
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4361135959625244
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 82756
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.45884370803833
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.438 Vali Acc: 0.336 Test Loss: 1.438 Test Acc: 0.336
Validation loss decreased (inf --> -0.335512).  Saving model ...
Epoch: 2 cost time: 1.4730651378631592
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.293 Vali Acc: 0.441 Test Loss: 1.293 Test Acc: 0.441
Validation loss decreased (-0.335512 --> -0.440777).  Saving model ...
Epoch: 3 cost time: 1.9334015846252441
Epoch: 3, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.118 Vali Acc: 0.559 Test Loss: 1.118 Test Acc: 0.559
Validation loss decreased (-0.440777 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.3837661743164062
Epoch: 4, Steps: 10 | Train Loss: 0.921 Vali Loss: 0.958 Vali Acc: 0.612 Test Loss: 0.958 Test Acc: 0.612
Validation loss decreased (-0.559199 --> -0.611833).  Saving model ...
Epoch: 5 cost time: 1.3854718208312988
Epoch: 5, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.839 Vali Acc: 0.678 Test Loss: 0.839 Test Acc: 0.678
Validation loss decreased (-0.611833 --> -0.677623).  Saving model ...
Epoch: 6 cost time: 1.233656644821167
Epoch: 6, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.750 Vali Acc: 0.704 Test Loss: 0.750 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703940).  Saving model ...
Epoch: 7 cost time: 1.5464262962341309
Epoch: 7, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.697 Vali Acc: 0.717 Test Loss: 0.697 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.6530756950378418
Epoch: 8, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.643 Vali Acc: 0.737 Test Loss: 0.643 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 1.4950220584869385
Epoch: 9, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.605 Vali Acc: 0.770 Test Loss: 0.605 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.3519768714904785
Epoch: 10, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4027454853057861
Epoch: 11, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.3502724170684814
Epoch: 12, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.334620475769043
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.2713675498962402
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.2731781005859375
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2422292232513428
Epoch: 16, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.5185928344726562
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4376437664031982
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3272392749786377
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2346458435058594
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2922062873840332
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 22 cost time: 1.376995325088501
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.521158218383789
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.266730785369873
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.610 Vali Acc: 0.796 Test Loss: 0.610 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.272249460220337
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.610 Vali Acc: 0.796 Test Loss: 0.610 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.344475507736206
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.617 Vali Acc: 0.796 Test Loss: 0.617 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.564476490020752
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2900047302246094
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.638 Vali Acc: 0.796 Test Loss: 0.638 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6015574932098389
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.637 Vali Acc: 0.803 Test Loss: 0.637 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5268440246582031
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3464245796203613
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 82820
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.680455923080444
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.473 Vali Acc: 0.250 Test Loss: 1.473 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.4466352462768555
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.377 Vali Acc: 0.362 Test Loss: 1.377 Test Acc: 0.362
Validation loss decreased (-0.249985 --> -0.361828).  Saving model ...
Epoch: 3 cost time: 1.8601889610290527
Epoch: 3, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.246 Vali Acc: 0.447 Test Loss: 1.246 Test Acc: 0.447
Validation loss decreased (-0.361828 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.53183913230896
Epoch: 4, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.123 Vali Acc: 0.507 Test Loss: 1.123 Test Acc: 0.507
Validation loss decreased (-0.447356 --> -0.506568).  Saving model ...
Epoch: 5 cost time: 1.6398053169250488
Epoch: 5, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.008 Vali Acc: 0.592 Test Loss: 1.008 Test Acc: 0.592
Validation loss decreased (-0.506568 --> -0.592095).  Saving model ...
Epoch: 6 cost time: 1.6537694931030273
Epoch: 6, Steps: 10 | Train Loss: 0.691 Vali Loss: 0.904 Vali Acc: 0.645 Test Loss: 0.904 Test Acc: 0.645
Validation loss decreased (-0.592095 --> -0.644728).  Saving model ...
Epoch: 7 cost time: 1.7185938358306885
Epoch: 7, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.819 Vali Acc: 0.638 Test Loss: 0.819 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2427873611450195
Epoch: 8, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.760 Vali Acc: 0.711 Test Loss: 0.760 Test Acc: 0.711
Validation loss decreased (-0.644728 --> -0.710519).  Saving model ...
Epoch: 9 cost time: 1.2420332431793213
Epoch: 9, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.710 Vali Acc: 0.711 Test Loss: 0.710 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.1510913372039795
Epoch: 10, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.677 Vali Acc: 0.724 Test Loss: 0.677 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 1.5396451950073242
Epoch: 11, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.662 Vali Acc: 0.724 Test Loss: 0.662 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723678).  Saving model ...
Epoch: 12 cost time: 1.358051061630249
Epoch: 12, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3984286785125732
Epoch: 13, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.634 Vali Acc: 0.730 Test Loss: 0.634 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 14 cost time: 1.233506441116333
Epoch: 14, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 15 cost time: 1.3446927070617676
Epoch: 15, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.623 Vali Acc: 0.730 Test Loss: 0.623 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.353546142578125
Epoch: 16, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.621 Vali Acc: 0.757 Test Loss: 0.621 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 1.2926535606384277
Epoch: 17, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3700220584869385
Epoch: 18, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.627 Vali Acc: 0.743 Test Loss: 0.627 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4864940643310547
Epoch: 19, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.627 Vali Acc: 0.750 Test Loss: 0.627 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4548399448394775
Epoch: 20, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.619 Vali Acc: 0.743 Test Loss: 0.619 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5668723583221436
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 22 cost time: 1.264115810394287
Epoch: 22, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.626 Vali Acc: 0.763 Test Loss: 0.626 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 1.3287978172302246
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.633 Vali Acc: 0.763 Test Loss: 0.633 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.226011037826538
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.637 Vali Acc: 0.757 Test Loss: 0.637 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1868467330932617
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782888).  Saving model ...
Epoch: 26 cost time: 1.2875182628631592
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5167427062988281
Epoch: 27, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.668 Vali Acc: 0.776 Test Loss: 0.668 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.369398832321167
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.690 Vali Acc: 0.770 Test Loss: 0.690 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2344024181365967
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.686 Vali Acc: 0.776 Test Loss: 0.686 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.317460298538208
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.691 Vali Acc: 0.770 Test Loss: 0.691 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.860245704650879
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.696 Vali Acc: 0.770 Test Loss: 0.696 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.592949390411377
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.697 Vali Acc: 0.770 Test Loss: 0.697 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5881688594818115
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4665260314941406
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.703 Vali Acc: 0.789 Test Loss: 0.703 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 35 cost time: 1.3675835132598877
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.709 Vali Acc: 0.796 Test Loss: 0.709 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 36 cost time: 1.7154638767242432
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.705 Vali Acc: 0.796 Test Loss: 0.705 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796046).  Saving model ...
Epoch: 37 cost time: 1.2203619480133057
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.703 Vali Acc: 0.789 Test Loss: 0.703 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1704380512237549
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.708 Vali Acc: 0.783 Test Loss: 0.708 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.415186882019043
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.719 Vali Acc: 0.783 Test Loss: 0.719 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.380976676940918
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.723 Vali Acc: 0.783 Test Loss: 0.723 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6366379261016846
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.727 Vali Acc: 0.789 Test Loss: 0.727 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.5555334091186523
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3166604042053223
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2243590354919434
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.8482105731964111
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.762 Vali Acc: 0.796 Test Loss: 0.762 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.3073954582214355
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.756 Vali Acc: 0.796 Test Loss: 0.756 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 78340
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8903439044952393
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.308 Vali Acc: 0.368 Test Loss: 1.308 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 1.1845951080322266
Epoch: 2, Steps: 10 | Train Loss: 1.146 Vali Loss: 0.992 Vali Acc: 0.592 Test Loss: 0.992 Test Acc: 0.592
Validation loss decreased (-0.368408 --> -0.592095).  Saving model ...
Epoch: 3 cost time: 1.2469120025634766
Epoch: 3, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.775 Vali Acc: 0.691 Test Loss: 0.775 Test Acc: 0.691
Validation loss decreased (-0.592095 --> -0.690782).  Saving model ...
Epoch: 4 cost time: 1.3982746601104736
Epoch: 4, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.646 Vali Acc: 0.730 Test Loss: 0.646 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730257).  Saving model ...
Epoch: 5 cost time: 1.8006007671356201
Epoch: 5, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.567 Vali Acc: 0.770 Test Loss: 0.567 Test Acc: 0.770
Validation loss decreased (-0.730257 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 1.6009182929992676
Epoch: 6, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
Validation loss decreased (-0.769731 --> -0.802626).  Saving model ...
Epoch: 7 cost time: 1.4628703594207764
Epoch: 7, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7545080184936523
Epoch: 8, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.8335731029510498
Epoch: 9, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5467185974121094
Epoch: 10, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.421647310256958
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.548 Vali Acc: 0.829 Test Loss: 0.548 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828942).  Saving model ...
Epoch: 12 cost time: 1.3737730979919434
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5368406772613525
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.557 Vali Acc: 0.829 Test Loss: 0.557 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7943603992462158
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7478430271148682
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.591 Vali Acc: 0.816 Test Loss: 0.591 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.295544147491455
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4283232688903809
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5923733711242676
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3698601722717285
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.816 Test Loss: 0.627 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6869370937347412
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3091325759887695
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 96772
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.46271824836731
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.378 Vali Acc: 0.289 Test Loss: 1.378 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.401484727859497
Epoch: 2, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.201 Vali Acc: 0.487 Test Loss: 1.201 Test Acc: 0.487
Validation loss decreased (-0.289460 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.2043240070343018
Epoch: 3, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.006 Vali Acc: 0.592 Test Loss: 1.006 Test Acc: 0.592
Validation loss decreased (-0.486830 --> -0.592095).  Saving model ...
Epoch: 4 cost time: 1.3353958129882812
Epoch: 4, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.829 Vali Acc: 0.704 Test Loss: 0.829 Test Acc: 0.704
Validation loss decreased (-0.592095 --> -0.703939).  Saving model ...
Epoch: 5 cost time: 1.1240274906158447
Epoch: 5, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.715 Vali Acc: 0.737 Test Loss: 0.715 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.3284108638763428
Epoch: 6, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.643 Vali Acc: 0.757 Test Loss: 0.643 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.3615636825561523
Epoch: 7, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.3229236602783203
Epoch: 8, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.3206562995910645
Epoch: 9, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.3036658763885498
Epoch: 10, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.2756235599517822
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.3679814338684082
Epoch: 12, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4733355045318604
Epoch: 13, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5522687435150146
Epoch: 14, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 15 cost time: 1.3308656215667725
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2899441719055176
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3990912437438965
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3015151023864746
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.349095344543457
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.595 Vali Acc: 0.809 Test Loss: 0.595 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.475531816482544
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7010157108306885
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7431678771972656
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.622 Vali Acc: 0.809 Test Loss: 0.622 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4201951026916504
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2539637088775635
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.629 Vali Acc: 0.816 Test Loss: 0.629 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 73796
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.541713237762451
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.364 Vali Acc: 0.329 Test Loss: 1.364 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.3701694011688232
Epoch: 2, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.206 Vali Acc: 0.487 Test Loss: 1.206 Test Acc: 0.487
Validation loss decreased (-0.328934 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.552384614944458
Epoch: 3, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.049 Vali Acc: 0.566 Test Loss: 1.049 Test Acc: 0.566
Validation loss decreased (-0.486830 --> -0.565779).  Saving model ...
Epoch: 4 cost time: 1.2291154861450195
Epoch: 4, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.917 Vali Acc: 0.632 Test Loss: 0.917 Test Acc: 0.632
Validation loss decreased (-0.565779 --> -0.631570).  Saving model ...
Epoch: 5 cost time: 1.4614756107330322
Epoch: 5, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.811 Vali Acc: 0.678 Test Loss: 0.811 Test Acc: 0.678
Validation loss decreased (-0.631570 --> -0.677623).  Saving model ...
Epoch: 6 cost time: 1.4714529514312744
Epoch: 6, Steps: 10 | Train Loss: 0.588 Vali Loss: 0.723 Vali Acc: 0.717 Test Loss: 0.723 Test Acc: 0.717
Validation loss decreased (-0.677623 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 1.4096133708953857
Epoch: 7, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.660 Vali Acc: 0.730 Test Loss: 0.660 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 8 cost time: 1.6428511142730713
Epoch: 8, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.5712573528289795
Epoch: 9, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.4807302951812744
Epoch: 10, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.561 Vali Acc: 0.757 Test Loss: 0.561 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.5309576988220215
Epoch: 11, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.542 Vali Acc: 0.763 Test Loss: 0.542 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.6471450328826904
Epoch: 12, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.4176557064056396
Epoch: 13, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3882532119750977
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.5760047435760498
Epoch: 15, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.317023515701294
Epoch: 16, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.1457724571228027
Epoch: 17, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3041021823883057
Epoch: 18, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4783658981323242
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8779854774475098
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2751984596252441
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 1.3455395698547363
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 23 cost time: 1.4310026168823242
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.559 Vali Acc: 0.803 Test Loss: 0.559 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3033018112182617
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3255505561828613
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.353085994720459
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.273881435394287
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 28 cost time: 1.2772197723388672
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 29 cost time: 1.1502740383148193
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2580373287200928
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.593 Vali Acc: 0.809 Test Loss: 0.593 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4168610572814941
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.593 Vali Acc: 0.809 Test Loss: 0.593 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.472522258758545
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4961833953857422
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.603 Vali Acc: 0.809 Test Loss: 0.603 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6965272426605225
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.599 Vali Acc: 0.829 Test Loss: 0.599 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828941).  Saving model ...
Epoch: 35 cost time: 1.5034871101379395
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.609 Vali Acc: 0.809 Test Loss: 0.609 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3880491256713867
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1958675384521484
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2262754440307617
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.394263505935669
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.307044267654419
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.637 Vali Acc: 0.829 Test Loss: 0.637 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3447766304016113
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.641 Vali Acc: 0.829 Test Loss: 0.641 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2979977130889893
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.641 Vali Acc: 0.842 Test Loss: 0.641 Test Acc: 0.842
Validation loss decreased (-0.828941 --> -0.842099).  Saving model ...
Epoch: 43 cost time: 1.7562825679779053
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.643 Vali Acc: 0.842 Test Loss: 0.643 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3518507480621338
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.648 Vali Acc: 0.836 Test Loss: 0.648 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3187284469604492
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3544697761535645
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.5270860195159912
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.687 Vali Acc: 0.822 Test Loss: 0.687 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.5210692882537842
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.695 Vali Acc: 0.816 Test Loss: 0.695 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.28066086769104
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.692 Vali Acc: 0.809 Test Loss: 0.692 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.2681288719177246
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.695 Vali Acc: 0.816 Test Loss: 0.695 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.2922725677490234
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.700 Vali Acc: 0.816 Test Loss: 0.700 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.3383510112762451
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.816 Test Loss: 0.705 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 66244
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.624169111251831
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.349 Vali Acc: 0.336 Test Loss: 1.349 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.1441197395324707
Epoch: 2, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.211 Vali Acc: 0.480 Test Loss: 1.211 Test Acc: 0.480
Validation loss decreased (-0.335513 --> -0.480251).  Saving model ...
Epoch: 3 cost time: 1.276139259338379
Epoch: 3, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.053 Vali Acc: 0.592 Test Loss: 1.053 Test Acc: 0.592
Validation loss decreased (-0.480251 --> -0.592095).  Saving model ...
Epoch: 4 cost time: 1.1699516773223877
Epoch: 4, Steps: 10 | Train Loss: 0.934 Vali Loss: 0.908 Vali Acc: 0.651 Test Loss: 0.908 Test Acc: 0.651
Validation loss decreased (-0.592095 --> -0.651307).  Saving model ...
Epoch: 5 cost time: 1.1278722286224365
Epoch: 5, Steps: 10 | Train Loss: 0.754 Vali Loss: 0.798 Vali Acc: 0.724 Test Loss: 0.798 Test Acc: 0.724
Validation loss decreased (-0.651307 --> -0.723676).  Saving model ...
Epoch: 6 cost time: 1.0219407081604004
Epoch: 6, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.713 Vali Acc: 0.730 Test Loss: 0.713 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 7 cost time: 1.1921932697296143
Epoch: 7, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.656 Vali Acc: 0.737 Test Loss: 0.656 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 8 cost time: 1.3899600505828857
Epoch: 8, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.2656970024108887
Epoch: 9, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 1.2409014701843262
Epoch: 10, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.330930471420288
Epoch: 11, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3774285316467285
Epoch: 12, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.2886555194854736
Epoch: 13, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.283191442489624
Epoch: 14, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.554 Vali Acc: 0.789 Test Loss: 0.554 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.0710525512695312
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1630849838256836
Epoch: 16, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.1987996101379395
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0679645538330078
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 19 cost time: 1.1546356678009033
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3929388523101807
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3677716255187988
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.602 Vali Acc: 0.789 Test Loss: 0.602 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4464144706726074
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3936700820922852
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2133080959320068
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2857911586761475
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.626 Vali Acc: 0.803 Test Loss: 0.626 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.466750144958496
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.626 Vali Acc: 0.796 Test Loss: 0.626 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2850251197814941
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3011045455932617
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.666 Vali Acc: 0.796 Test Loss: 0.666 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 66308
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.463751316070557
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.395 Vali Acc: 0.303 Test Loss: 1.395 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.5528392791748047
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.296 Vali Acc: 0.388 Test Loss: 1.296 Test Acc: 0.388
Validation loss decreased (-0.302618 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.1849360466003418
Epoch: 3, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
Validation loss decreased (-0.388145 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.587113618850708
Epoch: 4, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.027 Vali Acc: 0.618 Test Loss: 1.027 Test Acc: 0.618
Validation loss decreased (-0.499988 --> -0.618411).  Saving model ...
Epoch: 5 cost time: 1.6955406665802002
Epoch: 5, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.925 Vali Acc: 0.625 Test Loss: 0.925 Test Acc: 0.625
Validation loss decreased (-0.618411 --> -0.624991).  Saving model ...
Epoch: 6 cost time: 1.7241380214691162
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.842 Vali Acc: 0.664 Test Loss: 0.842 Test Acc: 0.664
Validation loss decreased (-0.624991 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 1.3122098445892334
Epoch: 7, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.775 Vali Acc: 0.697 Test Loss: 0.775 Test Acc: 0.697
Validation loss decreased (-0.664465 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 1.2487387657165527
Epoch: 8, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.720 Vali Acc: 0.724 Test Loss: 0.720 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 9 cost time: 1.413728952407837
Epoch: 9, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.671 Vali Acc: 0.730 Test Loss: 0.671 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 1.3773982524871826
Epoch: 10, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 2.1811575889587402
Epoch: 11, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 1.7808990478515625
Epoch: 12, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.592 Vali Acc: 0.770 Test Loss: 0.592 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.5313148498535156
Epoch: 13, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.5827229022979736
Epoch: 14, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.583 Vali Acc: 0.763 Test Loss: 0.583 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6571485996246338
Epoch: 15, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.572 Vali Acc: 0.796 Test Loss: 0.572 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.3848741054534912
Epoch: 16, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4118409156799316
Epoch: 17, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.548846960067749
Epoch: 18, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4422857761383057
Epoch: 19, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2020580768585205
Epoch: 20, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 1.3147327899932861
Epoch: 21, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.598 Vali Acc: 0.816 Test Loss: 0.598 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 22 cost time: 1.6329162120819092
Epoch: 22, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 23 cost time: 1.5675723552703857
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6266677379608154
Epoch: 24, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4988114833831787
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.622 Vali Acc: 0.822 Test Loss: 0.622 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.839449405670166
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9832968711853027
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.631 Vali Acc: 0.803 Test Loss: 0.631 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6679894924163818
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.637 Vali Acc: 0.816 Test Loss: 0.637 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5235185623168945
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6020500659942627
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.632 Vali Acc: 0.816 Test Loss: 0.632 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7171998023986816
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8226559162139893
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.650 Vali Acc: 0.809 Test Loss: 0.650 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 61828
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.769041538238525
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.368 Vali Acc: 0.388 Test Loss: 1.368 Test Acc: 0.388
Validation loss decreased (inf --> -0.388144).  Saving model ...
Epoch: 2 cost time: 1.5636849403381348
Epoch: 2, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
Validation loss decreased (-0.388144 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 1.7574248313903809
Epoch: 3, Steps: 10 | Train Loss: 1.022 Vali Loss: 0.980 Vali Acc: 0.618 Test Loss: 0.980 Test Acc: 0.618
Validation loss decreased (-0.467093 --> -0.618411).  Saving model ...
Epoch: 4 cost time: 1.0208840370178223
Epoch: 4, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.827 Vali Acc: 0.684 Test Loss: 0.827 Test Acc: 0.684
Validation loss decreased (-0.618411 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 1.1334788799285889
Epoch: 5, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.687 Vali Acc: 0.717 Test Loss: 0.687 Test Acc: 0.717
Validation loss decreased (-0.684202 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.148249626159668
Epoch: 6, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.604 Vali Acc: 0.743 Test Loss: 0.604 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743415).  Saving model ...
Epoch: 7 cost time: 1.365035057067871
Epoch: 7, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.550 Vali Acc: 0.770 Test Loss: 0.550 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.3040506839752197
Epoch: 8, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
Validation loss decreased (-0.769731 --> -0.809205).  Saving model ...
Epoch: 9 cost time: 1.533522367477417
Epoch: 9, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 10 cost time: 1.594609022140503
Epoch: 10, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 11 cost time: 1.063192367553711
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.468 Vali Acc: 0.822 Test Loss: 0.468 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2892067432403564
Epoch: 12, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.461 Vali Acc: 0.836 Test Loss: 0.461 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 13 cost time: 1.1045935153961182
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.081538438796997
Epoch: 14, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.494 Vali Acc: 0.842 Test Loss: 0.494 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842100).  Saving model ...
Epoch: 15 cost time: 0.9238898754119873
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.460 Vali Acc: 0.842 Test Loss: 0.460 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 16 cost time: 1.1570262908935547
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.484 Vali Acc: 0.836 Test Loss: 0.484 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.709338665008545
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3408176898956299
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.495 Vali Acc: 0.829 Test Loss: 0.495 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.145287036895752
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5776729583740234
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4658613204956055
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.529 Vali Acc: 0.836 Test Loss: 0.529 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3989222049713135
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.545 Vali Acc: 0.829 Test Loss: 0.545 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3799984455108643
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3010070323944092
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.545 Vali Acc: 0.829 Test Loss: 0.545 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2068657875061035
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.561 Vali Acc: 0.836 Test Loss: 0.561 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 65220
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.64300012588501
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.490 Vali Acc: 0.303 Test Loss: 1.490 Test Acc: 0.303
Validation loss decreased (inf --> -0.302617).  Saving model ...
Epoch: 2 cost time: 1.4834787845611572
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.328 Vali Acc: 0.355 Test Loss: 1.328 Test Acc: 0.355
Validation loss decreased (-0.302617 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.4145817756652832
Epoch: 3, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.182 Vali Acc: 0.461 Test Loss: 1.182 Test Acc: 0.461
Validation loss decreased (-0.355250 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 1.7410130500793457
Epoch: 4, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.040 Vali Acc: 0.612 Test Loss: 1.040 Test Acc: 0.612
Validation loss decreased (-0.460514 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 1.1448228359222412
Epoch: 5, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.922 Vali Acc: 0.645 Test Loss: 0.922 Test Acc: 0.645
Validation loss decreased (-0.611832 --> -0.644728).  Saving model ...
Epoch: 6 cost time: 1.4713108539581299
Epoch: 6, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.821 Vali Acc: 0.684 Test Loss: 0.821 Test Acc: 0.684
Validation loss decreased (-0.644728 --> -0.684202).  Saving model ...
Epoch: 7 cost time: 1.7576277256011963
Epoch: 7, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.730 Vali Acc: 0.711 Test Loss: 0.730 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710519).  Saving model ...
Epoch: 8 cost time: 1.3697056770324707
Epoch: 8, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.662 Vali Acc: 0.737 Test Loss: 0.662 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 1.3498477935791016
Epoch: 9, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.618 Vali Acc: 0.750 Test Loss: 0.618 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.7566344738006592
Epoch: 10, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.573 Vali Acc: 0.757 Test Loss: 0.573 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.2641539573669434
Epoch: 11, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.3626818656921387
Epoch: 12, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.78560471534729
Epoch: 13, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 14 cost time: 1.5540876388549805
Epoch: 14, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.506 Vali Acc: 0.776 Test Loss: 0.506 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1144652366638184
Epoch: 15, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 16 cost time: 1.219294548034668
Epoch: 16, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 17 cost time: 1.0698175430297852
Epoch: 17, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.320838212966919
Epoch: 18, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4309306144714355
Epoch: 19, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.5638222694396973
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3416283130645752
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2876315116882324
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4370098114013672
Epoch: 23, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.555 Vali Acc: 0.796 Test Loss: 0.555 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.280900239944458
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.257683277130127
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 26 cost time: 1.5089788436889648
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.508453607559204
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.413097620010376
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7330732345581055
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.574 Vali Acc: 0.796 Test Loss: 0.574 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.528430461883545
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3856322765350342
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.5552864074707031
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.3327322006225586
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.597 Vali Acc: 0.796 Test Loss: 0.597 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3602426052093506
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3147802352905273
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 53732
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.039397954940796
Epoch: 1, Steps: 10 | Train Loss: 1.609 Vali Loss: 1.482 Vali Acc: 0.178 Test Loss: 1.482 Test Acc: 0.178
Validation loss decreased (inf --> -0.177617).  Saving model ...
Epoch: 2 cost time: 1.0382678508758545
Epoch: 2, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
Validation loss decreased (-0.177617 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 1.4480552673339844
Epoch: 3, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.280 Vali Acc: 0.368 Test Loss: 1.280 Test Acc: 0.368
Validation loss decreased (-0.243407 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.7102606296539307
Epoch: 4, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.161 Vali Acc: 0.487 Test Loss: 1.161 Test Acc: 0.487
Validation loss decreased (-0.368408 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 1.4741857051849365
Epoch: 5, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.058 Vali Acc: 0.553 Test Loss: 1.058 Test Acc: 0.553
Validation loss decreased (-0.486830 --> -0.552621).  Saving model ...
Epoch: 6 cost time: 1.38938307762146
Epoch: 6, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.954 Vali Acc: 0.592 Test Loss: 0.954 Test Acc: 0.592
Validation loss decreased (-0.552621 --> -0.592096).  Saving model ...
Epoch: 7 cost time: 1.1673123836517334
Epoch: 7, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.864 Vali Acc: 0.658 Test Loss: 0.864 Test Acc: 0.658
Validation loss decreased (-0.592096 --> -0.657886).  Saving model ...
Epoch: 8 cost time: 1.2374911308288574
Epoch: 8, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.790 Vali Acc: 0.684 Test Loss: 0.790 Test Acc: 0.684
Validation loss decreased (-0.657886 --> -0.684203).  Saving model ...
Epoch: 9 cost time: 1.2707829475402832
Epoch: 9, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.725 Vali Acc: 0.711 Test Loss: 0.725 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.8617606163024902
Epoch: 10, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.676 Vali Acc: 0.730 Test Loss: 0.676 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.1795928478240967
Epoch: 11, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.632 Vali Acc: 0.757 Test Loss: 0.632 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 1.5189340114593506
Epoch: 12, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.3481371402740479
Epoch: 13, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.579 Vali Acc: 0.770 Test Loss: 0.579 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.6162502765655518
Epoch: 14, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.3814685344696045
Epoch: 15, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.1970632076263428
Epoch: 16, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.6155369281768799
Epoch: 17, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.2895524501800537
Epoch: 18, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4202556610107422
Epoch: 19, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.5351240634918213
Epoch: 20, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 21 cost time: 1.3820433616638184
Epoch: 21, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2042055130004883
Epoch: 22, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.748197317123413
Epoch: 23, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4580426216125488
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6779985427856445
Epoch: 25, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4246106147766113
Epoch: 26, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2959933280944824
Epoch: 27, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3045876026153564
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3042314052581787
Epoch: 29, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6444611549377441
Epoch: 30, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 49956
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.045569658279419
Epoch: 1, Steps: 10 | Train Loss: 1.513 Vali Loss: 1.483 Vali Acc: 0.270 Test Loss: 1.483 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 1.4723920822143555
Epoch: 2, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.376 Vali Acc: 0.336 Test Loss: 1.376 Test Acc: 0.336
Validation loss decreased (-0.269722 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.4292852878570557
Epoch: 3, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.267 Vali Acc: 0.447 Test Loss: 1.267 Test Acc: 0.447
Validation loss decreased (-0.335513 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.2470998764038086
Epoch: 4, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.157 Vali Acc: 0.539 Test Loss: 1.157 Test Acc: 0.539
Validation loss decreased (-0.447356 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 1.4248542785644531
Epoch: 5, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.055 Vali Acc: 0.572 Test Loss: 1.055 Test Acc: 0.572
Validation loss decreased (-0.539462 --> -0.572358).  Saving model ...
Epoch: 6 cost time: 1.5378506183624268
Epoch: 6, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.957 Vali Acc: 0.612 Test Loss: 0.957 Test Acc: 0.612
Validation loss decreased (-0.572358 --> -0.611833).  Saving model ...
Epoch: 7 cost time: 1.235438585281372
Epoch: 7, Steps: 10 | Train Loss: 0.728 Vali Loss: 0.871 Vali Acc: 0.664 Test Loss: 0.871 Test Acc: 0.664
Validation loss decreased (-0.611833 --> -0.664465).  Saving model ...
Epoch: 8 cost time: 1.5952420234680176
Epoch: 8, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.799 Vali Acc: 0.678 Test Loss: 0.799 Test Acc: 0.678
Validation loss decreased (-0.664465 --> -0.677624).  Saving model ...
Epoch: 9 cost time: 1.297508716583252
Epoch: 9, Steps: 10 | Train Loss: 0.499 Vali Loss: 0.731 Vali Acc: 0.717 Test Loss: 0.731 Test Acc: 0.717
Validation loss decreased (-0.677624 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 1.5353097915649414
Epoch: 10, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.680 Vali Acc: 0.743 Test Loss: 0.680 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 11 cost time: 1.4301235675811768
Epoch: 11, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.643 Vali Acc: 0.743 Test Loss: 0.643 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.5916202068328857
Epoch: 12, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.621 Vali Acc: 0.730 Test Loss: 0.621 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3612945079803467
Epoch: 13, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.3125832080841064
Epoch: 14, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.578 Vali Acc: 0.776 Test Loss: 0.578 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.538923740386963
Epoch: 15, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7620153427124023
Epoch: 16, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.947068452835083
Epoch: 17, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.4254674911499023
Epoch: 18, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.4625043869018555
Epoch: 19, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.292065143585205
Epoch: 20, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.433603286743164
Epoch: 21, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7798216342926025
Epoch: 22, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.484116554260254
Epoch: 23, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3973398208618164
Epoch: 24, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4985013008117676
Epoch: 25, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4889330863952637
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5895769596099854
Epoch: 27, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 28 cost time: 1.4408791065216064
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 29 cost time: 1.2863364219665527
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5828278064727783
Epoch: 30, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.580 Vali Acc: 0.796 Test Loss: 0.580 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4000072479248047
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4752991199493408
Epoch: 32, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3890211582183838
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.31819748878479
Epoch: 34, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2037463188171387
Epoch: 35, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.552887201309204
Epoch: 36, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.8755476474761963
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.616 Vali Acc: 0.789 Test Loss: 0.616 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2233116626739502
Epoch: 38, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.617 Vali Acc: 0.789 Test Loss: 0.617 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 49988
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.227663516998291
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.383 Vali Acc: 0.322 Test Loss: 1.383 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.73354172706604
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.317 Vali Acc: 0.408 Test Loss: 1.317 Test Acc: 0.408
Validation loss decreased (-0.322355 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.0891022682189941
Epoch: 3, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.224 Vali Acc: 0.526 Test Loss: 1.224 Test Acc: 0.526
Validation loss decreased (-0.407882 --> -0.526304).  Saving model ...
Epoch: 4 cost time: 1.0936741828918457
Epoch: 4, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.132 Vali Acc: 0.579 Test Loss: 1.132 Test Acc: 0.579
Validation loss decreased (-0.526304 --> -0.578936).  Saving model ...
Epoch: 5 cost time: 1.4724712371826172
Epoch: 5, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.044 Vali Acc: 0.618 Test Loss: 1.044 Test Acc: 0.618
Validation loss decreased (-0.578936 --> -0.618411).  Saving model ...
Epoch: 6 cost time: 1.2178289890289307
Epoch: 6, Steps: 10 | Train Loss: 0.916 Vali Loss: 0.968 Vali Acc: 0.658 Test Loss: 0.968 Test Acc: 0.658
Validation loss decreased (-0.618411 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 1.4325311183929443
Epoch: 7, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.900 Vali Acc: 0.664 Test Loss: 0.900 Test Acc: 0.664
Validation loss decreased (-0.657885 --> -0.664465).  Saving model ...
Epoch: 8 cost time: 1.2748503684997559
Epoch: 8, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.839 Vali Acc: 0.671 Test Loss: 0.839 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 1.6438453197479248
Epoch: 9, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.786 Vali Acc: 0.691 Test Loss: 0.786 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690782).  Saving model ...
Epoch: 10 cost time: 1.8007123470306396
Epoch: 10, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.741 Vali Acc: 0.711 Test Loss: 0.741 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 11 cost time: 1.6670112609863281
Epoch: 11, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.703 Vali Acc: 0.724 Test Loss: 0.703 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 12 cost time: 1.7307233810424805
Epoch: 12, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.667 Vali Acc: 0.724 Test Loss: 0.667 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723678).  Saving model ...
Epoch: 13 cost time: 1.4815504550933838
Epoch: 13, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.637 Vali Acc: 0.730 Test Loss: 0.637 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 14 cost time: 1.3031823635101318
Epoch: 14, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.621 Vali Acc: 0.750 Test Loss: 0.621 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.9953253269195557
Epoch: 15, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.606 Vali Acc: 0.763 Test Loss: 0.606 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.7115836143493652
Epoch: 16, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.598 Vali Acc: 0.757 Test Loss: 0.598 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4314947128295898
Epoch: 17, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.590 Vali Acc: 0.750 Test Loss: 0.590 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8200695514678955
Epoch: 18, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.582 Vali Acc: 0.757 Test Loss: 0.582 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0097439289093018
Epoch: 19, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.572 Vali Acc: 0.750 Test Loss: 0.572 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4877324104309082
Epoch: 20, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.577 Vali Acc: 0.763 Test Loss: 0.577 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 21 cost time: 1.1054973602294922
Epoch: 21, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 1.6671593189239502
Epoch: 22, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 1.6502203941345215
Epoch: 23, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7104406356811523
Epoch: 24, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 25 cost time: 1.3441078662872314
Epoch: 25, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.587 Vali Acc: 0.776 Test Loss: 0.587 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7202942371368408
Epoch: 26, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.516524314880371
Epoch: 27, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6293559074401855
Epoch: 28, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.272026777267456
Epoch: 29, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.594 Vali Acc: 0.783 Test Loss: 0.594 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4466617107391357
Epoch: 30, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.596 Vali Acc: 0.770 Test Loss: 0.596 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4419536590576172
Epoch: 31, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.605 Vali Acc: 0.783 Test Loss: 0.605 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5640513896942139
Epoch: 32, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.760164737701416
Epoch: 33, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.8246514797210693
Epoch: 34, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 47748
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.35420036315918
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.348 Vali Acc: 0.276 Test Loss: 1.348 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.3712387084960938
Epoch: 2, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.187 Vali Acc: 0.487 Test Loss: 1.187 Test Acc: 0.487
Validation loss decreased (-0.276302 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.4024794101715088
Epoch: 3, Steps: 10 | Train Loss: 1.006 Vali Loss: 0.971 Vali Acc: 0.645 Test Loss: 0.971 Test Acc: 0.645
Validation loss decreased (-0.486830 --> -0.644727).  Saving model ...
Epoch: 4 cost time: 1.5302059650421143
Epoch: 4, Steps: 10 | Train Loss: 0.803 Vali Loss: 0.827 Vali Acc: 0.671 Test Loss: 0.827 Test Acc: 0.671
Validation loss decreased (-0.644727 --> -0.671044).  Saving model ...
Epoch: 5 cost time: 1.4176454544067383
Epoch: 5, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.691 Vali Acc: 0.724 Test Loss: 0.691 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.4599246978759766
Epoch: 6, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
Validation loss decreased (-0.723677 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.5436432361602783
Epoch: 7, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
Validation loss decreased (-0.763152 --> -0.802626).  Saving model ...
Epoch: 8 cost time: 1.160998821258545
Epoch: 8, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 9 cost time: 1.324617862701416
Epoch: 9, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.478 Vali Acc: 0.796 Test Loss: 0.478 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0260040760040283
Epoch: 10, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822364).  Saving model ...
Epoch: 11 cost time: 1.6922969818115234
Epoch: 11, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.483 Vali Acc: 0.829 Test Loss: 0.483 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 12 cost time: 1.2520806789398193
Epoch: 12, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2698183059692383
Epoch: 13, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.480 Vali Acc: 0.822 Test Loss: 0.480 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4165935516357422
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.504 Vali Acc: 0.829 Test Loss: 0.504 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6007654666900635
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5933103561401367
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1750237941741943
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6645641326904297
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3902559280395508
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.522 Vali Acc: 0.829 Test Loss: 0.522 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.466752052307129
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.552 Vali Acc: 0.829 Test Loss: 0.552 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6283631324768066
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.537 Vali Acc: 0.829 Test Loss: 0.537 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 48580
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.030211687088013
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.386 Vali Acc: 0.322 Test Loss: 1.386 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.4754867553710938
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.290 Vali Acc: 0.408 Test Loss: 1.290 Test Acc: 0.408
Validation loss decreased (-0.322355 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.5654945373535156
Epoch: 3, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.164 Vali Acc: 0.520 Test Loss: 1.164 Test Acc: 0.520
Validation loss decreased (-0.407882 --> -0.519725).  Saving model ...
Epoch: 4 cost time: 1.3676445484161377
Epoch: 4, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.041 Vali Acc: 0.612 Test Loss: 1.041 Test Acc: 0.612
Validation loss decreased (-0.519725 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 1.7165906429290771
Epoch: 5, Steps: 10 | Train Loss: 0.874 Vali Loss: 0.934 Vali Acc: 0.651 Test Loss: 0.934 Test Acc: 0.651
Validation loss decreased (-0.611832 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 1.5069267749786377
Epoch: 6, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.825 Vali Acc: 0.684 Test Loss: 0.825 Test Acc: 0.684
Validation loss decreased (-0.651306 --> -0.684202).  Saving model ...
Epoch: 7 cost time: 1.359959363937378
Epoch: 7, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.744 Vali Acc: 0.678 Test Loss: 0.744 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.728748083114624
Epoch: 8, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.690 Vali Acc: 0.697 Test Loss: 0.690 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697362).  Saving model ...
Epoch: 9 cost time: 1.7182674407958984
Epoch: 9, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.637 Vali Acc: 0.737 Test Loss: 0.637 Test Acc: 0.737
Validation loss decreased (-0.697362 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.5433995723724365
Epoch: 10, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.8520100116729736
Epoch: 11, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 2.1008875370025635
Epoch: 12, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.8253042697906494
Epoch: 13, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.3453714847564697
Epoch: 14, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.2017571926116943
Epoch: 15, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.4436964988708496
Epoch: 16, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.726651668548584
Epoch: 17, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4833202362060547
Epoch: 18, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 19 cost time: 1.4037282466888428
Epoch: 19, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4730138778686523
Epoch: 20, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8349616527557373
Epoch: 21, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.472536325454712
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7124457359313965
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.438276767730713
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9076557159423828
Epoch: 25, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.576 Vali Acc: 0.803 Test Loss: 0.576 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8217577934265137
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6619184017181396
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.689760684967041
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 29 cost time: 1.5582106113433838
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.57059907913208
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6663916110992432
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.590 Vali Acc: 0.803 Test Loss: 0.590 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.174102783203125
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.6997082233428955
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.847872257232666
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4181244373321533
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.608 Vali Acc: 0.816 Test Loss: 0.608 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4177725315093994
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.142925977706909
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.7148354053497314
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 37092
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.321927547454834
Epoch: 1, Steps: 10 | Train Loss: 1.560 Vali Loss: 1.549 Vali Acc: 0.230 Test Loss: 1.549 Test Acc: 0.230
Validation loss decreased (inf --> -0.230248).  Saving model ...
Epoch: 2 cost time: 1.7587485313415527
Epoch: 2, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.456 Vali Acc: 0.283 Test Loss: 1.456 Test Acc: 0.283
Validation loss decreased (-0.230248 --> -0.282880).  Saving model ...
Epoch: 3 cost time: 1.6972906589508057
Epoch: 3, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.340 Vali Acc: 0.382 Test Loss: 1.340 Test Acc: 0.382
Validation loss decreased (-0.282880 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 1.6472914218902588
Epoch: 4, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.222 Vali Acc: 0.487 Test Loss: 1.222 Test Acc: 0.487
Validation loss decreased (-0.381566 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 1.6449756622314453
Epoch: 5, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.101 Vali Acc: 0.586 Test Loss: 1.101 Test Acc: 0.586
Validation loss decreased (-0.486830 --> -0.585515).  Saving model ...
Epoch: 6 cost time: 1.3036460876464844
Epoch: 6, Steps: 10 | Train Loss: 0.874 Vali Loss: 0.998 Vali Acc: 0.638 Test Loss: 0.998 Test Acc: 0.638
Validation loss decreased (-0.585515 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 1.4606449604034424
Epoch: 7, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.893 Vali Acc: 0.678 Test Loss: 0.893 Test Acc: 0.678
Validation loss decreased (-0.638148 --> -0.677623).  Saving model ...
Epoch: 8 cost time: 1.448580026626587
Epoch: 8, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.812 Vali Acc: 0.717 Test Loss: 0.812 Test Acc: 0.717
Validation loss decreased (-0.677623 --> -0.717097).  Saving model ...
Epoch: 9 cost time: 1.4772636890411377
Epoch: 9, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.754 Vali Acc: 0.730 Test Loss: 0.754 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 1.2877733707427979
Epoch: 10, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.695 Vali Acc: 0.770 Test Loss: 0.695 Test Acc: 0.770
Validation loss decreased (-0.730256 --> -0.769730).  Saving model ...
Epoch: 11 cost time: 1.5695736408233643
Epoch: 11, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 12 cost time: 1.509784460067749
Epoch: 12, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.4926135540008545
Epoch: 13, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.4155478477478027
Epoch: 14, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 15 cost time: 1.2346506118774414
Epoch: 15, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8482000827789307
Epoch: 16, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 17 cost time: 1.5740725994110107
Epoch: 17, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7021565437316895
Epoch: 18, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4225742816925049
Epoch: 19, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5905168056488037
Epoch: 20, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 21 cost time: 1.3851234912872314
Epoch: 21, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3749220371246338
Epoch: 22, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.505 Vali Acc: 0.829 Test Loss: 0.505 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 23 cost time: 1.3427050113677979
Epoch: 23, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.679358720779419
Epoch: 24, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.501 Vali Acc: 0.829 Test Loss: 0.501 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 25 cost time: 1.9184236526489258
Epoch: 25, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.504 Vali Acc: 0.822 Test Loss: 0.504 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6112840175628662
Epoch: 26, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.510 Vali Acc: 0.829 Test Loss: 0.510 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5896766185760498
Epoch: 27, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.514 Vali Acc: 0.829 Test Loss: 0.514 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6232783794403076
Epoch: 28, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.513 Vali Acc: 0.836 Test Loss: 0.513 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 29 cost time: 1.8010914325714111
Epoch: 29, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.517 Vali Acc: 0.829 Test Loss: 0.517 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.872718095779419
Epoch: 30, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2177908420562744
Epoch: 31, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7717878818511963
Epoch: 32, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.532 Vali Acc: 0.829 Test Loss: 0.532 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.6351244449615479
Epoch: 33, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.540 Vali Acc: 0.829 Test Loss: 0.540 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.7628748416900635
Epoch: 34, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.541 Vali Acc: 0.829 Test Loss: 0.541 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.765578269958496
Epoch: 35, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.537 Vali Acc: 0.842 Test Loss: 0.537 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 36 cost time: 1.6923744678497314
Epoch: 36, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8465304374694824
Epoch: 37, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.550 Vali Acc: 0.829 Test Loss: 0.550 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.784320592880249
Epoch: 38, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.554 Vali Acc: 0.829 Test Loss: 0.554 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5738234519958496
Epoch: 39, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.9332172870635986
Epoch: 40, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.0864503383636475
Epoch: 41, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.567 Vali Acc: 0.829 Test Loss: 0.567 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.9569079875946045
Epoch: 42, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.569 Vali Acc: 0.829 Test Loss: 0.569 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.660405158996582
Epoch: 43, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.567 Vali Acc: 0.836 Test Loss: 0.567 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.692927360534668
Epoch: 44, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.576 Vali Acc: 0.829 Test Loss: 0.576 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.6902341842651367
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.580 Vali Acc: 0.829 Test Loss: 0.580 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 33316
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.538378953933716
Epoch: 1, Steps: 10 | Train Loss: 1.546 Vali Loss: 1.398 Vali Acc: 0.329 Test Loss: 1.398 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 1.4909982681274414
Epoch: 2, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.306 Vali Acc: 0.375 Test Loss: 1.306 Test Acc: 0.375
Validation loss decreased (-0.328933 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.5434980392456055
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.199 Vali Acc: 0.461 Test Loss: 1.199 Test Acc: 0.461
Validation loss decreased (-0.374987 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 1.5312111377716064
Epoch: 4, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.094 Vali Acc: 0.487 Test Loss: 1.094 Test Acc: 0.487
Validation loss decreased (-0.460514 --> -0.486831).  Saving model ...
Epoch: 5 cost time: 1.677232027053833
Epoch: 5, Steps: 10 | Train Loss: 1.065 Vali Loss: 0.997 Vali Acc: 0.566 Test Loss: 0.997 Test Acc: 0.566
Validation loss decreased (-0.486831 --> -0.565780).  Saving model ...
Epoch: 6 cost time: 1.4683470726013184
Epoch: 6, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.898 Vali Acc: 0.625 Test Loss: 0.898 Test Acc: 0.625
Validation loss decreased (-0.565780 --> -0.624991).  Saving model ...
Epoch: 7 cost time: 1.8603246212005615
Epoch: 7, Steps: 10 | Train Loss: 0.788 Vali Loss: 0.808 Vali Acc: 0.645 Test Loss: 0.808 Test Acc: 0.645
Validation loss decreased (-0.624991 --> -0.644729).  Saving model ...
Epoch: 8 cost time: 1.4661457538604736
Epoch: 8, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.742 Vali Acc: 0.684 Test Loss: 0.742 Test Acc: 0.684
Validation loss decreased (-0.644729 --> -0.684203).  Saving model ...
Epoch: 9 cost time: 1.5671350955963135
Epoch: 9, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.685 Vali Acc: 0.691 Test Loss: 0.685 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690783).  Saving model ...
Epoch: 10 cost time: 1.791682481765747
Epoch: 10, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.628 Vali Acc: 0.717 Test Loss: 0.628 Test Acc: 0.717
Validation loss decreased (-0.690783 --> -0.717099).  Saving model ...
Epoch: 11 cost time: 1.579512119293213
Epoch: 11, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736836).  Saving model ...
Epoch: 12 cost time: 1.2697715759277344
Epoch: 12, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
Validation loss decreased (-0.736836 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 2.0338096618652344
Epoch: 13, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8396403789520264
Epoch: 14, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 15 cost time: 1.6243858337402344
Epoch: 15, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.512 Vali Acc: 0.776 Test Loss: 0.512 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.842461109161377
Epoch: 16, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 17 cost time: 1.655757188796997
Epoch: 17, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 18 cost time: 1.551459550857544
Epoch: 18, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.485 Vali Acc: 0.796 Test Loss: 0.485 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 19 cost time: 1.750317096710205
Epoch: 19, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.480 Vali Acc: 0.796 Test Loss: 0.480 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 20 cost time: 1.7120978832244873
Epoch: 20, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 21 cost time: 1.44032883644104
Epoch: 21, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 22 cost time: 1.8514716625213623
Epoch: 22, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.882211685180664
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.483 Vali Acc: 0.816 Test Loss: 0.483 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7368202209472656
Epoch: 24, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.482 Vali Acc: 0.829 Test Loss: 0.482 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 25 cost time: 1.8920660018920898
Epoch: 25, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.482 Vali Acc: 0.836 Test Loss: 0.482 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835521).  Saving model ...
Epoch: 26 cost time: 1.860961675643921
Epoch: 26, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7768478393554688
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.047713279724121
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.500 Vali Acc: 0.829 Test Loss: 0.500 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7472102642059326
Epoch: 29, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8541042804718018
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7041900157928467
Epoch: 31, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.8256888389587402
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.515 Vali Acc: 0.816 Test Loss: 0.515 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5137908458709717
Epoch: 33, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.5492000579833984
Epoch: 34, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8550522327423096
Epoch: 35, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 33348
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.710034608840942
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.419 Vali Acc: 0.342 Test Loss: 1.419 Test Acc: 0.342
Validation loss decreased (inf --> -0.342091).  Saving model ...
Epoch: 2 cost time: 1.5884509086608887
Epoch: 2, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.328 Vali Acc: 0.401 Test Loss: 1.328 Test Acc: 0.401
Validation loss decreased (-0.342091 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.2471768856048584
Epoch: 3, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.236 Vali Acc: 0.461 Test Loss: 1.236 Test Acc: 0.461
Validation loss decreased (-0.401303 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 1.3329250812530518
Epoch: 4, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.140 Vali Acc: 0.553 Test Loss: 1.140 Test Acc: 0.553
Validation loss decreased (-0.460514 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 1.2987983226776123
Epoch: 5, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.047 Vali Acc: 0.579 Test Loss: 1.047 Test Acc: 0.579
Validation loss decreased (-0.552620 --> -0.578937).  Saving model ...
Epoch: 6 cost time: 1.4062116146087646
Epoch: 6, Steps: 10 | Train Loss: 0.923 Vali Loss: 0.960 Vali Acc: 0.625 Test Loss: 0.960 Test Acc: 0.625
Validation loss decreased (-0.578937 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 1.355799913406372
Epoch: 7, Steps: 10 | Train Loss: 0.863 Vali Loss: 0.887 Vali Acc: 0.632 Test Loss: 0.887 Test Acc: 0.632
Validation loss decreased (-0.624990 --> -0.631570).  Saving model ...
Epoch: 8 cost time: 1.307138204574585
Epoch: 8, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.826 Vali Acc: 0.671 Test Loss: 0.826 Test Acc: 0.671
Validation loss decreased (-0.631570 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 1.4568312168121338
Epoch: 9, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.765 Vali Acc: 0.671 Test Loss: 0.765 Test Acc: 0.671
Validation loss decreased (-0.671044 --> -0.671045).  Saving model ...
Epoch: 10 cost time: 1.2017216682434082
Epoch: 10, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.716 Vali Acc: 0.704 Test Loss: 0.716 Test Acc: 0.704
Validation loss decreased (-0.671045 --> -0.703940).  Saving model ...
Epoch: 11 cost time: 1.5249481201171875
Epoch: 11, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.672 Vali Acc: 0.743 Test Loss: 0.672 Test Acc: 0.743
Validation loss decreased (-0.703940 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 1.5528011322021484
Epoch: 12, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.3309779167175293
Epoch: 13, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.607 Vali Acc: 0.750 Test Loss: 0.607 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.4208111763000488
Epoch: 14, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.6233859062194824
Epoch: 15, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.4764952659606934
Epoch: 16, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.558 Vali Acc: 0.796 Test Loss: 0.558 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.392136812210083
Epoch: 17, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.5472049713134766
Epoch: 18, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 1.4446909427642822
Epoch: 19, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3697044849395752
Epoch: 20, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.458733320236206
Epoch: 21, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1414000988006592
Epoch: 22, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.461536169052124
Epoch: 23, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 24 cost time: 1.192497968673706
Epoch: 24, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.555849313735962
Epoch: 25, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 26 cost time: 1.4553911685943604
Epoch: 26, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6545794010162354
Epoch: 27, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 28 cost time: 1.3688418865203857
Epoch: 28, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 29 cost time: 1.3184642791748047
Epoch: 29, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.476991891860962
Epoch: 30, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6870391368865967
Epoch: 31, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.092773199081421
Epoch: 32, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.083281993865967
Epoch: 33, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3878381252288818
Epoch: 34, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.576 Vali Acc: 0.809 Test Loss: 0.576 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2923622131347656
Epoch: 35, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.579 Vali Acc: 0.796 Test Loss: 0.579 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.5441548824310303
Epoch: 36, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1840481758117676
Epoch: 37, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.9422180652618408
Epoch: 38, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 31108
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.005080699920654
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.332 Vali Acc: 0.355 Test Loss: 1.332 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.755911111831665
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.179 Vali Acc: 0.493 Test Loss: 1.179 Test Acc: 0.493
Validation loss decreased (-0.355250 --> -0.493409).  Saving model ...
Epoch: 3 cost time: 1.5347332954406738
Epoch: 3, Steps: 10 | Train Loss: 0.993 Vali Loss: 0.984 Vali Acc: 0.618 Test Loss: 0.984 Test Acc: 0.618
Validation loss decreased (-0.493409 --> -0.618411).  Saving model ...
Epoch: 4 cost time: 1.5632216930389404
Epoch: 4, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.818 Vali Acc: 0.664 Test Loss: 0.818 Test Acc: 0.664
Validation loss decreased (-0.618411 --> -0.664466).  Saving model ...
Epoch: 5 cost time: 2.282515525817871
Epoch: 5, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.701 Vali Acc: 0.724 Test Loss: 0.701 Test Acc: 0.724
Validation loss decreased (-0.664466 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.5417110919952393
Epoch: 6, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.627 Vali Acc: 0.770 Test Loss: 0.627 Test Acc: 0.770
Validation loss decreased (-0.723677 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.8944966793060303
Epoch: 7, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.4249472618103027
Epoch: 8, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
Validation loss decreased (-0.769731 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.764045000076294
Epoch: 9, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.505 Vali Acc: 0.783 Test Loss: 0.505 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6011574268341064
Epoch: 10, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 11 cost time: 1.6847209930419922
Epoch: 11, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.4702203273773193
Epoch: 12, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4686212539672852
Epoch: 13, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 1.7193291187286377
Epoch: 14, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 15 cost time: 1.8301360607147217
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6654751300811768
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5219550132751465
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9993233680725098
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8494658470153809
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 20 cost time: 1.4257838726043701
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.511603832244873
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.525862455368042
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4845249652862549
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3970510959625244
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2270762920379639
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.527712345123291
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4979910850524902
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7042169570922852
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.03385329246521
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 40260
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.872515439987183
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.340 Vali Acc: 0.375 Test Loss: 1.340 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.42724609375
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.252 Vali Acc: 0.434 Test Loss: 1.252 Test Acc: 0.434
Validation loss decreased (-0.374987 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 1.3654649257659912
Epoch: 3, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.148 Vali Acc: 0.513 Test Loss: 1.148 Test Acc: 0.513
Validation loss decreased (-0.434198 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 1.3750982284545898
Epoch: 4, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.028 Vali Acc: 0.599 Test Loss: 1.028 Test Acc: 0.599
Validation loss decreased (-0.513146 --> -0.598674).  Saving model ...
Epoch: 5 cost time: 1.5990681648254395
Epoch: 5, Steps: 10 | Train Loss: 0.874 Vali Loss: 0.912 Vali Acc: 0.664 Test Loss: 0.912 Test Acc: 0.664
Validation loss decreased (-0.598674 --> -0.664465).  Saving model ...
Epoch: 6 cost time: 1.660902500152588
Epoch: 6, Steps: 10 | Train Loss: 0.744 Vali Loss: 0.817 Vali Acc: 0.691 Test Loss: 0.817 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690781).  Saving model ...
Epoch: 7 cost time: 1.5393288135528564
Epoch: 7, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.740 Vali Acc: 0.717 Test Loss: 0.740 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.0994906425476074
Epoch: 8, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.687 Vali Acc: 0.730 Test Loss: 0.687 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 1.7770717144012451
Epoch: 9, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.636 Vali Acc: 0.724 Test Loss: 0.636 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8405394554138184
Epoch: 10, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
Validation loss decreased (-0.730256 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.5536575317382812
Epoch: 11, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.8785667419433594
Epoch: 12, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.864366054534912
Epoch: 13, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.9418528079986572
Epoch: 14, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.355018138885498
Epoch: 15, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5399994850158691
Epoch: 16, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4297358989715576
Epoch: 17, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.501 Vali Acc: 0.763 Test Loss: 0.501 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4259860515594482
Epoch: 18, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.497 Vali Acc: 0.796 Test Loss: 0.497 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5654571056365967
Epoch: 19, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.677398443222046
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.2957136631011963
Epoch: 21, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5579745769500732
Epoch: 22, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5291850566864014
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5280780792236328
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.522 Vali Acc: 0.822 Test Loss: 0.522 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 25 cost time: 2.0002031326293945
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7203071117401123
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5612635612487793
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.50443696975708
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.624192714691162
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5646154880523682
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5845434665679932
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.575523853302002
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.571 Vali Acc: 0.829 Test Loss: 0.571 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 33 cost time: 1.2250347137451172
Epoch: 33, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.829 Test Loss: 0.579 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.874915361404419
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.470890760421753
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4640429019927979
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.967216968536377
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.7003071308135986
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.9736099243164062
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.8361742496490479
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.7056360244750977
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.611 Vali Acc: 0.816 Test Loss: 0.611 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6387476921081543
Epoch: 42, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 28772
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.199880599975586
Epoch: 1, Steps: 10 | Train Loss: 1.547 Vali Loss: 1.441 Vali Acc: 0.329 Test Loss: 1.441 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 1.4107577800750732
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.337 Vali Acc: 0.434 Test Loss: 1.337 Test Acc: 0.434
Validation loss decreased (-0.328933 --> -0.434197).  Saving model ...
Epoch: 3 cost time: 1.6556382179260254
Epoch: 3, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.220 Vali Acc: 0.480 Test Loss: 1.220 Test Acc: 0.480
Validation loss decreased (-0.434197 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 1.8754713535308838
Epoch: 4, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.108 Vali Acc: 0.572 Test Loss: 1.108 Test Acc: 0.572
Validation loss decreased (-0.480251 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 1.6561667919158936
Epoch: 5, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.007 Vali Acc: 0.605 Test Loss: 1.007 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605253).  Saving model ...
Epoch: 6 cost time: 1.7021753787994385
Epoch: 6, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.917 Vali Acc: 0.632 Test Loss: 0.917 Test Acc: 0.632
Validation loss decreased (-0.605253 --> -0.631570).  Saving model ...
Epoch: 7 cost time: 1.5053987503051758
Epoch: 7, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.827 Vali Acc: 0.651 Test Loss: 0.827 Test Acc: 0.651
Validation loss decreased (-0.631570 --> -0.651308).  Saving model ...
Epoch: 8 cost time: 1.7807292938232422
Epoch: 8, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.758 Vali Acc: 0.671 Test Loss: 0.758 Test Acc: 0.671
Validation loss decreased (-0.651308 --> -0.671045).  Saving model ...
Epoch: 9 cost time: 1.4394817352294922
Epoch: 9, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.706 Vali Acc: 0.697 Test Loss: 0.706 Test Acc: 0.697
Validation loss decreased (-0.671045 --> -0.697361).  Saving model ...
Epoch: 10 cost time: 1.6778602600097656
Epoch: 10, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.661 Vali Acc: 0.717 Test Loss: 0.661 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717099).  Saving model ...
Epoch: 11 cost time: 1.4917991161346436
Epoch: 11, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736836).  Saving model ...
Epoch: 12 cost time: 1.8467872142791748
Epoch: 12, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.583 Vali Acc: 0.724 Test Loss: 0.583 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0053677558898926
Epoch: 13, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.557 Vali Acc: 0.750 Test Loss: 0.557 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.5322508811950684
Epoch: 14, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.545 Vali Acc: 0.757 Test Loss: 0.545 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 1.789764404296875
Epoch: 15, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763153).  Saving model ...
Epoch: 16 cost time: 1.6268467903137207
Epoch: 16, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.763153 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.882786750793457
Epoch: 17, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 18 cost time: 1.4870936870574951
Epoch: 18, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 19 cost time: 1.7063968181610107
Epoch: 19, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
Validation loss decreased (-0.796048 --> -0.815784).  Saving model ...
Epoch: 20 cost time: 1.655632734298706
Epoch: 20, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6876578330993652
Epoch: 21, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.415386438369751
Epoch: 22, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0061087608337402
Epoch: 23, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3643877506256104
Epoch: 24, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.816009759902954
Epoch: 25, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0807650089263916
Epoch: 26, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.065786838531494
Epoch: 27, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.168851852416992
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8972597122192383
Epoch: 29, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 24996
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.448101282119751
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.434 Vali Acc: 0.289 Test Loss: 1.434 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 1.7704343795776367
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.322 Vali Acc: 0.349 Test Loss: 1.322 Test Acc: 0.349
Validation loss decreased (-0.289459 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 1.430072546005249
Epoch: 3, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.219 Vali Acc: 0.474 Test Loss: 1.219 Test Acc: 0.474
Validation loss decreased (-0.348671 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 1.79384183883667
Epoch: 4, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.113 Vali Acc: 0.526 Test Loss: 1.113 Test Acc: 0.526
Validation loss decreased (-0.473672 --> -0.526305).  Saving model ...
Epoch: 5 cost time: 1.470442295074463
Epoch: 5, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.013 Vali Acc: 0.579 Test Loss: 1.013 Test Acc: 0.579
Validation loss decreased (-0.526305 --> -0.578937).  Saving model ...
Epoch: 6 cost time: 1.6246581077575684
Epoch: 6, Steps: 10 | Train Loss: 0.877 Vali Loss: 0.929 Vali Acc: 0.625 Test Loss: 0.929 Test Acc: 0.625
Validation loss decreased (-0.578937 --> -0.624991).  Saving model ...
Epoch: 7 cost time: 1.55678129196167
Epoch: 7, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.851 Vali Acc: 0.645 Test Loss: 0.851 Test Acc: 0.645
Validation loss decreased (-0.624991 --> -0.644728).  Saving model ...
Epoch: 8 cost time: 1.299095630645752
Epoch: 8, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.781 Vali Acc: 0.671 Test Loss: 0.781 Test Acc: 0.671
Validation loss decreased (-0.644728 --> -0.671045).  Saving model ...
Epoch: 9 cost time: 1.2442376613616943
Epoch: 9, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.722 Vali Acc: 0.684 Test Loss: 0.722 Test Acc: 0.684
Validation loss decreased (-0.671045 --> -0.684203).  Saving model ...
Epoch: 10 cost time: 1.683908224105835
Epoch: 10, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.674 Vali Acc: 0.711 Test Loss: 0.674 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710520).  Saving model ...
Epoch: 11 cost time: 1.7548208236694336
Epoch: 11, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.639 Vali Acc: 0.724 Test Loss: 0.639 Test Acc: 0.724
Validation loss decreased (-0.710520 --> -0.723678).  Saving model ...
Epoch: 12 cost time: 1.310398817062378
Epoch: 12, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.615 Vali Acc: 0.730 Test Loss: 0.615 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 13 cost time: 1.1683485507965088
Epoch: 13, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.584 Vali Acc: 0.750 Test Loss: 0.584 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.4359326362609863
Epoch: 14, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.43056321144104
Epoch: 15, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.545 Vali Acc: 0.776 Test Loss: 0.545 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.547356367111206
Epoch: 16, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.2941796779632568
Epoch: 17, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.3288819789886475
Epoch: 18, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3041963577270508
Epoch: 19, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.5441112518310547
Epoch: 20, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5128846168518066
Epoch: 21, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 1.3304462432861328
Epoch: 22, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.733415126800537
Epoch: 23, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4322326183319092
Epoch: 24, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5039563179016113
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4307887554168701
Epoch: 26, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.525 Vali Acc: 0.816 Test Loss: 0.525 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 27 cost time: 1.3569743633270264
Epoch: 27, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6769835948944092
Epoch: 28, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2360813617706299
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2056388854980469
Epoch: 30, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3570926189422607
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5239105224609375
Epoch: 32, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3888225555419922
Epoch: 33, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.094649076461792
Epoch: 34, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 35 cost time: 1.2533624172210693
Epoch: 35, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4375371932983398
Epoch: 36, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7786002159118652
Epoch: 37, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.809020757675171
Epoch: 38, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.377351999282837
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2952136993408203
Epoch: 40, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.6816952228546143
Epoch: 41, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.6832234859466553
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.602771520614624
Epoch: 43, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.629420518875122
Epoch: 44, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.593 Vali Acc: 0.816 Test Loss: 0.593 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 25028
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.324294805526733
Epoch: 1, Steps: 10 | Train Loss: 1.617 Vali Loss: 1.579 Vali Acc: 0.257 Test Loss: 1.579 Test Acc: 0.257
Validation loss decreased (inf --> -0.256563).  Saving model ...
Epoch: 2 cost time: 1.2822160720825195
Epoch: 2, Steps: 10 | Train Loss: 1.516 Vali Loss: 1.497 Vali Acc: 0.296 Test Loss: 1.497 Test Acc: 0.296
Validation loss decreased (-0.256563 --> -0.296038).  Saving model ...
Epoch: 3 cost time: 1.6805169582366943
Epoch: 3, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.405 Vali Acc: 0.322 Test Loss: 1.405 Test Acc: 0.322
Validation loss decreased (-0.296038 --> -0.322354).  Saving model ...
Epoch: 4 cost time: 1.4435615539550781
Epoch: 4, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.306 Vali Acc: 0.428 Test Loss: 1.306 Test Acc: 0.428
Validation loss decreased (-0.322354 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 1.433110237121582
Epoch: 5, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.212 Vali Acc: 0.526 Test Loss: 1.212 Test Acc: 0.526
Validation loss decreased (-0.427619 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 1.3321478366851807
Epoch: 6, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.120 Vali Acc: 0.586 Test Loss: 1.120 Test Acc: 0.586
Validation loss decreased (-0.526304 --> -0.585515).  Saving model ...
Epoch: 7 cost time: 1.2833127975463867
Epoch: 7, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.037 Vali Acc: 0.605 Test Loss: 1.037 Test Acc: 0.605
Validation loss decreased (-0.585515 --> -0.605253).  Saving model ...
Epoch: 8 cost time: 1.424109935760498
Epoch: 8, Steps: 10 | Train Loss: 0.841 Vali Loss: 0.970 Vali Acc: 0.625 Test Loss: 0.970 Test Acc: 0.625
Validation loss decreased (-0.605253 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 1.1851215362548828
Epoch: 9, Steps: 10 | Train Loss: 0.787 Vali Loss: 0.909 Vali Acc: 0.612 Test Loss: 0.909 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3304553031921387
Epoch: 10, Steps: 10 | Train Loss: 0.640 Vali Loss: 0.851 Vali Acc: 0.651 Test Loss: 0.851 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651307).  Saving model ...
Epoch: 11 cost time: 1.5093262195587158
Epoch: 11, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.795 Vali Acc: 0.678 Test Loss: 0.795 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677624).  Saving model ...
Epoch: 12 cost time: 1.4962992668151855
Epoch: 12, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.748 Vali Acc: 0.691 Test Loss: 0.748 Test Acc: 0.691
Validation loss decreased (-0.677624 --> -0.690782).  Saving model ...
Epoch: 13 cost time: 1.6140468120574951
Epoch: 13, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.712 Vali Acc: 0.717 Test Loss: 0.712 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 14 cost time: 1.3634545803070068
Epoch: 14, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.681 Vali Acc: 0.730 Test Loss: 0.681 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 1.677992343902588
Epoch: 15, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.654 Vali Acc: 0.737 Test Loss: 0.654 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 16 cost time: 1.7914817333221436
Epoch: 16, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 17 cost time: 1.7597558498382568
Epoch: 17, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.613 Vali Acc: 0.750 Test Loss: 0.613 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 1.4081056118011475
Epoch: 18, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 19 cost time: 1.463716745376587
Epoch: 19, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.597 Vali Acc: 0.750 Test Loss: 0.597 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3882696628570557
Epoch: 20, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.591 Vali Acc: 0.763 Test Loss: 0.591 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 21 cost time: 1.5207092761993408
Epoch: 21, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.585 Vali Acc: 0.750 Test Loss: 0.585 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6109426021575928
Epoch: 22, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.583 Vali Acc: 0.750 Test Loss: 0.583 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8494281768798828
Epoch: 23, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.583 Vali Acc: 0.757 Test Loss: 0.583 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5776543617248535
Epoch: 24, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6659166812896729
Epoch: 25, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.435471534729004
Epoch: 26, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4521236419677734
Epoch: 27, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 28 cost time: 1.7842071056365967
Epoch: 28, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.581 Vali Acc: 0.770 Test Loss: 0.581 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 1.3480429649353027
Epoch: 29, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 30 cost time: 1.6308567523956299
Epoch: 30, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6415610313415527
Epoch: 31, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.577 Vali Acc: 0.763 Test Loss: 0.577 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3109393119812012
Epoch: 32, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.579 Vali Acc: 0.770 Test Loss: 0.579 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.447155475616455
Epoch: 33, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.580 Vali Acc: 0.763 Test Loss: 0.580 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4990849494934082
Epoch: 34, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.578 Vali Acc: 0.770 Test Loss: 0.578 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.1510720252990723
Epoch: 35, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.584 Vali Acc: 0.770 Test Loss: 0.584 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.6302437782287598
Epoch: 36, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.01888108253479
Epoch: 37, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.600 Vali Acc: 0.770 Test Loss: 0.600 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.4846110343933105
Epoch: 38, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.609 Vali Acc: 0.770 Test Loss: 0.609 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3006057739257812
Epoch: 39, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.612 Vali Acc: 0.770 Test Loss: 0.612 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 22788
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.442023038864136
Epoch: 1, Steps: 10 | Train Loss: 1.557 Vali Loss: 1.489 Vali Acc: 0.329 Test Loss: 1.489 Test Acc: 0.329
Validation loss decreased (inf --> -0.328932).  Saving model ...
Epoch: 2 cost time: 1.6347403526306152
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.351 Vali Acc: 0.368 Test Loss: 1.351 Test Acc: 0.368
Validation loss decreased (-0.328932 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.7883186340332031
Epoch: 3, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.211 Vali Acc: 0.474 Test Loss: 1.211 Test Acc: 0.474
Validation loss decreased (-0.368408 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 2.0494015216827393
Epoch: 4, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.088 Vali Acc: 0.566 Test Loss: 1.088 Test Acc: 0.566
Validation loss decreased (-0.473672 --> -0.565779).  Saving model ...
Epoch: 5 cost time: 1.449202537536621
Epoch: 5, Steps: 10 | Train Loss: 0.948 Vali Loss: 0.988 Vali Acc: 0.618 Test Loss: 0.988 Test Acc: 0.618
Validation loss decreased (-0.565779 --> -0.618411).  Saving model ...
Epoch: 6 cost time: 1.8410189151763916
Epoch: 6, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.873 Vali Acc: 0.664 Test Loss: 0.873 Test Acc: 0.664
Validation loss decreased (-0.618411 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 1.8981029987335205
Epoch: 7, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.796 Vali Acc: 0.717 Test Loss: 0.796 Test Acc: 0.717
Validation loss decreased (-0.664465 --> -0.717097).  Saving model ...
Epoch: 8 cost time: 1.5762701034545898
Epoch: 8, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.712 Vali Acc: 0.743 Test Loss: 0.712 Test Acc: 0.743
Validation loss decreased (-0.717097 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 2.3680942058563232
Epoch: 9, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.656 Vali Acc: 0.770 Test Loss: 0.656 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769730).  Saving model ...
Epoch: 10 cost time: 2.149092197418213
Epoch: 10, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
Validation loss decreased (-0.769730 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.3918590545654297
Epoch: 11, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.574 Vali Acc: 0.796 Test Loss: 0.574 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.731719970703125
Epoch: 12, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 2.0506081581115723
Epoch: 13, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.61203932762146
Epoch: 14, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.5991291999816895
Epoch: 15, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.9568545818328857
Epoch: 16, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 1.8777754306793213
Epoch: 17, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.790576696395874
Epoch: 18, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 19 cost time: 1.8561224937438965
Epoch: 19, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.047330856323242
Epoch: 20, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 21 cost time: 1.8388278484344482
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8993947505950928
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.000800371170044
Epoch: 23, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 24 cost time: 1.761192798614502
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7257156372070312
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6628313064575195
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4900016784667969
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.750577688217163
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5943119525909424
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.2267587184906006
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8684744834899902
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.595 Vali Acc: 0.816 Test Loss: 0.595 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6719024181365967
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.2838778495788574
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.593 Vali Acc: 0.816 Test Loss: 0.593 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 30820
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.792440176010132
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.446 Vali Acc: 0.276 Test Loss: 1.446 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 1.56681227684021
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.394 Vali Acc: 0.355 Test Loss: 1.394 Test Acc: 0.355
Validation loss decreased (-0.276301 --> -0.355249).  Saving model ...
Epoch: 3 cost time: 2.0474348068237305
Epoch: 3, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.317 Vali Acc: 0.414 Test Loss: 1.317 Test Acc: 0.414
Validation loss decreased (-0.355249 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 1.7998502254486084
Epoch: 4, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.233 Vali Acc: 0.487 Test Loss: 1.233 Test Acc: 0.487
Validation loss decreased (-0.414461 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 1.9899709224700928
Epoch: 5, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.151 Vali Acc: 0.559 Test Loss: 1.151 Test Acc: 0.559
Validation loss decreased (-0.486830 --> -0.559199).  Saving model ...
Epoch: 6 cost time: 2.1082890033721924
Epoch: 6, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.067 Vali Acc: 0.579 Test Loss: 1.067 Test Acc: 0.579
Validation loss decreased (-0.559199 --> -0.578937).  Saving model ...
Epoch: 7 cost time: 2.3579540252685547
Epoch: 7, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.984 Vali Acc: 0.618 Test Loss: 0.984 Test Acc: 0.618
Validation loss decreased (-0.578937 --> -0.618411).  Saving model ...
Epoch: 8 cost time: 2.225827693939209
Epoch: 8, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.910 Vali Acc: 0.625 Test Loss: 0.910 Test Acc: 0.625
Validation loss decreased (-0.618411 --> -0.624991).  Saving model ...
Epoch: 9 cost time: 1.757192850112915
Epoch: 9, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.844 Vali Acc: 0.638 Test Loss: 0.844 Test Acc: 0.638
Validation loss decreased (-0.624991 --> -0.638149).  Saving model ...
Epoch: 10 cost time: 1.936962366104126
Epoch: 10, Steps: 10 | Train Loss: 0.597 Vali Loss: 0.782 Vali Acc: 0.664 Test Loss: 0.782 Test Acc: 0.664
Validation loss decreased (-0.638149 --> -0.664466).  Saving model ...
Epoch: 11 cost time: 2.468874454498291
Epoch: 11, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.725 Vali Acc: 0.664 Test Loss: 0.725 Test Acc: 0.664
Validation loss decreased (-0.664466 --> -0.664466).  Saving model ...
Epoch: 12 cost time: 2.4709880352020264
Epoch: 12, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.675 Vali Acc: 0.704 Test Loss: 0.675 Test Acc: 0.704
Validation loss decreased (-0.664466 --> -0.703941).  Saving model ...
Epoch: 13 cost time: 1.9220571517944336
Epoch: 13, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.634 Vali Acc: 0.724 Test Loss: 0.634 Test Acc: 0.724
Validation loss decreased (-0.703941 --> -0.723678).  Saving model ...
Epoch: 14 cost time: 1.8134102821350098
Epoch: 14, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.597 Vali Acc: 0.776 Test Loss: 0.597 Test Acc: 0.776
Validation loss decreased (-0.723678 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 2.2148101329803467
Epoch: 15, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.8666377067565918
Epoch: 16, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.5136895179748535
Epoch: 17, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.7674336433410645
Epoch: 18, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 2.119455575942993
Epoch: 19, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.588101863861084
Epoch: 20, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0113778114318848
Epoch: 21, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 22 cost time: 1.6729247570037842
Epoch: 22, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6411218643188477
Epoch: 23, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 24 cost time: 1.5621366500854492
Epoch: 24, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8890316486358643
Epoch: 25, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8669042587280273
Epoch: 26, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 27 cost time: 1.724644660949707
Epoch: 27, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7147102355957031
Epoch: 28, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5450334548950195
Epoch: 29, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7551348209381104
Epoch: 30, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7252838611602783
Epoch: 31, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5582880973815918
Epoch: 32, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.523 Vali Acc: 0.829 Test Loss: 0.523 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 33 cost time: 1.7419776916503906
Epoch: 33, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.527 Vali Acc: 0.822 Test Loss: 0.527 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3062288761138916
Epoch: 34, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.529 Vali Acc: 0.829 Test Loss: 0.529 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7606546878814697
Epoch: 35, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.532 Vali Acc: 0.829 Test Loss: 0.532 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8306772708892822
Epoch: 36, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5269238948822021
Epoch: 37, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.7074825763702393
Epoch: 38, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.568683385848999
Epoch: 39, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.779341697692871
Epoch: 40, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.91640305519104
Epoch: 41, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.854630470275879
Epoch: 42, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 25076
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.574130058288574
Epoch: 1, Steps: 10 | Train Loss: 1.566 Vali Loss: 1.497 Vali Acc: 0.224 Test Loss: 1.497 Test Acc: 0.224
Validation loss decreased (inf --> -0.223669).  Saving model ...
Epoch: 2 cost time: 2.0146243572235107
Epoch: 2, Steps: 10 | Train Loss: 1.537 Vali Loss: 1.423 Vali Acc: 0.289 Test Loss: 1.423 Test Acc: 0.289
Validation loss decreased (-0.223669 --> -0.289459).  Saving model ...
Epoch: 3 cost time: 1.8553569316864014
Epoch: 3, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.336 Vali Acc: 0.388 Test Loss: 1.336 Test Acc: 0.388
Validation loss decreased (-0.289459 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 1.5351324081420898
Epoch: 4, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.250 Vali Acc: 0.447 Test Loss: 1.250 Test Acc: 0.447
Validation loss decreased (-0.388145 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 1.6825103759765625
Epoch: 5, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.159 Vali Acc: 0.533 Test Loss: 1.159 Test Acc: 0.533
Validation loss decreased (-0.447356 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 1.7051968574523926
Epoch: 6, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.079 Vali Acc: 0.605 Test Loss: 1.079 Test Acc: 0.605
Validation loss decreased (-0.532883 --> -0.605252).  Saving model ...
Epoch: 7 cost time: 1.2840659618377686
Epoch: 7, Steps: 10 | Train Loss: 1.037 Vali Loss: 0.995 Vali Acc: 0.671 Test Loss: 0.995 Test Acc: 0.671
Validation loss decreased (-0.605252 --> -0.671043).  Saving model ...
Epoch: 8 cost time: 1.3628685474395752
Epoch: 8, Steps: 10 | Train Loss: 0.907 Vali Loss: 0.920 Vali Acc: 0.697 Test Loss: 0.920 Test Acc: 0.697
Validation loss decreased (-0.671043 --> -0.697359).  Saving model ...
Epoch: 9 cost time: 1.8188185691833496
Epoch: 9, Steps: 10 | Train Loss: 0.835 Vali Loss: 0.860 Vali Acc: 0.737 Test Loss: 0.860 Test Acc: 0.737
Validation loss decreased (-0.697359 --> -0.736834).  Saving model ...
Epoch: 10 cost time: 1.6512391567230225
Epoch: 10, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.803 Vali Acc: 0.757 Test Loss: 0.803 Test Acc: 0.757
Validation loss decreased (-0.736834 --> -0.756571).  Saving model ...
Epoch: 11 cost time: 1.4755499362945557
Epoch: 11, Steps: 10 | Train Loss: 0.651 Vali Loss: 0.754 Vali Acc: 0.763 Test Loss: 0.754 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763150).  Saving model ...
Epoch: 12 cost time: 1.6635558605194092
Epoch: 12, Steps: 10 | Train Loss: 0.597 Vali Loss: 0.707 Vali Acc: 0.776 Test Loss: 0.707 Test Acc: 0.776
Validation loss decreased (-0.763150 --> -0.776309).  Saving model ...
Epoch: 13 cost time: 1.6189725399017334
Epoch: 13, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.666 Vali Acc: 0.770 Test Loss: 0.666 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8900671005249023
Epoch: 14, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.639 Vali Acc: 0.789 Test Loss: 0.639 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 15 cost time: 1.635737657546997
Epoch: 15, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.614 Vali Acc: 0.789 Test Loss: 0.614 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.4648821353912354
Epoch: 16, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.450944423675537
Epoch: 17, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6111807823181152
Epoch: 18, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8183140754699707
Epoch: 19, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.67718505859375
Epoch: 20, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 1.8014163970947266
Epoch: 21, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 22 cost time: 1.376985788345337
Epoch: 22, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7235443592071533
Epoch: 23, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 24 cost time: 1.674901008605957
Epoch: 24, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7563929557800293
Epoch: 25, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.500 Vali Acc: 0.776 Test Loss: 0.500 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6043848991394043
Epoch: 26, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 27 cost time: 1.4652445316314697
Epoch: 27, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.489 Vali Acc: 0.783 Test Loss: 0.489 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6011979579925537
Epoch: 28, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 29 cost time: 1.4933381080627441
Epoch: 29, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.486 Vali Acc: 0.796 Test Loss: 0.486 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.76694917678833
Epoch: 30, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.483 Vali Acc: 0.789 Test Loss: 0.483 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5365338325500488
Epoch: 31, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.477 Vali Acc: 0.803 Test Loss: 0.477 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 32 cost time: 1.5743892192840576
Epoch: 32, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 33 cost time: 1.7448761463165283
Epoch: 33, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.476 Vali Acc: 0.803 Test Loss: 0.476 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6385619640350342
Epoch: 34, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6931302547454834
Epoch: 35, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3482327461242676
Epoch: 36, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 37 cost time: 2.030264139175415
Epoch: 37, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.60182785987854
Epoch: 38, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 39 cost time: 1.3991780281066895
Epoch: 39, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 40 cost time: 1.5560402870178223
Epoch: 40, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6137735843658447
Epoch: 41, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.482 Vali Acc: 0.816 Test Loss: 0.482 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.6283462047576904
Epoch: 42, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.483 Vali Acc: 0.822 Test Loss: 0.483 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 43 cost time: 1.5517659187316895
Epoch: 43, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.484 Vali Acc: 0.829 Test Loss: 0.484 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 44 cost time: 1.9821934700012207
Epoch: 44, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6420578956604004
Epoch: 45, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.484 Vali Acc: 0.822 Test Loss: 0.484 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6501708030700684
Epoch: 46, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.796630859375
Epoch: 47, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6763546466827393
Epoch: 48, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.9483575820922852
Epoch: 49, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.489 Vali Acc: 0.836 Test Loss: 0.489 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835521).  Saving model ...
Epoch: 50 cost time: 1.4821078777313232
Epoch: 50, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.5569922924041748
Epoch: 51, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.489 Vali Acc: 0.836 Test Loss: 0.489 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 52 cost time: 1.5330209732055664
Epoch: 52, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.491 Vali Acc: 0.829 Test Loss: 0.491 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.8549575805664062
Epoch: 53, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.8708584308624268
Epoch: 54, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.507 Vali Acc: 0.829 Test Loss: 0.507 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.6412549018859863
Epoch: 55, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.501 Vali Acc: 0.829 Test Loss: 0.501 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.721177577972412
Epoch: 56, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.504 Vali Acc: 0.829 Test Loss: 0.504 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.5665392875671387
Epoch: 57, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.513 Vali Acc: 0.829 Test Loss: 0.513 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.8372056484222412
Epoch: 58, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.778578758239746
Epoch: 59, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.510 Vali Acc: 0.829 Test Loss: 0.510 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.6477794647216797
Epoch: 60, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.516 Vali Acc: 0.829 Test Loss: 0.516 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.796191930770874
Epoch: 61, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 23188
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.1075279712677
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.475 Vali Acc: 0.158 Test Loss: 1.475 Test Acc: 0.158
Validation loss decreased (inf --> -0.157880).  Saving model ...
Epoch: 2 cost time: 1.2034978866577148
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.429 Vali Acc: 0.211 Test Loss: 1.429 Test Acc: 0.211
Validation loss decreased (-0.157880 --> -0.210512).  Saving model ...
Epoch: 3 cost time: 1.5261988639831543
Epoch: 3, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.369 Vali Acc: 0.309 Test Loss: 1.369 Test Acc: 0.309
Validation loss decreased (-0.210512 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 1.467557668685913
Epoch: 4, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.303 Vali Acc: 0.382 Test Loss: 1.303 Test Acc: 0.382
Validation loss decreased (-0.309197 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 1.2642042636871338
Epoch: 5, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.225 Vali Acc: 0.454 Test Loss: 1.225 Test Acc: 0.454
Validation loss decreased (-0.381566 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 1.3850593566894531
Epoch: 6, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.150 Vali Acc: 0.520 Test Loss: 1.150 Test Acc: 0.520
Validation loss decreased (-0.453935 --> -0.519725).  Saving model ...
Epoch: 7 cost time: 1.8330638408660889
Epoch: 7, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.080 Vali Acc: 0.566 Test Loss: 1.080 Test Acc: 0.566
Validation loss decreased (-0.519725 --> -0.565779).  Saving model ...
Epoch: 8 cost time: 1.428360939025879
Epoch: 8, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.014 Vali Acc: 0.599 Test Loss: 1.014 Test Acc: 0.599
Validation loss decreased (-0.565779 --> -0.598674).  Saving model ...
Epoch: 9 cost time: 1.32767915725708
Epoch: 9, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.948 Vali Acc: 0.618 Test Loss: 0.948 Test Acc: 0.618
Validation loss decreased (-0.598674 --> -0.618412).  Saving model ...
Epoch: 10 cost time: 1.5350580215454102
Epoch: 10, Steps: 10 | Train Loss: 0.704 Vali Loss: 0.881 Vali Acc: 0.638 Test Loss: 0.881 Test Acc: 0.638
Validation loss decreased (-0.618412 --> -0.638149).  Saving model ...
Epoch: 11 cost time: 1.4633371829986572
Epoch: 11, Steps: 10 | Train Loss: 0.704 Vali Loss: 0.820 Vali Acc: 0.658 Test Loss: 0.820 Test Acc: 0.658
Validation loss decreased (-0.638149 --> -0.657887).  Saving model ...
Epoch: 12 cost time: 1.4723396301269531
Epoch: 12, Steps: 10 | Train Loss: 0.608 Vali Loss: 0.773 Vali Acc: 0.671 Test Loss: 0.773 Test Acc: 0.671
Validation loss decreased (-0.657887 --> -0.671045).  Saving model ...
Epoch: 13 cost time: 2.2193753719329834
Epoch: 13, Steps: 10 | Train Loss: 0.541 Vali Loss: 0.737 Vali Acc: 0.678 Test Loss: 0.737 Test Acc: 0.678
Validation loss decreased (-0.671045 --> -0.677624).  Saving model ...
Epoch: 14 cost time: 1.8894600868225098
Epoch: 14, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.689 Vali Acc: 0.684 Test Loss: 0.689 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684204).  Saving model ...
Epoch: 15 cost time: 1.3950252532958984
Epoch: 15, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.655 Vali Acc: 0.724 Test Loss: 0.655 Test Acc: 0.724
Validation loss decreased (-0.684204 --> -0.723678).  Saving model ...
Epoch: 16 cost time: 1.6503486633300781
Epoch: 16, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.624 Vali Acc: 0.757 Test Loss: 0.624 Test Acc: 0.757
Validation loss decreased (-0.723678 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 1.7369496822357178
Epoch: 17, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.600 Vali Acc: 0.770 Test Loss: 0.600 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 18 cost time: 1.8006882667541504
Epoch: 18, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 1.4916059970855713
Epoch: 19, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 1.665818691253662
Epoch: 20, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 21 cost time: 1.7471215724945068
Epoch: 21, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7726373672485352
Epoch: 22, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 1.5418486595153809
Epoch: 23, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 24 cost time: 1.7366514205932617
Epoch: 24, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 25 cost time: 1.8055086135864258
Epoch: 25, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 26 cost time: 1.8398327827453613
Epoch: 26, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.714512586593628
Epoch: 27, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6766188144683838
Epoch: 28, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6117043495178223
Epoch: 29, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.67573881149292
Epoch: 30, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5475826263427734
Epoch: 31, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 32 cost time: 1.2140328884124756
Epoch: 32, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.896460771560669
Epoch: 33, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8749055862426758
Epoch: 34, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.9223580360412598
Epoch: 35, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.7415730953216553
Epoch: 36, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4378650188446045
Epoch: 37, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.666844129562378
Epoch: 38, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.6965751647949219
Epoch: 39, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.4706377983093262
Epoch: 40, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4230067729949951
Epoch: 41, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 42 cost time: 1.5081989765167236
Epoch: 42, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7808082103729248
Epoch: 43, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.586310625076294
Epoch: 44, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.5085089206695557
Epoch: 45, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.807157039642334
Epoch: 46, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 47 cost time: 1.6840016841888428
Epoch: 47, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5214715003967285
Epoch: 48, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.7866237163543701
Epoch: 49, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2980222702026367
Epoch: 50, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 51 cost time: 1.4881267547607422
Epoch: 51, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 52 cost time: 1.6675188541412354
Epoch: 52, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.5297186374664307
Epoch: 53, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.4160926342010498
Epoch: 54, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.8133862018585205
Epoch: 55, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.878753662109375
Epoch: 56, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.5114939212799072
Epoch: 57, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.2773878574371338
Epoch: 58, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.568 Vali Acc: 0.829 Test Loss: 0.568 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 59 cost time: 1.479659080505371
Epoch: 59, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.4442627429962158
Epoch: 60, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.580 Vali Acc: 0.829 Test Loss: 0.580 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.3458409309387207
Epoch: 61, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.576 Vali Acc: 0.829 Test Loss: 0.576 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.2735774517059326
Epoch: 62, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.579 Vali Acc: 0.822 Test Loss: 0.579 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.4082767963409424
Epoch: 63, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.3359599113464355
Epoch: 64, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.5292322635650635
Epoch: 65, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.575 Vali Acc: 0.829 Test Loss: 0.575 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.3197827339172363
Epoch: 66, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.746896743774414
Epoch: 67, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.6063196659088135
Epoch: 68, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.604 Vali Acc: 0.829 Test Loss: 0.604 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 23204
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.565403938293457
Epoch: 1, Steps: 10 | Train Loss: 1.533 Vali Loss: 1.546 Vali Acc: 0.171 Test Loss: 1.546 Test Acc: 0.171
Validation loss decreased (inf --> -0.171037).  Saving model ...
Epoch: 2 cost time: 1.6508255004882812
Epoch: 2, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.506 Vali Acc: 0.171 Test Loss: 1.506 Test Acc: 0.171
Validation loss decreased (-0.171037 --> -0.171038).  Saving model ...
Epoch: 3 cost time: 1.4739420413970947
Epoch: 3, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.450 Vali Acc: 0.230 Test Loss: 1.450 Test Acc: 0.230
Validation loss decreased (-0.171038 --> -0.230249).  Saving model ...
Epoch: 4 cost time: 1.3453969955444336
Epoch: 4, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.387 Vali Acc: 0.329 Test Loss: 1.387 Test Acc: 0.329
Validation loss decreased (-0.230249 --> -0.328933).  Saving model ...
Epoch: 5 cost time: 1.6454334259033203
Epoch: 5, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.317 Vali Acc: 0.362 Test Loss: 1.317 Test Acc: 0.362
Validation loss decreased (-0.328933 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 1.047633171081543
Epoch: 6, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.250 Vali Acc: 0.428 Test Loss: 1.250 Test Acc: 0.428
Validation loss decreased (-0.361829 --> -0.427619).  Saving model ...
Epoch: 7 cost time: 1.7822163105010986
Epoch: 7, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.182 Vali Acc: 0.441 Test Loss: 1.182 Test Acc: 0.441
Validation loss decreased (-0.427619 --> -0.440778).  Saving model ...
Epoch: 8 cost time: 1.4970581531524658
Epoch: 8, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.121 Vali Acc: 0.526 Test Loss: 1.121 Test Acc: 0.526
Validation loss decreased (-0.440778 --> -0.526305).  Saving model ...
Epoch: 9 cost time: 1.8580989837646484
Epoch: 9, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.061 Vali Acc: 0.572 Test Loss: 1.061 Test Acc: 0.572
Validation loss decreased (-0.526305 --> -0.572358).  Saving model ...
Epoch: 10 cost time: 1.4607527256011963
Epoch: 10, Steps: 10 | Train Loss: 0.873 Vali Loss: 1.006 Vali Acc: 0.605 Test Loss: 1.006 Test Acc: 0.605
Validation loss decreased (-0.572358 --> -0.605253).  Saving model ...
Epoch: 11 cost time: 1.4104063510894775
Epoch: 11, Steps: 10 | Train Loss: 0.796 Vali Loss: 0.955 Vali Acc: 0.625 Test Loss: 0.955 Test Acc: 0.625
Validation loss decreased (-0.605253 --> -0.624990).  Saving model ...
Epoch: 12 cost time: 2.1341633796691895
Epoch: 12, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.910 Vali Acc: 0.651 Test Loss: 0.910 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651307).  Saving model ...
Epoch: 13 cost time: 1.926964282989502
Epoch: 13, Steps: 10 | Train Loss: 0.705 Vali Loss: 0.866 Vali Acc: 0.678 Test Loss: 0.866 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 14 cost time: 1.7471179962158203
Epoch: 14, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.824 Vali Acc: 0.678 Test Loss: 0.824 Test Acc: 0.678
Validation loss decreased (-0.677623 --> -0.677623).  Saving model ...
Epoch: 15 cost time: 1.7691032886505127
Epoch: 15, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.784 Vali Acc: 0.684 Test Loss: 0.784 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684203).  Saving model ...
Epoch: 16 cost time: 1.8961234092712402
Epoch: 16, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.753 Vali Acc: 0.684 Test Loss: 0.753 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684203).  Saving model ...
Epoch: 17 cost time: 1.9063222408294678
Epoch: 17, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.729 Vali Acc: 0.704 Test Loss: 0.729 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703940).  Saving model ...
Epoch: 18 cost time: 1.5811989307403564
Epoch: 18, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.706 Vali Acc: 0.711 Test Loss: 0.706 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 19 cost time: 2.0905942916870117
Epoch: 19, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.686 Vali Acc: 0.704 Test Loss: 0.686 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9517533779144287
Epoch: 20, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.668 Vali Acc: 0.724 Test Loss: 0.668 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723678).  Saving model ...
Epoch: 21 cost time: 1.5813400745391846
Epoch: 21, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.655 Vali Acc: 0.730 Test Loss: 0.655 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 22 cost time: 1.5633320808410645
Epoch: 22, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.643 Vali Acc: 0.730 Test Loss: 0.643 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 23 cost time: 1.9161736965179443
Epoch: 23, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.634 Vali Acc: 0.737 Test Loss: 0.634 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 24 cost time: 1.834507703781128
Epoch: 24, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 25 cost time: 1.6140029430389404
Epoch: 25, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.609 Vali Acc: 0.743 Test Loss: 0.609 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 26 cost time: 1.55446457862854
Epoch: 26, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.602 Vali Acc: 0.743 Test Loss: 0.602 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 27 cost time: 1.3527777194976807
Epoch: 27, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.596 Vali Acc: 0.743 Test Loss: 0.596 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 28 cost time: 1.7700786590576172
Epoch: 28, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.593 Vali Acc: 0.750 Test Loss: 0.593 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 29 cost time: 1.6768724918365479
Epoch: 29, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.590 Vali Acc: 0.757 Test Loss: 0.590 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 30 cost time: 1.420243501663208
Epoch: 30, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.581 Vali Acc: 0.750 Test Loss: 0.581 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.887159824371338
Epoch: 31, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6778829097747803
Epoch: 32, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 33 cost time: 1.4413931369781494
Epoch: 33, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.571 Vali Acc: 0.750 Test Loss: 0.571 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4178965091705322
Epoch: 34, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.575 Vali Acc: 0.757 Test Loss: 0.575 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 35 cost time: 1.5281095504760742
Epoch: 35, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5548124313354492
Epoch: 36, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.578 Vali Acc: 0.757 Test Loss: 0.578 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8376781940460205
Epoch: 37, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.490483045578003
Epoch: 38, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5409047603607178
Epoch: 39, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.7440659999847412
Epoch: 40, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 41 cost time: 1.7233607769012451
Epoch: 41, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.573 Vali Acc: 0.757 Test Loss: 0.573 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9878759384155273
Epoch: 42, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.8792130947113037
Epoch: 43, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.8265268802642822
Epoch: 44, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.586 Vali Acc: 0.750 Test Loss: 0.586 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.806225061416626
Epoch: 45, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.586 Vali Acc: 0.750 Test Loss: 0.586 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.992231845855713
Epoch: 46, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.7195243835449219
Epoch: 47, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.9117372035980225
Epoch: 48, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.8400321006774902
Epoch: 49, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.601 Vali Acc: 0.757 Test Loss: 0.601 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.430931568145752
Epoch: 50, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.603 Vali Acc: 0.757 Test Loss: 0.603 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 22084
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.889385938644409
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.331 Vali Acc: 0.414 Test Loss: 1.331 Test Acc: 0.414
Validation loss decreased (inf --> -0.414460).  Saving model ...
Epoch: 2 cost time: 1.396106243133545
Epoch: 2, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.246 Vali Acc: 0.520 Test Loss: 1.246 Test Acc: 0.520
Validation loss decreased (-0.414460 --> -0.519724).  Saving model ...
Epoch: 3 cost time: 1.289491891860962
Epoch: 3, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.158 Vali Acc: 0.566 Test Loss: 1.158 Test Acc: 0.566
Validation loss decreased (-0.519724 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 1.428276538848877
Epoch: 4, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.049 Vali Acc: 0.632 Test Loss: 1.049 Test Acc: 0.632
Validation loss decreased (-0.565778 --> -0.631568).  Saving model ...
Epoch: 5 cost time: 1.3947243690490723
Epoch: 5, Steps: 10 | Train Loss: 0.936 Vali Loss: 0.957 Vali Acc: 0.651 Test Loss: 0.957 Test Acc: 0.651
Validation loss decreased (-0.631568 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 1.7079570293426514
Epoch: 6, Steps: 10 | Train Loss: 0.801 Vali Loss: 0.867 Vali Acc: 0.750 Test Loss: 0.867 Test Acc: 0.750
Validation loss decreased (-0.651306 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 1.6598231792449951
Epoch: 7, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.655083417892456
Epoch: 8, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.715 Vali Acc: 0.743 Test Loss: 0.715 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4689979553222656
Epoch: 9, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.656 Vali Acc: 0.776 Test Loss: 0.656 Test Acc: 0.776
Validation loss decreased (-0.749992 --> -0.776309).  Saving model ...
Epoch: 10 cost time: 2.031045436859131
Epoch: 10, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.618 Vali Acc: 0.743 Test Loss: 0.618 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.071791172027588
Epoch: 11, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.7349743843078613
Epoch: 12, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.560 Vali Acc: 0.796 Test Loss: 0.560 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.177119255065918
Epoch: 13, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.6392345428466797
Epoch: 14, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.6786601543426514
Epoch: 15, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.9104504585266113
Epoch: 16, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7179861068725586
Epoch: 17, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6853113174438477
Epoch: 18, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.016613721847534
Epoch: 19, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1635193824768066
Epoch: 20, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.6813573837280273
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9531912803649902
Epoch: 22, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5930633544921875
Epoch: 23, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9011585712432861
Epoch: 24, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4454565048217773
Epoch: 25, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.81681227684021
Epoch: 26, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0027406215667725
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 28 cost time: 1.5498909950256348
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8006391525268555
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5378119945526123
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.1419217586517334
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7645595073699951
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.739180326461792
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6912596225738525
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.6746480464935303
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.595 Vali Acc: 0.816 Test Loss: 0.595 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.803839921951294
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.928731918334961
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 22372
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.584449291229248
Epoch: 1, Steps: 10 | Train Loss: 1.516 Vali Loss: 1.392 Vali Acc: 0.316 Test Loss: 1.392 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.4587390422821045
Epoch: 2, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.330 Vali Acc: 0.382 Test Loss: 1.330 Test Acc: 0.382
Validation loss decreased (-0.315776 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.2737131118774414
Epoch: 3, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
Validation loss decreased (-0.381566 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.5951144695281982
Epoch: 4, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.183 Vali Acc: 0.559 Test Loss: 1.183 Test Acc: 0.559
Validation loss decreased (-0.499987 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.7218267917633057
Epoch: 5, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.100 Vali Acc: 0.572 Test Loss: 1.100 Test Acc: 0.572
Validation loss decreased (-0.559199 --> -0.572357).  Saving model ...
Epoch: 6 cost time: 1.7074694633483887
Epoch: 6, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.019 Vali Acc: 0.618 Test Loss: 1.019 Test Acc: 0.618
Validation loss decreased (-0.572357 --> -0.618411).  Saving model ...
Epoch: 7 cost time: 1.314957857131958
Epoch: 7, Steps: 10 | Train Loss: 0.923 Vali Loss: 0.946 Vali Acc: 0.638 Test Loss: 0.946 Test Acc: 0.638
Validation loss decreased (-0.618411 --> -0.638148).  Saving model ...
Epoch: 8 cost time: 1.3748695850372314
Epoch: 8, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.877 Vali Acc: 0.658 Test Loss: 0.877 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657886).  Saving model ...
Epoch: 9 cost time: 1.5810375213623047
Epoch: 9, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.820 Vali Acc: 0.671 Test Loss: 0.820 Test Acc: 0.671
Validation loss decreased (-0.657886 --> -0.671044).  Saving model ...
Epoch: 10 cost time: 1.3570027351379395
Epoch: 10, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.751 Vali Acc: 0.678 Test Loss: 0.751 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677624).  Saving model ...
Epoch: 11 cost time: 2.326875686645508
Epoch: 11, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.699 Vali Acc: 0.697 Test Loss: 0.699 Test Acc: 0.697
Validation loss decreased (-0.677624 --> -0.697361).  Saving model ...
Epoch: 12 cost time: 1.347019910812378
Epoch: 12, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.648 Vali Acc: 0.717 Test Loss: 0.648 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717099).  Saving model ...
Epoch: 13 cost time: 1.1776046752929688
Epoch: 13, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.603 Vali Acc: 0.770 Test Loss: 0.603 Test Acc: 0.770
Validation loss decreased (-0.717099 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.5576810836791992
Epoch: 14, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.400770902633667
Epoch: 15, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.47727632522583
Epoch: 16, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 17 cost time: 1.6880998611450195
Epoch: 17, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.495 Vali Acc: 0.796 Test Loss: 0.495 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 18 cost time: 1.404564619064331
Epoch: 18, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.478 Vali Acc: 0.796 Test Loss: 0.478 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 19 cost time: 1.964332103729248
Epoch: 19, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 20 cost time: 1.4841697216033936
Epoch: 20, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.467 Vali Acc: 0.803 Test Loss: 0.467 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.16009521484375
Epoch: 21, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.464 Vali Acc: 0.809 Test Loss: 0.464 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 22 cost time: 1.2687404155731201
Epoch: 22, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1468422412872314
Epoch: 23, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.465 Vali Acc: 0.809 Test Loss: 0.465 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3210053443908691
Epoch: 24, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.459 Vali Acc: 0.816 Test Loss: 0.459 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 25 cost time: 1.4636569023132324
Epoch: 25, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.452 Vali Acc: 0.822 Test Loss: 0.452 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 26 cost time: 1.353865385055542
Epoch: 26, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 27 cost time: 1.2256674766540527
Epoch: 27, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 28 cost time: 1.4100348949432373
Epoch: 28, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.458 Vali Acc: 0.829 Test Loss: 0.458 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 29 cost time: 1.2941875457763672
Epoch: 29, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5013420581817627
Epoch: 30, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.449 Vali Acc: 0.822 Test Loss: 0.449 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.222876787185669
Epoch: 31, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.456 Vali Acc: 0.822 Test Loss: 0.456 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.276193618774414
Epoch: 32, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.456 Vali Acc: 0.822 Test Loss: 0.456 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.6441597938537598
Epoch: 33, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2913739681243896
Epoch: 34, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.459 Vali Acc: 0.829 Test Loss: 0.459 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.405980110168457
Epoch: 35, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.462 Vali Acc: 0.829 Test Loss: 0.462 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3139290809631348
Epoch: 36, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.467 Vali Acc: 0.829 Test Loss: 0.467 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4045875072479248
Epoch: 37, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.406019926071167
Epoch: 38, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 16628
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.333339214324951
Epoch: 1, Steps: 10 | Train Loss: 1.612 Vali Loss: 1.521 Vali Acc: 0.204 Test Loss: 1.521 Test Acc: 0.204
Validation loss decreased (inf --> -0.203932).  Saving model ...
Epoch: 2 cost time: 1.6714873313903809
Epoch: 2, Steps: 10 | Train Loss: 1.504 Vali Loss: 1.479 Vali Acc: 0.263 Test Loss: 1.479 Test Acc: 0.263
Validation loss decreased (-0.203932 --> -0.263143).  Saving model ...
Epoch: 3 cost time: 1.777357578277588
Epoch: 3, Steps: 10 | Train Loss: 1.532 Vali Loss: 1.415 Vali Acc: 0.309 Test Loss: 1.415 Test Acc: 0.309
Validation loss decreased (-0.263143 --> -0.309196).  Saving model ...
Epoch: 4 cost time: 2.061619758605957
Epoch: 4, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.337 Vali Acc: 0.349 Test Loss: 1.337 Test Acc: 0.349
Validation loss decreased (-0.309196 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 1.408433437347412
Epoch: 5, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.254 Vali Acc: 0.441 Test Loss: 1.254 Test Acc: 0.441
Validation loss decreased (-0.348671 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 1.5264575481414795
Epoch: 6, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.172 Vali Acc: 0.493 Test Loss: 1.172 Test Acc: 0.493
Validation loss decreased (-0.440777 --> -0.493409).  Saving model ...
Epoch: 7 cost time: 1.575819969177246
Epoch: 7, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.094 Vali Acc: 0.553 Test Loss: 1.094 Test Acc: 0.553
Validation loss decreased (-0.493409 --> -0.552621).  Saving model ...
Epoch: 8 cost time: 1.5209012031555176
Epoch: 8, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.019 Vali Acc: 0.586 Test Loss: 1.019 Test Acc: 0.586
Validation loss decreased (-0.552621 --> -0.585516).  Saving model ...
Epoch: 9 cost time: 1.4009218215942383
Epoch: 9, Steps: 10 | Train Loss: 0.878 Vali Loss: 0.946 Vali Acc: 0.645 Test Loss: 0.946 Test Acc: 0.645
Validation loss decreased (-0.585516 --> -0.644727).  Saving model ...
Epoch: 10 cost time: 1.7575969696044922
Epoch: 10, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.876 Vali Acc: 0.664 Test Loss: 0.876 Test Acc: 0.664
Validation loss decreased (-0.644727 --> -0.664465).  Saving model ...
Epoch: 11 cost time: 1.3406939506530762
Epoch: 11, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.817 Vali Acc: 0.664 Test Loss: 0.817 Test Acc: 0.664
Validation loss decreased (-0.664465 --> -0.664466).  Saving model ...
Epoch: 12 cost time: 1.939234733581543
Epoch: 12, Steps: 10 | Train Loss: 0.625 Vali Loss: 0.767 Vali Acc: 0.671 Test Loss: 0.767 Test Acc: 0.671
Validation loss decreased (-0.664466 --> -0.671045).  Saving model ...
Epoch: 13 cost time: 1.7504901885986328
Epoch: 13, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.722 Vali Acc: 0.684 Test Loss: 0.722 Test Acc: 0.684
Validation loss decreased (-0.671045 --> -0.684203).  Saving model ...
Epoch: 14 cost time: 1.9889678955078125
Epoch: 14, Steps: 10 | Train Loss: 0.492 Vali Loss: 0.680 Vali Acc: 0.711 Test Loss: 0.680 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710520).  Saving model ...
Epoch: 15 cost time: 1.5467114448547363
Epoch: 15, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.645 Vali Acc: 0.737 Test Loss: 0.645 Test Acc: 0.737
Validation loss decreased (-0.710520 --> -0.736836).  Saving model ...
Epoch: 16 cost time: 1.848912239074707
Epoch: 16, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.620 Vali Acc: 0.730 Test Loss: 0.620 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7118606567382812
Epoch: 17, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 18 cost time: 1.622936487197876
Epoch: 18, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.573 Vali Acc: 0.737 Test Loss: 0.573 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 19 cost time: 1.9323079586029053
Epoch: 19, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 20 cost time: 1.9412317276000977
Epoch: 20, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 21 cost time: 1.5391783714294434
Epoch: 21, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.528 Vali Acc: 0.763 Test Loss: 0.528 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 22 cost time: 1.56978440284729
Epoch: 22, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.521 Vali Acc: 0.770 Test Loss: 0.521 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 23 cost time: 1.6028940677642822
Epoch: 23, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.512 Vali Acc: 0.776 Test Loss: 0.512 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 24 cost time: 1.4479081630706787
Epoch: 24, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.505 Vali Acc: 0.783 Test Loss: 0.505 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 25 cost time: 2.04996657371521
Epoch: 25, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.499 Vali Acc: 0.783 Test Loss: 0.499 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 26 cost time: 1.2109930515289307
Epoch: 26, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.490 Vali Acc: 0.796 Test Loss: 0.490 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 27 cost time: 1.6286003589630127
Epoch: 27, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.490 Vali Acc: 0.796 Test Loss: 0.490 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 28 cost time: 1.632319450378418
Epoch: 28, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 29 cost time: 1.8161046504974365
Epoch: 29, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.484 Vali Acc: 0.789 Test Loss: 0.484 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5947706699371338
Epoch: 30, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.481 Vali Acc: 0.796 Test Loss: 0.481 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4959092140197754
Epoch: 31, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.475 Vali Acc: 0.789 Test Loss: 0.475 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7696034908294678
Epoch: 32, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.473 Vali Acc: 0.789 Test Loss: 0.473 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7640273571014404
Epoch: 33, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.479 Vali Acc: 0.796 Test Loss: 0.479 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.8550574779510498
Epoch: 34, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4658148288726807
Epoch: 35, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.5187005996704102
Epoch: 36, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 37 cost time: 1.529982089996338
Epoch: 37, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 38 cost time: 1.5834639072418213
Epoch: 38, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.485 Vali Acc: 0.796 Test Loss: 0.485 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5508956909179688
Epoch: 39, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.484 Vali Acc: 0.796 Test Loss: 0.484 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5621027946472168
Epoch: 40, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.484 Vali Acc: 0.796 Test Loss: 0.484 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8175616264343262
Epoch: 41, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.482 Vali Acc: 0.796 Test Loss: 0.482 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.7800953388214111
Epoch: 42, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.481 Vali Acc: 0.796 Test Loss: 0.481 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.771714210510254
Epoch: 43, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.480 Vali Acc: 0.796 Test Loss: 0.480 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.7664849758148193
Epoch: 44, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.7167515754699707
Epoch: 45, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.6092312335968018
Epoch: 46, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.487 Vali Acc: 0.803 Test Loss: 0.487 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.6810264587402344
Epoch: 47, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 14740
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.858435392379761
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.500 Vali Acc: 0.211 Test Loss: 1.500 Test Acc: 0.211
Validation loss decreased (inf --> -0.210511).  Saving model ...
Epoch: 2 cost time: 2.0439696311950684
Epoch: 2, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.446 Vali Acc: 0.211 Test Loss: 1.446 Test Acc: 0.211
Validation loss decreased (-0.210511 --> -0.210512).  Saving model ...
Epoch: 3 cost time: 1.9691457748413086
Epoch: 3, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.386 Vali Acc: 0.257 Test Loss: 1.386 Test Acc: 0.257
Validation loss decreased (-0.210512 --> -0.256565).  Saving model ...
Epoch: 4 cost time: 1.830791711807251
Epoch: 4, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.321 Vali Acc: 0.336 Test Loss: 1.321 Test Acc: 0.336
Validation loss decreased (-0.256565 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 1.5779619216918945
Epoch: 5, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.256 Vali Acc: 0.421 Test Loss: 1.256 Test Acc: 0.421
Validation loss decreased (-0.335513 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 1.5272743701934814
Epoch: 6, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.195 Vali Acc: 0.493 Test Loss: 1.195 Test Acc: 0.493
Validation loss decreased (-0.421040 --> -0.493409).  Saving model ...
Epoch: 7 cost time: 2.0041728019714355
Epoch: 7, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.136 Vali Acc: 0.513 Test Loss: 1.136 Test Acc: 0.513
Validation loss decreased (-0.493409 --> -0.513147).  Saving model ...
Epoch: 8 cost time: 1.9764404296875
Epoch: 8, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.513147 --> -0.532884).  Saving model ...
Epoch: 9 cost time: 2.3696515560150146
Epoch: 9, Steps: 10 | Train Loss: 0.878 Vali Loss: 1.026 Vali Acc: 0.559 Test Loss: 1.026 Test Acc: 0.559
Validation loss decreased (-0.532884 --> -0.559200).  Saving model ...
Epoch: 10 cost time: 1.820910930633545
Epoch: 10, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.973 Vali Acc: 0.579 Test Loss: 0.973 Test Acc: 0.579
Validation loss decreased (-0.559200 --> -0.578938).  Saving model ...
Epoch: 11 cost time: 1.8996214866638184
Epoch: 11, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.924 Vali Acc: 0.599 Test Loss: 0.924 Test Acc: 0.599
Validation loss decreased (-0.578938 --> -0.598675).  Saving model ...
Epoch: 12 cost time: 2.2292275428771973
Epoch: 12, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.870 Vali Acc: 0.625 Test Loss: 0.870 Test Acc: 0.625
Validation loss decreased (-0.598675 --> -0.624991).  Saving model ...
Epoch: 13 cost time: 2.5737993717193604
Epoch: 13, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.822 Vali Acc: 0.638 Test Loss: 0.822 Test Acc: 0.638
Validation loss decreased (-0.624991 --> -0.638150).  Saving model ...
Epoch: 14 cost time: 1.7510974407196045
Epoch: 14, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.787 Vali Acc: 0.638 Test Loss: 0.787 Test Acc: 0.638
Validation loss decreased (-0.638150 --> -0.638150).  Saving model ...
Epoch: 15 cost time: 1.8350064754486084
Epoch: 15, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.751 Vali Acc: 0.651 Test Loss: 0.751 Test Acc: 0.651
Validation loss decreased (-0.638150 --> -0.651308).  Saving model ...
Epoch: 16 cost time: 1.8317034244537354
Epoch: 16, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.720 Vali Acc: 0.651 Test Loss: 0.720 Test Acc: 0.651
Validation loss decreased (-0.651308 --> -0.651309).  Saving model ...
Epoch: 17 cost time: 1.9572741985321045
Epoch: 17, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.697 Vali Acc: 0.684 Test Loss: 0.697 Test Acc: 0.684
Validation loss decreased (-0.651309 --> -0.684204).  Saving model ...
Epoch: 18 cost time: 1.8105168342590332
Epoch: 18, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.674 Vali Acc: 0.704 Test Loss: 0.674 Test Acc: 0.704
Validation loss decreased (-0.684204 --> -0.703941).  Saving model ...
Epoch: 19 cost time: 1.7160005569458008
Epoch: 19, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.655 Vali Acc: 0.717 Test Loss: 0.655 Test Acc: 0.717
Validation loss decreased (-0.703941 --> -0.717099).  Saving model ...
Epoch: 20 cost time: 2.121213674545288
Epoch: 20, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
Validation loss decreased (-0.717099 --> -0.717099).  Saving model ...
Epoch: 21 cost time: 1.7941997051239014
Epoch: 21, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
Validation loss decreased (-0.717099 --> -0.717099).  Saving model ...
Epoch: 22 cost time: 1.8668792247772217
Epoch: 22, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.617 Vali Acc: 0.717 Test Loss: 0.617 Test Acc: 0.717
Validation loss decreased (-0.717099 --> -0.717099).  Saving model ...
Epoch: 23 cost time: 1.715031623840332
Epoch: 23, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.608 Vali Acc: 0.724 Test Loss: 0.608 Test Acc: 0.724
Validation loss decreased (-0.717099 --> -0.723678).  Saving model ...
Epoch: 24 cost time: 1.6227343082427979
Epoch: 24, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.594 Vali Acc: 0.724 Test Loss: 0.594 Test Acc: 0.724
Validation loss decreased (-0.723678 --> -0.723678).  Saving model ...
Epoch: 25 cost time: 1.6407523155212402
Epoch: 25, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
Validation loss decreased (-0.723678 --> -0.736836).  Saving model ...
Epoch: 26 cost time: 1.835202932357788
Epoch: 26, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 27 cost time: 2.109416961669922
Epoch: 27, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.583 Vali Acc: 0.743 Test Loss: 0.583 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 28 cost time: 1.7441935539245605
Epoch: 28, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7922141551971436
Epoch: 29, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.577 Vali Acc: 0.743 Test Loss: 0.577 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 30 cost time: 1.83339262008667
Epoch: 30, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.573 Vali Acc: 0.750 Test Loss: 0.573 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 31 cost time: 1.4984159469604492
Epoch: 31, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.577 Vali Acc: 0.757 Test Loss: 0.577 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 32 cost time: 1.8998384475708008
Epoch: 32, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 33 cost time: 1.3222496509552002
Epoch: 33, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 34 cost time: 1.9409515857696533
Epoch: 34, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 35 cost time: 2.0748207569122314
Epoch: 35, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 36 cost time: 1.5643601417541504
Epoch: 36, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4434287548065186
Epoch: 37, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.573 Vali Acc: 0.757 Test Loss: 0.573 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.9854204654693604
Epoch: 38, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.1210641860961914
Epoch: 39, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.7114253044128418
Epoch: 40, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.9653067588806152
Epoch: 41, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.857759952545166
Epoch: 42, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3807134628295898
Epoch: 43, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.5409271717071533
Epoch: 44, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.1809072494506836
Epoch: 45, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.592 Vali Acc: 0.770 Test Loss: 0.592 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 14756
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.303206920623779
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.475 Vali Acc: 0.224 Test Loss: 1.475 Test Acc: 0.224
Validation loss decreased (inf --> -0.223669).  Saving model ...
Epoch: 2 cost time: 1.467956304550171
Epoch: 2, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.431 Vali Acc: 0.270 Test Loss: 1.431 Test Acc: 0.270
Validation loss decreased (-0.223669 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.813066005706787
Epoch: 3, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.382 Vali Acc: 0.316 Test Loss: 1.382 Test Acc: 0.316
Validation loss decreased (-0.269723 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 1.8338816165924072
Epoch: 4, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.327 Vali Acc: 0.336 Test Loss: 1.327 Test Acc: 0.336
Validation loss decreased (-0.315776 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 1.5378484725952148
Epoch: 5, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.271 Vali Acc: 0.375 Test Loss: 1.271 Test Acc: 0.375
Validation loss decreased (-0.335513 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.5859053134918213
Epoch: 6, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.215 Vali Acc: 0.461 Test Loss: 1.215 Test Acc: 0.461
Validation loss decreased (-0.374987 --> -0.460514).  Saving model ...
Epoch: 7 cost time: 1.7472729682922363
Epoch: 7, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.460514 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.1607122421264648
Epoch: 8, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.108 Vali Acc: 0.546 Test Loss: 1.108 Test Acc: 0.546
Validation loss decreased (-0.499988 --> -0.546042).  Saving model ...
Epoch: 9 cost time: 1.3396434783935547
Epoch: 9, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.054 Vali Acc: 0.586 Test Loss: 1.054 Test Acc: 0.586
Validation loss decreased (-0.546042 --> -0.585516).  Saving model ...
Epoch: 10 cost time: 1.6129789352416992
Epoch: 10, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.003 Vali Acc: 0.599 Test Loss: 1.003 Test Acc: 0.599
Validation loss decreased (-0.585516 --> -0.598674).  Saving model ...
Epoch: 11 cost time: 1.882836103439331
Epoch: 11, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.954 Vali Acc: 0.632 Test Loss: 0.954 Test Acc: 0.632
Validation loss decreased (-0.598674 --> -0.631569).  Saving model ...
Epoch: 12 cost time: 1.6939928531646729
Epoch: 12, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.910 Vali Acc: 0.664 Test Loss: 0.910 Test Acc: 0.664
Validation loss decreased (-0.631569 --> -0.664465).  Saving model ...
Epoch: 13 cost time: 1.684617519378662
Epoch: 13, Steps: 10 | Train Loss: 0.684 Vali Loss: 0.869 Vali Acc: 0.684 Test Loss: 0.869 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 1.3683793544769287
Epoch: 14, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.831 Vali Acc: 0.684 Test Loss: 0.831 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684202).  Saving model ...
Epoch: 15 cost time: 1.9961800575256348
Epoch: 15, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.796 Vali Acc: 0.684 Test Loss: 0.796 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684203).  Saving model ...
Epoch: 16 cost time: 1.7409625053405762
Epoch: 16, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.767 Vali Acc: 0.684 Test Loss: 0.767 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684203).  Saving model ...
Epoch: 17 cost time: 1.0891103744506836
Epoch: 17, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.739 Vali Acc: 0.678 Test Loss: 0.739 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3807482719421387
Epoch: 18, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.717 Vali Acc: 0.697 Test Loss: 0.717 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 19 cost time: 1.3645508289337158
Epoch: 19, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 20 cost time: 1.7175178527832031
Epoch: 20, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.680 Vali Acc: 0.730 Test Loss: 0.680 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 21 cost time: 2.0415167808532715
Epoch: 21, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.664 Vali Acc: 0.724 Test Loss: 0.664 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.591874599456787
Epoch: 22, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.651 Vali Acc: 0.730 Test Loss: 0.651 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 23 cost time: 1.7572627067565918
Epoch: 23, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.639 Vali Acc: 0.724 Test Loss: 0.639 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7418296337127686
Epoch: 24, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.626 Vali Acc: 0.743 Test Loss: 0.626 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 25 cost time: 1.7607312202453613
Epoch: 25, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.616 Vali Acc: 0.737 Test Loss: 0.616 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8534417152404785
Epoch: 26, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.611 Vali Acc: 0.743 Test Loss: 0.611 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 27 cost time: 1.1454243659973145
Epoch: 27, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7770726680755615
Epoch: 28, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.596 Vali Acc: 0.730 Test Loss: 0.596 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.533229112625122
Epoch: 29, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.590 Vali Acc: 0.730 Test Loss: 0.590 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4573626518249512
Epoch: 30, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.584 Vali Acc: 0.743 Test Loss: 0.584 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 31 cost time: 1.795583724975586
Epoch: 31, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.581 Vali Acc: 0.743 Test Loss: 0.581 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 32 cost time: 1.6132678985595703
Epoch: 32, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.584 Vali Acc: 0.743 Test Loss: 0.584 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7985646724700928
Epoch: 33, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6309123039245605
Epoch: 34, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.947861671447754
Epoch: 35, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.582 Vali Acc: 0.750 Test Loss: 0.582 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 36 cost time: 1.9076104164123535
Epoch: 36, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 37 cost time: 1.7595715522766113
Epoch: 37, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.777189016342163
Epoch: 38, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.570 Vali Acc: 0.730 Test Loss: 0.570 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.9088335037231445
Epoch: 39, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.562 Vali Acc: 0.730 Test Loss: 0.562 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7603111267089844
Epoch: 40, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.563 Vali Acc: 0.757 Test Loss: 0.563 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 41 cost time: 1.66790771484375
Epoch: 41, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.561 Vali Acc: 0.750 Test Loss: 0.561 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.781816005706787
Epoch: 42, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.563 Vali Acc: 0.757 Test Loss: 0.563 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7048029899597168
Epoch: 43, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.565 Vali Acc: 0.750 Test Loss: 0.565 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.8428220748901367
Epoch: 44, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.569 Vali Acc: 0.757 Test Loss: 0.569 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.7251207828521729
Epoch: 45, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.572 Vali Acc: 0.757 Test Loss: 0.572 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.0482935905456543
Epoch: 46, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.575 Vali Acc: 0.743 Test Loss: 0.575 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.640470027923584
Epoch: 47, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 48 cost time: 1.6751759052276611
Epoch: 48, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8045859336853027
Epoch: 49, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.580 Vali Acc: 0.770 Test Loss: 0.580 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 50 cost time: 1.8620636463165283
Epoch: 50, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.575 Vali Acc: 0.770 Test Loss: 0.575 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 51 cost time: 1.6996777057647705
Epoch: 51, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.685049057006836
Epoch: 52, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.578 Vali Acc: 0.757 Test Loss: 0.578 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.9665749073028564
Epoch: 53, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.7359702587127686
Epoch: 54, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 55 cost time: 1.856163501739502
Epoch: 55, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.575 Vali Acc: 0.770 Test Loss: 0.575 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.0268328189849854
Epoch: 56, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.917999029159546
Epoch: 57, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.5189406871795654
Epoch: 58, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.6647253036499023
Epoch: 59, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.6919171810150146
Epoch: 60, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.584 Vali Acc: 0.763 Test Loss: 0.584 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 2.030628204345703
Epoch: 61, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.586 Vali Acc: 0.776 Test Loss: 0.586 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.9947690963745117
Epoch: 62, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.7625958919525146
Epoch: 63, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.740795373916626
Epoch: 64, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.590 Vali Acc: 0.770 Test Loss: 0.590 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 13636
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.484121799468994
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.424 Vali Acc: 0.316 Test Loss: 1.424 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 2.321532726287842
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.334 Vali Acc: 0.414 Test Loss: 1.334 Test Acc: 0.414
Validation loss decreased (-0.315775 --> -0.414460).  Saving model ...
Epoch: 3 cost time: 1.4778921604156494
Epoch: 3, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.223 Vali Acc: 0.507 Test Loss: 1.223 Test Acc: 0.507
Validation loss decreased (-0.414460 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.2608628273010254
Epoch: 4, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.108 Vali Acc: 0.559 Test Loss: 1.108 Test Acc: 0.559
Validation loss decreased (-0.506567 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.7997057437896729
Epoch: 5, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.011 Vali Acc: 0.671 Test Loss: 1.011 Test Acc: 0.671
Validation loss decreased (-0.559199 --> -0.671043).  Saving model ...
Epoch: 6 cost time: 1.4980521202087402
Epoch: 6, Steps: 10 | Train Loss: 0.784 Vali Loss: 0.918 Vali Acc: 0.658 Test Loss: 0.918 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6900663375854492
Epoch: 7, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.810 Vali Acc: 0.704 Test Loss: 0.810 Test Acc: 0.704
Validation loss decreased (-0.671043 --> -0.703939).  Saving model ...
Epoch: 8 cost time: 1.49064302444458
Epoch: 8, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.736 Vali Acc: 0.743 Test Loss: 0.736 Test Acc: 0.743
Validation loss decreased (-0.703939 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 2.1285698413848877
Epoch: 9, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.674 Vali Acc: 0.737 Test Loss: 0.674 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9819104671478271
Epoch: 10, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.623 Vali Acc: 0.776 Test Loss: 0.623 Test Acc: 0.776
Validation loss decreased (-0.743414 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.9782640933990479
Epoch: 11, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.585 Vali Acc: 0.789 Test Loss: 0.585 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 2.196408748626709
Epoch: 12, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.555 Vali Acc: 0.796 Test Loss: 0.555 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.8939876556396484
Epoch: 13, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.9913110733032227
Epoch: 14, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.91086745262146
Epoch: 15, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7116022109985352
Epoch: 16, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.4632904529571533
Epoch: 17, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8903899192810059
Epoch: 18, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8131422996520996
Epoch: 19, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7001307010650635
Epoch: 20, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 1.2451577186584473
Epoch: 21, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.877072811126709
Epoch: 22, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7187178134918213
Epoch: 23, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9858794212341309
Epoch: 24, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8649530410766602
Epoch: 25, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9151766300201416
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 27 cost time: 1.368391513824463
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.947312355041504
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8073689937591553
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9004197120666504
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.1465675830841064
Epoch: 31, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.96999192237854
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.63169527053833
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.684779405593872
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4200270175933838
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.050008773803711
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.586 Vali Acc: 0.809 Test Loss: 0.586 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 18148
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.679755449295044
Epoch: 1, Steps: 10 | Train Loss: 1.501 Vali Loss: 1.419 Vali Acc: 0.243 Test Loss: 1.419 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.4270553588867188
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.355 Vali Acc: 0.309 Test Loss: 1.355 Test Acc: 0.309
Validation loss decreased (-0.243407 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 1.8549714088439941
Epoch: 3, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.282 Vali Acc: 0.441 Test Loss: 1.282 Test Acc: 0.441
Validation loss decreased (-0.309197 --> -0.440777).  Saving model ...
Epoch: 4 cost time: 1.6861841678619385
Epoch: 4, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.195 Vali Acc: 0.520 Test Loss: 1.195 Test Acc: 0.520
Validation loss decreased (-0.440777 --> -0.519725).  Saving model ...
Epoch: 5 cost time: 1.6437177658081055
Epoch: 5, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.109 Vali Acc: 0.579 Test Loss: 1.109 Test Acc: 0.579
Validation loss decreased (-0.519725 --> -0.578936).  Saving model ...
Epoch: 6 cost time: 1.5459589958190918
Epoch: 6, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.024 Vali Acc: 0.592 Test Loss: 1.024 Test Acc: 0.592
Validation loss decreased (-0.578936 --> -0.592095).  Saving model ...
Epoch: 7 cost time: 1.7202391624450684
Epoch: 7, Steps: 10 | Train Loss: 0.890 Vali Loss: 0.940 Vali Acc: 0.632 Test Loss: 0.940 Test Acc: 0.632
Validation loss decreased (-0.592095 --> -0.631570).  Saving model ...
Epoch: 8 cost time: 1.5601351261138916
Epoch: 8, Steps: 10 | Train Loss: 0.803 Vali Loss: 0.871 Vali Acc: 0.651 Test Loss: 0.871 Test Acc: 0.651
Validation loss decreased (-0.631570 --> -0.651307).  Saving model ...
Epoch: 9 cost time: 1.510277509689331
Epoch: 9, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.802 Vali Acc: 0.691 Test Loss: 0.802 Test Acc: 0.691
Validation loss decreased (-0.651307 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 1.9211695194244385
Epoch: 10, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.743 Vali Acc: 0.737 Test Loss: 0.743 Test Acc: 0.737
Validation loss decreased (-0.690781 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 1.3486428260803223
Epoch: 11, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.693 Vali Acc: 0.743 Test Loss: 0.693 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 1.5012900829315186
Epoch: 12, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.658 Vali Acc: 0.776 Test Loss: 0.658 Test Acc: 0.776
Validation loss decreased (-0.743414 --> -0.776309).  Saving model ...
Epoch: 13 cost time: 2.0284669399261475
Epoch: 13, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 14 cost time: 1.2233192920684814
Epoch: 14, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.589 Vali Acc: 0.796 Test Loss: 0.589 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.8924875259399414
Epoch: 15, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5442445278167725
Epoch: 16, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5120954513549805
Epoch: 17, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7626373767852783
Epoch: 18, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.532 Vali Acc: 0.796 Test Loss: 0.532 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 1.788095235824585
Epoch: 19, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.4799120426177979
Epoch: 20, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 1.5911755561828613
Epoch: 21, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 1.3999083042144775
Epoch: 22, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 23 cost time: 1.5511720180511475
Epoch: 23, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5979552268981934
Epoch: 24, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 25 cost time: 1.6988046169281006
Epoch: 25, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3537111282348633
Epoch: 26, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.493 Vali Acc: 0.789 Test Loss: 0.493 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.667811393737793
Epoch: 27, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 28 cost time: 1.6651647090911865
Epoch: 28, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5652267932891846
Epoch: 29, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7110776901245117
Epoch: 30, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.587123155593872
Epoch: 31, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.253941297531128
Epoch: 32, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7121093273162842
Epoch: 33, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6439735889434814
Epoch: 34, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.8557848930358887
Epoch: 35, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.7135391235351562
Epoch: 36, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 37 cost time: 1.9361488819122314
Epoch: 37, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8149783611297607
Epoch: 38, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.143887996673584
Epoch: 39, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.5511367321014404
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.528113842010498
Epoch: 41, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.61873459815979
Epoch: 42, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 43 cost time: 1.9570589065551758
Epoch: 43, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.559 Vali Acc: 0.803 Test Loss: 0.559 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6933376789093018
Epoch: 44, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.091660261154175
Epoch: 45, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.6214284896850586
Epoch: 46, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.574 Vali Acc: 0.803 Test Loss: 0.574 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.883646011352539
Epoch: 47, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.8470978736877441
Epoch: 48, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.020895481109619
Epoch: 49, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.682983160018921
Epoch: 50, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.9633991718292236
Epoch: 51, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.602 Vali Acc: 0.796 Test Loss: 0.602 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.7926974296569824
Epoch: 52, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 12404
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.0284764766693115
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.308 Vali Acc: 0.329 Test Loss: 1.308 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.5027036666870117
Epoch: 2, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.265 Vali Acc: 0.362 Test Loss: 1.265 Test Acc: 0.362
Validation loss decreased (-0.328934 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.4658222198486328
Epoch: 3, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.207 Vali Acc: 0.421 Test Loss: 1.207 Test Acc: 0.421
Validation loss decreased (-0.361829 --> -0.421041).  Saving model ...
Epoch: 4 cost time: 1.570012092590332
Epoch: 4, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.141 Vali Acc: 0.553 Test Loss: 1.141 Test Acc: 0.553
Validation loss decreased (-0.421041 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 1.7725248336791992
Epoch: 5, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.074 Vali Acc: 0.605 Test Loss: 1.074 Test Acc: 0.605
Validation loss decreased (-0.552620 --> -0.605252).  Saving model ...
Epoch: 6 cost time: 1.3935587406158447
Epoch: 6, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.007 Vali Acc: 0.632 Test Loss: 1.007 Test Acc: 0.632
Validation loss decreased (-0.605252 --> -0.631569).  Saving model ...
Epoch: 7 cost time: 1.729781150817871
Epoch: 7, Steps: 10 | Train Loss: 0.925 Vali Loss: 0.943 Vali Acc: 0.651 Test Loss: 0.943 Test Acc: 0.651
Validation loss decreased (-0.631569 --> -0.651306).  Saving model ...
Epoch: 8 cost time: 1.9622225761413574
Epoch: 8, Steps: 10 | Train Loss: 0.881 Vali Loss: 0.883 Vali Acc: 0.678 Test Loss: 0.883 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 1.5357680320739746
Epoch: 9, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.829 Vali Acc: 0.697 Test Loss: 0.829 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697360).  Saving model ...
Epoch: 10 cost time: 2.1495420932769775
Epoch: 10, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.777 Vali Acc: 0.717 Test Loss: 0.777 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717097).  Saving model ...
Epoch: 11 cost time: 1.7157373428344727
Epoch: 11, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.734 Vali Acc: 0.737 Test Loss: 0.734 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 2.0269713401794434
Epoch: 12, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.687 Vali Acc: 0.737 Test Loss: 0.687 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 13 cost time: 1.8063397407531738
Epoch: 13, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.652 Vali Acc: 0.770 Test Loss: 0.652 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769730).  Saving model ...
Epoch: 14 cost time: 1.4988059997558594
Epoch: 14, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.4799282550811768
Epoch: 15, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.4805903434753418
Epoch: 16, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.581 Vali Acc: 0.770 Test Loss: 0.581 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5471820831298828
Epoch: 17, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7461318969726562
Epoch: 18, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.556 Vali Acc: 0.757 Test Loss: 0.556 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8897087574005127
Epoch: 19, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6360623836517334
Epoch: 20, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 21 cost time: 1.3847627639770508
Epoch: 21, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 22 cost time: 1.5520679950714111
Epoch: 22, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.524 Vali Acc: 0.757 Test Loss: 0.524 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5703046321868896
Epoch: 23, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5713138580322266
Epoch: 24, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 25 cost time: 1.4697043895721436
Epoch: 25, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 26 cost time: 1.4896466732025146
Epoch: 26, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.498 Vali Acc: 0.796 Test Loss: 0.498 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5214757919311523
Epoch: 27, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 28 cost time: 1.5331552028656006
Epoch: 28, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7564570903778076
Epoch: 29, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7993173599243164
Epoch: 30, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.559079885482788
Epoch: 31, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6961102485656738
Epoch: 32, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.9453742504119873
Epoch: 33, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5669965744018555
Epoch: 34, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.0382468700408936
Epoch: 35, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.497 Vali Acc: 0.796 Test Loss: 0.497 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.5899479389190674
Epoch: 36, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.492 Vali Acc: 0.803 Test Loss: 0.492 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6862516403198242
Epoch: 37, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 10516
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.708259105682373
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.482 Vali Acc: 0.204 Test Loss: 1.482 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 1.5880510807037354
Epoch: 2, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.420 Vali Acc: 0.276 Test Loss: 1.420 Test Acc: 0.276
Validation loss decreased (-0.203933 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 1.300279140472412
Epoch: 3, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.362 Vali Acc: 0.303 Test Loss: 1.362 Test Acc: 0.303
Validation loss decreased (-0.276302 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 1.8015687465667725
Epoch: 4, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.302 Vali Acc: 0.362 Test Loss: 1.302 Test Acc: 0.362
Validation loss decreased (-0.302618 --> -0.361829).  Saving model ...
Epoch: 5 cost time: 1.569559097290039
Epoch: 5, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.243 Vali Acc: 0.428 Test Loss: 1.243 Test Acc: 0.428
Validation loss decreased (-0.361829 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 1.7979202270507812
Epoch: 6, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.182 Vali Acc: 0.480 Test Loss: 1.182 Test Acc: 0.480
Validation loss decreased (-0.427619 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 1.5900866985321045
Epoch: 7, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.122 Vali Acc: 0.513 Test Loss: 1.122 Test Acc: 0.513
Validation loss decreased (-0.480251 --> -0.513147).  Saving model ...
Epoch: 8 cost time: 1.5073323249816895
Epoch: 8, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.062 Vali Acc: 0.553 Test Loss: 1.062 Test Acc: 0.553
Validation loss decreased (-0.513147 --> -0.552621).  Saving model ...
Epoch: 9 cost time: 1.812720537185669
Epoch: 9, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.010 Vali Acc: 0.592 Test Loss: 1.010 Test Acc: 0.592
Validation loss decreased (-0.552621 --> -0.592095).  Saving model ...
Epoch: 10 cost time: 1.6682209968566895
Epoch: 10, Steps: 10 | Train Loss: 0.864 Vali Loss: 0.956 Vali Acc: 0.612 Test Loss: 0.956 Test Acc: 0.612
Validation loss decreased (-0.592095 --> -0.611833).  Saving model ...
Epoch: 11 cost time: 1.8398947715759277
Epoch: 11, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.908 Vali Acc: 0.645 Test Loss: 0.908 Test Acc: 0.645
Validation loss decreased (-0.611833 --> -0.644728).  Saving model ...
Epoch: 12 cost time: 2.025299310684204
Epoch: 12, Steps: 10 | Train Loss: 0.674 Vali Loss: 0.859 Vali Acc: 0.638 Test Loss: 0.859 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5404996871948242
Epoch: 13, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.818 Vali Acc: 0.645 Test Loss: 0.818 Test Acc: 0.645
Validation loss decreased (-0.644728 --> -0.644729).  Saving model ...
Epoch: 14 cost time: 1.767244815826416
Epoch: 14, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.784 Vali Acc: 0.678 Test Loss: 0.784 Test Acc: 0.678
Validation loss decreased (-0.644729 --> -0.677624).  Saving model ...
Epoch: 15 cost time: 1.5750908851623535
Epoch: 15, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.748 Vali Acc: 0.684 Test Loss: 0.748 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 16 cost time: 1.8186166286468506
Epoch: 16, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.722 Vali Acc: 0.697 Test Loss: 0.722 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 17 cost time: 1.8559789657592773
Epoch: 17, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.699 Vali Acc: 0.724 Test Loss: 0.699 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 1.5768933296203613
Epoch: 18, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.674 Vali Acc: 0.724 Test Loss: 0.674 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 19 cost time: 2.0443129539489746
Epoch: 19, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.652 Vali Acc: 0.743 Test Loss: 0.652 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 20 cost time: 2.076167345046997
Epoch: 20, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.633 Vali Acc: 0.730 Test Loss: 0.633 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.964545726776123
Epoch: 21, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.620 Vali Acc: 0.750 Test Loss: 0.620 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 22 cost time: 1.826448678970337
Epoch: 22, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.606 Vali Acc: 0.757 Test Loss: 0.606 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 23 cost time: 1.9561693668365479
Epoch: 23, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.598 Vali Acc: 0.770 Test Loss: 0.598 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 24 cost time: 1.6973462104797363
Epoch: 24, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.591 Vali Acc: 0.770 Test Loss: 0.591 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 25 cost time: 1.7834908962249756
Epoch: 25, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8361458778381348
Epoch: 26, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.578 Vali Acc: 0.750 Test Loss: 0.578 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1376230716705322
Epoch: 27, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9009971618652344
Epoch: 28, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 1.7093229293823242
Epoch: 29, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6321132183074951
Epoch: 30, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 31 cost time: 2.2405855655670166
Epoch: 31, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 32 cost time: 1.8230633735656738
Epoch: 32, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 1.4424095153808594
Epoch: 33, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 34 cost time: 1.8259141445159912
Epoch: 34, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 35 cost time: 1.4575369358062744
Epoch: 35, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 36 cost time: 1.6476712226867676
Epoch: 36, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8319945335388184
Epoch: 37, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3293564319610596
Epoch: 38, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8904542922973633
Epoch: 39, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.0901920795440674
Epoch: 40, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 41 cost time: 1.7310905456542969
Epoch: 41, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.8327915668487549
Epoch: 42, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.564 Vali Acc: 0.796 Test Loss: 0.564 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7879071235656738
Epoch: 43, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.618873119354248
Epoch: 44, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.9816949367523193
Epoch: 45, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.8970046043395996
Epoch: 46, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.591 Vali Acc: 0.783 Test Loss: 0.591 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.7708282470703125
Epoch: 47, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.592 Vali Acc: 0.783 Test Loss: 0.592 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.0137407779693604
Epoch: 48, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.593 Vali Acc: 0.789 Test Loss: 0.593 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.015817165374756
Epoch: 49, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.599 Vali Acc: 0.796 Test Loss: 0.599 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.159536838531494
Epoch: 50, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 10532
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.684569597244263
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.344 Vali Acc: 0.276 Test Loss: 1.344 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.7044336795806885
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.297 Vali Acc: 0.336 Test Loss: 1.297 Test Acc: 0.336
Validation loss decreased (-0.276302 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.8412599563598633
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.246 Vali Acc: 0.395 Test Loss: 1.246 Test Acc: 0.395
Validation loss decreased (-0.335513 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 1.9435884952545166
Epoch: 4, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.189 Vali Acc: 0.467 Test Loss: 1.189 Test Acc: 0.467
Validation loss decreased (-0.394724 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 1.8054914474487305
Epoch: 5, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.136 Vali Acc: 0.507 Test Loss: 1.136 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506568).  Saving model ...
Epoch: 6 cost time: 1.8056893348693848
Epoch: 6, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.085 Vali Acc: 0.586 Test Loss: 1.085 Test Acc: 0.586
Validation loss decreased (-0.506568 --> -0.585515).  Saving model ...
Epoch: 7 cost time: 1.5678207874298096
Epoch: 7, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.035 Vali Acc: 0.599 Test Loss: 1.035 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598674).  Saving model ...
Epoch: 8 cost time: 1.6845941543579102
Epoch: 8, Steps: 10 | Train Loss: 1.022 Vali Loss: 0.991 Vali Acc: 0.625 Test Loss: 0.991 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 1.8591959476470947
Epoch: 9, Steps: 10 | Train Loss: 0.972 Vali Loss: 0.949 Vali Acc: 0.612 Test Loss: 0.949 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.029205799102783
Epoch: 10, Steps: 10 | Train Loss: 0.839 Vali Loss: 0.906 Vali Acc: 0.651 Test Loss: 0.906 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651307).  Saving model ...
Epoch: 11 cost time: 1.9611682891845703
Epoch: 11, Steps: 10 | Train Loss: 0.795 Vali Loss: 0.867 Vali Acc: 0.658 Test Loss: 0.867 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657886).  Saving model ...
Epoch: 12 cost time: 1.790658950805664
Epoch: 12, Steps: 10 | Train Loss: 0.778 Vali Loss: 0.831 Vali Acc: 0.664 Test Loss: 0.831 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664465).  Saving model ...
Epoch: 13 cost time: 1.721755027770996
Epoch: 13, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.796 Vali Acc: 0.678 Test Loss: 0.796 Test Acc: 0.678
Validation loss decreased (-0.664465 --> -0.677624).  Saving model ...
Epoch: 14 cost time: 1.7163262367248535
Epoch: 14, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.766 Vali Acc: 0.691 Test Loss: 0.766 Test Acc: 0.691
Validation loss decreased (-0.677624 --> -0.690782).  Saving model ...
Epoch: 15 cost time: 1.8651151657104492
Epoch: 15, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.739 Vali Acc: 0.684 Test Loss: 0.739 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9223430156707764
Epoch: 16, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.719 Vali Acc: 0.697 Test Loss: 0.719 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 17 cost time: 1.8845720291137695
Epoch: 17, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.697 Vali Acc: 0.717 Test Loss: 0.697 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 18 cost time: 2.4519364833831787
Epoch: 18, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.675 Vali Acc: 0.737 Test Loss: 0.675 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 19 cost time: 1.9585306644439697
Epoch: 19, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.656 Vali Acc: 0.743 Test Loss: 0.656 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 20 cost time: 2.143561840057373
Epoch: 20, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.643 Vali Acc: 0.743 Test Loss: 0.643 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 21 cost time: 1.838304042816162
Epoch: 21, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.627 Vali Acc: 0.750 Test Loss: 0.627 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 22 cost time: 1.9075031280517578
Epoch: 22, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 1.2578213214874268
Epoch: 23, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.597 Vali Acc: 0.763 Test Loss: 0.597 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 1.488879680633545
Epoch: 24, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 25 cost time: 1.6483423709869385
Epoch: 25, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.579 Vali Acc: 0.770 Test Loss: 0.579 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 1.879849910736084
Epoch: 26, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.417567253112793
Epoch: 27, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.563 Vali Acc: 0.750 Test Loss: 0.563 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5665385723114014
Epoch: 28, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.030595302581787
Epoch: 29, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.556 Vali Acc: 0.763 Test Loss: 0.556 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.614884853363037
Epoch: 30, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.0481112003326416
Epoch: 31, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.549 Vali Acc: 0.757 Test Loss: 0.549 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.1703264713287354
Epoch: 32, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7338049411773682
Epoch: 33, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 34 cost time: 1.2347548007965088
Epoch: 34, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.535 Vali Acc: 0.776 Test Loss: 0.535 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 35 cost time: 1.9352452754974365
Epoch: 35, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 36 cost time: 1.701962947845459
Epoch: 36, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 37 cost time: 1.6733148097991943
Epoch: 37, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.531 Vali Acc: 0.763 Test Loss: 0.531 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.0727486610412598
Epoch: 38, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 39 cost time: 1.8163726329803467
Epoch: 39, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.534 Vali Acc: 0.770 Test Loss: 0.534 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5272681713104248
Epoch: 40, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.8177096843719482
Epoch: 41, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.241504669189453
Epoch: 42, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 43 cost time: 1.7011420726776123
Epoch: 43, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.7846925258636475
Epoch: 44, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 45 cost time: 1.7388126850128174
Epoch: 45, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.9487321376800537
Epoch: 46, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.1092684268951416
Epoch: 47, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.7875006198883057
Epoch: 48, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.0355217456817627
Epoch: 49, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.8394670486450195
Epoch: 50, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.550 Vali Acc: 0.789 Test Loss: 0.550 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.5939054489135742
Epoch: 51, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.4960989952087402
Epoch: 52, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 53 cost time: 1.5072650909423828
Epoch: 53, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 54 cost time: 1.7990760803222656
Epoch: 54, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.643387794494629
Epoch: 55, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.4820713996887207
Epoch: 56, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.088092803955078
Epoch: 57, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.548 Vali Acc: 0.776 Test Loss: 0.548 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.7753100395202637
Epoch: 58, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.4485864639282227
Epoch: 59, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.303274154663086
Epoch: 60, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.3185276985168457
Epoch: 61, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.469043493270874
Epoch: 62, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.6731555461883545
Epoch: 63, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 9412
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9823880195617676
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.247 Vali Acc: 0.513 Test Loss: 1.247 Test Acc: 0.513
Validation loss decreased (inf --> -0.513145).  Saving model ...
Epoch: 2 cost time: 1.2057876586914062
Epoch: 2, Steps: 10 | Train Loss: 0.901 Vali Loss: 0.811 Vali Acc: 0.691 Test Loss: 0.811 Test Acc: 0.691
Validation loss decreased (-0.513145 --> -0.690781).  Saving model ...
Epoch: 3 cost time: 1.7437365055084229
Epoch: 3, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.648 Vali Acc: 0.717 Test Loss: 0.648 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717099).  Saving model ...
Epoch: 4 cost time: 1.9177298545837402
Epoch: 4, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
Validation loss decreased (-0.717099 --> -0.796047).  Saving model ...
Epoch: 5 cost time: 1.4981770515441895
Epoch: 5, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 6 cost time: 1.6443579196929932
Epoch: 6, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 7 cost time: 1.3575572967529297
Epoch: 7, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.677 Vali Acc: 0.796 Test Loss: 0.677 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.513484239578247
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 9 cost time: 1.8474879264831543
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.695 Vali Acc: 0.829 Test Loss: 0.695 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828940).  Saving model ...
Epoch: 10 cost time: 1.3871774673461914
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.737 Vali Acc: 0.822 Test Loss: 0.737 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.590404987335205
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.725 Vali Acc: 0.829 Test Loss: 0.725 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1019387245178223
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.729 Vali Acc: 0.829 Test Loss: 0.729 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3988978862762451
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.742 Vali Acc: 0.822 Test Loss: 0.742 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5715854167938232
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.761 Vali Acc: 0.829 Test Loss: 0.761 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.655005693435669
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.744 Vali Acc: 0.822 Test Loss: 0.744 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5148272514343262
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.787 Vali Acc: 0.822 Test Loss: 0.787 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4039838314056396
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.802 Vali Acc: 0.822 Test Loss: 0.802 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5192842483520508
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.822 Test Loss: 0.788 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6216373443603516
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.799 Vali Acc: 0.816 Test Loss: 0.799 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 225156
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8921239376068115
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.353 Vali Acc: 0.309 Test Loss: 1.353 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 2.309997797012329
Epoch: 2, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.033 Vali Acc: 0.559 Test Loss: 1.033 Test Acc: 0.559
Validation loss decreased (-0.309197 --> -0.559200).  Saving model ...
Epoch: 3 cost time: 1.6533644199371338
Epoch: 3, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.768 Vali Acc: 0.678 Test Loss: 0.768 Test Acc: 0.678
Validation loss decreased (-0.559200 --> -0.677624).  Saving model ...
Epoch: 4 cost time: 1.4749116897583008
Epoch: 4, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.635 Vali Acc: 0.763 Test Loss: 0.635 Test Acc: 0.763
Validation loss decreased (-0.677624 --> -0.763152).  Saving model ...
Epoch: 5 cost time: 1.750887155532837
Epoch: 5, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
Validation loss decreased (-0.763152 --> -0.796047).  Saving model ...
Epoch: 6 cost time: 1.8996493816375732
Epoch: 6, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7434043884277344
Epoch: 7, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7873284816741943
Epoch: 8, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5683512687683105
Epoch: 9, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0274853706359863
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.6585252285003662
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 12 cost time: 1.826796293258667
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.610 Vali Acc: 0.809 Test Loss: 0.610 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9330613613128662
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2592926025390625
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.648 Vali Acc: 0.809 Test Loss: 0.648 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.751084804534912
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.649 Vali Acc: 0.809 Test Loss: 0.649 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1970441341400146
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.661 Vali Acc: 0.809 Test Loss: 0.661 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6795189380645752
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.673 Vali Acc: 0.809 Test Loss: 0.673 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7052083015441895
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.692 Vali Acc: 0.816 Test Loss: 0.692 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6294357776641846
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.690 Vali Acc: 0.816 Test Loss: 0.690 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9400742053985596
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.697 Vali Acc: 0.809 Test Loss: 0.697 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7057299613952637
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.710 Vali Acc: 0.809 Test Loss: 0.710 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 179204
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.452338218688965
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.381 Vali Acc: 0.250 Test Loss: 1.381 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.5575945377349854
Epoch: 2, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.108 Vali Acc: 0.592 Test Loss: 1.108 Test Acc: 0.592
Validation loss decreased (-0.249986 --> -0.592094).  Saving model ...
Epoch: 3 cost time: 1.3279545307159424
Epoch: 3, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.891 Vali Acc: 0.638 Test Loss: 0.891 Test Acc: 0.638
Validation loss decreased (-0.592094 --> -0.638149).  Saving model ...
Epoch: 4 cost time: 1.3553040027618408
Epoch: 4, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.753 Vali Acc: 0.684 Test Loss: 0.753 Test Acc: 0.684
Validation loss decreased (-0.638149 --> -0.684203).  Saving model ...
Epoch: 5 cost time: 1.863332986831665
Epoch: 5, Steps: 10 | Train Loss: 0.445 Vali Loss: 0.651 Vali Acc: 0.730 Test Loss: 0.651 Test Acc: 0.730
Validation loss decreased (-0.684203 --> -0.730257).  Saving model ...
Epoch: 6 cost time: 1.3258962631225586
Epoch: 6, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.596 Vali Acc: 0.757 Test Loss: 0.596 Test Acc: 0.757
Validation loss decreased (-0.730257 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.3746881484985352
Epoch: 7, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 2.180933952331543
Epoch: 8, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 9 cost time: 1.616450309753418
Epoch: 9, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.776324987411499
Epoch: 10, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6471278667449951
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8462045192718506
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.657153606414795
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7271556854248047
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.587 Vali Acc: 0.796 Test Loss: 0.587 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.66831374168396
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.590 Vali Acc: 0.796 Test Loss: 0.590 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4015741348266602
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9215714931488037
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7360692024230957
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 164100
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.813740968704224
Epoch: 1, Steps: 10 | Train Loss: 1.517 Vali Loss: 1.336 Vali Acc: 0.336 Test Loss: 1.336 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.492943286895752
Epoch: 2, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.098 Vali Acc: 0.487 Test Loss: 1.098 Test Acc: 0.487
Validation loss decreased (-0.335513 --> -0.486831).  Saving model ...
Epoch: 3 cost time: 1.483177900314331
Epoch: 3, Steps: 10 | Train Loss: 0.862 Vali Loss: 0.882 Vali Acc: 0.625 Test Loss: 0.882 Test Acc: 0.625
Validation loss decreased (-0.486831 --> -0.624991).  Saving model ...
Epoch: 4 cost time: 1.2885987758636475
Epoch: 4, Steps: 10 | Train Loss: 0.602 Vali Loss: 0.741 Vali Acc: 0.704 Test Loss: 0.741 Test Acc: 0.704
Validation loss decreased (-0.624991 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 1.2810909748077393
Epoch: 5, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.644 Vali Acc: 0.757 Test Loss: 0.644 Test Acc: 0.757
Validation loss decreased (-0.703940 --> -0.756573).  Saving model ...
Epoch: 6 cost time: 1.5959851741790771
Epoch: 6, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.616 Vali Acc: 0.770 Test Loss: 0.616 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.3655073642730713
Epoch: 7, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.5038971900939941
Epoch: 8, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.587 Vali Acc: 0.776 Test Loss: 0.587 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8117945194244385
Epoch: 9, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5720508098602295
Epoch: 10, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.591 Vali Acc: 0.770 Test Loss: 0.591 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4560198783874512
Epoch: 11, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.619 Vali Acc: 0.770 Test Loss: 0.619 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5953595638275146
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.629 Vali Acc: 0.789 Test Loss: 0.629 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.097430467605591
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.988544225692749
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.657 Vali Acc: 0.789 Test Loss: 0.657 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5936837196350098
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3263051509857178
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8387787342071533
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 164228
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.851756572723389
Epoch: 1, Steps: 10 | Train Loss: 1.537 Vali Loss: 1.341 Vali Acc: 0.296 Test Loss: 1.341 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.4360535144805908
Epoch: 2, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.168 Vali Acc: 0.447 Test Loss: 1.168 Test Acc: 0.447
Validation loss decreased (-0.296039 --> -0.447357).  Saving model ...
Epoch: 3 cost time: 1.8215751647949219
Epoch: 3, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.004 Vali Acc: 0.586 Test Loss: 1.004 Test Acc: 0.586
Validation loss decreased (-0.447357 --> -0.585516).  Saving model ...
Epoch: 4 cost time: 1.2594242095947266
Epoch: 4, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.866 Vali Acc: 0.664 Test Loss: 0.866 Test Acc: 0.664
Validation loss decreased (-0.585516 --> -0.664465).  Saving model ...
Epoch: 5 cost time: 1.1358544826507568
Epoch: 5, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.771 Vali Acc: 0.691 Test Loss: 0.771 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690782).  Saving model ...
Epoch: 6 cost time: 1.4578158855438232
Epoch: 6, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.704 Vali Acc: 0.697 Test Loss: 0.704 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 7 cost time: 1.398038387298584
Epoch: 7, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.656 Vali Acc: 0.717 Test Loss: 0.656 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717099).  Saving model ...
Epoch: 8 cost time: 1.2766315937042236
Epoch: 8, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
Validation loss decreased (-0.717099 --> -0.717099).  Saving model ...
Epoch: 9 cost time: 1.3427302837371826
Epoch: 9, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.643 Vali Acc: 0.757 Test Loss: 0.643 Test Acc: 0.757
Validation loss decreased (-0.717099 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.968108892440796
Epoch: 10, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.634 Vali Acc: 0.743 Test Loss: 0.634 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7498626708984375
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.636 Vali Acc: 0.750 Test Loss: 0.636 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4217991828918457
Epoch: 12, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4129891395568848
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.654 Vali Acc: 0.763 Test Loss: 0.654 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 1.818882703781128
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.676 Vali Acc: 0.776 Test Loss: 0.676 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 15 cost time: 1.370987892150879
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.675 Vali Acc: 0.776 Test Loss: 0.675 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
Epoch: 16 cost time: 1.3470959663391113
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.684 Vali Acc: 0.783 Test Loss: 0.684 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 17 cost time: 1.5454208850860596
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.698 Vali Acc: 0.757 Test Loss: 0.698 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.732210636138916
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 19 cost time: 1.6314871311187744
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.721 Vali Acc: 0.789 Test Loss: 0.721 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7652299404144287
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.735 Vali Acc: 0.789 Test Loss: 0.735 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4607908725738525
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.740 Vali Acc: 0.789 Test Loss: 0.740 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.357945203781128
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.756 Vali Acc: 0.796 Test Loss: 0.756 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 23 cost time: 1.5167391300201416
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.778 Vali Acc: 0.789 Test Loss: 0.778 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5139570236206055
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.790 Vali Acc: 0.783 Test Loss: 0.790 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6129000186920166
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.794 Vali Acc: 0.776 Test Loss: 0.794 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7378578186035156
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.804 Vali Acc: 0.776 Test Loss: 0.804 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4346766471862793
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.810 Vali Acc: 0.783 Test Loss: 0.810 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8723809719085693
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.819 Vali Acc: 0.783 Test Loss: 0.819 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5008575916290283
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.823 Vali Acc: 0.783 Test Loss: 0.823 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6983089447021484
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.830 Vali Acc: 0.789 Test Loss: 0.830 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.455324649810791
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.836 Vali Acc: 0.789 Test Loss: 0.836 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.472273588180542
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.843 Vali Acc: 0.789 Test Loss: 0.843 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 155268
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.7416462898254395
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 2.062610149383545
Epoch: 2, Steps: 10 | Train Loss: 0.886 Vali Loss: 0.768 Vali Acc: 0.697 Test Loss: 0.768 Test Acc: 0.697
Validation loss decreased (-0.499988 --> -0.697361).  Saving model ...
Epoch: 3 cost time: 1.5713422298431396
Epoch: 3, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
Validation loss decreased (-0.697361 --> -0.749994).  Saving model ...
Epoch: 4 cost time: 1.692598581314087
Epoch: 4, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.531 Vali Acc: 0.829 Test Loss: 0.531 Test Acc: 0.829
Validation loss decreased (-0.749994 --> -0.828942).  Saving model ...
Epoch: 5 cost time: 1.7856533527374268
Epoch: 5, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9516725540161133
Epoch: 6, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9458048343658447
Epoch: 7, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8499739170074463
Epoch: 8, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.703 Vali Acc: 0.816 Test Loss: 0.703 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1111059188842773
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.633 Vali Acc: 0.849 Test Loss: 0.633 Test Acc: 0.849
Validation loss decreased (-0.828942 --> -0.848678).  Saving model ...
Epoch: 10 cost time: 1.8143048286437988
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.635 Vali Acc: 0.849 Test Loss: 0.635 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1485819816589355
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.732 Vali Acc: 0.816 Test Loss: 0.732 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7121422290802002
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.687 Vali Acc: 0.829 Test Loss: 0.687 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9276387691497803
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.779 Vali Acc: 0.829 Test Loss: 0.779 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5083866119384766
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.832 Vali Acc: 0.816 Test Loss: 0.832 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9199223518371582
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.818 Vali Acc: 0.829 Test Loss: 0.818 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8426663875579834
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.872 Vali Acc: 0.816 Test Loss: 0.872 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.76285719871521
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.839 Vali Acc: 0.829 Test Loss: 0.839 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9079606533050537
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.823 Vali Acc: 0.822 Test Loss: 0.823 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9243652820587158
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.822 Test Loss: 0.836 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 192260
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.968073844909668
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.256 Vali Acc: 0.467 Test Loss: 1.256 Test Acc: 0.467
Validation loss decreased (inf --> -0.467093).  Saving model ...
Epoch: 2 cost time: 2.2344632148742676
Epoch: 2, Steps: 10 | Train Loss: 1.158 Vali Loss: 0.979 Vali Acc: 0.612 Test Loss: 0.979 Test Acc: 0.612
Validation loss decreased (-0.467093 --> -0.611832).  Saving model ...
Epoch: 3 cost time: 1.7460358142852783
Epoch: 3, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.757 Vali Acc: 0.697 Test Loss: 0.757 Test Acc: 0.697
Validation loss decreased (-0.611832 --> -0.697361).  Saving model ...
Epoch: 4 cost time: 1.5299482345581055
Epoch: 4, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.640 Vali Acc: 0.724 Test Loss: 0.640 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723678).  Saving model ...
Epoch: 5 cost time: 1.6223936080932617
Epoch: 5, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.563 Vali Acc: 0.743 Test Loss: 0.563 Test Acc: 0.743
Validation loss decreased (-0.723678 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 1.628671407699585
Epoch: 6, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.556 Vali Acc: 0.757 Test Loss: 0.556 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.1876025199890137
Epoch: 7, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.547 Vali Acc: 0.770 Test Loss: 0.547 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.4128696918487549
Epoch: 8, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.9186384677886963
Epoch: 9, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3076319694519043
Epoch: 10, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.586 Vali Acc: 0.776 Test Loss: 0.586 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0743093490600586
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.4001173973083496
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6455788612365723
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.644 Vali Acc: 0.796 Test Loss: 0.644 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3334441184997559
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.638 Vali Acc: 0.803 Test Loss: 0.638 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 1.5361120700836182
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.686 Vali Acc: 0.770 Test Loss: 0.686 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5302717685699463
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.699 Vali Acc: 0.776 Test Loss: 0.699 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0139176845550537
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.703 Vali Acc: 0.783 Test Loss: 0.703 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8989205360412598
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.713 Vali Acc: 0.783 Test Loss: 0.713 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.607269048690796
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.721 Vali Acc: 0.803 Test Loss: 0.721 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7360055446624756
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.727 Vali Acc: 0.796 Test Loss: 0.727 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6446707248687744
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.740 Vali Acc: 0.796 Test Loss: 0.740 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.18009877204895
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.750 Vali Acc: 0.796 Test Loss: 0.750 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4328055381774902
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.746 Vali Acc: 0.803 Test Loss: 0.746 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.0376298427581787
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.758 Vali Acc: 0.796 Test Loss: 0.758 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 146308
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.898567199707031
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.289 Vali Acc: 0.421 Test Loss: 1.289 Test Acc: 0.421
Validation loss decreased (inf --> -0.421040).  Saving model ...
Epoch: 2 cost time: 2.028221607208252
Epoch: 2, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.061 Vali Acc: 0.592 Test Loss: 1.061 Test Acc: 0.592
Validation loss decreased (-0.421040 --> -0.592095).  Saving model ...
Epoch: 3 cost time: 1.3911845684051514
Epoch: 3, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.863 Vali Acc: 0.671 Test Loss: 0.863 Test Acc: 0.671
Validation loss decreased (-0.592095 --> -0.671044).  Saving model ...
Epoch: 4 cost time: 1.4223055839538574
Epoch: 4, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.720 Vali Acc: 0.724 Test Loss: 0.720 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723677).  Saving model ...
Epoch: 5 cost time: 1.0207526683807373
Epoch: 5, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.638 Vali Acc: 0.743 Test Loss: 0.638 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 1.3991317749023438
Epoch: 6, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.2500264644622803
Epoch: 7, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.386598825454712
Epoch: 8, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.5701897144317627
Epoch: 9, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.3238294124603271
Epoch: 10, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.4327137470245361
Epoch: 11, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.529186725616455
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 13 cost time: 1.6926298141479492
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7120740413665771
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.572 Vali Acc: 0.829 Test Loss: 0.572 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 15 cost time: 1.6197667121887207
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3491966724395752
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7294304370880127
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6456475257873535
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5403270721435547
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.637 Vali Acc: 0.816 Test Loss: 0.637 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5113849639892578
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5373685359954834
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.650 Vali Acc: 0.816 Test Loss: 0.650 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4723975658416748
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.669 Vali Acc: 0.809 Test Loss: 0.669 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9054434299468994
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.687 Vali Acc: 0.816 Test Loss: 0.687 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4793663024902344
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.688 Vali Acc: 0.822 Test Loss: 0.688 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 131204
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.988442897796631
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.293 Vali Acc: 0.368 Test Loss: 1.293 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 2.1017658710479736
Epoch: 2, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.104 Vali Acc: 0.546 Test Loss: 1.104 Test Acc: 0.546
Validation loss decreased (-0.368408 --> -0.546042).  Saving model ...
Epoch: 3 cost time: 1.7414741516113281
Epoch: 3, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.896 Vali Acc: 0.605 Test Loss: 0.896 Test Acc: 0.605
Validation loss decreased (-0.546042 --> -0.605254).  Saving model ...
Epoch: 4 cost time: 1.6012635231018066
Epoch: 4, Steps: 10 | Train Loss: 0.625 Vali Loss: 0.744 Vali Acc: 0.664 Test Loss: 0.744 Test Acc: 0.664
Validation loss decreased (-0.605254 --> -0.664466).  Saving model ...
Epoch: 5 cost time: 1.7903664112091064
Epoch: 5, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.674 Vali Acc: 0.704 Test Loss: 0.674 Test Acc: 0.704
Validation loss decreased (-0.664466 --> -0.703941).  Saving model ...
Epoch: 6 cost time: 1.6571087837219238
Epoch: 6, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.624 Vali Acc: 0.717 Test Loss: 0.624 Test Acc: 0.717
Validation loss decreased (-0.703941 --> -0.717099).  Saving model ...
Epoch: 7 cost time: 1.6700239181518555
Epoch: 7, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
Validation loss decreased (-0.717099 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.429764986038208
Epoch: 8, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.588 Vali Acc: 0.757 Test Loss: 0.588 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7898082733154297
Epoch: 9, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.597 Vali Acc: 0.757 Test Loss: 0.597 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6916790008544922
Epoch: 10, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.616 Vali Acc: 0.776 Test Loss: 0.616 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.3172988891601562
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.4459669589996338
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.638 Vali Acc: 0.783 Test Loss: 0.638 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.665447473526001
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.667 Vali Acc: 0.776 Test Loss: 0.667 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6703312397003174
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.679 Vali Acc: 0.776 Test Loss: 0.679 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6328823566436768
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.679 Vali Acc: 0.776 Test Loss: 0.679 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5330445766448975
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.683 Vali Acc: 0.776 Test Loss: 0.683 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7595770359039307
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 18 cost time: 1.2863693237304688
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.714 Vali Acc: 0.789 Test Loss: 0.714 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7038915157318115
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2928886413574219
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.724 Vali Acc: 0.783 Test Loss: 0.724 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5868840217590332
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.727 Vali Acc: 0.796 Test Loss: 0.727 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 22 cost time: 1.7227718830108643
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.734 Vali Acc: 0.796 Test Loss: 0.734 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4868242740631104
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.735 Vali Acc: 0.796 Test Loss: 0.735 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6059303283691406
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.756 Vali Acc: 0.789 Test Loss: 0.756 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9165003299713135
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.750 Vali Acc: 0.796 Test Loss: 0.750 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6964495182037354
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.755 Vali Acc: 0.796 Test Loss: 0.755 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8448643684387207
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.766 Vali Acc: 0.796 Test Loss: 0.766 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3706042766571045
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.776 Vali Acc: 0.796 Test Loss: 0.776 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.225785493850708
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.782 Vali Acc: 0.809 Test Loss: 0.782 Test Acc: 0.809
Validation loss decreased (-0.796045 --> -0.809203).  Saving model ...
Epoch: 30 cost time: 1.5645370483398438
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.780 Vali Acc: 0.803 Test Loss: 0.780 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6611888408660889
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.792 Vali Acc: 0.809 Test Loss: 0.792 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.886451244354248
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.805 Vali Acc: 0.796 Test Loss: 0.805 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8029303550720215
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.816 Vali Acc: 0.796 Test Loss: 0.816 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4109632968902588
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.803 Test Loss: 0.814 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2914578914642334
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.815 Vali Acc: 0.789 Test Loss: 0.815 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8150713443756104
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.821 Vali Acc: 0.796 Test Loss: 0.821 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.8247456550598145
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.832 Vali Acc: 0.789 Test Loss: 0.832 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.3132596015930176
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.829 Vali Acc: 0.789 Test Loss: 0.829 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.125619888305664
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.830 Vali Acc: 0.789 Test Loss: 0.830 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 131332
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.503999948501587
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.375 Vali Acc: 0.382 Test Loss: 1.375 Test Acc: 0.382
Validation loss decreased (inf --> -0.381565).  Saving model ...
Epoch: 2 cost time: 1.4952290058135986
Epoch: 2, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.194 Vali Acc: 0.487 Test Loss: 1.194 Test Acc: 0.487
Validation loss decreased (-0.381565 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.3767673969268799
Epoch: 3, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.025 Vali Acc: 0.625 Test Loss: 1.025 Test Acc: 0.625
Validation loss decreased (-0.486830 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 1.250049114227295
Epoch: 4, Steps: 10 | Train Loss: 0.766 Vali Loss: 0.869 Vali Acc: 0.717 Test Loss: 0.869 Test Acc: 0.717
Validation loss decreased (-0.624990 --> -0.717097).  Saving model ...
Epoch: 5 cost time: 1.5990478992462158
Epoch: 5, Steps: 10 | Train Loss: 0.539 Vali Loss: 0.768 Vali Acc: 0.743 Test Loss: 0.768 Test Acc: 0.743
Validation loss decreased (-0.717097 --> -0.743413).  Saving model ...
Epoch: 6 cost time: 2.06581974029541
Epoch: 6, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.699 Vali Acc: 0.737 Test Loss: 0.699 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7505807876586914
Epoch: 7, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.670 Vali Acc: 0.743 Test Loss: 0.670 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 1.5418744087219238
Epoch: 8, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.638 Vali Acc: 0.730 Test Loss: 0.638 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4934887886047363
Epoch: 9, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.617 Vali Acc: 0.724 Test Loss: 0.617 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1217219829559326
Epoch: 10, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.619 Vali Acc: 0.737 Test Loss: 0.619 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7211225032806396
Epoch: 11, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.636 Vali Acc: 0.770 Test Loss: 0.636 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 1.5504298210144043
Epoch: 12, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.642 Vali Acc: 0.770 Test Loss: 0.642 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5297386646270752
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.658 Vali Acc: 0.763 Test Loss: 0.658 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8512647151947021
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.668 Vali Acc: 0.750 Test Loss: 0.668 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.239797592163086
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.675 Vali Acc: 0.763 Test Loss: 0.675 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4390499591827393
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.690 Vali Acc: 0.763 Test Loss: 0.690 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4299912452697754
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.692 Vali Acc: 0.770 Test Loss: 0.692 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7189381122589111
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.700 Vali Acc: 0.770 Test Loss: 0.700 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7928705215454102
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.708 Vali Acc: 0.776 Test Loss: 0.708 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 20 cost time: 1.420623540878296
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.724 Vali Acc: 0.776 Test Loss: 0.724 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4024348258972168
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.744 Vali Acc: 0.770 Test Loss: 0.744 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.962390422821045
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.759 Vali Acc: 0.776 Test Loss: 0.759 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5381724834442139
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.766 Vali Acc: 0.770 Test Loss: 0.766 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.384653329849243
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.775 Vali Acc: 0.776 Test Loss: 0.775 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5682895183563232
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.785 Vali Acc: 0.776 Test Loss: 0.785 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.484886884689331
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.791 Vali Acc: 0.776 Test Loss: 0.791 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6568143367767334
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.801 Vali Acc: 0.770 Test Loss: 0.801 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.590064525604248
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.811 Vali Acc: 0.770 Test Loss: 0.811 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.0634493827819824
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.820 Vali Acc: 0.770 Test Loss: 0.820 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 122372
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.382797002792358
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.226 Vali Acc: 0.480 Test Loss: 1.226 Test Acc: 0.480
Validation loss decreased (inf --> -0.480251).  Saving model ...
Epoch: 2 cost time: 1.4416580200195312
Epoch: 2, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.814 Vali Acc: 0.671 Test Loss: 0.814 Test Acc: 0.671
Validation loss decreased (-0.480251 --> -0.671044).  Saving model ...
Epoch: 3 cost time: 1.492985725402832
Epoch: 3, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.623 Vali Acc: 0.724 Test Loss: 0.623 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723678).  Saving model ...
Epoch: 4 cost time: 1.6388752460479736
Epoch: 4, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
Validation loss decreased (-0.723678 --> -0.796047).  Saving model ...
Epoch: 5 cost time: 1.739936113357544
Epoch: 5, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.560 Vali Acc: 0.776 Test Loss: 0.560 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2580657005310059
Epoch: 6, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8890185356140137
Epoch: 7, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 8 cost time: 1.305408000946045
Epoch: 8, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815783).  Saving model ...
Epoch: 9 cost time: 1.7249042987823486
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.704 Vali Acc: 0.796 Test Loss: 0.704 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7246241569519043
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.702 Vali Acc: 0.816 Test Loss: 0.702 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.321549415588379
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.727 Vali Acc: 0.809 Test Loss: 0.727 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.083894968032837
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.633347511291504
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.737 Vali Acc: 0.816 Test Loss: 0.737 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.462282657623291
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.754 Vali Acc: 0.809 Test Loss: 0.754 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9946417808532715
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.754 Vali Acc: 0.803 Test Loss: 0.754 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5920259952545166
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.781 Vali Acc: 0.803 Test Loss: 0.781 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7431871891021729
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.822 Test Loss: 0.775 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822361).  Saving model ...
Epoch: 18 cost time: 1.5816125869750977
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8303537368774414
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.803 Test Loss: 0.806 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.383363962173462
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.811 Vali Acc: 0.809 Test Loss: 0.811 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.212153673171997
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.803 Test Loss: 0.835 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7205257415771484
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.803 Test Loss: 0.844 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.954669713973999
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.841 Vali Acc: 0.803 Test Loss: 0.841 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.415771722793579
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.809 Test Loss: 0.844 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7795672416687012
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.849 Vali Acc: 0.809 Test Loss: 0.849 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4043183326721191
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.803 Test Loss: 0.860 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6537144184112549
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.867 Vali Acc: 0.809 Test Loss: 0.867 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 175812
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.162301301956177
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.272 Vali Acc: 0.454 Test Loss: 1.272 Test Acc: 0.454
Validation loss decreased (inf --> -0.453935).  Saving model ...
Epoch: 2 cost time: 1.7658724784851074
Epoch: 2, Steps: 10 | Train Loss: 1.062 Vali Loss: 0.954 Vali Acc: 0.671 Test Loss: 0.954 Test Acc: 0.671
Validation loss decreased (-0.453935 --> -0.671043).  Saving model ...
Epoch: 3 cost time: 1.6258635520935059
Epoch: 3, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.742 Vali Acc: 0.697 Test Loss: 0.742 Test Acc: 0.697
Validation loss decreased (-0.671043 --> -0.697361).  Saving model ...
Epoch: 4 cost time: 1.653426170349121
Epoch: 4, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.601 Vali Acc: 0.757 Test Loss: 0.601 Test Acc: 0.757
Validation loss decreased (-0.697361 --> -0.756573).  Saving model ...
Epoch: 5 cost time: 1.8844239711761475
Epoch: 5, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
Validation loss decreased (-0.756573 --> -0.796047).  Saving model ...
Epoch: 6 cost time: 1.6520800590515137
Epoch: 6, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.520 Vali Acc: 0.770 Test Loss: 0.520 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1704134941101074
Epoch: 7, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 8 cost time: 1.6755688190460205
Epoch: 8, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.8952794075012207
Epoch: 9, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8487467765808105
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.598 Vali Acc: 0.796 Test Loss: 0.598 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.035224437713623
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.112070083618164
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7811267375946045
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.639 Vali Acc: 0.803 Test Loss: 0.639 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7668125629425049
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 15 cost time: 1.6122214794158936
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0194270610809326
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0334322452545166
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9923570156097412
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1364967823028564
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.803 Test Loss: 0.707 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0993831157684326
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.809 Test Loss: 0.712 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2073140144348145
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.721 Vali Acc: 0.809 Test Loss: 0.721 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9601154327392578
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.722 Vali Acc: 0.809 Test Loss: 0.722 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8569815158843994
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.728 Vali Acc: 0.803 Test Loss: 0.728 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7697739601135254
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.736 Vali Acc: 0.803 Test Loss: 0.736 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 129860
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.930548667907715
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.313 Vali Acc: 0.342 Test Loss: 1.313 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.3821332454681396
Epoch: 2, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.070 Vali Acc: 0.638 Test Loss: 1.070 Test Acc: 0.638
Validation loss decreased (-0.342092 --> -0.638147).  Saving model ...
Epoch: 3 cost time: 1.3629848957061768
Epoch: 3, Steps: 10 | Train Loss: 0.809 Vali Loss: 0.854 Vali Acc: 0.651 Test Loss: 0.854 Test Acc: 0.651
Validation loss decreased (-0.638147 --> -0.651307).  Saving model ...
Epoch: 4 cost time: 1.4899446964263916
Epoch: 4, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.697 Vali Acc: 0.684 Test Loss: 0.697 Test Acc: 0.684
Validation loss decreased (-0.651307 --> -0.684204).  Saving model ...
Epoch: 5 cost time: 1.4226937294006348
Epoch: 5, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.620 Vali Acc: 0.743 Test Loss: 0.620 Test Acc: 0.743
Validation loss decreased (-0.684204 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 1.8059256076812744
Epoch: 6, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.583 Vali Acc: 0.743 Test Loss: 0.583 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 7 cost time: 1.4845869541168213
Epoch: 7, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 2.112643241882324
Epoch: 8, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.528 Vali Acc: 0.770 Test Loss: 0.528 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 9 cost time: 1.356182336807251
Epoch: 9, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.529 Vali Acc: 0.770 Test Loss: 0.529 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8740208148956299
Epoch: 10, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
Validation loss decreased (-0.769732 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.7886059284210205
Epoch: 11, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.4686431884765625
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.7320220470428467
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 14 cost time: 1.774137020111084
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8904497623443604
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0679900646209717
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8638560771942139
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.525766134262085
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6601030826568604
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5094804763793945
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.596 Vali Acc: 0.816 Test Loss: 0.596 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1133041381835938
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.589 Vali Acc: 0.809 Test Loss: 0.589 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.663670539855957
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.595 Vali Acc: 0.809 Test Loss: 0.595 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0079329013824463
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 114756
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.630988121032715
Epoch: 1, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.332 Vali Acc: 0.362 Test Loss: 1.332 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 1.4226930141448975
Epoch: 2, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.126 Vali Acc: 0.546 Test Loss: 1.126 Test Acc: 0.546
Validation loss decreased (-0.361829 --> -0.546041).  Saving model ...
Epoch: 3 cost time: 1.5919883251190186
Epoch: 3, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.917 Vali Acc: 0.645 Test Loss: 0.917 Test Acc: 0.645
Validation loss decreased (-0.546041 --> -0.644728).  Saving model ...
Epoch: 4 cost time: 1.5989980697631836
Epoch: 4, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.779 Vali Acc: 0.691 Test Loss: 0.779 Test Acc: 0.691
Validation loss decreased (-0.644728 --> -0.690782).  Saving model ...
Epoch: 5 cost time: 1.3818457126617432
Epoch: 5, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.5079882144927979
Epoch: 6, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736836).  Saving model ...
Epoch: 7 cost time: 1.333545207977295
Epoch: 7, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.613 Vali Acc: 0.743 Test Loss: 0.613 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.7054014205932617
Epoch: 8, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.615 Vali Acc: 0.763 Test Loss: 0.615 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.4495434761047363
Epoch: 9, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.622 Vali Acc: 0.757 Test Loss: 0.622 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.551004409790039
Epoch: 10, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.629 Vali Acc: 0.783 Test Loss: 0.629 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782888).  Saving model ...
Epoch: 11 cost time: 1.6288270950317383
Epoch: 11, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 1.8125767707824707
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.637 Vali Acc: 0.796 Test Loss: 0.637 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 13 cost time: 1.8571250438690186
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.660 Vali Acc: 0.789 Test Loss: 0.660 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1839053630828857
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.659 Vali Acc: 0.789 Test Loss: 0.659 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.830763339996338
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.658 Vali Acc: 0.803 Test Loss: 0.658 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 16 cost time: 1.6761982440948486
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.657 Vali Acc: 0.803 Test Loss: 0.657 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802625).  Saving model ...
Epoch: 17 cost time: 1.5843098163604736
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.674 Vali Acc: 0.809 Test Loss: 0.674 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 18 cost time: 1.6755754947662354
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.687 Vali Acc: 0.803 Test Loss: 0.687 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5203170776367188
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.693 Vali Acc: 0.809 Test Loss: 0.693 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.604851484298706
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.708 Vali Acc: 0.809 Test Loss: 0.708 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.809621810913086
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.540266752243042
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.727 Vali Acc: 0.809 Test Loss: 0.727 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.826383113861084
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.733 Vali Acc: 0.803 Test Loss: 0.733 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.505904197692871
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.737 Vali Acc: 0.803 Test Loss: 0.737 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5138492584228516
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.737 Vali Acc: 0.796 Test Loss: 0.737 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6508054733276367
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.759 Vali Acc: 0.803 Test Loss: 0.759 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9507112503051758
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.762 Vali Acc: 0.803 Test Loss: 0.762 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 114884
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.8650453090667725
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.379 Vali Acc: 0.395 Test Loss: 1.379 Test Acc: 0.395
Validation loss decreased (inf --> -0.394723).  Saving model ...
Epoch: 2 cost time: 1.386162519454956
Epoch: 2, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.176 Vali Acc: 0.507 Test Loss: 1.176 Test Acc: 0.507
Validation loss decreased (-0.394723 --> -0.506567).  Saving model ...
Epoch: 3 cost time: 1.9051830768585205
Epoch: 3, Steps: 10 | Train Loss: 0.962 Vali Loss: 0.975 Vali Acc: 0.645 Test Loss: 0.975 Test Acc: 0.645
Validation loss decreased (-0.506567 --> -0.644727).  Saving model ...
Epoch: 4 cost time: 1.5680623054504395
Epoch: 4, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.848 Vali Acc: 0.691 Test Loss: 0.848 Test Acc: 0.691
Validation loss decreased (-0.644727 --> -0.690781).  Saving model ...
Epoch: 5 cost time: 1.6124870777130127
Epoch: 5, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.746 Vali Acc: 0.724 Test Loss: 0.746 Test Acc: 0.724
Validation loss decreased (-0.690781 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.6859288215637207
Epoch: 6, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.686 Vali Acc: 0.724 Test Loss: 0.686 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 7 cost time: 1.4595870971679688
Epoch: 7, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.629 Vali Acc: 0.750 Test Loss: 0.629 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.4234137535095215
Epoch: 8, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.610 Vali Acc: 0.743 Test Loss: 0.610 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.453909158706665
Epoch: 9, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.619 Vali Acc: 0.730 Test Loss: 0.619 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6814241409301758
Epoch: 10, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.615 Vali Acc: 0.757 Test Loss: 0.615 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.5772285461425781
Epoch: 11, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.621 Vali Acc: 0.770 Test Loss: 0.621 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.8398723602294922
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.154499053955078
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.648 Vali Acc: 0.770 Test Loss: 0.648 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6469902992248535
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.653 Vali Acc: 0.776 Test Loss: 0.653 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 15 cost time: 1.561100959777832
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 16 cost time: 1.4655117988586426
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.690 Vali Acc: 0.783 Test Loss: 0.690 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.742910385131836
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.705 Vali Acc: 0.783 Test Loss: 0.705 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5164225101470947
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.710 Vali Acc: 0.776 Test Loss: 0.710 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7186613082885742
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.720 Vali Acc: 0.783 Test Loss: 0.720 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4056875705718994
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.733 Vali Acc: 0.796 Test Loss: 0.733 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796045).  Saving model ...
Epoch: 21 cost time: 1.5061759948730469
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.745 Vali Acc: 0.789 Test Loss: 0.745 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2791392803192139
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.757 Vali Acc: 0.796 Test Loss: 0.757 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4819328784942627
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.766 Vali Acc: 0.796 Test Loss: 0.766 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.386599063873291
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.772 Vali Acc: 0.783 Test Loss: 0.772 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.336207389831543
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.782 Vali Acc: 0.796 Test Loss: 0.782 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5636200904846191
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.799 Vali Acc: 0.796 Test Loss: 0.799 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3868582248687744
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.808 Vali Acc: 0.796 Test Loss: 0.808 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5840139389038086
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.814 Vali Acc: 0.796 Test Loss: 0.814 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4709570407867432
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.822 Vali Acc: 0.796 Test Loss: 0.822 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5823113918304443
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.826 Vali Acc: 0.789 Test Loss: 0.826 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 105924
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.232239723205566
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.250 Vali Acc: 0.467 Test Loss: 1.250 Test Acc: 0.467
Validation loss decreased (inf --> -0.467093).  Saving model ...
Epoch: 2 cost time: 1.8969228267669678
Epoch: 2, Steps: 10 | Train Loss: 1.119 Vali Loss: 0.987 Vali Acc: 0.625 Test Loss: 0.987 Test Acc: 0.625
Validation loss decreased (-0.467093 --> -0.624990).  Saving model ...
Epoch: 3 cost time: 1.4022552967071533
Epoch: 3, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.784 Vali Acc: 0.697 Test Loss: 0.784 Test Acc: 0.697
Validation loss decreased (-0.624990 --> -0.697361).  Saving model ...
Epoch: 4 cost time: 1.9357037544250488
Epoch: 4, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.625 Vali Acc: 0.757 Test Loss: 0.625 Test Acc: 0.757
Validation loss decreased (-0.697361 --> -0.756573).  Saving model ...
Epoch: 5 cost time: 1.458167552947998
Epoch: 5, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
Validation loss decreased (-0.756573 --> -0.796047).  Saving model ...
Epoch: 6 cost time: 1.8426258563995361
Epoch: 6, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 1.7293179035186768
Epoch: 7, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 8 cost time: 1.4064810276031494
Epoch: 8, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.534 Vali Acc: 0.829 Test Loss: 0.534 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828942).  Saving model ...
Epoch: 9 cost time: 1.8423254489898682
Epoch: 9, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7544572353363037
Epoch: 10, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.909564733505249
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.557 Vali Acc: 0.836 Test Loss: 0.557 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 12 cost time: 1.1336956024169922
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.595949649810791
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.593 Vali Acc: 0.816 Test Loss: 0.593 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.769237756729126
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6052567958831787
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7314822673797607
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.683 Vali Acc: 0.809 Test Loss: 0.683 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4597795009613037
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.674 Vali Acc: 0.809 Test Loss: 0.674 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9999597072601318
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.673 Vali Acc: 0.816 Test Loss: 0.673 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6580626964569092
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.687 Vali Acc: 0.816 Test Loss: 0.687 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9462285041809082
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.692 Vali Acc: 0.809 Test Loss: 0.692 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3327903747558594
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.689 Vali Acc: 0.816 Test Loss: 0.689 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 96324
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.456226348876953
Epoch: 1, Steps: 10 | Train Loss: 1.532 Vali Loss: 1.425 Vali Acc: 0.349 Test Loss: 1.425 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.2548575401306152
Epoch: 2, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.165 Vali Acc: 0.520 Test Loss: 1.165 Test Acc: 0.520
Validation loss decreased (-0.348670 --> -0.519725).  Saving model ...
Epoch: 3 cost time: 1.4919259548187256
Epoch: 3, Steps: 10 | Train Loss: 1.009 Vali Loss: 0.967 Vali Acc: 0.605 Test Loss: 0.967 Test Acc: 0.605
Validation loss decreased (-0.519725 --> -0.605253).  Saving model ...
Epoch: 4 cost time: 1.3707208633422852
Epoch: 4, Steps: 10 | Train Loss: 0.674 Vali Loss: 0.829 Vali Acc: 0.678 Test Loss: 0.829 Test Acc: 0.678
Validation loss decreased (-0.605253 --> -0.677623).  Saving model ...
Epoch: 5 cost time: 1.0036497116088867
Epoch: 5, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.728 Vali Acc: 0.697 Test Loss: 0.728 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 6 cost time: 1.44990873336792
Epoch: 6, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.638 Vali Acc: 0.763 Test Loss: 0.638 Test Acc: 0.763
Validation loss decreased (-0.697361 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.2863004207611084
Epoch: 7, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.9931859970092773
Epoch: 8, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.6152417659759521
Epoch: 9, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.4497179985046387
Epoch: 10, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4384434223175049
Epoch: 11, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9736056327819824
Epoch: 12, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.8133845329284668
Epoch: 13, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5775463581085205
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5345022678375244
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6302638053894043
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5017735958099365
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5598971843719482
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5182197093963623
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 20 cost time: 1.5648810863494873
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.595 Vali Acc: 0.816 Test Loss: 0.595 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.372288703918457
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5869696140289307
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.620 Vali Acc: 0.803 Test Loss: 0.620 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6441233158111572
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.437260389328003
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6242356300354004
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.486130714416504
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.643 Vali Acc: 0.816 Test Loss: 0.643 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.397470235824585
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.697058916091919
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4738824367523193
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.654 Vali Acc: 0.816 Test Loss: 0.654 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 73348
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.784290313720703
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.326 Vali Acc: 0.362 Test Loss: 1.326 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 1.408961296081543
Epoch: 2, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.187 Vali Acc: 0.467 Test Loss: 1.187 Test Acc: 0.467
Validation loss decreased (-0.361829 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 1.6000056266784668
Epoch: 3, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.016 Vali Acc: 0.566 Test Loss: 1.016 Test Acc: 0.566
Validation loss decreased (-0.467093 --> -0.565779).  Saving model ...
Epoch: 4 cost time: 1.3694889545440674
Epoch: 4, Steps: 10 | Train Loss: 0.829 Vali Loss: 0.865 Vali Acc: 0.625 Test Loss: 0.865 Test Acc: 0.625
Validation loss decreased (-0.565779 --> -0.624991).  Saving model ...
Epoch: 5 cost time: 1.6465232372283936
Epoch: 5, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.745 Vali Acc: 0.678 Test Loss: 0.745 Test Acc: 0.678
Validation loss decreased (-0.624991 --> -0.677624).  Saving model ...
Epoch: 6 cost time: 1.4635882377624512
Epoch: 6, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.654 Vali Acc: 0.737 Test Loss: 0.654 Test Acc: 0.737
Validation loss decreased (-0.677624 --> -0.736836).  Saving model ...
Epoch: 7 cost time: 1.1370584964752197
Epoch: 7, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.594 Vali Acc: 0.750 Test Loss: 0.594 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.537984848022461
Epoch: 8, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.565 Vali Acc: 0.757 Test Loss: 0.565 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 1.413818120956421
Epoch: 9, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.726614236831665
Epoch: 10, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 11 cost time: 1.2604765892028809
Epoch: 11, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 12 cost time: 1.314983606338501
Epoch: 12, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 13 cost time: 1.248800277709961
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 14 cost time: 1.784745216369629
Epoch: 14, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 15 cost time: 1.7339494228363037
Epoch: 15, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 16 cost time: 1.9824762344360352
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.498683214187622
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9220702648162842
Epoch: 18, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8688619136810303
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7807765007019043
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.406083583831787
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.330362319946289
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2760753631591797
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.756535530090332
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.381392240524292
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 65796
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.572757244110107
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.339 Vali Acc: 0.375 Test Loss: 1.339 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.6730237007141113
Epoch: 2, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.198 Vali Acc: 0.493 Test Loss: 1.198 Test Acc: 0.493
Validation loss decreased (-0.374987 --> -0.493409).  Saving model ...
Epoch: 3 cost time: 1.2647056579589844
Epoch: 3, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.054 Vali Acc: 0.586 Test Loss: 1.054 Test Acc: 0.586
Validation loss decreased (-0.493409 --> -0.585516).  Saving model ...
Epoch: 4 cost time: 1.4088091850280762
Epoch: 4, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.929 Vali Acc: 0.625 Test Loss: 0.929 Test Acc: 0.625
Validation loss decreased (-0.585516 --> -0.624991).  Saving model ...
Epoch: 5 cost time: 1.5550808906555176
Epoch: 5, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.832 Vali Acc: 0.658 Test Loss: 0.832 Test Acc: 0.658
Validation loss decreased (-0.624991 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.3926403522491455
Epoch: 6, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.753 Vali Acc: 0.691 Test Loss: 0.753 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690782).  Saving model ...
Epoch: 7 cost time: 1.5267624855041504
Epoch: 7, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.697 Vali Acc: 0.711 Test Loss: 0.697 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 8 cost time: 1.7358686923980713
Epoch: 8, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 1.0837352275848389
Epoch: 9, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.6890625953674316
Epoch: 10, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.41387939453125
Epoch: 11, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.593 Vali Acc: 0.757 Test Loss: 0.593 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.582629919052124
Epoch: 12, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5278112888336182
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1647915840148926
Epoch: 14, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.5417850017547607
Epoch: 15, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.5175845623016357
Epoch: 16, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.586 Vali Acc: 0.803 Test Loss: 0.586 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.4027495384216309
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.5174245834350586
Epoch: 18, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.607 Vali Acc: 0.809 Test Loss: 0.607 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4500689506530762
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.615 Vali Acc: 0.796 Test Loss: 0.615 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6523826122283936
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4626727104187012
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4036009311676025
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822362).  Saving model ...
Epoch: 23 cost time: 1.8549230098724365
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.665 Vali Acc: 0.783 Test Loss: 0.665 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3733186721801758
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.664 Vali Acc: 0.809 Test Loss: 0.664 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5377135276794434
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.674 Vali Acc: 0.803 Test Loss: 0.674 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4399476051330566
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.680 Vali Acc: 0.816 Test Loss: 0.680 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3455374240875244
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6699416637420654
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.683 Vali Acc: 0.816 Test Loss: 0.683 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6355912685394287
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.685 Vali Acc: 0.816 Test Loss: 0.685 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3647842407226562
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.698 Vali Acc: 0.796 Test Loss: 0.698 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5188536643981934
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.708 Vali Acc: 0.789 Test Loss: 0.708 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6203551292419434
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.709 Vali Acc: 0.796 Test Loss: 0.709 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 65860
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7828972339630127
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.335 Vali Acc: 0.355 Test Loss: 1.335 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.4081416130065918
Epoch: 2, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.232 Vali Acc: 0.480 Test Loss: 1.232 Test Acc: 0.480
Validation loss decreased (-0.355250 --> -0.480251).  Saving model ...
Epoch: 3 cost time: 1.591322898864746
Epoch: 3, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.107 Vali Acc: 0.559 Test Loss: 1.107 Test Acc: 0.559
Validation loss decreased (-0.480251 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.3710155487060547
Epoch: 4, Steps: 10 | Train Loss: 0.967 Vali Loss: 0.999 Vali Acc: 0.579 Test Loss: 0.999 Test Acc: 0.579
Validation loss decreased (-0.559199 --> -0.578937).  Saving model ...
Epoch: 5 cost time: 1.7921772003173828
Epoch: 5, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.898 Vali Acc: 0.664 Test Loss: 0.898 Test Acc: 0.664
Validation loss decreased (-0.578937 --> -0.664465).  Saving model ...
Epoch: 6 cost time: 1.3079938888549805
Epoch: 6, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.819 Vali Acc: 0.691 Test Loss: 0.819 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690781).  Saving model ...
Epoch: 7 cost time: 1.6526024341583252
Epoch: 7, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.754 Vali Acc: 0.711 Test Loss: 0.754 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710519).  Saving model ...
Epoch: 8 cost time: 1.3061623573303223
Epoch: 8, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.711 Vali Acc: 0.691 Test Loss: 0.711 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3042049407958984
Epoch: 9, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.677 Vali Acc: 0.711 Test Loss: 0.677 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710520).  Saving model ...
Epoch: 10 cost time: 1.6927509307861328
Epoch: 10, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
Validation loss decreased (-0.710520 --> -0.717099).  Saving model ...
Epoch: 11 cost time: 1.4405670166015625
Epoch: 11, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.630 Vali Acc: 0.737 Test Loss: 0.630 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736836).  Saving model ...
Epoch: 12 cost time: 1.7117624282836914
Epoch: 12, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 1.3473379611968994
Epoch: 13, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.624 Vali Acc: 0.737 Test Loss: 0.624 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 14 cost time: 1.4071645736694336
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.621 Vali Acc: 0.743 Test Loss: 0.621 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 2.1101675033569336
Epoch: 15, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.625 Vali Acc: 0.730 Test Loss: 0.625 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8016071319580078
Epoch: 16, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.630 Vali Acc: 0.730 Test Loss: 0.630 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2846853733062744
Epoch: 17, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.634 Vali Acc: 0.743 Test Loss: 0.634 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.72316312789917
Epoch: 18, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.637 Vali Acc: 0.743 Test Loss: 0.637 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7073137760162354
Epoch: 19, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.644 Vali Acc: 0.743 Test Loss: 0.644 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8255369663238525
Epoch: 20, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.645 Vali Acc: 0.743 Test Loss: 0.645 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3653292655944824
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.655 Vali Acc: 0.757 Test Loss: 0.655 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756572).  Saving model ...
Epoch: 22 cost time: 1.8209259510040283
Epoch: 22, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.656 Vali Acc: 0.757 Test Loss: 0.656 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.329413890838623
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.663 Vali Acc: 0.763 Test Loss: 0.663 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 24 cost time: 1.528334140777588
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.663 Vali Acc: 0.743 Test Loss: 0.663 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7133252620697021
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.672 Vali Acc: 0.757 Test Loss: 0.672 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.436561107635498
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.680 Vali Acc: 0.743 Test Loss: 0.680 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5023441314697266
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.679 Vali Acc: 0.743 Test Loss: 0.679 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8509674072265625
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.680 Vali Acc: 0.757 Test Loss: 0.680 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2380564212799072
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.683 Vali Acc: 0.763 Test Loss: 0.683 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5554900169372559
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.691 Vali Acc: 0.763 Test Loss: 0.691 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.4180550575256348
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.695 Vali Acc: 0.750 Test Loss: 0.695 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.9800868034362793
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.701 Vali Acc: 0.757 Test Loss: 0.701 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3543128967285156
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.708 Vali Acc: 0.757 Test Loss: 0.708 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 61380
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.552504062652588
Epoch: 1, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.221 Vali Acc: 0.559 Test Loss: 1.221 Test Acc: 0.559
Validation loss decreased (inf --> -0.559198).  Saving model ...
Epoch: 2 cost time: 1.20100998878479
Epoch: 2, Steps: 10 | Train Loss: 1.226 Vali Loss: 0.961 Vali Acc: 0.638 Test Loss: 0.961 Test Acc: 0.638
Validation loss decreased (-0.559198 --> -0.638148).  Saving model ...
Epoch: 3 cost time: 1.5388226509094238
Epoch: 3, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.734 Vali Acc: 0.724 Test Loss: 0.734 Test Acc: 0.724
Validation loss decreased (-0.638148 --> -0.723677).  Saving model ...
Epoch: 4 cost time: 1.449455976486206
Epoch: 4, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 1.598757266998291
Epoch: 5, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 6 cost time: 1.2820937633514404
Epoch: 6, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 1.5089731216430664
Epoch: 7, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4852683544158936
Epoch: 8, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 9 cost time: 1.4666547775268555
Epoch: 9, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5389173030853271
Epoch: 10, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.514 Vali Acc: 0.836 Test Loss: 0.514 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835521).  Saving model ...
Epoch: 11 cost time: 1.1979210376739502
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2739458084106445
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6663274765014648
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1918351650238037
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.606 Vali Acc: 0.829 Test Loss: 0.606 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.747910499572754
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.610 Vali Acc: 0.822 Test Loss: 0.610 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9536287784576416
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.552814245223999
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6073861122131348
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4273366928100586
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3056881427764893
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.659 Vali Acc: 0.816 Test Loss: 0.659 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 79812
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.509489059448242
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.383 Vali Acc: 0.342 Test Loss: 1.383 Test Acc: 0.342
Validation loss decreased (inf --> -0.342091).  Saving model ...
Epoch: 2 cost time: 1.29030179977417
Epoch: 2, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.211 Vali Acc: 0.474 Test Loss: 1.211 Test Acc: 0.474
Validation loss decreased (-0.342091 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 1.4128365516662598
Epoch: 3, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.023 Vali Acc: 0.579 Test Loss: 1.023 Test Acc: 0.579
Validation loss decreased (-0.473672 --> -0.578937).  Saving model ...
Epoch: 4 cost time: 1.248037338256836
Epoch: 4, Steps: 10 | Train Loss: 0.788 Vali Loss: 0.860 Vali Acc: 0.658 Test Loss: 0.860 Test Acc: 0.658
Validation loss decreased (-0.578937 --> -0.657886).  Saving model ...
Epoch: 5 cost time: 1.4490642547607422
Epoch: 5, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.746 Vali Acc: 0.691 Test Loss: 0.746 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690782).  Saving model ...
Epoch: 6 cost time: 1.2524657249450684
Epoch: 6, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.671 Vali Acc: 0.724 Test Loss: 0.671 Test Acc: 0.724
Validation loss decreased (-0.690782 --> -0.723677).  Saving model ...
Epoch: 7 cost time: 1.1984853744506836
Epoch: 7, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.597 Vali Acc: 0.730 Test Loss: 0.597 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730257).  Saving model ...
Epoch: 8 cost time: 1.4369726181030273
Epoch: 8, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
Validation loss decreased (-0.730257 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.3206892013549805
Epoch: 9, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.553 Vali Acc: 0.757 Test Loss: 0.553 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6043102741241455
Epoch: 10, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.570796251296997
Epoch: 11, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
Validation loss decreased (-0.776310 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.0379202365875244
Epoch: 12, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4254589080810547
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2393600940704346
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.558 Vali Acc: 0.803 Test Loss: 0.558 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3903043270111084
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3476738929748535
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.511037826538086
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.592 Vali Acc: 0.796 Test Loss: 0.592 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5453100204467773
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815783).  Saving model ...
Epoch: 19 cost time: 1.3464720249176025
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3631269931793213
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.608 Vali Acc: 0.803 Test Loss: 0.608 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4375364780426025
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.620 Vali Acc: 0.803 Test Loss: 0.620 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6297080516815186
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.705571174621582
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.646043062210083
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.642 Vali Acc: 0.816 Test Loss: 0.642 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4582290649414062
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6210269927978516
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3812901973724365
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.666 Vali Acc: 0.809 Test Loss: 0.666 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4908239841461182
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.682 Vali Acc: 0.816 Test Loss: 0.682 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 56836
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.013317346572876
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.436 Vali Acc: 0.276 Test Loss: 1.436 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 1.8039896488189697
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.271 Vali Acc: 0.395 Test Loss: 1.271 Test Acc: 0.395
Validation loss decreased (-0.276301 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 1.88653564453125
Epoch: 3, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.087 Vali Acc: 0.526 Test Loss: 1.087 Test Acc: 0.526
Validation loss decreased (-0.394724 --> -0.526305).  Saving model ...
Epoch: 4 cost time: 1.8684477806091309
Epoch: 4, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.938 Vali Acc: 0.599 Test Loss: 0.938 Test Acc: 0.599
Validation loss decreased (-0.526305 --> -0.598675).  Saving model ...
Epoch: 5 cost time: 1.4750375747680664
Epoch: 5, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.824 Vali Acc: 0.664 Test Loss: 0.824 Test Acc: 0.664
Validation loss decreased (-0.598675 --> -0.664465).  Saving model ...
Epoch: 6 cost time: 2.081928253173828
Epoch: 6, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.731 Vali Acc: 0.724 Test Loss: 0.731 Test Acc: 0.724
Validation loss decreased (-0.664465 --> -0.723677).  Saving model ...
Epoch: 7 cost time: 1.5970370769500732
Epoch: 7, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.664 Vali Acc: 0.770 Test Loss: 0.664 Test Acc: 0.770
Validation loss decreased (-0.723677 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 1.2927203178405762
Epoch: 8, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.608 Vali Acc: 0.770 Test Loss: 0.608 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.3466219902038574
Epoch: 9, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.589 Vali Acc: 0.776 Test Loss: 0.589 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.4506688117980957
Epoch: 10, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.4658310413360596
Epoch: 11, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.629152774810791
Epoch: 12, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7951786518096924
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.5600035190582275
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.4023821353912354
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.34092116355896
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.547 Vali Acc: 0.796 Test Loss: 0.547 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3405025005340576
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6983516216278076
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3466804027557373
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8511619567871094
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.575 Vali Acc: 0.796 Test Loss: 0.575 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.735440969467163
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 22 cost time: 2.0653247833251953
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0854105949401855
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.592 Vali Acc: 0.796 Test Loss: 0.592 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0464141368865967
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.913365364074707
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7156322002410889
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.594 Vali Acc: 0.789 Test Loss: 0.594 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7325701713562012
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.602 Vali Acc: 0.796 Test Loss: 0.602 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2531874179840088
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.617 Vali Acc: 0.796 Test Loss: 0.617 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6134779453277588
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6025896072387695
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.034573554992676
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 49284
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.146547317504883
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.371 Vali Acc: 0.309 Test Loss: 1.371 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.1370837688446045
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.234 Vali Acc: 0.408 Test Loss: 1.234 Test Acc: 0.408
Validation loss decreased (-0.309197 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.3823027610778809
Epoch: 3, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.088 Vali Acc: 0.553 Test Loss: 1.088 Test Acc: 0.553
Validation loss decreased (-0.407882 --> -0.552621).  Saving model ...
Epoch: 4 cost time: 1.548156976699829
Epoch: 4, Steps: 10 | Train Loss: 0.871 Vali Loss: 0.954 Vali Acc: 0.612 Test Loss: 0.954 Test Acc: 0.612
Validation loss decreased (-0.552621 --> -0.611833).  Saving model ...
Epoch: 5 cost time: 1.3476347923278809
Epoch: 5, Steps: 10 | Train Loss: 0.719 Vali Loss: 0.850 Vali Acc: 0.632 Test Loss: 0.850 Test Acc: 0.632
Validation loss decreased (-0.611833 --> -0.631570).  Saving model ...
Epoch: 6 cost time: 1.4284858703613281
Epoch: 6, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.769 Vali Acc: 0.651 Test Loss: 0.769 Test Acc: 0.651
Validation loss decreased (-0.631570 --> -0.651308).  Saving model ...
Epoch: 7 cost time: 1.3697800636291504
Epoch: 7, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.704 Vali Acc: 0.691 Test Loss: 0.704 Test Acc: 0.691
Validation loss decreased (-0.651308 --> -0.690782).  Saving model ...
Epoch: 8 cost time: 1.3746545314788818
Epoch: 8, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.664 Vali Acc: 0.724 Test Loss: 0.664 Test Acc: 0.724
Validation loss decreased (-0.690782 --> -0.723678).  Saving model ...
Epoch: 9 cost time: 1.2704181671142578
Epoch: 9, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.651 Vali Acc: 0.730 Test Loss: 0.651 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 10 cost time: 1.2854666709899902
Epoch: 10, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.624 Vali Acc: 0.737 Test Loss: 0.624 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 11 cost time: 1.3656342029571533
Epoch: 11, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.610 Vali Acc: 0.750 Test Loss: 0.610 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 1.1406195163726807
Epoch: 12, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.605 Vali Acc: 0.770 Test Loss: 0.605 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.570103406906128
Epoch: 13, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.598 Vali Acc: 0.757 Test Loss: 0.598 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3501901626586914
Epoch: 14, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2779748439788818
Epoch: 15, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.2717969417572021
Epoch: 16, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.615 Vali Acc: 0.770 Test Loss: 0.615 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2747917175292969
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.620 Vali Acc: 0.763 Test Loss: 0.620 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3493516445159912
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.1741344928741455
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796046).  Saving model ...
Epoch: 20 cost time: 1.6076569557189941
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.649 Vali Acc: 0.796 Test Loss: 0.649 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.58961820602417
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.651 Vali Acc: 0.789 Test Loss: 0.651 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4916613101959229
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.653 Vali Acc: 0.796 Test Loss: 0.653 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3019177913665771
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.659 Vali Acc: 0.783 Test Loss: 0.659 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7144920825958252
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 25 cost time: 1.3330812454223633
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.678 Vali Acc: 0.796 Test Loss: 0.678 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5043690204620361
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.683 Vali Acc: 0.796 Test Loss: 0.683 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3347761631011963
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.691 Vali Acc: 0.796 Test Loss: 0.691 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1254782676696777
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.698 Vali Acc: 0.796 Test Loss: 0.698 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3257687091827393
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.697 Vali Acc: 0.803 Test Loss: 0.697 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3555796146392822
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.708 Vali Acc: 0.789 Test Loss: 0.708 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.547750473022461
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.714 Vali Acc: 0.796 Test Loss: 0.714 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.265204668045044
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.724 Vali Acc: 0.796 Test Loss: 0.724 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4387576580047607
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6402685642242432
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.736 Vali Acc: 0.796 Test Loss: 0.736 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 49348
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.458913087844849
Epoch: 1, Steps: 10 | Train Loss: 1.539 Vali Loss: 1.314 Vali Acc: 0.368 Test Loss: 1.314 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 1.5646164417266846
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.216 Vali Acc: 0.454 Test Loss: 1.216 Test Acc: 0.454
Validation loss decreased (-0.368408 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 1.420506477355957
Epoch: 3, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.098 Vali Acc: 0.566 Test Loss: 1.098 Test Acc: 0.566
Validation loss decreased (-0.453935 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 1.7351562976837158
Epoch: 4, Steps: 10 | Train Loss: 1.030 Vali Loss: 0.984 Vali Acc: 0.645 Test Loss: 0.984 Test Acc: 0.645
Validation loss decreased (-0.565778 --> -0.644727).  Saving model ...
Epoch: 5 cost time: 1.6930875778198242
Epoch: 5, Steps: 10 | Train Loss: 0.915 Vali Loss: 0.886 Vali Acc: 0.651 Test Loss: 0.886 Test Acc: 0.651
Validation loss decreased (-0.644727 --> -0.651307).  Saving model ...
Epoch: 6 cost time: 1.8194637298583984
Epoch: 6, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.803 Vali Acc: 0.678 Test Loss: 0.803 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677624).  Saving model ...
Epoch: 7 cost time: 1.306976318359375
Epoch: 7, Steps: 10 | Train Loss: 0.640 Vali Loss: 0.740 Vali Acc: 0.697 Test Loss: 0.740 Test Acc: 0.697
Validation loss decreased (-0.677624 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 1.5913965702056885
Epoch: 8, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.687 Vali Acc: 0.730 Test Loss: 0.687 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 1.5997750759124756
Epoch: 9, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.656 Vali Acc: 0.737 Test Loss: 0.656 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.5236258506774902
Epoch: 10, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.620 Vali Acc: 0.750 Test Loss: 0.620 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.8870832920074463
Epoch: 11, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.593 Vali Acc: 0.757 Test Loss: 0.593 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 1.658036231994629
Epoch: 12, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8637807369232178
Epoch: 13, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.562 Vali Acc: 0.757 Test Loss: 0.562 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 2.1335666179656982
Epoch: 14, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.4569215774536133
Epoch: 15, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.2022416591644287
Epoch: 16, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.742915153503418
Epoch: 17, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.394707202911377
Epoch: 18, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.576 Vali Acc: 0.789 Test Loss: 0.576 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.8177266120910645
Epoch: 19, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7612543106079102
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.08612060546875
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8448307514190674
Epoch: 22, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.593 Vali Acc: 0.789 Test Loss: 0.593 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8641211986541748
Epoch: 23, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.592 Vali Acc: 0.783 Test Loss: 0.592 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6809139251708984
Epoch: 24, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6641945838928223
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.610 Vali Acc: 0.783 Test Loss: 0.610 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7502567768096924
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5399034023284912
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.610 Vali Acc: 0.796 Test Loss: 0.610 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 1.8136818408966064
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3528239727020264
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.627 Vali Acc: 0.789 Test Loss: 0.627 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4449598789215088
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.420677661895752
Epoch: 31, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.653 Vali Acc: 0.789 Test Loss: 0.653 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.9876928329467773
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.0914478302001953
Epoch: 33, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8439245223999023
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.667 Vali Acc: 0.796 Test Loss: 0.667 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.965388536453247
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.671 Vali Acc: 0.789 Test Loss: 0.671 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.7459959983825684
Epoch: 36, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.675 Vali Acc: 0.796 Test Loss: 0.675 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4027161598205566
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.681 Vali Acc: 0.783 Test Loss: 0.681 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 44868
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.611825704574585
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.290 Vali Acc: 0.428 Test Loss: 1.290 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 1.685633659362793
Epoch: 2, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.007 Vali Acc: 0.599 Test Loss: 1.007 Test Acc: 0.599
Validation loss decreased (-0.427619 --> -0.598674).  Saving model ...
Epoch: 3 cost time: 1.7312631607055664
Epoch: 3, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.753 Vali Acc: 0.697 Test Loss: 0.753 Test Acc: 0.697
Validation loss decreased (-0.598674 --> -0.697361).  Saving model ...
Epoch: 4 cost time: 1.7199645042419434
Epoch: 4, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.634 Vali Acc: 0.757 Test Loss: 0.634 Test Acc: 0.757
Validation loss decreased (-0.697361 --> -0.756573).  Saving model ...
Epoch: 5 cost time: 1.5777099132537842
Epoch: 5, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 6 cost time: 1.5373311042785645
Epoch: 6, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 1.7288715839385986
Epoch: 7, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 8 cost time: 1.381852149963379
Epoch: 8, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.606916904449463
Epoch: 9, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.69926118850708
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1496236324310303
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 12 cost time: 1.8200199604034424
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.627 Vali Acc: 0.816 Test Loss: 0.627 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9029290676116943
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.596 Vali Acc: 0.829 Test Loss: 0.596 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828941).  Saving model ...
Epoch: 14 cost time: 1.3740992546081543
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.638 Vali Acc: 0.816 Test Loss: 0.638 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.509831190109253
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.627 Vali Acc: 0.829 Test Loss: 0.627 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3660037517547607
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.630 Vali Acc: 0.836 Test Loss: 0.630 Test Acc: 0.836
Validation loss decreased (-0.828941 --> -0.835520).  Saving model ...
Epoch: 17 cost time: 1.221883773803711
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.670 Vali Acc: 0.816 Test Loss: 0.670 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8155653476715088
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.931711196899414
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.689 Vali Acc: 0.816 Test Loss: 0.689 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6862566471099854
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.677 Vali Acc: 0.822 Test Loss: 0.677 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.749842882156372
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.696 Vali Acc: 0.822 Test Loss: 0.696 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8991115093231201
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.721 Vali Acc: 0.809 Test Loss: 0.721 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0140745639801025
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.704 Vali Acc: 0.822 Test Loss: 0.704 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5580954551696777
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.816 Test Loss: 0.717 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7268383502960205
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.760 Vali Acc: 0.822 Test Loss: 0.760 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8672878742218018
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.742 Vali Acc: 0.822 Test Loss: 0.742 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 71556
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.126925706863403
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.414 Vali Acc: 0.270 Test Loss: 1.414 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.4844822883605957
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.223 Vali Acc: 0.428 Test Loss: 1.223 Test Acc: 0.428
Validation loss decreased (-0.269723 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 1.1504535675048828
Epoch: 3, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.021 Vali Acc: 0.625 Test Loss: 1.021 Test Acc: 0.625
Validation loss decreased (-0.427619 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 1.2981255054473877
Epoch: 4, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.864 Vali Acc: 0.697 Test Loss: 0.864 Test Acc: 0.697
Validation loss decreased (-0.624990 --> -0.697360).  Saving model ...
Epoch: 5 cost time: 1.8512334823608398
Epoch: 5, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.757 Vali Acc: 0.704 Test Loss: 0.757 Test Acc: 0.704
Validation loss decreased (-0.697360 --> -0.703940).  Saving model ...
Epoch: 6 cost time: 1.1709749698638916
Epoch: 6, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.703 Vali Acc: 0.717 Test Loss: 0.703 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 0.990253210067749
Epoch: 7, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.634 Vali Acc: 0.757 Test Loss: 0.634 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.2880606651306152
Epoch: 8, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.590 Vali Acc: 0.750 Test Loss: 0.590 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.083259105682373
Epoch: 9, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.580 Vali Acc: 0.770 Test Loss: 0.580 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.307105541229248
Epoch: 10, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.1831068992614746
Epoch: 11, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.5704636573791504
Epoch: 12, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.567 Vali Acc: 0.770 Test Loss: 0.567 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6229779720306396
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3018736839294434
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4381983280181885
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.6582462787628174
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 1.4404888153076172
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.620 Vali Acc: 0.796 Test Loss: 0.620 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.330352544784546
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.625 Vali Acc: 0.796 Test Loss: 0.625 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4786231517791748
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.613 Vali Acc: 0.789 Test Loss: 0.613 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5784425735473633
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5870449542999268
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.622288465499878
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.295802354812622
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.636 Vali Acc: 0.796 Test Loss: 0.636 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2052221298217773
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.651 Vali Acc: 0.803 Test Loss: 0.651 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2247560024261475
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.652 Vali Acc: 0.803 Test Loss: 0.652 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5064706802368164
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.667 Vali Acc: 0.803 Test Loss: 0.667 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 48580
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.132915019989014
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.393 Vali Acc: 0.296 Test Loss: 1.393 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.6527214050292969
Epoch: 2, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.244 Vali Acc: 0.480 Test Loss: 1.244 Test Acc: 0.480
Validation loss decreased (-0.296039 --> -0.480251).  Saving model ...
Epoch: 3 cost time: 1.6175975799560547
Epoch: 3, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.091 Vali Acc: 0.579 Test Loss: 1.091 Test Acc: 0.579
Validation loss decreased (-0.480251 --> -0.578936).  Saving model ...
Epoch: 4 cost time: 1.801039695739746
Epoch: 4, Steps: 10 | Train Loss: 0.862 Vali Loss: 0.944 Vali Acc: 0.658 Test Loss: 0.944 Test Acc: 0.658
Validation loss decreased (-0.578936 --> -0.657885).  Saving model ...
Epoch: 5 cost time: 1.5900914669036865
Epoch: 5, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.823 Vali Acc: 0.691 Test Loss: 0.823 Test Acc: 0.691
Validation loss decreased (-0.657885 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 1.6162934303283691
Epoch: 6, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.741 Vali Acc: 0.684 Test Loss: 0.741 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.10111927986145
Epoch: 7, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.693 Vali Acc: 0.711 Test Loss: 0.693 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710519).  Saving model ...
Epoch: 8 cost time: 1.309908151626587
Epoch: 8, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
Validation loss decreased (-0.710519 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.4977498054504395
Epoch: 9, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.596 Vali Acc: 0.763 Test Loss: 0.596 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.471296787261963
Epoch: 10, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.727734088897705
Epoch: 11, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.565 Vali Acc: 0.763 Test Loss: 0.565 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7825868129730225
Epoch: 12, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.5408949851989746
Epoch: 13, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.852905511856079
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7597064971923828
Epoch: 15, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.6520216464996338
Epoch: 16, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.563 Vali Acc: 0.789 Test Loss: 0.563 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5596506595611572
Epoch: 17, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4714593887329102
Epoch: 18, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4946973323822021
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.574 Vali Acc: 0.796 Test Loss: 0.574 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.4557409286499023
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 1.595930814743042
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 22 cost time: 1.8817591667175293
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6702470779418945
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.590 Vali Acc: 0.803 Test Loss: 0.590 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.943044900894165
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6411795616149902
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8450212478637695
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8540072441101074
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1575422286987305
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5909984111785889
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.776280403137207
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.633 Vali Acc: 0.803 Test Loss: 0.633 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3791375160217285
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 41028
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9413347244262695
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.454 Vali Acc: 0.243 Test Loss: 1.454 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.3214786052703857
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.282 Vali Acc: 0.441 Test Loss: 1.282 Test Acc: 0.441
Validation loss decreased (-0.243407 --> -0.440777).  Saving model ...
Epoch: 3 cost time: 1.4645521640777588
Epoch: 3, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.120 Vali Acc: 0.526 Test Loss: 1.120 Test Acc: 0.526
Validation loss decreased (-0.440777 --> -0.526305).  Saving model ...
Epoch: 4 cost time: 1.2700567245483398
Epoch: 4, Steps: 10 | Train Loss: 0.925 Vali Loss: 0.985 Vali Acc: 0.612 Test Loss: 0.985 Test Acc: 0.612
Validation loss decreased (-0.526305 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 1.2487609386444092
Epoch: 5, Steps: 10 | Train Loss: 0.756 Vali Loss: 0.873 Vali Acc: 0.691 Test Loss: 0.873 Test Acc: 0.691
Validation loss decreased (-0.611832 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 1.6680688858032227
Epoch: 6, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.784 Vali Acc: 0.697 Test Loss: 0.784 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697361).  Saving model ...
Epoch: 7 cost time: 1.1782143115997314
Epoch: 7, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.710 Vali Acc: 0.730 Test Loss: 0.710 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.0951900482177734
Epoch: 8, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.657 Vali Acc: 0.737 Test Loss: 0.657 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 1.4076995849609375
Epoch: 9, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.624 Vali Acc: 0.750 Test Loss: 0.624 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.1069786548614502
Epoch: 10, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.4186890125274658
Epoch: 11, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.588 Vali Acc: 0.770 Test Loss: 0.588 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.2836618423461914
Epoch: 12, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3076221942901611
Epoch: 13, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.326819896697998
Epoch: 14, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3835203647613525
Epoch: 15, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.36008620262146
Epoch: 16, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.3542723655700684
Epoch: 17, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.591 Vali Acc: 0.796 Test Loss: 0.591 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4644455909729004
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.614 Vali Acc: 0.796 Test Loss: 0.614 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2523727416992188
Epoch: 19, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.637876033782959
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.623 Vali Acc: 0.809 Test Loss: 0.623 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 21 cost time: 1.374502420425415
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.629 Vali Acc: 0.816 Test Loss: 0.629 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 22 cost time: 1.0929999351501465
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.633 Vali Acc: 0.803 Test Loss: 0.633 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3375723361968994
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.296281099319458
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1496310234069824
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0254812240600586
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4083654880523682
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.672 Vali Acc: 0.796 Test Loss: 0.672 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4253473281860352
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.677 Vali Acc: 0.803 Test Loss: 0.677 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7639837265014648
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3724453449249268
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.690 Vali Acc: 0.816 Test Loss: 0.690 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.217679738998413
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.697 Vali Acc: 0.796 Test Loss: 0.697 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 41092
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.226908206939697
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.384 Vali Acc: 0.283 Test Loss: 1.384 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.7059216499328613
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.278 Vali Acc: 0.395 Test Loss: 1.278 Test Acc: 0.395
Validation loss decreased (-0.282881 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 1.3522250652313232
Epoch: 3, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.161 Vali Acc: 0.513 Test Loss: 1.161 Test Acc: 0.513
Validation loss decreased (-0.394724 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 1.6128485202789307
Epoch: 4, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.047 Vali Acc: 0.546 Test Loss: 1.047 Test Acc: 0.546
Validation loss decreased (-0.513146 --> -0.546042).  Saving model ...
Epoch: 5 cost time: 1.4174995422363281
Epoch: 5, Steps: 10 | Train Loss: 0.845 Vali Loss: 0.953 Vali Acc: 0.592 Test Loss: 0.953 Test Acc: 0.592
Validation loss decreased (-0.546042 --> -0.592096).  Saving model ...
Epoch: 6 cost time: 1.5478143692016602
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.879 Vali Acc: 0.605 Test Loss: 0.879 Test Acc: 0.605
Validation loss decreased (-0.592096 --> -0.605254).  Saving model ...
Epoch: 7 cost time: 1.542823076248169
Epoch: 7, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.811 Vali Acc: 0.645 Test Loss: 0.811 Test Acc: 0.645
Validation loss decreased (-0.605254 --> -0.644729).  Saving model ...
Epoch: 8 cost time: 1.8380444049835205
Epoch: 8, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.743 Vali Acc: 0.684 Test Loss: 0.743 Test Acc: 0.684
Validation loss decreased (-0.644729 --> -0.684203).  Saving model ...
Epoch: 9 cost time: 1.547065019607544
Epoch: 9, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.703 Vali Acc: 0.684 Test Loss: 0.703 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684203).  Saving model ...
Epoch: 10 cost time: 1.4089534282684326
Epoch: 10, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.672 Vali Acc: 0.711 Test Loss: 0.672 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710520).  Saving model ...
Epoch: 11 cost time: 1.5108387470245361
Epoch: 11, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.654 Vali Acc: 0.743 Test Loss: 0.654 Test Acc: 0.743
Validation loss decreased (-0.710520 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.6258893013000488
Epoch: 12, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.644 Vali Acc: 0.743 Test Loss: 0.644 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 13 cost time: 1.1800060272216797
Epoch: 13, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.633 Vali Acc: 0.730 Test Loss: 0.633 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2759661674499512
Epoch: 14, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.618 Vali Acc: 0.750 Test Loss: 0.618 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.3614180088043213
Epoch: 15, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 1.210500717163086
Epoch: 16, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.620 Vali Acc: 0.757 Test Loss: 0.620 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4502699375152588
Epoch: 17, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.622 Vali Acc: 0.776 Test Loss: 0.622 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.1978211402893066
Epoch: 18, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.628 Vali Acc: 0.757 Test Loss: 0.628 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3892931938171387
Epoch: 19, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.637 Vali Acc: 0.757 Test Loss: 0.637 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3851900100708008
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.650 Vali Acc: 0.757 Test Loss: 0.650 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5027217864990234
Epoch: 21, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.654 Vali Acc: 0.770 Test Loss: 0.654 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1709308624267578
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.653 Vali Acc: 0.763 Test Loss: 0.653 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4617846012115479
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.655 Vali Acc: 0.776 Test Loss: 0.655 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7322382926940918
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.661 Vali Acc: 0.770 Test Loss: 0.661 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4594407081604004
Epoch: 25, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.664 Vali Acc: 0.776 Test Loss: 0.664 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0783796310424805
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.671 Vali Acc: 0.776 Test Loss: 0.671 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5879566669464111
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.681 Vali Acc: 0.783 Test Loss: 0.681 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 28 cost time: 1.0760319232940674
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.688 Vali Acc: 0.789 Test Loss: 0.688 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 29 cost time: 1.4968721866607666
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.695 Vali Acc: 0.789 Test Loss: 0.695 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.108299732208252
Epoch: 30, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1853587627410889
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.707 Vali Acc: 0.796 Test Loss: 0.707 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 32 cost time: 1.4823503494262695
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.711 Vali Acc: 0.776 Test Loss: 0.711 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5562758445739746
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.712 Vali Acc: 0.789 Test Loss: 0.712 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3034319877624512
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.716 Vali Acc: 0.789 Test Loss: 0.716 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.138505220413208
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.720 Vali Acc: 0.789 Test Loss: 0.720 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3619909286499023
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.726 Vali Acc: 0.796 Test Loss: 0.726 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2146580219268799
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.733 Vali Acc: 0.803 Test Loss: 0.733 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 38 cost time: 1.3304252624511719
Epoch: 38, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.737 Vali Acc: 0.796 Test Loss: 0.737 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3498778343200684
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.744 Vali Acc: 0.796 Test Loss: 0.744 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1070239543914795
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.752 Vali Acc: 0.796 Test Loss: 0.752 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.551670789718628
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.760 Vali Acc: 0.803 Test Loss: 0.760 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.4243018627166748
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.764 Vali Acc: 0.803 Test Loss: 0.764 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.220395803451538
Epoch: 43, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.769 Vali Acc: 0.803 Test Loss: 0.769 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3652617931365967
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.774 Vali Acc: 0.796 Test Loss: 0.774 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.2223351001739502
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.775 Vali Acc: 0.796 Test Loss: 0.775 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.511033296585083
Epoch: 46, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.784 Vali Acc: 0.803 Test Loss: 0.784 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.386070966720581
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.786 Vali Acc: 0.796 Test Loss: 0.786 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 36612
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.188993692398071
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.243 Vali Acc: 0.447 Test Loss: 1.243 Test Acc: 0.447
Validation loss decreased (inf --> -0.447356).  Saving model ...
Epoch: 2 cost time: 1.4109017848968506
Epoch: 2, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.040 Vali Acc: 0.618 Test Loss: 1.040 Test Acc: 0.618
Validation loss decreased (-0.447356 --> -0.618411).  Saving model ...
Epoch: 3 cost time: 1.372035264968872
Epoch: 3, Steps: 10 | Train Loss: 0.925 Vali Loss: 0.867 Vali Acc: 0.684 Test Loss: 0.867 Test Acc: 0.684
Validation loss decreased (-0.618411 --> -0.684202).  Saving model ...
Epoch: 4 cost time: 1.27235746383667
Epoch: 4, Steps: 10 | Train Loss: 0.703 Vali Loss: 0.740 Vali Acc: 0.704 Test Loss: 0.740 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 1.3808043003082275
Epoch: 5, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
Validation loss decreased (-0.703940 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.3224310874938965
Epoch: 6, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.3616960048675537
Epoch: 7, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.7128980159759521
Epoch: 8, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
Validation loss decreased (-0.789468 --> -0.815785).  Saving model ...
Epoch: 9 cost time: 1.3615012168884277
Epoch: 9, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3552944660186768
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4707615375518799
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.495 Vali Acc: 0.829 Test Loss: 0.495 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828942).  Saving model ...
Epoch: 12 cost time: 1.3308839797973633
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.368060827255249
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.55253267288208
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5988149642944336
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.517594814300537
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3020386695861816
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2588539123535156
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2419140338897705
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2227301597595215
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1538152694702148
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 44196
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.3636415004730225
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.371 Vali Acc: 0.349 Test Loss: 1.371 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 2.0116541385650635
Epoch: 2, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.267 Vali Acc: 0.395 Test Loss: 1.267 Test Acc: 0.395
Validation loss decreased (-0.348671 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 1.513493299484253
Epoch: 3, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.146 Vali Acc: 0.533 Test Loss: 1.146 Test Acc: 0.533
Validation loss decreased (-0.394724 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 1.9634642601013184
Epoch: 4, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.031 Vali Acc: 0.599 Test Loss: 1.031 Test Acc: 0.599
Validation loss decreased (-0.532883 --> -0.598674).  Saving model ...
Epoch: 5 cost time: 1.8304097652435303
Epoch: 5, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.931 Vali Acc: 0.618 Test Loss: 0.931 Test Acc: 0.618
Validation loss decreased (-0.598674 --> -0.618412).  Saving model ...
Epoch: 6 cost time: 2.1369051933288574
Epoch: 6, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.844 Vali Acc: 0.671 Test Loss: 0.844 Test Acc: 0.671
Validation loss decreased (-0.618412 --> -0.671044).  Saving model ...
Epoch: 7 cost time: 1.666330099105835
Epoch: 7, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.759 Vali Acc: 0.697 Test Loss: 0.759 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 2.1775574684143066
Epoch: 8, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.696 Vali Acc: 0.730 Test Loss: 0.696 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 1.7560045719146729
Epoch: 9, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.646 Vali Acc: 0.743 Test Loss: 0.646 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 10 cost time: 1.4839608669281006
Epoch: 10, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.608 Vali Acc: 0.743 Test Loss: 0.608 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 11 cost time: 1.4725995063781738
Epoch: 11, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.5473287105560303
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.559 Vali Acc: 0.770 Test Loss: 0.559 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.3547680377960205
Epoch: 13, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.7062671184539795
Epoch: 14, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5630147457122803
Epoch: 15, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.534 Vali Acc: 0.783 Test Loss: 0.534 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5626044273376465
Epoch: 16, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.3882026672363281
Epoch: 17, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.5099074840545654
Epoch: 18, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5717837810516357
Epoch: 19, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.691819667816162
Epoch: 20, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3725464344024658
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8334834575653076
Epoch: 22, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9445760250091553
Epoch: 23, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.576 Vali Acc: 0.789 Test Loss: 0.576 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8163974285125732
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7881879806518555
Epoch: 25, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8346264362335205
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.589 Vali Acc: 0.796 Test Loss: 0.589 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.516037940979004
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 32708
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.082958698272705
Epoch: 1, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.318 Vali Acc: 0.467 Test Loss: 1.318 Test Acc: 0.467
Validation loss decreased (inf --> -0.467092).  Saving model ...
Epoch: 2 cost time: 1.608203411102295
Epoch: 2, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.225 Vali Acc: 0.487 Test Loss: 1.225 Test Acc: 0.487
Validation loss decreased (-0.467092 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.3336498737335205
Epoch: 3, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.126 Vali Acc: 0.539 Test Loss: 1.126 Test Acc: 0.539
Validation loss decreased (-0.486830 --> -0.539462).  Saving model ...
Epoch: 4 cost time: 1.3737456798553467
Epoch: 4, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.027 Vali Acc: 0.605 Test Loss: 1.027 Test Acc: 0.605
Validation loss decreased (-0.539462 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 1.281851053237915
Epoch: 5, Steps: 10 | Train Loss: 0.860 Vali Loss: 0.935 Vali Acc: 0.638 Test Loss: 0.935 Test Acc: 0.638
Validation loss decreased (-0.605253 --> -0.638149).  Saving model ...
Epoch: 6 cost time: 1.1562941074371338
Epoch: 6, Steps: 10 | Train Loss: 0.767 Vali Loss: 0.857 Vali Acc: 0.697 Test Loss: 0.857 Test Acc: 0.697
Validation loss decreased (-0.638149 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 1.6891920566558838
Epoch: 7, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.790 Vali Acc: 0.730 Test Loss: 0.790 Test Acc: 0.730
Validation loss decreased (-0.697360 --> -0.730255).  Saving model ...
Epoch: 8 cost time: 1.6815464496612549
Epoch: 8, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.733 Vali Acc: 0.737 Test Loss: 0.733 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 1.7147159576416016
Epoch: 9, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.694 Vali Acc: 0.743 Test Loss: 0.694 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 10 cost time: 1.808739185333252
Epoch: 10, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.523921251296997
Epoch: 11, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.614 Vali Acc: 0.763 Test Loss: 0.614 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.917076587677002
Epoch: 12, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.588 Vali Acc: 0.763 Test Loss: 0.588 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.2703113555908203
Epoch: 13, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.4391260147094727
Epoch: 14, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.5506126880645752
Epoch: 15, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.3337998390197754
Epoch: 16, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.528134822845459
Epoch: 17, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.517089605331421
Epoch: 18, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.410193681716919
Epoch: 19, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3950979709625244
Epoch: 20, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 1.9828908443450928
Epoch: 21, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6594045162200928
Epoch: 22, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.956240177154541
Epoch: 23, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2007853984832764
Epoch: 24, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 25 cost time: 1.4616141319274902
Epoch: 25, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2669978141784668
Epoch: 26, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5258262157440186
Epoch: 27, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6188910007476807
Epoch: 28, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6664156913757324
Epoch: 29, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6697781085968018
Epoch: 30, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.532 Vali Acc: 0.796 Test Loss: 0.532 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.854029655456543
Epoch: 31, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7543303966522217
Epoch: 32, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6688847541809082
Epoch: 33, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.7283878326416016
Epoch: 34, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 28932
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.542194366455078
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.374 Vali Acc: 0.362 Test Loss: 1.374 Test Acc: 0.362
Validation loss decreased (inf --> -0.361828).  Saving model ...
Epoch: 2 cost time: 1.4781384468078613
Epoch: 2, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.282 Vali Acc: 0.428 Test Loss: 1.282 Test Acc: 0.428
Validation loss decreased (-0.361828 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 1.070620059967041
Epoch: 3, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.183 Vali Acc: 0.513 Test Loss: 1.183 Test Acc: 0.513
Validation loss decreased (-0.427619 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 1.5118978023529053
Epoch: 4, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.086 Vali Acc: 0.586 Test Loss: 1.086 Test Acc: 0.586
Validation loss decreased (-0.513146 --> -0.585515).  Saving model ...
Epoch: 5 cost time: 1.1768097877502441
Epoch: 5, Steps: 10 | Train Loss: 0.946 Vali Loss: 0.996 Vali Acc: 0.645 Test Loss: 0.996 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644727).  Saving model ...
Epoch: 6 cost time: 1.113600492477417
Epoch: 6, Steps: 10 | Train Loss: 0.795 Vali Loss: 0.912 Vali Acc: 0.671 Test Loss: 0.912 Test Acc: 0.671
Validation loss decreased (-0.644727 --> -0.671044).  Saving model ...
Epoch: 7 cost time: 1.2604455947875977
Epoch: 7, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.838 Vali Acc: 0.678 Test Loss: 0.838 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677623).  Saving model ...
Epoch: 8 cost time: 1.1636157035827637
Epoch: 8, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
Validation loss decreased (-0.677623 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 1.1953105926513672
Epoch: 9, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.721 Vali Acc: 0.724 Test Loss: 0.721 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 1.3760473728179932
Epoch: 10, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.673 Vali Acc: 0.750 Test Loss: 0.673 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 1.213329553604126
Epoch: 11, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.628 Vali Acc: 0.743 Test Loss: 0.628 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3864238262176514
Epoch: 12, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.290998935699463
Epoch: 13, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.5100805759429932
Epoch: 14, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 0.9446191787719727
Epoch: 15, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.558 Vali Acc: 0.796 Test Loss: 0.558 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.1667447090148926
Epoch: 16, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.3511841297149658
Epoch: 17, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.3678734302520752
Epoch: 18, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 19 cost time: 1.2175226211547852
Epoch: 19, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 20 cost time: 1.3657796382904053
Epoch: 20, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3581774234771729
Epoch: 21, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2568299770355225
Epoch: 22, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 23 cost time: 1.224052906036377
Epoch: 23, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 24 cost time: 1.3027980327606201
Epoch: 24, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6026711463928223
Epoch: 25, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3081896305084229
Epoch: 26, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2836244106292725
Epoch: 27, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4423637390136719
Epoch: 28, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1217401027679443
Epoch: 29, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.509673833847046
Epoch: 30, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.4898881912231445
Epoch: 31, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3624699115753174
Epoch: 32, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4049584865570068
Epoch: 33, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 28964
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.282639741897583
Epoch: 1, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.330 Vali Acc: 0.316 Test Loss: 1.330 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.014986515045166
Epoch: 2, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.269 Vali Acc: 0.329 Test Loss: 1.269 Test Acc: 0.329
Validation loss decreased (-0.315776 --> -0.328935).  Saving model ...
Epoch: 3 cost time: 1.4977431297302246
Epoch: 3, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.194 Vali Acc: 0.447 Test Loss: 1.194 Test Acc: 0.447
Validation loss decreased (-0.328935 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.1793875694274902
Epoch: 4, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.111 Vali Acc: 0.487 Test Loss: 1.111 Test Acc: 0.487
Validation loss decreased (-0.447356 --> -0.486831).  Saving model ...
Epoch: 5 cost time: 1.1451196670532227
Epoch: 5, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.033 Vali Acc: 0.572 Test Loss: 1.033 Test Acc: 0.572
Validation loss decreased (-0.486831 --> -0.572358).  Saving model ...
Epoch: 6 cost time: 1.136251449584961
Epoch: 6, Steps: 10 | Train Loss: 0.894 Vali Loss: 0.968 Vali Acc: 0.618 Test Loss: 0.968 Test Acc: 0.618
Validation loss decreased (-0.572358 --> -0.618411).  Saving model ...
Epoch: 7 cost time: 1.1063861846923828
Epoch: 7, Steps: 10 | Train Loss: 0.852 Vali Loss: 0.907 Vali Acc: 0.651 Test Loss: 0.907 Test Acc: 0.651
Validation loss decreased (-0.618411 --> -0.651307).  Saving model ...
Epoch: 8 cost time: 1.1508605480194092
Epoch: 8, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.854 Vali Acc: 0.664 Test Loss: 0.854 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664465).  Saving model ...
Epoch: 9 cost time: 1.3517019748687744
Epoch: 9, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.807 Vali Acc: 0.678 Test Loss: 0.807 Test Acc: 0.678
Validation loss decreased (-0.664465 --> -0.677624).  Saving model ...
Epoch: 10 cost time: 1.809133768081665
Epoch: 10, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.759 Vali Acc: 0.684 Test Loss: 0.759 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 11 cost time: 0.9608826637268066
Epoch: 11, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.719 Vali Acc: 0.697 Test Loss: 0.719 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 12 cost time: 1.4343233108520508
Epoch: 12, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 13 cost time: 1.1214072704315186
Epoch: 13, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.661 Vali Acc: 0.724 Test Loss: 0.661 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723678).  Saving model ...
Epoch: 14 cost time: 1.1581919193267822
Epoch: 14, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.639 Vali Acc: 0.724 Test Loss: 0.639 Test Acc: 0.724
Validation loss decreased (-0.723678 --> -0.723678).  Saving model ...
Epoch: 15 cost time: 1.065152883529663
Epoch: 15, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.620 Vali Acc: 0.737 Test Loss: 0.620 Test Acc: 0.737
Validation loss decreased (-0.723678 --> -0.736836).  Saving model ...
Epoch: 16 cost time: 1.0925774574279785
Epoch: 16, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.602 Vali Acc: 0.743 Test Loss: 0.602 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 17 cost time: 1.236816644668579
Epoch: 17, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.3152635097503662
Epoch: 18, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.5047054290771484
Epoch: 19, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.580 Vali Acc: 0.763 Test Loss: 0.580 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4774413108825684
Epoch: 20, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.577 Vali Acc: 0.763 Test Loss: 0.577 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4436593055725098
Epoch: 21, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 22 cost time: 1.169969081878662
Epoch: 22, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 1.7096679210662842
Epoch: 23, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4828474521636963
Epoch: 24, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7074131965637207
Epoch: 25, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5991542339324951
Epoch: 26, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0489990711212158
Epoch: 27, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4159789085388184
Epoch: 28, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0526411533355713
Epoch: 29, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3893382549285889
Epoch: 30, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.580 Vali Acc: 0.776 Test Loss: 0.580 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1832408905029297
Epoch: 31, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.580 Vali Acc: 0.776 Test Loss: 0.580 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2693040370941162
Epoch: 32, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 26724
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.070444107055664
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.400 Vali Acc: 0.303 Test Loss: 1.400 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.082211971282959
Epoch: 2, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.198 Vali Acc: 0.513 Test Loss: 1.198 Test Acc: 0.513
Validation loss decreased (-0.302618 --> -0.513146).  Saving model ...
Epoch: 3 cost time: 1.2904963493347168
Epoch: 3, Steps: 10 | Train Loss: 0.986 Vali Loss: 0.990 Vali Acc: 0.651 Test Loss: 0.990 Test Acc: 0.651
Validation loss decreased (-0.513146 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 1.048656702041626
Epoch: 4, Steps: 10 | Train Loss: 0.816 Vali Loss: 0.838 Vali Acc: 0.691 Test Loss: 0.838 Test Acc: 0.691
Validation loss decreased (-0.651306 --> -0.690781).  Saving model ...
Epoch: 5 cost time: 1.2321863174438477
Epoch: 5, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.719 Vali Acc: 0.717 Test Loss: 0.719 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.1361522674560547
Epoch: 6, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.639 Vali Acc: 0.743 Test Loss: 0.639 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743415).  Saving model ...
Epoch: 7 cost time: 1.3224570751190186
Epoch: 7, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.577 Vali Acc: 0.763 Test Loss: 0.577 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.0937678813934326
Epoch: 8, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.532 Vali Acc: 0.763 Test Loss: 0.532 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 9 cost time: 1.2245943546295166
Epoch: 9, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.514 Vali Acc: 0.789 Test Loss: 0.514 Test Acc: 0.789
Validation loss decreased (-0.763153 --> -0.789469).  Saving model ...
Epoch: 10 cost time: 1.4364066123962402
Epoch: 10, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 11 cost time: 1.5068082809448242
Epoch: 11, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 12 cost time: 1.3110647201538086
Epoch: 12, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6375641822814941
Epoch: 13, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.0346989631652832
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.389296293258667
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2905604839324951
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 17 cost time: 1.2392158508300781
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7219209671020508
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2410106658935547
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2758638858795166
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.300910234451294
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2839281558990479
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7600071430206299
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.591 Vali Acc: 0.816 Test Loss: 0.591 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4768030643463135
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.500673532485962
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.34360933303833
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 35876
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8497369289398193
Epoch: 1, Steps: 10 | Train Loss: 1.530 Vali Loss: 1.464 Vali Acc: 0.276 Test Loss: 1.464 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 1.63954496383667
Epoch: 2, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.371 Vali Acc: 0.349 Test Loss: 1.371 Test Acc: 0.349
Validation loss decreased (-0.276301 --> -0.348670).  Saving model ...
Epoch: 3 cost time: 1.2669134140014648
Epoch: 3, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.240 Vali Acc: 0.480 Test Loss: 1.240 Test Acc: 0.480
Validation loss decreased (-0.348670 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 1.7494347095489502
Epoch: 4, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.106 Vali Acc: 0.553 Test Loss: 1.106 Test Acc: 0.553
Validation loss decreased (-0.480251 --> -0.552621).  Saving model ...
Epoch: 5 cost time: 1.3215875625610352
Epoch: 5, Steps: 10 | Train Loss: 0.930 Vali Loss: 0.981 Vali Acc: 0.625 Test Loss: 0.981 Test Acc: 0.625
Validation loss decreased (-0.552621 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 1.3955433368682861
Epoch: 6, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.879 Vali Acc: 0.658 Test Loss: 0.879 Test Acc: 0.658
Validation loss decreased (-0.624990 --> -0.657886).  Saving model ...
Epoch: 7 cost time: 1.5647706985473633
Epoch: 7, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.782 Vali Acc: 0.691 Test Loss: 0.782 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690782).  Saving model ...
Epoch: 8 cost time: 1.506324052810669
Epoch: 8, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.710 Vali Acc: 0.743 Test Loss: 0.710 Test Acc: 0.743
Validation loss decreased (-0.690782 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 1.3946492671966553
Epoch: 9, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.661 Vali Acc: 0.750 Test Loss: 0.661 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 1.643566608428955
Epoch: 10, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.605 Vali Acc: 0.783 Test Loss: 0.605 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.6873440742492676
Epoch: 11, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8107357025146484
Epoch: 12, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6178791522979736
Epoch: 13, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.2173352241516113
Epoch: 14, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 15 cost time: 1.6268978118896484
Epoch: 15, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.544353723526001
Epoch: 16, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.5062055587768555
Epoch: 17, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2813730239868164
Epoch: 18, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.267425537109375
Epoch: 19, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 20 cost time: 1.6986711025238037
Epoch: 20, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.6599137783050537
Epoch: 21, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 22 cost time: 1.6990118026733398
Epoch: 22, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4451136589050293
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6733901500701904
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6079859733581543
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8521103858947754
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7653851509094238
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.654390573501587
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.421264886856079
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7487969398498535
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.8232262134552002
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 24388
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.2048633098602295
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.425 Vali Acc: 0.270 Test Loss: 1.425 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 2.0578739643096924
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.351 Vali Acc: 0.342 Test Loss: 1.351 Test Acc: 0.342
Validation loss decreased (-0.269723 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.412715196609497
Epoch: 3, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.245 Vali Acc: 0.421 Test Loss: 1.245 Test Acc: 0.421
Validation loss decreased (-0.342092 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.3004722595214844
Epoch: 4, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.139 Vali Acc: 0.480 Test Loss: 1.139 Test Acc: 0.480
Validation loss decreased (-0.421040 --> -0.480252).  Saving model ...
Epoch: 5 cost time: 1.5947978496551514
Epoch: 5, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.035 Vali Acc: 0.566 Test Loss: 1.035 Test Acc: 0.566
Validation loss decreased (-0.480252 --> -0.565779).  Saving model ...
Epoch: 6 cost time: 1.8347437381744385
Epoch: 6, Steps: 10 | Train Loss: 0.844 Vali Loss: 0.943 Vali Acc: 0.658 Test Loss: 0.943 Test Acc: 0.658
Validation loss decreased (-0.565779 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 1.5179283618927002
Epoch: 7, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.869 Vali Acc: 0.678 Test Loss: 0.869 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677623).  Saving model ...
Epoch: 8 cost time: 1.4036874771118164
Epoch: 8, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.799 Vali Acc: 0.671 Test Loss: 0.799 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7697079181671143
Epoch: 9, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.744 Vali Acc: 0.697 Test Loss: 0.744 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 10 cost time: 1.4955437183380127
Epoch: 10, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.703 Vali Acc: 0.724 Test Loss: 0.703 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 1.6778604984283447
Epoch: 11, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.659 Vali Acc: 0.750 Test Loss: 0.659 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.600632667541504
Epoch: 12, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.624 Vali Acc: 0.776 Test Loss: 0.624 Test Acc: 0.776
Validation loss decreased (-0.749993 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.1322872638702393
Epoch: 13, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.4819879531860352
Epoch: 14, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1929783821105957
Epoch: 15, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1933207511901855
Epoch: 16, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3819873332977295
Epoch: 17, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5715460777282715
Epoch: 18, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5931971073150635
Epoch: 19, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.2679734230041504
Epoch: 20, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7729077339172363
Epoch: 21, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.739764928817749
Epoch: 22, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 1.5414206981658936
Epoch: 23, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5237488746643066
Epoch: 24, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4747841358184814
Epoch: 25, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2915496826171875
Epoch: 26, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8879694938659668
Epoch: 27, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5132040977478027
Epoch: 28, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.417628288269043
Epoch: 29, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.3161604404449463
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3401825428009033
Epoch: 31, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4366273880004883
Epoch: 32, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4177474975585938
Epoch: 33, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.25919246673584
Epoch: 34, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3878710269927979
Epoch: 35, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.642385721206665
Epoch: 36, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 37 cost time: 1.3581428527832031
Epoch: 37, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4783124923706055
Epoch: 38, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3066778182983398
Epoch: 39, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6110403537750244
Epoch: 40, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4513428211212158
Epoch: 41, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.7948675155639648
Epoch: 42, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.579 Vali Acc: 0.796 Test Loss: 0.579 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.8186578750610352
Epoch: 43, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.27156400680542
Epoch: 44, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.539090871810913
Epoch: 45, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.6235485076904297
Epoch: 46, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 20612
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.942394971847534
Epoch: 1, Steps: 10 | Train Loss: 1.710 Vali Loss: 1.546 Vali Acc: 0.204 Test Loss: 1.546 Test Acc: 0.204
Validation loss decreased (inf --> -0.203932).  Saving model ...
Epoch: 2 cost time: 1.4329829216003418
Epoch: 2, Steps: 10 | Train Loss: 1.562 Vali Loss: 1.442 Vali Acc: 0.257 Test Loss: 1.442 Test Acc: 0.257
Validation loss decreased (-0.203932 --> -0.256565).  Saving model ...
Epoch: 3 cost time: 1.4297609329223633
Epoch: 3, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.325 Vali Acc: 0.362 Test Loss: 1.325 Test Acc: 0.362
Validation loss decreased (-0.256565 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 1.6139371395111084
Epoch: 4, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.203 Vali Acc: 0.487 Test Loss: 1.203 Test Acc: 0.487
Validation loss decreased (-0.361829 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 1.551546573638916
Epoch: 5, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.087 Vali Acc: 0.553 Test Loss: 1.087 Test Acc: 0.553
Validation loss decreased (-0.486830 --> -0.552621).  Saving model ...
Epoch: 6 cost time: 1.4890320301055908
Epoch: 6, Steps: 10 | Train Loss: 0.901 Vali Loss: 0.993 Vali Acc: 0.579 Test Loss: 0.993 Test Acc: 0.579
Validation loss decreased (-0.552621 --> -0.578937).  Saving model ...
Epoch: 7 cost time: 1.7809264659881592
Epoch: 7, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.913 Vali Acc: 0.632 Test Loss: 0.913 Test Acc: 0.632
Validation loss decreased (-0.578937 --> -0.631570).  Saving model ...
Epoch: 8 cost time: 1.692490816116333
Epoch: 8, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.821 Vali Acc: 0.711 Test Loss: 0.821 Test Acc: 0.711
Validation loss decreased (-0.631570 --> -0.710518).  Saving model ...
Epoch: 9 cost time: 1.4659361839294434
Epoch: 9, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.749 Vali Acc: 0.730 Test Loss: 0.749 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 1.7049024105072021
Epoch: 10, Steps: 10 | Train Loss: 0.492 Vali Loss: 0.699 Vali Acc: 0.750 Test Loss: 0.699 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 1.44270920753479
Epoch: 11, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.649 Vali Acc: 0.743 Test Loss: 0.649 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2844011783599854
Epoch: 12, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.5007688999176025
Epoch: 13, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.590 Vali Acc: 0.757 Test Loss: 0.590 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.7675416469573975
Epoch: 14, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.3517060279846191
Epoch: 15, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6802191734313965
Epoch: 16, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 17 cost time: 1.7693524360656738
Epoch: 17, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.7439370155334473
Epoch: 18, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.329779863357544
Epoch: 19, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1361403465270996
Epoch: 20, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 21 cost time: 1.5291054248809814
Epoch: 21, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6431195735931396
Epoch: 22, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5850157737731934
Epoch: 23, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.475684404373169
Epoch: 24, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4516496658325195
Epoch: 25, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.641721248626709
Epoch: 26, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5621235370635986
Epoch: 27, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.0415151119232178
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9317116737365723
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.0344011783599854
Epoch: 30, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 20644
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.019109487533569
Epoch: 1, Steps: 10 | Train Loss: 1.567 Vali Loss: 1.568 Vali Acc: 0.145 Test Loss: 1.568 Test Acc: 0.145
Validation loss decreased (inf --> -0.144721).  Saving model ...
Epoch: 2 cost time: 1.2015039920806885
Epoch: 2, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.495 Vali Acc: 0.191 Test Loss: 1.495 Test Acc: 0.191
Validation loss decreased (-0.144721 --> -0.190775).  Saving model ...
Epoch: 3 cost time: 1.5704352855682373
Epoch: 3, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.405 Vali Acc: 0.303 Test Loss: 1.405 Test Acc: 0.303
Validation loss decreased (-0.190775 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 1.314866065979004
Epoch: 4, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.308 Vali Acc: 0.434 Test Loss: 1.308 Test Acc: 0.434
Validation loss decreased (-0.302618 --> -0.434197).  Saving model ...
Epoch: 5 cost time: 1.6479451656341553
Epoch: 5, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.213 Vali Acc: 0.487 Test Loss: 1.213 Test Acc: 0.487
Validation loss decreased (-0.434197 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 1.248199462890625
Epoch: 6, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.123 Vali Acc: 0.526 Test Loss: 1.123 Test Acc: 0.526
Validation loss decreased (-0.486830 --> -0.526305).  Saving model ...
Epoch: 7 cost time: 1.431269884109497
Epoch: 7, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.040 Vali Acc: 0.579 Test Loss: 1.040 Test Acc: 0.579
Validation loss decreased (-0.526305 --> -0.578937).  Saving model ...
Epoch: 8 cost time: 1.2470550537109375
Epoch: 8, Steps: 10 | Train Loss: 0.843 Vali Loss: 0.965 Vali Acc: 0.618 Test Loss: 0.965 Test Acc: 0.618
Validation loss decreased (-0.578937 --> -0.618411).  Saving model ...
Epoch: 9 cost time: 1.2597227096557617
Epoch: 9, Steps: 10 | Train Loss: 0.752 Vali Loss: 0.900 Vali Acc: 0.651 Test Loss: 0.900 Test Acc: 0.651
Validation loss decreased (-0.618411 --> -0.651307).  Saving model ...
Epoch: 10 cost time: 1.2595348358154297
Epoch: 10, Steps: 10 | Train Loss: 0.641 Vali Loss: 0.834 Vali Acc: 0.678 Test Loss: 0.834 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 11 cost time: 1.4128518104553223
Epoch: 11, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.783 Vali Acc: 0.704 Test Loss: 0.783 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703940).  Saving model ...
Epoch: 12 cost time: 1.3891401290893555
Epoch: 12, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.742 Vali Acc: 0.704 Test Loss: 0.742 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 13 cost time: 1.4755384922027588
Epoch: 13, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.708 Vali Acc: 0.730 Test Loss: 0.708 Test Acc: 0.730
Validation loss decreased (-0.703940 --> -0.730256).  Saving model ...
Epoch: 14 cost time: 0.9670557975769043
Epoch: 14, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.678 Vali Acc: 0.737 Test Loss: 0.678 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 15 cost time: 1.545111894607544
Epoch: 15, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.656 Vali Acc: 0.737 Test Loss: 0.656 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 16 cost time: 1.2235591411590576
Epoch: 16, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.642 Vali Acc: 0.724 Test Loss: 0.642 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.558384656906128
Epoch: 17, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.627 Vali Acc: 0.724 Test Loss: 0.627 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6429574489593506
Epoch: 18, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.617 Vali Acc: 0.717 Test Loss: 0.617 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4658660888671875
Epoch: 19, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.612 Vali Acc: 0.711 Test Loss: 0.612 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2796471118927002
Epoch: 20, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.606 Vali Acc: 0.730 Test Loss: 0.606 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4022185802459717
Epoch: 21, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.597 Vali Acc: 0.730 Test Loss: 0.597 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.425203800201416
Epoch: 22, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.593 Vali Acc: 0.730 Test Loss: 0.593 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9126989841461182
Epoch: 23, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.586 Vali Acc: 0.724 Test Loss: 0.586 Test Acc: 0.724
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7598490715026855
Epoch: 24, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.582 Vali Acc: 0.730 Test Loss: 0.582 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2363898754119873
Epoch: 25, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.580 Vali Acc: 0.750 Test Loss: 0.580 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 26 cost time: 1.1069800853729248
Epoch: 26, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.579 Vali Acc: 0.730 Test Loss: 0.579 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0324718952178955
Epoch: 27, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.582 Vali Acc: 0.730 Test Loss: 0.582 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2450122833251953
Epoch: 28, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.586 Vali Acc: 0.730 Test Loss: 0.586 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4242773056030273
Epoch: 29, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.407412052154541
Epoch: 30, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5590531826019287
Epoch: 31, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.591 Vali Acc: 0.743 Test Loss: 0.591 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4774067401885986
Epoch: 32, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 33 cost time: 1.3119606971740723
Epoch: 33, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 34 cost time: 1.6297147274017334
Epoch: 34, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2455453872680664
Epoch: 35, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0080645084381104
Epoch: 36, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.725013017654419
Epoch: 37, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.606 Vali Acc: 0.757 Test Loss: 0.606 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2692687511444092
Epoch: 38, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.613 Vali Acc: 0.757 Test Loss: 0.613 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2831568717956543
Epoch: 39, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.615 Vali Acc: 0.763 Test Loss: 0.615 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.7065699100494385
Epoch: 40, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.621 Vali Acc: 0.770 Test Loss: 0.621 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 41 cost time: 1.6202123165130615
Epoch: 41, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.622 Vali Acc: 0.770 Test Loss: 0.622 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6633782386779785
Epoch: 42, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.620 Vali Acc: 0.770 Test Loss: 0.620 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 43 cost time: 1.2991743087768555
Epoch: 43, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.623 Vali Acc: 0.776 Test Loss: 0.623 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 44 cost time: 1.5319547653198242
Epoch: 44, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.635 Vali Acc: 0.776 Test Loss: 0.635 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3014552593231201
Epoch: 45, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.639 Vali Acc: 0.776 Test Loss: 0.639 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6711363792419434
Epoch: 46, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.645 Vali Acc: 0.783 Test Loss: 0.645 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 47 cost time: 1.4886260032653809
Epoch: 47, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.649 Vali Acc: 0.776 Test Loss: 0.649 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.6881322860717773
Epoch: 48, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.652 Vali Acc: 0.776 Test Loss: 0.652 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.4741992950439453
Epoch: 49, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.654 Vali Acc: 0.789 Test Loss: 0.654 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 50 cost time: 1.2751975059509277
Epoch: 50, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.661 Vali Acc: 0.796 Test Loss: 0.661 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 51 cost time: 1.2131364345550537
Epoch: 51, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.668 Vali Acc: 0.796 Test Loss: 0.668 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2140848636627197
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.670 Vali Acc: 0.796 Test Loss: 0.670 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.5938551425933838
Epoch: 53, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.671 Vali Acc: 0.796 Test Loss: 0.671 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.970895528793335
Epoch: 54, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.6166629791259766
Epoch: 55, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.677 Vali Acc: 0.783 Test Loss: 0.677 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.6314213275909424
Epoch: 56, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.678 Vali Acc: 0.783 Test Loss: 0.678 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.4629547595977783
Epoch: 57, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.2371299266815186
Epoch: 58, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.5349094867706299
Epoch: 59, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.690 Vali Acc: 0.783 Test Loss: 0.690 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.243410587310791
Epoch: 60, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.691 Vali Acc: 0.783 Test Loss: 0.691 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 18404
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.157039642333984
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.364 Vali Acc: 0.362 Test Loss: 1.364 Test Acc: 0.362
Validation loss decreased (inf --> -0.361828).  Saving model ...
Epoch: 2 cost time: 1.4741272926330566
Epoch: 2, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.152 Vali Acc: 0.520 Test Loss: 1.152 Test Acc: 0.520
Validation loss decreased (-0.361828 --> -0.519725).  Saving model ...
Epoch: 3 cost time: 1.124718189239502
Epoch: 3, Steps: 10 | Train Loss: 1.043 Vali Loss: 0.970 Vali Acc: 0.664 Test Loss: 0.970 Test Acc: 0.664
Validation loss decreased (-0.519725 --> -0.664464).  Saving model ...
Epoch: 4 cost time: 1.103362798690796
Epoch: 4, Steps: 10 | Train Loss: 0.839 Vali Loss: 0.815 Vali Acc: 0.691 Test Loss: 0.815 Test Acc: 0.691
Validation loss decreased (-0.664464 --> -0.690781).  Saving model ...
Epoch: 5 cost time: 1.0609195232391357
Epoch: 5, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.694 Vali Acc: 0.724 Test Loss: 0.694 Test Acc: 0.724
Validation loss decreased (-0.690781 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.120802879333496
Epoch: 6, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.0793101787567139
Epoch: 7, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.2526872158050537
Epoch: 8, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.3931806087493896
Epoch: 9, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 10 cost time: 1.3969316482543945
Epoch: 10, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
Validation loss decreased (-0.796048 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 1.3163907527923584
Epoch: 11, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.353790521621704
Epoch: 12, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.483065128326416
Epoch: 13, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4163181781768799
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.496 Vali Acc: 0.836 Test Loss: 0.496 Test Acc: 0.836
Validation loss decreased (-0.822363 --> -0.835521).  Saving model ...
Epoch: 15 cost time: 1.229339361190796
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4318370819091797
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.522 Vali Acc: 0.842 Test Loss: 0.522 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 17 cost time: 1.1629219055175781
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.536 Vali Acc: 0.829 Test Loss: 0.536 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6527717113494873
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.533 Vali Acc: 0.836 Test Loss: 0.533 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2599639892578125
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.544 Vali Acc: 0.829 Test Loss: 0.544 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2735304832458496
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.117600440979004
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9578852653503418
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.565 Vali Acc: 0.829 Test Loss: 0.565 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3830821514129639
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.566 Vali Acc: 0.829 Test Loss: 0.566 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0181634426116943
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.146963119506836
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1226775646209717
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.581 Vali Acc: 0.829 Test Loss: 0.581 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 31716
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.422825574874878
Epoch: 1, Steps: 10 | Train Loss: 1.584 Vali Loss: 1.531 Vali Acc: 0.289 Test Loss: 1.531 Test Acc: 0.289
Validation loss decreased (inf --> -0.289458).  Saving model ...
Epoch: 2 cost time: 1.334381103515625
Epoch: 2, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.385 Vali Acc: 0.388 Test Loss: 1.385 Test Acc: 0.388
Validation loss decreased (-0.289458 --> -0.388144).  Saving model ...
Epoch: 3 cost time: 1.4177055358886719
Epoch: 3, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.241 Vali Acc: 0.467 Test Loss: 1.241 Test Acc: 0.467
Validation loss decreased (-0.388144 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 1.563406229019165
Epoch: 4, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.107 Vali Acc: 0.612 Test Loss: 1.107 Test Acc: 0.612
Validation loss decreased (-0.467093 --> -0.611831).  Saving model ...
Epoch: 5 cost time: 1.8538706302642822
Epoch: 5, Steps: 10 | Train Loss: 0.977 Vali Loss: 0.983 Vali Acc: 0.645 Test Loss: 0.983 Test Acc: 0.645
Validation loss decreased (-0.611831 --> -0.644727).  Saving model ...
Epoch: 6 cost time: 1.3390607833862305
Epoch: 6, Steps: 10 | Train Loss: 0.794 Vali Loss: 0.879 Vali Acc: 0.678 Test Loss: 0.879 Test Acc: 0.678
Validation loss decreased (-0.644727 --> -0.677623).  Saving model ...
Epoch: 7 cost time: 1.1784682273864746
Epoch: 7, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.793 Vali Acc: 0.704 Test Loss: 0.793 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703939).  Saving model ...
Epoch: 8 cost time: 1.2474751472473145
Epoch: 8, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.723 Vali Acc: 0.724 Test Loss: 0.723 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723677).  Saving model ...
Epoch: 9 cost time: 1.415254831314087
Epoch: 9, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.666 Vali Acc: 0.757 Test Loss: 0.666 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756572).  Saving model ...
Epoch: 10 cost time: 1.1205158233642578
Epoch: 10, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.634 Vali Acc: 0.770 Test Loss: 0.634 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 11 cost time: 1.534421443939209
Epoch: 11, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4876503944396973
Epoch: 12, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.4109034538269043
Epoch: 13, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.05220365524292
Epoch: 14, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.1583716869354248
Epoch: 15, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 0.9356014728546143
Epoch: 16, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6193468570709229
Epoch: 17, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3464281558990479
Epoch: 18, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.417168378829956
Epoch: 19, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3356602191925049
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 21 cost time: 1.055466890335083
Epoch: 21, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.269770860671997
Epoch: 22, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.226726770401001
Epoch: 23, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5260140895843506
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1406524181365967
Epoch: 25, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.224379301071167
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6235764026641846
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.387904405593872
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4843482971191406
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1725740432739258
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.574 Vali Acc: 0.803 Test Loss: 0.574 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 20228
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4544851779937744
Epoch: 1, Steps: 10 | Train Loss: 1.548 Vali Loss: 1.476 Vali Acc: 0.270 Test Loss: 1.476 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 0.9645321369171143
Epoch: 2, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.401 Vali Acc: 0.342 Test Loss: 1.401 Test Acc: 0.342
Validation loss decreased (-0.269722 --> -0.342091).  Saving model ...
Epoch: 3 cost time: 1.1569499969482422
Epoch: 3, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.297 Vali Acc: 0.434 Test Loss: 1.297 Test Acc: 0.434
Validation loss decreased (-0.342091 --> -0.434198).  Saving model ...
Epoch: 4 cost time: 1.3194339275360107
Epoch: 4, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.180 Vali Acc: 0.572 Test Loss: 1.180 Test Acc: 0.572
Validation loss decreased (-0.434198 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 1.2233357429504395
Epoch: 5, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.070 Vali Acc: 0.599 Test Loss: 1.070 Test Acc: 0.599
Validation loss decreased (-0.572357 --> -0.598674).  Saving model ...
Epoch: 6 cost time: 1.0001823902130127
Epoch: 6, Steps: 10 | Train Loss: 0.892 Vali Loss: 0.978 Vali Acc: 0.638 Test Loss: 0.978 Test Acc: 0.638
Validation loss decreased (-0.598674 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 1.3292567729949951
Epoch: 7, Steps: 10 | Train Loss: 0.756 Vali Loss: 0.893 Vali Acc: 0.651 Test Loss: 0.893 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651307).  Saving model ...
Epoch: 8 cost time: 1.6674315929412842
Epoch: 8, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.828 Vali Acc: 0.691 Test Loss: 0.828 Test Acc: 0.691
Validation loss decreased (-0.651307 --> -0.690781).  Saving model ...
Epoch: 9 cost time: 1.5482041835784912
Epoch: 9, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.776 Vali Acc: 0.704 Test Loss: 0.776 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703940).  Saving model ...
Epoch: 10 cost time: 1.5246326923370361
Epoch: 10, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.720 Vali Acc: 0.704 Test Loss: 0.720 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 11 cost time: 1.3955600261688232
Epoch: 11, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.683 Vali Acc: 0.711 Test Loss: 0.683 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 12 cost time: 1.6178219318389893
Epoch: 12, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.654 Vali Acc: 0.743 Test Loss: 0.654 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743415).  Saving model ...
Epoch: 13 cost time: 1.338087558746338
Epoch: 13, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.624 Vali Acc: 0.763 Test Loss: 0.624 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 1.0982966423034668
Epoch: 14, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.1471354961395264
Epoch: 15, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.2063324451446533
Epoch: 16, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.3907496929168701
Epoch: 17, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.5586397647857666
Epoch: 18, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.579 Vali Acc: 0.763 Test Loss: 0.579 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6829249858856201
Epoch: 19, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 1.3427016735076904
Epoch: 20, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4339373111724854
Epoch: 21, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.572 Vali Acc: 0.776 Test Loss: 0.572 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 22 cost time: 1.147862195968628
Epoch: 22, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3129241466522217
Epoch: 23, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 24 cost time: 1.5251386165618896
Epoch: 24, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.407616376876831
Epoch: 25, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4684464931488037
Epoch: 26, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6530866622924805
Epoch: 27, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3460607528686523
Epoch: 28, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 1.2736659049987793
Epoch: 29, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2425813674926758
Epoch: 30, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.295621633529663
Epoch: 31, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.262535810470581
Epoch: 32, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 33 cost time: 1.3508765697479248
Epoch: 33, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.264021396636963
Epoch: 34, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3225972652435303
Epoch: 35, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7190454006195068
Epoch: 36, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.606 Vali Acc: 0.796 Test Loss: 0.606 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.460221767425537
Epoch: 37, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5566518306732178
Epoch: 38, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.610 Vali Acc: 0.796 Test Loss: 0.610 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4044618606567383
Epoch: 39, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1110975742340088
Epoch: 40, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.605 Vali Acc: 0.796 Test Loss: 0.605 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.225693941116333
Epoch: 41, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1599361896514893
Epoch: 42, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 16452
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.893836259841919
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.370 Vali Acc: 0.322 Test Loss: 1.370 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.516157627105713
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.300 Vali Acc: 0.414 Test Loss: 1.300 Test Acc: 0.414
Validation loss decreased (-0.322355 --> -0.414461).  Saving model ...
Epoch: 3 cost time: 1.5059082508087158
Epoch: 3, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.208 Vali Acc: 0.513 Test Loss: 1.208 Test Acc: 0.513
Validation loss decreased (-0.414461 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 1.6383335590362549
Epoch: 4, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.109 Vali Acc: 0.599 Test Loss: 1.109 Test Acc: 0.599
Validation loss decreased (-0.513146 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 1.786827564239502
Epoch: 5, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.021 Vali Acc: 0.632 Test Loss: 1.021 Test Acc: 0.632
Validation loss decreased (-0.598673 --> -0.631569).  Saving model ...
Epoch: 6 cost time: 1.9729652404785156
Epoch: 6, Steps: 10 | Train Loss: 0.866 Vali Loss: 0.932 Vali Acc: 0.671 Test Loss: 0.932 Test Acc: 0.671
Validation loss decreased (-0.631569 --> -0.671043).  Saving model ...
Epoch: 7 cost time: 1.146714687347412
Epoch: 7, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.864 Vali Acc: 0.651 Test Loss: 0.864 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5173606872558594
Epoch: 8, Steps: 10 | Train Loss: 0.639 Vali Loss: 0.801 Vali Acc: 0.684 Test Loss: 0.801 Test Acc: 0.684
Validation loss decreased (-0.671043 --> -0.684203).  Saving model ...
Epoch: 9 cost time: 1.5006091594696045
Epoch: 9, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.743 Vali Acc: 0.711 Test Loss: 0.743 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.4158005714416504
Epoch: 10, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.703 Vali Acc: 0.724 Test Loss: 0.703 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 1.4909749031066895
Epoch: 11, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.671 Vali Acc: 0.750 Test Loss: 0.671 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.3371520042419434
Epoch: 12, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.649 Vali Acc: 0.750 Test Loss: 0.649 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.832106590270996
Epoch: 13, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.583498477935791
Epoch: 14, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.610 Vali Acc: 0.743 Test Loss: 0.610 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4435739517211914
Epoch: 15, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.6757316589355469
Epoch: 16, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6369802951812744
Epoch: 17, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.3086531162261963
Epoch: 18, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 1.6086270809173584
Epoch: 19, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.451402187347412
Epoch: 20, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 21 cost time: 1.4890649318695068
Epoch: 21, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 22 cost time: 1.2885074615478516
Epoch: 22, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 1.649989366531372
Epoch: 23, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 24 cost time: 1.500284194946289
Epoch: 24, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 25 cost time: 1.6271514892578125
Epoch: 25, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8155786991119385
Epoch: 26, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3029882907867432
Epoch: 27, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 28 cost time: 1.2572894096374512
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 29 cost time: 1.5645897388458252
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5105657577514648
Epoch: 30, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 31 cost time: 0.9577851295471191
Epoch: 31, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.008117914199829
Epoch: 32, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8500921726226807
Epoch: 33, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.55757474899292
Epoch: 34, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.572622537612915
Epoch: 35, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.562 Vali Acc: 0.809 Test Loss: 0.562 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7592194080352783
Epoch: 36, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6859185695648193
Epoch: 37, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4170074462890625
Epoch: 38, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.576 Vali Acc: 0.803 Test Loss: 0.576 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8996713161468506
Epoch: 39, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.4971439838409424
Epoch: 40, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 16484
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.517477035522461
Epoch: 1, Steps: 10 | Train Loss: 1.651 Vali Loss: 1.412 Vali Acc: 0.224 Test Loss: 1.412 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.4120826721191406
Epoch: 2, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.349 Vali Acc: 0.296 Test Loss: 1.349 Test Acc: 0.296
Validation loss decreased (-0.223670 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.2901296615600586
Epoch: 3, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.268 Vali Acc: 0.342 Test Loss: 1.268 Test Acc: 0.342
Validation loss decreased (-0.296039 --> -0.342093).  Saving model ...
Epoch: 4 cost time: 1.2521636486053467
Epoch: 4, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.184 Vali Acc: 0.441 Test Loss: 1.184 Test Acc: 0.441
Validation loss decreased (-0.342093 --> -0.440778).  Saving model ...
Epoch: 5 cost time: 1.3338358402252197
Epoch: 5, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.099 Vali Acc: 0.487 Test Loss: 1.099 Test Acc: 0.487
Validation loss decreased (-0.440778 --> -0.486831).  Saving model ...
Epoch: 6 cost time: 1.3811719417572021
Epoch: 6, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.022 Vali Acc: 0.566 Test Loss: 1.022 Test Acc: 0.566
Validation loss decreased (-0.486831 --> -0.565779).  Saving model ...
Epoch: 7 cost time: 1.3695573806762695
Epoch: 7, Steps: 10 | Train Loss: 0.929 Vali Loss: 0.951 Vali Acc: 0.612 Test Loss: 0.951 Test Acc: 0.612
Validation loss decreased (-0.565779 --> -0.611833).  Saving model ...
Epoch: 8 cost time: 1.4308125972747803
Epoch: 8, Steps: 10 | Train Loss: 0.777 Vali Loss: 0.886 Vali Acc: 0.651 Test Loss: 0.886 Test Acc: 0.651
Validation loss decreased (-0.611833 --> -0.651307).  Saving model ...
Epoch: 9 cost time: 1.7612614631652832
Epoch: 9, Steps: 10 | Train Loss: 0.697 Vali Loss: 0.832 Vali Acc: 0.671 Test Loss: 0.832 Test Acc: 0.671
Validation loss decreased (-0.651307 --> -0.671044).  Saving model ...
Epoch: 10 cost time: 1.7686147689819336
Epoch: 10, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.782 Vali Acc: 0.704 Test Loss: 0.782 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703940).  Saving model ...
Epoch: 11 cost time: 1.0909764766693115
Epoch: 11, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.738 Vali Acc: 0.724 Test Loss: 0.738 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 12 cost time: 1.4781339168548584
Epoch: 12, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.708 Vali Acc: 0.730 Test Loss: 0.708 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 13 cost time: 1.640378713607788
Epoch: 13, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.678 Vali Acc: 0.743 Test Loss: 0.678 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 14 cost time: 1.289283037185669
Epoch: 14, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.651 Vali Acc: 0.743 Test Loss: 0.651 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 1.1971869468688965
Epoch: 15, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.627 Vali Acc: 0.750 Test Loss: 0.627 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 0.9744658470153809
Epoch: 16, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 1.2344474792480469
Epoch: 17, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4590418338775635
Epoch: 18, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.587 Vali Acc: 0.743 Test Loss: 0.587 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0808959007263184
Epoch: 19, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.578 Vali Acc: 0.770 Test Loss: 0.578 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 20 cost time: 1.3347771167755127
Epoch: 20, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.570 Vali Acc: 0.763 Test Loss: 0.570 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7482881546020508
Epoch: 21, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 22 cost time: 1.6721301078796387
Epoch: 22, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2117712497711182
Epoch: 23, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.571 Vali Acc: 0.743 Test Loss: 0.571 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2115364074707031
Epoch: 24, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.568 Vali Acc: 0.750 Test Loss: 0.568 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3828365802764893
Epoch: 25, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3061835765838623
Epoch: 26, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3509571552276611
Epoch: 27, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.575 Vali Acc: 0.750 Test Loss: 0.575 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3441157341003418
Epoch: 28, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 29 cost time: 1.2329308986663818
Epoch: 29, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 1.4674320220947266
Epoch: 30, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 31 cost time: 1.2054617404937744
Epoch: 31, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 32 cost time: 0.9469223022460938
Epoch: 32, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1620490550994873
Epoch: 33, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 34 cost time: 1.1195237636566162
Epoch: 34, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1538920402526855
Epoch: 35, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 36 cost time: 1.2940635681152344
Epoch: 36, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3037476539611816
Epoch: 37, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5416088104248047
Epoch: 38, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4136228561401367
Epoch: 39, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.602 Vali Acc: 0.796 Test Loss: 0.602 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.266829013824463
Epoch: 40, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.608 Vali Acc: 0.803 Test Loss: 0.608 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.5951611995697021
Epoch: 41, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.189359426498413
Epoch: 42, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.411588191986084
Epoch: 43, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.620 Vali Acc: 0.796 Test Loss: 0.620 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.6934595108032227
Epoch: 44, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.625 Vali Acc: 0.803 Test Loss: 0.625 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.587477445602417
Epoch: 45, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 14244
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.001772403717041
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.384 Vali Acc: 0.276 Test Loss: 1.384 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.6856560707092285
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.300 Vali Acc: 0.414 Test Loss: 1.300 Test Acc: 0.414
Validation loss decreased (-0.276302 --> -0.414461).  Saving model ...
Epoch: 3 cost time: 1.5172979831695557
Epoch: 3, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.190 Vali Acc: 0.520 Test Loss: 1.190 Test Acc: 0.520
Validation loss decreased (-0.414461 --> -0.519725).  Saving model ...
Epoch: 4 cost time: 1.431966781616211
Epoch: 4, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.057 Vali Acc: 0.605 Test Loss: 1.057 Test Acc: 0.605
Validation loss decreased (-0.519725 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 1.320875644683838
Epoch: 5, Steps: 10 | Train Loss: 0.901 Vali Loss: 0.944 Vali Acc: 0.678 Test Loss: 0.944 Test Acc: 0.678
Validation loss decreased (-0.605253 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 1.3343250751495361
Epoch: 6, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.854 Vali Acc: 0.697 Test Loss: 0.854 Test Acc: 0.697
Validation loss decreased (-0.677622 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 1.931082010269165
Epoch: 7, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.767 Vali Acc: 0.704 Test Loss: 0.767 Test Acc: 0.704
Validation loss decreased (-0.697360 --> -0.703940).  Saving model ...
Epoch: 8 cost time: 1.1479003429412842
Epoch: 8, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.701 Vali Acc: 0.724 Test Loss: 0.701 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 9 cost time: 1.2188670635223389
Epoch: 9, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.661 Vali Acc: 0.757 Test Loss: 0.661 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756572).  Saving model ...
Epoch: 10 cost time: 0.9117729663848877
Epoch: 10, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.610 Vali Acc: 0.776 Test Loss: 0.610 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.1008028984069824
Epoch: 11, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.1557109355926514
Epoch: 12, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.1644113063812256
Epoch: 13, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.6946237087249756
Epoch: 14, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.1084420680999756
Epoch: 15, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6562094688415527
Epoch: 16, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.3410210609436035
Epoch: 17, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 18 cost time: 1.9933481216430664
Epoch: 18, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 19 cost time: 1.3930039405822754
Epoch: 19, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5355181694030762
Epoch: 20, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5129644870758057
Epoch: 21, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 22 cost time: 1.3273944854736328
Epoch: 22, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5569288730621338
Epoch: 23, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.539 Vali Acc: 0.816 Test Loss: 0.539 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.346433401107788
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3867366313934326
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.203441858291626
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5517702102661133
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0937645435333252
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6286158561706543
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4894554615020752
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4757156372070312
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 21204
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.142942905426025
Epoch: 1, Steps: 10 | Train Loss: 1.560 Vali Loss: 1.436 Vali Acc: 0.316 Test Loss: 1.436 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 1.4333264827728271
Epoch: 2, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.373 Vali Acc: 0.342 Test Loss: 1.373 Test Acc: 0.342
Validation loss decreased (-0.315775 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.6694092750549316
Epoch: 3, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.294 Vali Acc: 0.395 Test Loss: 1.294 Test Acc: 0.395
Validation loss decreased (-0.342092 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 1.5613739490509033
Epoch: 4, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.207 Vali Acc: 0.454 Test Loss: 1.207 Test Acc: 0.454
Validation loss decreased (-0.394724 --> -0.453935).  Saving model ...
Epoch: 5 cost time: 1.212437391281128
Epoch: 5, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.118 Vali Acc: 0.559 Test Loss: 1.118 Test Acc: 0.559
Validation loss decreased (-0.453935 --> -0.559199).  Saving model ...
Epoch: 6 cost time: 1.3752617835998535
Epoch: 6, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.036 Vali Acc: 0.625 Test Loss: 1.036 Test Acc: 0.625
Validation loss decreased (-0.559199 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 1.7316765785217285
Epoch: 7, Steps: 10 | Train Loss: 0.955 Vali Loss: 0.953 Vali Acc: 0.645 Test Loss: 0.953 Test Acc: 0.645
Validation loss decreased (-0.624990 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 1.2804999351501465
Epoch: 8, Steps: 10 | Train Loss: 0.834 Vali Loss: 0.878 Vali Acc: 0.671 Test Loss: 0.878 Test Acc: 0.671
Validation loss decreased (-0.644727 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 1.473874807357788
Epoch: 9, Steps: 10 | Train Loss: 0.766 Vali Loss: 0.814 Vali Acc: 0.704 Test Loss: 0.814 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 1.466569185256958
Epoch: 10, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.756 Vali Acc: 0.737 Test Loss: 0.756 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 1.3705637454986572
Epoch: 11, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.712 Vali Acc: 0.711 Test Loss: 0.712 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5111117362976074
Epoch: 12, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.670 Vali Acc: 0.730 Test Loss: 0.670 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4087409973144531
Epoch: 13, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.631 Vali Acc: 0.763 Test Loss: 0.631 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 1.6242287158966064
Epoch: 14, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.6229584217071533
Epoch: 15, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.0379180908203125
Epoch: 16, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.6178028583526611
Epoch: 17, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.50913405418396
Epoch: 18, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.2352063655853271
Epoch: 19, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 1.5377421379089355
Epoch: 20, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 2.0877318382263184
Epoch: 21, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 22 cost time: 1.3770029544830322
Epoch: 22, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 23 cost time: 1.550196647644043
Epoch: 23, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 24 cost time: 1.5341176986694336
Epoch: 24, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 25 cost time: 1.29081130027771
Epoch: 25, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 26 cost time: 1.130199909210205
Epoch: 26, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2089362144470215
Epoch: 27, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2349796295166016
Epoch: 28, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4009451866149902
Epoch: 29, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3925282955169678
Epoch: 30, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5956065654754639
Epoch: 31, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2436866760253906
Epoch: 32, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.513 Vali Acc: 0.822 Test Loss: 0.513 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822363).  Saving model ...
Epoch: 33 cost time: 1.6195955276489258
Epoch: 33, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3209967613220215
Epoch: 34, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5554111003875732
Epoch: 35, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5703213214874268
Epoch: 36, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4667420387268066
Epoch: 37, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.73063325881958
Epoch: 38, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.703430414199829
Epoch: 39, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6800594329833984
Epoch: 40, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1247315406799316
Epoch: 41, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.3688924312591553
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 15460
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.283841848373413
Epoch: 1, Steps: 10 | Train Loss: 1.544 Vali Loss: 1.492 Vali Acc: 0.230 Test Loss: 1.492 Test Acc: 0.230
Validation loss decreased (inf --> -0.230248).  Saving model ...
Epoch: 2 cost time: 1.531977653503418
Epoch: 2, Steps: 10 | Train Loss: 1.510 Vali Loss: 1.438 Vali Acc: 0.316 Test Loss: 1.438 Test Acc: 0.316
Validation loss decreased (-0.230248 --> -0.315775).  Saving model ...
Epoch: 3 cost time: 1.4687423706054688
Epoch: 3, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.368 Vali Acc: 0.362 Test Loss: 1.368 Test Acc: 0.362
Validation loss decreased (-0.315775 --> -0.361828).  Saving model ...
Epoch: 4 cost time: 1.6852853298187256
Epoch: 4, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.291 Vali Acc: 0.382 Test Loss: 1.291 Test Acc: 0.382
Validation loss decreased (-0.361828 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 1.261908769607544
Epoch: 5, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.215 Vali Acc: 0.461 Test Loss: 1.215 Test Acc: 0.461
Validation loss decreased (-0.381566 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 1.979811429977417
Epoch: 6, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.141 Vali Acc: 0.533 Test Loss: 1.141 Test Acc: 0.533
Validation loss decreased (-0.460514 --> -0.532883).  Saving model ...
Epoch: 7 cost time: 1.7472553253173828
Epoch: 7, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.067 Vali Acc: 0.572 Test Loss: 1.067 Test Acc: 0.572
Validation loss decreased (-0.532883 --> -0.572358).  Saving model ...
Epoch: 8 cost time: 2.2194230556488037
Epoch: 8, Steps: 10 | Train Loss: 0.954 Vali Loss: 0.996 Vali Acc: 0.632 Test Loss: 0.996 Test Acc: 0.632
Validation loss decreased (-0.572358 --> -0.631569).  Saving model ...
Epoch: 9 cost time: 1.331648826599121
Epoch: 9, Steps: 10 | Train Loss: 0.851 Vali Loss: 0.926 Vali Acc: 0.625 Test Loss: 0.926 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7770297527313232
Epoch: 10, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.871 Vali Acc: 0.651 Test Loss: 0.871 Test Acc: 0.651
Validation loss decreased (-0.631569 --> -0.651307).  Saving model ...
Epoch: 11 cost time: 1.5899693965911865
Epoch: 11, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.815 Vali Acc: 0.678 Test Loss: 0.815 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 12 cost time: 1.3661892414093018
Epoch: 12, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.763 Vali Acc: 0.691 Test Loss: 0.763 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690782).  Saving model ...
Epoch: 13 cost time: 1.9476263523101807
Epoch: 13, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.720 Vali Acc: 0.724 Test Loss: 0.720 Test Acc: 0.724
Validation loss decreased (-0.690782 --> -0.723677).  Saving model ...
Epoch: 14 cost time: 1.6828885078430176
Epoch: 14, Steps: 10 | Train Loss: 0.499 Vali Loss: 0.684 Vali Acc: 0.737 Test Loss: 0.684 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 15 cost time: 1.3319957256317139
Epoch: 15, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.653 Vali Acc: 0.757 Test Loss: 0.653 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 16 cost time: 1.5874807834625244
Epoch: 16, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.628 Vali Acc: 0.757 Test Loss: 0.628 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 1.6471924781799316
Epoch: 17, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.473682165145874
Epoch: 18, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.580 Vali Acc: 0.763 Test Loss: 0.580 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 1.5713112354278564
Epoch: 19, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 2.2673568725585938
Epoch: 20, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4688990116119385
Epoch: 21, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.538 Vali Acc: 0.763 Test Loss: 0.538 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7552878856658936
Epoch: 22, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 1.7193498611450195
Epoch: 23, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 24 cost time: 1.3588097095489502
Epoch: 24, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 25 cost time: 1.4822263717651367
Epoch: 25, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 26 cost time: 1.524275541305542
Epoch: 26, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809205).  Saving model ...
Epoch: 27 cost time: 1.478452205657959
Epoch: 27, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.724151372909546
Epoch: 28, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5610442161560059
Epoch: 29, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 30 cost time: 1.8217484951019287
Epoch: 30, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7808160781860352
Epoch: 31, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 32 cost time: 1.535754680633545
Epoch: 32, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.618161916732788
Epoch: 33, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.681518316268921
Epoch: 34, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.587334156036377
Epoch: 35, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.728438377380371
Epoch: 36, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 37 cost time: 1.3912839889526367
Epoch: 37, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5224125385284424
Epoch: 38, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5616521835327148
Epoch: 39, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8770272731781006
Epoch: 40, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 41 cost time: 1.9791288375854492
Epoch: 41, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7778515815734863
Epoch: 42, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.8386297225952148
Epoch: 43, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.304717779159546
Epoch: 44, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4854893684387207
Epoch: 45, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.352668046951294
Epoch: 46, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.6181163787841797
Epoch: 47, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.7611336708068848
Epoch: 48, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.5133488178253174
Epoch: 49, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4493215084075928
Epoch: 50, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 13572
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.6480326652526855
Epoch: 1, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.354 Vali Acc: 0.421 Test Loss: 1.354 Test Acc: 0.421
Validation loss decreased (inf --> -0.421039).  Saving model ...
Epoch: 2 cost time: 1.3423070907592773
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.310 Vali Acc: 0.434 Test Loss: 1.310 Test Acc: 0.434
Validation loss decreased (-0.421039 --> -0.434197).  Saving model ...
Epoch: 3 cost time: 1.244809627532959
Epoch: 3, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.262 Vali Acc: 0.467 Test Loss: 1.262 Test Acc: 0.467
Validation loss decreased (-0.434197 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 1.5023407936096191
Epoch: 4, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.208 Vali Acc: 0.474 Test Loss: 1.208 Test Acc: 0.474
Validation loss decreased (-0.467093 --> -0.473672).  Saving model ...
Epoch: 5 cost time: 1.306596279144287
Epoch: 5, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.154 Vali Acc: 0.520 Test Loss: 1.154 Test Acc: 0.520
Validation loss decreased (-0.473672 --> -0.519725).  Saving model ...
Epoch: 6 cost time: 1.3000364303588867
Epoch: 6, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.092 Vali Acc: 0.579 Test Loss: 1.092 Test Acc: 0.579
Validation loss decreased (-0.519725 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 1.587303876876831
Epoch: 7, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.030 Vali Acc: 0.586 Test Loss: 1.030 Test Acc: 0.586
Validation loss decreased (-0.578936 --> -0.585516).  Saving model ...
Epoch: 8 cost time: 1.5965173244476318
Epoch: 8, Steps: 10 | Train Loss: 0.872 Vali Loss: 0.972 Vali Acc: 0.625 Test Loss: 0.972 Test Acc: 0.625
Validation loss decreased (-0.585516 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 1.445518970489502
Epoch: 9, Steps: 10 | Train Loss: 0.798 Vali Loss: 0.912 Vali Acc: 0.651 Test Loss: 0.912 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651307).  Saving model ...
Epoch: 10 cost time: 1.4907174110412598
Epoch: 10, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.857 Vali Acc: 0.671 Test Loss: 0.857 Test Acc: 0.671
Validation loss decreased (-0.651307 --> -0.671044).  Saving model ...
Epoch: 11 cost time: 1.5920875072479248
Epoch: 11, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.807 Vali Acc: 0.678 Test Loss: 0.807 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677624).  Saving model ...
Epoch: 12 cost time: 1.7807068824768066
Epoch: 12, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.762 Vali Acc: 0.691 Test Loss: 0.762 Test Acc: 0.691
Validation loss decreased (-0.677624 --> -0.690782).  Saving model ...
Epoch: 13 cost time: 1.6125154495239258
Epoch: 13, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.724 Vali Acc: 0.711 Test Loss: 0.724 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 14 cost time: 1.4585497379302979
Epoch: 14, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.695 Vali Acc: 0.730 Test Loss: 0.695 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 1.7412488460540771
Epoch: 15, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.664 Vali Acc: 0.743 Test Loss: 0.664 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 16 cost time: 1.641449213027954
Epoch: 16, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.637 Vali Acc: 0.743 Test Loss: 0.637 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 17 cost time: 1.5618219375610352
Epoch: 17, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.623 Vali Acc: 0.757 Test Loss: 0.623 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 18 cost time: 1.6095645427703857
Epoch: 18, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.608 Vali Acc: 0.763 Test Loss: 0.608 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 1.9169766902923584
Epoch: 19, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 1.626779317855835
Epoch: 20, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 21 cost time: 1.676522970199585
Epoch: 21, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 22 cost time: 1.771782398223877
Epoch: 22, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 1.4028148651123047
Epoch: 23, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 24 cost time: 2.1112701892852783
Epoch: 24, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 25 cost time: 1.5222578048706055
Epoch: 25, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 26 cost time: 1.5326330661773682
Epoch: 26, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 27 cost time: 1.6599650382995605
Epoch: 27, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 1.8314549922943115
Epoch: 28, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.476217269897461
Epoch: 29, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3989133834838867
Epoch: 30, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4912817478179932
Epoch: 31, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.841679334640503
Epoch: 32, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.8842179775238037
Epoch: 33, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.779012680053711
Epoch: 34, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.7642309665679932
Epoch: 35, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3856539726257324
Epoch: 36, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.3296780586242676
Epoch: 37, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 13588
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.020718812942505
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.495 Vali Acc: 0.224 Test Loss: 1.495 Test Acc: 0.224
Validation loss decreased (inf --> -0.223669).  Saving model ...
Epoch: 2 cost time: 1.3778290748596191
Epoch: 2, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.472 Vali Acc: 0.257 Test Loss: 1.472 Test Acc: 0.257
Validation loss decreased (-0.223669 --> -0.256564).  Saving model ...
Epoch: 3 cost time: 0.9924771785736084
Epoch: 3, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.437 Vali Acc: 0.243 Test Loss: 1.437 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5159721374511719
Epoch: 4, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.391 Vali Acc: 0.276 Test Loss: 1.391 Test Acc: 0.276
Validation loss decreased (-0.256564 --> -0.276302).  Saving model ...
Epoch: 5 cost time: 1.0590157508850098
Epoch: 5, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.340 Vali Acc: 0.322 Test Loss: 1.340 Test Acc: 0.322
Validation loss decreased (-0.276302 --> -0.322355).  Saving model ...
Epoch: 6 cost time: 1.547990083694458
Epoch: 6, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.287 Vali Acc: 0.401 Test Loss: 1.287 Test Acc: 0.401
Validation loss decreased (-0.322355 --> -0.401303).  Saving model ...
Epoch: 7 cost time: 1.4372906684875488
Epoch: 7, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.234 Vali Acc: 0.441 Test Loss: 1.234 Test Acc: 0.441
Validation loss decreased (-0.401303 --> -0.440777).  Saving model ...
Epoch: 8 cost time: 1.4310595989227295
Epoch: 8, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.185 Vali Acc: 0.487 Test Loss: 1.185 Test Acc: 0.487
Validation loss decreased (-0.440777 --> -0.486830).  Saving model ...
Epoch: 9 cost time: 1.6333649158477783
Epoch: 9, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.135 Vali Acc: 0.533 Test Loss: 1.135 Test Acc: 0.533
Validation loss decreased (-0.486830 --> -0.532883).  Saving model ...
Epoch: 10 cost time: 1.974682092666626
Epoch: 10, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.085 Vali Acc: 0.566 Test Loss: 1.085 Test Acc: 0.566
Validation loss decreased (-0.532883 --> -0.565779).  Saving model ...
Epoch: 11 cost time: 1.668776035308838
Epoch: 11, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.040 Vali Acc: 0.599 Test Loss: 1.040 Test Acc: 0.599
Validation loss decreased (-0.565779 --> -0.598674).  Saving model ...
Epoch: 12 cost time: 1.7314274311065674
Epoch: 12, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.995 Vali Acc: 0.625 Test Loss: 0.995 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 1.3887660503387451
Epoch: 13, Steps: 10 | Train Loss: 0.724 Vali Loss: 0.955 Vali Acc: 0.638 Test Loss: 0.955 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638148).  Saving model ...
Epoch: 14 cost time: 1.6380860805511475
Epoch: 14, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.916 Vali Acc: 0.671 Test Loss: 0.916 Test Acc: 0.671
Validation loss decreased (-0.638148 --> -0.671043).  Saving model ...
Epoch: 15 cost time: 1.397803544998169
Epoch: 15, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.878 Vali Acc: 0.684 Test Loss: 0.878 Test Acc: 0.684
Validation loss decreased (-0.671043 --> -0.684202).  Saving model ...
Epoch: 16 cost time: 1.2750823497772217
Epoch: 16, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.849 Vali Acc: 0.684 Test Loss: 0.849 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684202).  Saving model ...
Epoch: 17 cost time: 1.7137596607208252
Epoch: 17, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.819 Vali Acc: 0.684 Test Loss: 0.819 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684202).  Saving model ...
Epoch: 18 cost time: 1.6239397525787354
Epoch: 18, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.791 Vali Acc: 0.697 Test Loss: 0.791 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697361).  Saving model ...
Epoch: 19 cost time: 1.4847548007965088
Epoch: 19, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.768 Vali Acc: 0.704 Test Loss: 0.768 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 20 cost time: 2.0102126598358154
Epoch: 20, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.748 Vali Acc: 0.704 Test Loss: 0.748 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 21 cost time: 1.684887170791626
Epoch: 21, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.732 Vali Acc: 0.711 Test Loss: 0.732 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 22 cost time: 1.3235199451446533
Epoch: 22, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 23 cost time: 1.76176118850708
Epoch: 23, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.704 Vali Acc: 0.730 Test Loss: 0.704 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 24 cost time: 1.2952384948730469
Epoch: 24, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.690 Vali Acc: 0.743 Test Loss: 0.690 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 25 cost time: 1.3697025775909424
Epoch: 25, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.682 Vali Acc: 0.737 Test Loss: 0.682 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5622596740722656
Epoch: 26, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.672 Vali Acc: 0.743 Test Loss: 0.672 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 27 cost time: 1.6634740829467773
Epoch: 27, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.665 Vali Acc: 0.743 Test Loss: 0.665 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 28 cost time: 1.4654934406280518
Epoch: 28, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.655 Vali Acc: 0.743 Test Loss: 0.655 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 29 cost time: 1.739771842956543
Epoch: 29, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.652 Vali Acc: 0.750 Test Loss: 0.652 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 30 cost time: 1.5422766208648682
Epoch: 30, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.642 Vali Acc: 0.750 Test Loss: 0.642 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 31 cost time: 2.316758632659912
Epoch: 31, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.632 Vali Acc: 0.750 Test Loss: 0.632 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 32 cost time: 1.5750977993011475
Epoch: 32, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.622 Vali Acc: 0.763 Test Loss: 0.622 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 33 cost time: 1.0016250610351562
Epoch: 33, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.620 Vali Acc: 0.763 Test Loss: 0.620 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 34 cost time: 1.536590814590454
Epoch: 34, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.619 Vali Acc: 0.763 Test Loss: 0.619 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 35 cost time: 1.4130446910858154
Epoch: 35, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.615 Vali Acc: 0.763 Test Loss: 0.615 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 36 cost time: 1.1970109939575195
Epoch: 36, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.605 Vali Acc: 0.763 Test Loss: 0.605 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 37 cost time: 1.3798754215240479
Epoch: 37, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 38 cost time: 1.3463146686553955
Epoch: 38, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3845276832580566
Epoch: 39, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2886152267456055
Epoch: 40, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.604 Vali Acc: 0.770 Test Loss: 0.604 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 41 cost time: 1.741511344909668
Epoch: 41, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.601 Vali Acc: 0.776 Test Loss: 0.601 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 42 cost time: 1.3324224948883057
Epoch: 42, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.601 Vali Acc: 0.776 Test Loss: 0.601 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1911015510559082
Epoch: 43, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.602 Vali Acc: 0.776 Test Loss: 0.602 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2698447704315186
Epoch: 44, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.601 Vali Acc: 0.770 Test Loss: 0.601 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3222370147705078
Epoch: 45, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.600 Vali Acc: 0.776 Test Loss: 0.600 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 46 cost time: 1.55214524269104
Epoch: 46, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 47 cost time: 1.1478610038757324
Epoch: 47, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2194724082946777
Epoch: 48, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.7147374153137207
Epoch: 49, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.518315315246582
Epoch: 50, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.5842700004577637
Epoch: 51, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.9749844074249268
Epoch: 52, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.613 Vali Acc: 0.776 Test Loss: 0.613 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.690417766571045
Epoch: 53, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.619 Vali Acc: 0.776 Test Loss: 0.619 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.5234544277191162
Epoch: 54, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.631 Vali Acc: 0.776 Test Loss: 0.631 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.5390212535858154
Epoch: 55, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.627 Vali Acc: 0.776 Test Loss: 0.627 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.8767921924591064
Epoch: 56, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.622 Vali Acc: 0.770 Test Loss: 0.622 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 12468
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.385776519775391
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.439 Vali Acc: 0.263 Test Loss: 1.439 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.818415641784668
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.312 Vali Acc: 0.336 Test Loss: 1.312 Test Acc: 0.336
Validation loss decreased (-0.263144 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.670508623123169
Epoch: 3, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.216 Vali Acc: 0.428 Test Loss: 1.216 Test Acc: 0.428
Validation loss decreased (-0.335513 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 1.56624174118042
Epoch: 4, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.098 Vali Acc: 0.579 Test Loss: 1.098 Test Acc: 0.579
Validation loss decreased (-0.427619 --> -0.578936).  Saving model ...
Epoch: 5 cost time: 1.2869255542755127
Epoch: 5, Steps: 10 | Train Loss: 0.965 Vali Loss: 0.975 Vali Acc: 0.632 Test Loss: 0.975 Test Acc: 0.632
Validation loss decreased (-0.578936 --> -0.631569).  Saving model ...
Epoch: 6 cost time: 1.3126449584960938
Epoch: 6, Steps: 10 | Train Loss: 0.802 Vali Loss: 0.881 Vali Acc: 0.664 Test Loss: 0.881 Test Acc: 0.664
Validation loss decreased (-0.631569 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 1.3851826190948486
Epoch: 7, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.813 Vali Acc: 0.684 Test Loss: 0.813 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684202).  Saving model ...
Epoch: 8 cost time: 1.7426872253417969
Epoch: 8, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.730 Vali Acc: 0.704 Test Loss: 0.730 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703940).  Saving model ...
Epoch: 9 cost time: 1.728423833847046
Epoch: 9, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.682 Vali Acc: 0.724 Test Loss: 0.682 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 1.2681517601013184
Epoch: 10, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.638 Vali Acc: 0.743 Test Loss: 0.638 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 11 cost time: 1.3298840522766113
Epoch: 11, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.593111515045166
Epoch: 12, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.569 Vali Acc: 0.770 Test Loss: 0.569 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.5512828826904297
Epoch: 13, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.520437479019165
Epoch: 14, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.4791224002838135
Epoch: 15, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 16 cost time: 1.4908173084259033
Epoch: 16, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 17 cost time: 1.2922625541687012
Epoch: 17, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.9456543922424316
Epoch: 18, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 19 cost time: 1.4544446468353271
Epoch: 19, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4805481433868408
Epoch: 20, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3983426094055176
Epoch: 21, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5617878437042236
Epoch: 22, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.555833101272583
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7151901721954346
Epoch: 24, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3108665943145752
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4560353755950928
Epoch: 26, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6829605102539062
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5265254974365234
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.561 Vali Acc: 0.816 Test Loss: 0.561 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 29 cost time: 1.2559053897857666
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.559 Vali Acc: 0.803 Test Loss: 0.559 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.168635606765747
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7090322971343994
Epoch: 31, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4644207954406738
Epoch: 32, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3359687328338623
Epoch: 33, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5699563026428223
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.596 Vali Acc: 0.816 Test Loss: 0.596 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.6459546089172363
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 36 cost time: 1.373408317565918
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.603 Vali Acc: 0.816 Test Loss: 0.603 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4576590061187744
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6379060745239258
Epoch: 38, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.360952138900757
Epoch: 39, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.5256261825561523
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.617 Vali Acc: 0.809 Test Loss: 0.617 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.4538509845733643
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.4431023597717285
Epoch: 42, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3516974449157715
Epoch: 43, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.323218822479248
Epoch: 44, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.636 Vali Acc: 0.822 Test Loss: 0.636 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.6499829292297363
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 16980
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.336400270462036
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.449 Vali Acc: 0.303 Test Loss: 1.449 Test Acc: 0.303
Validation loss decreased (inf --> -0.302617).  Saving model ...
Epoch: 2 cost time: 1.548741340637207
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.371 Vali Acc: 0.368 Test Loss: 1.371 Test Acc: 0.368
Validation loss decreased (-0.302617 --> -0.368407).  Saving model ...
Epoch: 3 cost time: 1.5087192058563232
Epoch: 3, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.289 Vali Acc: 0.441 Test Loss: 1.289 Test Acc: 0.441
Validation loss decreased (-0.368407 --> -0.440777).  Saving model ...
Epoch: 4 cost time: 2.192533254623413
Epoch: 4, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
Validation loss decreased (-0.440777 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.1375007629394531
Epoch: 5, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.126 Vali Acc: 0.546 Test Loss: 1.126 Test Acc: 0.546
Validation loss decreased (-0.499988 --> -0.546041).  Saving model ...
Epoch: 6 cost time: 2.2889292240142822
Epoch: 6, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.054 Vali Acc: 0.599 Test Loss: 1.054 Test Acc: 0.599
Validation loss decreased (-0.546041 --> -0.598674).  Saving model ...
Epoch: 7 cost time: 1.6365294456481934
Epoch: 7, Steps: 10 | Train Loss: 0.910 Vali Loss: 0.981 Vali Acc: 0.625 Test Loss: 0.981 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 1.6222209930419922
Epoch: 8, Steps: 10 | Train Loss: 0.782 Vali Loss: 0.915 Vali Acc: 0.638 Test Loss: 0.915 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638149).  Saving model ...
Epoch: 9 cost time: 1.3979864120483398
Epoch: 9, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.851 Vali Acc: 0.671 Test Loss: 0.851 Test Acc: 0.671
Validation loss decreased (-0.638149 --> -0.671044).  Saving model ...
Epoch: 10 cost time: 1.542609691619873
Epoch: 10, Steps: 10 | Train Loss: 0.659 Vali Loss: 0.801 Vali Acc: 0.697 Test Loss: 0.801 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697360).  Saving model ...
Epoch: 11 cost time: 1.6133360862731934
Epoch: 11, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.742 Vali Acc: 0.711 Test Loss: 0.742 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710519).  Saving model ...
Epoch: 12 cost time: 1.5734903812408447
Epoch: 12, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.700 Vali Acc: 0.737 Test Loss: 0.700 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736835).  Saving model ...
Epoch: 13 cost time: 2.0397047996520996
Epoch: 13, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.659 Vali Acc: 0.743 Test Loss: 0.659 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 14 cost time: 1.734309434890747
Epoch: 14, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.9398725032806396
Epoch: 15, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 2.342944860458374
Epoch: 16, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.575 Vali Acc: 0.757 Test Loss: 0.575 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 1.694908857345581
Epoch: 17, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.554 Vali Acc: 0.763 Test Loss: 0.554 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.4412212371826172
Epoch: 18, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.538 Vali Acc: 0.763 Test Loss: 0.538 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 19 cost time: 1.4284961223602295
Epoch: 19, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.527 Vali Acc: 0.770 Test Loss: 0.527 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 20 cost time: 1.8639068603515625
Epoch: 20, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.516 Vali Acc: 0.770 Test Loss: 0.516 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 21 cost time: 1.3496944904327393
Epoch: 21, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 22 cost time: 1.4223628044128418
Epoch: 22, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 23 cost time: 1.5598530769348145
Epoch: 23, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 24 cost time: 1.8484878540039062
Epoch: 24, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.486 Vali Acc: 0.783 Test Loss: 0.486 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 25 cost time: 1.4862525463104248
Epoch: 25, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 26 cost time: 1.6839823722839355
Epoch: 26, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.483 Vali Acc: 0.783 Test Loss: 0.483 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.795072317123413
Epoch: 27, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.485 Vali Acc: 0.783 Test Loss: 0.485 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7324786186218262
Epoch: 28, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.488 Vali Acc: 0.776 Test Loss: 0.488 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.473294973373413
Epoch: 29, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.491 Vali Acc: 0.783 Test Loss: 0.491 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.566462516784668
Epoch: 30, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.492 Vali Acc: 0.789 Test Loss: 0.492 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.0718154907226562
Epoch: 31, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.489 Vali Acc: 0.783 Test Loss: 0.489 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7255492210388184
Epoch: 32, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.488 Vali Acc: 0.783 Test Loss: 0.488 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.652127742767334
Epoch: 33, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.487 Vali Acc: 0.789 Test Loss: 0.487 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8152580261230469
Epoch: 34, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.490 Vali Acc: 0.789 Test Loss: 0.490 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8936147689819336
Epoch: 35, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 11236
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.404405355453491
Epoch: 1, Steps: 10 | Train Loss: 1.528 Vali Loss: 1.466 Vali Acc: 0.289 Test Loss: 1.466 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 1.4285235404968262
Epoch: 2, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.413 Vali Acc: 0.303 Test Loss: 1.413 Test Acc: 0.303
Validation loss decreased (-0.289459 --> -0.302617).  Saving model ...
Epoch: 3 cost time: 1.4123802185058594
Epoch: 3, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.346 Vali Acc: 0.342 Test Loss: 1.346 Test Acc: 0.342
Validation loss decreased (-0.302617 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.558689832687378
Epoch: 4, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.270 Vali Acc: 0.401 Test Loss: 1.270 Test Acc: 0.401
Validation loss decreased (-0.342092 --> -0.401303).  Saving model ...
Epoch: 5 cost time: 1.5788168907165527
Epoch: 5, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.192 Vali Acc: 0.467 Test Loss: 1.192 Test Acc: 0.467
Validation loss decreased (-0.401303 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 1.9031281471252441
Epoch: 6, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.119 Vali Acc: 0.513 Test Loss: 1.119 Test Acc: 0.513
Validation loss decreased (-0.467093 --> -0.513147).  Saving model ...
Epoch: 7 cost time: 1.7183260917663574
Epoch: 7, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.042 Vali Acc: 0.566 Test Loss: 1.042 Test Acc: 0.566
Validation loss decreased (-0.513147 --> -0.565779).  Saving model ...
Epoch: 8 cost time: 1.7920417785644531
Epoch: 8, Steps: 10 | Train Loss: 0.957 Vali Loss: 0.977 Vali Acc: 0.612 Test Loss: 0.977 Test Acc: 0.612
Validation loss decreased (-0.565779 --> -0.611832).  Saving model ...
Epoch: 9 cost time: 1.4417033195495605
Epoch: 9, Steps: 10 | Train Loss: 0.852 Vali Loss: 0.909 Vali Acc: 0.651 Test Loss: 0.909 Test Acc: 0.651
Validation loss decreased (-0.611832 --> -0.651307).  Saving model ...
Epoch: 10 cost time: 1.538470983505249
Epoch: 10, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.850 Vali Acc: 0.678 Test Loss: 0.850 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 11 cost time: 1.5320062637329102
Epoch: 11, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.793 Vali Acc: 0.678 Test Loss: 0.793 Test Acc: 0.678
Validation loss decreased (-0.677623 --> -0.677624).  Saving model ...
Epoch: 12 cost time: 1.3602945804595947
Epoch: 12, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
Validation loss decreased (-0.677624 --> -0.717098).  Saving model ...
Epoch: 13 cost time: 1.7909510135650635
Epoch: 13, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.709 Vali Acc: 0.730 Test Loss: 0.709 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 14 cost time: 1.609546184539795
Epoch: 14, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.670 Vali Acc: 0.730 Test Loss: 0.670 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 1.488318920135498
Epoch: 15, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.639 Vali Acc: 0.724 Test Loss: 0.639 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5097956657409668
Epoch: 16, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.618 Vali Acc: 0.730 Test Loss: 0.618 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 17 cost time: 1.7429630756378174
Epoch: 17, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.596 Vali Acc: 0.737 Test Loss: 0.596 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 18 cost time: 1.4992022514343262
Epoch: 18, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 19 cost time: 1.511824131011963
Epoch: 19, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 20 cost time: 1.560878038406372
Epoch: 20, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.550 Vali Acc: 0.763 Test Loss: 0.550 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 21 cost time: 1.3515727519989014
Epoch: 21, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 1.4837286472320557
Epoch: 22, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
Validation loss decreased (-0.769731 --> -0.802626).  Saving model ...
Epoch: 23 cost time: 1.2723422050476074
Epoch: 23, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 24 cost time: 1.5617270469665527
Epoch: 24, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7993838787078857
Epoch: 25, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5525450706481934
Epoch: 26, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.589043378829956
Epoch: 27, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.264171838760376
Epoch: 28, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.020998477935791
Epoch: 29, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4499225616455078
Epoch: 30, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.247187852859497
Epoch: 31, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.611358642578125
Epoch: 32, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.943699836730957
Epoch: 33, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 9348
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.841062545776367
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.397 Vali Acc: 0.309 Test Loss: 1.397 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.5127811431884766
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.360 Vali Acc: 0.395 Test Loss: 1.360 Test Acc: 0.395
Validation loss decreased (-0.309197 --> -0.394723).  Saving model ...
Epoch: 3 cost time: 1.7005281448364258
Epoch: 3, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.304 Vali Acc: 0.474 Test Loss: 1.304 Test Acc: 0.474
Validation loss decreased (-0.394723 --> -0.473671).  Saving model ...
Epoch: 4 cost time: 1.5176100730895996
Epoch: 4, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.246 Vali Acc: 0.526 Test Loss: 1.246 Test Acc: 0.526
Validation loss decreased (-0.473671 --> -0.526303).  Saving model ...
Epoch: 5 cost time: 1.249696969985962
Epoch: 5, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.180 Vali Acc: 0.586 Test Loss: 1.180 Test Acc: 0.586
Validation loss decreased (-0.526303 --> -0.585515).  Saving model ...
Epoch: 6 cost time: 1.5684247016906738
Epoch: 6, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
Validation loss decreased (-0.585515 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 1.6990406513214111
Epoch: 7, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.057 Vali Acc: 0.645 Test Loss: 1.057 Test Acc: 0.645
Validation loss decreased (-0.624989 --> -0.644726).  Saving model ...
Epoch: 8 cost time: 1.5404188632965088
Epoch: 8, Steps: 10 | Train Loss: 0.928 Vali Loss: 0.993 Vali Acc: 0.645 Test Loss: 0.993 Test Acc: 0.645
Validation loss decreased (-0.644726 --> -0.644727).  Saving model ...
Epoch: 9 cost time: 1.383882761001587
Epoch: 9, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.932 Vali Acc: 0.645 Test Loss: 0.932 Test Acc: 0.645
Validation loss decreased (-0.644727 --> -0.644728).  Saving model ...
Epoch: 10 cost time: 2.074554920196533
Epoch: 10, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.875 Vali Acc: 0.678 Test Loss: 0.875 Test Acc: 0.678
Validation loss decreased (-0.644728 --> -0.677623).  Saving model ...
Epoch: 11 cost time: 1.5580177307128906
Epoch: 11, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.827 Vali Acc: 0.691 Test Loss: 0.827 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690781).  Saving model ...
Epoch: 12 cost time: 1.7366001605987549
Epoch: 12, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.783 Vali Acc: 0.711 Test Loss: 0.783 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710518).  Saving model ...
Epoch: 13 cost time: 1.6913654804229736
Epoch: 13, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.743 Vali Acc: 0.724 Test Loss: 0.743 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723677).  Saving model ...
Epoch: 14 cost time: 1.5500609874725342
Epoch: 14, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.713 Vali Acc: 0.737 Test Loss: 0.713 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 15 cost time: 1.8854749202728271
Epoch: 15, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.678 Vali Acc: 0.743 Test Loss: 0.678 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 16 cost time: 1.5050671100616455
Epoch: 16, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.647 Vali Acc: 0.743 Test Loss: 0.647 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 17 cost time: 1.8245975971221924
Epoch: 17, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 1.8139827251434326
Epoch: 18, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.604 Vali Acc: 0.757 Test Loss: 0.604 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 19 cost time: 1.7471718788146973
Epoch: 19, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.586 Vali Acc: 0.763 Test Loss: 0.586 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 20 cost time: 1.3788151741027832
Epoch: 20, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 21 cost time: 1.3318836688995361
Epoch: 21, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 22 cost time: 1.709141492843628
Epoch: 22, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 1.1341018676757812
Epoch: 23, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 1.3872320652008057
Epoch: 24, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 25 cost time: 1.3258256912231445
Epoch: 25, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.414574384689331
Epoch: 26, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8841962814331055
Epoch: 27, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.535 Vali Acc: 0.776 Test Loss: 0.535 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.1773614883422852
Epoch: 28, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 1.407963514328003
Epoch: 29, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.534 Vali Acc: 0.783 Test Loss: 0.534 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.769824504852295
Epoch: 30, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1719956398010254
Epoch: 31, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5181312561035156
Epoch: 32, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 33 cost time: 1.6168932914733887
Epoch: 33, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.364717960357666
Epoch: 34, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5016398429870605
Epoch: 35, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.391033411026001
Epoch: 36, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.535 Vali Acc: 0.776 Test Loss: 0.535 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6363375186920166
Epoch: 37, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.8950526714324951
Epoch: 38, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.545 Vali Acc: 0.776 Test Loss: 0.545 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.9487357139587402
Epoch: 39, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.420288324356079
Epoch: 40, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4022667407989502
Epoch: 41, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.3311736583709717
Epoch: 42, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 9364
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.267759084701538
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.400 Vali Acc: 0.263 Test Loss: 1.400 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.5046768188476562
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.381 Vali Acc: 0.296 Test Loss: 1.381 Test Acc: 0.296
Validation loss decreased (-0.263144 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.4124765396118164
Epoch: 3, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.339 Vali Acc: 0.316 Test Loss: 1.339 Test Acc: 0.316
Validation loss decreased (-0.296039 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 1.2835578918457031
Epoch: 4, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.285 Vali Acc: 0.395 Test Loss: 1.285 Test Acc: 0.395
Validation loss decreased (-0.315776 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 1.5991086959838867
Epoch: 5, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
Validation loss decreased (-0.394724 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 1.7083735466003418
Epoch: 6, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
Validation loss decreased (-0.467093 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.3116230964660645
Epoch: 7, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.126 Vali Acc: 0.539 Test Loss: 1.126 Test Acc: 0.539
Validation loss decreased (-0.499988 --> -0.539462).  Saving model ...
Epoch: 8 cost time: 1.769604206085205
Epoch: 8, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.078 Vali Acc: 0.566 Test Loss: 1.078 Test Acc: 0.566
Validation loss decreased (-0.539462 --> -0.565779).  Saving model ...
Epoch: 9 cost time: 1.6532127857208252
Epoch: 9, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.033 Vali Acc: 0.586 Test Loss: 1.033 Test Acc: 0.586
Validation loss decreased (-0.565779 --> -0.585516).  Saving model ...
Epoch: 10 cost time: 1.642601490020752
Epoch: 10, Steps: 10 | Train Loss: 0.866 Vali Loss: 0.990 Vali Acc: 0.645 Test Loss: 0.990 Test Acc: 0.645
Validation loss decreased (-0.585516 --> -0.644727).  Saving model ...
Epoch: 11 cost time: 2.0921316146850586
Epoch: 11, Steps: 10 | Train Loss: 0.820 Vali Loss: 0.951 Vali Acc: 0.632 Test Loss: 0.951 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.380112648010254
Epoch: 12, Steps: 10 | Train Loss: 0.744 Vali Loss: 0.917 Vali Acc: 0.638 Test Loss: 0.917 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5778753757476807
Epoch: 13, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.883 Vali Acc: 0.645 Test Loss: 0.883 Test Acc: 0.645
Validation loss decreased (-0.644727 --> -0.644728).  Saving model ...
Epoch: 14 cost time: 1.5994689464569092
Epoch: 14, Steps: 10 | Train Loss: 0.656 Vali Loss: 0.846 Vali Acc: 0.658 Test Loss: 0.846 Test Acc: 0.658
Validation loss decreased (-0.644728 --> -0.657886).  Saving model ...
Epoch: 15 cost time: 1.1935980319976807
Epoch: 15, Steps: 10 | Train Loss: 0.597 Vali Loss: 0.812 Vali Acc: 0.704 Test Loss: 0.812 Test Acc: 0.704
Validation loss decreased (-0.657886 --> -0.703939).  Saving model ...
Epoch: 16 cost time: 1.663942813873291
Epoch: 16, Steps: 10 | Train Loss: 0.564 Vali Loss: 0.784 Vali Acc: 0.704 Test Loss: 0.784 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703940).  Saving model ...
Epoch: 17 cost time: 1.461632490158081
Epoch: 17, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.762 Vali Acc: 0.697 Test Loss: 0.762 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.877579689025879
Epoch: 18, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.740 Vali Acc: 0.717 Test Loss: 0.740 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 19 cost time: 1.7355825901031494
Epoch: 19, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.712 Vali Acc: 0.743 Test Loss: 0.712 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 20 cost time: 1.738433837890625
Epoch: 20, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 1.78715181350708
Epoch: 21, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.679 Vali Acc: 0.763 Test Loss: 0.679 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 22 cost time: 1.9015309810638428
Epoch: 22, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.662 Vali Acc: 0.757 Test Loss: 0.662 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4487500190734863
Epoch: 23, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.650 Vali Acc: 0.763 Test Loss: 0.650 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 24 cost time: 1.3968353271484375
Epoch: 24, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.643 Vali Acc: 0.770 Test Loss: 0.643 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 25 cost time: 1.2570610046386719
Epoch: 25, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.628 Vali Acc: 0.789 Test Loss: 0.628 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789467).  Saving model ...
Epoch: 26 cost time: 1.3855547904968262
Epoch: 26, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 1.4757804870605469
Epoch: 27, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 28 cost time: 1.7261817455291748
Epoch: 28, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 1.5967326164245605
Epoch: 29, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 30 cost time: 1.51332426071167
Epoch: 30, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.604 Vali Acc: 0.789 Test Loss: 0.604 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 31 cost time: 1.2291648387908936
Epoch: 31, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3933959007263184
Epoch: 32, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.594 Vali Acc: 0.776 Test Loss: 0.594 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.9279837608337402
Epoch: 33, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.592 Vali Acc: 0.783 Test Loss: 0.592 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6702427864074707
Epoch: 34, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.588 Vali Acc: 0.770 Test Loss: 0.588 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6895675659179688
Epoch: 35, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.0714643001556396
Epoch: 36, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.0047082901000977
Epoch: 37, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.581 Vali Acc: 0.770 Test Loss: 0.581 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.2285234928131104
Epoch: 38, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.580 Vali Acc: 0.770 Test Loss: 0.580 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.169445276260376
Epoch: 39, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.579 Vali Acc: 0.763 Test Loss: 0.579 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.9439411163330078
Epoch: 40, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 8244
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8451194763183594
Epoch: 1, Steps: 10 | Train Loss: 1.622 Vali Loss: 1.484 Vali Acc: 0.250 Test Loss: 1.484 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.9506323337554932
Epoch: 2, Steps: 10 | Train Loss: 1.544 Vali Loss: 1.388 Vali Acc: 0.296 Test Loss: 1.388 Test Acc: 0.296
Validation loss decreased (-0.249985 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.0727429389953613
Epoch: 3, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.270 Vali Acc: 0.388 Test Loss: 1.270 Test Acc: 0.388
Validation loss decreased (-0.296039 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 1.2234735488891602
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.135 Vali Acc: 0.566 Test Loss: 1.135 Test Acc: 0.566
Validation loss decreased (-0.388145 --> -0.565778).  Saving model ...
Epoch: 5 cost time: 1.9676432609558105
Epoch: 5, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.017 Vali Acc: 0.638 Test Loss: 1.017 Test Acc: 0.638
Validation loss decreased (-0.565778 --> -0.638148).  Saving model ...
Epoch: 6 cost time: 1.098801612854004
Epoch: 6, Steps: 10 | Train Loss: 0.856 Vali Loss: 0.912 Vali Acc: 0.632 Test Loss: 0.912 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0710735321044922
Epoch: 7, Steps: 10 | Train Loss: 0.715 Vali Loss: 0.825 Vali Acc: 0.684 Test Loss: 0.825 Test Acc: 0.684
Validation loss decreased (-0.638148 --> -0.684202).  Saving model ...
Epoch: 8 cost time: 1.43861985206604
Epoch: 8, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.733 Vali Acc: 0.724 Test Loss: 0.733 Test Acc: 0.724
Validation loss decreased (-0.684202 --> -0.723677).  Saving model ...
Epoch: 9 cost time: 1.3526008129119873
Epoch: 9, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.669 Vali Acc: 0.743 Test Loss: 0.669 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 10 cost time: 1.1914334297180176
Epoch: 10, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
Validation loss decreased (-0.743414 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.473313808441162
Epoch: 11, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.2602627277374268
Epoch: 12, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1334939002990723
Epoch: 13, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.256094217300415
Epoch: 14, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.382944107055664
Epoch: 15, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.185049295425415
Epoch: 16, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 17 cost time: 1.4697327613830566
Epoch: 17, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2493877410888672
Epoch: 18, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4501116275787354
Epoch: 19, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.2217857837677002
Epoch: 20, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 1.5596418380737305
Epoch: 21, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.32041597366333
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8630201816558838
Epoch: 23, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.437183141708374
Epoch: 24, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6169168949127197
Epoch: 25, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.627533197402954
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.536 Vali Acc: 0.809 Test Loss: 0.536 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 27 cost time: 1.5061945915222168
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.473991870880127
Epoch: 28, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4993960857391357
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2429695129394531
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5464394092559814
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6758191585540771
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4127674102783203
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5657565593719482
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4540271759033203
Epoch: 35, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.586 Vali Acc: 0.803 Test Loss: 0.586 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6002929210662842
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.587 Vali Acc: 0.796 Test Loss: 0.587 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 14868
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.062111854553223
Epoch: 1, Steps: 10 | Train Loss: 1.541 Vali Loss: 1.410 Vali Acc: 0.230 Test Loss: 1.410 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.2052817344665527
Epoch: 2, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.354 Vali Acc: 0.296 Test Loss: 1.354 Test Acc: 0.296
Validation loss decreased (-0.230249 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.1540663242340088
Epoch: 3, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.278 Vali Acc: 0.414 Test Loss: 1.278 Test Acc: 0.414
Validation loss decreased (-0.296039 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 1.2786352634429932
Epoch: 4, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.200 Vali Acc: 0.493 Test Loss: 1.200 Test Acc: 0.493
Validation loss decreased (-0.414461 --> -0.493409).  Saving model ...
Epoch: 5 cost time: 1.4000201225280762
Epoch: 5, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.113 Vali Acc: 0.572 Test Loss: 1.113 Test Acc: 0.572
Validation loss decreased (-0.493409 --> -0.572357).  Saving model ...
Epoch: 6 cost time: 1.563725233078003
Epoch: 6, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.036 Vali Acc: 0.638 Test Loss: 1.036 Test Acc: 0.638
Validation loss decreased (-0.572357 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 1.8277697563171387
Epoch: 7, Steps: 10 | Train Loss: 0.902 Vali Loss: 0.963 Vali Acc: 0.664 Test Loss: 0.963 Test Acc: 0.664
Validation loss decreased (-0.638148 --> -0.664464).  Saving model ...
Epoch: 8 cost time: 1.9737608432769775
Epoch: 8, Steps: 10 | Train Loss: 0.845 Vali Loss: 0.898 Vali Acc: 0.671 Test Loss: 0.898 Test Acc: 0.671
Validation loss decreased (-0.664464 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 1.0862174034118652
Epoch: 9, Steps: 10 | Train Loss: 0.756 Vali Loss: 0.840 Vali Acc: 0.697 Test Loss: 0.840 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697360).  Saving model ...
Epoch: 10 cost time: 1.2129995822906494
Epoch: 10, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.781 Vali Acc: 0.711 Test Loss: 0.781 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710519).  Saving model ...
Epoch: 11 cost time: 1.6959459781646729
Epoch: 11, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.728 Vali Acc: 0.724 Test Loss: 0.728 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 12 cost time: 1.3531405925750732
Epoch: 12, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6895561218261719
Epoch: 13, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.649 Vali Acc: 0.717 Test Loss: 0.649 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3100495338439941
Epoch: 14, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.613 Vali Acc: 0.743 Test Loss: 0.613 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 1.692068099975586
Epoch: 15, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 1.60418701171875
Epoch: 16, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.573 Vali Acc: 0.757 Test Loss: 0.573 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 1.528458595275879
Epoch: 17, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.556 Vali Acc: 0.763 Test Loss: 0.556 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.4230847358703613
Epoch: 18, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.544 Vali Acc: 0.763 Test Loss: 0.544 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 1.4081900119781494
Epoch: 19, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 20 cost time: 1.9010701179504395
Epoch: 20, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.527 Vali Acc: 0.763 Test Loss: 0.527 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4134867191314697
Epoch: 21, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.519 Vali Acc: 0.770 Test Loss: 0.519 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 22 cost time: 1.7563791275024414
Epoch: 22, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.515 Vali Acc: 0.770 Test Loss: 0.515 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 23 cost time: 1.5278246402740479
Epoch: 23, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.512 Vali Acc: 0.776 Test Loss: 0.512 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 24 cost time: 1.5963032245635986
Epoch: 24, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.509 Vali Acc: 0.776 Test Loss: 0.509 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 25 cost time: 1.8430919647216797
Epoch: 25, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.504 Vali Acc: 0.776 Test Loss: 0.504 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 26 cost time: 1.3104236125946045
Epoch: 26, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 27 cost time: 1.3697731494903564
Epoch: 27, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 28 cost time: 1.4950993061065674
Epoch: 28, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.502 Vali Acc: 0.770 Test Loss: 0.502 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2616565227508545
Epoch: 29, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 30 cost time: 1.3691232204437256
Epoch: 30, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3040664196014404
Epoch: 31, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.508 Vali Acc: 0.776 Test Loss: 0.508 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.36297607421875
Epoch: 32, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3450653553009033
Epoch: 33, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.515 Vali Acc: 0.770 Test Loss: 0.515 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.084568977355957
Epoch: 34, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.124305248260498
Epoch: 35, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.7629749774932861
Epoch: 36, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1193079948425293
Epoch: 37, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.734489917755127
Epoch: 38, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.535 Vali Acc: 0.776 Test Loss: 0.535 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3290340900421143
Epoch: 39, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 9124
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.201994180679321
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.459 Vali Acc: 0.270 Test Loss: 1.459 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 1.5236680507659912
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.408 Vali Acc: 0.296 Test Loss: 1.408 Test Acc: 0.296
Validation loss decreased (-0.269722 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.752223253250122
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.345 Vali Acc: 0.349 Test Loss: 1.345 Test Acc: 0.349
Validation loss decreased (-0.296039 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 1.496269941329956
Epoch: 4, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.274 Vali Acc: 0.421 Test Loss: 1.274 Test Acc: 0.421
Validation loss decreased (-0.348671 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 1.2887628078460693
Epoch: 5, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.201 Vali Acc: 0.487 Test Loss: 1.201 Test Acc: 0.487
Validation loss decreased (-0.421040 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 1.6436145305633545
Epoch: 6, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.124 Vali Acc: 0.546 Test Loss: 1.124 Test Acc: 0.546
Validation loss decreased (-0.486830 --> -0.546041).  Saving model ...
Epoch: 7 cost time: 1.3758299350738525
Epoch: 7, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.058 Vali Acc: 0.572 Test Loss: 1.058 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572358).  Saving model ...
Epoch: 8 cost time: 1.2770185470581055
Epoch: 8, Steps: 10 | Train Loss: 0.884 Vali Loss: 0.991 Vali Acc: 0.592 Test Loss: 0.991 Test Acc: 0.592
Validation loss decreased (-0.572358 --> -0.592095).  Saving model ...
Epoch: 9 cost time: 1.2080576419830322
Epoch: 9, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.927 Vali Acc: 0.605 Test Loss: 0.927 Test Acc: 0.605
Validation loss decreased (-0.592095 --> -0.605254).  Saving model ...
Epoch: 10 cost time: 1.274320363998413
Epoch: 10, Steps: 10 | Train Loss: 0.720 Vali Loss: 0.871 Vali Acc: 0.625 Test Loss: 0.871 Test Acc: 0.625
Validation loss decreased (-0.605254 --> -0.624991).  Saving model ...
Epoch: 11 cost time: 1.406121015548706
Epoch: 11, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.821 Vali Acc: 0.651 Test Loss: 0.821 Test Acc: 0.651
Validation loss decreased (-0.624991 --> -0.651308).  Saving model ...
Epoch: 12 cost time: 1.3297131061553955
Epoch: 12, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.767 Vali Acc: 0.697 Test Loss: 0.767 Test Acc: 0.697
Validation loss decreased (-0.651308 --> -0.697361).  Saving model ...
Epoch: 13 cost time: 1.5657551288604736
Epoch: 13, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.724 Vali Acc: 0.717 Test Loss: 0.724 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 14 cost time: 1.537224531173706
Epoch: 14, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.684 Vali Acc: 0.724 Test Loss: 0.684 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 15 cost time: 1.469085693359375
Epoch: 15, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.655 Vali Acc: 0.724 Test Loss: 0.655 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723678).  Saving model ...
Epoch: 16 cost time: 1.4364712238311768
Epoch: 16, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.631 Vali Acc: 0.724 Test Loss: 0.631 Test Acc: 0.724
Validation loss decreased (-0.723678 --> -0.723678).  Saving model ...
Epoch: 17 cost time: 1.3293633460998535
Epoch: 17, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.613 Vali Acc: 0.730 Test Loss: 0.613 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 18 cost time: 1.2139902114868164
Epoch: 18, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.593 Vali Acc: 0.743 Test Loss: 0.593 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 19 cost time: 1.1254963874816895
Epoch: 19, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.576 Vali Acc: 0.743 Test Loss: 0.576 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 20 cost time: 1.496372938156128
Epoch: 20, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.560 Vali Acc: 0.750 Test Loss: 0.560 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 21 cost time: 1.1611287593841553
Epoch: 21, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.549 Vali Acc: 0.743 Test Loss: 0.549 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.305067539215088
Epoch: 22, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.539 Vali Acc: 0.750 Test Loss: 0.539 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749995).  Saving model ...
Epoch: 23 cost time: 1.4743709564208984
Epoch: 23, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.537 Vali Acc: 0.750 Test Loss: 0.537 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 24 cost time: 1.4355769157409668
Epoch: 24, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.535 Vali Acc: 0.750 Test Loss: 0.535 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 25 cost time: 1.3249082565307617
Epoch: 25, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.528 Vali Acc: 0.750 Test Loss: 0.528 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 26 cost time: 1.5138344764709473
Epoch: 26, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.519 Vali Acc: 0.763 Test Loss: 0.519 Test Acc: 0.763
Validation loss decreased (-0.749995 --> -0.763153).  Saving model ...
Epoch: 27 cost time: 1.332951545715332
Epoch: 27, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.517 Vali Acc: 0.770 Test Loss: 0.517 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 28 cost time: 1.1228241920471191
Epoch: 28, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.513 Vali Acc: 0.776 Test Loss: 0.513 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 29 cost time: 1.2252907752990723
Epoch: 29, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.512 Vali Acc: 0.776 Test Loss: 0.512 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 30 cost time: 1.0597765445709229
Epoch: 30, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.502 Vali Acc: 0.776 Test Loss: 0.502 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 31 cost time: 1.0461435317993164
Epoch: 31, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 32 cost time: 1.3265368938446045
Epoch: 32, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.505 Vali Acc: 0.776 Test Loss: 0.505 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4393470287322998
Epoch: 33, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.503 Vali Acc: 0.770 Test Loss: 0.503 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.548985481262207
Epoch: 34, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.262085199356079
Epoch: 35, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 36 cost time: 1.4137613773345947
Epoch: 36, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1676111221313477
Epoch: 37, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3910856246948242
Epoch: 38, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0251846313476562
Epoch: 39, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2474238872528076
Epoch: 40, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1539011001586914
Epoch: 41, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2321701049804688
Epoch: 42, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.2923355102539062
Epoch: 43, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.750243902206421
Epoch: 44, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.5434834957122803
Epoch: 45, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 7236
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.298029661178589
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.502 Vali Acc: 0.257 Test Loss: 1.502 Test Acc: 0.257
Validation loss decreased (inf --> -0.256564).  Saving model ...
Epoch: 2 cost time: 1.2151682376861572
Epoch: 2, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.456 Vali Acc: 0.283 Test Loss: 1.456 Test Acc: 0.283
Validation loss decreased (-0.256564 --> -0.282880).  Saving model ...
Epoch: 3 cost time: 1.0609967708587646
Epoch: 3, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.391 Vali Acc: 0.303 Test Loss: 1.391 Test Acc: 0.303
Validation loss decreased (-0.282880 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 1.3188610076904297
Epoch: 4, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.320 Vali Acc: 0.382 Test Loss: 1.320 Test Acc: 0.382
Validation loss decreased (-0.302618 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 1.2111506462097168
Epoch: 5, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.252 Vali Acc: 0.454 Test Loss: 1.252 Test Acc: 0.454
Validation loss decreased (-0.381566 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 0.9500436782836914
Epoch: 6, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.184 Vali Acc: 0.507 Test Loss: 1.184 Test Acc: 0.507
Validation loss decreased (-0.453935 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 1.3030552864074707
Epoch: 7, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.119 Vali Acc: 0.526 Test Loss: 1.119 Test Acc: 0.526
Validation loss decreased (-0.506567 --> -0.526305).  Saving model ...
Epoch: 8 cost time: 1.17563796043396
Epoch: 8, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.060 Vali Acc: 0.586 Test Loss: 1.060 Test Acc: 0.586
Validation loss decreased (-0.526305 --> -0.585516).  Saving model ...
Epoch: 9 cost time: 1.7270853519439697
Epoch: 9, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.003 Vali Acc: 0.605 Test Loss: 1.003 Test Acc: 0.605
Validation loss decreased (-0.585516 --> -0.605253).  Saving model ...
Epoch: 10 cost time: 1.2748708724975586
Epoch: 10, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.948 Vali Acc: 0.618 Test Loss: 0.948 Test Acc: 0.618
Validation loss decreased (-0.605253 --> -0.618412).  Saving model ...
Epoch: 11 cost time: 1.3272042274475098
Epoch: 11, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.897 Vali Acc: 0.632 Test Loss: 0.897 Test Acc: 0.632
Validation loss decreased (-0.618412 --> -0.631570).  Saving model ...
Epoch: 12 cost time: 1.2169063091278076
Epoch: 12, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.844 Vali Acc: 0.651 Test Loss: 0.844 Test Acc: 0.651
Validation loss decreased (-0.631570 --> -0.651307).  Saving model ...
Epoch: 13 cost time: 1.5100948810577393
Epoch: 13, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.804 Vali Acc: 0.664 Test Loss: 0.804 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664466).  Saving model ...
Epoch: 14 cost time: 1.4707043170928955
Epoch: 14, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.765 Vali Acc: 0.671 Test Loss: 0.765 Test Acc: 0.671
Validation loss decreased (-0.664466 --> -0.671045).  Saving model ...
Epoch: 15 cost time: 1.1304175853729248
Epoch: 15, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.738 Vali Acc: 0.704 Test Loss: 0.738 Test Acc: 0.704
Validation loss decreased (-0.671045 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 1.393589973449707
Epoch: 16, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.712 Vali Acc: 0.724 Test Loss: 0.712 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 17 cost time: 1.1300413608551025
Epoch: 17, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.690 Vali Acc: 0.711 Test Loss: 0.690 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2073163986206055
Epoch: 18, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.666 Vali Acc: 0.743 Test Loss: 0.666 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 1.6101224422454834
Epoch: 19, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.649 Vali Acc: 0.730 Test Loss: 0.649 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1308364868164062
Epoch: 20, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 21 cost time: 1.3964803218841553
Epoch: 21, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.634 Vali Acc: 0.757 Test Loss: 0.634 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 22 cost time: 1.2839365005493164
Epoch: 22, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.623 Vali Acc: 0.763 Test Loss: 0.623 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 1.3564109802246094
Epoch: 23, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 1.3039741516113281
Epoch: 24, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3522439002990723
Epoch: 25, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.594 Vali Acc: 0.757 Test Loss: 0.594 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3377423286437988
Epoch: 26, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 27 cost time: 1.5678980350494385
Epoch: 27, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 28 cost time: 1.1191678047180176
Epoch: 28, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.446422815322876
Epoch: 29, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4645869731903076
Epoch: 30, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.578 Vali Acc: 0.770 Test Loss: 0.578 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.217315673828125
Epoch: 31, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.198709487915039
Epoch: 32, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 33 cost time: 1.2203009128570557
Epoch: 33, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2412984371185303
Epoch: 34, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0933268070220947
Epoch: 35, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1970984935760498
Epoch: 36, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2248823642730713
Epoch: 37, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2375662326812744
Epoch: 38, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1056039333343506
Epoch: 39, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.365403175354004
Epoch: 40, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.580 Vali Acc: 0.776 Test Loss: 0.580 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2478597164154053
Epoch: 41, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1293365955352783
Epoch: 42, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 7252
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8670384883880615
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.468 Vali Acc: 0.257 Test Loss: 1.468 Test Acc: 0.257
Validation loss decreased (inf --> -0.256564).  Saving model ...
Epoch: 2 cost time: 1.2799396514892578
Epoch: 2, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.454 Vali Acc: 0.289 Test Loss: 1.454 Test Acc: 0.289
Validation loss decreased (-0.256564 --> -0.289459).  Saving model ...
Epoch: 3 cost time: 1.4420409202575684
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.417 Vali Acc: 0.342 Test Loss: 1.417 Test Acc: 0.342
Validation loss decreased (-0.289459 --> -0.342091).  Saving model ...
Epoch: 4 cost time: 1.3689093589782715
Epoch: 4, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.367 Vali Acc: 0.355 Test Loss: 1.367 Test Acc: 0.355
Validation loss decreased (-0.342091 --> -0.355249).  Saving model ...
Epoch: 5 cost time: 1.2402431964874268
Epoch: 5, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.314 Vali Acc: 0.395 Test Loss: 1.314 Test Acc: 0.395
Validation loss decreased (-0.355249 --> -0.394724).  Saving model ...
Epoch: 6 cost time: 1.3287584781646729
Epoch: 6, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.260 Vali Acc: 0.461 Test Loss: 1.260 Test Acc: 0.461
Validation loss decreased (-0.394724 --> -0.460514).  Saving model ...
Epoch: 7 cost time: 1.2867369651794434
Epoch: 7, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
Validation loss decreased (-0.460514 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.3930821418762207
Epoch: 8, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.157 Vali Acc: 0.520 Test Loss: 1.157 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519725).  Saving model ...
Epoch: 9 cost time: 1.2014639377593994
Epoch: 9, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.103 Vali Acc: 0.553 Test Loss: 1.103 Test Acc: 0.553
Validation loss decreased (-0.519725 --> -0.552621).  Saving model ...
Epoch: 10 cost time: 1.5154623985290527
Epoch: 10, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.058 Vali Acc: 0.579 Test Loss: 1.058 Test Acc: 0.579
Validation loss decreased (-0.552621 --> -0.578937).  Saving model ...
Epoch: 11 cost time: 1.4877455234527588
Epoch: 11, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.014 Vali Acc: 0.618 Test Loss: 1.014 Test Acc: 0.618
Validation loss decreased (-0.578937 --> -0.618411).  Saving model ...
Epoch: 12 cost time: 1.4627985954284668
Epoch: 12, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.973 Vali Acc: 0.632 Test Loss: 0.973 Test Acc: 0.632
Validation loss decreased (-0.618411 --> -0.631569).  Saving model ...
Epoch: 13 cost time: 1.1404571533203125
Epoch: 13, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.937 Vali Acc: 0.678 Test Loss: 0.937 Test Acc: 0.678
Validation loss decreased (-0.631569 --> -0.677622).  Saving model ...
Epoch: 14 cost time: 1.3870799541473389
Epoch: 14, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.903 Vali Acc: 0.671 Test Loss: 0.903 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.699866533279419
Epoch: 15, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.870 Vali Acc: 0.697 Test Loss: 0.870 Test Acc: 0.697
Validation loss decreased (-0.677622 --> -0.697360).  Saving model ...
Epoch: 16 cost time: 1.3603110313415527
Epoch: 16, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.839 Vali Acc: 0.704 Test Loss: 0.839 Test Acc: 0.704
Validation loss decreased (-0.697360 --> -0.703939).  Saving model ...
Epoch: 17 cost time: 1.1148371696472168
Epoch: 17, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.810 Vali Acc: 0.717 Test Loss: 0.810 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717097).  Saving model ...
Epoch: 18 cost time: 1.2396607398986816
Epoch: 18, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.784 Vali Acc: 0.711 Test Loss: 0.784 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5088508129119873
Epoch: 19, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.762 Vali Acc: 0.711 Test Loss: 0.762 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.523594617843628
Epoch: 20, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.740 Vali Acc: 0.711 Test Loss: 0.740 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5506923198699951
Epoch: 21, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.722 Vali Acc: 0.724 Test Loss: 0.722 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723677).  Saving model ...
Epoch: 22 cost time: 1.4697425365447998
Epoch: 22, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.708 Vali Acc: 0.750 Test Loss: 0.708 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 23 cost time: 1.2850983142852783
Epoch: 23, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.689 Vali Acc: 0.757 Test Loss: 0.689 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 24 cost time: 1.2204899787902832
Epoch: 24, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5157513618469238
Epoch: 25, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.672 Vali Acc: 0.757 Test Loss: 0.672 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 26 cost time: 1.5229873657226562
Epoch: 26, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.661 Vali Acc: 0.757 Test Loss: 0.661 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 27 cost time: 1.3984534740447998
Epoch: 27, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.652 Vali Acc: 0.763 Test Loss: 0.652 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 28 cost time: 1.5591278076171875
Epoch: 28, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.643 Vali Acc: 0.763 Test Loss: 0.643 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 29 cost time: 1.5831677913665771
Epoch: 29, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.632 Vali Acc: 0.770 Test Loss: 0.632 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 30 cost time: 1.447758436203003
Epoch: 30, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2868940830230713
Epoch: 31, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.620 Vali Acc: 0.763 Test Loss: 0.620 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3968918323516846
Epoch: 32, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.615 Vali Acc: 0.770 Test Loss: 0.615 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 33 cost time: 1.1592254638671875
Epoch: 33, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.611 Vali Acc: 0.770 Test Loss: 0.611 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 34 cost time: 1.5067431926727295
Epoch: 34, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.608 Vali Acc: 0.776 Test Loss: 0.608 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 35 cost time: 1.1961824893951416
Epoch: 35, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.609 Vali Acc: 0.770 Test Loss: 0.609 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1749320030212402
Epoch: 36, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.605 Vali Acc: 0.776 Test Loss: 0.605 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 37 cost time: 1.3089208602905273
Epoch: 37, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.600 Vali Acc: 0.776 Test Loss: 0.600 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 38 cost time: 1.6119799613952637
Epoch: 38, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 39 cost time: 1.1055066585540771
Epoch: 39, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5006904602050781
Epoch: 40, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.593 Vali Acc: 0.757 Test Loss: 0.593 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4416897296905518
Epoch: 41, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.403721570968628
Epoch: 42, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.592 Vali Acc: 0.757 Test Loss: 0.592 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.0213444232940674
Epoch: 43, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.594 Vali Acc: 0.763 Test Loss: 0.594 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.519711971282959
Epoch: 44, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.596 Vali Acc: 0.757 Test Loss: 0.596 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.0603280067443848
Epoch: 45, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.338280439376831
Epoch: 46, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.598 Vali Acc: 0.770 Test Loss: 0.598 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.1406121253967285
Epoch: 47, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.330658197402954
Epoch: 48, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_PatchTST_UEA_ftM_sl30_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 6132
model size : 0.34MB
