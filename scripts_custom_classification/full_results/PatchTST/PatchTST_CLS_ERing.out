Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9697620868682861
Epoch: 1, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.671 Vali Acc: 0.285 Test Loss: 1.671 Test Acc: 0.285
Validation loss decreased (inf --> -0.285168).  Saving model ...
Epoch: 2 cost time: 0.5207278728485107
Epoch: 2, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.491 Vali Acc: 0.448 Test Loss: 1.491 Test Acc: 0.448
Validation loss decreased (-0.285168 --> -0.448133).  Saving model ...
Epoch: 3 cost time: 0.4966752529144287
Epoch: 3, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.238 Vali Acc: 0.730 Test Loss: 1.238 Test Acc: 0.730
Validation loss decreased (-0.448133 --> -0.729617).  Saving model ...
Epoch: 4 cost time: 0.49016785621643066
Epoch: 4, Steps: 2 | Train Loss: 1.069 Vali Loss: 0.885 Vali Acc: 0.819 Test Loss: 0.885 Test Acc: 0.819
Validation loss decreased (-0.729617 --> -0.818510).  Saving model ...
Epoch: 5 cost time: 0.44058942794799805
Epoch: 5, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.607 Vali Acc: 0.889 Test Loss: 0.607 Test Acc: 0.889
Validation loss decreased (-0.818510 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 0.485318660736084
Epoch: 6, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.437 Vali Acc: 0.911 Test Loss: 0.437 Test Acc: 0.911
Validation loss decreased (-0.888883 --> -0.911107).  Saving model ...
Epoch: 7 cost time: 0.5061912536621094
Epoch: 7, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.321 Vali Acc: 0.952 Test Loss: 0.321 Test Acc: 0.952
Validation loss decreased (-0.911107 --> -0.951849).  Saving model ...
Epoch: 8 cost time: 0.423907995223999
Epoch: 8, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.49008846282958984
Epoch: 9, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5559735298156738
Epoch: 10, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4887869358062744
Epoch: 11, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 12 cost time: 0.5021541118621826
Epoch: 12, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.38269901275634766
Epoch: 13, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4369335174560547
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.40533995628356934
Epoch: 15, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.45404529571533203
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4224414825439453
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4822571277618408
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.473675012588501
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.47257208824157715
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5175535678863525
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 597638
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0597915649414062
Epoch: 1, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.758 Vali Acc: 0.307 Test Loss: 1.758 Test Acc: 0.307
Validation loss decreased (inf --> -0.307390).  Saving model ...
Epoch: 2 cost time: 0.5675559043884277
Epoch: 2, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.643 Vali Acc: 0.370 Test Loss: 1.643 Test Acc: 0.370
Validation loss decreased (-0.307390 --> -0.370354).  Saving model ...
Epoch: 3 cost time: 0.5340044498443604
Epoch: 3, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.500 Vali Acc: 0.489 Test Loss: 1.500 Test Acc: 0.489
Validation loss decreased (-0.370354 --> -0.488874).  Saving model ...
Epoch: 4 cost time: 0.503270149230957
Epoch: 4, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.284 Vali Acc: 0.630 Test Loss: 1.284 Test Acc: 0.630
Validation loss decreased (-0.488874 --> -0.629617).  Saving model ...
Epoch: 5 cost time: 0.4957718849182129
Epoch: 5, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.052 Vali Acc: 0.748 Test Loss: 1.052 Test Acc: 0.748
Validation loss decreased (-0.629617 --> -0.748138).  Saving model ...
Epoch: 6 cost time: 0.5044159889221191
Epoch: 6, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.836 Vali Acc: 0.833 Test Loss: 0.836 Test Acc: 0.833
Validation loss decreased (-0.748138 --> -0.833325).  Saving model ...
Epoch: 7 cost time: 0.4842853546142578
Epoch: 7, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.661 Vali Acc: 0.881 Test Loss: 0.661 Test Acc: 0.881
Validation loss decreased (-0.833325 --> -0.881475).  Saving model ...
Epoch: 8 cost time: 0.477827787399292
Epoch: 8, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.527 Vali Acc: 0.919 Test Loss: 0.527 Test Acc: 0.919
Validation loss decreased (-0.881475 --> -0.918513).  Saving model ...
Epoch: 9 cost time: 0.5513300895690918
Epoch: 9, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.427 Vali Acc: 0.933 Test Loss: 0.427 Test Acc: 0.933
Validation loss decreased (-0.918513 --> -0.933329).  Saving model ...
Epoch: 10 cost time: 0.511012077331543
Epoch: 10, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.350 Vali Acc: 0.944 Test Loss: 0.350 Test Acc: 0.944
Validation loss decreased (-0.933329 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 0.49248409271240234
Epoch: 11, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.5855016708374023
Epoch: 12, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.532395601272583
Epoch: 13, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5455021858215332
Epoch: 14, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5492475032806396
Epoch: 15, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.59122633934021
Epoch: 16, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5239806175231934
Epoch: 17, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 0.5265107154846191
Epoch: 18, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 0.4543912410736084
Epoch: 19, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5435354709625244
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5306923389434814
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.49078845977783203
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5163404941558838
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5381348133087158
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5458691120147705
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4160804748535156
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.48218560218811035
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5210824012756348
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 496518
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.227900743484497
Epoch: 1, Steps: 2 | Train Loss: 2.068 Vali Loss: 1.780 Vali Acc: 0.200 Test Loss: 1.780 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.6021690368652344
Epoch: 2, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.674 Vali Acc: 0.219 Test Loss: 1.674 Test Acc: 0.219
Validation loss decreased (-0.199982 --> -0.218502).  Saving model ...
Epoch: 3 cost time: 0.5507662296295166
Epoch: 3, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.553 Vali Acc: 0.296 Test Loss: 1.553 Test Acc: 0.296
Validation loss decreased (-0.218502 --> -0.296281).  Saving model ...
Epoch: 4 cost time: 0.5928864479064941
Epoch: 4, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.374 Vali Acc: 0.537 Test Loss: 1.374 Test Acc: 0.537
Validation loss decreased (-0.296281 --> -0.537023).  Saving model ...
Epoch: 5 cost time: 0.5751485824584961
Epoch: 5, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.174 Vali Acc: 0.719 Test Loss: 1.174 Test Acc: 0.719
Validation loss decreased (-0.537023 --> -0.718507).  Saving model ...
Epoch: 6 cost time: 0.6373264789581299
Epoch: 6, Steps: 2 | Train Loss: 1.008 Vali Loss: 0.980 Vali Acc: 0.811 Test Loss: 0.980 Test Acc: 0.811
Validation loss decreased (-0.718507 --> -0.811101).  Saving model ...
Epoch: 7 cost time: 0.5849425792694092
Epoch: 7, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.810 Vali Acc: 0.848 Test Loss: 0.810 Test Acc: 0.848
Validation loss decreased (-0.811101 --> -0.848140).  Saving model ...
Epoch: 8 cost time: 0.6612122058868408
Epoch: 8, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.667 Vali Acc: 0.859 Test Loss: 0.667 Test Acc: 0.859
Validation loss decreased (-0.848140 --> -0.859253).  Saving model ...
Epoch: 9 cost time: 0.6040949821472168
Epoch: 9, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.553 Vali Acc: 0.881 Test Loss: 0.553 Test Acc: 0.881
Validation loss decreased (-0.859253 --> -0.881476).  Saving model ...
Epoch: 10 cost time: 0.6129312515258789
Epoch: 10, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
Validation loss decreased (-0.881476 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 0.6595027446746826
Epoch: 11, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.380 Vali Acc: 0.941 Test Loss: 0.380 Test Acc: 0.941
Validation loss decreased (-0.899995 --> -0.940737).  Saving model ...
Epoch: 12 cost time: 0.6081743240356445
Epoch: 12, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.317 Vali Acc: 0.944 Test Loss: 0.317 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.5880107879638672
Epoch: 13, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.5895943641662598
Epoch: 14, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.239 Vali Acc: 0.948 Test Loss: 0.239 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 15 cost time: 0.6137802600860596
Epoch: 15, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.539665937423706
Epoch: 16, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 17 cost time: 0.6167185306549072
Epoch: 17, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5526089668273926
Epoch: 18, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.553295373916626
Epoch: 19, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6180059909820557
Epoch: 20, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5842628479003906
Epoch: 21, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.44995617866516113
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5183799266815186
Epoch: 23, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6743040084838867
Epoch: 24, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5599005222320557
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5578262805938721
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.4542863368988037
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6552989482879639
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5825502872467041
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5656087398529053
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.930 Test Loss: 0.169 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5023417472839355
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.930 Test Loss: 0.170 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 465926
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.313410758972168
Epoch: 1, Steps: 2 | Train Loss: 2.186 Vali Loss: 2.051 Vali Acc: 0.033 Test Loss: 2.051 Test Acc: 0.033
Validation loss decreased (inf --> -0.033313).  Saving model ...
Epoch: 2 cost time: 0.532052755355835
Epoch: 2, Steps: 2 | Train Loss: 2.125 Vali Loss: 1.962 Vali Acc: 0.074 Test Loss: 1.962 Test Acc: 0.074
Validation loss decreased (-0.033313 --> -0.074054).  Saving model ...
Epoch: 3 cost time: 0.5262014865875244
Epoch: 3, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.864 Vali Acc: 0.167 Test Loss: 1.864 Test Acc: 0.167
Validation loss decreased (-0.074054 --> -0.166648).  Saving model ...
Epoch: 4 cost time: 0.5517909526824951
Epoch: 4, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.717 Vali Acc: 0.289 Test Loss: 1.717 Test Acc: 0.289
Validation loss decreased (-0.166648 --> -0.288872).  Saving model ...
Epoch: 5 cost time: 0.656449556350708
Epoch: 5, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.539 Vali Acc: 0.419 Test Loss: 1.539 Test Acc: 0.419
Validation loss decreased (-0.288872 --> -0.418503).  Saving model ...
Epoch: 6 cost time: 0.5802934169769287
Epoch: 6, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.343 Vali Acc: 0.570 Test Loss: 1.343 Test Acc: 0.570
Validation loss decreased (-0.418503 --> -0.570357).  Saving model ...
Epoch: 7 cost time: 0.6210598945617676
Epoch: 7, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.149 Vali Acc: 0.711 Test Loss: 1.149 Test Acc: 0.711
Validation loss decreased (-0.570357 --> -0.711100).  Saving model ...
Epoch: 8 cost time: 0.5679855346679688
Epoch: 8, Steps: 2 | Train Loss: 1.062 Vali Loss: 0.967 Vali Acc: 0.793 Test Loss: 0.967 Test Acc: 0.793
Validation loss decreased (-0.711100 --> -0.792583).  Saving model ...
Epoch: 9 cost time: 0.6006267070770264
Epoch: 9, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.805 Vali Acc: 0.844 Test Loss: 0.805 Test Acc: 0.844
Validation loss decreased (-0.792583 --> -0.844436).  Saving model ...
Epoch: 10 cost time: 0.48270535469055176
Epoch: 10, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.671 Vali Acc: 0.881 Test Loss: 0.671 Test Acc: 0.881
Validation loss decreased (-0.844436 --> -0.881475).  Saving model ...
Epoch: 11 cost time: 0.5187973976135254
Epoch: 11, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.566 Vali Acc: 0.889 Test Loss: 0.566 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888883).  Saving model ...
Epoch: 12 cost time: 0.4536006450653076
Epoch: 12, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.483 Vali Acc: 0.896 Test Loss: 0.483 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 13 cost time: 0.5295593738555908
Epoch: 13, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.415 Vali Acc: 0.907 Test Loss: 0.415 Test Acc: 0.907
Validation loss decreased (-0.896291 --> -0.907403).  Saving model ...
Epoch: 14 cost time: 0.5989806652069092
Epoch: 14, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.361 Vali Acc: 0.919 Test Loss: 0.361 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918515).  Saving model ...
Epoch: 15 cost time: 0.5444660186767578
Epoch: 15, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5545246601104736
Epoch: 16, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.5042431354522705
Epoch: 17, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 0.5588023662567139
Epoch: 18, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 19 cost time: 0.5361595153808594
Epoch: 19, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 0.509242057800293
Epoch: 20, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.5031301975250244
Epoch: 21, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.5367887020111084
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.5943374633789062
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6555776596069336
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6267039775848389
Epoch: 25, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.709867000579834
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5623888969421387
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5828073024749756
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6084780693054199
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6035568714141846
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.714134693145752
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.926 Test Loss: 0.185 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6609461307525635
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.926 Test Loss: 0.183 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 447750
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.412081241607666
Epoch: 1, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.711 Vali Acc: 0.289 Test Loss: 1.711 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 0.5518434047698975
Epoch: 2, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.639 Vali Acc: 0.311 Test Loss: 1.639 Test Acc: 0.311
Validation loss decreased (-0.288872 --> -0.311095).  Saving model ...
Epoch: 3 cost time: 0.46004414558410645
Epoch: 3, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.565 Vali Acc: 0.337 Test Loss: 1.565 Test Acc: 0.337
Validation loss decreased (-0.311095 --> -0.337021).  Saving model ...
Epoch: 4 cost time: 0.5383648872375488
Epoch: 4, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.455 Vali Acc: 0.452 Test Loss: 1.455 Test Acc: 0.452
Validation loss decreased (-0.337021 --> -0.451837).  Saving model ...
Epoch: 5 cost time: 0.5550260543823242
Epoch: 5, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.320 Vali Acc: 0.574 Test Loss: 1.320 Test Acc: 0.574
Validation loss decreased (-0.451837 --> -0.574061).  Saving model ...
Epoch: 6 cost time: 0.6200883388519287
Epoch: 6, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.176 Vali Acc: 0.674 Test Loss: 1.176 Test Acc: 0.674
Validation loss decreased (-0.574061 --> -0.674062).  Saving model ...
Epoch: 7 cost time: 0.523484468460083
Epoch: 7, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.033 Vali Acc: 0.770 Test Loss: 1.033 Test Acc: 0.770
Validation loss decreased (-0.674062 --> -0.770360).  Saving model ...
Epoch: 8 cost time: 0.5362563133239746
Epoch: 8, Steps: 2 | Train Loss: 0.882 Vali Loss: 0.895 Vali Acc: 0.815 Test Loss: 0.895 Test Acc: 0.815
Validation loss decreased (-0.770360 --> -0.814806).  Saving model ...
Epoch: 9 cost time: 0.47133421897888184
Epoch: 9, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.768 Vali Acc: 0.856 Test Loss: 0.768 Test Acc: 0.856
Validation loss decreased (-0.814806 --> -0.855548).  Saving model ...
Epoch: 10 cost time: 0.51261305809021
Epoch: 10, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.660 Vali Acc: 0.859 Test Loss: 0.660 Test Acc: 0.859
Validation loss decreased (-0.855548 --> -0.859253).  Saving model ...
Epoch: 11 cost time: 0.47104454040527344
Epoch: 11, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.572 Vali Acc: 0.870 Test Loss: 0.572 Test Acc: 0.870
Validation loss decreased (-0.859253 --> -0.870365).  Saving model ...
Epoch: 12 cost time: 0.5377480983734131
Epoch: 12, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
Validation loss decreased (-0.870365 --> -0.888884).  Saving model ...
Epoch: 13 cost time: 0.583491325378418
Epoch: 13, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.426 Vali Acc: 0.926 Test Loss: 0.426 Test Acc: 0.926
Validation loss decreased (-0.888884 --> -0.925922).  Saving model ...
Epoch: 14 cost time: 0.5001389980316162
Epoch: 14, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5449438095092773
Epoch: 15, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.325 Vali Acc: 0.937 Test Loss: 0.325 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937034).  Saving model ...
Epoch: 16 cost time: 0.530153751373291
Epoch: 16, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.6670846939086914
Epoch: 17, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5428290367126465
Epoch: 18, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5340425968170166
Epoch: 19, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5495467185974121
Epoch: 20, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4761016368865967
Epoch: 21, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.513312816619873
Epoch: 22, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6069645881652832
Epoch: 23, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5546994209289551
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.6003034114837646
Epoch: 25, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.5057270526885986
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.6004137992858887
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.523090124130249
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5819318294525146
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5456671714782715
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4484128952026367
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.48752450942993164
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4551420211791992
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5378875732421875
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.47240376472473145
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5781207084655762
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 438918
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0922014713287354
Epoch: 1, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.653 Vali Acc: 0.252 Test Loss: 1.653 Test Acc: 0.252
Validation loss decreased (inf --> -0.251835).  Saving model ...
Epoch: 2 cost time: 0.5290429592132568
Epoch: 2, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.587 Vali Acc: 0.293 Test Loss: 1.587 Test Acc: 0.293
Validation loss decreased (-0.251835 --> -0.292577).  Saving model ...
Epoch: 3 cost time: 0.5559003353118896
Epoch: 3, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.520 Vali Acc: 0.337 Test Loss: 1.520 Test Acc: 0.337
Validation loss decreased (-0.292577 --> -0.337022).  Saving model ...
Epoch: 4 cost time: 0.5564358234405518
Epoch: 4, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.429 Vali Acc: 0.522 Test Loss: 1.429 Test Acc: 0.522
Validation loss decreased (-0.337022 --> -0.522208).  Saving model ...
Epoch: 5 cost time: 0.49686264991760254
Epoch: 5, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.319 Vali Acc: 0.637 Test Loss: 1.319 Test Acc: 0.637
Validation loss decreased (-0.522208 --> -0.637024).  Saving model ...
Epoch: 6 cost time: 0.48000335693359375
Epoch: 6, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.200 Vali Acc: 0.730 Test Loss: 1.200 Test Acc: 0.730
Validation loss decreased (-0.637024 --> -0.729618).  Saving model ...
Epoch: 7 cost time: 0.5163700580596924
Epoch: 7, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.079 Vali Acc: 0.774 Test Loss: 1.079 Test Acc: 0.774
Validation loss decreased (-0.729618 --> -0.774063).  Saving model ...
Epoch: 8 cost time: 0.5886340141296387
Epoch: 8, Steps: 2 | Train Loss: 0.945 Vali Loss: 0.960 Vali Acc: 0.807 Test Loss: 0.960 Test Acc: 0.807
Validation loss decreased (-0.774063 --> -0.807398).  Saving model ...
Epoch: 9 cost time: 0.5384528636932373
Epoch: 9, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.851 Vali Acc: 0.844 Test Loss: 0.851 Test Acc: 0.844
Validation loss decreased (-0.807398 --> -0.844436).  Saving model ...
Epoch: 10 cost time: 0.528019905090332
Epoch: 10, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.752 Vali Acc: 0.874 Test Loss: 0.752 Test Acc: 0.874
Validation loss decreased (-0.844436 --> -0.874067).  Saving model ...
Epoch: 11 cost time: 0.4918992519378662
Epoch: 11, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.665 Vali Acc: 0.896 Test Loss: 0.665 Test Acc: 0.896
Validation loss decreased (-0.874067 --> -0.896290).  Saving model ...
Epoch: 12 cost time: 0.53182053565979
Epoch: 12, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.590 Vali Acc: 0.904 Test Loss: 0.590 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 13 cost time: 0.4299337863922119
Epoch: 13, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.524 Vali Acc: 0.919 Test Loss: 0.524 Test Acc: 0.919
Validation loss decreased (-0.903698 --> -0.918513).  Saving model ...
Epoch: 14 cost time: 0.47872042655944824
Epoch: 14, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.467 Vali Acc: 0.926 Test Loss: 0.467 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 15 cost time: 0.5134291648864746
Epoch: 15, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.420 Vali Acc: 0.930 Test Loss: 0.420 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 16 cost time: 0.5212264060974121
Epoch: 16, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5441484451293945
Epoch: 17, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.349 Vali Acc: 0.922 Test Loss: 0.349 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5201976299285889
Epoch: 18, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.49861693382263184
Epoch: 19, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.298 Vali Acc: 0.915 Test Loss: 0.298 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4965662956237793
Epoch: 20, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5430736541748047
Epoch: 21, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.264 Vali Acc: 0.919 Test Loss: 0.264 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.47698211669921875
Epoch: 22, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5808238983154297
Epoch: 23, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5068635940551758
Epoch: 24, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.5132429599761963
Epoch: 25, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.5666849613189697
Epoch: 26, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.533684492111206
Epoch: 27, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.5781307220458984
Epoch: 28, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.5449051856994629
Epoch: 29, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.5097453594207764
Epoch: 30, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.7068018913269043
Epoch: 31, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.5561378002166748
Epoch: 32, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.6218357086181641
Epoch: 33, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.5205583572387695
Epoch: 34, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.5264508724212646
Epoch: 35, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.5229184627532959
Epoch: 36, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.6186971664428711
Epoch: 37, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.5636427402496338
Epoch: 38, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.5745596885681152
Epoch: 39, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.5947778224945068
Epoch: 40, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.5110988616943359
Epoch: 41, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.47538232803344727
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.5445840358734131
Epoch: 43, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.5467245578765869
Epoch: 44, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.49197888374328613
Epoch: 45, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.4762539863586426
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.5839416980743408
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.4281916618347168
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.4951341152191162
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 50 cost time: 0.551389217376709
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5381689071655273
Epoch: 51, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.4966726303100586
Epoch: 52, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.6044878959655762
Epoch: 53, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5556764602661133
Epoch: 54, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5081322193145752
Epoch: 55, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.47699856758117676
Epoch: 56, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.5963013172149658
Epoch: 57, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.5602824687957764
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.5275726318359375
Epoch: 59, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 427014
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.878739833831787
Epoch: 1, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.795 Vali Acc: 0.185 Test Loss: 1.795 Test Acc: 0.185
Validation loss decreased (inf --> -0.185167).  Saving model ...
Epoch: 2 cost time: 0.48445940017700195
Epoch: 2, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.723 Vali Acc: 0.215 Test Loss: 1.723 Test Acc: 0.215
Validation loss decreased (-0.185167 --> -0.214798).  Saving model ...
Epoch: 3 cost time: 0.46879100799560547
Epoch: 3, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.657 Vali Acc: 0.278 Test Loss: 1.657 Test Acc: 0.278
Validation loss decreased (-0.214798 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 0.4508023262023926
Epoch: 4, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.574 Vali Acc: 0.389 Test Loss: 1.574 Test Acc: 0.389
Validation loss decreased (-0.277761 --> -0.388873).  Saving model ...
Epoch: 5 cost time: 0.5512692928314209
Epoch: 5, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.475 Vali Acc: 0.448 Test Loss: 1.475 Test Acc: 0.448
Validation loss decreased (-0.388873 --> -0.448133).  Saving model ...
Epoch: 6 cost time: 0.5369958877563477
Epoch: 6, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.367 Vali Acc: 0.511 Test Loss: 1.367 Test Acc: 0.511
Validation loss decreased (-0.448133 --> -0.511097).  Saving model ...
Epoch: 7 cost time: 0.5688045024871826
Epoch: 7, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.252 Vali Acc: 0.581 Test Loss: 1.252 Test Acc: 0.581
Validation loss decreased (-0.511097 --> -0.581469).  Saving model ...
Epoch: 8 cost time: 0.49051809310913086
Epoch: 8, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.136 Vali Acc: 0.656 Test Loss: 1.136 Test Acc: 0.656
Validation loss decreased (-0.581469 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 0.5435304641723633
Epoch: 9, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.024 Vali Acc: 0.715 Test Loss: 1.024 Test Acc: 0.715
Validation loss decreased (-0.655544 --> -0.714805).  Saving model ...
Epoch: 10 cost time: 0.520167350769043
Epoch: 10, Steps: 2 | Train Loss: 0.833 Vali Loss: 0.919 Vali Acc: 0.767 Test Loss: 0.919 Test Acc: 0.767
Validation loss decreased (-0.714805 --> -0.766657).  Saving model ...
Epoch: 11 cost time: 0.5289962291717529
Epoch: 11, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.823 Vali Acc: 0.811 Test Loss: 0.823 Test Acc: 0.811
Validation loss decreased (-0.766657 --> -0.811103).  Saving model ...
Epoch: 12 cost time: 0.5981063842773438
Epoch: 12, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.737 Vali Acc: 0.841 Test Loss: 0.737 Test Acc: 0.841
Validation loss decreased (-0.811103 --> -0.840733).  Saving model ...
Epoch: 13 cost time: 0.5634055137634277
Epoch: 13, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.662 Vali Acc: 0.856 Test Loss: 0.662 Test Acc: 0.856
Validation loss decreased (-0.840733 --> -0.855549).  Saving model ...
Epoch: 14 cost time: 0.6309657096862793
Epoch: 14, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.594 Vali Acc: 0.878 Test Loss: 0.594 Test Acc: 0.878
Validation loss decreased (-0.855549 --> -0.877772).  Saving model ...
Epoch: 15 cost time: 0.526505708694458
Epoch: 15, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
Validation loss decreased (-0.877772 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.5696742534637451
Epoch: 16, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.476 Vali Acc: 0.911 Test Loss: 0.476 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911106).  Saving model ...
Epoch: 17 cost time: 0.5293581485748291
Epoch: 17, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.429 Vali Acc: 0.919 Test Loss: 0.429 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 18 cost time: 0.5716240406036377
Epoch: 18, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.390 Vali Acc: 0.926 Test Loss: 0.390 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 19 cost time: 0.5586593151092529
Epoch: 19, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 20 cost time: 0.5492768287658691
Epoch: 20, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5493876934051514
Epoch: 21, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.305 Vali Acc: 0.922 Test Loss: 0.305 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5874853134155273
Epoch: 22, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.286 Vali Acc: 0.915 Test Loss: 0.286 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.606245756149292
Epoch: 23, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.49160313606262207
Epoch: 24, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.259 Vali Acc: 0.915 Test Loss: 0.259 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5429446697235107
Epoch: 25, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.57057785987854
Epoch: 26, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.4313781261444092
Epoch: 27, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.5251462459564209
Epoch: 28, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.5109450817108154
Epoch: 29, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.466721773147583
Epoch: 30, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.937035 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.47585487365722656
Epoch: 31, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 0.4892251491546631
Epoch: 32, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.5139594078063965
Epoch: 33, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.5066831111907959
Epoch: 34, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.5626616477966309
Epoch: 35, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.5621895790100098
Epoch: 36, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.5019826889038086
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.5602571964263916
Epoch: 38, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5553305149078369
Epoch: 39, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5920672416687012
Epoch: 40, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5661602020263672
Epoch: 41, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6009261608123779
Epoch: 42, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5689899921417236
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5691602230072021
Epoch: 44, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 45 cost time: 0.5526087284088135
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 46 cost time: 0.5487112998962402
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 47 cost time: 0.5840528011322021
Epoch: 47, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 48 cost time: 0.5462074279785156
Epoch: 48, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.5298628807067871
Epoch: 49, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.5730972290039062
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 51 cost time: 0.5339860916137695
Epoch: 51, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 52 cost time: 0.517021656036377
Epoch: 52, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 53 cost time: 0.4754009246826172
Epoch: 53, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 54 cost time: 0.4323558807373047
Epoch: 54, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 55 cost time: 0.5085217952728271
Epoch: 55, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 56 cost time: 0.5171618461608887
Epoch: 56, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.48413515090942383
Epoch: 57, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6925394535064697
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5510716438293457
Epoch: 59, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.6449084281921387
Epoch: 60, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.4979867935180664
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.617203950881958
Epoch: 62, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.5677812099456787
Epoch: 63, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.5625848770141602
Epoch: 64, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.6229743957519531
Epoch: 65, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 421382
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3396713733673096
Epoch: 1, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.576 Vali Acc: 0.444 Test Loss: 1.576 Test Acc: 0.444
Validation loss decreased (inf --> -0.444429).  Saving model ...
Epoch: 2 cost time: 0.6609852313995361
Epoch: 2, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.430 Vali Acc: 0.544 Test Loss: 1.430 Test Acc: 0.544
Validation loss decreased (-0.444429 --> -0.544430).  Saving model ...
Epoch: 3 cost time: 0.6227231025695801
Epoch: 3, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.216 Vali Acc: 0.744 Test Loss: 1.216 Test Acc: 0.744
Validation loss decreased (-0.544430 --> -0.744432).  Saving model ...
Epoch: 4 cost time: 0.6459019184112549
Epoch: 4, Steps: 2 | Train Loss: 1.220 Vali Loss: 0.911 Vali Acc: 0.804 Test Loss: 0.911 Test Acc: 0.804
Validation loss decreased (-0.744432 --> -0.803695).  Saving model ...
Epoch: 5 cost time: 0.6584346294403076
Epoch: 5, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.662 Vali Acc: 0.904 Test Loss: 0.662 Test Acc: 0.904
Validation loss decreased (-0.803695 --> -0.903697).  Saving model ...
Epoch: 6 cost time: 0.6651856899261475
Epoch: 6, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.478 Vali Acc: 0.926 Test Loss: 0.478 Test Acc: 0.926
Validation loss decreased (-0.903697 --> -0.925921).  Saving model ...
Epoch: 7 cost time: 0.6793243885040283
Epoch: 7, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.369 Vali Acc: 0.933 Test Loss: 0.369 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933330).  Saving model ...
Epoch: 8 cost time: 0.6712155342102051
Epoch: 8, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.307 Vali Acc: 0.922 Test Loss: 0.307 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6294214725494385
Epoch: 9, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7255280017852783
Epoch: 10, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7143094539642334
Epoch: 11, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937035).  Saving model ...
Epoch: 12 cost time: 0.7162742614746094
Epoch: 12, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
Validation loss decreased (-0.937035 --> -0.951850).  Saving model ...
Epoch: 13 cost time: 0.7906103134155273
Epoch: 13, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.937 Test Loss: 0.154 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7615630626678467
Epoch: 14, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.154 Vali Acc: 0.937 Test Loss: 0.154 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7723283767700195
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.702866792678833
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6728944778442383
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7469892501831055
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7405328750610352
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7047288417816162
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8008918762207031
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.919 Test Loss: 0.221 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7029838562011719
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.919 Test Loss: 0.225 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 498950
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4417483806610107
Epoch: 1, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.653 Vali Acc: 0.374 Test Loss: 1.653 Test Acc: 0.374
Validation loss decreased (inf --> -0.374058).  Saving model ...
Epoch: 2 cost time: 0.8042106628417969
Epoch: 2, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.564 Vali Acc: 0.456 Test Loss: 1.564 Test Acc: 0.456
Validation loss decreased (-0.374058 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 0.855365514755249
Epoch: 3, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.447 Vali Acc: 0.507 Test Loss: 1.447 Test Acc: 0.507
Validation loss decreased (-0.455540 --> -0.507393).  Saving model ...
Epoch: 4 cost time: 0.7109696865081787
Epoch: 4, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.264 Vali Acc: 0.607 Test Loss: 1.264 Test Acc: 0.607
Validation loss decreased (-0.507393 --> -0.607395).  Saving model ...
Epoch: 5 cost time: 0.9057307243347168
Epoch: 5, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.067 Vali Acc: 0.696 Test Loss: 1.067 Test Acc: 0.696
Validation loss decreased (-0.607395 --> -0.696286).  Saving model ...
Epoch: 6 cost time: 0.7962169647216797
Epoch: 6, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.876 Vali Acc: 0.770 Test Loss: 0.876 Test Acc: 0.770
Validation loss decreased (-0.696286 --> -0.770362).  Saving model ...
Epoch: 7 cost time: 0.7523400783538818
Epoch: 7, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.714 Vali Acc: 0.819 Test Loss: 0.714 Test Acc: 0.819
Validation loss decreased (-0.770362 --> -0.818511).  Saving model ...
Epoch: 8 cost time: 0.6755847930908203
Epoch: 8, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
Validation loss decreased (-0.818511 --> -0.866661).  Saving model ...
Epoch: 9 cost time: 0.8021533489227295
Epoch: 9, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.459 Vali Acc: 0.922 Test Loss: 0.459 Test Acc: 0.922
Validation loss decreased (-0.866661 --> -0.922218).  Saving model ...
Epoch: 10 cost time: 0.7567234039306641
Epoch: 10, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.373 Vali Acc: 0.930 Test Loss: 0.373 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 11 cost time: 0.7443938255310059
Epoch: 11, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 12 cost time: 0.8241474628448486
Epoch: 12, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.261 Vali Acc: 0.948 Test Loss: 0.261 Test Acc: 0.948
Validation loss decreased (-0.933330 --> -0.948146).  Saving model ...
Epoch: 13 cost time: 0.7806036472320557
Epoch: 13, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8278419971466064
Epoch: 14, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8536477088928223
Epoch: 15, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.796832799911499
Epoch: 16, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.778764009475708
Epoch: 17, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7777161598205566
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8173658847808838
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8452434539794922
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.770017147064209
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8310248851776123
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 397830
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.530869960784912
Epoch: 1, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.746 Vali Acc: 0.089 Test Loss: 1.746 Test Acc: 0.089
Validation loss decreased (inf --> -0.088871).  Saving model ...
Epoch: 2 cost time: 0.7022552490234375
Epoch: 2, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.645 Vali Acc: 0.278 Test Loss: 1.645 Test Acc: 0.278
Validation loss decreased (-0.088871 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.700739860534668
Epoch: 3, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.532 Vali Acc: 0.456 Test Loss: 1.532 Test Acc: 0.456
Validation loss decreased (-0.277761 --> -0.455540).  Saving model ...
Epoch: 4 cost time: 0.6715512275695801
Epoch: 4, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.372 Vali Acc: 0.563 Test Loss: 1.372 Test Acc: 0.563
Validation loss decreased (-0.455540 --> -0.562949).  Saving model ...
Epoch: 5 cost time: 0.669823408126831
Epoch: 5, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.195 Vali Acc: 0.659 Test Loss: 1.195 Test Acc: 0.659
Validation loss decreased (-0.562949 --> -0.659247).  Saving model ...
Epoch: 6 cost time: 0.768714189529419
Epoch: 6, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.018 Vali Acc: 0.741 Test Loss: 1.018 Test Acc: 0.741
Validation loss decreased (-0.659247 --> -0.740731).  Saving model ...
Epoch: 7 cost time: 0.7830181121826172
Epoch: 7, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.855 Vali Acc: 0.789 Test Loss: 0.855 Test Acc: 0.789
Validation loss decreased (-0.740731 --> -0.788880).  Saving model ...
Epoch: 8 cost time: 0.6386463642120361
Epoch: 8, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.706 Vali Acc: 0.848 Test Loss: 0.706 Test Acc: 0.848
Validation loss decreased (-0.788880 --> -0.848141).  Saving model ...
Epoch: 9 cost time: 0.7483439445495605
Epoch: 9, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.580 Vali Acc: 0.896 Test Loss: 0.580 Test Acc: 0.896
Validation loss decreased (-0.848141 --> -0.896290).  Saving model ...
Epoch: 10 cost time: 0.689136266708374
Epoch: 10, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.482 Vali Acc: 0.911 Test Loss: 0.482 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911106).  Saving model ...
Epoch: 11 cost time: 0.7052254676818848
Epoch: 11, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.401 Vali Acc: 0.941 Test Loss: 0.401 Test Acc: 0.941
Validation loss decreased (-0.911106 --> -0.940737).  Saving model ...
Epoch: 12 cost time: 0.7925338745117188
Epoch: 12, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.336 Vali Acc: 0.944 Test Loss: 0.336 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.7348816394805908
Epoch: 13, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.283 Vali Acc: 0.959 Test Loss: 0.283 Test Acc: 0.959
Validation loss decreased (-0.944441 --> -0.959256).  Saving model ...
Epoch: 14 cost time: 0.7881293296813965
Epoch: 14, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7916717529296875
Epoch: 15, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.75996994972229
Epoch: 16, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959257).  Saving model ...
Epoch: 17 cost time: 0.7659182548522949
Epoch: 17, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 18 cost time: 0.781059741973877
Epoch: 18, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7136478424072266
Epoch: 19, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7708883285522461
Epoch: 20, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7173070907592773
Epoch: 21, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7910397052764893
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7205297946929932
Epoch: 23, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.637249231338501
Epoch: 24, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6967756748199463
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6750771999359131
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.952 Test Loss: 0.153 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6297957897186279
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.948 Test Loss: 0.153 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 367238
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3336994647979736
Epoch: 1, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.739 Vali Acc: 0.274 Test Loss: 1.739 Test Acc: 0.274
Validation loss decreased (inf --> -0.274057).  Saving model ...
Epoch: 2 cost time: 0.7488725185394287
Epoch: 2, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.654 Vali Acc: 0.304 Test Loss: 1.654 Test Acc: 0.304
Validation loss decreased (-0.274057 --> -0.303687).  Saving model ...
Epoch: 3 cost time: 0.746213436126709
Epoch: 3, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.562 Vali Acc: 0.400 Test Loss: 1.562 Test Acc: 0.400
Validation loss decreased (-0.303687 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 0.7136433124542236
Epoch: 4, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.431 Vali Acc: 0.567 Test Loss: 1.431 Test Acc: 0.567
Validation loss decreased (-0.399984 --> -0.566652).  Saving model ...
Epoch: 5 cost time: 0.7352650165557861
Epoch: 5, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.275 Vali Acc: 0.693 Test Loss: 1.275 Test Acc: 0.693
Validation loss decreased (-0.566652 --> -0.692580).  Saving model ...
Epoch: 6 cost time: 0.7050316333770752
Epoch: 6, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.108 Vali Acc: 0.744 Test Loss: 1.108 Test Acc: 0.744
Validation loss decreased (-0.692580 --> -0.744433).  Saving model ...
Epoch: 7 cost time: 0.7887251377105713
Epoch: 7, Steps: 2 | Train Loss: 0.952 Vali Loss: 0.950 Vali Acc: 0.796 Test Loss: 0.950 Test Acc: 0.796
Validation loss decreased (-0.744433 --> -0.796287).  Saving model ...
Epoch: 8 cost time: 0.7659790515899658
Epoch: 8, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.808 Vali Acc: 0.844 Test Loss: 0.808 Test Acc: 0.844
Validation loss decreased (-0.796287 --> -0.844436).  Saving model ...
Epoch: 9 cost time: 0.7395713329315186
Epoch: 9, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.688 Vali Acc: 0.859 Test Loss: 0.688 Test Acc: 0.859
Validation loss decreased (-0.844436 --> -0.859252).  Saving model ...
Epoch: 10 cost time: 0.7111790180206299
Epoch: 10, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.590 Vali Acc: 0.870 Test Loss: 0.590 Test Acc: 0.870
Validation loss decreased (-0.859252 --> -0.870364).  Saving model ...
Epoch: 11 cost time: 0.7161543369293213
Epoch: 11, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.510 Vali Acc: 0.889 Test Loss: 0.510 Test Acc: 0.889
Validation loss decreased (-0.870364 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 0.6793761253356934
Epoch: 12, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 13 cost time: 0.6964263916015625
Epoch: 13, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.6908345222473145
Epoch: 14, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.342 Vali Acc: 0.911 Test Loss: 0.342 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 0.732356071472168
Epoch: 15, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 0.7024984359741211
Epoch: 16, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.272 Vali Acc: 0.915 Test Loss: 0.272 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 17 cost time: 0.6773443222045898
Epoch: 17, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 18 cost time: 0.6790421009063721
Epoch: 18, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (-0.918516 --> -0.929627).  Saving model ...
Epoch: 19 cost time: 0.7901511192321777
Epoch: 19, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7236442565917969
Epoch: 20, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7662792205810547
Epoch: 21, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.7800536155700684
Epoch: 22, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.6917684078216553
Epoch: 23, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8214380741119385
Epoch: 24, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.855332612991333
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.7387723922729492
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.8220844268798828
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.6664779186248779
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.7731418609619141
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7692089080810547
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8207714557647705
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6908247470855713
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.930 Test Loss: 0.178 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8255581855773926
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7983291149139404
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7640542984008789
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8872363567352295
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7367439270019531
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.8018512725830078
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 349062
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4795196056365967
Epoch: 1, Steps: 2 | Train Loss: 1.955 Vali Loss: 1.930 Vali Acc: 0.156 Test Loss: 1.930 Test Acc: 0.156
Validation loss decreased (inf --> -0.155536).  Saving model ...
Epoch: 2 cost time: 0.5986182689666748
Epoch: 2, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.849 Vali Acc: 0.219 Test Loss: 1.849 Test Acc: 0.219
Validation loss decreased (-0.155536 --> -0.218500).  Saving model ...
Epoch: 3 cost time: 0.6294033527374268
Epoch: 3, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.767 Vali Acc: 0.263 Test Loss: 1.767 Test Acc: 0.263
Validation loss decreased (-0.218500 --> -0.262945).  Saving model ...
Epoch: 4 cost time: 0.6252405643463135
Epoch: 4, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.652 Vali Acc: 0.304 Test Loss: 1.652 Test Acc: 0.304
Validation loss decreased (-0.262945 --> -0.303687).  Saving model ...
Epoch: 5 cost time: 0.599496603012085
Epoch: 5, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.511 Vali Acc: 0.370 Test Loss: 1.511 Test Acc: 0.370
Validation loss decreased (-0.303687 --> -0.370355).  Saving model ...
Epoch: 6 cost time: 0.6336352825164795
Epoch: 6, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.356 Vali Acc: 0.441 Test Loss: 1.356 Test Acc: 0.441
Validation loss decreased (-0.370355 --> -0.440727).  Saving model ...
Epoch: 7 cost time: 0.6299607753753662
Epoch: 7, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.201 Vali Acc: 0.533 Test Loss: 1.201 Test Acc: 0.533
Validation loss decreased (-0.440727 --> -0.533321).  Saving model ...
Epoch: 8 cost time: 0.5581891536712646
Epoch: 8, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.049 Vali Acc: 0.693 Test Loss: 1.049 Test Acc: 0.693
Validation loss decreased (-0.533321 --> -0.692582).  Saving model ...
Epoch: 9 cost time: 0.5238673686981201
Epoch: 9, Steps: 2 | Train Loss: 0.890 Vali Loss: 0.910 Vali Acc: 0.781 Test Loss: 0.910 Test Acc: 0.781
Validation loss decreased (-0.692582 --> -0.781472).  Saving model ...
Epoch: 10 cost time: 0.5263140201568604
Epoch: 10, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.786 Vali Acc: 0.837 Test Loss: 0.786 Test Acc: 0.837
Validation loss decreased (-0.781472 --> -0.837029).  Saving model ...
Epoch: 11 cost time: 0.556957483291626
Epoch: 11, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.680 Vali Acc: 0.859 Test Loss: 0.680 Test Acc: 0.859
Validation loss decreased (-0.837029 --> -0.859252).  Saving model ...
Epoch: 12 cost time: 0.5347363948822021
Epoch: 12, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.589 Vali Acc: 0.870 Test Loss: 0.589 Test Acc: 0.870
Validation loss decreased (-0.859252 --> -0.870364).  Saving model ...
Epoch: 13 cost time: 0.6193633079528809
Epoch: 13, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.512 Vali Acc: 0.896 Test Loss: 0.512 Test Acc: 0.896
Validation loss decreased (-0.870364 --> -0.896291).  Saving model ...
Epoch: 14 cost time: 0.5927670001983643
Epoch: 14, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.449 Vali Acc: 0.926 Test Loss: 0.449 Test Acc: 0.926
Validation loss decreased (-0.896291 --> -0.925921).  Saving model ...
Epoch: 15 cost time: 0.5557887554168701
Epoch: 15, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.396 Vali Acc: 0.933 Test Loss: 0.396 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 16 cost time: 0.5316224098205566
Epoch: 16, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.353 Vali Acc: 0.933 Test Loss: 0.353 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 17 cost time: 0.5595364570617676
Epoch: 17, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.322 Vali Acc: 0.915 Test Loss: 0.322 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6187417507171631
Epoch: 18, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.294 Vali Acc: 0.915 Test Loss: 0.294 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7237250804901123
Epoch: 19, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.270 Vali Acc: 0.919 Test Loss: 0.270 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7029201984405518
Epoch: 20, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.253 Vali Acc: 0.915 Test Loss: 0.253 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6659355163574219
Epoch: 21, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.237 Vali Acc: 0.919 Test Loss: 0.237 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6757409572601318
Epoch: 22, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.651679515838623
Epoch: 23, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.5889067649841309
Epoch: 24, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.6280982494354248
Epoch: 25, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.6582982540130615
Epoch: 26, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.6346843242645264
Epoch: 27, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.625004768371582
Epoch: 28, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.6361420154571533
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.5816755294799805
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.6170186996459961
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5508139133453369
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5522315502166748
Epoch: 33, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5611023902893066
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5555784702301025
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6043882369995117
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5319883823394775
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5729584693908691
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5828938484191895
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6147770881652832
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 340230
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3902664184570312
Epoch: 1, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.616 Vali Acc: 0.478 Test Loss: 1.616 Test Acc: 0.478
Validation loss decreased (inf --> -0.477762).  Saving model ...
Epoch: 2 cost time: 0.6580219268798828
Epoch: 2, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.551 Vali Acc: 0.500 Test Loss: 1.551 Test Acc: 0.500
Validation loss decreased (-0.477762 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 0.6329646110534668
Epoch: 3, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.490 Vali Acc: 0.515 Test Loss: 1.490 Test Acc: 0.515
Validation loss decreased (-0.499984 --> -0.514800).  Saving model ...
Epoch: 4 cost time: 0.6848201751708984
Epoch: 4, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.411 Vali Acc: 0.541 Test Loss: 1.411 Test Acc: 0.541
Validation loss decreased (-0.514800 --> -0.540727).  Saving model ...
Epoch: 5 cost time: 0.639056921005249
Epoch: 5, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.311 Vali Acc: 0.563 Test Loss: 1.311 Test Acc: 0.563
Validation loss decreased (-0.540727 --> -0.562950).  Saving model ...
Epoch: 6 cost time: 0.6000576019287109
Epoch: 6, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.202 Vali Acc: 0.596 Test Loss: 1.202 Test Acc: 0.596
Validation loss decreased (-0.562950 --> -0.596284).  Saving model ...
Epoch: 7 cost time: 0.5937676429748535
Epoch: 7, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.089 Vali Acc: 0.681 Test Loss: 1.089 Test Acc: 0.681
Validation loss decreased (-0.596284 --> -0.681471).  Saving model ...
Epoch: 8 cost time: 0.5174942016601562
Epoch: 8, Steps: 2 | Train Loss: 1.039 Vali Loss: 0.977 Vali Acc: 0.770 Test Loss: 0.977 Test Acc: 0.770
Validation loss decreased (-0.681471 --> -0.770361).  Saving model ...
Epoch: 9 cost time: 0.5476405620574951
Epoch: 9, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.871 Vali Acc: 0.819 Test Loss: 0.871 Test Acc: 0.819
Validation loss decreased (-0.770361 --> -0.818510).  Saving model ...
Epoch: 10 cost time: 0.5241031646728516
Epoch: 10, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.773 Vali Acc: 0.874 Test Loss: 0.773 Test Acc: 0.874
Validation loss decreased (-0.818510 --> -0.874066).  Saving model ...
Epoch: 11 cost time: 0.4995462894439697
Epoch: 11, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.684 Vali Acc: 0.896 Test Loss: 0.684 Test Acc: 0.896
Validation loss decreased (-0.874066 --> -0.896289).  Saving model ...
Epoch: 12 cost time: 0.5152499675750732
Epoch: 12, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.605 Vali Acc: 0.907 Test Loss: 0.605 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907401).  Saving model ...
Epoch: 13 cost time: 0.48389601707458496
Epoch: 13, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.537 Vali Acc: 0.919 Test Loss: 0.537 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 14 cost time: 0.6320433616638184
Epoch: 14, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.477 Vali Acc: 0.922 Test Loss: 0.477 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 15 cost time: 0.5915331840515137
Epoch: 15, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.426 Vali Acc: 0.926 Test Loss: 0.426 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925922).  Saving model ...
Epoch: 16 cost time: 0.6101515293121338
Epoch: 16, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.382 Vali Acc: 0.930 Test Loss: 0.382 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 17 cost time: 0.6480898857116699
Epoch: 17, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.344 Vali Acc: 0.930 Test Loss: 0.344 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 18 cost time: 0.5287065505981445
Epoch: 18, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.311 Vali Acc: 0.933 Test Loss: 0.311 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 19 cost time: 0.6073949337005615
Epoch: 19, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6320583820343018
Epoch: 20, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5873165130615234
Epoch: 21, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5721602439880371
Epoch: 22, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5648691654205322
Epoch: 23, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6115977764129639
Epoch: 24, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5605618953704834
Epoch: 25, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5455212593078613
Epoch: 26, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5199873447418213
Epoch: 27, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.5929350852966309
Epoch: 28, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.6377108097076416
Epoch: 29, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.5753610134124756
Epoch: 30, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.6166369915008545
Epoch: 31, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.5344545841217041
Epoch: 32, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.6461129188537598
Epoch: 33, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.6239285469055176
Epoch: 34, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.6270225048065186
Epoch: 35, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6719577312469482
Epoch: 36, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6753876209259033
Epoch: 37, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7100379467010498
Epoch: 38, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7742466926574707
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6477460861206055
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6809015274047852
Epoch: 41, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6661138534545898
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6448349952697754
Epoch: 43, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.6197686195373535
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.6673088073730469
Epoch: 45, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 46 cost time: 0.6146745681762695
Epoch: 46, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 47 cost time: 0.6967651844024658
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 48 cost time: 0.6282861232757568
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 49 cost time: 0.6334078311920166
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 50 cost time: 0.6862738132476807
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 51 cost time: 0.5997257232666016
Epoch: 51, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 52 cost time: 0.5168511867523193
Epoch: 52, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 53 cost time: 0.6331405639648438
Epoch: 53, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 0.6416759490966797
Epoch: 54, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 0.6115398406982422
Epoch: 55, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 0.6714842319488525
Epoch: 56, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6530666351318359
Epoch: 57, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.629906177520752
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7529664039611816
Epoch: 59, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.6155509948730469
Epoch: 60, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.741962194442749
Epoch: 61, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.5959575176239014
Epoch: 62, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.7400169372558594
Epoch: 63, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.6105828285217285
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.6854677200317383
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 328326
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.216878652572632
Epoch: 1, Steps: 2 | Train Loss: 1.965 Vali Loss: 1.812 Vali Acc: 0.181 Test Loss: 1.812 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.5897698402404785
Epoch: 2, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.741 Vali Acc: 0.196 Test Loss: 1.741 Test Acc: 0.196
Validation loss decreased (-0.181463 --> -0.196279).  Saving model ...
Epoch: 3 cost time: 0.5520455837249756
Epoch: 3, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.678 Vali Acc: 0.207 Test Loss: 1.678 Test Acc: 0.207
Validation loss decreased (-0.196279 --> -0.207391).  Saving model ...
Epoch: 4 cost time: 0.5849144458770752
Epoch: 4, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.599 Vali Acc: 0.300 Test Loss: 1.599 Test Acc: 0.300
Validation loss decreased (-0.207391 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 0.7529141902923584
Epoch: 5, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.504 Vali Acc: 0.426 Test Loss: 1.504 Test Acc: 0.426
Validation loss decreased (-0.299984 --> -0.425911).  Saving model ...
Epoch: 6 cost time: 0.649045467376709
Epoch: 6, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.398 Vali Acc: 0.544 Test Loss: 1.398 Test Acc: 0.544
Validation loss decreased (-0.425911 --> -0.544430).  Saving model ...
Epoch: 7 cost time: 0.6469399929046631
Epoch: 7, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.286 Vali Acc: 0.644 Test Loss: 1.286 Test Acc: 0.644
Validation loss decreased (-0.544430 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 0.6099448204040527
Epoch: 8, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.172 Vali Acc: 0.719 Test Loss: 1.172 Test Acc: 0.719
Validation loss decreased (-0.644432 --> -0.718507).  Saving model ...
Epoch: 9 cost time: 0.6865596771240234
Epoch: 9, Steps: 2 | Train Loss: 1.119 Vali Loss: 1.061 Vali Acc: 0.774 Test Loss: 1.061 Test Acc: 0.774
Validation loss decreased (-0.718507 --> -0.774063).  Saving model ...
Epoch: 10 cost time: 0.6114425659179688
Epoch: 10, Steps: 2 | Train Loss: 1.100 Vali Loss: 0.956 Vali Acc: 0.819 Test Loss: 0.956 Test Acc: 0.819
Validation loss decreased (-0.774063 --> -0.818509).  Saving model ...
Epoch: 11 cost time: 0.6247446537017822
Epoch: 11, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.857 Vali Acc: 0.848 Test Loss: 0.857 Test Acc: 0.848
Validation loss decreased (-0.818509 --> -0.848140).  Saving model ...
Epoch: 12 cost time: 0.6046810150146484
Epoch: 12, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.770 Vali Acc: 0.863 Test Loss: 0.770 Test Acc: 0.863
Validation loss decreased (-0.848140 --> -0.862955).  Saving model ...
Epoch: 13 cost time: 0.6152992248535156
Epoch: 13, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.691 Vali Acc: 0.870 Test Loss: 0.691 Test Acc: 0.870
Validation loss decreased (-0.862955 --> -0.870363).  Saving model ...
Epoch: 14 cost time: 0.5842208862304688
Epoch: 14, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.621 Vali Acc: 0.881 Test Loss: 0.621 Test Acc: 0.881
Validation loss decreased (-0.870363 --> -0.881475).  Saving model ...
Epoch: 15 cost time: 0.6312460899353027
Epoch: 15, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.558 Vali Acc: 0.900 Test Loss: 0.558 Test Acc: 0.900
Validation loss decreased (-0.881475 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.5886738300323486
Epoch: 16, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.503 Vali Acc: 0.904 Test Loss: 0.503 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903699).  Saving model ...
Epoch: 17 cost time: 0.5691630840301514
Epoch: 17, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.456 Vali Acc: 0.919 Test Loss: 0.456 Test Acc: 0.919
Validation loss decreased (-0.903699 --> -0.918514).  Saving model ...
Epoch: 18 cost time: 0.6180870532989502
Epoch: 18, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.416 Vali Acc: 0.922 Test Loss: 0.416 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 19 cost time: 0.68017578125
Epoch: 19, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.380 Vali Acc: 0.930 Test Loss: 0.380 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 20 cost time: 0.5797884464263916
Epoch: 20, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.345 Vali Acc: 0.937 Test Loss: 0.345 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 21 cost time: 0.4753110408782959
Epoch: 21, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.317 Vali Acc: 0.941 Test Loss: 0.317 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 22 cost time: 0.5450515747070312
Epoch: 22, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6087055206298828
Epoch: 23, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.501713752746582
Epoch: 24, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6000359058380127
Epoch: 25, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6074700355529785
Epoch: 26, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5825555324554443
Epoch: 27, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6127111911773682
Epoch: 28, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.6291518211364746
Epoch: 29, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6203458309173584
Epoch: 30, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6242823600769043
Epoch: 31, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6178970336914062
Epoch: 32, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5638139247894287
Epoch: 33, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6206638813018799
Epoch: 34, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.6051208972930908
Epoch: 35, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.579301118850708
Epoch: 36, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6038601398468018
Epoch: 37, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5752415657043457
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.714956521987915
Epoch: 39, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6955511569976807
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.6014823913574219
Epoch: 41, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.5339362621307373
Epoch: 42, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.6074931621551514
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.6803426742553711
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.5883228778839111
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.6087720394134521
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.5089871883392334
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6046292781829834
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.5423464775085449
Epoch: 49, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7069532871246338
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 51 cost time: 0.5962197780609131
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 52 cost time: 0.6688964366912842
Epoch: 52, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 53 cost time: 0.6724059581756592
Epoch: 53, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948147).  Saving model ...
Epoch: 54 cost time: 0.6727392673492432
Epoch: 54, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 55 cost time: 0.6293666362762451
Epoch: 55, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 56 cost time: 0.6295976638793945
Epoch: 56, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6650869846343994
Epoch: 57, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6235313415527344
Epoch: 58, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6194500923156738
Epoch: 59, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.582373857498169
Epoch: 60, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.6184420585632324
Epoch: 61, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.7369427680969238
Epoch: 62, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.6715030670166016
Epoch: 63, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.5551421642303467
Epoch: 64, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.5054490566253662
Epoch: 65, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 322694
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5049142837524414
Epoch: 1, Steps: 2 | Train Loss: 2.064 Vali Loss: 1.894 Vali Acc: 0.215 Test Loss: 1.894 Test Acc: 0.215
Validation loss decreased (inf --> -0.214796).  Saving model ...
Epoch: 2 cost time: 0.8485677242279053
Epoch: 2, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.715 Vali Acc: 0.259 Test Loss: 1.715 Test Acc: 0.259
Validation loss decreased (-0.214796 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.8463397026062012
Epoch: 3, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.465 Vali Acc: 0.396 Test Loss: 1.465 Test Acc: 0.396
Validation loss decreased (-0.259242 --> -0.396282).  Saving model ...
Epoch: 4 cost time: 0.8287951946258545
Epoch: 4, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.090 Vali Acc: 0.633 Test Loss: 1.090 Test Acc: 0.633
Validation loss decreased (-0.396282 --> -0.633322).  Saving model ...
Epoch: 5 cost time: 0.8110597133636475
Epoch: 5, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.772 Vali Acc: 0.748 Test Loss: 0.772 Test Acc: 0.748
Validation loss decreased (-0.633322 --> -0.748140).  Saving model ...
Epoch: 6 cost time: 0.8482363224029541
Epoch: 6, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.529 Vali Acc: 0.915 Test Loss: 0.529 Test Acc: 0.915
Validation loss decreased (-0.748140 --> -0.914810).  Saving model ...
Epoch: 7 cost time: 0.8117799758911133
Epoch: 7, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.386 Vali Acc: 0.915 Test Loss: 0.386 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 8 cost time: 0.7838904857635498
Epoch: 8, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.302 Vali Acc: 0.915 Test Loss: 0.302 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 9 cost time: 0.8295750617980957
Epoch: 9, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 10 cost time: 0.8473715782165527
Epoch: 10, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929628).  Saving model ...
Epoch: 11 cost time: 0.896355152130127
Epoch: 11, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 12 cost time: 0.8119192123413086
Epoch: 12, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8257348537445068
Epoch: 13, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.744748592376709
Epoch: 14, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7238149642944336
Epoch: 15, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8516011238098145
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7699024677276611
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.8312551975250244
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 19 cost time: 0.9543862342834473
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 20 cost time: 0.8245711326599121
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.933332 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.939805269241333
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7519505023956299
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7082962989807129
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9240620136260986
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9133789539337158
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.886063814163208
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9029953479766846
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8694722652435303
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8231725692749023
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8878047466278076
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 449606
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2942373752593994
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.779 Vali Acc: 0.159 Test Loss: 1.779 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 0.8319618701934814
Epoch: 2, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.672 Vali Acc: 0.252 Test Loss: 1.672 Test Acc: 0.252
Validation loss decreased (-0.159241 --> -0.251835).  Saving model ...
Epoch: 3 cost time: 0.6961338520050049
Epoch: 3, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.535 Vali Acc: 0.393 Test Loss: 1.535 Test Acc: 0.393
Validation loss decreased (-0.251835 --> -0.392577).  Saving model ...
Epoch: 4 cost time: 0.7523863315582275
Epoch: 4, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.327 Vali Acc: 0.544 Test Loss: 1.327 Test Acc: 0.544
Validation loss decreased (-0.392577 --> -0.544431).  Saving model ...
Epoch: 5 cost time: 0.7242751121520996
Epoch: 5, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.102 Vali Acc: 0.681 Test Loss: 1.102 Test Acc: 0.681
Validation loss decreased (-0.544431 --> -0.681470).  Saving model ...
Epoch: 6 cost time: 0.7614784240722656
Epoch: 6, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.894 Vali Acc: 0.741 Test Loss: 0.894 Test Acc: 0.741
Validation loss decreased (-0.681470 --> -0.740732).  Saving model ...
Epoch: 7 cost time: 0.7877380847930908
Epoch: 7, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
Validation loss decreased (-0.740732 --> -0.788882).  Saving model ...
Epoch: 8 cost time: 0.682835578918457
Epoch: 8, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
Validation loss decreased (-0.788882 --> -0.840735).  Saving model ...
Epoch: 9 cost time: 0.7513697147369385
Epoch: 9, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.476 Vali Acc: 0.904 Test Loss: 0.476 Test Acc: 0.904
Validation loss decreased (-0.840735 --> -0.903699).  Saving model ...
Epoch: 10 cost time: 0.8601527214050293
Epoch: 10, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.395 Vali Acc: 0.919 Test Loss: 0.395 Test Acc: 0.919
Validation loss decreased (-0.903699 --> -0.918515).  Saving model ...
Epoch: 11 cost time: 0.9075701236724854
Epoch: 11, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.340 Vali Acc: 0.904 Test Loss: 0.340 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7693920135498047
Epoch: 12, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.301 Vali Acc: 0.907 Test Loss: 0.301 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.818622350692749
Epoch: 13, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.284 Vali Acc: 0.907 Test Loss: 0.284 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7800941467285156
Epoch: 14, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.241 Vali Acc: 0.907 Test Loss: 0.241 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8304839134216309
Epoch: 15, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.918515 --> -0.948146).  Saving model ...
Epoch: 16 cost time: 0.820936918258667
Epoch: 16, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7700128555297852
Epoch: 17, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7206358909606934
Epoch: 18, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7141995429992676
Epoch: 19, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7862982749938965
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.926 Test Loss: 0.184 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9134471416473389
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8847277164459229
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.926 Test Loss: 0.194 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8550198078155518
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8108248710632324
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8375556468963623
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 348486
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5582337379455566
Epoch: 1, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.672 Vali Acc: 0.230 Test Loss: 1.672 Test Acc: 0.230
Validation loss decreased (inf --> -0.229613).  Saving model ...
Epoch: 2 cost time: 0.7082364559173584
Epoch: 2, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.577 Vali Acc: 0.296 Test Loss: 1.577 Test Acc: 0.296
Validation loss decreased (-0.229613 --> -0.296281).  Saving model ...
Epoch: 3 cost time: 0.7244172096252441
Epoch: 3, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.473 Vali Acc: 0.456 Test Loss: 1.473 Test Acc: 0.456
Validation loss decreased (-0.296281 --> -0.455541).  Saving model ...
Epoch: 4 cost time: 0.6898374557495117
Epoch: 4, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.320 Vali Acc: 0.637 Test Loss: 1.320 Test Acc: 0.637
Validation loss decreased (-0.455541 --> -0.637024).  Saving model ...
Epoch: 5 cost time: 0.6470382213592529
Epoch: 5, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.145 Vali Acc: 0.693 Test Loss: 1.145 Test Acc: 0.693
Validation loss decreased (-0.637024 --> -0.692581).  Saving model ...
Epoch: 6 cost time: 0.7301816940307617
Epoch: 6, Steps: 2 | Train Loss: 1.038 Vali Loss: 0.979 Vali Acc: 0.696 Test Loss: 0.979 Test Acc: 0.696
Validation loss decreased (-0.692581 --> -0.696287).  Saving model ...
Epoch: 7 cost time: 0.6946835517883301
Epoch: 7, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.836 Vali Acc: 0.722 Test Loss: 0.836 Test Acc: 0.722
Validation loss decreased (-0.696287 --> -0.722214).  Saving model ...
Epoch: 8 cost time: 0.6351280212402344
Epoch: 8, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.707 Vali Acc: 0.744 Test Loss: 0.707 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744437).  Saving model ...
Epoch: 9 cost time: 0.7294833660125732
Epoch: 9, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.593 Vali Acc: 0.811 Test Loss: 0.593 Test Acc: 0.811
Validation loss decreased (-0.744437 --> -0.811105).  Saving model ...
Epoch: 10 cost time: 0.7468292713165283
Epoch: 10, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
Validation loss decreased (-0.811105 --> -0.888884).  Saving model ...
Epoch: 11 cost time: 0.7389712333679199
Epoch: 11, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.402 Vali Acc: 0.937 Test Loss: 0.402 Test Acc: 0.937
Validation loss decreased (-0.888884 --> -0.937033).  Saving model ...
Epoch: 12 cost time: 0.8032379150390625
Epoch: 12, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.347 Vali Acc: 0.937 Test Loss: 0.347 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 13 cost time: 0.6279973983764648
Epoch: 13, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 14 cost time: 0.6639325618743896
Epoch: 14, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7701153755187988
Epoch: 15, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7390949726104736
Epoch: 16, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6930553913116455
Epoch: 17, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.6369132995605469
Epoch: 18, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.6820492744445801
Epoch: 19, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.6619424819946289
Epoch: 20, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.6575992107391357
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 22 cost time: 0.6615467071533203
Epoch: 22, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.948 Test Loss: 0.157 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7157163619995117
Epoch: 23, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7667009830474854
Epoch: 24, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.941 Test Loss: 0.157 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7037911415100098
Epoch: 25, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7060105800628662
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.937 Test Loss: 0.160 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6876945495605469
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7240569591522217
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.933 Test Loss: 0.161 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7592372894287109
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.933 Test Loss: 0.162 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7291133403778076
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.933 Test Loss: 0.163 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7299056053161621
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.933 Test Loss: 0.164 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 317894
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3129043579101562
Epoch: 1, Steps: 2 | Train Loss: 1.961 Vali Loss: 2.026 Vali Acc: 0.300 Test Loss: 2.026 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 0.7575662136077881
Epoch: 2, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.891 Vali Acc: 0.304 Test Loss: 1.891 Test Acc: 0.304
Validation loss decreased (-0.299980 --> -0.303685).  Saving model ...
Epoch: 3 cost time: 0.6153764724731445
Epoch: 3, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.762 Vali Acc: 0.315 Test Loss: 1.762 Test Acc: 0.315
Validation loss decreased (-0.303685 --> -0.314797).  Saving model ...
Epoch: 4 cost time: 0.7411520481109619
Epoch: 4, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.595 Vali Acc: 0.326 Test Loss: 1.595 Test Acc: 0.326
Validation loss decreased (-0.314797 --> -0.325910).  Saving model ...
Epoch: 5 cost time: 0.6734163761138916
Epoch: 5, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.408 Vali Acc: 0.463 Test Loss: 1.408 Test Acc: 0.463
Validation loss decreased (-0.325910 --> -0.462949).  Saving model ...
Epoch: 6 cost time: 0.7609426975250244
Epoch: 6, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.219 Vali Acc: 0.641 Test Loss: 1.219 Test Acc: 0.641
Validation loss decreased (-0.462949 --> -0.640729).  Saving model ...
Epoch: 7 cost time: 0.775153398513794
Epoch: 7, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.047 Vali Acc: 0.726 Test Loss: 1.047 Test Acc: 0.726
Validation loss decreased (-0.640729 --> -0.725915).  Saving model ...
Epoch: 8 cost time: 0.705939769744873
Epoch: 8, Steps: 2 | Train Loss: 0.951 Vali Loss: 0.891 Vali Acc: 0.822 Test Loss: 0.891 Test Acc: 0.822
Validation loss decreased (-0.725915 --> -0.822213).  Saving model ...
Epoch: 9 cost time: 0.7563810348510742
Epoch: 9, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.760 Vali Acc: 0.881 Test Loss: 0.760 Test Acc: 0.881
Validation loss decreased (-0.822213 --> -0.881474).  Saving model ...
Epoch: 10 cost time: 0.6601979732513428
Epoch: 10, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.648 Vali Acc: 0.926 Test Loss: 0.648 Test Acc: 0.926
Validation loss decreased (-0.881474 --> -0.925919).  Saving model ...
Epoch: 11 cost time: 0.7447018623352051
Epoch: 11, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.554 Vali Acc: 0.930 Test Loss: 0.554 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929624).  Saving model ...
Epoch: 12 cost time: 0.7042021751403809
Epoch: 12, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.474 Vali Acc: 0.944 Test Loss: 0.474 Test Acc: 0.944
Validation loss decreased (-0.929624 --> -0.944440).  Saving model ...
Epoch: 13 cost time: 0.804995059967041
Epoch: 13, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.405 Vali Acc: 0.948 Test Loss: 0.405 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 14 cost time: 0.8276684284210205
Epoch: 14, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.349 Vali Acc: 0.952 Test Loss: 0.349 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 15 cost time: 0.7053873538970947
Epoch: 15, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.305 Vali Acc: 0.948 Test Loss: 0.305 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7659869194030762
Epoch: 16, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7381033897399902
Epoch: 17, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7652106285095215
Epoch: 18, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8378939628601074
Epoch: 19, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8107035160064697
Epoch: 20, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6847720146179199
Epoch: 21, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6517994403839111
Epoch: 22, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7531507015228271
Epoch: 23, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.7080502510070801
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.7352585792541504
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.7643411159515381
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.8117296695709229
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.6952412128448486
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.7303874492645264
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.73195481300354
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7525529861450195
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7758336067199707
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7328953742980957
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.7544806003570557
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.7276272773742676
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6823196411132812
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7288415431976318
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7276968955993652
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7461340427398682
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7725529670715332
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7016279697418213
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7425737380981445
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7340002059936523
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7727277278900146
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 299718
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2115824222564697
Epoch: 1, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.754 Vali Acc: 0.326 Test Loss: 1.754 Test Acc: 0.326
Validation loss decreased (inf --> -0.325908).  Saving model ...
Epoch: 2 cost time: 0.5719625949859619
Epoch: 2, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.677 Vali Acc: 0.344 Test Loss: 1.677 Test Acc: 0.344
Validation loss decreased (-0.325908 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 0.6243407726287842
Epoch: 3, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.598 Vali Acc: 0.352 Test Loss: 1.598 Test Acc: 0.352
Validation loss decreased (-0.344428 --> -0.351836).  Saving model ...
Epoch: 4 cost time: 0.6524343490600586
Epoch: 4, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.488 Vali Acc: 0.378 Test Loss: 1.488 Test Acc: 0.378
Validation loss decreased (-0.351836 --> -0.377763).  Saving model ...
Epoch: 5 cost time: 0.6743407249450684
Epoch: 5, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.357 Vali Acc: 0.493 Test Loss: 1.357 Test Acc: 0.493
Validation loss decreased (-0.377763 --> -0.492579).  Saving model ...
Epoch: 6 cost time: 0.6533818244934082
Epoch: 6, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.215 Vali Acc: 0.619 Test Loss: 1.215 Test Acc: 0.619
Validation loss decreased (-0.492579 --> -0.618506).  Saving model ...
Epoch: 7 cost time: 0.6970374584197998
Epoch: 7, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.072 Vali Acc: 0.741 Test Loss: 1.072 Test Acc: 0.741
Validation loss decreased (-0.618506 --> -0.740730).  Saving model ...
Epoch: 8 cost time: 0.7075881958007812
Epoch: 8, Steps: 2 | Train Loss: 0.921 Vali Loss: 0.938 Vali Acc: 0.837 Test Loss: 0.938 Test Acc: 0.837
Validation loss decreased (-0.740730 --> -0.837028).  Saving model ...
Epoch: 9 cost time: 0.6590409278869629
Epoch: 9, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.817 Vali Acc: 0.863 Test Loss: 0.817 Test Acc: 0.863
Validation loss decreased (-0.837028 --> -0.862955).  Saving model ...
Epoch: 10 cost time: 0.6747329235076904
Epoch: 10, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.710 Vali Acc: 0.893 Test Loss: 0.710 Test Acc: 0.893
Validation loss decreased (-0.862955 --> -0.892585).  Saving model ...
Epoch: 11 cost time: 0.5586285591125488
Epoch: 11, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.617 Vali Acc: 0.911 Test Loss: 0.617 Test Acc: 0.911
Validation loss decreased (-0.892585 --> -0.911105).  Saving model ...
Epoch: 12 cost time: 0.6572134494781494
Epoch: 12, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.537 Vali Acc: 0.904 Test Loss: 0.537 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7070755958557129
Epoch: 13, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.470 Vali Acc: 0.919 Test Loss: 0.470 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918514).  Saving model ...
Epoch: 14 cost time: 0.6823821067810059
Epoch: 14, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.416 Vali Acc: 0.919 Test Loss: 0.416 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 15 cost time: 0.6814818382263184
Epoch: 15, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.371 Vali Acc: 0.922 Test Loss: 0.371 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922219).  Saving model ...
Epoch: 16 cost time: 0.6398782730102539
Epoch: 16, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.331 Vali Acc: 0.937 Test Loss: 0.331 Test Acc: 0.937
Validation loss decreased (-0.922219 --> -0.937034).  Saving model ...
Epoch: 17 cost time: 0.6436171531677246
Epoch: 17, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.614661693572998
Epoch: 18, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.267 Vali Acc: 0.948 Test Loss: 0.267 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 19 cost time: 0.6653528213500977
Epoch: 19, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.244 Vali Acc: 0.952 Test Loss: 0.244 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 20 cost time: 0.6199884414672852
Epoch: 20, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.6814742088317871
Epoch: 21, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.7099399566650391
Epoch: 22, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6659841537475586
Epoch: 23, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.7251737117767334
Epoch: 24, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.6507465839385986
Epoch: 25, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5596802234649658
Epoch: 26, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6583292484283447
Epoch: 27, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6301853656768799
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7112133502960205
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6863548755645752
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6252884864807129
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7154955863952637
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6982953548431396
Epoch: 33, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5497651100158691
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 290886
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.236980676651001
Epoch: 1, Steps: 2 | Train Loss: 2.257 Vali Loss: 2.082 Vali Acc: 0.044 Test Loss: 2.082 Test Acc: 0.044
Validation loss decreased (inf --> -0.044424).  Saving model ...
Epoch: 2 cost time: 0.6458945274353027
Epoch: 2, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.995 Vali Acc: 0.044 Test Loss: 1.995 Test Acc: 0.044
Validation loss decreased (-0.044424 --> -0.044424).  Saving model ...
Epoch: 3 cost time: 0.6058096885681152
Epoch: 3, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.910 Vali Acc: 0.067 Test Loss: 1.910 Test Acc: 0.067
Validation loss decreased (-0.044424 --> -0.066648).  Saving model ...
Epoch: 4 cost time: 0.6214907169342041
Epoch: 4, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.801 Vali Acc: 0.104 Test Loss: 1.801 Test Acc: 0.104
Validation loss decreased (-0.066648 --> -0.103686).  Saving model ...
Epoch: 5 cost time: 0.6683440208435059
Epoch: 5, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.666 Vali Acc: 0.241 Test Loss: 1.666 Test Acc: 0.241
Validation loss decreased (-0.103686 --> -0.240724).  Saving model ...
Epoch: 6 cost time: 0.5936803817749023
Epoch: 6, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.518 Vali Acc: 0.478 Test Loss: 1.518 Test Acc: 0.478
Validation loss decreased (-0.240724 --> -0.477763).  Saving model ...
Epoch: 7 cost time: 0.6040389537811279
Epoch: 7, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.363 Vali Acc: 0.570 Test Loss: 1.363 Test Acc: 0.570
Validation loss decreased (-0.477763 --> -0.570357).  Saving model ...
Epoch: 8 cost time: 0.5893533229827881
Epoch: 8, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.212 Vali Acc: 0.656 Test Loss: 1.212 Test Acc: 0.656
Validation loss decreased (-0.570357 --> -0.655543).  Saving model ...
Epoch: 9 cost time: 0.731633186340332
Epoch: 9, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.070 Vali Acc: 0.726 Test Loss: 1.070 Test Acc: 0.726
Validation loss decreased (-0.655543 --> -0.725915).  Saving model ...
Epoch: 10 cost time: 0.667151689529419
Epoch: 10, Steps: 2 | Train Loss: 0.917 Vali Loss: 0.941 Vali Acc: 0.774 Test Loss: 0.941 Test Acc: 0.774
Validation loss decreased (-0.725915 --> -0.774065).  Saving model ...
Epoch: 11 cost time: 0.6426665782928467
Epoch: 11, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.823 Vali Acc: 0.789 Test Loss: 0.823 Test Acc: 0.789
Validation loss decreased (-0.774065 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 0.624915599822998
Epoch: 12, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.718 Vali Acc: 0.826 Test Loss: 0.718 Test Acc: 0.826
Validation loss decreased (-0.788881 --> -0.825919).  Saving model ...
Epoch: 13 cost time: 0.6396567821502686
Epoch: 13, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.629 Vali Acc: 0.848 Test Loss: 0.629 Test Acc: 0.848
Validation loss decreased (-0.825919 --> -0.848142).  Saving model ...
Epoch: 14 cost time: 0.6967945098876953
Epoch: 14, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.557 Vali Acc: 0.870 Test Loss: 0.557 Test Acc: 0.870
Validation loss decreased (-0.848142 --> -0.870365).  Saving model ...
Epoch: 15 cost time: 0.7146956920623779
Epoch: 15, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.497 Vali Acc: 0.878 Test Loss: 0.497 Test Acc: 0.878
Validation loss decreased (-0.870365 --> -0.877773).  Saving model ...
Epoch: 16 cost time: 0.6553225517272949
Epoch: 16, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.447 Vali Acc: 0.878 Test Loss: 0.447 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 17 cost time: 0.7350175380706787
Epoch: 17, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.402 Vali Acc: 0.881 Test Loss: 0.402 Test Acc: 0.881
Validation loss decreased (-0.877773 --> -0.881477).  Saving model ...
Epoch: 18 cost time: 0.6153664588928223
Epoch: 18, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.364 Vali Acc: 0.896 Test Loss: 0.364 Test Acc: 0.896
Validation loss decreased (-0.881477 --> -0.896293).  Saving model ...
Epoch: 19 cost time: 0.6280391216278076
Epoch: 19, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.333 Vali Acc: 0.904 Test Loss: 0.333 Test Acc: 0.904
Validation loss decreased (-0.896293 --> -0.903700).  Saving model ...
Epoch: 20 cost time: 0.6245520114898682
Epoch: 20, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.310 Vali Acc: 0.907 Test Loss: 0.310 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 21 cost time: 0.5941572189331055
Epoch: 21, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
Validation loss decreased (-0.907404 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.6205775737762451
Epoch: 22, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.6404902935028076
Epoch: 23, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 24 cost time: 0.579495906829834
Epoch: 24, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 25 cost time: 0.6090741157531738
Epoch: 25, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 26 cost time: 0.5887975692749023
Epoch: 26, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.5397777557373047
Epoch: 27, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.5235931873321533
Epoch: 28, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.5716192722320557
Epoch: 29, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6098484992980957
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.5391273498535156
Epoch: 31, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6375555992126465
Epoch: 32, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6037421226501465
Epoch: 33, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6297409534454346
Epoch: 34, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6401479244232178
Epoch: 35, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6096405982971191
Epoch: 36, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5731995105743408
Epoch: 37, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5234694480895996
Epoch: 38, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6001019477844238
Epoch: 39, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6750915050506592
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 278982
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4665122032165527
Epoch: 1, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.657 Vali Acc: 0.204 Test Loss: 1.657 Test Acc: 0.204
Validation loss decreased (inf --> -0.203687).  Saving model ...
Epoch: 2 cost time: 0.576740026473999
Epoch: 2, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.595 Vali Acc: 0.285 Test Loss: 1.595 Test Acc: 0.285
Validation loss decreased (-0.203687 --> -0.285169).  Saving model ...
Epoch: 3 cost time: 0.597285270690918
Epoch: 3, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.537 Vali Acc: 0.333 Test Loss: 1.537 Test Acc: 0.333
Validation loss decreased (-0.285169 --> -0.333318).  Saving model ...
Epoch: 4 cost time: 0.6373040676116943
Epoch: 4, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.469 Vali Acc: 0.378 Test Loss: 1.469 Test Acc: 0.378
Validation loss decreased (-0.333318 --> -0.377763).  Saving model ...
Epoch: 5 cost time: 0.5955369472503662
Epoch: 5, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.452 Test Loss: 1.386 Test Acc: 0.452
Validation loss decreased (-0.377763 --> -0.451838).  Saving model ...
Epoch: 6 cost time: 0.6192927360534668
Epoch: 6, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.293 Vali Acc: 0.522 Test Loss: 1.293 Test Acc: 0.522
Validation loss decreased (-0.451838 --> -0.522209).  Saving model ...
Epoch: 7 cost time: 0.6962006092071533
Epoch: 7, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.194 Vali Acc: 0.596 Test Loss: 1.194 Test Acc: 0.596
Validation loss decreased (-0.522209 --> -0.596284).  Saving model ...
Epoch: 8 cost time: 0.6180629730224609
Epoch: 8, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.092 Vali Acc: 0.652 Test Loss: 1.092 Test Acc: 0.652
Validation loss decreased (-0.596284 --> -0.651841).  Saving model ...
Epoch: 9 cost time: 0.568774938583374
Epoch: 9, Steps: 2 | Train Loss: 1.162 Vali Loss: 0.992 Vali Acc: 0.733 Test Loss: 0.992 Test Acc: 0.733
Validation loss decreased (-0.651841 --> -0.733323).  Saving model ...
Epoch: 10 cost time: 0.6340451240539551
Epoch: 10, Steps: 2 | Train Loss: 0.927 Vali Loss: 0.897 Vali Acc: 0.796 Test Loss: 0.897 Test Acc: 0.796
Validation loss decreased (-0.733323 --> -0.796287).  Saving model ...
Epoch: 11 cost time: 0.6520450115203857
Epoch: 11, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.811 Vali Acc: 0.833 Test Loss: 0.811 Test Acc: 0.833
Validation loss decreased (-0.796287 --> -0.833325).  Saving model ...
Epoch: 12 cost time: 0.5630016326904297
Epoch: 12, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.731 Vali Acc: 0.859 Test Loss: 0.731 Test Acc: 0.859
Validation loss decreased (-0.833325 --> -0.859252).  Saving model ...
Epoch: 13 cost time: 0.6865615844726562
Epoch: 13, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.661 Vali Acc: 0.870 Test Loss: 0.661 Test Acc: 0.870
Validation loss decreased (-0.859252 --> -0.870364).  Saving model ...
Epoch: 14 cost time: 0.6886000633239746
Epoch: 14, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.596 Vali Acc: 0.893 Test Loss: 0.596 Test Acc: 0.893
Validation loss decreased (-0.870364 --> -0.892587).  Saving model ...
Epoch: 15 cost time: 0.6283810138702393
Epoch: 15, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.5460004806518555
Epoch: 16, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.488 Vali Acc: 0.919 Test Loss: 0.488 Test Acc: 0.919
Validation loss decreased (-0.899995 --> -0.918514).  Saving model ...
Epoch: 17 cost time: 0.593862771987915
Epoch: 17, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.442 Vali Acc: 0.930 Test Loss: 0.442 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929625).  Saving model ...
Epoch: 18 cost time: 0.6397497653961182
Epoch: 18, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.401 Vali Acc: 0.944 Test Loss: 0.401 Test Acc: 0.944
Validation loss decreased (-0.929625 --> -0.944440).  Saving model ...
Epoch: 19 cost time: 0.6768815517425537
Epoch: 19, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.366 Vali Acc: 0.952 Test Loss: 0.366 Test Acc: 0.952
Validation loss decreased (-0.944440 --> -0.951848).  Saving model ...
Epoch: 20 cost time: 0.6082086563110352
Epoch: 20, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.337 Vali Acc: 0.944 Test Loss: 0.337 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.610187292098999
Epoch: 21, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.314 Vali Acc: 0.937 Test Loss: 0.314 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6071186065673828
Epoch: 22, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6333155632019043
Epoch: 23, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5746078491210938
Epoch: 24, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.256 Vali Acc: 0.952 Test Loss: 0.256 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 25 cost time: 0.5780210494995117
Epoch: 25, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.242 Vali Acc: 0.952 Test Loss: 0.242 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 26 cost time: 0.5403048992156982
Epoch: 26, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.229 Vali Acc: 0.956 Test Loss: 0.229 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 0.6016464233398438
Epoch: 27, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.6815803050994873
Epoch: 28, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 0.666440486907959
Epoch: 29, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.626154899597168
Epoch: 30, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6509864330291748
Epoch: 31, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6436254978179932
Epoch: 32, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6266794204711914
Epoch: 33, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6993436813354492
Epoch: 34, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.668109655380249
Epoch: 35, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.575110673904419
Epoch: 36, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6544528007507324
Epoch: 37, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5832953453063965
Epoch: 38, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm128_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 273350
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.507922887802124
Epoch: 1, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.702 Vali Acc: 0.344 Test Loss: 1.702 Test Acc: 0.344
Validation loss decreased (inf --> -0.344427).  Saving model ...
Epoch: 2 cost time: 0.7809638977050781
Epoch: 2, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.586 Vali Acc: 0.422 Test Loss: 1.586 Test Acc: 0.422
Validation loss decreased (-0.344427 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 0.8009729385375977
Epoch: 3, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.444 Vali Acc: 0.522 Test Loss: 1.444 Test Acc: 0.522
Validation loss decreased (-0.422206 --> -0.522208).  Saving model ...
Epoch: 4 cost time: 0.8184895515441895
Epoch: 4, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.233 Vali Acc: 0.622 Test Loss: 1.233 Test Acc: 0.622
Validation loss decreased (-0.522208 --> -0.622210).  Saving model ...
Epoch: 5 cost time: 0.8482611179351807
Epoch: 5, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.018 Vali Acc: 0.704 Test Loss: 1.018 Test Acc: 0.704
Validation loss decreased (-0.622210 --> -0.703694).  Saving model ...
Epoch: 6 cost time: 0.834343433380127
Epoch: 6, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.823 Vali Acc: 0.756 Test Loss: 0.823 Test Acc: 0.756
Validation loss decreased (-0.703694 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 0.761629581451416
Epoch: 7, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.661 Vali Acc: 0.793 Test Loss: 0.661 Test Acc: 0.793
Validation loss decreased (-0.755547 --> -0.792586).  Saving model ...
Epoch: 8 cost time: 0.7913186550140381
Epoch: 8, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.525 Vali Acc: 0.881 Test Loss: 0.525 Test Acc: 0.881
Validation loss decreased (-0.792586 --> -0.881476).  Saving model ...
Epoch: 9 cost time: 0.921558141708374
Epoch: 9, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.434 Vali Acc: 0.907 Test Loss: 0.434 Test Acc: 0.907
Validation loss decreased (-0.881476 --> -0.907403).  Saving model ...
Epoch: 10 cost time: 0.7680416107177734
Epoch: 10, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.362 Vali Acc: 0.919 Test Loss: 0.362 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918515).  Saving model ...
Epoch: 11 cost time: 0.9279932975769043
Epoch: 11, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
Validation loss decreased (-0.918515 --> -0.929627).  Saving model ...
Epoch: 12 cost time: 0.8170158863067627
Epoch: 12, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.270 Vali Acc: 0.930 Test Loss: 0.270 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 13 cost time: 0.8559987545013428
Epoch: 13, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 14 cost time: 0.7707891464233398
Epoch: 14, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8853321075439453
Epoch: 15, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.758913516998291
Epoch: 16, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7727110385894775
Epoch: 17, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8842079639434814
Epoch: 18, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.8400108814239502
Epoch: 19, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.7389798164367676
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.8554258346557617
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.8623948097229004
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.9083573818206787
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9445803165435791
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8928649425506592
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.810096025466919
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7907364368438721
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8469500541687012
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8653631210327148
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8609364032745361
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.886970043182373
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8234226703643799
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 250054
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.427313804626465
Epoch: 1, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.628 Vali Acc: 0.304 Test Loss: 1.628 Test Acc: 0.304
Validation loss decreased (inf --> -0.303687).  Saving model ...
Epoch: 2 cost time: 0.8255512714385986
Epoch: 2, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.532 Vali Acc: 0.381 Test Loss: 1.532 Test Acc: 0.381
Validation loss decreased (-0.303687 --> -0.381466).  Saving model ...
Epoch: 3 cost time: 0.6813554763793945
Epoch: 3, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.435 Vali Acc: 0.507 Test Loss: 1.435 Test Acc: 0.507
Validation loss decreased (-0.381466 --> -0.507393).  Saving model ...
Epoch: 4 cost time: 0.7635276317596436
Epoch: 4, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.308 Vali Acc: 0.633 Test Loss: 1.308 Test Acc: 0.633
Validation loss decreased (-0.507393 --> -0.633320).  Saving model ...
Epoch: 5 cost time: 0.7755870819091797
Epoch: 5, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.159 Vali Acc: 0.689 Test Loss: 1.159 Test Acc: 0.689
Validation loss decreased (-0.633320 --> -0.688877).  Saving model ...
Epoch: 6 cost time: 0.727069616317749
Epoch: 6, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.007 Vali Acc: 0.737 Test Loss: 1.007 Test Acc: 0.737
Validation loss decreased (-0.688877 --> -0.737027).  Saving model ...
Epoch: 7 cost time: 0.7853002548217773
Epoch: 7, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.737027 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.6897211074829102
Epoch: 8, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.731 Vali Acc: 0.859 Test Loss: 0.731 Test Acc: 0.859
Validation loss decreased (-0.799991 --> -0.859252).  Saving model ...
Epoch: 9 cost time: 0.767991304397583
Epoch: 9, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.623 Vali Acc: 0.904 Test Loss: 0.623 Test Acc: 0.904
Validation loss decreased (-0.859252 --> -0.903697).  Saving model ...
Epoch: 10 cost time: 0.7601370811462402
Epoch: 10, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.536 Vali Acc: 0.919 Test Loss: 0.536 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918513).  Saving model ...
Epoch: 11 cost time: 0.8023147583007812
Epoch: 11, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.465 Vali Acc: 0.915 Test Loss: 0.465 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6759862899780273
Epoch: 12, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.407 Vali Acc: 0.919 Test Loss: 0.407 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 13 cost time: 0.6806385517120361
Epoch: 13, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929626).  Saving model ...
Epoch: 14 cost time: 0.8384041786193848
Epoch: 14, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.316 Vali Acc: 0.933 Test Loss: 0.316 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 15 cost time: 0.7868657112121582
Epoch: 15, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7907752990722656
Epoch: 16, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7222683429718018
Epoch: 17, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
Validation loss decreased (-0.933330 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.7258217334747314
Epoch: 18, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7238614559173584
Epoch: 19, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7463183403015137
Epoch: 20, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7697649002075195
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7321465015411377
Epoch: 22, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6843645572662354
Epoch: 23, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8163256645202637
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7808341979980469
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7043447494506836
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7249143123626709
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 199494
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2252421379089355
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.675 Vali Acc: 0.337 Test Loss: 1.675 Test Acc: 0.337
Validation loss decreased (inf --> -0.337020).  Saving model ...
Epoch: 2 cost time: 0.573718786239624
Epoch: 2, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.603 Vali Acc: 0.370 Test Loss: 1.603 Test Acc: 0.370
Validation loss decreased (-0.337020 --> -0.370354).  Saving model ...
Epoch: 3 cost time: 0.5966718196868896
Epoch: 3, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.530 Vali Acc: 0.419 Test Loss: 1.530 Test Acc: 0.419
Validation loss decreased (-0.370354 --> -0.418503).  Saving model ...
Epoch: 4 cost time: 0.6676561832427979
Epoch: 4, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.431 Vali Acc: 0.519 Test Loss: 1.431 Test Acc: 0.519
Validation loss decreased (-0.418503 --> -0.518504).  Saving model ...
Epoch: 5 cost time: 0.6905496120452881
Epoch: 5, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.311 Vali Acc: 0.678 Test Loss: 1.311 Test Acc: 0.678
Validation loss decreased (-0.518504 --> -0.677765).  Saving model ...
Epoch: 6 cost time: 0.6218109130859375
Epoch: 6, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.179 Vali Acc: 0.804 Test Loss: 1.179 Test Acc: 0.804
Validation loss decreased (-0.677765 --> -0.803692).  Saving model ...
Epoch: 7 cost time: 0.5334692001342773
Epoch: 7, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.043 Vali Acc: 0.844 Test Loss: 1.043 Test Acc: 0.844
Validation loss decreased (-0.803692 --> -0.844434).  Saving model ...
Epoch: 8 cost time: 0.597722053527832
Epoch: 8, Steps: 2 | Train Loss: 1.042 Vali Loss: 0.915 Vali Acc: 0.874 Test Loss: 0.915 Test Acc: 0.874
Validation loss decreased (-0.844434 --> -0.874065).  Saving model ...
Epoch: 9 cost time: 0.6355242729187012
Epoch: 9, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.800 Vali Acc: 0.881 Test Loss: 0.800 Test Acc: 0.881
Validation loss decreased (-0.874065 --> -0.881473).  Saving model ...
Epoch: 10 cost time: 0.5651581287384033
Epoch: 10, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.700 Vali Acc: 0.885 Test Loss: 0.700 Test Acc: 0.885
Validation loss decreased (-0.881473 --> -0.885178).  Saving model ...
Epoch: 11 cost time: 0.5236215591430664
Epoch: 11, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.612 Vali Acc: 0.907 Test Loss: 0.612 Test Acc: 0.907
Validation loss decreased (-0.885178 --> -0.907401).  Saving model ...
Epoch: 12 cost time: 0.6064701080322266
Epoch: 12, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.533 Vali Acc: 0.919 Test Loss: 0.533 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 13 cost time: 0.5657916069030762
Epoch: 13, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.467 Vali Acc: 0.933 Test Loss: 0.467 Test Acc: 0.933
Validation loss decreased (-0.918513 --> -0.933329).  Saving model ...
Epoch: 14 cost time: 0.5880553722381592
Epoch: 14, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.413 Vali Acc: 0.930 Test Loss: 0.413 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6003940105438232
Epoch: 15, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.368 Vali Acc: 0.937 Test Loss: 0.368 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 16 cost time: 0.590461015701294
Epoch: 16, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.329 Vali Acc: 0.941 Test Loss: 0.329 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 17 cost time: 0.6135950088500977
Epoch: 17, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.298 Vali Acc: 0.948 Test Loss: 0.298 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 18 cost time: 0.7334036827087402
Epoch: 18, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.271 Vali Acc: 0.956 Test Loss: 0.271 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955553).  Saving model ...
Epoch: 19 cost time: 0.5750625133514404
Epoch: 19, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.627619743347168
Epoch: 20, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5593760013580322
Epoch: 21, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.610020637512207
Epoch: 22, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6623272895812988
Epoch: 23, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6444110870361328
Epoch: 24, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5730879306793213
Epoch: 25, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6491968631744385
Epoch: 26, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6728665828704834
Epoch: 27, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6436336040496826
Epoch: 28, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 184198
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.281062126159668
Epoch: 1, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.877 Vali Acc: 0.126 Test Loss: 1.877 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 0.566002607345581
Epoch: 2, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.809 Vali Acc: 0.130 Test Loss: 1.809 Test Acc: 0.130
Validation loss decreased (-0.125907 --> -0.129612).  Saving model ...
Epoch: 3 cost time: 0.6557326316833496
Epoch: 3, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.744 Vali Acc: 0.126 Test Loss: 1.744 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5324318408966064
Epoch: 4, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.663 Vali Acc: 0.152 Test Loss: 1.663 Test Acc: 0.152
Validation loss decreased (-0.129612 --> -0.151835).  Saving model ...
Epoch: 5 cost time: 0.6156463623046875
Epoch: 5, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.562 Vali Acc: 0.200 Test Loss: 1.562 Test Acc: 0.200
Validation loss decreased (-0.151835 --> -0.199984).  Saving model ...
Epoch: 6 cost time: 0.6205089092254639
Epoch: 6, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.448 Vali Acc: 0.337 Test Loss: 1.448 Test Acc: 0.337
Validation loss decreased (-0.199984 --> -0.337023).  Saving model ...
Epoch: 7 cost time: 0.6225085258483887
Epoch: 7, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.326 Vali Acc: 0.541 Test Loss: 1.326 Test Acc: 0.541
Validation loss decreased (-0.337023 --> -0.540727).  Saving model ...
Epoch: 8 cost time: 0.6593196392059326
Epoch: 8, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.204 Vali Acc: 0.619 Test Loss: 1.204 Test Acc: 0.619
Validation loss decreased (-0.540727 --> -0.618506).  Saving model ...
Epoch: 9 cost time: 0.5635924339294434
Epoch: 9, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.089 Vali Acc: 0.667 Test Loss: 1.089 Test Acc: 0.667
Validation loss decreased (-0.618506 --> -0.666656).  Saving model ...
Epoch: 10 cost time: 0.7043812274932861
Epoch: 10, Steps: 2 | Train Loss: 0.978 Vali Loss: 0.983 Vali Acc: 0.715 Test Loss: 0.983 Test Acc: 0.715
Validation loss decreased (-0.666656 --> -0.714805).  Saving model ...
Epoch: 11 cost time: 0.6021289825439453
Epoch: 11, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.885 Vali Acc: 0.770 Test Loss: 0.885 Test Acc: 0.770
Validation loss decreased (-0.714805 --> -0.770362).  Saving model ...
Epoch: 12 cost time: 0.5787692070007324
Epoch: 12, Steps: 2 | Train Loss: 0.840 Vali Loss: 0.795 Vali Acc: 0.811 Test Loss: 0.795 Test Acc: 0.811
Validation loss decreased (-0.770362 --> -0.811103).  Saving model ...
Epoch: 13 cost time: 0.6162242889404297
Epoch: 13, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.714 Vali Acc: 0.837 Test Loss: 0.714 Test Acc: 0.837
Validation loss decreased (-0.811103 --> -0.837030).  Saving model ...
Epoch: 14 cost time: 0.5986006259918213
Epoch: 14, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
Validation loss decreased (-0.837030 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 0.5617208480834961
Epoch: 15, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
Validation loss decreased (-0.844438 --> -0.877772).  Saving model ...
Epoch: 16 cost time: 0.5630669593811035
Epoch: 16, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.518 Vali Acc: 0.896 Test Loss: 0.518 Test Acc: 0.896
Validation loss decreased (-0.877772 --> -0.896291).  Saving model ...
Epoch: 17 cost time: 0.56607985496521
Epoch: 17, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.467 Vali Acc: 0.907 Test Loss: 0.467 Test Acc: 0.907
Validation loss decreased (-0.896291 --> -0.907403).  Saving model ...
Epoch: 18 cost time: 0.7000482082366943
Epoch: 18, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.421 Vali Acc: 0.926 Test Loss: 0.421 Test Acc: 0.926
Validation loss decreased (-0.907403 --> -0.925922).  Saving model ...
Epoch: 19 cost time: 0.7811458110809326
Epoch: 19, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.382 Vali Acc: 0.930 Test Loss: 0.382 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 20 cost time: 0.6779301166534424
Epoch: 20, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.350 Vali Acc: 0.933 Test Loss: 0.350 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 21 cost time: 0.5487782955169678
Epoch: 21, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.322 Vali Acc: 0.930 Test Loss: 0.322 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6680052280426025
Epoch: 22, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7606964111328125
Epoch: 23, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6351308822631836
Epoch: 24, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6484572887420654
Epoch: 25, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6561214923858643
Epoch: 26, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7098116874694824
Epoch: 27, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7237210273742676
Epoch: 28, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6572079658508301
Epoch: 29, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6971473693847656
Epoch: 30, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.5624294281005859
Epoch: 31, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.6632535457611084
Epoch: 32, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.6468524932861328
Epoch: 33, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.6102681159973145
Epoch: 34, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.6290693283081055
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.5902152061462402
Epoch: 36, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6483056545257568
Epoch: 37, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6264839172363281
Epoch: 38, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.575721025466919
Epoch: 39, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6394462585449219
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5294413566589355
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6920185089111328
Epoch: 42, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6245803833007812
Epoch: 43, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6140949726104736
Epoch: 44, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5349235534667969
Epoch: 45, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.59609055519104
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 175110
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.458282470703125
Epoch: 1, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.634 Vali Acc: 0.359 Test Loss: 1.634 Test Acc: 0.359
Validation loss decreased (inf --> -0.359243).  Saving model ...
Epoch: 2 cost time: 0.7405188083648682
Epoch: 2, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.579 Vali Acc: 0.389 Test Loss: 1.579 Test Acc: 0.389
Validation loss decreased (-0.359243 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 0.6686990261077881
Epoch: 3, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.530 Vali Acc: 0.456 Test Loss: 1.530 Test Acc: 0.456
Validation loss decreased (-0.388873 --> -0.455540).  Saving model ...
Epoch: 4 cost time: 0.6742208003997803
Epoch: 4, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.470 Vali Acc: 0.496 Test Loss: 1.470 Test Acc: 0.496
Validation loss decreased (-0.455540 --> -0.496282).  Saving model ...
Epoch: 5 cost time: 0.6049051284790039
Epoch: 5, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.394 Vali Acc: 0.544 Test Loss: 1.394 Test Acc: 0.544
Validation loss decreased (-0.496282 --> -0.544431).  Saving model ...
Epoch: 6 cost time: 0.5950367450714111
Epoch: 6, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.308 Vali Acc: 0.626 Test Loss: 1.308 Test Acc: 0.626
Validation loss decreased (-0.544431 --> -0.625913).  Saving model ...
Epoch: 7 cost time: 0.5723578929901123
Epoch: 7, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.217 Vali Acc: 0.659 Test Loss: 1.217 Test Acc: 0.659
Validation loss decreased (-0.625913 --> -0.659247).  Saving model ...
Epoch: 8 cost time: 0.693835973739624
Epoch: 8, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.124 Vali Acc: 0.730 Test Loss: 1.124 Test Acc: 0.730
Validation loss decreased (-0.659247 --> -0.729618).  Saving model ...
Epoch: 9 cost time: 0.6073119640350342
Epoch: 9, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.029 Vali Acc: 0.778 Test Loss: 1.029 Test Acc: 0.778
Validation loss decreased (-0.729618 --> -0.777767).  Saving model ...
Epoch: 10 cost time: 0.6464128494262695
Epoch: 10, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.937 Vali Acc: 0.800 Test Loss: 0.937 Test Acc: 0.800
Validation loss decreased (-0.777767 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 0.600740909576416
Epoch: 11, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.850 Vali Acc: 0.837 Test Loss: 0.850 Test Acc: 0.837
Validation loss decreased (-0.799991 --> -0.837029).  Saving model ...
Epoch: 12 cost time: 0.5917608737945557
Epoch: 12, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.768 Vali Acc: 0.837 Test Loss: 0.768 Test Acc: 0.837
Validation loss decreased (-0.837029 --> -0.837029).  Saving model ...
Epoch: 13 cost time: 0.613415002822876
Epoch: 13, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.694 Vali Acc: 0.863 Test Loss: 0.694 Test Acc: 0.863
Validation loss decreased (-0.837029 --> -0.862956).  Saving model ...
Epoch: 14 cost time: 0.6812546253204346
Epoch: 14, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.627 Vali Acc: 0.889 Test Loss: 0.627 Test Acc: 0.889
Validation loss decreased (-0.862956 --> -0.888883).  Saving model ...
Epoch: 15 cost time: 0.6258587837219238
Epoch: 15, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.566 Vali Acc: 0.904 Test Loss: 0.566 Test Acc: 0.904
Validation loss decreased (-0.888883 --> -0.903698).  Saving model ...
Epoch: 16 cost time: 0.6499912738800049
Epoch: 16, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.512 Vali Acc: 0.915 Test Loss: 0.512 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914810).  Saving model ...
Epoch: 17 cost time: 0.7087211608886719
Epoch: 17, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.462 Vali Acc: 0.926 Test Loss: 0.462 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925921).  Saving model ...
Epoch: 18 cost time: 0.7278809547424316
Epoch: 18, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.420 Vali Acc: 0.937 Test Loss: 0.420 Test Acc: 0.937
Validation loss decreased (-0.925921 --> -0.937033).  Saving model ...
Epoch: 19 cost time: 0.5794646739959717
Epoch: 19, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6044249534606934
Epoch: 20, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6425135135650635
Epoch: 21, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.327 Vali Acc: 0.933 Test Loss: 0.327 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6235880851745605
Epoch: 22, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944441).  Saving model ...
Epoch: 23 cost time: 0.6410222053527832
Epoch: 23, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.51820969581604
Epoch: 24, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.268 Vali Acc: 0.952 Test Loss: 0.268 Test Acc: 0.952
Validation loss decreased (-0.944442 --> -0.951849).  Saving model ...
Epoch: 25 cost time: 0.6084120273590088
Epoch: 25, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.255 Vali Acc: 0.952 Test Loss: 0.255 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 26 cost time: 0.5164237022399902
Epoch: 26, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6281778812408447
Epoch: 27, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6436946392059326
Epoch: 28, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.605649471282959
Epoch: 29, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5716235637664795
Epoch: 30, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6246905326843262
Epoch: 31, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5990190505981445
Epoch: 32, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5598692893981934
Epoch: 33, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6056258678436279
Epoch: 34, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.6290924549102783
Epoch: 35, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.6958305835723877
Epoch: 36, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.633514404296875
Epoch: 37, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5839109420776367
Epoch: 38, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7350273132324219
Epoch: 39, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6695137023925781
Epoch: 40, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6444656848907471
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.619126558303833
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.641016960144043
Epoch: 43, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7149126529693604
Epoch: 44, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7043337821960449
Epoch: 45, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 170694
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4227871894836426
Epoch: 1, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.939 Vali Acc: 0.159 Test Loss: 1.939 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.8176455497741699
Epoch: 2, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.861 Vali Acc: 0.167 Test Loss: 1.861 Test Acc: 0.167
Validation loss decreased (-0.159240 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.6592693328857422
Epoch: 3, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.798 Vali Acc: 0.181 Test Loss: 1.798 Test Acc: 0.181
Validation loss decreased (-0.166648 --> -0.181463).  Saving model ...
Epoch: 4 cost time: 0.5628385543823242
Epoch: 4, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.735 Vali Acc: 0.230 Test Loss: 1.735 Test Acc: 0.230
Validation loss decreased (-0.181463 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.7061107158660889
Epoch: 5, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.660 Vali Acc: 0.274 Test Loss: 1.660 Test Acc: 0.274
Validation loss decreased (-0.229612 --> -0.274057).  Saving model ...
Epoch: 6 cost time: 0.6060764789581299
Epoch: 6, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.577 Vali Acc: 0.367 Test Loss: 1.577 Test Acc: 0.367
Validation loss decreased (-0.274057 --> -0.366651).  Saving model ...
Epoch: 7 cost time: 0.6899020671844482
Epoch: 7, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.489 Vali Acc: 0.478 Test Loss: 1.489 Test Acc: 0.478
Validation loss decreased (-0.366651 --> -0.477763).  Saving model ...
Epoch: 8 cost time: 0.7155835628509521
Epoch: 8, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.397 Vali Acc: 0.622 Test Loss: 1.397 Test Acc: 0.622
Validation loss decreased (-0.477763 --> -0.622208).  Saving model ...
Epoch: 9 cost time: 0.6772186756134033
Epoch: 9, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.302 Vali Acc: 0.681 Test Loss: 1.302 Test Acc: 0.681
Validation loss decreased (-0.622208 --> -0.681468).  Saving model ...
Epoch: 10 cost time: 0.6734530925750732
Epoch: 10, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.207 Vali Acc: 0.730 Test Loss: 1.207 Test Acc: 0.730
Validation loss decreased (-0.681468 --> -0.729618).  Saving model ...
Epoch: 11 cost time: 0.6798427104949951
Epoch: 11, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.115 Vali Acc: 0.763 Test Loss: 1.115 Test Acc: 0.763
Validation loss decreased (-0.729618 --> -0.762952).  Saving model ...
Epoch: 12 cost time: 0.5774891376495361
Epoch: 12, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.028 Vali Acc: 0.785 Test Loss: 1.028 Test Acc: 0.785
Validation loss decreased (-0.762952 --> -0.785175).  Saving model ...
Epoch: 13 cost time: 0.5964031219482422
Epoch: 13, Steps: 2 | Train Loss: 0.959 Vali Loss: 0.944 Vali Acc: 0.811 Test Loss: 0.944 Test Acc: 0.811
Validation loss decreased (-0.785175 --> -0.811102).  Saving model ...
Epoch: 14 cost time: 0.611666202545166
Epoch: 14, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.867 Vali Acc: 0.856 Test Loss: 0.867 Test Acc: 0.856
Validation loss decreased (-0.811102 --> -0.855547).  Saving model ...
Epoch: 15 cost time: 0.6374244689941406
Epoch: 15, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.795 Vali Acc: 0.859 Test Loss: 0.795 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859251).  Saving model ...
Epoch: 16 cost time: 0.6147217750549316
Epoch: 16, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.728 Vali Acc: 0.870 Test Loss: 0.728 Test Acc: 0.870
Validation loss decreased (-0.859251 --> -0.870363).  Saving model ...
Epoch: 17 cost time: 0.704077959060669
Epoch: 17, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.666 Vali Acc: 0.889 Test Loss: 0.666 Test Acc: 0.889
Validation loss decreased (-0.870363 --> -0.888882).  Saving model ...
Epoch: 18 cost time: 0.6010525226593018
Epoch: 18, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.610 Vali Acc: 0.896 Test Loss: 0.610 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 19 cost time: 0.6612911224365234
Epoch: 19, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.559 Vali Acc: 0.904 Test Loss: 0.559 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 20 cost time: 0.5878334045410156
Epoch: 20, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.515 Vali Acc: 0.904 Test Loss: 0.515 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903699).  Saving model ...
Epoch: 21 cost time: 0.7078189849853516
Epoch: 21, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.479 Vali Acc: 0.919 Test Loss: 0.479 Test Acc: 0.919
Validation loss decreased (-0.903699 --> -0.918514).  Saving model ...
Epoch: 22 cost time: 0.7094321250915527
Epoch: 22, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.445 Vali Acc: 0.911 Test Loss: 0.445 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6724772453308105
Epoch: 23, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.414 Vali Acc: 0.915 Test Loss: 0.414 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.812985897064209
Epoch: 24, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.388 Vali Acc: 0.915 Test Loss: 0.388 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7213149070739746
Epoch: 25, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.364 Vali Acc: 0.915 Test Loss: 0.364 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6233518123626709
Epoch: 26, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.345 Vali Acc: 0.915 Test Loss: 0.345 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6200261116027832
Epoch: 27, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.326 Vali Acc: 0.919 Test Loss: 0.326 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 28 cost time: 0.6124181747436523
Epoch: 28, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.308 Vali Acc: 0.922 Test Loss: 0.308 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 29 cost time: 0.641685962677002
Epoch: 29, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 30 cost time: 0.6445338726043701
Epoch: 30, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.6438169479370117
Epoch: 31, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.6001784801483154
Epoch: 32, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 33 cost time: 0.7003631591796875
Epoch: 33, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 34 cost time: 0.640002965927124
Epoch: 34, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.6133100986480713
Epoch: 35, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.643543004989624
Epoch: 36, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6380226612091064
Epoch: 37, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6701881885528564
Epoch: 38, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6100020408630371
Epoch: 39, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6044318675994873
Epoch: 40, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.638697624206543
Epoch: 41, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6026661396026611
Epoch: 42, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5883119106292725
Epoch: 43, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6071312427520752
Epoch: 44, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5236825942993164
Epoch: 45, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 164742
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2420027256011963
Epoch: 1, Steps: 2 | Train Loss: 2.039 Vali Loss: 2.041 Vali Acc: 0.085 Test Loss: 2.041 Test Acc: 0.085
Validation loss decreased (inf --> -0.085165).  Saving model ...
Epoch: 2 cost time: 0.6835620403289795
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.966 Vali Acc: 0.093 Test Loss: 1.966 Test Acc: 0.093
Validation loss decreased (-0.085165 --> -0.092573).  Saving model ...
Epoch: 3 cost time: 0.5941829681396484
Epoch: 3, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.907 Vali Acc: 0.096 Test Loss: 1.907 Test Acc: 0.096
Validation loss decreased (-0.092573 --> -0.096277).  Saving model ...
Epoch: 4 cost time: 0.6854135990142822
Epoch: 4, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.845 Vali Acc: 0.104 Test Loss: 1.845 Test Acc: 0.104
Validation loss decreased (-0.096277 --> -0.103685).  Saving model ...
Epoch: 5 cost time: 0.608330488204956
Epoch: 5, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.774 Vali Acc: 0.141 Test Loss: 1.774 Test Acc: 0.141
Validation loss decreased (-0.103685 --> -0.140723).  Saving model ...
Epoch: 6 cost time: 0.6719436645507812
Epoch: 6, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.695 Vali Acc: 0.211 Test Loss: 1.695 Test Acc: 0.211
Validation loss decreased (-0.140723 --> -0.211094).  Saving model ...
Epoch: 7 cost time: 0.6426243782043457
Epoch: 7, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.612 Vali Acc: 0.304 Test Loss: 1.612 Test Acc: 0.304
Validation loss decreased (-0.211094 --> -0.303688).  Saving model ...
Epoch: 8 cost time: 0.6075687408447266
Epoch: 8, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.524 Vali Acc: 0.463 Test Loss: 1.524 Test Acc: 0.463
Validation loss decreased (-0.303688 --> -0.462948).  Saving model ...
Epoch: 9 cost time: 0.6005611419677734
Epoch: 9, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.433 Vali Acc: 0.581 Test Loss: 1.433 Test Acc: 0.581
Validation loss decreased (-0.462948 --> -0.581467).  Saving model ...
Epoch: 10 cost time: 0.5999014377593994
Epoch: 10, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.342 Vali Acc: 0.659 Test Loss: 1.342 Test Acc: 0.659
Validation loss decreased (-0.581467 --> -0.659246).  Saving model ...
Epoch: 11 cost time: 0.5792958736419678
Epoch: 11, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.251 Vali Acc: 0.719 Test Loss: 1.251 Test Acc: 0.719
Validation loss decreased (-0.659246 --> -0.718506).  Saving model ...
Epoch: 12 cost time: 0.696235179901123
Epoch: 12, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.162 Vali Acc: 0.737 Test Loss: 1.162 Test Acc: 0.737
Validation loss decreased (-0.718506 --> -0.737025).  Saving model ...
Epoch: 13 cost time: 0.5781137943267822
Epoch: 13, Steps: 2 | Train Loss: 0.891 Vali Loss: 1.076 Vali Acc: 0.748 Test Loss: 1.076 Test Acc: 0.748
Validation loss decreased (-0.737025 --> -0.748137).  Saving model ...
Epoch: 14 cost time: 0.6769218444824219
Epoch: 14, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.994 Vali Acc: 0.781 Test Loss: 0.994 Test Acc: 0.781
Validation loss decreased (-0.748137 --> -0.781472).  Saving model ...
Epoch: 15 cost time: 0.5679423809051514
Epoch: 15, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.918 Vali Acc: 0.793 Test Loss: 0.918 Test Acc: 0.793
Validation loss decreased (-0.781472 --> -0.792583).  Saving model ...
Epoch: 16 cost time: 0.5903701782226562
Epoch: 16, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.845 Vali Acc: 0.822 Test Loss: 0.845 Test Acc: 0.822
Validation loss decreased (-0.792583 --> -0.822214).  Saving model ...
Epoch: 17 cost time: 0.6739604473114014
Epoch: 17, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.779 Vali Acc: 0.837 Test Loss: 0.779 Test Acc: 0.837
Validation loss decreased (-0.822214 --> -0.837029).  Saving model ...
Epoch: 18 cost time: 0.5577592849731445
Epoch: 18, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.717 Vali Acc: 0.859 Test Loss: 0.717 Test Acc: 0.859
Validation loss decreased (-0.837029 --> -0.859252).  Saving model ...
Epoch: 19 cost time: 0.7627866268157959
Epoch: 19, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.659 Vali Acc: 0.893 Test Loss: 0.659 Test Acc: 0.893
Validation loss decreased (-0.859252 --> -0.892586).  Saving model ...
Epoch: 20 cost time: 0.646554708480835
Epoch: 20, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.607 Vali Acc: 0.904 Test Loss: 0.607 Test Acc: 0.904
Validation loss decreased (-0.892586 --> -0.903698).  Saving model ...
Epoch: 21 cost time: 0.7667741775512695
Epoch: 21, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.561 Vali Acc: 0.919 Test Loss: 0.561 Test Acc: 0.919
Validation loss decreased (-0.903698 --> -0.918513).  Saving model ...
Epoch: 22 cost time: 0.6267056465148926
Epoch: 22, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.520 Vali Acc: 0.922 Test Loss: 0.520 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 23 cost time: 0.6489992141723633
Epoch: 23, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.485 Vali Acc: 0.926 Test Loss: 0.485 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 24 cost time: 0.5935840606689453
Epoch: 24, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.450 Vali Acc: 0.941 Test Loss: 0.450 Test Acc: 0.941
Validation loss decreased (-0.925921 --> -0.940736).  Saving model ...
Epoch: 25 cost time: 0.6696317195892334
Epoch: 25, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.419 Vali Acc: 0.941 Test Loss: 0.419 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 26 cost time: 0.6954517364501953
Epoch: 26, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.393 Vali Acc: 0.941 Test Loss: 0.393 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 27 cost time: 0.6364953517913818
Epoch: 27, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.366 Vali Acc: 0.941 Test Loss: 0.366 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 28 cost time: 0.6204419136047363
Epoch: 28, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.344 Vali Acc: 0.941 Test Loss: 0.344 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 29 cost time: 0.662193775177002
Epoch: 29, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.325 Vali Acc: 0.941 Test Loss: 0.325 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 30 cost time: 0.6585028171539307
Epoch: 30, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 31 cost time: 0.6556117534637451
Epoch: 31, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5776667594909668
Epoch: 32, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5805742740631104
Epoch: 33, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6559302806854248
Epoch: 34, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6317758560180664
Epoch: 35, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.6851804256439209
Epoch: 36, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.5796380043029785
Epoch: 37, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.238 Vali Acc: 0.956 Test Loss: 0.238 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 38 cost time: 0.5632824897766113
Epoch: 38, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.233 Vali Acc: 0.956 Test Loss: 0.233 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 39 cost time: 0.6477422714233398
Epoch: 39, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.228 Vali Acc: 0.959 Test Loss: 0.228 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 40 cost time: 0.6549265384674072
Epoch: 40, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.224 Vali Acc: 0.959 Test Loss: 0.224 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 41 cost time: 0.6098916530609131
Epoch: 41, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.221 Vali Acc: 0.959 Test Loss: 0.221 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 42 cost time: 0.6114051342010498
Epoch: 42, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.219 Vali Acc: 0.952 Test Loss: 0.219 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6363503932952881
Epoch: 43, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5996522903442383
Epoch: 44, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5196881294250488
Epoch: 45, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7261984348297119
Epoch: 46, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6907291412353516
Epoch: 47, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6190485954284668
Epoch: 48, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6319491863250732
Epoch: 49, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6149523258209229
Epoch: 50, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.7098653316497803
Epoch: 51, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 161926
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5063254833221436
Epoch: 1, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.900 Vali Acc: 0.107 Test Loss: 1.900 Test Acc: 0.107
Validation loss decreased (inf --> -0.107388).  Saving model ...
Epoch: 2 cost time: 0.7356388568878174
Epoch: 2, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.785 Vali Acc: 0.148 Test Loss: 1.785 Test Acc: 0.148
Validation loss decreased (-0.107388 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 0.7179641723632812
Epoch: 3, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.637 Vali Acc: 0.293 Test Loss: 1.637 Test Acc: 0.293
Validation loss decreased (-0.148130 --> -0.292576).  Saving model ...
Epoch: 4 cost time: 0.7213428020477295
Epoch: 4, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.409 Vali Acc: 0.563 Test Loss: 1.409 Test Acc: 0.563
Validation loss decreased (-0.292576 --> -0.562949).  Saving model ...
Epoch: 5 cost time: 0.725541353225708
Epoch: 5, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.157 Vali Acc: 0.715 Test Loss: 1.157 Test Acc: 0.715
Validation loss decreased (-0.562949 --> -0.714803).  Saving model ...
Epoch: 6 cost time: 0.7182834148406982
Epoch: 6, Steps: 2 | Train Loss: 0.970 Vali Loss: 0.927 Vali Acc: 0.815 Test Loss: 0.927 Test Acc: 0.815
Validation loss decreased (-0.714803 --> -0.814806).  Saving model ...
Epoch: 7 cost time: 0.6979415416717529
Epoch: 7, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.732 Vali Acc: 0.870 Test Loss: 0.732 Test Acc: 0.870
Validation loss decreased (-0.814806 --> -0.870363).  Saving model ...
Epoch: 8 cost time: 0.7452049255371094
Epoch: 8, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.583 Vali Acc: 0.907 Test Loss: 0.583 Test Acc: 0.907
Validation loss decreased (-0.870363 --> -0.907402).  Saving model ...
Epoch: 9 cost time: 0.7271561622619629
Epoch: 9, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.468 Vali Acc: 0.915 Test Loss: 0.468 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 10 cost time: 0.7134943008422852
Epoch: 10, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.383 Vali Acc: 0.926 Test Loss: 0.383 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925922).  Saving model ...
Epoch: 11 cost time: 0.724311351776123
Epoch: 11, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 12 cost time: 0.646477222442627
Epoch: 12, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 13 cost time: 0.5898473262786865
Epoch: 13, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 14 cost time: 0.6982080936431885
Epoch: 14, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 15 cost time: 0.6097397804260254
Epoch: 15, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 16 cost time: 0.6590073108673096
Epoch: 16, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.7686514854431152
Epoch: 17, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 18 cost time: 0.7817943096160889
Epoch: 18, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 19 cost time: 0.6668908596038818
Epoch: 19, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5691666603088379
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7592573165893555
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.930 Test Loss: 0.177 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7743053436279297
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7022984027862549
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6316404342651367
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5995855331420898
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6826887130737305
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7057416439056396
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7360336780548096
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 200518
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4914956092834473
Epoch: 1, Steps: 2 | Train Loss: 2.041 Vali Loss: 1.928 Vali Acc: 0.148 Test Loss: 1.928 Test Acc: 0.148
Validation loss decreased (inf --> -0.148129).  Saving model ...
Epoch: 2 cost time: 0.766218900680542
Epoch: 2, Steps: 2 | Train Loss: 2.021 Vali Loss: 1.837 Vali Acc: 0.200 Test Loss: 1.837 Test Acc: 0.200
Validation loss decreased (-0.148129 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.6367473602294922
Epoch: 3, Steps: 2 | Train Loss: 1.922 Vali Loss: 1.738 Vali Acc: 0.259 Test Loss: 1.738 Test Acc: 0.259
Validation loss decreased (-0.199982 --> -0.259242).  Saving model ...
Epoch: 4 cost time: 0.7382919788360596
Epoch: 4, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.600 Vali Acc: 0.356 Test Loss: 1.600 Test Acc: 0.356
Validation loss decreased (-0.259242 --> -0.355540).  Saving model ...
Epoch: 5 cost time: 0.7383315563201904
Epoch: 5, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.433 Vali Acc: 0.496 Test Loss: 1.433 Test Acc: 0.496
Validation loss decreased (-0.355540 --> -0.496282).  Saving model ...
Epoch: 6 cost time: 0.859102725982666
Epoch: 6, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.255 Vali Acc: 0.633 Test Loss: 1.255 Test Acc: 0.633
Validation loss decreased (-0.496282 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 0.7310707569122314
Epoch: 7, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.085 Vali Acc: 0.752 Test Loss: 1.085 Test Acc: 0.752
Validation loss decreased (-0.633321 --> -0.751841).  Saving model ...
Epoch: 8 cost time: 0.6701157093048096
Epoch: 8, Steps: 2 | Train Loss: 0.942 Vali Loss: 0.925 Vali Acc: 0.837 Test Loss: 0.925 Test Acc: 0.837
Validation loss decreased (-0.751841 --> -0.837028).  Saving model ...
Epoch: 9 cost time: 0.7384026050567627
Epoch: 9, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.780 Vali Acc: 0.881 Test Loss: 0.780 Test Acc: 0.881
Validation loss decreased (-0.837028 --> -0.881474).  Saving model ...
Epoch: 10 cost time: 0.7837731838226318
Epoch: 10, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.654 Vali Acc: 0.896 Test Loss: 0.654 Test Acc: 0.896
Validation loss decreased (-0.881474 --> -0.896290).  Saving model ...
Epoch: 11 cost time: 0.6874558925628662
Epoch: 11, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.552 Vali Acc: 0.911 Test Loss: 0.552 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911106).  Saving model ...
Epoch: 12 cost time: 0.7470376491546631
Epoch: 12, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.468 Vali Acc: 0.926 Test Loss: 0.468 Test Acc: 0.926
Validation loss decreased (-0.911106 --> -0.925921).  Saving model ...
Epoch: 13 cost time: 0.8891465663909912
Epoch: 13, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.403 Vali Acc: 0.933 Test Loss: 0.403 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 14 cost time: 0.6778295040130615
Epoch: 14, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.352 Vali Acc: 0.937 Test Loss: 0.352 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937034).  Saving model ...
Epoch: 15 cost time: 0.7198469638824463
Epoch: 15, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 16 cost time: 0.6086950302124023
Epoch: 16, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6219429969787598
Epoch: 17, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6644773483276367
Epoch: 18, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6114370822906494
Epoch: 19, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6250698566436768
Epoch: 20, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6371662616729736
Epoch: 21, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7089672088623047
Epoch: 22, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.691678524017334
Epoch: 23, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6628696918487549
Epoch: 24, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.6830990314483643
Epoch: 25, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.6860971450805664
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.6046898365020752
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5500147342681885
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.170 Vali Acc: 0.933 Test Loss: 0.170 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6474401950836182
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6809074878692627
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7813725471496582
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.744617223739624
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6082954406738281
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7146701812744141
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.930 Test Loss: 0.178 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6938879489898682
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8027698993682861
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 149958
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9730772972106934
Epoch: 1, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.793 Vali Acc: 0.237 Test Loss: 1.793 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 0.564781904220581
Epoch: 2, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.707 Vali Acc: 0.289 Test Loss: 1.707 Test Acc: 0.289
Validation loss decreased (-0.237019 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 0.601874828338623
Epoch: 3, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.625 Vali Acc: 0.348 Test Loss: 1.625 Test Acc: 0.348
Validation loss decreased (-0.288872 --> -0.348132).  Saving model ...
Epoch: 4 cost time: 0.5523712635040283
Epoch: 4, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.522 Vali Acc: 0.411 Test Loss: 1.522 Test Acc: 0.411
Validation loss decreased (-0.348132 --> -0.411096).  Saving model ...
Epoch: 5 cost time: 0.51639723777771
Epoch: 5, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.402 Vali Acc: 0.511 Test Loss: 1.402 Test Acc: 0.511
Validation loss decreased (-0.411096 --> -0.511097).  Saving model ...
Epoch: 6 cost time: 0.5515730381011963
Epoch: 6, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.272 Vali Acc: 0.570 Test Loss: 1.272 Test Acc: 0.570
Validation loss decreased (-0.511097 --> -0.570358).  Saving model ...
Epoch: 7 cost time: 0.6247715950012207
Epoch: 7, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.140 Vali Acc: 0.633 Test Loss: 1.140 Test Acc: 0.633
Validation loss decreased (-0.570358 --> -0.633322).  Saving model ...
Epoch: 8 cost time: 0.6339161396026611
Epoch: 8, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.012 Vali Acc: 0.722 Test Loss: 1.012 Test Acc: 0.722
Validation loss decreased (-0.633322 --> -0.722212).  Saving model ...
Epoch: 9 cost time: 0.6258528232574463
Epoch: 9, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.894 Vali Acc: 0.804 Test Loss: 0.894 Test Acc: 0.804
Validation loss decreased (-0.722212 --> -0.803695).  Saving model ...
Epoch: 10 cost time: 0.5653533935546875
Epoch: 10, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.789 Vali Acc: 0.830 Test Loss: 0.789 Test Acc: 0.830
Validation loss decreased (-0.803695 --> -0.829622).  Saving model ...
Epoch: 11 cost time: 0.5491008758544922
Epoch: 11, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.697 Vali Acc: 0.867 Test Loss: 0.697 Test Acc: 0.867
Validation loss decreased (-0.829622 --> -0.866660).  Saving model ...
Epoch: 12 cost time: 0.6105492115020752
Epoch: 12, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.618 Vali Acc: 0.874 Test Loss: 0.618 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874068).  Saving model ...
Epoch: 13 cost time: 0.5502822399139404
Epoch: 13, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.550 Vali Acc: 0.881 Test Loss: 0.550 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 14 cost time: 0.5528028011322021
Epoch: 14, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.490 Vali Acc: 0.904 Test Loss: 0.490 Test Acc: 0.904
Validation loss decreased (-0.881476 --> -0.903699).  Saving model ...
Epoch: 15 cost time: 0.555095911026001
Epoch: 15, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.435 Vali Acc: 0.911 Test Loss: 0.435 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911107).  Saving model ...
Epoch: 16 cost time: 0.5228567123413086
Epoch: 16, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.387 Vali Acc: 0.926 Test Loss: 0.387 Test Acc: 0.926
Validation loss decreased (-0.911107 --> -0.925922).  Saving model ...
Epoch: 17 cost time: 0.49535059928894043
Epoch: 17, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.347 Vali Acc: 0.926 Test Loss: 0.347 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 18 cost time: 0.5098469257354736
Epoch: 18, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.313 Vali Acc: 0.941 Test Loss: 0.313 Test Acc: 0.941
Validation loss decreased (-0.925922 --> -0.940738).  Saving model ...
Epoch: 19 cost time: 0.620164155960083
Epoch: 19, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.286 Vali Acc: 0.937 Test Loss: 0.286 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.521500825881958
Epoch: 20, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5961441993713379
Epoch: 21, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5482962131500244
Epoch: 22, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5417137145996094
Epoch: 23, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5690877437591553
Epoch: 24, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7157361507415771
Epoch: 25, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5551571846008301
Epoch: 26, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5506956577301025
Epoch: 27, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6183121204376221
Epoch: 28, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 134662
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1698808670043945
Epoch: 1, Steps: 2 | Train Loss: 2.138 Vali Loss: 1.828 Vali Acc: 0.215 Test Loss: 1.828 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.5911769866943359
Epoch: 2, Steps: 2 | Train Loss: 1.987 Vali Loss: 1.758 Vali Acc: 0.230 Test Loss: 1.758 Test Acc: 0.230
Validation loss decreased (-0.214797 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 0.5438385009765625
Epoch: 3, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.692 Vali Acc: 0.281 Test Loss: 1.692 Test Acc: 0.281
Validation loss decreased (-0.229612 --> -0.281465).  Saving model ...
Epoch: 4 cost time: 0.6834983825683594
Epoch: 4, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.611 Vali Acc: 0.341 Test Loss: 1.611 Test Acc: 0.341
Validation loss decreased (-0.281465 --> -0.340725).  Saving model ...
Epoch: 5 cost time: 0.9208865165710449
Epoch: 5, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.512 Vali Acc: 0.470 Test Loss: 1.512 Test Acc: 0.470
Validation loss decreased (-0.340725 --> -0.470355).  Saving model ...
Epoch: 6 cost time: 0.7033576965332031
Epoch: 6, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.399 Vali Acc: 0.615 Test Loss: 1.399 Test Acc: 0.615
Validation loss decreased (-0.470355 --> -0.614801).  Saving model ...
Epoch: 7 cost time: 0.5733580589294434
Epoch: 7, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.278 Vali Acc: 0.696 Test Loss: 1.278 Test Acc: 0.696
Validation loss decreased (-0.614801 --> -0.696284).  Saving model ...
Epoch: 8 cost time: 0.6013329029083252
Epoch: 8, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.154 Vali Acc: 0.767 Test Loss: 1.154 Test Acc: 0.767
Validation loss decreased (-0.696284 --> -0.766655).  Saving model ...
Epoch: 9 cost time: 0.6194984912872314
Epoch: 9, Steps: 2 | Train Loss: 1.171 Vali Loss: 1.035 Vali Acc: 0.796 Test Loss: 1.035 Test Acc: 0.796
Validation loss decreased (-0.766655 --> -0.796286).  Saving model ...
Epoch: 10 cost time: 0.5581908226013184
Epoch: 10, Steps: 2 | Train Loss: 1.046 Vali Loss: 0.922 Vali Acc: 0.852 Test Loss: 0.922 Test Acc: 0.852
Validation loss decreased (-0.796286 --> -0.851843).  Saving model ...
Epoch: 11 cost time: 0.6168043613433838
Epoch: 11, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.816 Vali Acc: 0.863 Test Loss: 0.816 Test Acc: 0.863
Validation loss decreased (-0.851843 --> -0.862955).  Saving model ...
Epoch: 12 cost time: 0.6181235313415527
Epoch: 12, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.723 Vali Acc: 0.885 Test Loss: 0.723 Test Acc: 0.885
Validation loss decreased (-0.862955 --> -0.885178).  Saving model ...
Epoch: 13 cost time: 0.6156005859375
Epoch: 13, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.642 Vali Acc: 0.904 Test Loss: 0.642 Test Acc: 0.904
Validation loss decreased (-0.885178 --> -0.903697).  Saving model ...
Epoch: 14 cost time: 0.6261296272277832
Epoch: 14, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.573 Vali Acc: 0.904 Test Loss: 0.573 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 15 cost time: 0.6039614677429199
Epoch: 15, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.513 Vali Acc: 0.915 Test Loss: 0.513 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914810).  Saving model ...
Epoch: 16 cost time: 0.6546919345855713
Epoch: 16, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.464 Vali Acc: 0.911 Test Loss: 0.464 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5901358127593994
Epoch: 17, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.422 Vali Acc: 0.915 Test Loss: 0.422 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 18 cost time: 0.6018075942993164
Epoch: 18, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.385 Vali Acc: 0.919 Test Loss: 0.385 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 19 cost time: 0.5650777816772461
Epoch: 19, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.353 Vali Acc: 0.919 Test Loss: 0.353 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.66009521484375
Epoch: 20, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.322 Vali Acc: 0.922 Test Loss: 0.322 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 0.6886358261108398
Epoch: 21, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.296 Vali Acc: 0.937 Test Loss: 0.296 Test Acc: 0.937
Validation loss decreased (-0.922219 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 0.6446981430053711
Epoch: 22, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.273 Vali Acc: 0.933 Test Loss: 0.273 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6347949504852295
Epoch: 23, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7358176708221436
Epoch: 24, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.5623841285705566
Epoch: 25, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 26 cost time: 0.6849873065948486
Epoch: 26, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.6366691589355469
Epoch: 27, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.5498471260070801
Epoch: 28, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.6448764801025391
Epoch: 29, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5635263919830322
Epoch: 30, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.49747681617736816
Epoch: 31, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.6231966018676758
Epoch: 32, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.536550760269165
Epoch: 33, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.5078115463256836
Epoch: 34, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.5287280082702637
Epoch: 35, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.5632424354553223
Epoch: 36, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.6391856670379639
Epoch: 37, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 38 cost time: 0.5825014114379883
Epoch: 38, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.544654130935669
Epoch: 39, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.6293108463287354
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.6498315334320068
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.6887862682342529
Epoch: 42, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.6477298736572266
Epoch: 43, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.617786169052124
Epoch: 44, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7020213603973389
Epoch: 45, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5811970233917236
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6404874324798584
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.650721549987793
Epoch: 48, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6595919132232666
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6318626403808594
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6728000640869141
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6353549957275391
Epoch: 52, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 125574
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4495301246643066
Epoch: 1, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.912 Vali Acc: 0.196 Test Loss: 1.912 Test Acc: 0.196
Validation loss decreased (inf --> -0.196277).  Saving model ...
Epoch: 2 cost time: 0.6401541233062744
Epoch: 2, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.835 Vali Acc: 0.241 Test Loss: 1.835 Test Acc: 0.241
Validation loss decreased (-0.196277 --> -0.240722).  Saving model ...
Epoch: 3 cost time: 0.6167075634002686
Epoch: 3, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.766 Vali Acc: 0.274 Test Loss: 1.766 Test Acc: 0.274
Validation loss decreased (-0.240722 --> -0.274056).  Saving model ...
Epoch: 4 cost time: 0.6289942264556885
Epoch: 4, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.686 Vali Acc: 0.356 Test Loss: 1.686 Test Acc: 0.356
Validation loss decreased (-0.274056 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 0.571690559387207
Epoch: 5, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.589 Vali Acc: 0.430 Test Loss: 1.589 Test Acc: 0.430
Validation loss decreased (-0.355539 --> -0.429614).  Saving model ...
Epoch: 6 cost time: 0.5861775875091553
Epoch: 6, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.478 Vali Acc: 0.515 Test Loss: 1.478 Test Acc: 0.515
Validation loss decreased (-0.429614 --> -0.514800).  Saving model ...
Epoch: 7 cost time: 0.6578431129455566
Epoch: 7, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.359 Vali Acc: 0.630 Test Loss: 1.359 Test Acc: 0.630
Validation loss decreased (-0.514800 --> -0.629616).  Saving model ...
Epoch: 8 cost time: 0.5697832107543945
Epoch: 8, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.236 Vali Acc: 0.756 Test Loss: 1.236 Test Acc: 0.756
Validation loss decreased (-0.629616 --> -0.755543).  Saving model ...
Epoch: 9 cost time: 0.5692205429077148
Epoch: 9, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.114 Vali Acc: 0.833 Test Loss: 1.114 Test Acc: 0.833
Validation loss decreased (-0.755543 --> -0.833322).  Saving model ...
Epoch: 10 cost time: 0.6687338352203369
Epoch: 10, Steps: 2 | Train Loss: 1.032 Vali Loss: 0.996 Vali Acc: 0.878 Test Loss: 0.996 Test Acc: 0.878
Validation loss decreased (-0.833322 --> -0.877768).  Saving model ...
Epoch: 11 cost time: 0.5894122123718262
Epoch: 11, Steps: 2 | Train Loss: 0.942 Vali Loss: 0.887 Vali Acc: 0.900 Test Loss: 0.887 Test Acc: 0.900
Validation loss decreased (-0.877768 --> -0.899991).  Saving model ...
Epoch: 12 cost time: 0.5559554100036621
Epoch: 12, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.789 Vali Acc: 0.915 Test Loss: 0.789 Test Acc: 0.915
Validation loss decreased (-0.899991 --> -0.914807).  Saving model ...
Epoch: 13 cost time: 0.6157135963439941
Epoch: 13, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.700 Vali Acc: 0.922 Test Loss: 0.700 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922215).  Saving model ...
Epoch: 14 cost time: 0.6449370384216309
Epoch: 14, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.623 Vali Acc: 0.926 Test Loss: 0.623 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925920).  Saving model ...
Epoch: 15 cost time: 0.6329784393310547
Epoch: 15, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.557 Vali Acc: 0.926 Test Loss: 0.557 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 16 cost time: 0.5910513401031494
Epoch: 16, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.501 Vali Acc: 0.933 Test Loss: 0.501 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 17 cost time: 0.6312921047210693
Epoch: 17, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.452 Vali Acc: 0.941 Test Loss: 0.452 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 18 cost time: 0.5615031719207764
Epoch: 18, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.409 Vali Acc: 0.941 Test Loss: 0.409 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 19 cost time: 0.5617613792419434
Epoch: 19, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.372 Vali Acc: 0.941 Test Loss: 0.372 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 20 cost time: 0.561492919921875
Epoch: 20, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.341 Vali Acc: 0.944 Test Loss: 0.341 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.6194031238555908
Epoch: 21, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.315 Vali Acc: 0.944 Test Loss: 0.315 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 22 cost time: 0.4791107177734375
Epoch: 22, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6024799346923828
Epoch: 23, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5717124938964844
Epoch: 24, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.256 Vali Acc: 0.948 Test Loss: 0.256 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.5898525714874268
Epoch: 25, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.5938563346862793
Epoch: 26, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.5794517993927002
Epoch: 27, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6422326564788818
Epoch: 28, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5535478591918945
Epoch: 29, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6125056743621826
Epoch: 30, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5900583267211914
Epoch: 31, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5720696449279785
Epoch: 32, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5733215808868408
Epoch: 33, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.6725730895996094
Epoch: 34, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.5502021312713623
Epoch: 35, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.5972814559936523
Epoch: 36, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.632096529006958
Epoch: 37, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6623778343200684
Epoch: 38, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.667205810546875
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6005444526672363
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6048107147216797
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5904014110565186
Epoch: 42, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7500224113464355
Epoch: 43, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6529779434204102
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6583139896392822
Epoch: 45, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 121158
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2784934043884277
Epoch: 1, Steps: 2 | Train Loss: 2.045 Vali Loss: 2.008 Vali Acc: 0.167 Test Loss: 2.008 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.5840988159179688
Epoch: 2, Steps: 2 | Train Loss: 2.082 Vali Loss: 1.937 Vali Acc: 0.174 Test Loss: 1.937 Test Acc: 0.174
Validation loss decreased (-0.166647 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 0.5852780342102051
Epoch: 3, Steps: 2 | Train Loss: 1.978 Vali Loss: 1.876 Vali Acc: 0.174 Test Loss: 1.876 Test Acc: 0.174
Validation loss decreased (-0.174055 --> -0.174055).  Saving model ...
Epoch: 4 cost time: 0.5682938098907471
Epoch: 4, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.813 Vali Acc: 0.237 Test Loss: 1.813 Test Acc: 0.237
Validation loss decreased (-0.174055 --> -0.237019).  Saving model ...
Epoch: 5 cost time: 0.7573277950286865
Epoch: 5, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.736 Vali Acc: 0.304 Test Loss: 1.736 Test Acc: 0.304
Validation loss decreased (-0.237019 --> -0.303686).  Saving model ...
Epoch: 6 cost time: 0.6579837799072266
Epoch: 6, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.649 Vali Acc: 0.407 Test Loss: 1.649 Test Acc: 0.407
Validation loss decreased (-0.303686 --> -0.407391).  Saving model ...
Epoch: 7 cost time: 0.6322333812713623
Epoch: 7, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.555 Vali Acc: 0.485 Test Loss: 1.555 Test Acc: 0.485
Validation loss decreased (-0.407391 --> -0.485170).  Saving model ...
Epoch: 8 cost time: 0.6009156703948975
Epoch: 8, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.456 Vali Acc: 0.559 Test Loss: 1.456 Test Acc: 0.559
Validation loss decreased (-0.485170 --> -0.559245).  Saving model ...
Epoch: 9 cost time: 0.5506644248962402
Epoch: 9, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.354 Vali Acc: 0.630 Test Loss: 1.354 Test Acc: 0.630
Validation loss decreased (-0.559245 --> -0.629616).  Saving model ...
Epoch: 10 cost time: 0.6093614101409912
Epoch: 10, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.254 Vali Acc: 0.674 Test Loss: 1.254 Test Acc: 0.674
Validation loss decreased (-0.629616 --> -0.674062).  Saving model ...
Epoch: 11 cost time: 0.6066107749938965
Epoch: 11, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.154 Vali Acc: 0.700 Test Loss: 1.154 Test Acc: 0.700
Validation loss decreased (-0.674062 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.6018726825714111
Epoch: 12, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.059 Vali Acc: 0.774 Test Loss: 1.059 Test Acc: 0.774
Validation loss decreased (-0.699988 --> -0.774063).  Saving model ...
Epoch: 13 cost time: 0.6731226444244385
Epoch: 13, Steps: 2 | Train Loss: 1.011 Vali Loss: 0.970 Vali Acc: 0.796 Test Loss: 0.970 Test Acc: 0.796
Validation loss decreased (-0.774063 --> -0.796287).  Saving model ...
Epoch: 14 cost time: 0.6347835063934326
Epoch: 14, Steps: 2 | Train Loss: 0.949 Vali Loss: 0.887 Vali Acc: 0.811 Test Loss: 0.887 Test Acc: 0.811
Validation loss decreased (-0.796287 --> -0.811102).  Saving model ...
Epoch: 15 cost time: 0.5473301410675049
Epoch: 15, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.812 Vali Acc: 0.833 Test Loss: 0.812 Test Acc: 0.833
Validation loss decreased (-0.811102 --> -0.833325).  Saving model ...
Epoch: 16 cost time: 0.5749602317810059
Epoch: 16, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.744 Vali Acc: 0.848 Test Loss: 0.744 Test Acc: 0.848
Validation loss decreased (-0.833325 --> -0.848141).  Saving model ...
Epoch: 17 cost time: 0.5333099365234375
Epoch: 17, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.684 Vali Acc: 0.870 Test Loss: 0.684 Test Acc: 0.870
Validation loss decreased (-0.848141 --> -0.870364).  Saving model ...
Epoch: 18 cost time: 0.5488808155059814
Epoch: 18, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.630 Vali Acc: 0.878 Test Loss: 0.630 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877771).  Saving model ...
Epoch: 19 cost time: 0.5748164653778076
Epoch: 19, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.579 Vali Acc: 0.896 Test Loss: 0.579 Test Acc: 0.896
Validation loss decreased (-0.877771 --> -0.896291).  Saving model ...
Epoch: 20 cost time: 0.6423892974853516
Epoch: 20, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.534 Vali Acc: 0.904 Test Loss: 0.534 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903698).  Saving model ...
Epoch: 21 cost time: 0.5934703350067139
Epoch: 21, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.491 Vali Acc: 0.907 Test Loss: 0.491 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 22 cost time: 0.6053054332733154
Epoch: 22, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.454 Vali Acc: 0.911 Test Loss: 0.454 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911107).  Saving model ...
Epoch: 23 cost time: 0.6696176528930664
Epoch: 23, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.421 Vali Acc: 0.911 Test Loss: 0.421 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 24 cost time: 0.6208639144897461
Epoch: 24, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.393 Vali Acc: 0.915 Test Loss: 0.393 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 25 cost time: 0.6548957824707031
Epoch: 25, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.368 Vali Acc: 0.915 Test Loss: 0.368 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 26 cost time: 0.6221156120300293
Epoch: 26, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 27 cost time: 0.6094732284545898
Epoch: 27, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 28 cost time: 0.555264949798584
Epoch: 28, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.312 Vali Acc: 0.915 Test Loss: 0.312 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6033785343170166
Epoch: 29, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.299 Vali Acc: 0.919 Test Loss: 0.299 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6268534660339355
Epoch: 30, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.287 Vali Acc: 0.919 Test Loss: 0.287 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6217732429504395
Epoch: 31, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.661262035369873
Epoch: 32, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.267 Vali Acc: 0.919 Test Loss: 0.267 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5997476577758789
Epoch: 33, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.261 Vali Acc: 0.919 Test Loss: 0.261 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6188256740570068
Epoch: 34, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 35 cost time: 0.5002014636993408
Epoch: 35, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 36 cost time: 0.5858657360076904
Epoch: 36, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 37 cost time: 0.5830774307250977
Epoch: 37, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 0.6301770210266113
Epoch: 38, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 0.5886914730072021
Epoch: 39, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.5877926349639893
Epoch: 40, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.6633028984069824
Epoch: 41, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 42 cost time: 0.6250665187835693
Epoch: 42, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.6014707088470459
Epoch: 43, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 44 cost time: 0.6116495132446289
Epoch: 44, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5878283977508545
Epoch: 45, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.592247486114502
Epoch: 46, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6030070781707764
Epoch: 47, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5238111019134521
Epoch: 48, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6167469024658203
Epoch: 49, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5878448486328125
Epoch: 50, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.6694297790527344
Epoch: 51, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5157546997070312
Epoch: 52, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5933506488800049
Epoch: 53, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 115206
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0406124591827393
Epoch: 1, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.933 Vali Acc: 0.189 Test Loss: 1.933 Test Acc: 0.189
Validation loss decreased (inf --> -0.188870).  Saving model ...
Epoch: 2 cost time: 0.6986069679260254
Epoch: 2, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.878 Vali Acc: 0.200 Test Loss: 1.878 Test Acc: 0.200
Validation loss decreased (-0.188870 --> -0.199981).  Saving model ...
Epoch: 3 cost time: 0.6329247951507568
Epoch: 3, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.832 Vali Acc: 0.211 Test Loss: 1.832 Test Acc: 0.211
Validation loss decreased (-0.199981 --> -0.211093).  Saving model ...
Epoch: 4 cost time: 0.5657670497894287
Epoch: 4, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.786 Vali Acc: 0.230 Test Loss: 1.786 Test Acc: 0.230
Validation loss decreased (-0.211093 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.5811302661895752
Epoch: 5, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.729 Vali Acc: 0.263 Test Loss: 1.729 Test Acc: 0.263
Validation loss decreased (-0.229612 --> -0.262946).  Saving model ...
Epoch: 6 cost time: 0.6504993438720703
Epoch: 6, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.665 Vali Acc: 0.322 Test Loss: 1.665 Test Acc: 0.322
Validation loss decreased (-0.262946 --> -0.322206).  Saving model ...
Epoch: 7 cost time: 0.5780022144317627
Epoch: 7, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.593 Vali Acc: 0.385 Test Loss: 1.593 Test Acc: 0.385
Validation loss decreased (-0.322206 --> -0.385169).  Saving model ...
Epoch: 8 cost time: 0.6385679244995117
Epoch: 8, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.517 Vali Acc: 0.437 Test Loss: 1.517 Test Acc: 0.437
Validation loss decreased (-0.385169 --> -0.437022).  Saving model ...
Epoch: 9 cost time: 0.6560802459716797
Epoch: 9, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.438 Vali Acc: 0.507 Test Loss: 1.438 Test Acc: 0.507
Validation loss decreased (-0.437022 --> -0.507393).  Saving model ...
Epoch: 10 cost time: 0.6650693416595459
Epoch: 10, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.356 Vali Acc: 0.552 Test Loss: 1.356 Test Acc: 0.552
Validation loss decreased (-0.507393 --> -0.551838).  Saving model ...
Epoch: 11 cost time: 0.5635371208190918
Epoch: 11, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.276 Vali Acc: 0.615 Test Loss: 1.276 Test Acc: 0.615
Validation loss decreased (-0.551838 --> -0.614802).  Saving model ...
Epoch: 12 cost time: 0.6381869316101074
Epoch: 12, Steps: 2 | Train Loss: 1.171 Vali Loss: 1.196 Vali Acc: 0.674 Test Loss: 1.196 Test Acc: 0.674
Validation loss decreased (-0.614802 --> -0.674062).  Saving model ...
Epoch: 13 cost time: 0.6040184497833252
Epoch: 13, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.118 Vali Acc: 0.722 Test Loss: 1.118 Test Acc: 0.722
Validation loss decreased (-0.674062 --> -0.722211).  Saving model ...
Epoch: 14 cost time: 0.68758225440979
Epoch: 14, Steps: 2 | Train Loss: 0.928 Vali Loss: 1.044 Vali Acc: 0.763 Test Loss: 1.044 Test Acc: 0.763
Validation loss decreased (-0.722211 --> -0.762953).  Saving model ...
Epoch: 15 cost time: 0.6473188400268555
Epoch: 15, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.972 Vali Acc: 0.781 Test Loss: 0.972 Test Acc: 0.781
Validation loss decreased (-0.762953 --> -0.781472).  Saving model ...
Epoch: 16 cost time: 0.6590304374694824
Epoch: 16, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.904 Vali Acc: 0.807 Test Loss: 0.904 Test Acc: 0.807
Validation loss decreased (-0.781472 --> -0.807398).  Saving model ...
Epoch: 17 cost time: 0.7006525993347168
Epoch: 17, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.840 Vali Acc: 0.826 Test Loss: 0.840 Test Acc: 0.826
Validation loss decreased (-0.807398 --> -0.825918).  Saving model ...
Epoch: 18 cost time: 0.6403408050537109
Epoch: 18, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.781 Vali Acc: 0.844 Test Loss: 0.781 Test Acc: 0.844
Validation loss decreased (-0.825918 --> -0.844437).  Saving model ...
Epoch: 19 cost time: 0.6056597232818604
Epoch: 19, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.725 Vali Acc: 0.856 Test Loss: 0.725 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855548).  Saving model ...
Epoch: 20 cost time: 0.6649777889251709
Epoch: 20, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.674 Vali Acc: 0.870 Test Loss: 0.674 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870364).  Saving model ...
Epoch: 21 cost time: 0.6439340114593506
Epoch: 21, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.625 Vali Acc: 0.874 Test Loss: 0.625 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 22 cost time: 0.7191386222839355
Epoch: 22, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.580 Vali Acc: 0.893 Test Loss: 0.580 Test Acc: 0.893
Validation loss decreased (-0.874068 --> -0.892587).  Saving model ...
Epoch: 23 cost time: 0.7239415645599365
Epoch: 23, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.539 Vali Acc: 0.896 Test Loss: 0.539 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 24 cost time: 0.6074533462524414
Epoch: 24, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.499 Vali Acc: 0.907 Test Loss: 0.499 Test Acc: 0.907
Validation loss decreased (-0.896291 --> -0.907402).  Saving model ...
Epoch: 25 cost time: 0.633406400680542
Epoch: 25, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.463 Vali Acc: 0.915 Test Loss: 0.463 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 26 cost time: 0.7332863807678223
Epoch: 26, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.432 Vali Acc: 0.915 Test Loss: 0.432 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 27 cost time: 0.5872805118560791
Epoch: 27, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.404 Vali Acc: 0.915 Test Loss: 0.404 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 28 cost time: 0.6311037540435791
Epoch: 28, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.379 Vali Acc: 0.919 Test Loss: 0.379 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 29 cost time: 0.5891785621643066
Epoch: 29, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.358 Vali Acc: 0.926 Test Loss: 0.358 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 0.6047971248626709
Epoch: 30, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.340 Vali Acc: 0.926 Test Loss: 0.340 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 31 cost time: 0.6368298530578613
Epoch: 31, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.324 Vali Acc: 0.926 Test Loss: 0.324 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 32 cost time: 0.5560357570648193
Epoch: 32, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 33 cost time: 0.5603532791137695
Epoch: 33, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.6244702339172363
Epoch: 34, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 35 cost time: 0.6048312187194824
Epoch: 35, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.5381145477294922
Epoch: 36, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 37 cost time: 0.5576047897338867
Epoch: 37, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.6106092929840088
Epoch: 38, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.5974061489105225
Epoch: 39, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.6074573993682861
Epoch: 40, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.5985186100006104
Epoch: 41, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.5719811916351318
Epoch: 42, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6733067035675049
Epoch: 43, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5486328601837158
Epoch: 44, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6293497085571289
Epoch: 45, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5707008838653564
Epoch: 46, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6452202796936035
Epoch: 47, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6395871639251709
Epoch: 48, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.5906252861022949
Epoch: 49, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6026561260223389
Epoch: 50, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.5679090023040771
Epoch: 51, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 112390
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4132742881774902
Epoch: 1, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.790 Vali Acc: 0.237 Test Loss: 1.790 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 0.6207356452941895
Epoch: 2, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.663 Vali Acc: 0.322 Test Loss: 1.663 Test Acc: 0.322
Validation loss decreased (-0.237019 --> -0.322206).  Saving model ...
Epoch: 3 cost time: 0.765667200088501
Epoch: 3, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.508 Vali Acc: 0.448 Test Loss: 1.508 Test Acc: 0.448
Validation loss decreased (-0.322206 --> -0.448133).  Saving model ...
Epoch: 4 cost time: 0.673717737197876
Epoch: 4, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.276 Vali Acc: 0.733 Test Loss: 1.276 Test Acc: 0.733
Validation loss decreased (-0.448133 --> -0.733321).  Saving model ...
Epoch: 5 cost time: 0.7339067459106445
Epoch: 5, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.037 Vali Acc: 0.793 Test Loss: 1.037 Test Acc: 0.793
Validation loss decreased (-0.733321 --> -0.792582).  Saving model ...
Epoch: 6 cost time: 0.7000687122344971
Epoch: 6, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.826 Vali Acc: 0.833 Test Loss: 0.826 Test Acc: 0.833
Validation loss decreased (-0.792582 --> -0.833325).  Saving model ...
Epoch: 7 cost time: 0.7265603542327881
Epoch: 7, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.663 Vali Acc: 0.870 Test Loss: 0.663 Test Acc: 0.870
Validation loss decreased (-0.833325 --> -0.870364).  Saving model ...
Epoch: 8 cost time: 0.6962342262268066
Epoch: 8, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.529 Vali Acc: 0.930 Test Loss: 0.529 Test Acc: 0.930
Validation loss decreased (-0.870364 --> -0.929624).  Saving model ...
Epoch: 9 cost time: 0.767725944519043
Epoch: 9, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.436 Vali Acc: 0.922 Test Loss: 0.436 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6935579776763916
Epoch: 10, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.360 Vali Acc: 0.944 Test Loss: 0.360 Test Acc: 0.944
Validation loss decreased (-0.929624 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 0.6269693374633789
Epoch: 11, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.309 Vali Acc: 0.937 Test Loss: 0.309 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6668455600738525
Epoch: 12, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.276 Vali Acc: 0.926 Test Loss: 0.276 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6846010684967041
Epoch: 13, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.759479284286499
Epoch: 14, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948146).  Saving model ...
Epoch: 15 cost time: 0.6404383182525635
Epoch: 15, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6747784614562988
Epoch: 16, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6647241115570068
Epoch: 17, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7013335227966309
Epoch: 18, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6940300464630127
Epoch: 19, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.730046272277832
Epoch: 20, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.937 Test Loss: 0.165 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6624195575714111
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.933 Test Loss: 0.169 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6948494911193848
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.930 Test Loss: 0.172 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.743706226348877
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.930 Test Loss: 0.175 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7075774669647217
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.930 Test Loss: 0.176 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 175750
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.515021562576294
Epoch: 1, Steps: 2 | Train Loss: 1.990 Vali Loss: 1.850 Vali Acc: 0.044 Test Loss: 1.850 Test Acc: 0.044
Validation loss decreased (inf --> -0.044426).  Saving model ...
Epoch: 2 cost time: 0.6809287071228027
Epoch: 2, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.754 Vali Acc: 0.141 Test Loss: 1.754 Test Acc: 0.141
Validation loss decreased (-0.044426 --> -0.140723).  Saving model ...
Epoch: 3 cost time: 0.6614770889282227
Epoch: 3, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.655 Vali Acc: 0.285 Test Loss: 1.655 Test Acc: 0.285
Validation loss decreased (-0.140723 --> -0.285169).  Saving model ...
Epoch: 4 cost time: 0.6885414123535156
Epoch: 4, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.522 Vali Acc: 0.419 Test Loss: 1.522 Test Acc: 0.419
Validation loss decreased (-0.285169 --> -0.418503).  Saving model ...
Epoch: 5 cost time: 0.6938419342041016
Epoch: 5, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.364 Vali Acc: 0.530 Test Loss: 1.364 Test Acc: 0.530
Validation loss decreased (-0.418503 --> -0.529616).  Saving model ...
Epoch: 6 cost time: 0.6646416187286377
Epoch: 6, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.202 Vali Acc: 0.641 Test Loss: 1.202 Test Acc: 0.641
Validation loss decreased (-0.529616 --> -0.640729).  Saving model ...
Epoch: 7 cost time: 0.6925077438354492
Epoch: 7, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.045 Vali Acc: 0.722 Test Loss: 1.045 Test Acc: 0.722
Validation loss decreased (-0.640729 --> -0.722212).  Saving model ...
Epoch: 8 cost time: 0.6782360076904297
Epoch: 8, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.903 Vali Acc: 0.793 Test Loss: 0.903 Test Acc: 0.793
Validation loss decreased (-0.722212 --> -0.792584).  Saving model ...
Epoch: 9 cost time: 0.627983808517456
Epoch: 9, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.774 Vali Acc: 0.844 Test Loss: 0.774 Test Acc: 0.844
Validation loss decreased (-0.792584 --> -0.844437).  Saving model ...
Epoch: 10 cost time: 0.7566103935241699
Epoch: 10, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.656 Vali Acc: 0.881 Test Loss: 0.656 Test Acc: 0.881
Validation loss decreased (-0.844437 --> -0.881475).  Saving model ...
Epoch: 11 cost time: 0.6596081256866455
Epoch: 11, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888883).  Saving model ...
Epoch: 12 cost time: 0.6604723930358887
Epoch: 12, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.474 Vali Acc: 0.904 Test Loss: 0.474 Test Acc: 0.904
Validation loss decreased (-0.888883 --> -0.903699).  Saving model ...
Epoch: 13 cost time: 0.6870591640472412
Epoch: 13, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.408 Vali Acc: 0.922 Test Loss: 0.408 Test Acc: 0.922
Validation loss decreased (-0.903699 --> -0.922218).  Saving model ...
Epoch: 14 cost time: 0.6039907932281494
Epoch: 14, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.354 Vali Acc: 0.926 Test Loss: 0.354 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 15 cost time: 0.6397757530212402
Epoch: 15, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937034).  Saving model ...
Epoch: 16 cost time: 0.673121452331543
Epoch: 16, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.6465201377868652
Epoch: 17, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.6831660270690918
Epoch: 18, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6635949611663818
Epoch: 19, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6722064018249512
Epoch: 20, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6351261138916016
Epoch: 21, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5955815315246582
Epoch: 22, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.6851339340209961
Epoch: 23, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.6760733127593994
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6004345417022705
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5684351921081543
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6142880916595459
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5524864196777344
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6317131519317627
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6397082805633545
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7603397369384766
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6401717662811279
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6435377597808838
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 125190
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.420833110809326
Epoch: 1, Steps: 2 | Train Loss: 2.073 Vali Loss: 1.924 Vali Acc: 0.204 Test Loss: 1.924 Test Acc: 0.204
Validation loss decreased (inf --> -0.203684).  Saving model ...
Epoch: 2 cost time: 0.6699154376983643
Epoch: 2, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.851 Vali Acc: 0.222 Test Loss: 1.851 Test Acc: 0.222
Validation loss decreased (-0.203684 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 0.633265495300293
Epoch: 3, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.780 Vali Acc: 0.259 Test Loss: 1.780 Test Acc: 0.259
Validation loss decreased (-0.222204 --> -0.259241).  Saving model ...
Epoch: 4 cost time: 0.6657309532165527
Epoch: 4, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.681 Vali Acc: 0.315 Test Loss: 1.681 Test Acc: 0.315
Validation loss decreased (-0.259241 --> -0.314798).  Saving model ...
Epoch: 5 cost time: 0.6950898170471191
Epoch: 5, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.554 Vali Acc: 0.415 Test Loss: 1.554 Test Acc: 0.415
Validation loss decreased (-0.314798 --> -0.414799).  Saving model ...
Epoch: 6 cost time: 0.617079496383667
Epoch: 6, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.409 Vali Acc: 0.607 Test Loss: 1.409 Test Acc: 0.607
Validation loss decreased (-0.414799 --> -0.607393).  Saving model ...
Epoch: 7 cost time: 0.6020393371582031
Epoch: 7, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.258 Vali Acc: 0.737 Test Loss: 1.258 Test Acc: 0.737
Validation loss decreased (-0.607393 --> -0.737024).  Saving model ...
Epoch: 8 cost time: 0.6491868495941162
Epoch: 8, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.108 Vali Acc: 0.807 Test Loss: 1.108 Test Acc: 0.807
Validation loss decreased (-0.737024 --> -0.807396).  Saving model ...
Epoch: 9 cost time: 0.6308047771453857
Epoch: 9, Steps: 2 | Train Loss: 0.975 Vali Loss: 0.967 Vali Acc: 0.867 Test Loss: 0.967 Test Acc: 0.867
Validation loss decreased (-0.807396 --> -0.866657).  Saving model ...
Epoch: 10 cost time: 0.6187210083007812
Epoch: 10, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.842 Vali Acc: 0.870 Test Loss: 0.842 Test Acc: 0.870
Validation loss decreased (-0.866657 --> -0.870362).  Saving model ...
Epoch: 11 cost time: 0.5973598957061768
Epoch: 11, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.732 Vali Acc: 0.885 Test Loss: 0.732 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885178).  Saving model ...
Epoch: 12 cost time: 0.6253528594970703
Epoch: 12, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.637 Vali Acc: 0.904 Test Loss: 0.637 Test Acc: 0.904
Validation loss decreased (-0.885178 --> -0.903697).  Saving model ...
Epoch: 13 cost time: 0.6353623867034912
Epoch: 13, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.554 Vali Acc: 0.926 Test Loss: 0.554 Test Acc: 0.926
Validation loss decreased (-0.903697 --> -0.925920).  Saving model ...
Epoch: 14 cost time: 0.5980899333953857
Epoch: 14, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.484 Vali Acc: 0.933 Test Loss: 0.484 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 15 cost time: 0.8255407810211182
Epoch: 15, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.428 Vali Acc: 0.937 Test Loss: 0.428 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937033).  Saving model ...
Epoch: 16 cost time: 0.5937609672546387
Epoch: 16, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.382 Vali Acc: 0.941 Test Loss: 0.382 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 17 cost time: 0.7944850921630859
Epoch: 17, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.342 Vali Acc: 0.933 Test Loss: 0.342 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6827938556671143
Epoch: 18, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.310 Vali Acc: 0.933 Test Loss: 0.310 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6261067390441895
Epoch: 19, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5737316608428955
Epoch: 20, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.5839433670043945
Epoch: 21, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5813515186309814
Epoch: 22, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5598123073577881
Epoch: 23, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6375925540924072
Epoch: 24, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7584328651428223
Epoch: 25, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.62734055519104
Epoch: 26, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5224955081939697
Epoch: 27, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5637161731719971
Epoch: 28, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.837421178817749
Epoch: 29, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5132176876068115
Epoch: 30, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 109894
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2307095527648926
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.829 Vali Acc: 0.207 Test Loss: 1.829 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 0.5329065322875977
Epoch: 2, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.768 Vali Acc: 0.274 Test Loss: 1.768 Test Acc: 0.274
Validation loss decreased (-0.207389 --> -0.274056).  Saving model ...
Epoch: 3 cost time: 0.6235244274139404
Epoch: 3, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.709 Vali Acc: 0.315 Test Loss: 1.709 Test Acc: 0.315
Validation loss decreased (-0.274056 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 0.5627572536468506
Epoch: 4, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.640 Vali Acc: 0.367 Test Loss: 1.640 Test Acc: 0.367
Validation loss decreased (-0.314798 --> -0.366650).  Saving model ...
Epoch: 5 cost time: 0.5484697818756104
Epoch: 5, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.555 Vali Acc: 0.430 Test Loss: 1.555 Test Acc: 0.430
Validation loss decreased (-0.366650 --> -0.429614).  Saving model ...
Epoch: 6 cost time: 0.5417270660400391
Epoch: 6, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.457 Vali Acc: 0.515 Test Loss: 1.457 Test Acc: 0.515
Validation loss decreased (-0.429614 --> -0.514800).  Saving model ...
Epoch: 7 cost time: 0.5777854919433594
Epoch: 7, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.351 Vali Acc: 0.559 Test Loss: 1.351 Test Acc: 0.559
Validation loss decreased (-0.514800 --> -0.559246).  Saving model ...
Epoch: 8 cost time: 0.6237733364105225
Epoch: 8, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.242 Vali Acc: 0.619 Test Loss: 1.242 Test Acc: 0.619
Validation loss decreased (-0.559246 --> -0.618506).  Saving model ...
Epoch: 9 cost time: 0.6518704891204834
Epoch: 9, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.134 Vali Acc: 0.667 Test Loss: 1.134 Test Acc: 0.667
Validation loss decreased (-0.618506 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 0.5815520286560059
Epoch: 10, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.028 Vali Acc: 0.722 Test Loss: 1.028 Test Acc: 0.722
Validation loss decreased (-0.666655 --> -0.722212).  Saving model ...
Epoch: 11 cost time: 0.5738649368286133
Epoch: 11, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.928 Vali Acc: 0.763 Test Loss: 0.928 Test Acc: 0.763
Validation loss decreased (-0.722212 --> -0.762954).  Saving model ...
Epoch: 12 cost time: 0.582312822341919
Epoch: 12, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.834 Vali Acc: 0.807 Test Loss: 0.834 Test Acc: 0.807
Validation loss decreased (-0.762954 --> -0.807399).  Saving model ...
Epoch: 13 cost time: 0.6085915565490723
Epoch: 13, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.748 Vali Acc: 0.830 Test Loss: 0.748 Test Acc: 0.830
Validation loss decreased (-0.807399 --> -0.829622).  Saving model ...
Epoch: 14 cost time: 0.6304106712341309
Epoch: 14, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.674 Vali Acc: 0.867 Test Loss: 0.674 Test Acc: 0.867
Validation loss decreased (-0.829622 --> -0.866660).  Saving model ...
Epoch: 15 cost time: 0.6038117408752441
Epoch: 15, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.609 Vali Acc: 0.874 Test Loss: 0.609 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874068).  Saving model ...
Epoch: 16 cost time: 0.6055567264556885
Epoch: 16, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.555 Vali Acc: 0.881 Test Loss: 0.555 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 17 cost time: 0.62237548828125
Epoch: 17, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
Validation loss decreased (-0.881476 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.5840234756469727
Epoch: 18, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.459 Vali Acc: 0.911 Test Loss: 0.459 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 0.6263105869293213
Epoch: 19, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.422 Vali Acc: 0.904 Test Loss: 0.422 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6478261947631836
Epoch: 20, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6153104305267334
Epoch: 21, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5806179046630859
Epoch: 22, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.340 Vali Acc: 0.904 Test Loss: 0.340 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.578402042388916
Epoch: 23, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.319 Vali Acc: 0.907 Test Loss: 0.319 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.628669023513794
Epoch: 24, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.297 Vali Acc: 0.915 Test Loss: 0.297 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914812).  Saving model ...
Epoch: 25 cost time: 0.6355664730072021
Epoch: 25, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.282 Vali Acc: 0.919 Test Loss: 0.282 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 26 cost time: 0.5350840091705322
Epoch: 26, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 27 cost time: 0.6026368141174316
Epoch: 27, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.5750479698181152
Epoch: 28, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.246 Vali Acc: 0.926 Test Loss: 0.246 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 29 cost time: 0.58815598487854
Epoch: 29, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.46740055084228516
Epoch: 30, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6459202766418457
Epoch: 31, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5026211738586426
Epoch: 32, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.46059107780456543
Epoch: 33, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5586776733398438
Epoch: 34, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.565619707107544
Epoch: 35, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5828497409820557
Epoch: 36, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5343890190124512
Epoch: 37, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7059502601623535
Epoch: 38, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5131819248199463
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 100806
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1257400512695312
Epoch: 1, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.784 Vali Acc: 0.189 Test Loss: 1.784 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.6130151748657227
Epoch: 2, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.715 Vali Acc: 0.196 Test Loss: 1.715 Test Acc: 0.196
Validation loss decreased (-0.188871 --> -0.196279).  Saving model ...
Epoch: 3 cost time: 0.5924320220947266
Epoch: 3, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.657 Vali Acc: 0.230 Test Loss: 1.657 Test Acc: 0.230
Validation loss decreased (-0.196279 --> -0.229613).  Saving model ...
Epoch: 4 cost time: 0.6253159046173096
Epoch: 4, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.591 Vali Acc: 0.304 Test Loss: 1.591 Test Acc: 0.304
Validation loss decreased (-0.229613 --> -0.303688).  Saving model ...
Epoch: 5 cost time: 0.5835306644439697
Epoch: 5, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.510 Vali Acc: 0.467 Test Loss: 1.510 Test Acc: 0.467
Validation loss decreased (-0.303688 --> -0.466652).  Saving model ...
Epoch: 6 cost time: 0.6711316108703613
Epoch: 6, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.420 Vali Acc: 0.574 Test Loss: 1.420 Test Acc: 0.574
Validation loss decreased (-0.466652 --> -0.574060).  Saving model ...
Epoch: 7 cost time: 0.6477322578430176
Epoch: 7, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.323 Vali Acc: 0.678 Test Loss: 1.323 Test Acc: 0.678
Validation loss decreased (-0.574060 --> -0.677765).  Saving model ...
Epoch: 8 cost time: 0.5938570499420166
Epoch: 8, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.223 Vali Acc: 0.737 Test Loss: 1.223 Test Acc: 0.737
Validation loss decreased (-0.677765 --> -0.737025).  Saving model ...
Epoch: 9 cost time: 0.6976354122161865
Epoch: 9, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.122 Vali Acc: 0.778 Test Loss: 1.122 Test Acc: 0.778
Validation loss decreased (-0.737025 --> -0.777767).  Saving model ...
Epoch: 10 cost time: 0.6101634502410889
Epoch: 10, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.026 Vali Acc: 0.804 Test Loss: 1.026 Test Acc: 0.804
Validation loss decreased (-0.777767 --> -0.803693).  Saving model ...
Epoch: 11 cost time: 0.562624454498291
Epoch: 11, Steps: 2 | Train Loss: 0.938 Vali Loss: 0.935 Vali Acc: 0.830 Test Loss: 0.935 Test Acc: 0.830
Validation loss decreased (-0.803693 --> -0.829620).  Saving model ...
Epoch: 12 cost time: 0.6465849876403809
Epoch: 12, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.851 Vali Acc: 0.833 Test Loss: 0.851 Test Acc: 0.833
Validation loss decreased (-0.829620 --> -0.833325).  Saving model ...
Epoch: 13 cost time: 0.5864017009735107
Epoch: 13, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.771 Vali Acc: 0.852 Test Loss: 0.771 Test Acc: 0.852
Validation loss decreased (-0.833325 --> -0.851844).  Saving model ...
Epoch: 14 cost time: 0.5649397373199463
Epoch: 14, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.701 Vali Acc: 0.870 Test Loss: 0.701 Test Acc: 0.870
Validation loss decreased (-0.851844 --> -0.870363).  Saving model ...
Epoch: 15 cost time: 0.6220884323120117
Epoch: 15, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.636 Vali Acc: 0.878 Test Loss: 0.636 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 16 cost time: 0.6431164741516113
Epoch: 16, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.579 Vali Acc: 0.900 Test Loss: 0.579 Test Acc: 0.900
Validation loss decreased (-0.877771 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.6394221782684326
Epoch: 17, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.528 Vali Acc: 0.907 Test Loss: 0.528 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 18 cost time: 0.5883748531341553
Epoch: 18, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.483 Vali Acc: 0.915 Test Loss: 0.483 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 19 cost time: 0.5944876670837402
Epoch: 19, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.443 Vali Acc: 0.911 Test Loss: 0.443 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5528819561004639
Epoch: 20, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.407 Vali Acc: 0.915 Test Loss: 0.407 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 21 cost time: 0.6548523902893066
Epoch: 21, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.376 Vali Acc: 0.922 Test Loss: 0.376 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922218).  Saving model ...
Epoch: 22 cost time: 0.6090602874755859
Epoch: 22, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.347 Vali Acc: 0.926 Test Loss: 0.347 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 23 cost time: 0.5611956119537354
Epoch: 23, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.323 Vali Acc: 0.937 Test Loss: 0.323 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937034).  Saving model ...
Epoch: 24 cost time: 0.5959568023681641
Epoch: 24, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.302 Vali Acc: 0.937 Test Loss: 0.302 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 25 cost time: 0.6298778057098389
Epoch: 25, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5954382419586182
Epoch: 26, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.270 Vali Acc: 0.930 Test Loss: 0.270 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5784895420074463
Epoch: 27, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.556178092956543
Epoch: 28, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5600495338439941
Epoch: 29, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5414860248565674
Epoch: 30, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5662426948547363
Epoch: 31, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.225 Vali Acc: 0.926 Test Loss: 0.225 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5867500305175781
Epoch: 32, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.628727912902832
Epoch: 33, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6226208209991455
Epoch: 34, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 96390
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1163527965545654
Epoch: 1, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.922 Vali Acc: 0.119 Test Loss: 1.922 Test Acc: 0.119
Validation loss decreased (inf --> -0.118499).  Saving model ...
Epoch: 2 cost time: 0.5347261428833008
Epoch: 2, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.866 Vali Acc: 0.137 Test Loss: 1.866 Test Acc: 0.137
Validation loss decreased (-0.118499 --> -0.137018).  Saving model ...
Epoch: 3 cost time: 0.5750718116760254
Epoch: 3, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.818 Vali Acc: 0.163 Test Loss: 1.818 Test Acc: 0.163
Validation loss decreased (-0.137018 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 0.6558425426483154
Epoch: 4, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.766 Vali Acc: 0.196 Test Loss: 1.766 Test Acc: 0.196
Validation loss decreased (-0.162945 --> -0.196279).  Saving model ...
Epoch: 5 cost time: 0.5956377983093262
Epoch: 5, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.700 Vali Acc: 0.263 Test Loss: 1.700 Test Acc: 0.263
Validation loss decreased (-0.196279 --> -0.262946).  Saving model ...
Epoch: 6 cost time: 0.6272943019866943
Epoch: 6, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.622 Vali Acc: 0.378 Test Loss: 1.622 Test Acc: 0.378
Validation loss decreased (-0.262946 --> -0.377762).  Saving model ...
Epoch: 7 cost time: 0.5836045742034912
Epoch: 7, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.536 Vali Acc: 0.485 Test Loss: 1.536 Test Acc: 0.485
Validation loss decreased (-0.377762 --> -0.485170).  Saving model ...
Epoch: 8 cost time: 0.7069869041442871
Epoch: 8, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.445 Vali Acc: 0.559 Test Loss: 1.445 Test Acc: 0.559
Validation loss decreased (-0.485170 --> -0.559245).  Saving model ...
Epoch: 9 cost time: 0.5664429664611816
Epoch: 9, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.350 Vali Acc: 0.607 Test Loss: 1.350 Test Acc: 0.607
Validation loss decreased (-0.559245 --> -0.607394).  Saving model ...
Epoch: 10 cost time: 0.6465268135070801
Epoch: 10, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.254 Vali Acc: 0.659 Test Loss: 1.254 Test Acc: 0.659
Validation loss decreased (-0.607394 --> -0.659247).  Saving model ...
Epoch: 11 cost time: 0.5704903602600098
Epoch: 11, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.160 Vali Acc: 0.696 Test Loss: 1.160 Test Acc: 0.696
Validation loss decreased (-0.659247 --> -0.696285).  Saving model ...
Epoch: 12 cost time: 0.6293771266937256
Epoch: 12, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.070 Vali Acc: 0.752 Test Loss: 1.070 Test Acc: 0.752
Validation loss decreased (-0.696285 --> -0.751841).  Saving model ...
Epoch: 13 cost time: 0.6621837615966797
Epoch: 13, Steps: 2 | Train Loss: 0.890 Vali Loss: 0.985 Vali Acc: 0.807 Test Loss: 0.985 Test Acc: 0.807
Validation loss decreased (-0.751841 --> -0.807398).  Saving model ...
Epoch: 14 cost time: 0.5599963665008545
Epoch: 14, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.905 Vali Acc: 0.837 Test Loss: 0.905 Test Acc: 0.837
Validation loss decreased (-0.807398 --> -0.837028).  Saving model ...
Epoch: 15 cost time: 0.6388649940490723
Epoch: 15, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.831 Vali Acc: 0.848 Test Loss: 0.831 Test Acc: 0.848
Validation loss decreased (-0.837028 --> -0.848140).  Saving model ...
Epoch: 16 cost time: 0.6129119396209717
Epoch: 16, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.766 Vali Acc: 0.856 Test Loss: 0.766 Test Acc: 0.856
Validation loss decreased (-0.848140 --> -0.855548).  Saving model ...
Epoch: 17 cost time: 0.6818490028381348
Epoch: 17, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.708 Vali Acc: 0.870 Test Loss: 0.708 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870363).  Saving model ...
Epoch: 18 cost time: 0.6789896488189697
Epoch: 18, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.655 Vali Acc: 0.878 Test Loss: 0.655 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 19 cost time: 0.6551487445831299
Epoch: 19, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.608 Vali Acc: 0.881 Test Loss: 0.608 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 20 cost time: 0.6374192237854004
Epoch: 20, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.564 Vali Acc: 0.881 Test Loss: 0.564 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 21 cost time: 0.6076259613037109
Epoch: 21, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.524 Vali Acc: 0.889 Test Loss: 0.524 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 22 cost time: 0.5895900726318359
Epoch: 22, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.487 Vali Acc: 0.889 Test Loss: 0.487 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 23 cost time: 0.5760910511016846
Epoch: 23, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.452 Vali Acc: 0.904 Test Loss: 0.452 Test Acc: 0.904
Validation loss decreased (-0.888884 --> -0.903699).  Saving model ...
Epoch: 24 cost time: 0.5538334846496582
Epoch: 24, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.421 Vali Acc: 0.911 Test Loss: 0.421 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911107).  Saving model ...
Epoch: 25 cost time: 0.5712747573852539
Epoch: 25, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.396 Vali Acc: 0.911 Test Loss: 0.396 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 26 cost time: 0.5633394718170166
Epoch: 26, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.371 Vali Acc: 0.915 Test Loss: 0.371 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 27 cost time: 0.5768418312072754
Epoch: 27, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.350 Vali Acc: 0.919 Test Loss: 0.350 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 28 cost time: 0.644096851348877
Epoch: 28, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.331 Vali Acc: 0.933 Test Loss: 0.331 Test Acc: 0.933
Validation loss decreased (-0.918515 --> -0.933330).  Saving model ...
Epoch: 29 cost time: 0.662517786026001
Epoch: 29, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.313 Vali Acc: 0.933 Test Loss: 0.313 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 30 cost time: 0.5663015842437744
Epoch: 30, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 31 cost time: 0.5671122074127197
Epoch: 31, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.284 Vali Acc: 0.937 Test Loss: 0.284 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.587594747543335
Epoch: 32, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 33 cost time: 0.5762827396392822
Epoch: 33, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6789393424987793
Epoch: 34, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 35 cost time: 0.5392482280731201
Epoch: 35, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5653693675994873
Epoch: 36, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6197152137756348
Epoch: 37, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6195428371429443
Epoch: 38, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5914568901062012
Epoch: 39, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6361794471740723
Epoch: 40, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.534752368927002
Epoch: 41, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5696029663085938
Epoch: 42, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5333294868469238
Epoch: 43, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.688788652420044
Epoch: 44, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 90438
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.079923152923584
Epoch: 1, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.846 Vali Acc: 0.319 Test Loss: 1.846 Test Acc: 0.319
Validation loss decreased (inf --> -0.318500).  Saving model ...
Epoch: 2 cost time: 0.5802171230316162
Epoch: 2, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.796 Vali Acc: 0.337 Test Loss: 1.796 Test Acc: 0.337
Validation loss decreased (-0.318500 --> -0.337019).  Saving model ...
Epoch: 3 cost time: 0.6696529388427734
Epoch: 3, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.753 Vali Acc: 0.363 Test Loss: 1.753 Test Acc: 0.363
Validation loss decreased (-0.337019 --> -0.362945).  Saving model ...
Epoch: 4 cost time: 0.6660220623016357
Epoch: 4, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.707 Vali Acc: 0.381 Test Loss: 1.707 Test Acc: 0.381
Validation loss decreased (-0.362945 --> -0.381464).  Saving model ...
Epoch: 5 cost time: 0.5961229801177979
Epoch: 5, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.652 Vali Acc: 0.400 Test Loss: 1.652 Test Acc: 0.400
Validation loss decreased (-0.381464 --> -0.399983).  Saving model ...
Epoch: 6 cost time: 0.5690536499023438
Epoch: 6, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.592 Vali Acc: 0.426 Test Loss: 1.592 Test Acc: 0.426
Validation loss decreased (-0.399983 --> -0.425910).  Saving model ...
Epoch: 7 cost time: 0.6208572387695312
Epoch: 7, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.525 Vali Acc: 0.444 Test Loss: 1.525 Test Acc: 0.444
Validation loss decreased (-0.425910 --> -0.444429).  Saving model ...
Epoch: 8 cost time: 0.69338059425354
Epoch: 8, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.456 Vali Acc: 0.467 Test Loss: 1.456 Test Acc: 0.467
Validation loss decreased (-0.444429 --> -0.466652).  Saving model ...
Epoch: 9 cost time: 0.6128747463226318
Epoch: 9, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.383 Vali Acc: 0.496 Test Loss: 1.383 Test Acc: 0.496
Validation loss decreased (-0.466652 --> -0.496282).  Saving model ...
Epoch: 10 cost time: 0.6114640235900879
Epoch: 10, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.308 Vali Acc: 0.522 Test Loss: 1.308 Test Acc: 0.522
Validation loss decreased (-0.496282 --> -0.522209).  Saving model ...
Epoch: 11 cost time: 0.583808422088623
Epoch: 11, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.230 Vali Acc: 0.578 Test Loss: 1.230 Test Acc: 0.578
Validation loss decreased (-0.522209 --> -0.577765).  Saving model ...
Epoch: 12 cost time: 0.5944483280181885
Epoch: 12, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.153 Vali Acc: 0.626 Test Loss: 1.153 Test Acc: 0.626
Validation loss decreased (-0.577765 --> -0.625914).  Saving model ...
Epoch: 13 cost time: 0.6584420204162598
Epoch: 13, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.079 Vali Acc: 0.670 Test Loss: 1.079 Test Acc: 0.670
Validation loss decreased (-0.625914 --> -0.670360).  Saving model ...
Epoch: 14 cost time: 0.5851705074310303
Epoch: 14, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.006 Vali Acc: 0.733 Test Loss: 1.006 Test Acc: 0.733
Validation loss decreased (-0.670360 --> -0.733323).  Saving model ...
Epoch: 15 cost time: 0.5360982418060303
Epoch: 15, Steps: 2 | Train Loss: 0.941 Vali Loss: 0.937 Vali Acc: 0.763 Test Loss: 0.937 Test Acc: 0.763
Validation loss decreased (-0.733323 --> -0.762954).  Saving model ...
Epoch: 16 cost time: 0.5463171005249023
Epoch: 16, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.871 Vali Acc: 0.807 Test Loss: 0.871 Test Acc: 0.807
Validation loss decreased (-0.762954 --> -0.807399).  Saving model ...
Epoch: 17 cost time: 0.6959145069122314
Epoch: 17, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.809 Vali Acc: 0.833 Test Loss: 0.809 Test Acc: 0.833
Validation loss decreased (-0.807399 --> -0.833325).  Saving model ...
Epoch: 18 cost time: 0.7279098033905029
Epoch: 18, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.751 Vali Acc: 0.852 Test Loss: 0.751 Test Acc: 0.852
Validation loss decreased (-0.833325 --> -0.851844).  Saving model ...
Epoch: 19 cost time: 0.6394999027252197
Epoch: 19, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.698 Vali Acc: 0.863 Test Loss: 0.698 Test Acc: 0.863
Validation loss decreased (-0.851844 --> -0.862956).  Saving model ...
Epoch: 20 cost time: 0.6981735229492188
Epoch: 20, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.648 Vali Acc: 0.889 Test Loss: 0.648 Test Acc: 0.889
Validation loss decreased (-0.862956 --> -0.888882).  Saving model ...
Epoch: 21 cost time: 0.6388399600982666
Epoch: 21, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.603 Vali Acc: 0.889 Test Loss: 0.603 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 22 cost time: 0.630120038986206
Epoch: 22, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.561 Vali Acc: 0.885 Test Loss: 0.561 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6359970569610596
Epoch: 23, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.524 Vali Acc: 0.915 Test Loss: 0.524 Test Acc: 0.915
Validation loss decreased (-0.888883 --> -0.914810).  Saving model ...
Epoch: 24 cost time: 0.5892810821533203
Epoch: 24, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.490 Vali Acc: 0.926 Test Loss: 0.490 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925921).  Saving model ...
Epoch: 25 cost time: 0.5392036437988281
Epoch: 25, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.458 Vali Acc: 0.926 Test Loss: 0.458 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 26 cost time: 0.6111974716186523
Epoch: 26, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.429 Vali Acc: 0.930 Test Loss: 0.429 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 27 cost time: 0.6314060688018799
Epoch: 27, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.403 Vali Acc: 0.933 Test Loss: 0.403 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 28 cost time: 0.4888038635253906
Epoch: 28, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.380 Vali Acc: 0.937 Test Loss: 0.380 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 29 cost time: 0.5798656940460205
Epoch: 29, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.360 Vali Acc: 0.937 Test Loss: 0.360 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 30 cost time: 0.5590298175811768
Epoch: 30, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.345 Vali Acc: 0.937 Test Loss: 0.345 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.5593698024749756
Epoch: 31, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940737).  Saving model ...
Epoch: 32 cost time: 0.5686674118041992
Epoch: 32, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5546913146972656
Epoch: 33, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.307 Vali Acc: 0.930 Test Loss: 0.307 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5659031867980957
Epoch: 34, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.297 Vali Acc: 0.933 Test Loss: 0.297 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6632239818572998
Epoch: 35, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.285 Vali Acc: 0.941 Test Loss: 0.285 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.6341607570648193
Epoch: 36, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.6238856315612793
Epoch: 37, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.5625553131103516
Epoch: 38, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5721604824066162
Epoch: 39, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6526474952697754
Epoch: 40, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.246 Vali Acc: 0.948 Test Loss: 0.246 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.7047934532165527
Epoch: 41, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 42 cost time: 0.6777937412261963
Epoch: 42, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.235 Vali Acc: 0.952 Test Loss: 0.235 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 43 cost time: 0.6793532371520996
Epoch: 43, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7751798629760742
Epoch: 44, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8199517726898193
Epoch: 45, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7212283611297607
Epoch: 46, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7510671615600586
Epoch: 47, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7967398166656494
Epoch: 48, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7564256191253662
Epoch: 49, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7053694725036621
Epoch: 50, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7630751132965088
Epoch: 51, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.7431368827819824
Epoch: 52, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm64_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 87622
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6073100566864014
Epoch: 1, Steps: 2 | Train Loss: 2.054 Vali Loss: 1.852 Vali Acc: 0.170 Test Loss: 1.852 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.7116882801055908
Epoch: 2, Steps: 2 | Train Loss: 1.968 Vali Loss: 1.761 Vali Acc: 0.204 Test Loss: 1.761 Test Acc: 0.204
Validation loss decreased (-0.170352 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.7176690101623535
Epoch: 3, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.669 Vali Acc: 0.259 Test Loss: 1.669 Test Acc: 0.259
Validation loss decreased (-0.203686 --> -0.259243).  Saving model ...
Epoch: 4 cost time: 0.6691269874572754
Epoch: 4, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.541 Vali Acc: 0.407 Test Loss: 1.541 Test Acc: 0.407
Validation loss decreased (-0.259243 --> -0.407392).  Saving model ...
Epoch: 5 cost time: 0.763556957244873
Epoch: 5, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.386 Vali Acc: 0.581 Test Loss: 1.386 Test Acc: 0.581
Validation loss decreased (-0.407392 --> -0.581468).  Saving model ...
Epoch: 6 cost time: 0.6658725738525391
Epoch: 6, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.220 Vali Acc: 0.719 Test Loss: 1.220 Test Acc: 0.719
Validation loss decreased (-0.581468 --> -0.718506).  Saving model ...
Epoch: 7 cost time: 0.6303122043609619
Epoch: 7, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.057 Vali Acc: 0.800 Test Loss: 1.057 Test Acc: 0.800
Validation loss decreased (-0.718506 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 0.6116199493408203
Epoch: 8, Steps: 2 | Train Loss: 0.958 Vali Loss: 0.911 Vali Acc: 0.837 Test Loss: 0.911 Test Acc: 0.837
Validation loss decreased (-0.799989 --> -0.837028).  Saving model ...
Epoch: 9 cost time: 0.6497640609741211
Epoch: 9, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.776 Vali Acc: 0.874 Test Loss: 0.776 Test Acc: 0.874
Validation loss decreased (-0.837028 --> -0.874066).  Saving model ...
Epoch: 10 cost time: 0.7493531703948975
Epoch: 10, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.660 Vali Acc: 0.911 Test Loss: 0.660 Test Acc: 0.911
Validation loss decreased (-0.874066 --> -0.911105).  Saving model ...
Epoch: 11 cost time: 0.6197860240936279
Epoch: 11, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.565 Vali Acc: 0.911 Test Loss: 0.565 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 12 cost time: 0.7356641292572021
Epoch: 12, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.491 Vali Acc: 0.926 Test Loss: 0.491 Test Acc: 0.926
Validation loss decreased (-0.911105 --> -0.925921).  Saving model ...
Epoch: 13 cost time: 0.7355108261108398
Epoch: 13, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.428 Vali Acc: 0.922 Test Loss: 0.428 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6268317699432373
Epoch: 14, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.377 Vali Acc: 0.926 Test Loss: 0.377 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 15 cost time: 0.6588494777679443
Epoch: 15, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
Validation loss decreased (-0.925922 --> -0.940737).  Saving model ...
Epoch: 16 cost time: 0.585838794708252
Epoch: 16, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.296 Vali Acc: 0.937 Test Loss: 0.296 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5640802383422852
Epoch: 17, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 18 cost time: 0.7114601135253906
Epoch: 18, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.61086106300354
Epoch: 19, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6444363594055176
Epoch: 20, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.678391695022583
Epoch: 21, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7818958759307861
Epoch: 22, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.715198278427124
Epoch: 23, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.5615856647491455
Epoch: 24, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.6271741390228271
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.6099400520324707
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.5950613021850586
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.937 Test Loss: 0.165 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6622099876403809
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.930 Test Loss: 0.168 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7691543102264404
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.930 Test Loss: 0.171 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7330317497253418
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.926 Test Loss: 0.174 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7851297855377197
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.922 Test Loss: 0.177 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7517530918121338
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.922 Test Loss: 0.178 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7310144901275635
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.922 Test Loss: 0.180 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7517490386962891
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.922 Test Loss: 0.180 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7626810073852539
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.922 Test Loss: 0.179 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6303281784057617
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.926 Test Loss: 0.178 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 113126
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3319385051727295
Epoch: 1, Steps: 2 | Train Loss: 1.984 Vali Loss: 1.760 Vali Acc: 0.207 Test Loss: 1.760 Test Acc: 0.207
Validation loss decreased (inf --> -0.207390).  Saving model ...
Epoch: 2 cost time: 0.5822749137878418
Epoch: 2, Steps: 2 | Train Loss: 1.966 Vali Loss: 1.703 Vali Acc: 0.226 Test Loss: 1.703 Test Acc: 0.226
Validation loss decreased (-0.207390 --> -0.225909).  Saving model ...
Epoch: 3 cost time: 0.5990631580352783
Epoch: 3, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.649 Vali Acc: 0.259 Test Loss: 1.649 Test Acc: 0.259
Validation loss decreased (-0.225909 --> -0.259243).  Saving model ...
Epoch: 4 cost time: 0.6594367027282715
Epoch: 4, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.578 Vali Acc: 0.307 Test Loss: 1.578 Test Acc: 0.307
Validation loss decreased (-0.259243 --> -0.307392).  Saving model ...
Epoch: 5 cost time: 0.6098949909210205
Epoch: 5, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.489 Vali Acc: 0.385 Test Loss: 1.489 Test Acc: 0.385
Validation loss decreased (-0.307392 --> -0.385170).  Saving model ...
Epoch: 6 cost time: 0.6971766948699951
Epoch: 6, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.385 Vali Acc: 0.504 Test Loss: 1.385 Test Acc: 0.504
Validation loss decreased (-0.385170 --> -0.503690).  Saving model ...
Epoch: 7 cost time: 0.6611051559448242
Epoch: 7, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.275 Vali Acc: 0.622 Test Loss: 1.275 Test Acc: 0.622
Validation loss decreased (-0.503690 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 0.6248149871826172
Epoch: 8, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.163 Vali Acc: 0.681 Test Loss: 1.163 Test Acc: 0.681
Validation loss decreased (-0.622209 --> -0.681470).  Saving model ...
Epoch: 9 cost time: 0.585453987121582
Epoch: 9, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.054 Vali Acc: 0.737 Test Loss: 1.054 Test Acc: 0.737
Validation loss decreased (-0.681470 --> -0.737026).  Saving model ...
Epoch: 10 cost time: 0.6460983753204346
Epoch: 10, Steps: 2 | Train Loss: 1.058 Vali Loss: 0.952 Vali Acc: 0.756 Test Loss: 0.952 Test Acc: 0.756
Validation loss decreased (-0.737026 --> -0.755546).  Saving model ...
Epoch: 11 cost time: 0.7272615432739258
Epoch: 11, Steps: 2 | Train Loss: 0.923 Vali Loss: 0.855 Vali Acc: 0.781 Test Loss: 0.855 Test Acc: 0.781
Validation loss decreased (-0.755546 --> -0.781473).  Saving model ...
Epoch: 12 cost time: 0.5995209217071533
Epoch: 12, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.765 Vali Acc: 0.822 Test Loss: 0.765 Test Acc: 0.822
Validation loss decreased (-0.781473 --> -0.822215).  Saving model ...
Epoch: 13 cost time: 0.6199567317962646
Epoch: 13, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.685 Vali Acc: 0.867 Test Loss: 0.685 Test Acc: 0.867
Validation loss decreased (-0.822215 --> -0.866660).  Saving model ...
Epoch: 14 cost time: 0.5351786613464355
Epoch: 14, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.614 Vali Acc: 0.893 Test Loss: 0.614 Test Acc: 0.893
Validation loss decreased (-0.866660 --> -0.892586).  Saving model ...
Epoch: 15 cost time: 0.6008892059326172
Epoch: 15, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.550 Vali Acc: 0.911 Test Loss: 0.550 Test Acc: 0.911
Validation loss decreased (-0.892586 --> -0.911106).  Saving model ...
Epoch: 16 cost time: 0.5802733898162842
Epoch: 16, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.495 Vali Acc: 0.919 Test Loss: 0.495 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 17 cost time: 0.6021065711975098
Epoch: 17, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.447 Vali Acc: 0.922 Test Loss: 0.447 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 18 cost time: 0.6225366592407227
Epoch: 18, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.406 Vali Acc: 0.941 Test Loss: 0.406 Test Acc: 0.941
Validation loss decreased (-0.922218 --> -0.940737).  Saving model ...
Epoch: 19 cost time: 0.6519615650177002
Epoch: 19, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.371 Vali Acc: 0.941 Test Loss: 0.371 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 20 cost time: 0.5555942058563232
Epoch: 20, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.340 Vali Acc: 0.944 Test Loss: 0.340 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.6135168075561523
Epoch: 21, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.313 Vali Acc: 0.941 Test Loss: 0.313 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5355420112609863
Epoch: 22, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.593949556350708
Epoch: 23, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5443882942199707
Epoch: 24, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6588485240936279
Epoch: 25, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7548086643218994
Epoch: 26, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7731821537017822
Epoch: 27, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6331348419189453
Epoch: 28, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5374746322631836
Epoch: 29, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5048236846923828
Epoch: 30, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 87846
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2018609046936035
Epoch: 1, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.880 Vali Acc: 0.207 Test Loss: 1.880 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 0.573265790939331
Epoch: 2, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.806 Vali Acc: 0.226 Test Loss: 1.806 Test Acc: 0.226
Validation loss decreased (-0.207389 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.5950686931610107
Epoch: 3, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.746 Vali Acc: 0.244 Test Loss: 1.746 Test Acc: 0.244
Validation loss decreased (-0.225908 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 0.5564696788787842
Epoch: 4, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.682 Vali Acc: 0.300 Test Loss: 1.682 Test Acc: 0.300
Validation loss decreased (-0.244427 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 0.5949304103851318
Epoch: 5, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.606 Vali Acc: 0.348 Test Loss: 1.606 Test Acc: 0.348
Validation loss decreased (-0.299983 --> -0.348132).  Saving model ...
Epoch: 6 cost time: 0.6469449996948242
Epoch: 6, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.522 Vali Acc: 0.400 Test Loss: 1.522 Test Acc: 0.400
Validation loss decreased (-0.348132 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 0.5786681175231934
Epoch: 7, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.429 Vali Acc: 0.481 Test Loss: 1.429 Test Acc: 0.481
Validation loss decreased (-0.399985 --> -0.481467).  Saving model ...
Epoch: 8 cost time: 0.5469858646392822
Epoch: 8, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.334 Vali Acc: 0.522 Test Loss: 1.334 Test Acc: 0.522
Validation loss decreased (-0.481467 --> -0.522209).  Saving model ...
Epoch: 9 cost time: 0.6072168350219727
Epoch: 9, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.236 Vali Acc: 0.619 Test Loss: 1.236 Test Acc: 0.619
Validation loss decreased (-0.522209 --> -0.618506).  Saving model ...
Epoch: 10 cost time: 0.6057243347167969
Epoch: 10, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.140 Vali Acc: 0.696 Test Loss: 1.140 Test Acc: 0.696
Validation loss decreased (-0.618506 --> -0.696285).  Saving model ...
Epoch: 11 cost time: 0.6343741416931152
Epoch: 11, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.047 Vali Acc: 0.752 Test Loss: 1.047 Test Acc: 0.752
Validation loss decreased (-0.696285 --> -0.751841).  Saving model ...
Epoch: 12 cost time: 0.5601279735565186
Epoch: 12, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.959 Vali Acc: 0.785 Test Loss: 0.959 Test Acc: 0.785
Validation loss decreased (-0.751841 --> -0.785176).  Saving model ...
Epoch: 13 cost time: 0.6192872524261475
Epoch: 13, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.876 Vali Acc: 0.819 Test Loss: 0.876 Test Acc: 0.819
Validation loss decreased (-0.785176 --> -0.818510).  Saving model ...
Epoch: 14 cost time: 0.6282196044921875
Epoch: 14, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.799 Vali Acc: 0.848 Test Loss: 0.799 Test Acc: 0.848
Validation loss decreased (-0.818510 --> -0.848140).  Saving model ...
Epoch: 15 cost time: 0.5876836776733398
Epoch: 15, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.728 Vali Acc: 0.863 Test Loss: 0.728 Test Acc: 0.863
Validation loss decreased (-0.848140 --> -0.862956).  Saving model ...
Epoch: 16 cost time: 0.688786506652832
Epoch: 16, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.663 Vali Acc: 0.881 Test Loss: 0.663 Test Acc: 0.881
Validation loss decreased (-0.862956 --> -0.881475).  Saving model ...
Epoch: 17 cost time: 0.558039665222168
Epoch: 17, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.605 Vali Acc: 0.889 Test Loss: 0.605 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888883).  Saving model ...
Epoch: 18 cost time: 0.6089415550231934
Epoch: 18, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.552 Vali Acc: 0.896 Test Loss: 0.552 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 19 cost time: 0.6671619415283203
Epoch: 19, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.506 Vali Acc: 0.896 Test Loss: 0.506 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 20 cost time: 0.6242740154266357
Epoch: 20, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.7271280288696289
Epoch: 21, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.432 Vali Acc: 0.904 Test Loss: 0.432 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 22 cost time: 0.6232349872589111
Epoch: 22, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.400 Vali Acc: 0.904 Test Loss: 0.400 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903700).  Saving model ...
Epoch: 23 cost time: 0.6275081634521484
Epoch: 23, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.371 Vali Acc: 0.911 Test Loss: 0.371 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911107).  Saving model ...
Epoch: 24 cost time: 0.6493961811065674
Epoch: 24, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.347 Vali Acc: 0.915 Test Loss: 0.347 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 25 cost time: 0.7177760601043701
Epoch: 25, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.325 Vali Acc: 0.911 Test Loss: 0.325 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6882908344268799
Epoch: 26, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.306 Vali Acc: 0.922 Test Loss: 0.306 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 27 cost time: 0.5593013763427734
Epoch: 27, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8451673984527588
Epoch: 28, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 29 cost time: 0.6643881797790527
Epoch: 29, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.266 Vali Acc: 0.926 Test Loss: 0.266 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 30 cost time: 0.7392542362213135
Epoch: 30, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 31 cost time: 0.6658918857574463
Epoch: 31, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 32 cost time: 0.5876307487487793
Epoch: 32, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 33 cost time: 0.6722040176391602
Epoch: 33, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.7026102542877197
Epoch: 34, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.929627 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.6521732807159424
Epoch: 35, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5291135311126709
Epoch: 36, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.5618250370025635
Epoch: 37, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5654830932617188
Epoch: 38, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5380120277404785
Epoch: 39, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6381344795227051
Epoch: 40, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6007893085479736
Epoch: 41, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.6299262046813965
Epoch: 42, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6029388904571533
Epoch: 43, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.641416072845459
Epoch: 44, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5426063537597656
Epoch: 45, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5678744316101074
Epoch: 46, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6018717288970947
Epoch: 47, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.546576976776123
Epoch: 48, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.5178806781768799
Epoch: 49, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6256308555603027
Epoch: 50, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.5562396049499512
Epoch: 51, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 80198
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.506286382675171
Epoch: 1, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.997 Vali Acc: 0.144 Test Loss: 1.997 Test Acc: 0.144
Validation loss decreased (inf --> -0.144424).  Saving model ...
Epoch: 2 cost time: 0.6686537265777588
Epoch: 2, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.922 Vali Acc: 0.152 Test Loss: 1.922 Test Acc: 0.152
Validation loss decreased (-0.144424 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 0.6726388931274414
Epoch: 3, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.858 Vali Acc: 0.144 Test Loss: 1.858 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.643852949142456
Epoch: 4, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.795 Vali Acc: 0.156 Test Loss: 1.795 Test Acc: 0.156
Validation loss decreased (-0.151833 --> -0.155538).  Saving model ...
Epoch: 5 cost time: 0.669008731842041
Epoch: 5, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.724 Vali Acc: 0.189 Test Loss: 1.724 Test Acc: 0.189
Validation loss decreased (-0.155538 --> -0.188872).  Saving model ...
Epoch: 6 cost time: 0.6749725341796875
Epoch: 6, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.646 Vali Acc: 0.230 Test Loss: 1.646 Test Acc: 0.230
Validation loss decreased (-0.188872 --> -0.229613).  Saving model ...
Epoch: 7 cost time: 0.6923527717590332
Epoch: 7, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.563 Vali Acc: 0.270 Test Loss: 1.563 Test Acc: 0.270
Validation loss decreased (-0.229613 --> -0.270355).  Saving model ...
Epoch: 8 cost time: 0.6391088962554932
Epoch: 8, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.474 Vali Acc: 0.341 Test Loss: 1.474 Test Acc: 0.341
Validation loss decreased (-0.270355 --> -0.340726).  Saving model ...
Epoch: 9 cost time: 0.5584194660186768
Epoch: 9, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.383 Vali Acc: 0.511 Test Loss: 1.383 Test Acc: 0.511
Validation loss decreased (-0.340726 --> -0.511097).  Saving model ...
Epoch: 10 cost time: 0.5571079254150391
Epoch: 10, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.291 Vali Acc: 0.681 Test Loss: 1.291 Test Acc: 0.681
Validation loss decreased (-0.511097 --> -0.681469).  Saving model ...
Epoch: 11 cost time: 0.6060113906860352
Epoch: 11, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.202 Vali Acc: 0.704 Test Loss: 1.202 Test Acc: 0.704
Validation loss decreased (-0.681469 --> -0.703692).  Saving model ...
Epoch: 12 cost time: 0.5328047275543213
Epoch: 12, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.116 Vali Acc: 0.741 Test Loss: 1.116 Test Acc: 0.741
Validation loss decreased (-0.703692 --> -0.740730).  Saving model ...
Epoch: 13 cost time: 0.5445711612701416
Epoch: 13, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.035 Vali Acc: 0.770 Test Loss: 1.035 Test Acc: 0.770
Validation loss decreased (-0.740730 --> -0.770360).  Saving model ...
Epoch: 14 cost time: 0.5620660781860352
Epoch: 14, Steps: 2 | Train Loss: 1.008 Vali Loss: 0.958 Vali Acc: 0.796 Test Loss: 0.958 Test Acc: 0.796
Validation loss decreased (-0.770360 --> -0.796287).  Saving model ...
Epoch: 15 cost time: 0.5124082565307617
Epoch: 15, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.887 Vali Acc: 0.807 Test Loss: 0.887 Test Acc: 0.807
Validation loss decreased (-0.796287 --> -0.807399).  Saving model ...
Epoch: 16 cost time: 0.5638909339904785
Epoch: 16, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.820 Vali Acc: 0.815 Test Loss: 0.820 Test Acc: 0.815
Validation loss decreased (-0.807399 --> -0.814807).  Saving model ...
Epoch: 17 cost time: 0.6534030437469482
Epoch: 17, Steps: 2 | Train Loss: 0.778 Vali Loss: 0.757 Vali Acc: 0.833 Test Loss: 0.757 Test Acc: 0.833
Validation loss decreased (-0.814807 --> -0.833326).  Saving model ...
Epoch: 18 cost time: 0.6153016090393066
Epoch: 18, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.699 Vali Acc: 0.870 Test Loss: 0.699 Test Acc: 0.870
Validation loss decreased (-0.833326 --> -0.870363).  Saving model ...
Epoch: 19 cost time: 0.6377568244934082
Epoch: 19, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.646 Vali Acc: 0.881 Test Loss: 0.646 Test Acc: 0.881
Validation loss decreased (-0.870363 --> -0.881475).  Saving model ...
Epoch: 20 cost time: 0.5420553684234619
Epoch: 20, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.598 Vali Acc: 0.896 Test Loss: 0.598 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896290).  Saving model ...
Epoch: 21 cost time: 0.5100224018096924
Epoch: 21, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.6094558238983154
Epoch: 22, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.518 Vali Acc: 0.915 Test Loss: 0.518 Test Acc: 0.915
Validation loss decreased (-0.899994 --> -0.914810).  Saving model ...
Epoch: 23 cost time: 0.6099073886871338
Epoch: 23, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.482 Vali Acc: 0.922 Test Loss: 0.482 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922217).  Saving model ...
Epoch: 24 cost time: 0.5765690803527832
Epoch: 24, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.450 Vali Acc: 0.926 Test Loss: 0.450 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 25 cost time: 0.5590276718139648
Epoch: 25, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.421 Vali Acc: 0.922 Test Loss: 0.421 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5977656841278076
Epoch: 26, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.395 Vali Acc: 0.922 Test Loss: 0.395 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6475095748901367
Epoch: 27, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.374 Vali Acc: 0.922 Test Loss: 0.374 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.47437119483947754
Epoch: 28, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5092730522155762
Epoch: 29, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.336 Vali Acc: 0.919 Test Loss: 0.336 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6441450119018555
Epoch: 30, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6027209758758545
Epoch: 31, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925923).  Saving model ...
Epoch: 32 cost time: 0.6598846912384033
Epoch: 32, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 33 cost time: 0.6453554630279541
Epoch: 33, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 34 cost time: 0.5372812747955322
Epoch: 34, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5385937690734863
Epoch: 35, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6931662559509277
Epoch: 36, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5884733200073242
Epoch: 37, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5686719417572021
Epoch: 38, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.556053876876831
Epoch: 39, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5892467498779297
Epoch: 40, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7145190238952637
Epoch: 41, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6133224964141846
Epoch: 42, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6769440174102783
Epoch: 43, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 75654
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3945863246917725
Epoch: 1, Steps: 2 | Train Loss: 2.074 Vali Loss: 1.897 Vali Acc: 0.174 Test Loss: 1.897 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 0.5876672267913818
Epoch: 2, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.842 Vali Acc: 0.200 Test Loss: 1.842 Test Acc: 0.200
Validation loss decreased (-0.174055 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.6347882747650146
Epoch: 3, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.798 Vali Acc: 0.219 Test Loss: 1.798 Test Acc: 0.219
Validation loss decreased (-0.199982 --> -0.218501).  Saving model ...
Epoch: 4 cost time: 0.6359949111938477
Epoch: 4, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.755 Vali Acc: 0.237 Test Loss: 1.755 Test Acc: 0.237
Validation loss decreased (-0.218501 --> -0.237019).  Saving model ...
Epoch: 5 cost time: 0.638817548751831
Epoch: 5, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.703 Vali Acc: 0.267 Test Loss: 1.703 Test Acc: 0.267
Validation loss decreased (-0.237019 --> -0.266650).  Saving model ...
Epoch: 6 cost time: 0.568751335144043
Epoch: 6, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.642 Vali Acc: 0.300 Test Loss: 1.642 Test Acc: 0.300
Validation loss decreased (-0.266650 --> -0.299984).  Saving model ...
Epoch: 7 cost time: 0.6380774974822998
Epoch: 7, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.577 Vali Acc: 0.337 Test Loss: 1.577 Test Acc: 0.337
Validation loss decreased (-0.299984 --> -0.337021).  Saving model ...
Epoch: 8 cost time: 0.5876507759094238
Epoch: 8, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.507 Vali Acc: 0.367 Test Loss: 1.507 Test Acc: 0.367
Validation loss decreased (-0.337021 --> -0.366652).  Saving model ...
Epoch: 9 cost time: 0.5147929191589355
Epoch: 9, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.434 Vali Acc: 0.441 Test Loss: 1.434 Test Acc: 0.441
Validation loss decreased (-0.366652 --> -0.440726).  Saving model ...
Epoch: 10 cost time: 0.6155691146850586
Epoch: 10, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.361 Vali Acc: 0.481 Test Loss: 1.361 Test Acc: 0.481
Validation loss decreased (-0.440726 --> -0.481468).  Saving model ...
Epoch: 11 cost time: 0.5281229019165039
Epoch: 11, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.289 Vali Acc: 0.522 Test Loss: 1.289 Test Acc: 0.522
Validation loss decreased (-0.481468 --> -0.522209).  Saving model ...
Epoch: 12 cost time: 0.6592185497283936
Epoch: 12, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.218 Vali Acc: 0.556 Test Loss: 1.218 Test Acc: 0.556
Validation loss decreased (-0.522209 --> -0.555543).  Saving model ...
Epoch: 13 cost time: 0.5609371662139893
Epoch: 13, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.148 Vali Acc: 0.604 Test Loss: 1.148 Test Acc: 0.604
Validation loss decreased (-0.555543 --> -0.603692).  Saving model ...
Epoch: 14 cost time: 0.5311582088470459
Epoch: 14, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.082 Vali Acc: 0.644 Test Loss: 1.082 Test Acc: 0.644
Validation loss decreased (-0.603692 --> -0.644434).  Saving model ...
Epoch: 15 cost time: 0.5520343780517578
Epoch: 15, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.018 Vali Acc: 0.674 Test Loss: 1.018 Test Acc: 0.674
Validation loss decreased (-0.644434 --> -0.674064).  Saving model ...
Epoch: 16 cost time: 0.6421933174133301
Epoch: 16, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.956 Vali Acc: 0.704 Test Loss: 0.956 Test Acc: 0.704
Validation loss decreased (-0.674064 --> -0.703694).  Saving model ...
Epoch: 17 cost time: 0.5911176204681396
Epoch: 17, Steps: 2 | Train Loss: 0.882 Vali Loss: 0.898 Vali Acc: 0.722 Test Loss: 0.898 Test Acc: 0.722
Validation loss decreased (-0.703694 --> -0.722213).  Saving model ...
Epoch: 18 cost time: 0.701462984085083
Epoch: 18, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.843 Vali Acc: 0.756 Test Loss: 0.843 Test Acc: 0.756
Validation loss decreased (-0.722213 --> -0.755547).  Saving model ...
Epoch: 19 cost time: 0.7344179153442383
Epoch: 19, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.791 Vali Acc: 0.781 Test Loss: 0.791 Test Acc: 0.781
Validation loss decreased (-0.755547 --> -0.781474).  Saving model ...
Epoch: 20 cost time: 0.6406943798065186
Epoch: 20, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
Validation loss decreased (-0.781474 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 0.7652723789215088
Epoch: 21, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.698 Vali Acc: 0.807 Test Loss: 0.698 Test Acc: 0.807
Validation loss decreased (-0.799993 --> -0.807400).  Saving model ...
Epoch: 22 cost time: 0.5752236843109131
Epoch: 22, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.657 Vali Acc: 0.837 Test Loss: 0.657 Test Acc: 0.837
Validation loss decreased (-0.807400 --> -0.837030).  Saving model ...
Epoch: 23 cost time: 0.6497020721435547
Epoch: 23, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
Validation loss decreased (-0.837030 --> -0.855549).  Saving model ...
Epoch: 24 cost time: 0.6212372779846191
Epoch: 24, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.581 Vali Acc: 0.863 Test Loss: 0.581 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862957).  Saving model ...
Epoch: 25 cost time: 0.6157550811767578
Epoch: 25, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.547 Vali Acc: 0.874 Test Loss: 0.547 Test Acc: 0.874
Validation loss decreased (-0.862957 --> -0.874069).  Saving model ...
Epoch: 26 cost time: 0.6997792720794678
Epoch: 26, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.516 Vali Acc: 0.878 Test Loss: 0.516 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877773).  Saving model ...
Epoch: 27 cost time: 0.6303339004516602
Epoch: 27, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.488 Vali Acc: 0.885 Test Loss: 0.488 Test Acc: 0.885
Validation loss decreased (-0.877773 --> -0.885180).  Saving model ...
Epoch: 28 cost time: 0.627056360244751
Epoch: 28, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 29 cost time: 0.5757079124450684
Epoch: 29, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.436 Vali Acc: 0.896 Test Loss: 0.436 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896292).  Saving model ...
Epoch: 30 cost time: 0.592292308807373
Epoch: 30, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.416 Vali Acc: 0.904 Test Loss: 0.416 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903700).  Saving model ...
Epoch: 31 cost time: 0.6026830673217773
Epoch: 31, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.397 Vali Acc: 0.911 Test Loss: 0.397 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911107).  Saving model ...
Epoch: 32 cost time: 0.5706427097320557
Epoch: 32, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.381 Vali Acc: 0.911 Test Loss: 0.381 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 33 cost time: 0.610114574432373
Epoch: 33, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.366 Vali Acc: 0.911 Test Loss: 0.366 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 34 cost time: 0.6573998928070068
Epoch: 34, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.353 Vali Acc: 0.911 Test Loss: 0.353 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 35 cost time: 0.6990056037902832
Epoch: 35, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.341 Vali Acc: 0.911 Test Loss: 0.341 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 36 cost time: 0.7410838603973389
Epoch: 36, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.330 Vali Acc: 0.919 Test Loss: 0.330 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918515).  Saving model ...
Epoch: 37 cost time: 0.6628117561340332
Epoch: 37, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 38 cost time: 0.5941128730773926
Epoch: 38, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 39 cost time: 0.5108218193054199
Epoch: 39, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.303 Vali Acc: 0.926 Test Loss: 0.303 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 40 cost time: 0.5638918876647949
Epoch: 40, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.297 Vali Acc: 0.926 Test Loss: 0.297 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 41 cost time: 0.571052074432373
Epoch: 41, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7166669368743896
Epoch: 42, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6432151794433594
Epoch: 43, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6830713748931885
Epoch: 44, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5581786632537842
Epoch: 45, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.272 Vali Acc: 0.926 Test Loss: 0.272 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 46 cost time: 0.6491854190826416
Epoch: 46, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 47 cost time: 0.5602366924285889
Epoch: 47, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.263 Vali Acc: 0.926 Test Loss: 0.263 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 48 cost time: 0.5947413444519043
Epoch: 48, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 49 cost time: 0.5786480903625488
Epoch: 49, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 50 cost time: 0.6053855419158936
Epoch: 50, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 51 cost time: 0.5631632804870605
Epoch: 51, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 52 cost time: 0.5817148685455322
Epoch: 52, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 53 cost time: 0.5973219871520996
Epoch: 53, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 54 cost time: 0.6207327842712402
Epoch: 54, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 55 cost time: 0.5623385906219482
Epoch: 55, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6813998222351074
Epoch: 56, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.661442756652832
Epoch: 57, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5928676128387451
Epoch: 58, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6775929927825928
Epoch: 59, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.7628674507141113
Epoch: 60, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.6137912273406982
Epoch: 61, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.6317670345306396
Epoch: 62, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.697490930557251
Epoch: 63, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.5680124759674072
Epoch: 64, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 73446
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4575939178466797
Epoch: 1, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.889 Vali Acc: 0.130 Test Loss: 1.889 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 0.6171712875366211
Epoch: 2, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.858 Vali Acc: 0.144 Test Loss: 1.858 Test Acc: 0.144
Validation loss decreased (-0.129611 --> -0.144426).  Saving model ...
Epoch: 3 cost time: 0.6531221866607666
Epoch: 3, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.834 Vali Acc: 0.130 Test Loss: 1.834 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6756711006164551
Epoch: 4, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.811 Vali Acc: 0.137 Test Loss: 1.811 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6208827495574951
Epoch: 5, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.780 Vali Acc: 0.163 Test Loss: 1.780 Test Acc: 0.163
Validation loss decreased (-0.144426 --> -0.162945).  Saving model ...
Epoch: 6 cost time: 0.7212262153625488
Epoch: 6, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.743 Vali Acc: 0.174 Test Loss: 1.743 Test Acc: 0.174
Validation loss decreased (-0.162945 --> -0.174057).  Saving model ...
Epoch: 7 cost time: 0.554351806640625
Epoch: 7, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.700 Vali Acc: 0.226 Test Loss: 1.700 Test Acc: 0.226
Validation loss decreased (-0.174057 --> -0.225909).  Saving model ...
Epoch: 8 cost time: 0.5996010303497314
Epoch: 8, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.651 Vali Acc: 0.285 Test Loss: 1.651 Test Acc: 0.285
Validation loss decreased (-0.225909 --> -0.285169).  Saving model ...
Epoch: 9 cost time: 0.6039731502532959
Epoch: 9, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.599 Vali Acc: 0.356 Test Loss: 1.599 Test Acc: 0.356
Validation loss decreased (-0.285169 --> -0.355540).  Saving model ...
Epoch: 10 cost time: 0.5425572395324707
Epoch: 10, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.541 Vali Acc: 0.415 Test Loss: 1.541 Test Acc: 0.415
Validation loss decreased (-0.355540 --> -0.414799).  Saving model ...
Epoch: 11 cost time: 0.555140495300293
Epoch: 11, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.481 Vali Acc: 0.467 Test Loss: 1.481 Test Acc: 0.467
Validation loss decreased (-0.414799 --> -0.466652).  Saving model ...
Epoch: 12 cost time: 0.6943933963775635
Epoch: 12, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.419 Vali Acc: 0.511 Test Loss: 1.419 Test Acc: 0.511
Validation loss decreased (-0.466652 --> -0.511097).  Saving model ...
Epoch: 13 cost time: 0.6218459606170654
Epoch: 13, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.356 Vali Acc: 0.567 Test Loss: 1.356 Test Acc: 0.567
Validation loss decreased (-0.511097 --> -0.566653).  Saving model ...
Epoch: 14 cost time: 0.5519282817840576
Epoch: 14, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.293 Vali Acc: 0.593 Test Loss: 1.293 Test Acc: 0.593
Validation loss decreased (-0.566653 --> -0.592580).  Saving model ...
Epoch: 15 cost time: 0.6025664806365967
Epoch: 15, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.230 Vali Acc: 0.615 Test Loss: 1.230 Test Acc: 0.615
Validation loss decreased (-0.592580 --> -0.614803).  Saving model ...
Epoch: 16 cost time: 0.5809810161590576
Epoch: 16, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.168 Vali Acc: 0.693 Test Loss: 1.168 Test Acc: 0.693
Validation loss decreased (-0.614803 --> -0.692581).  Saving model ...
Epoch: 17 cost time: 0.586118221282959
Epoch: 17, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.107 Vali Acc: 0.726 Test Loss: 1.107 Test Acc: 0.726
Validation loss decreased (-0.692581 --> -0.725915).  Saving model ...
Epoch: 18 cost time: 0.6505851745605469
Epoch: 18, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.049 Vali Acc: 0.759 Test Loss: 1.049 Test Acc: 0.759
Validation loss decreased (-0.725915 --> -0.759249).  Saving model ...
Epoch: 19 cost time: 0.6145787239074707
Epoch: 19, Steps: 2 | Train Loss: 0.983 Vali Loss: 0.992 Vali Acc: 0.781 Test Loss: 0.992 Test Acc: 0.781
Validation loss decreased (-0.759249 --> -0.781472).  Saving model ...
Epoch: 20 cost time: 0.490969181060791
Epoch: 20, Steps: 2 | Train Loss: 0.833 Vali Loss: 0.937 Vali Acc: 0.811 Test Loss: 0.937 Test Acc: 0.811
Validation loss decreased (-0.781472 --> -0.811102).  Saving model ...
Epoch: 21 cost time: 0.5713400840759277
Epoch: 21, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.885 Vali Acc: 0.815 Test Loss: 0.885 Test Acc: 0.815
Validation loss decreased (-0.811102 --> -0.814806).  Saving model ...
Epoch: 22 cost time: 0.6526362895965576
Epoch: 22, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.835 Vali Acc: 0.826 Test Loss: 0.835 Test Acc: 0.826
Validation loss decreased (-0.814806 --> -0.825918).  Saving model ...
Epoch: 23 cost time: 0.6485729217529297
Epoch: 23, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.788 Vali Acc: 0.841 Test Loss: 0.788 Test Acc: 0.841
Validation loss decreased (-0.825918 --> -0.840733).  Saving model ...
Epoch: 24 cost time: 0.6225817203521729
Epoch: 24, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.744 Vali Acc: 0.859 Test Loss: 0.744 Test Acc: 0.859
Validation loss decreased (-0.840733 --> -0.859252).  Saving model ...
Epoch: 25 cost time: 0.5771305561065674
Epoch: 25, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.702 Vali Acc: 0.863 Test Loss: 0.702 Test Acc: 0.863
Validation loss decreased (-0.859252 --> -0.862956).  Saving model ...
Epoch: 26 cost time: 0.5954458713531494
Epoch: 26, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.666 Vali Acc: 0.870 Test Loss: 0.666 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870364).  Saving model ...
Epoch: 27 cost time: 0.6221330165863037
Epoch: 27, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.631 Vali Acc: 0.878 Test Loss: 0.631 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877771).  Saving model ...
Epoch: 28 cost time: 0.7219657897949219
Epoch: 28, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.599 Vali Acc: 0.885 Test Loss: 0.599 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885179).  Saving model ...
Epoch: 29 cost time: 0.6767194271087646
Epoch: 29, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.567 Vali Acc: 0.893 Test Loss: 0.567 Test Acc: 0.893
Validation loss decreased (-0.885179 --> -0.892587).  Saving model ...
Epoch: 30 cost time: 0.664466381072998
Epoch: 30, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.6217131614685059
Epoch: 31, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.512 Vali Acc: 0.904 Test Loss: 0.512 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 32 cost time: 0.7154855728149414
Epoch: 32, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.487 Vali Acc: 0.907 Test Loss: 0.487 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 33 cost time: 0.681767463684082
Epoch: 33, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.466 Vali Acc: 0.907 Test Loss: 0.466 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 34 cost time: 0.7565212249755859
Epoch: 34, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.446 Vali Acc: 0.911 Test Loss: 0.446 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 35 cost time: 0.71756911277771
Epoch: 35, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.428 Vali Acc: 0.911 Test Loss: 0.428 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 36 cost time: 0.7617945671081543
Epoch: 36, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.412 Vali Acc: 0.915 Test Loss: 0.412 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 37 cost time: 0.6922175884246826
Epoch: 37, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.398 Vali Acc: 0.911 Test Loss: 0.398 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6198382377624512
Epoch: 38, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.385 Vali Acc: 0.911 Test Loss: 0.385 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6973707675933838
Epoch: 39, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.374 Vali Acc: 0.907 Test Loss: 0.374 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5973286628723145
Epoch: 40, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.365 Vali Acc: 0.907 Test Loss: 0.365 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6257684230804443
Epoch: 41, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.356 Vali Acc: 0.911 Test Loss: 0.356 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6548604965209961
Epoch: 42, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.720829963684082
Epoch: 43, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.339 Vali Acc: 0.919 Test Loss: 0.339 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 44 cost time: 0.7331960201263428
Epoch: 44, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 45 cost time: 0.6495664119720459
Epoch: 45, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 46 cost time: 0.7951042652130127
Epoch: 46, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.316 Vali Acc: 0.922 Test Loss: 0.316 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 47 cost time: 0.5025656223297119
Epoch: 47, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.310 Vali Acc: 0.922 Test Loss: 0.310 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 48 cost time: 0.6497344970703125
Epoch: 48, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.305 Vali Acc: 0.922 Test Loss: 0.305 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 49 cost time: 0.5939900875091553
Epoch: 49, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.300 Vali Acc: 0.926 Test Loss: 0.300 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 50 cost time: 0.5779054164886475
Epoch: 50, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 51 cost time: 0.5446600914001465
Epoch: 51, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.292 Vali Acc: 0.926 Test Loss: 0.292 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 52 cost time: 0.6395936012268066
Epoch: 52, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 53 cost time: 0.5763354301452637
Epoch: 53, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 54 cost time: 0.5661416053771973
Epoch: 54, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 55 cost time: 0.5566213130950928
Epoch: 55, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.281 Vali Acc: 0.926 Test Loss: 0.281 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 56 cost time: 0.5734808444976807
Epoch: 56, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 57 cost time: 0.6744418144226074
Epoch: 57, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 58 cost time: 0.6667752265930176
Epoch: 58, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 59 cost time: 0.645404577255249
Epoch: 59, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.272 Vali Acc: 0.926 Test Loss: 0.272 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 60 cost time: 0.5811364650726318
Epoch: 60, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.270 Vali Acc: 0.926 Test Loss: 0.270 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 61 cost time: 0.5839056968688965
Epoch: 61, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 62 cost time: 0.7410447597503662
Epoch: 62, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 63 cost time: 0.6018626689910889
Epoch: 63, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 64 cost time: 0.5874276161193848
Epoch: 64, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6772096157073975
Epoch: 65, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.624727725982666
Epoch: 66, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.6856832504272461
Epoch: 67, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.7050793170928955
Epoch: 68, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.6262867450714111
Epoch: 69, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.6154539585113525
Epoch: 70, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.5601024627685547
Epoch: 71, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.5492007732391357
Epoch: 72, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.6401441097259521
Epoch: 73, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 70470
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4306700229644775
Epoch: 1, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.878 Vali Acc: 0.170 Test Loss: 1.878 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.6404438018798828
Epoch: 2, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.848 Vali Acc: 0.170 Test Loss: 1.848 Test Acc: 0.170
Validation loss decreased (-0.170352 --> -0.170352).  Saving model ...
Epoch: 3 cost time: 0.5999600887298584
Epoch: 3, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.824 Vali Acc: 0.174 Test Loss: 1.824 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174056).  Saving model ...
Epoch: 4 cost time: 0.5747511386871338
Epoch: 4, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.800 Vali Acc: 0.185 Test Loss: 1.800 Test Acc: 0.185
Validation loss decreased (-0.174056 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 0.5386190414428711
Epoch: 5, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.771 Vali Acc: 0.207 Test Loss: 1.771 Test Acc: 0.207
Validation loss decreased (-0.185167 --> -0.207390).  Saving model ...
Epoch: 6 cost time: 0.6047027111053467
Epoch: 6, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.736 Vali Acc: 0.215 Test Loss: 1.736 Test Acc: 0.215
Validation loss decreased (-0.207390 --> -0.214797).  Saving model ...
Epoch: 7 cost time: 0.677515983581543
Epoch: 7, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.696 Vali Acc: 0.230 Test Loss: 1.696 Test Acc: 0.230
Validation loss decreased (-0.214797 --> -0.229613).  Saving model ...
Epoch: 8 cost time: 0.6001589298248291
Epoch: 8, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.652 Vali Acc: 0.274 Test Loss: 1.652 Test Acc: 0.274
Validation loss decreased (-0.229613 --> -0.274058).  Saving model ...
Epoch: 9 cost time: 0.6487874984741211
Epoch: 9, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.605 Vali Acc: 0.337 Test Loss: 1.605 Test Acc: 0.337
Validation loss decreased (-0.274058 --> -0.337021).  Saving model ...
Epoch: 10 cost time: 0.6619627475738525
Epoch: 10, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.556 Vali Acc: 0.393 Test Loss: 1.556 Test Acc: 0.393
Validation loss decreased (-0.337021 --> -0.392577).  Saving model ...
Epoch: 11 cost time: 0.6710937023162842
Epoch: 11, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.505 Vali Acc: 0.452 Test Loss: 1.505 Test Acc: 0.452
Validation loss decreased (-0.392577 --> -0.451837).  Saving model ...
Epoch: 12 cost time: 0.6224956512451172
Epoch: 12, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.452 Vali Acc: 0.500 Test Loss: 1.452 Test Acc: 0.500
Validation loss decreased (-0.451837 --> -0.499985).  Saving model ...
Epoch: 13 cost time: 0.5598330497741699
Epoch: 13, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.398 Vali Acc: 0.559 Test Loss: 1.398 Test Acc: 0.559
Validation loss decreased (-0.499985 --> -0.559245).  Saving model ...
Epoch: 14 cost time: 0.598055362701416
Epoch: 14, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.345 Vali Acc: 0.589 Test Loss: 1.345 Test Acc: 0.589
Validation loss decreased (-0.559245 --> -0.588875).  Saving model ...
Epoch: 15 cost time: 0.575653076171875
Epoch: 15, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.293 Vali Acc: 0.626 Test Loss: 1.293 Test Acc: 0.626
Validation loss decreased (-0.588875 --> -0.625913).  Saving model ...
Epoch: 16 cost time: 0.6976773738861084
Epoch: 16, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.240 Vali Acc: 0.659 Test Loss: 1.240 Test Acc: 0.659
Validation loss decreased (-0.625913 --> -0.659247).  Saving model ...
Epoch: 17 cost time: 0.575747013092041
Epoch: 17, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.188 Vali Acc: 0.674 Test Loss: 1.188 Test Acc: 0.674
Validation loss decreased (-0.659247 --> -0.674062).  Saving model ...
Epoch: 18 cost time: 0.591789722442627
Epoch: 18, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.138 Vali Acc: 0.700 Test Loss: 1.138 Test Acc: 0.700
Validation loss decreased (-0.674062 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 0.6436488628387451
Epoch: 19, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.089 Vali Acc: 0.707 Test Loss: 1.089 Test Acc: 0.707
Validation loss decreased (-0.699989 --> -0.707397).  Saving model ...
Epoch: 20 cost time: 0.5932056903839111
Epoch: 20, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.041 Vali Acc: 0.730 Test Loss: 1.041 Test Acc: 0.730
Validation loss decreased (-0.707397 --> -0.729619).  Saving model ...
Epoch: 21 cost time: 0.591505765914917
Epoch: 21, Steps: 2 | Train Loss: 0.925 Vali Loss: 0.995 Vali Acc: 0.733 Test Loss: 0.995 Test Acc: 0.733
Validation loss decreased (-0.729619 --> -0.733323).  Saving model ...
Epoch: 22 cost time: 0.5884420871734619
Epoch: 22, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.950 Vali Acc: 0.770 Test Loss: 0.950 Test Acc: 0.770
Validation loss decreased (-0.733323 --> -0.770361).  Saving model ...
Epoch: 23 cost time: 0.7426800727844238
Epoch: 23, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.907 Vali Acc: 0.800 Test Loss: 0.907 Test Acc: 0.800
Validation loss decreased (-0.770361 --> -0.799991).  Saving model ...
Epoch: 24 cost time: 0.7038090229034424
Epoch: 24, Steps: 2 | Train Loss: 0.827 Vali Loss: 0.866 Vali Acc: 0.796 Test Loss: 0.866 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8272159099578857
Epoch: 25, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.826 Vali Acc: 0.815 Test Loss: 0.826 Test Acc: 0.815
Validation loss decreased (-0.799991 --> -0.814807).  Saving model ...
Epoch: 26 cost time: 0.7471849918365479
Epoch: 26, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.789 Vali Acc: 0.819 Test Loss: 0.789 Test Acc: 0.819
Validation loss decreased (-0.814807 --> -0.818511).  Saving model ...
Epoch: 27 cost time: 0.5867257118225098
Epoch: 27, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.752 Vali Acc: 0.833 Test Loss: 0.752 Test Acc: 0.833
Validation loss decreased (-0.818511 --> -0.833326).  Saving model ...
Epoch: 28 cost time: 0.7108526229858398
Epoch: 28, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.718 Vali Acc: 0.841 Test Loss: 0.718 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840734).  Saving model ...
Epoch: 29 cost time: 0.8040144443511963
Epoch: 29, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.687 Vali Acc: 0.863 Test Loss: 0.687 Test Acc: 0.863
Validation loss decreased (-0.840734 --> -0.862956).  Saving model ...
Epoch: 30 cost time: 0.6043422222137451
Epoch: 30, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.658 Vali Acc: 0.867 Test Loss: 0.658 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 31 cost time: 0.7173757553100586
Epoch: 31, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.628 Vali Acc: 0.878 Test Loss: 0.628 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 32 cost time: 0.6106653213500977
Epoch: 32, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.601 Vali Acc: 0.885 Test Loss: 0.601 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885179).  Saving model ...
Epoch: 33 cost time: 0.5955958366394043
Epoch: 33, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.575 Vali Acc: 0.889 Test Loss: 0.575 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 34 cost time: 0.6851601600646973
Epoch: 34, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.552 Vali Acc: 0.893 Test Loss: 0.552 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 35 cost time: 0.6516942977905273
Epoch: 35, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.530 Vali Acc: 0.893 Test Loss: 0.530 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 36 cost time: 0.683107852935791
Epoch: 36, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.510 Vali Acc: 0.893 Test Loss: 0.510 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 37 cost time: 0.6405963897705078
Epoch: 37, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 38 cost time: 0.6376171112060547
Epoch: 38, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.472 Vali Acc: 0.904 Test Loss: 0.472 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 39 cost time: 0.6143546104431152
Epoch: 39, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.456 Vali Acc: 0.907 Test Loss: 0.456 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 40 cost time: 0.6375322341918945
Epoch: 40, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.442 Vali Acc: 0.919 Test Loss: 0.442 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918514).  Saving model ...
Epoch: 41 cost time: 0.6545629501342773
Epoch: 41, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.427 Vali Acc: 0.922 Test Loss: 0.427 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 42 cost time: 0.7163252830505371
Epoch: 42, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.415 Vali Acc: 0.930 Test Loss: 0.415 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929625).  Saving model ...
Epoch: 43 cost time: 0.6563522815704346
Epoch: 43, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.402 Vali Acc: 0.933 Test Loss: 0.402 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 44 cost time: 0.6545596122741699
Epoch: 44, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.392 Vali Acc: 0.930 Test Loss: 0.392 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5773816108703613
Epoch: 45, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.381 Vali Acc: 0.930 Test Loss: 0.381 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5378148555755615
Epoch: 46, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.371 Vali Acc: 0.930 Test Loss: 0.371 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5405604839324951
Epoch: 47, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.364 Vali Acc: 0.922 Test Loss: 0.364 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5671565532684326
Epoch: 48, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.356 Vali Acc: 0.922 Test Loss: 0.356 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6990365982055664
Epoch: 49, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.349 Vali Acc: 0.922 Test Loss: 0.349 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.634878396987915
Epoch: 50, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.6733095645904541
Epoch: 51, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5797381401062012
Epoch: 52, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5615711212158203
Epoch: 53, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.325 Vali Acc: 0.922 Test Loss: 0.325 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 69062
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3020474910736084
Epoch: 1, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.686 Vali Acc: 0.293 Test Loss: 1.686 Test Acc: 0.293
Validation loss decreased (inf --> -0.292576).  Saving model ...
Epoch: 2 cost time: 0.6684818267822266
Epoch: 2, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.598 Vali Acc: 0.381 Test Loss: 1.598 Test Acc: 0.381
Validation loss decreased (-0.292576 --> -0.381465).  Saving model ...
Epoch: 3 cost time: 0.6944074630737305
Epoch: 3, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.503 Vali Acc: 0.481 Test Loss: 1.503 Test Acc: 0.481
Validation loss decreased (-0.381465 --> -0.481466).  Saving model ...
Epoch: 4 cost time: 0.6317219734191895
Epoch: 4, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.373 Vali Acc: 0.633 Test Loss: 1.373 Test Acc: 0.633
Validation loss decreased (-0.481466 --> -0.633320).  Saving model ...
Epoch: 5 cost time: 0.6532528400421143
Epoch: 5, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.219 Vali Acc: 0.770 Test Loss: 1.219 Test Acc: 0.770
Validation loss decreased (-0.633320 --> -0.770358).  Saving model ...
Epoch: 6 cost time: 0.7518093585968018
Epoch: 6, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.058 Vali Acc: 0.841 Test Loss: 1.058 Test Acc: 0.841
Validation loss decreased (-0.770358 --> -0.840730).  Saving model ...
Epoch: 7 cost time: 0.6720905303955078
Epoch: 7, Steps: 2 | Train Loss: 0.930 Vali Loss: 0.906 Vali Acc: 0.889 Test Loss: 0.906 Test Acc: 0.889
Validation loss decreased (-0.840730 --> -0.888880).  Saving model ...
Epoch: 8 cost time: 0.6153733730316162
Epoch: 8, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.772 Vali Acc: 0.907 Test Loss: 0.772 Test Acc: 0.907
Validation loss decreased (-0.888880 --> -0.907400).  Saving model ...
Epoch: 9 cost time: 0.6850175857543945
Epoch: 9, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.656 Vali Acc: 0.922 Test Loss: 0.656 Test Acc: 0.922
Validation loss decreased (-0.907400 --> -0.922216).  Saving model ...
Epoch: 10 cost time: 0.7227897644042969
Epoch: 10, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.559 Vali Acc: 0.948 Test Loss: 0.559 Test Acc: 0.948
Validation loss decreased (-0.922216 --> -0.948143).  Saving model ...
Epoch: 11 cost time: 0.6918718814849854
Epoch: 11, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.478 Vali Acc: 0.948 Test Loss: 0.478 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 12 cost time: 0.6763668060302734
Epoch: 12, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.410 Vali Acc: 0.944 Test Loss: 0.410 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.802142858505249
Epoch: 13, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.360 Vali Acc: 0.944 Test Loss: 0.360 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6124758720397949
Epoch: 14, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.316 Vali Acc: 0.948 Test Loss: 0.316 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948145).  Saving model ...
Epoch: 15 cost time: 0.7002193927764893
Epoch: 15, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.281 Vali Acc: 0.948 Test Loss: 0.281 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 16 cost time: 0.6900744438171387
Epoch: 16, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8269250392913818
Epoch: 17, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951850).  Saving model ...
Epoch: 18 cost time: 0.5870747566223145
Epoch: 18, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7839968204498291
Epoch: 19, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.639448881149292
Epoch: 20, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7409131526947021
Epoch: 21, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6637880802154541
Epoch: 22, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7310490608215332
Epoch: 23, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.5774812698364258
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.7160305976867676
Epoch: 25, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.6107115745544434
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.6443991661071777
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.7033383846282959
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6472222805023193
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6609537601470947
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6977040767669678
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6300857067108154
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6443064212799072
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5853290557861328
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6749014854431152
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5886325836181641
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6143286228179932
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 88166
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.483407735824585
Epoch: 1, Steps: 2 | Train Loss: 2.093 Vali Loss: 1.927 Vali Acc: 0.093 Test Loss: 1.927 Test Acc: 0.093
Validation loss decreased (inf --> -0.092573).  Saving model ...
Epoch: 2 cost time: 0.6777098178863525
Epoch: 2, Steps: 2 | Train Loss: 2.016 Vali Loss: 1.859 Vali Acc: 0.137 Test Loss: 1.859 Test Acc: 0.137
Validation loss decreased (-0.092573 --> -0.137018).  Saving model ...
Epoch: 3 cost time: 0.6272714138031006
Epoch: 3, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.798 Vali Acc: 0.137 Test Loss: 1.798 Test Acc: 0.137
Validation loss decreased (-0.137018 --> -0.137019).  Saving model ...
Epoch: 4 cost time: 0.632136344909668
Epoch: 4, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.729 Vali Acc: 0.170 Test Loss: 1.729 Test Acc: 0.170
Validation loss decreased (-0.137019 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 0.6241672039031982
Epoch: 5, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.644 Vali Acc: 0.285 Test Loss: 1.644 Test Acc: 0.285
Validation loss decreased (-0.170353 --> -0.285169).  Saving model ...
Epoch: 6 cost time: 0.5945532321929932
Epoch: 6, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.548 Vali Acc: 0.389 Test Loss: 1.548 Test Acc: 0.389
Validation loss decreased (-0.285169 --> -0.388873).  Saving model ...
Epoch: 7 cost time: 0.6756718158721924
Epoch: 7, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.443 Vali Acc: 0.493 Test Loss: 1.443 Test Acc: 0.493
Validation loss decreased (-0.388873 --> -0.492578).  Saving model ...
Epoch: 8 cost time: 0.7325186729431152
Epoch: 8, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.334 Vali Acc: 0.607 Test Loss: 1.334 Test Acc: 0.607
Validation loss decreased (-0.492578 --> -0.607394).  Saving model ...
Epoch: 9 cost time: 0.614293098449707
Epoch: 9, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.225 Vali Acc: 0.689 Test Loss: 1.225 Test Acc: 0.689
Validation loss decreased (-0.607394 --> -0.688877).  Saving model ...
Epoch: 10 cost time: 0.6254384517669678
Epoch: 10, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.114 Vali Acc: 0.748 Test Loss: 1.114 Test Acc: 0.748
Validation loss decreased (-0.688877 --> -0.748137).  Saving model ...
Epoch: 11 cost time: 0.8139512538909912
Epoch: 11, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.009 Vali Acc: 0.807 Test Loss: 1.009 Test Acc: 0.807
Validation loss decreased (-0.748137 --> -0.807397).  Saving model ...
Epoch: 12 cost time: 0.6554596424102783
Epoch: 12, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.910 Vali Acc: 0.822 Test Loss: 0.910 Test Acc: 0.822
Validation loss decreased (-0.807397 --> -0.822213).  Saving model ...
Epoch: 13 cost time: 0.8397822380065918
Epoch: 13, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.815 Vali Acc: 0.844 Test Loss: 0.815 Test Acc: 0.844
Validation loss decreased (-0.822213 --> -0.844436).  Saving model ...
Epoch: 14 cost time: 0.7837333679199219
Epoch: 14, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.730 Vali Acc: 0.867 Test Loss: 0.730 Test Acc: 0.867
Validation loss decreased (-0.844436 --> -0.866659).  Saving model ...
Epoch: 15 cost time: 0.648627758026123
Epoch: 15, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.654 Vali Acc: 0.878 Test Loss: 0.654 Test Acc: 0.878
Validation loss decreased (-0.866659 --> -0.877771).  Saving model ...
Epoch: 16 cost time: 0.6567416191101074
Epoch: 16, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.588 Vali Acc: 0.881 Test Loss: 0.588 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881476).  Saving model ...
Epoch: 17 cost time: 0.6471409797668457
Epoch: 17, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.530 Vali Acc: 0.896 Test Loss: 0.530 Test Acc: 0.896
Validation loss decreased (-0.881476 --> -0.896291).  Saving model ...
Epoch: 18 cost time: 0.6296937465667725
Epoch: 18, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.480 Vali Acc: 0.926 Test Loss: 0.480 Test Acc: 0.926
Validation loss decreased (-0.896291 --> -0.925921).  Saving model ...
Epoch: 19 cost time: 0.5898964405059814
Epoch: 19, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.438 Vali Acc: 0.926 Test Loss: 0.438 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 20 cost time: 0.69004225730896
Epoch: 20, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.401 Vali Acc: 0.930 Test Loss: 0.401 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 21 cost time: 0.6678323745727539
Epoch: 21, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.368 Vali Acc: 0.930 Test Loss: 0.368 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 22 cost time: 0.5988221168518066
Epoch: 22, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.339 Vali Acc: 0.941 Test Loss: 0.339 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940737).  Saving model ...
Epoch: 23 cost time: 0.6108059883117676
Epoch: 23, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.315 Vali Acc: 0.937 Test Loss: 0.315 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6146838665008545
Epoch: 24, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.294 Vali Acc: 0.948 Test Loss: 0.294 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 25 cost time: 0.6700687408447266
Epoch: 25, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6038680076599121
Epoch: 26, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5722835063934326
Epoch: 27, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.260 Vali Acc: 0.919 Test Loss: 0.260 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5451629161834717
Epoch: 28, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8967258930206299
Epoch: 29, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6394820213317871
Epoch: 30, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5691275596618652
Epoch: 31, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6741180419921875
Epoch: 32, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.5997581481933594
Epoch: 33, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.8282294273376465
Epoch: 34, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.650139570236206
Epoch: 35, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7316884994506836
Epoch: 36, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7125911712646484
Epoch: 37, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7764003276824951
Epoch: 38, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5639734268188477
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7528319358825684
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7919178009033203
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5656290054321289
Epoch: 42, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5602874755859375
Epoch: 43, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6847648620605469
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 62886
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5285463333129883
Epoch: 1, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.924 Vali Acc: 0.181 Test Loss: 1.924 Test Acc: 0.181
Validation loss decreased (inf --> -0.181462).  Saving model ...
Epoch: 2 cost time: 0.7023468017578125
Epoch: 2, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.844 Vali Acc: 0.200 Test Loss: 1.844 Test Acc: 0.200
Validation loss decreased (-0.181462 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.7453453540802002
Epoch: 3, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.776 Vali Acc: 0.256 Test Loss: 1.776 Test Acc: 0.256
Validation loss decreased (-0.199982 --> -0.255538).  Saving model ...
Epoch: 4 cost time: 0.5840363502502441
Epoch: 4, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.708 Vali Acc: 0.307 Test Loss: 1.708 Test Acc: 0.307
Validation loss decreased (-0.255538 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.616424560546875
Epoch: 5, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.628 Vali Acc: 0.367 Test Loss: 1.628 Test Acc: 0.367
Validation loss decreased (-0.307390 --> -0.366650).  Saving model ...
Epoch: 6 cost time: 0.6239893436431885
Epoch: 6, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.542 Vali Acc: 0.456 Test Loss: 1.542 Test Acc: 0.456
Validation loss decreased (-0.366650 --> -0.455540).  Saving model ...
Epoch: 7 cost time: 0.5734012126922607
Epoch: 7, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.453 Vali Acc: 0.504 Test Loss: 1.453 Test Acc: 0.504
Validation loss decreased (-0.455540 --> -0.503689).  Saving model ...
Epoch: 8 cost time: 0.6085507869720459
Epoch: 8, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.358 Vali Acc: 0.552 Test Loss: 1.358 Test Acc: 0.552
Validation loss decreased (-0.503689 --> -0.551838).  Saving model ...
Epoch: 9 cost time: 0.7140483856201172
Epoch: 9, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.264 Vali Acc: 0.622 Test Loss: 1.264 Test Acc: 0.622
Validation loss decreased (-0.551838 --> -0.622210).  Saving model ...
Epoch: 10 cost time: 0.521735429763794
Epoch: 10, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.174 Vali Acc: 0.685 Test Loss: 1.174 Test Acc: 0.685
Validation loss decreased (-0.622210 --> -0.685173).  Saving model ...
Epoch: 11 cost time: 0.6396756172180176
Epoch: 11, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.087 Vali Acc: 0.726 Test Loss: 1.087 Test Acc: 0.726
Validation loss decreased (-0.685173 --> -0.725915).  Saving model ...
Epoch: 12 cost time: 0.6617238521575928
Epoch: 12, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.005 Vali Acc: 0.756 Test Loss: 1.005 Test Acc: 0.756
Validation loss decreased (-0.725915 --> -0.755546).  Saving model ...
Epoch: 13 cost time: 0.5199079513549805
Epoch: 13, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.927 Vali Acc: 0.781 Test Loss: 0.927 Test Acc: 0.781
Validation loss decreased (-0.755546 --> -0.781472).  Saving model ...
Epoch: 14 cost time: 0.6272251605987549
Epoch: 14, Steps: 2 | Train Loss: 0.882 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.781472 --> -0.799991).  Saving model ...
Epoch: 15 cost time: 0.6270010471343994
Epoch: 15, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.787 Vali Acc: 0.804 Test Loss: 0.787 Test Acc: 0.804
Validation loss decreased (-0.799991 --> -0.803696).  Saving model ...
Epoch: 16 cost time: 0.7181110382080078
Epoch: 16, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.723 Vali Acc: 0.852 Test Loss: 0.723 Test Acc: 0.852
Validation loss decreased (-0.803696 --> -0.851845).  Saving model ...
Epoch: 17 cost time: 0.6136045455932617
Epoch: 17, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.665 Vali Acc: 0.859 Test Loss: 0.665 Test Acc: 0.859
Validation loss decreased (-0.851845 --> -0.859253).  Saving model ...
Epoch: 18 cost time: 0.47112226486206055
Epoch: 18, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.613 Vali Acc: 0.874 Test Loss: 0.613 Test Acc: 0.874
Validation loss decreased (-0.859253 --> -0.874068).  Saving model ...
Epoch: 19 cost time: 0.5828220844268799
Epoch: 19, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.564 Vali Acc: 0.893 Test Loss: 0.564 Test Acc: 0.893
Validation loss decreased (-0.874068 --> -0.892587).  Saving model ...
Epoch: 20 cost time: 0.6299769878387451
Epoch: 20, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.523 Vali Acc: 0.896 Test Loss: 0.523 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 21 cost time: 0.537848949432373
Epoch: 21, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.484 Vali Acc: 0.915 Test Loss: 0.484 Test Acc: 0.915
Validation loss decreased (-0.896291 --> -0.914810).  Saving model ...
Epoch: 22 cost time: 0.5520143508911133
Epoch: 22, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.450 Vali Acc: 0.919 Test Loss: 0.450 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 23 cost time: 0.5729305744171143
Epoch: 23, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.421 Vali Acc: 0.919 Test Loss: 0.421 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 24 cost time: 0.5694513320922852
Epoch: 24, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.394 Vali Acc: 0.926 Test Loss: 0.394 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 25 cost time: 0.5554232597351074
Epoch: 25, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.368 Vali Acc: 0.937 Test Loss: 0.368 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937033).  Saving model ...
Epoch: 26 cost time: 0.6029572486877441
Epoch: 26, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.345 Vali Acc: 0.941 Test Loss: 0.345 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 27 cost time: 0.5775392055511475
Epoch: 27, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.326 Vali Acc: 0.937 Test Loss: 0.326 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5563702583312988
Epoch: 28, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5834865570068359
Epoch: 29, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.302 Vali Acc: 0.926 Test Loss: 0.302 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.584700345993042
Epoch: 30, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.293 Vali Acc: 0.922 Test Loss: 0.293 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6477005481719971
Epoch: 31, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5911235809326172
Epoch: 32, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5511088371276855
Epoch: 33, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5657503604888916
Epoch: 34, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5718588829040527
Epoch: 35, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6457715034484863
Epoch: 36, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.6797194480895996
Epoch: 37, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5884528160095215
Epoch: 38, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6060914993286133
Epoch: 39, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.621314287185669
Epoch: 40, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6432762145996094
Epoch: 41, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6935620307922363
Epoch: 42, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6684837341308594
Epoch: 43, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5549941062927246
Epoch: 44, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.5864424705505371
Epoch: 45, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.6276204586029053
Epoch: 46, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5765836238861084
Epoch: 47, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.533768892288208
Epoch: 48, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6043634414672852
Epoch: 49, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6138193607330322
Epoch: 50, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5459086894989014
Epoch: 51, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5980110168457031
Epoch: 52, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.6446142196655273
Epoch: 53, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.6251318454742432
Epoch: 54, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7377724647521973
Epoch: 55, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.5992527008056641
Epoch: 56, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 57 cost time: 0.7289128303527832
Epoch: 57, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 58 cost time: 0.6693596839904785
Epoch: 58, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 59 cost time: 0.6448266506195068
Epoch: 59, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 60 cost time: 0.6168487071990967
Epoch: 60, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 61 cost time: 0.6611320972442627
Epoch: 61, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 62 cost time: 0.6116447448730469
Epoch: 62, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 63 cost time: 0.6409075260162354
Epoch: 63, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 64 cost time: 0.6188452243804932
Epoch: 64, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 65 cost time: 0.7000973224639893
Epoch: 65, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 66 cost time: 0.5301406383514404
Epoch: 66, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 67 cost time: 0.5663909912109375
Epoch: 67, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 68 cost time: 0.6514835357666016
Epoch: 68, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 69 cost time: 0.6117291450500488
Epoch: 69, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 70 cost time: 0.6492228507995605
Epoch: 70, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.5889949798583984
Epoch: 71, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.603952169418335
Epoch: 72, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.5494544506072998
Epoch: 73, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.5714757442474365
Epoch: 74, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 75 cost time: 0.5478579998016357
Epoch: 75, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.5555875301361084
Epoch: 76, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.6278095245361328
Epoch: 77, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.7120609283447266
Epoch: 78, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.6185693740844727
Epoch: 79, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.6230792999267578
Epoch: 80, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.6150178909301758
Epoch: 81, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.6059291362762451
Epoch: 82, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.6279001235961914
Epoch: 83, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.6262445449829102
Epoch: 84, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 55238
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1879525184631348
Epoch: 1, Steps: 2 | Train Loss: 2.106 Vali Loss: 2.227 Vali Acc: 0.167 Test Loss: 2.227 Test Acc: 0.167
Validation loss decreased (inf --> -0.166644).  Saving model ...
Epoch: 2 cost time: 0.6142513751983643
Epoch: 2, Steps: 2 | Train Loss: 2.086 Vali Loss: 2.118 Vali Acc: 0.167 Test Loss: 2.118 Test Acc: 0.167
Validation loss decreased (-0.166644 --> -0.166645).  Saving model ...
Epoch: 3 cost time: 0.5574634075164795
Epoch: 3, Steps: 2 | Train Loss: 1.880 Vali Loss: 2.035 Vali Acc: 0.167 Test Loss: 2.035 Test Acc: 0.167
Validation loss decreased (-0.166645 --> -0.166646).  Saving model ...
Epoch: 4 cost time: 0.600172758102417
Epoch: 4, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.959 Vali Acc: 0.167 Test Loss: 1.959 Test Acc: 0.167
Validation loss decreased (-0.166646 --> -0.166647).  Saving model ...
Epoch: 5 cost time: 0.6221168041229248
Epoch: 5, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.881 Vali Acc: 0.167 Test Loss: 1.881 Test Acc: 0.167
Validation loss decreased (-0.166647 --> -0.166648).  Saving model ...
Epoch: 6 cost time: 0.6106157302856445
Epoch: 6, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.799 Vali Acc: 0.170 Test Loss: 1.799 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 7 cost time: 0.663844108581543
Epoch: 7, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.716 Vali Acc: 0.226 Test Loss: 1.716 Test Acc: 0.226
Validation loss decreased (-0.170352 --> -0.225909).  Saving model ...
Epoch: 8 cost time: 0.5384790897369385
Epoch: 8, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.631 Vali Acc: 0.341 Test Loss: 1.631 Test Acc: 0.341
Validation loss decreased (-0.225909 --> -0.340724).  Saving model ...
Epoch: 9 cost time: 0.6531774997711182
Epoch: 9, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.544 Vali Acc: 0.419 Test Loss: 1.544 Test Acc: 0.419
Validation loss decreased (-0.340724 --> -0.418503).  Saving model ...
Epoch: 10 cost time: 0.6707260608673096
Epoch: 10, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.455 Vali Acc: 0.470 Test Loss: 1.455 Test Acc: 0.470
Validation loss decreased (-0.418503 --> -0.470356).  Saving model ...
Epoch: 11 cost time: 0.6278514862060547
Epoch: 11, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.367 Vali Acc: 0.544 Test Loss: 1.367 Test Acc: 0.544
Validation loss decreased (-0.470356 --> -0.544431).  Saving model ...
Epoch: 12 cost time: 0.578239917755127
Epoch: 12, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.280 Vali Acc: 0.622 Test Loss: 1.280 Test Acc: 0.622
Validation loss decreased (-0.544431 --> -0.622209).  Saving model ...
Epoch: 13 cost time: 0.49451589584350586
Epoch: 13, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.196 Vali Acc: 0.659 Test Loss: 1.196 Test Acc: 0.659
Validation loss decreased (-0.622209 --> -0.659247).  Saving model ...
Epoch: 14 cost time: 0.6396932601928711
Epoch: 14, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.115 Vali Acc: 0.715 Test Loss: 1.115 Test Acc: 0.715
Validation loss decreased (-0.659247 --> -0.714804).  Saving model ...
Epoch: 15 cost time: 0.6099317073822021
Epoch: 15, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.036 Vali Acc: 0.748 Test Loss: 1.036 Test Acc: 0.748
Validation loss decreased (-0.714804 --> -0.748138).  Saving model ...
Epoch: 16 cost time: 0.5404729843139648
Epoch: 16, Steps: 2 | Train Loss: 0.936 Vali Loss: 0.962 Vali Acc: 0.770 Test Loss: 0.962 Test Acc: 0.770
Validation loss decreased (-0.748138 --> -0.770361).  Saving model ...
Epoch: 17 cost time: 0.5831444263458252
Epoch: 17, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.893 Vali Acc: 0.789 Test Loss: 0.893 Test Acc: 0.789
Validation loss decreased (-0.770361 --> -0.788880).  Saving model ...
Epoch: 18 cost time: 0.5350587368011475
Epoch: 18, Steps: 2 | Train Loss: 0.806 Vali Loss: 0.827 Vali Acc: 0.819 Test Loss: 0.827 Test Acc: 0.819
Validation loss decreased (-0.788880 --> -0.818510).  Saving model ...
Epoch: 19 cost time: 0.5943381786346436
Epoch: 19, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.769 Vali Acc: 0.841 Test Loss: 0.769 Test Acc: 0.841
Validation loss decreased (-0.818510 --> -0.840733).  Saving model ...
Epoch: 20 cost time: 0.6235334873199463
Epoch: 20, Steps: 2 | Train Loss: 0.640 Vali Loss: 0.715 Vali Acc: 0.856 Test Loss: 0.715 Test Acc: 0.856
Validation loss decreased (-0.840733 --> -0.855548).  Saving model ...
Epoch: 21 cost time: 0.5530388355255127
Epoch: 21, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.664 Vali Acc: 0.859 Test Loss: 0.664 Test Acc: 0.859
Validation loss decreased (-0.855548 --> -0.859253).  Saving model ...
Epoch: 22 cost time: 0.5990688800811768
Epoch: 22, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.618 Vali Acc: 0.878 Test Loss: 0.618 Test Acc: 0.878
Validation loss decreased (-0.859253 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 0.5857305526733398
Epoch: 23, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.577 Vali Acc: 0.874 Test Loss: 0.577 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6056811809539795
Epoch: 24, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 25 cost time: 0.5654842853546143
Epoch: 25, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.5195794105529785
Epoch: 26, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.476 Vali Acc: 0.904 Test Loss: 0.476 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 27 cost time: 0.5370543003082275
Epoch: 27, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.447 Vali Acc: 0.915 Test Loss: 0.447 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914810).  Saving model ...
Epoch: 28 cost time: 0.6266865730285645
Epoch: 28, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.421 Vali Acc: 0.919 Test Loss: 0.421 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 29 cost time: 0.6871519088745117
Epoch: 29, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.398 Vali Acc: 0.926 Test Loss: 0.398 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 0.5983371734619141
Epoch: 30, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.375 Vali Acc: 0.933 Test Loss: 0.375 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 31 cost time: 0.5491492748260498
Epoch: 31, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.356 Vali Acc: 0.933 Test Loss: 0.356 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 32 cost time: 0.7938077449798584
Epoch: 32, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.340 Vali Acc: 0.933 Test Loss: 0.340 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 33 cost time: 0.7629513740539551
Epoch: 33, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.327 Vali Acc: 0.930 Test Loss: 0.327 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6152701377868652
Epoch: 34, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.315 Vali Acc: 0.930 Test Loss: 0.315 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6965703964233398
Epoch: 35, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.307 Vali Acc: 0.926 Test Loss: 0.307 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5951189994812012
Epoch: 36, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.299 Vali Acc: 0.922 Test Loss: 0.299 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.63496994972229
Epoch: 37, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.288 Vali Acc: 0.926 Test Loss: 0.288 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6466410160064697
Epoch: 38, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6589930057525635
Epoch: 39, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.6182446479797363
Epoch: 40, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6599252223968506
Epoch: 41, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.5934154987335205
Epoch: 42, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.245 Vali Acc: 0.948 Test Loss: 0.245 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.6334507465362549
Epoch: 43, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7373125553131104
Epoch: 44, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6646397113800049
Epoch: 45, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6845464706420898
Epoch: 46, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6122434139251709
Epoch: 47, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5883052349090576
Epoch: 48, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5531401634216309
Epoch: 49, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6822113990783691
Epoch: 50, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6215920448303223
Epoch: 51, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.5860507488250732
Epoch: 52, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 50694
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3065576553344727
Epoch: 1, Steps: 2 | Train Loss: 2.043 Vali Loss: 1.942 Vali Acc: 0.030 Test Loss: 1.942 Test Acc: 0.030
Validation loss decreased (inf --> -0.029610).  Saving model ...
Epoch: 2 cost time: 0.6079361438751221
Epoch: 2, Steps: 2 | Train Loss: 2.171 Vali Loss: 1.907 Vali Acc: 0.041 Test Loss: 1.907 Test Acc: 0.041
Validation loss decreased (-0.029610 --> -0.040722).  Saving model ...
Epoch: 3 cost time: 0.6639242172241211
Epoch: 3, Steps: 2 | Train Loss: 2.069 Vali Loss: 1.880 Vali Acc: 0.063 Test Loss: 1.880 Test Acc: 0.063
Validation loss decreased (-0.040722 --> -0.062944).  Saving model ...
Epoch: 4 cost time: 0.6649036407470703
Epoch: 4, Steps: 2 | Train Loss: 2.026 Vali Loss: 1.853 Vali Acc: 0.085 Test Loss: 1.853 Test Acc: 0.085
Validation loss decreased (-0.062944 --> -0.085167).  Saving model ...
Epoch: 5 cost time: 0.6692996025085449
Epoch: 5, Steps: 2 | Train Loss: 1.992 Vali Loss: 1.818 Vali Acc: 0.104 Test Loss: 1.818 Test Acc: 0.104
Validation loss decreased (-0.085167 --> -0.103686).  Saving model ...
Epoch: 6 cost time: 0.6907763481140137
Epoch: 6, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.774 Vali Acc: 0.156 Test Loss: 1.774 Test Acc: 0.156
Validation loss decreased (-0.103686 --> -0.155538).  Saving model ...
Epoch: 7 cost time: 0.582578182220459
Epoch: 7, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.722 Vali Acc: 0.233 Test Loss: 1.722 Test Acc: 0.233
Validation loss decreased (-0.155538 --> -0.233316).  Saving model ...
Epoch: 8 cost time: 0.6236543655395508
Epoch: 8, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.662 Vali Acc: 0.274 Test Loss: 1.662 Test Acc: 0.274
Validation loss decreased (-0.233316 --> -0.274057).  Saving model ...
Epoch: 9 cost time: 0.7130889892578125
Epoch: 9, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.597 Vali Acc: 0.352 Test Loss: 1.597 Test Acc: 0.352
Validation loss decreased (-0.274057 --> -0.351836).  Saving model ...
Epoch: 10 cost time: 0.6246888637542725
Epoch: 10, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.529 Vali Acc: 0.433 Test Loss: 1.529 Test Acc: 0.433
Validation loss decreased (-0.351836 --> -0.433318).  Saving model ...
Epoch: 11 cost time: 0.5545883178710938
Epoch: 11, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.459 Vali Acc: 0.504 Test Loss: 1.459 Test Acc: 0.504
Validation loss decreased (-0.433318 --> -0.503689).  Saving model ...
Epoch: 12 cost time: 0.5965571403503418
Epoch: 12, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.388 Vali Acc: 0.593 Test Loss: 1.388 Test Acc: 0.593
Validation loss decreased (-0.503689 --> -0.592579).  Saving model ...
Epoch: 13 cost time: 0.6067318916320801
Epoch: 13, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.315 Vali Acc: 0.633 Test Loss: 1.315 Test Acc: 0.633
Validation loss decreased (-0.592579 --> -0.633320).  Saving model ...
Epoch: 14 cost time: 0.6611652374267578
Epoch: 14, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.242 Vali Acc: 0.659 Test Loss: 1.242 Test Acc: 0.659
Validation loss decreased (-0.633320 --> -0.659247).  Saving model ...
Epoch: 15 cost time: 0.6795427799224854
Epoch: 15, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.169 Vali Acc: 0.704 Test Loss: 1.169 Test Acc: 0.704
Validation loss decreased (-0.659247 --> -0.703692).  Saving model ...
Epoch: 16 cost time: 0.6500017642974854
Epoch: 16, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.099 Vali Acc: 0.737 Test Loss: 1.099 Test Acc: 0.737
Validation loss decreased (-0.703692 --> -0.737026).  Saving model ...
Epoch: 17 cost time: 0.6906046867370605
Epoch: 17, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.031 Vali Acc: 0.759 Test Loss: 1.031 Test Acc: 0.759
Validation loss decreased (-0.737026 --> -0.759249).  Saving model ...
Epoch: 18 cost time: 0.6513557434082031
Epoch: 18, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.965 Vali Acc: 0.811 Test Loss: 0.965 Test Acc: 0.811
Validation loss decreased (-0.759249 --> -0.811101).  Saving model ...
Epoch: 19 cost time: 0.7197489738464355
Epoch: 19, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.902 Vali Acc: 0.844 Test Loss: 0.902 Test Acc: 0.844
Validation loss decreased (-0.811101 --> -0.844435).  Saving model ...
Epoch: 20 cost time: 0.6162633895874023
Epoch: 20, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.843 Vali Acc: 0.863 Test Loss: 0.843 Test Acc: 0.863
Validation loss decreased (-0.844435 --> -0.862955).  Saving model ...
Epoch: 21 cost time: 0.6620533466339111
Epoch: 21, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.786 Vali Acc: 0.874 Test Loss: 0.786 Test Acc: 0.874
Validation loss decreased (-0.862955 --> -0.874066).  Saving model ...
Epoch: 22 cost time: 0.6955578327178955
Epoch: 22, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.734 Vali Acc: 0.878 Test Loss: 0.734 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877770).  Saving model ...
Epoch: 23 cost time: 0.6849286556243896
Epoch: 23, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.686 Vali Acc: 0.896 Test Loss: 0.686 Test Acc: 0.896
Validation loss decreased (-0.877770 --> -0.896289).  Saving model ...
Epoch: 24 cost time: 0.6518528461456299
Epoch: 24, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.641 Vali Acc: 0.896 Test Loss: 0.641 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896290).  Saving model ...
Epoch: 25 cost time: 0.6331942081451416
Epoch: 25, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.600 Vali Acc: 0.900 Test Loss: 0.600 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.6892998218536377
Epoch: 26, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.563 Vali Acc: 0.904 Test Loss: 0.563 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 27 cost time: 0.6615111827850342
Epoch: 27, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.527 Vali Acc: 0.911 Test Loss: 0.527 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 28 cost time: 0.7095718383789062
Epoch: 28, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.495 Vali Acc: 0.930 Test Loss: 0.495 Test Acc: 0.930
Validation loss decreased (-0.911106 --> -0.929625).  Saving model ...
Epoch: 29 cost time: 0.6852679252624512
Epoch: 29, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.466 Vali Acc: 0.933 Test Loss: 0.466 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 30 cost time: 0.7144780158996582
Epoch: 30, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.439 Vali Acc: 0.933 Test Loss: 0.439 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 31 cost time: 0.697479248046875
Epoch: 31, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.415 Vali Acc: 0.933 Test Loss: 0.415 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 32 cost time: 0.6464869976043701
Epoch: 32, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.392 Vali Acc: 0.933 Test Loss: 0.392 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 33 cost time: 0.6073884963989258
Epoch: 33, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.373 Vali Acc: 0.933 Test Loss: 0.373 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 34 cost time: 0.7678165435791016
Epoch: 34, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.354 Vali Acc: 0.933 Test Loss: 0.354 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 35 cost time: 0.6038796901702881
Epoch: 35, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.337 Vali Acc: 0.933 Test Loss: 0.337 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 36 cost time: 0.5681428909301758
Epoch: 36, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.321 Vali Acc: 0.933 Test Loss: 0.321 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 0.606656551361084
Epoch: 37, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.308 Vali Acc: 0.937 Test Loss: 0.308 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 38 cost time: 0.5952117443084717
Epoch: 38, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.297 Vali Acc: 0.941 Test Loss: 0.297 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 39 cost time: 0.6517839431762695
Epoch: 39, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 40 cost time: 0.6752903461456299
Epoch: 40, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5926530361175537
Epoch: 41, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.6274712085723877
Epoch: 42, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6922171115875244
Epoch: 43, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6487247943878174
Epoch: 44, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6964719295501709
Epoch: 45, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6385061740875244
Epoch: 46, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.570404052734375
Epoch: 47, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.6154155731201172
Epoch: 48, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.6412391662597656
Epoch: 49, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5340597629547119
Epoch: 50, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.582721471786499
Epoch: 51, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.6281065940856934
Epoch: 52, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7078332901000977
Epoch: 53, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.7054495811462402
Epoch: 54, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.6224136352539062
Epoch: 55, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.6214523315429688
Epoch: 56, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.724355936050415
Epoch: 57, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.6118824481964111
Epoch: 58, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 48486
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.300694227218628
Epoch: 1, Steps: 2 | Train Loss: 1.957 Vali Loss: 1.986 Vali Acc: 0.167 Test Loss: 1.986 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.6440255641937256
Epoch: 2, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.948 Vali Acc: 0.193 Test Loss: 1.948 Test Acc: 0.193
Validation loss decreased (-0.166647 --> -0.192573).  Saving model ...
Epoch: 3 cost time: 0.5950994491577148
Epoch: 3, Steps: 2 | Train Loss: 1.951 Vali Loss: 1.919 Vali Acc: 0.230 Test Loss: 1.919 Test Acc: 0.230
Validation loss decreased (-0.192573 --> -0.229610).  Saving model ...
Epoch: 4 cost time: 0.5238757133483887
Epoch: 4, Steps: 2 | Train Loss: 2.018 Vali Loss: 1.892 Vali Acc: 0.259 Test Loss: 1.892 Test Acc: 0.259
Validation loss decreased (-0.229610 --> -0.259240).  Saving model ...
Epoch: 5 cost time: 0.529071569442749
Epoch: 5, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.858 Vali Acc: 0.296 Test Loss: 1.858 Test Acc: 0.296
Validation loss decreased (-0.259240 --> -0.296278).  Saving model ...
Epoch: 6 cost time: 0.5994822978973389
Epoch: 6, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.818 Vali Acc: 0.307 Test Loss: 1.818 Test Acc: 0.307
Validation loss decreased (-0.296278 --> -0.307389).  Saving model ...
Epoch: 7 cost time: 0.6470692157745361
Epoch: 7, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.772 Vali Acc: 0.344 Test Loss: 1.772 Test Acc: 0.344
Validation loss decreased (-0.307389 --> -0.344427).  Saving model ...
Epoch: 8 cost time: 0.76851487159729
Epoch: 8, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.723 Vali Acc: 0.363 Test Loss: 1.723 Test Acc: 0.363
Validation loss decreased (-0.344427 --> -0.362946).  Saving model ...
Epoch: 9 cost time: 0.6354074478149414
Epoch: 9, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.670 Vali Acc: 0.381 Test Loss: 1.670 Test Acc: 0.381
Validation loss decreased (-0.362946 --> -0.381465).  Saving model ...
Epoch: 10 cost time: 0.6555626392364502
Epoch: 10, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.614 Vali Acc: 0.426 Test Loss: 1.614 Test Acc: 0.426
Validation loss decreased (-0.381465 --> -0.425910).  Saving model ...
Epoch: 11 cost time: 0.5613670349121094
Epoch: 11, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.557 Vali Acc: 0.459 Test Loss: 1.557 Test Acc: 0.459
Validation loss decreased (-0.425910 --> -0.459244).  Saving model ...
Epoch: 12 cost time: 0.5429575443267822
Epoch: 12, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.498 Vali Acc: 0.500 Test Loss: 1.498 Test Acc: 0.500
Validation loss decreased (-0.459244 --> -0.499985).  Saving model ...
Epoch: 13 cost time: 0.6164329051971436
Epoch: 13, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.439 Vali Acc: 0.541 Test Loss: 1.439 Test Acc: 0.541
Validation loss decreased (-0.499985 --> -0.540726).  Saving model ...
Epoch: 14 cost time: 0.6897890567779541
Epoch: 14, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.378 Vali Acc: 0.578 Test Loss: 1.378 Test Acc: 0.578
Validation loss decreased (-0.540726 --> -0.577764).  Saving model ...
Epoch: 15 cost time: 0.5794670581817627
Epoch: 15, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.318 Vali Acc: 0.611 Test Loss: 1.318 Test Acc: 0.611
Validation loss decreased (-0.577764 --> -0.611098).  Saving model ...
Epoch: 16 cost time: 0.5869946479797363
Epoch: 16, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.257 Vali Acc: 0.630 Test Loss: 1.257 Test Acc: 0.630
Validation loss decreased (-0.611098 --> -0.629617).  Saving model ...
Epoch: 17 cost time: 0.5177862644195557
Epoch: 17, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.198 Vali Acc: 0.652 Test Loss: 1.198 Test Acc: 0.652
Validation loss decreased (-0.629617 --> -0.651840).  Saving model ...
Epoch: 18 cost time: 0.5216729640960693
Epoch: 18, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.141 Vali Acc: 0.707 Test Loss: 1.141 Test Acc: 0.707
Validation loss decreased (-0.651840 --> -0.707396).  Saving model ...
Epoch: 19 cost time: 0.5424313545227051
Epoch: 19, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.084 Vali Acc: 0.737 Test Loss: 1.084 Test Acc: 0.737
Validation loss decreased (-0.707396 --> -0.737026).  Saving model ...
Epoch: 20 cost time: 0.5540616512298584
Epoch: 20, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.028 Vali Acc: 0.756 Test Loss: 1.028 Test Acc: 0.756
Validation loss decreased (-0.737026 --> -0.755545).  Saving model ...
Epoch: 21 cost time: 0.5043487548828125
Epoch: 21, Steps: 2 | Train Loss: 1.014 Vali Loss: 0.975 Vali Acc: 0.770 Test Loss: 0.975 Test Acc: 0.770
Validation loss decreased (-0.755545 --> -0.770361).  Saving model ...
Epoch: 22 cost time: 0.6035919189453125
Epoch: 22, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.924 Vali Acc: 0.796 Test Loss: 0.924 Test Acc: 0.796
Validation loss decreased (-0.770361 --> -0.796287).  Saving model ...
Epoch: 23 cost time: 0.5620834827423096
Epoch: 23, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.874 Vali Acc: 0.807 Test Loss: 0.874 Test Acc: 0.807
Validation loss decreased (-0.796287 --> -0.807399).  Saving model ...
Epoch: 24 cost time: 0.6197574138641357
Epoch: 24, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.826 Vali Acc: 0.822 Test Loss: 0.826 Test Acc: 0.822
Validation loss decreased (-0.807399 --> -0.822214).  Saving model ...
Epoch: 25 cost time: 0.6398313045501709
Epoch: 25, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.781 Vali Acc: 0.837 Test Loss: 0.781 Test Acc: 0.837
Validation loss decreased (-0.822214 --> -0.837029).  Saving model ...
Epoch: 26 cost time: 0.6087665557861328
Epoch: 26, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.738 Vali Acc: 0.844 Test Loss: 0.738 Test Acc: 0.844
Validation loss decreased (-0.837029 --> -0.844437).  Saving model ...
Epoch: 27 cost time: 0.5422649383544922
Epoch: 27, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.699 Vali Acc: 0.844 Test Loss: 0.699 Test Acc: 0.844
Validation loss decreased (-0.844437 --> -0.844437).  Saving model ...
Epoch: 28 cost time: 0.6247384548187256
Epoch: 28, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.661 Vali Acc: 0.856 Test Loss: 0.661 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855549).  Saving model ...
Epoch: 29 cost time: 0.5454051494598389
Epoch: 29, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.626 Vali Acc: 0.863 Test Loss: 0.626 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862957).  Saving model ...
Epoch: 30 cost time: 0.5373437404632568
Epoch: 30, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.592 Vali Acc: 0.863 Test Loss: 0.592 Test Acc: 0.863
Validation loss decreased (-0.862957 --> -0.862957).  Saving model ...
Epoch: 31 cost time: 0.5342123508453369
Epoch: 31, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.560 Vali Acc: 0.874 Test Loss: 0.560 Test Acc: 0.874
Validation loss decreased (-0.862957 --> -0.874068).  Saving model ...
Epoch: 32 cost time: 0.5327165126800537
Epoch: 32, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.530 Vali Acc: 0.896 Test Loss: 0.530 Test Acc: 0.896
Validation loss decreased (-0.874068 --> -0.896291).  Saving model ...
Epoch: 33 cost time: 0.5800521373748779
Epoch: 33, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.502 Vali Acc: 0.904 Test Loss: 0.502 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 34 cost time: 0.6141183376312256
Epoch: 34, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.478 Vali Acc: 0.904 Test Loss: 0.478 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 35 cost time: 0.5931940078735352
Epoch: 35, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.454 Vali Acc: 0.907 Test Loss: 0.454 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 36 cost time: 0.6087417602539062
Epoch: 36, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.434 Vali Acc: 0.911 Test Loss: 0.434 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 37 cost time: 0.6771020889282227
Epoch: 37, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.417 Vali Acc: 0.911 Test Loss: 0.417 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 38 cost time: 0.5932059288024902
Epoch: 38, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.402 Vali Acc: 0.915 Test Loss: 0.402 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 39 cost time: 0.6058762073516846
Epoch: 39, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.389 Vali Acc: 0.915 Test Loss: 0.389 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 40 cost time: 0.5874238014221191
Epoch: 40, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.379 Vali Acc: 0.919 Test Loss: 0.379 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 41 cost time: 0.6543624401092529
Epoch: 41, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.369 Vali Acc: 0.915 Test Loss: 0.369 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7382755279541016
Epoch: 42, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.359 Vali Acc: 0.919 Test Loss: 0.359 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 43 cost time: 0.6248829364776611
Epoch: 43, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.350 Vali Acc: 0.915 Test Loss: 0.350 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7639904022216797
Epoch: 44, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.342 Vali Acc: 0.915 Test Loss: 0.342 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7453305721282959
Epoch: 45, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.335 Vali Acc: 0.915 Test Loss: 0.335 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6770269870758057
Epoch: 46, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.328 Vali Acc: 0.915 Test Loss: 0.328 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6492369174957275
Epoch: 47, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.322 Vali Acc: 0.915 Test Loss: 0.322 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7864437103271484
Epoch: 48, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 49 cost time: 0.7253625392913818
Epoch: 49, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.308 Vali Acc: 0.922 Test Loss: 0.308 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 50 cost time: 0.6920771598815918
Epoch: 50, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.302 Vali Acc: 0.926 Test Loss: 0.302 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 51 cost time: 0.6037957668304443
Epoch: 51, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 52 cost time: 0.6471707820892334
Epoch: 52, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 53 cost time: 0.6262290477752686
Epoch: 53, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.288 Vali Acc: 0.930 Test Loss: 0.288 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 54 cost time: 0.6422991752624512
Epoch: 54, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 55 cost time: 0.572843074798584
Epoch: 55, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 56 cost time: 0.9225146770477295
Epoch: 56, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.275 Vali Acc: 0.930 Test Loss: 0.275 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 57 cost time: 0.6359274387359619
Epoch: 57, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.272 Vali Acc: 0.926 Test Loss: 0.272 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5340700149536133
Epoch: 58, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.269 Vali Acc: 0.926 Test Loss: 0.269 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5427508354187012
Epoch: 59, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 60 cost time: 0.5859565734863281
Epoch: 60, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 61 cost time: 0.5298588275909424
Epoch: 61, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 62 cost time: 0.593625545501709
Epoch: 62, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 63 cost time: 0.6397688388824463
Epoch: 63, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 64 cost time: 0.5303668975830078
Epoch: 64, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 65 cost time: 0.588620662689209
Epoch: 65, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 66 cost time: 0.5717217922210693
Epoch: 66, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 67 cost time: 0.7190806865692139
Epoch: 67, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 68 cost time: 0.5519044399261475
Epoch: 68, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 69 cost time: 0.5829203128814697
Epoch: 69, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 70 cost time: 0.5505709648132324
Epoch: 70, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 71 cost time: 0.6130876541137695
Epoch: 71, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.5574729442596436
Epoch: 72, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.5269713401794434
Epoch: 73, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.5879197120666504
Epoch: 74, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.8401222229003906
Epoch: 75, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.6225333213806152
Epoch: 76, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.5307374000549316
Epoch: 77, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.6887128353118896
Epoch: 78, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.5750136375427246
Epoch: 79, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.619417667388916
Epoch: 80, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 45510
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2266273498535156
Epoch: 1, Steps: 2 | Train Loss: 1.908 Vali Loss: 1.938 Vali Acc: 0.130 Test Loss: 1.938 Test Acc: 0.130
Validation loss decreased (inf --> -0.129610).  Saving model ...
Epoch: 2 cost time: 0.537194013595581
Epoch: 2, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.887 Vali Acc: 0.152 Test Loss: 1.887 Test Acc: 0.152
Validation loss decreased (-0.129610 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 0.6183362007141113
Epoch: 3, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.852 Vali Acc: 0.170 Test Loss: 1.852 Test Acc: 0.170
Validation loss decreased (-0.151833 --> -0.170352).  Saving model ...
Epoch: 4 cost time: 0.6282262802124023
Epoch: 4, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.825 Vali Acc: 0.163 Test Loss: 1.825 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5962698459625244
Epoch: 5, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.795 Vali Acc: 0.193 Test Loss: 1.795 Test Acc: 0.193
Validation loss decreased (-0.170352 --> -0.192575).  Saving model ...
Epoch: 6 cost time: 0.5493721961975098
Epoch: 6, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.763 Vali Acc: 0.226 Test Loss: 1.763 Test Acc: 0.226
Validation loss decreased (-0.192575 --> -0.225908).  Saving model ...
Epoch: 7 cost time: 0.6329052448272705
Epoch: 7, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.728 Vali Acc: 0.270 Test Loss: 1.728 Test Acc: 0.270
Validation loss decreased (-0.225908 --> -0.270353).  Saving model ...
Epoch: 8 cost time: 0.5647001266479492
Epoch: 8, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.692 Vali Acc: 0.304 Test Loss: 1.692 Test Acc: 0.304
Validation loss decreased (-0.270353 --> -0.303687).  Saving model ...
Epoch: 9 cost time: 0.5488369464874268
Epoch: 9, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.652 Vali Acc: 0.374 Test Loss: 1.652 Test Acc: 0.374
Validation loss decreased (-0.303687 --> -0.374058).  Saving model ...
Epoch: 10 cost time: 0.6004841327667236
Epoch: 10, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.610 Vali Acc: 0.411 Test Loss: 1.610 Test Acc: 0.411
Validation loss decreased (-0.374058 --> -0.411095).  Saving model ...
Epoch: 11 cost time: 0.6812870502471924
Epoch: 11, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.566 Vali Acc: 0.444 Test Loss: 1.566 Test Acc: 0.444
Validation loss decreased (-0.411095 --> -0.444429).  Saving model ...
Epoch: 12 cost time: 0.6235101222991943
Epoch: 12, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.519 Vali Acc: 0.496 Test Loss: 1.519 Test Acc: 0.496
Validation loss decreased (-0.444429 --> -0.496281).  Saving model ...
Epoch: 13 cost time: 0.5844030380249023
Epoch: 13, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.471 Vali Acc: 0.515 Test Loss: 1.471 Test Acc: 0.515
Validation loss decreased (-0.496281 --> -0.514800).  Saving model ...
Epoch: 14 cost time: 0.5784599781036377
Epoch: 14, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.422 Vali Acc: 0.537 Test Loss: 1.422 Test Acc: 0.537
Validation loss decreased (-0.514800 --> -0.537023).  Saving model ...
Epoch: 15 cost time: 0.5811161994934082
Epoch: 15, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.373 Vali Acc: 0.581 Test Loss: 1.373 Test Acc: 0.581
Validation loss decreased (-0.537023 --> -0.581468).  Saving model ...
Epoch: 16 cost time: 0.5175273418426514
Epoch: 16, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.323 Vali Acc: 0.622 Test Loss: 1.323 Test Acc: 0.622
Validation loss decreased (-0.581468 --> -0.622209).  Saving model ...
Epoch: 17 cost time: 0.5813174247741699
Epoch: 17, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.273 Vali Acc: 0.656 Test Loss: 1.273 Test Acc: 0.656
Validation loss decreased (-0.622209 --> -0.655543).  Saving model ...
Epoch: 18 cost time: 0.588890552520752
Epoch: 18, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.223 Vali Acc: 0.685 Test Loss: 1.223 Test Acc: 0.685
Validation loss decreased (-0.655543 --> -0.685173).  Saving model ...
Epoch: 19 cost time: 0.5762479305267334
Epoch: 19, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.173 Vali Acc: 0.704 Test Loss: 1.173 Test Acc: 0.704
Validation loss decreased (-0.685173 --> -0.703692).  Saving model ...
Epoch: 20 cost time: 0.7208783626556396
Epoch: 20, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.123 Vali Acc: 0.715 Test Loss: 1.123 Test Acc: 0.715
Validation loss decreased (-0.703692 --> -0.714804).  Saving model ...
Epoch: 21 cost time: 0.512033224105835
Epoch: 21, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.074 Vali Acc: 0.737 Test Loss: 1.074 Test Acc: 0.737
Validation loss decreased (-0.714804 --> -0.737026).  Saving model ...
Epoch: 22 cost time: 0.5839171409606934
Epoch: 22, Steps: 2 | Train Loss: 0.945 Vali Loss: 1.026 Vali Acc: 0.756 Test Loss: 1.026 Test Acc: 0.756
Validation loss decreased (-0.737026 --> -0.755545).  Saving model ...
Epoch: 23 cost time: 0.5475168228149414
Epoch: 23, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.979 Vali Acc: 0.789 Test Loss: 0.979 Test Acc: 0.789
Validation loss decreased (-0.755545 --> -0.788879).  Saving model ...
Epoch: 24 cost time: 0.5053935050964355
Epoch: 24, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.933 Vali Acc: 0.807 Test Loss: 0.933 Test Acc: 0.807
Validation loss decreased (-0.788879 --> -0.807398).  Saving model ...
Epoch: 25 cost time: 0.5429680347442627
Epoch: 25, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.889 Vali Acc: 0.826 Test Loss: 0.889 Test Acc: 0.826
Validation loss decreased (-0.807398 --> -0.825917).  Saving model ...
Epoch: 26 cost time: 0.5520710945129395
Epoch: 26, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.845 Vali Acc: 0.841 Test Loss: 0.845 Test Acc: 0.841
Validation loss decreased (-0.825917 --> -0.840732).  Saving model ...
Epoch: 27 cost time: 0.5777983665466309
Epoch: 27, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.804 Vali Acc: 0.859 Test Loss: 0.804 Test Acc: 0.859
Validation loss decreased (-0.840732 --> -0.859251).  Saving model ...
Epoch: 28 cost time: 0.5857365131378174
Epoch: 28, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.763 Vali Acc: 0.870 Test Loss: 0.763 Test Acc: 0.870
Validation loss decreased (-0.859251 --> -0.870363).  Saving model ...
Epoch: 29 cost time: 0.6060831546783447
Epoch: 29, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.725 Vali Acc: 0.874 Test Loss: 0.725 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 30 cost time: 0.5602514743804932
Epoch: 30, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.688 Vali Acc: 0.881 Test Loss: 0.688 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881475).  Saving model ...
Epoch: 31 cost time: 0.6899454593658447
Epoch: 31, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.653 Vali Acc: 0.881 Test Loss: 0.653 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 32 cost time: 0.6380186080932617
Epoch: 32, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.621 Vali Acc: 0.889 Test Loss: 0.621 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888883).  Saving model ...
Epoch: 33 cost time: 0.599989652633667
Epoch: 33, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.590 Vali Acc: 0.893 Test Loss: 0.590 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 34 cost time: 0.6143627166748047
Epoch: 34, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.561 Vali Acc: 0.896 Test Loss: 0.561 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 35 cost time: 0.5815243721008301
Epoch: 35, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.534 Vali Acc: 0.896 Test Loss: 0.534 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 36 cost time: 0.6813743114471436
Epoch: 36, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 37 cost time: 0.5959219932556152
Epoch: 37, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.485 Vali Acc: 0.907 Test Loss: 0.485 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 38 cost time: 0.6089756488800049
Epoch: 38, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.464 Vali Acc: 0.915 Test Loss: 0.464 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914810).  Saving model ...
Epoch: 39 cost time: 0.5714764595031738
Epoch: 39, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.446 Vali Acc: 0.919 Test Loss: 0.446 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 40 cost time: 0.6367218494415283
Epoch: 40, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.428 Vali Acc: 0.919 Test Loss: 0.428 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 41 cost time: 0.6941180229187012
Epoch: 41, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.412 Vali Acc: 0.919 Test Loss: 0.412 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 42 cost time: 0.6964795589447021
Epoch: 42, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.397 Vali Acc: 0.919 Test Loss: 0.397 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 43 cost time: 0.58139967918396
Epoch: 43, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.384 Vali Acc: 0.922 Test Loss: 0.384 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922218).  Saving model ...
Epoch: 44 cost time: 0.6960856914520264
Epoch: 44, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.372 Vali Acc: 0.926 Test Loss: 0.372 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 45 cost time: 0.6793651580810547
Epoch: 45, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.361 Vali Acc: 0.926 Test Loss: 0.361 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 46 cost time: 0.6605396270751953
Epoch: 46, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.351 Vali Acc: 0.933 Test Loss: 0.351 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 47 cost time: 0.5636043548583984
Epoch: 47, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 48 cost time: 0.6057829856872559
Epoch: 48, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.333 Vali Acc: 0.937 Test Loss: 0.333 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 49 cost time: 0.5670948028564453
Epoch: 49, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.325 Vali Acc: 0.941 Test Loss: 0.325 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940737).  Saving model ...
Epoch: 50 cost time: 0.6248719692230225
Epoch: 50, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.318 Vali Acc: 0.944 Test Loss: 0.318 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 51 cost time: 0.5408689975738525
Epoch: 51, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 52 cost time: 0.623347282409668
Epoch: 52, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 53 cost time: 0.5696792602539062
Epoch: 53, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6517994403839111
Epoch: 54, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.293 Vali Acc: 0.941 Test Loss: 0.293 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6179676055908203
Epoch: 55, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6321561336517334
Epoch: 56, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.581902265548706
Epoch: 57, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5682539939880371
Epoch: 58, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.6699955463409424
Epoch: 59, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.268 Vali Acc: 0.948 Test Loss: 0.268 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 60 cost time: 0.5716121196746826
Epoch: 60, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.264 Vali Acc: 0.952 Test Loss: 0.264 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 61 cost time: 0.6006371974945068
Epoch: 61, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.260 Vali Acc: 0.959 Test Loss: 0.260 Test Acc: 0.959
Validation loss decreased (-0.951849 --> -0.959257).  Saving model ...
Epoch: 62 cost time: 0.5986220836639404
Epoch: 62, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.257 Vali Acc: 0.963 Test Loss: 0.257 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962960).  Saving model ...
Epoch: 63 cost time: 0.5531542301177979
Epoch: 63, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.254 Vali Acc: 0.959 Test Loss: 0.254 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5742340087890625
Epoch: 64, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.251 Vali Acc: 0.956 Test Loss: 0.251 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.5324451923370361
Epoch: 65, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.249 Vali Acc: 0.956 Test Loss: 0.249 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.5944006443023682
Epoch: 66, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.246 Vali Acc: 0.956 Test Loss: 0.246 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7286620140075684
Epoch: 67, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.244 Vali Acc: 0.956 Test Loss: 0.244 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.5902459621429443
Epoch: 68, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.242 Vali Acc: 0.956 Test Loss: 0.242 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.5286800861358643
Epoch: 69, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.238 Vali Acc: 0.956 Test Loss: 0.238 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.5416064262390137
Epoch: 70, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.235 Vali Acc: 0.956 Test Loss: 0.235 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.49524378776550293
Epoch: 71, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.232 Vali Acc: 0.956 Test Loss: 0.232 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.5290076732635498
Epoch: 72, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.229 Vali Acc: 0.959 Test Loss: 0.229 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 44102
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.423569917678833
Epoch: 1, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.647 Vali Acc: 0.396 Test Loss: 1.647 Test Acc: 0.396
Validation loss decreased (inf --> -0.396280).  Saving model ...
Epoch: 2 cost time: 0.6656575202941895
Epoch: 2, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.556 Vali Acc: 0.459 Test Loss: 1.556 Test Acc: 0.459
Validation loss decreased (-0.396280 --> -0.459244).  Saving model ...
Epoch: 3 cost time: 0.843095064163208
Epoch: 3, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.465 Vali Acc: 0.533 Test Loss: 1.465 Test Acc: 0.533
Validation loss decreased (-0.459244 --> -0.533319).  Saving model ...
Epoch: 4 cost time: 0.6735196113586426
Epoch: 4, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.341 Vali Acc: 0.637 Test Loss: 1.341 Test Acc: 0.637
Validation loss decreased (-0.533319 --> -0.637024).  Saving model ...
Epoch: 5 cost time: 0.7465629577636719
Epoch: 5, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.201 Vali Acc: 0.744 Test Loss: 1.201 Test Acc: 0.744
Validation loss decreased (-0.637024 --> -0.744432).  Saving model ...
Epoch: 6 cost time: 0.717747688293457
Epoch: 6, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.063 Vali Acc: 0.796 Test Loss: 1.063 Test Acc: 0.796
Validation loss decreased (-0.744432 --> -0.796286).  Saving model ...
Epoch: 7 cost time: 0.6917798519134521
Epoch: 7, Steps: 2 | Train Loss: 0.988 Vali Loss: 0.934 Vali Acc: 0.807 Test Loss: 0.934 Test Acc: 0.807
Validation loss decreased (-0.796286 --> -0.807398).  Saving model ...
Epoch: 8 cost time: 0.7181613445281982
Epoch: 8, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.815 Vali Acc: 0.826 Test Loss: 0.815 Test Acc: 0.826
Validation loss decreased (-0.807398 --> -0.825918).  Saving model ...
Epoch: 9 cost time: 0.6503932476043701
Epoch: 9, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.708 Vali Acc: 0.848 Test Loss: 0.708 Test Acc: 0.848
Validation loss decreased (-0.825918 --> -0.848141).  Saving model ...
Epoch: 10 cost time: 0.8738937377929688
Epoch: 10, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.605 Vali Acc: 0.893 Test Loss: 0.605 Test Acc: 0.893
Validation loss decreased (-0.848141 --> -0.892587).  Saving model ...
Epoch: 11 cost time: 0.8223798274993896
Epoch: 11, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.517 Vali Acc: 0.919 Test Loss: 0.517 Test Acc: 0.919
Validation loss decreased (-0.892587 --> -0.918513).  Saving model ...
Epoch: 12 cost time: 0.7882614135742188
Epoch: 12, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.446 Vali Acc: 0.941 Test Loss: 0.446 Test Acc: 0.941
Validation loss decreased (-0.918513 --> -0.940736).  Saving model ...
Epoch: 13 cost time: 0.7222561836242676
Epoch: 13, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.390 Vali Acc: 0.941 Test Loss: 0.390 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 14 cost time: 0.6814162731170654
Epoch: 14, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.341 Vali Acc: 0.944 Test Loss: 0.341 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.7194192409515381
Epoch: 15, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.306 Vali Acc: 0.941 Test Loss: 0.306 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7231409549713135
Epoch: 16, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.272 Vali Acc: 0.952 Test Loss: 0.272 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951849).  Saving model ...
Epoch: 17 cost time: 0.6444604396820068
Epoch: 17, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 18 cost time: 0.8860087394714355
Epoch: 18, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.222 Vali Acc: 0.956 Test Loss: 0.222 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 19 cost time: 0.8311569690704346
Epoch: 19, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 20 cost time: 0.7449996471405029
Epoch: 20, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 21 cost time: 0.6577258110046387
Epoch: 21, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 22 cost time: 0.7410452365875244
Epoch: 22, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 23 cost time: 0.6337192058563232
Epoch: 23, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959258).  Saving model ...
Epoch: 24 cost time: 0.7369322776794434
Epoch: 24, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6697101593017578
Epoch: 25, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6828172206878662
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7796263694763184
Epoch: 27, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6629600524902344
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6887331008911133
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6406371593475342
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6789512634277344
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6468808650970459
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6680560111999512
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 75686
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1373560428619385
Epoch: 1, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.809 Vali Acc: 0.211 Test Loss: 1.809 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.676018476486206
Epoch: 2, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.717 Vali Acc: 0.256 Test Loss: 1.717 Test Acc: 0.256
Validation loss decreased (-0.211093 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 0.5522544384002686
Epoch: 3, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.639 Vali Acc: 0.315 Test Loss: 1.639 Test Acc: 0.315
Validation loss decreased (-0.255538 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 0.5345191955566406
Epoch: 4, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.552 Vali Acc: 0.374 Test Loss: 1.552 Test Acc: 0.374
Validation loss decreased (-0.314798 --> -0.374059).  Saving model ...
Epoch: 5 cost time: 0.6465635299682617
Epoch: 5, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.452 Vali Acc: 0.467 Test Loss: 1.452 Test Acc: 0.467
Validation loss decreased (-0.374059 --> -0.466652).  Saving model ...
Epoch: 6 cost time: 0.7561569213867188
Epoch: 6, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.345 Vali Acc: 0.630 Test Loss: 1.345 Test Acc: 0.630
Validation loss decreased (-0.466652 --> -0.629616).  Saving model ...
Epoch: 7 cost time: 0.589970588684082
Epoch: 7, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.237 Vali Acc: 0.707 Test Loss: 1.237 Test Acc: 0.707
Validation loss decreased (-0.629616 --> -0.707395).  Saving model ...
Epoch: 8 cost time: 0.5580093860626221
Epoch: 8, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.130 Vali Acc: 0.759 Test Loss: 1.130 Test Acc: 0.759
Validation loss decreased (-0.707395 --> -0.759248).  Saving model ...
Epoch: 9 cost time: 0.5856513977050781
Epoch: 9, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.027 Vali Acc: 0.789 Test Loss: 1.027 Test Acc: 0.789
Validation loss decreased (-0.759248 --> -0.788879).  Saving model ...
Epoch: 10 cost time: 0.7360751628875732
Epoch: 10, Steps: 2 | Train Loss: 1.004 Vali Loss: 0.928 Vali Acc: 0.796 Test Loss: 0.928 Test Acc: 0.796
Validation loss decreased (-0.788879 --> -0.796287).  Saving model ...
Epoch: 11 cost time: 0.6140925884246826
Epoch: 11, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.837 Vali Acc: 0.822 Test Loss: 0.837 Test Acc: 0.822
Validation loss decreased (-0.796287 --> -0.822214).  Saving model ...
Epoch: 12 cost time: 0.7297513484954834
Epoch: 12, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.755 Vali Acc: 0.833 Test Loss: 0.755 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833326).  Saving model ...
Epoch: 13 cost time: 0.7319355010986328
Epoch: 13, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.685 Vali Acc: 0.863 Test Loss: 0.685 Test Acc: 0.863
Validation loss decreased (-0.833326 --> -0.862956).  Saving model ...
Epoch: 14 cost time: 0.6077327728271484
Epoch: 14, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.623 Vali Acc: 0.889 Test Loss: 0.623 Test Acc: 0.889
Validation loss decreased (-0.862956 --> -0.888883).  Saving model ...
Epoch: 15 cost time: 0.6506149768829346
Epoch: 15, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.567 Vali Acc: 0.900 Test Loss: 0.567 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.6592240333557129
Epoch: 16, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.518 Vali Acc: 0.911 Test Loss: 0.518 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911106).  Saving model ...
Epoch: 17 cost time: 0.653623104095459
Epoch: 17, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.475 Vali Acc: 0.915 Test Loss: 0.475 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 18 cost time: 0.6410913467407227
Epoch: 18, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.436 Vali Acc: 0.919 Test Loss: 0.436 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 19 cost time: 0.5469009876251221
Epoch: 19, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.404 Vali Acc: 0.919 Test Loss: 0.404 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 20 cost time: 0.5420763492584229
Epoch: 20, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.376 Vali Acc: 0.922 Test Loss: 0.376 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 21 cost time: 0.5640177726745605
Epoch: 21, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.350 Vali Acc: 0.915 Test Loss: 0.350 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6141374111175537
Epoch: 22, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.327 Vali Acc: 0.919 Test Loss: 0.327 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6104679107666016
Epoch: 23, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925923).  Saving model ...
Epoch: 24 cost time: 0.6800229549407959
Epoch: 24, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.286 Vali Acc: 0.933 Test Loss: 0.286 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933330).  Saving model ...
Epoch: 25 cost time: 0.628666877746582
Epoch: 25, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 26 cost time: 0.6954522132873535
Epoch: 26, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.817194938659668
Epoch: 27, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.734727144241333
Epoch: 28, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6346461772918701
Epoch: 29, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7042322158813477
Epoch: 30, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6158108711242676
Epoch: 31, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6780972480773926
Epoch: 32, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6439142227172852
Epoch: 33, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7255356311798096
Epoch: 34, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6723997592926025
Epoch: 35, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.207 Vali Acc: 0.926 Test Loss: 0.207 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 50406
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.447985887527466
Epoch: 1, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.643 Vali Acc: 0.248 Test Loss: 1.643 Test Acc: 0.248
Validation loss decreased (inf --> -0.248132).  Saving model ...
Epoch: 2 cost time: 0.67569899559021
Epoch: 2, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.591 Vali Acc: 0.274 Test Loss: 1.591 Test Acc: 0.274
Validation loss decreased (-0.248132 --> -0.274058).  Saving model ...
Epoch: 3 cost time: 0.6197419166564941
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.546 Vali Acc: 0.307 Test Loss: 1.546 Test Acc: 0.307
Validation loss decreased (-0.274058 --> -0.307392).  Saving model ...
Epoch: 4 cost time: 0.6287322044372559
Epoch: 4, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.497 Vali Acc: 0.348 Test Loss: 1.497 Test Acc: 0.348
Validation loss decreased (-0.307392 --> -0.348133).  Saving model ...
Epoch: 5 cost time: 0.5639145374298096
Epoch: 5, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.436 Vali Acc: 0.430 Test Loss: 1.436 Test Acc: 0.430
Validation loss decreased (-0.348133 --> -0.429615).  Saving model ...
Epoch: 6 cost time: 0.6933293342590332
Epoch: 6, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.365 Vali Acc: 0.515 Test Loss: 1.365 Test Acc: 0.515
Validation loss decreased (-0.429615 --> -0.514801).  Saving model ...
Epoch: 7 cost time: 0.658977746963501
Epoch: 7, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.288 Vali Acc: 0.596 Test Loss: 1.288 Test Acc: 0.596
Validation loss decreased (-0.514801 --> -0.596283).  Saving model ...
Epoch: 8 cost time: 0.7067501544952393
Epoch: 8, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.207 Vali Acc: 0.648 Test Loss: 1.207 Test Acc: 0.648
Validation loss decreased (-0.596283 --> -0.648136).  Saving model ...
Epoch: 9 cost time: 0.6211514472961426
Epoch: 9, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.125 Vali Acc: 0.711 Test Loss: 1.125 Test Acc: 0.711
Validation loss decreased (-0.648136 --> -0.711100).  Saving model ...
Epoch: 10 cost time: 0.5897600650787354
Epoch: 10, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.044 Vali Acc: 0.737 Test Loss: 1.044 Test Acc: 0.737
Validation loss decreased (-0.711100 --> -0.737027).  Saving model ...
Epoch: 11 cost time: 0.6763184070587158
Epoch: 11, Steps: 2 | Train Loss: 0.989 Vali Loss: 0.967 Vali Acc: 0.778 Test Loss: 0.967 Test Acc: 0.778
Validation loss decreased (-0.737027 --> -0.777768).  Saving model ...
Epoch: 12 cost time: 0.5465567111968994
Epoch: 12, Steps: 2 | Train Loss: 0.958 Vali Loss: 0.894 Vali Acc: 0.800 Test Loss: 0.894 Test Acc: 0.800
Validation loss decreased (-0.777768 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.6527457237243652
Epoch: 13, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.823 Vali Acc: 0.830 Test Loss: 0.823 Test Acc: 0.830
Validation loss decreased (-0.799991 --> -0.829621).  Saving model ...
Epoch: 14 cost time: 0.5951638221740723
Epoch: 14, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.757 Vali Acc: 0.841 Test Loss: 0.757 Test Acc: 0.841
Validation loss decreased (-0.829621 --> -0.840733).  Saving model ...
Epoch: 15 cost time: 0.61380934715271
Epoch: 15, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.697 Vali Acc: 0.870 Test Loss: 0.697 Test Acc: 0.870
Validation loss decreased (-0.840733 --> -0.870363).  Saving model ...
Epoch: 16 cost time: 0.6852672100067139
Epoch: 16, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.642 Vali Acc: 0.878 Test Loss: 0.642 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 17 cost time: 0.659651517868042
Epoch: 17, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.591 Vali Acc: 0.896 Test Loss: 0.591 Test Acc: 0.896
Validation loss decreased (-0.877771 --> -0.896290).  Saving model ...
Epoch: 18 cost time: 0.8002924919128418
Epoch: 18, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.546 Vali Acc: 0.904 Test Loss: 0.546 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 19 cost time: 0.7089459896087646
Epoch: 19, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.504 Vali Acc: 0.904 Test Loss: 0.504 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903699).  Saving model ...
Epoch: 20 cost time: 0.627967119216919
Epoch: 20, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.465 Vali Acc: 0.907 Test Loss: 0.465 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 21 cost time: 0.6098947525024414
Epoch: 21, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.431 Vali Acc: 0.922 Test Loss: 0.431 Test Acc: 0.922
Validation loss decreased (-0.907403 --> -0.922218).  Saving model ...
Epoch: 22 cost time: 0.6063859462738037
Epoch: 22, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.402 Vali Acc: 0.922 Test Loss: 0.402 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 23 cost time: 0.7629587650299072
Epoch: 23, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.377 Vali Acc: 0.919 Test Loss: 0.377 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6275596618652344
Epoch: 24, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.353 Vali Acc: 0.919 Test Loss: 0.353 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6798441410064697
Epoch: 25, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.331 Vali Acc: 0.926 Test Loss: 0.331 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925923).  Saving model ...
Epoch: 26 cost time: 0.632561445236206
Epoch: 26, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6056513786315918
Epoch: 27, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6831514835357666
Epoch: 28, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 29 cost time: 0.7172620296478271
Epoch: 29, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.58056640625
Epoch: 30, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.679314136505127
Epoch: 31, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.5825381278991699
Epoch: 32, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.5988736152648926
Epoch: 33, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.6503167152404785
Epoch: 34, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.6303761005401611
Epoch: 35, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.6377310752868652
Epoch: 36, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 37 cost time: 0.6783392429351807
Epoch: 37, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 38 cost time: 0.5961463451385498
Epoch: 38, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 39 cost time: 0.5314438343048096
Epoch: 39, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.677375078201294
Epoch: 40, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5975356101989746
Epoch: 41, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.63466477394104
Epoch: 42, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5798792839050293
Epoch: 43, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.63739013671875
Epoch: 44, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6014144420623779
Epoch: 45, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5546200275421143
Epoch: 46, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5741136074066162
Epoch: 47, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 48 cost time: 0.5349535942077637
Epoch: 48, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.8067142963409424
Epoch: 49, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.5167746543884277
Epoch: 50, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 0.5558962821960449
Epoch: 51, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 0.6909072399139404
Epoch: 52, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 0.6527378559112549
Epoch: 53, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 0.5971696376800537
Epoch: 54, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 0.6076931953430176
Epoch: 55, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 0.6772410869598389
Epoch: 56, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6394996643066406
Epoch: 57, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.742213249206543
Epoch: 58, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6492495536804199
Epoch: 59, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.644320011138916
Epoch: 60, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7009356021881104
Epoch: 61, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.6287813186645508
Epoch: 62, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.7076108455657959
Epoch: 63, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.6886966228485107
Epoch: 64, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.930 Test Loss: 0.178 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.675283670425415
Epoch: 65, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 42758
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.422269821166992
Epoch: 1, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.939 Vali Acc: 0.096 Test Loss: 1.939 Test Acc: 0.096
Validation loss decreased (inf --> -0.096277).  Saving model ...
Epoch: 2 cost time: 0.5875148773193359
Epoch: 2, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.879 Vali Acc: 0.111 Test Loss: 1.879 Test Acc: 0.111
Validation loss decreased (-0.096277 --> -0.111092).  Saving model ...
Epoch: 3 cost time: 0.5179026126861572
Epoch: 3, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.828 Vali Acc: 0.126 Test Loss: 1.828 Test Acc: 0.126
Validation loss decreased (-0.111092 --> -0.125908).  Saving model ...
Epoch: 4 cost time: 0.4963970184326172
Epoch: 4, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.778 Vali Acc: 0.174 Test Loss: 1.778 Test Acc: 0.174
Validation loss decreased (-0.125908 --> -0.174056).  Saving model ...
Epoch: 5 cost time: 0.5588245391845703
Epoch: 5, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.718 Vali Acc: 0.259 Test Loss: 1.718 Test Acc: 0.259
Validation loss decreased (-0.174056 --> -0.259242).  Saving model ...
Epoch: 6 cost time: 0.6746518611907959
Epoch: 6, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.650 Vali Acc: 0.319 Test Loss: 1.650 Test Acc: 0.319
Validation loss decreased (-0.259242 --> -0.318502).  Saving model ...
Epoch: 7 cost time: 0.5407936573028564
Epoch: 7, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.576 Vali Acc: 0.370 Test Loss: 1.576 Test Acc: 0.370
Validation loss decreased (-0.318502 --> -0.370355).  Saving model ...
Epoch: 8 cost time: 0.6356136798858643
Epoch: 8, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.499 Vali Acc: 0.426 Test Loss: 1.499 Test Acc: 0.426
Validation loss decreased (-0.370355 --> -0.425911).  Saving model ...
Epoch: 9 cost time: 0.4885292053222656
Epoch: 9, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.418 Vali Acc: 0.511 Test Loss: 1.418 Test Acc: 0.511
Validation loss decreased (-0.425911 --> -0.511097).  Saving model ...
Epoch: 10 cost time: 0.5478880405426025
Epoch: 10, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.336 Vali Acc: 0.593 Test Loss: 1.336 Test Acc: 0.593
Validation loss decreased (-0.511097 --> -0.592579).  Saving model ...
Epoch: 11 cost time: 0.6424276828765869
Epoch: 11, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.254 Vali Acc: 0.693 Test Loss: 1.254 Test Acc: 0.693
Validation loss decreased (-0.592579 --> -0.692580).  Saving model ...
Epoch: 12 cost time: 0.5731801986694336
Epoch: 12, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.172 Vali Acc: 0.741 Test Loss: 1.172 Test Acc: 0.741
Validation loss decreased (-0.692580 --> -0.740729).  Saving model ...
Epoch: 13 cost time: 0.5535857677459717
Epoch: 13, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.092 Vali Acc: 0.767 Test Loss: 1.092 Test Acc: 0.767
Validation loss decreased (-0.740729 --> -0.766656).  Saving model ...
Epoch: 14 cost time: 0.6442821025848389
Epoch: 14, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.016 Vali Acc: 0.785 Test Loss: 1.016 Test Acc: 0.785
Validation loss decreased (-0.766656 --> -0.785175).  Saving model ...
Epoch: 15 cost time: 0.6534450054168701
Epoch: 15, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.945 Vali Acc: 0.807 Test Loss: 0.945 Test Acc: 0.807
Validation loss decreased (-0.785175 --> -0.807398).  Saving model ...
Epoch: 16 cost time: 0.5777113437652588
Epoch: 16, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.877 Vali Acc: 0.811 Test Loss: 0.877 Test Acc: 0.811
Validation loss decreased (-0.807398 --> -0.811102).  Saving model ...
Epoch: 17 cost time: 0.601642370223999
Epoch: 17, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.814 Vali Acc: 0.841 Test Loss: 0.814 Test Acc: 0.841
Validation loss decreased (-0.811102 --> -0.840733).  Saving model ...
Epoch: 18 cost time: 0.6583292484283447
Epoch: 18, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.755 Vali Acc: 0.852 Test Loss: 0.755 Test Acc: 0.852
Validation loss decreased (-0.840733 --> -0.851844).  Saving model ...
Epoch: 19 cost time: 0.6857240200042725
Epoch: 19, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.700 Vali Acc: 0.870 Test Loss: 0.700 Test Acc: 0.870
Validation loss decreased (-0.851844 --> -0.870363).  Saving model ...
Epoch: 20 cost time: 0.6667788028717041
Epoch: 20, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.651 Vali Acc: 0.885 Test Loss: 0.651 Test Acc: 0.885
Validation loss decreased (-0.870363 --> -0.885179).  Saving model ...
Epoch: 21 cost time: 0.6528546810150146
Epoch: 21, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.606 Vali Acc: 0.896 Test Loss: 0.606 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896290).  Saving model ...
Epoch: 22 cost time: 0.5905742645263672
Epoch: 22, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.564 Vali Acc: 0.907 Test Loss: 0.564 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907402).  Saving model ...
Epoch: 23 cost time: 0.6102919578552246
Epoch: 23, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.527 Vali Acc: 0.907 Test Loss: 0.527 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 24 cost time: 0.6710021495819092
Epoch: 24, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.495 Vali Acc: 0.907 Test Loss: 0.495 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 25 cost time: 0.685737133026123
Epoch: 25, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.463 Vali Acc: 0.915 Test Loss: 0.463 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 26 cost time: 0.6660468578338623
Epoch: 26, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.434 Vali Acc: 0.919 Test Loss: 0.434 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 27 cost time: 0.6760306358337402
Epoch: 27, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.409 Vali Acc: 0.926 Test Loss: 0.409 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 28 cost time: 0.6535356044769287
Epoch: 28, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.385 Vali Acc: 0.926 Test Loss: 0.385 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 29 cost time: 0.7254030704498291
Epoch: 29, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.364 Vali Acc: 0.926 Test Loss: 0.364 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 0.6523618698120117
Epoch: 30, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.345 Vali Acc: 0.926 Test Loss: 0.345 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 31 cost time: 0.7609422206878662
Epoch: 31, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 32 cost time: 0.5755002498626709
Epoch: 32, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 33 cost time: 0.6801974773406982
Epoch: 33, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.6102337837219238
Epoch: 34, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 35 cost time: 0.6826937198638916
Epoch: 35, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5911059379577637
Epoch: 36, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6927657127380371
Epoch: 37, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.270 Vali Acc: 0.926 Test Loss: 0.270 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6225659847259521
Epoch: 38, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6618294715881348
Epoch: 39, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.664201021194458
Epoch: 40, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.7091519832611084
Epoch: 41, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 42 cost time: 0.7024021148681641
Epoch: 42, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.6706583499908447
Epoch: 43, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 44 cost time: 0.781524658203125
Epoch: 44, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 45 cost time: 0.694364070892334
Epoch: 45, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 46 cost time: 0.721998929977417
Epoch: 46, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 47 cost time: 0.5431101322174072
Epoch: 47, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 48 cost time: 0.5312907695770264
Epoch: 48, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 49 cost time: 0.6185600757598877
Epoch: 49, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 50 cost time: 0.5097272396087646
Epoch: 50, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 51 cost time: 0.6667828559875488
Epoch: 51, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 52 cost time: 0.6916182041168213
Epoch: 52, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 53 cost time: 0.6822402477264404
Epoch: 53, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 54 cost time: 0.5807523727416992
Epoch: 54, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 55 cost time: 0.559154748916626
Epoch: 55, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 56 cost time: 0.5873632431030273
Epoch: 56, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 57 cost time: 0.6158361434936523
Epoch: 57, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 58 cost time: 0.6946516036987305
Epoch: 58, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 0.5225446224212646
Epoch: 59, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 60 cost time: 0.6111254692077637
Epoch: 60, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 61 cost time: 0.5317943096160889
Epoch: 61, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 62 cost time: 0.6174867153167725
Epoch: 62, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 63 cost time: 0.6375463008880615
Epoch: 63, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 64 cost time: 0.7855582237243652
Epoch: 64, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 65 cost time: 0.6165213584899902
Epoch: 65, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.6705083847045898
Epoch: 66, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.689445972442627
Epoch: 67, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 68 cost time: 0.7652745246887207
Epoch: 68, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.6518986225128174
Epoch: 69, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 70 cost time: 0.6301145553588867
Epoch: 70, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 71 cost time: 0.5729842185974121
Epoch: 71, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 72 cost time: 0.6066935062408447
Epoch: 72, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 73 cost time: 0.71938157081604
Epoch: 73, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 74 cost time: 0.6562497615814209
Epoch: 74, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 75 cost time: 0.6145505905151367
Epoch: 75, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 76 cost time: 0.6448781490325928
Epoch: 76, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 77 cost time: 0.5989344120025635
Epoch: 77, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 78 cost time: 0.6606786251068115
Epoch: 78, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 79 cost time: 0.6212177276611328
Epoch: 79, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 80 cost time: 0.6557245254516602
Epoch: 80, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 81 cost time: 0.6112837791442871
Epoch: 81, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 82 cost time: 0.6050047874450684
Epoch: 82, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 83 cost time: 0.6612691879272461
Epoch: 83, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 84 cost time: 0.8090550899505615
Epoch: 84, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 85 cost time: 0.608623743057251
Epoch: 85, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 86 cost time: 0.6063971519470215
Epoch: 86, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 87 cost time: 0.6932065486907959
Epoch: 87, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 88 cost time: 0.6044647693634033
Epoch: 88, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 89 cost time: 0.6608915328979492
Epoch: 89, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.6221742630004883
Epoch: 90, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 91 cost time: 0.6385736465454102
Epoch: 91, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 92 cost time: 0.6253416538238525
Epoch: 92, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 93 cost time: 0.5061709880828857
Epoch: 93, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 94 cost time: 0.5007326602935791
Epoch: 94, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 95 cost time: 0.5504615306854248
Epoch: 95, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 96 cost time: 0.5066118240356445
Epoch: 96, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 97 cost time: 0.47814154624938965
Epoch: 97, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 98 cost time: 0.5365216732025146
Epoch: 98, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 99 cost time: 0.5360918045043945
Epoch: 99, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 100 cost time: 0.6585886478424072
Epoch: 100, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 38214
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3732895851135254
Epoch: 1, Steps: 2 | Train Loss: 2.089 Vali Loss: 1.996 Vali Acc: 0.107 Test Loss: 1.996 Test Acc: 0.107
Validation loss decreased (inf --> -0.107387).  Saving model ...
Epoch: 2 cost time: 0.6251108646392822
Epoch: 2, Steps: 2 | Train Loss: 2.215 Vali Loss: 1.964 Vali Acc: 0.130 Test Loss: 1.964 Test Acc: 0.130
Validation loss decreased (-0.107387 --> -0.129610).  Saving model ...
Epoch: 3 cost time: 0.5915696620941162
Epoch: 3, Steps: 2 | Train Loss: 2.110 Vali Loss: 1.939 Vali Acc: 0.152 Test Loss: 1.939 Test Acc: 0.152
Validation loss decreased (-0.129610 --> -0.151832).  Saving model ...
Epoch: 4 cost time: 0.671196699142456
Epoch: 4, Steps: 2 | Train Loss: 1.973 Vali Loss: 1.913 Vali Acc: 0.156 Test Loss: 1.913 Test Acc: 0.156
Validation loss decreased (-0.151832 --> -0.155536).  Saving model ...
Epoch: 5 cost time: 0.6190495491027832
Epoch: 5, Steps: 2 | Train Loss: 2.035 Vali Loss: 1.875 Vali Acc: 0.185 Test Loss: 1.875 Test Acc: 0.185
Validation loss decreased (-0.155536 --> -0.185166).  Saving model ...
Epoch: 6 cost time: 0.6314728260040283
Epoch: 6, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.828 Vali Acc: 0.256 Test Loss: 1.828 Test Acc: 0.256
Validation loss decreased (-0.185166 --> -0.255537).  Saving model ...
Epoch: 7 cost time: 0.5832297801971436
Epoch: 7, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.772 Vali Acc: 0.337 Test Loss: 1.772 Test Acc: 0.337
Validation loss decreased (-0.255537 --> -0.337019).  Saving model ...
Epoch: 8 cost time: 0.6043374538421631
Epoch: 8, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.709 Vali Acc: 0.381 Test Loss: 1.709 Test Acc: 0.381
Validation loss decreased (-0.337019 --> -0.381464).  Saving model ...
Epoch: 9 cost time: 0.6677374839782715
Epoch: 9, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.642 Vali Acc: 0.415 Test Loss: 1.642 Test Acc: 0.415
Validation loss decreased (-0.381464 --> -0.414798).  Saving model ...
Epoch: 10 cost time: 0.6150567531585693
Epoch: 10, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.571 Vali Acc: 0.456 Test Loss: 1.571 Test Acc: 0.456
Validation loss decreased (-0.414798 --> -0.455540).  Saving model ...
Epoch: 11 cost time: 0.716198205947876
Epoch: 11, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.497 Vali Acc: 0.493 Test Loss: 1.497 Test Acc: 0.493
Validation loss decreased (-0.455540 --> -0.492578).  Saving model ...
Epoch: 12 cost time: 0.5896492004394531
Epoch: 12, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.421 Vali Acc: 0.507 Test Loss: 1.421 Test Acc: 0.507
Validation loss decreased (-0.492578 --> -0.507393).  Saving model ...
Epoch: 13 cost time: 0.5505108833312988
Epoch: 13, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.345 Vali Acc: 0.533 Test Loss: 1.345 Test Acc: 0.533
Validation loss decreased (-0.507393 --> -0.533320).  Saving model ...
Epoch: 14 cost time: 0.7111849784851074
Epoch: 14, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.268 Vali Acc: 0.570 Test Loss: 1.268 Test Acc: 0.570
Validation loss decreased (-0.533320 --> -0.570358).  Saving model ...
Epoch: 15 cost time: 0.5104274749755859
Epoch: 15, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.193 Vali Acc: 0.615 Test Loss: 1.193 Test Acc: 0.615
Validation loss decreased (-0.570358 --> -0.614803).  Saving model ...
Epoch: 16 cost time: 0.5827386379241943
Epoch: 16, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.120 Vali Acc: 0.678 Test Loss: 1.120 Test Acc: 0.678
Validation loss decreased (-0.614803 --> -0.677767).  Saving model ...
Epoch: 17 cost time: 0.5061719417572021
Epoch: 17, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.050 Vali Acc: 0.741 Test Loss: 1.050 Test Acc: 0.741
Validation loss decreased (-0.677767 --> -0.740730).  Saving model ...
Epoch: 18 cost time: 0.6586799621582031
Epoch: 18, Steps: 2 | Train Loss: 1.042 Vali Loss: 0.983 Vali Acc: 0.774 Test Loss: 0.983 Test Acc: 0.774
Validation loss decreased (-0.740730 --> -0.774064).  Saving model ...
Epoch: 19 cost time: 0.5883691310882568
Epoch: 19, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.919 Vali Acc: 0.800 Test Loss: 0.919 Test Acc: 0.800
Validation loss decreased (-0.774064 --> -0.799991).  Saving model ...
Epoch: 20 cost time: 0.6514022350311279
Epoch: 20, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.859 Vali Acc: 0.833 Test Loss: 0.859 Test Acc: 0.833
Validation loss decreased (-0.799991 --> -0.833325).  Saving model ...
Epoch: 21 cost time: 0.5443978309631348
Epoch: 21, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.803 Vali Acc: 0.837 Test Loss: 0.803 Test Acc: 0.837
Validation loss decreased (-0.833325 --> -0.837029).  Saving model ...
Epoch: 22 cost time: 0.5760459899902344
Epoch: 22, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.751 Vali Acc: 0.852 Test Loss: 0.751 Test Acc: 0.852
Validation loss decreased (-0.837029 --> -0.851844).  Saving model ...
Epoch: 23 cost time: 0.5755481719970703
Epoch: 23, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.703 Vali Acc: 0.867 Test Loss: 0.703 Test Acc: 0.867
Validation loss decreased (-0.851844 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 0.6853945255279541
Epoch: 24, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.657 Vali Acc: 0.878 Test Loss: 0.657 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 25 cost time: 0.6481363773345947
Epoch: 25, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.615 Vali Acc: 0.885 Test Loss: 0.615 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885179).  Saving model ...
Epoch: 26 cost time: 0.5111086368560791
Epoch: 26, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.577 Vali Acc: 0.889 Test Loss: 0.577 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 27 cost time: 0.4941062927246094
Epoch: 27, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.540 Vali Acc: 0.893 Test Loss: 0.540 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 28 cost time: 0.5510380268096924
Epoch: 28, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.506 Vali Acc: 0.896 Test Loss: 0.506 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 29 cost time: 0.6257684230804443
Epoch: 29, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.474 Vali Acc: 0.911 Test Loss: 0.474 Test Acc: 0.911
Validation loss decreased (-0.896291 --> -0.911106).  Saving model ...
Epoch: 30 cost time: 0.5347537994384766
Epoch: 30, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.447 Vali Acc: 0.919 Test Loss: 0.447 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 31 cost time: 0.519812822341919
Epoch: 31, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.421 Vali Acc: 0.922 Test Loss: 0.421 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 32 cost time: 0.6018574237823486
Epoch: 32, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.399 Vali Acc: 0.926 Test Loss: 0.399 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 33 cost time: 0.6358296871185303
Epoch: 33, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.379 Vali Acc: 0.926 Test Loss: 0.379 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 34 cost time: 0.6319832801818848
Epoch: 34, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.362 Vali Acc: 0.930 Test Loss: 0.362 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 35 cost time: 0.6382758617401123
Epoch: 35, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.345 Vali Acc: 0.933 Test Loss: 0.345 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 36 cost time: 0.6424753665924072
Epoch: 36, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.331 Vali Acc: 0.933 Test Loss: 0.331 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 0.6381254196166992
Epoch: 37, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.319 Vali Acc: 0.933 Test Loss: 0.319 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 38 cost time: 0.6274502277374268
Epoch: 38, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.307 Vali Acc: 0.937 Test Loss: 0.307 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 39 cost time: 0.5789268016815186
Epoch: 39, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.297 Vali Acc: 0.937 Test Loss: 0.297 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 0.5678625106811523
Epoch: 40, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.5638997554779053
Epoch: 41, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 42 cost time: 0.6304488182067871
Epoch: 42, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7903311252593994
Epoch: 43, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.266 Vali Acc: 0.941 Test Loss: 0.266 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.5939731597900391
Epoch: 44, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6421730518341064
Epoch: 45, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6809475421905518
Epoch: 46, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.572272777557373
Epoch: 47, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7533466815948486
Epoch: 48, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.581589937210083
Epoch: 49, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6250319480895996
Epoch: 50, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5327353477478027
Epoch: 51, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.6756422519683838
Epoch: 52, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.6710445880889893
Epoch: 53, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 36006
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.416804075241089
Epoch: 1, Steps: 2 | Train Loss: 2.014 Vali Loss: 1.946 Vali Acc: 0.107 Test Loss: 1.946 Test Acc: 0.107
Validation loss decreased (inf --> -0.107388).  Saving model ...
Epoch: 2 cost time: 0.6258642673492432
Epoch: 2, Steps: 2 | Train Loss: 2.004 Vali Loss: 1.915 Vali Acc: 0.130 Test Loss: 1.915 Test Acc: 0.130
Validation loss decreased (-0.107388 --> -0.129610).  Saving model ...
Epoch: 3 cost time: 0.5901052951812744
Epoch: 3, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.893 Vali Acc: 0.126 Test Loss: 1.893 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6203324794769287
Epoch: 4, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.874 Vali Acc: 0.156 Test Loss: 1.874 Test Acc: 0.156
Validation loss decreased (-0.129610 --> -0.155537).  Saving model ...
Epoch: 5 cost time: 0.5971555709838867
Epoch: 5, Steps: 2 | Train Loss: 2.008 Vali Loss: 1.849 Vali Acc: 0.211 Test Loss: 1.849 Test Acc: 0.211
Validation loss decreased (-0.155537 --> -0.211093).  Saving model ...
Epoch: 6 cost time: 0.7751791477203369
Epoch: 6, Steps: 2 | Train Loss: 1.936 Vali Loss: 1.820 Vali Acc: 0.237 Test Loss: 1.820 Test Acc: 0.237
Validation loss decreased (-0.211093 --> -0.237019).  Saving model ...
Epoch: 7 cost time: 0.6177091598510742
Epoch: 7, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.786 Vali Acc: 0.267 Test Loss: 1.786 Test Acc: 0.267
Validation loss decreased (-0.237019 --> -0.266649).  Saving model ...
Epoch: 8 cost time: 0.5205566883087158
Epoch: 8, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.747 Vali Acc: 0.296 Test Loss: 1.747 Test Acc: 0.296
Validation loss decreased (-0.266649 --> -0.296279).  Saving model ...
Epoch: 9 cost time: 0.6254026889801025
Epoch: 9, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.706 Vali Acc: 0.311 Test Loss: 1.706 Test Acc: 0.311
Validation loss decreased (-0.296279 --> -0.311094).  Saving model ...
Epoch: 10 cost time: 0.714728593826294
Epoch: 10, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.661 Vali Acc: 0.330 Test Loss: 1.661 Test Acc: 0.330
Validation loss decreased (-0.311094 --> -0.329613).  Saving model ...
Epoch: 11 cost time: 0.5936291217803955
Epoch: 11, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.614 Vali Acc: 0.352 Test Loss: 1.614 Test Acc: 0.352
Validation loss decreased (-0.329613 --> -0.351836).  Saving model ...
Epoch: 12 cost time: 0.6946091651916504
Epoch: 12, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.566 Vali Acc: 0.393 Test Loss: 1.566 Test Acc: 0.393
Validation loss decreased (-0.351836 --> -0.392577).  Saving model ...
Epoch: 13 cost time: 0.6884956359863281
Epoch: 13, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.516 Vali Acc: 0.430 Test Loss: 1.516 Test Acc: 0.430
Validation loss decreased (-0.392577 --> -0.429614).  Saving model ...
Epoch: 14 cost time: 0.6172842979431152
Epoch: 14, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.465 Vali Acc: 0.456 Test Loss: 1.465 Test Acc: 0.456
Validation loss decreased (-0.429614 --> -0.455541).  Saving model ...
Epoch: 15 cost time: 0.6064426898956299
Epoch: 15, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.414 Vali Acc: 0.452 Test Loss: 1.414 Test Acc: 0.452
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6042218208312988
Epoch: 16, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.362 Vali Acc: 0.496 Test Loss: 1.362 Test Acc: 0.496
Validation loss decreased (-0.455541 --> -0.496283).  Saving model ...
Epoch: 17 cost time: 0.6294100284576416
Epoch: 17, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.310 Vali Acc: 0.533 Test Loss: 1.310 Test Acc: 0.533
Validation loss decreased (-0.496283 --> -0.533320).  Saving model ...
Epoch: 18 cost time: 0.5947017669677734
Epoch: 18, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.259 Vali Acc: 0.563 Test Loss: 1.259 Test Acc: 0.563
Validation loss decreased (-0.533320 --> -0.562950).  Saving model ...
Epoch: 19 cost time: 0.6461870670318604
Epoch: 19, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.209 Vali Acc: 0.596 Test Loss: 1.209 Test Acc: 0.596
Validation loss decreased (-0.562950 --> -0.596284).  Saving model ...
Epoch: 20 cost time: 0.671910285949707
Epoch: 20, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.159 Vali Acc: 0.619 Test Loss: 1.159 Test Acc: 0.619
Validation loss decreased (-0.596284 --> -0.618507).  Saving model ...
Epoch: 21 cost time: 0.6465940475463867
Epoch: 21, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.111 Vali Acc: 0.659 Test Loss: 1.111 Test Acc: 0.659
Validation loss decreased (-0.618507 --> -0.659248).  Saving model ...
Epoch: 22 cost time: 0.7069628238677979
Epoch: 22, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.063 Vali Acc: 0.681 Test Loss: 1.063 Test Acc: 0.681
Validation loss decreased (-0.659248 --> -0.681471).  Saving model ...
Epoch: 23 cost time: 0.6781647205352783
Epoch: 23, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
Validation loss decreased (-0.681471 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 0.6416294574737549
Epoch: 24, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.970 Vali Acc: 0.733 Test Loss: 0.970 Test Acc: 0.733
Validation loss decreased (-0.699990 --> -0.733324).  Saving model ...
Epoch: 25 cost time: 0.7033617496490479
Epoch: 25, Steps: 2 | Train Loss: 0.915 Vali Loss: 0.925 Vali Acc: 0.763 Test Loss: 0.925 Test Acc: 0.763
Validation loss decreased (-0.733324 --> -0.762954).  Saving model ...
Epoch: 26 cost time: 0.6242368221282959
Epoch: 26, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.881 Vali Acc: 0.796 Test Loss: 0.881 Test Acc: 0.796
Validation loss decreased (-0.762954 --> -0.796287).  Saving model ...
Epoch: 27 cost time: 0.5870563983917236
Epoch: 27, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.839 Vali Acc: 0.800 Test Loss: 0.839 Test Acc: 0.800
Validation loss decreased (-0.796287 --> -0.799992).  Saving model ...
Epoch: 28 cost time: 0.9198811054229736
Epoch: 28, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.799 Vali Acc: 0.811 Test Loss: 0.799 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811103).  Saving model ...
Epoch: 29 cost time: 0.6504192352294922
Epoch: 29, Steps: 2 | Train Loss: 0.726 Vali Loss: 0.761 Vali Acc: 0.819 Test Loss: 0.761 Test Acc: 0.819
Validation loss decreased (-0.811103 --> -0.818511).  Saving model ...
Epoch: 30 cost time: 0.7430460453033447
Epoch: 30, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.725 Vali Acc: 0.826 Test Loss: 0.725 Test Acc: 0.826
Validation loss decreased (-0.818511 --> -0.825919).  Saving model ...
Epoch: 31 cost time: 0.7224268913269043
Epoch: 31, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.692 Vali Acc: 0.833 Test Loss: 0.692 Test Acc: 0.833
Validation loss decreased (-0.825919 --> -0.833326).  Saving model ...
Epoch: 32 cost time: 0.6518247127532959
Epoch: 32, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 33 cost time: 0.6256077289581299
Epoch: 33, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.630 Vali Acc: 0.852 Test Loss: 0.630 Test Acc: 0.852
Validation loss decreased (-0.833327 --> -0.851846).  Saving model ...
Epoch: 34 cost time: 0.7347970008850098
Epoch: 34, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
Validation loss decreased (-0.851846 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 0.6380636692047119
Epoch: 35, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.574 Vali Acc: 0.874 Test Loss: 0.574 Test Acc: 0.874
Validation loss decreased (-0.866661 --> -0.874068).  Saving model ...
Epoch: 36 cost time: 0.5892124176025391
Epoch: 36, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.549 Vali Acc: 0.881 Test Loss: 0.549 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 37 cost time: 0.6836621761322021
Epoch: 37, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 38 cost time: 0.6189849376678467
Epoch: 38, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.502 Vali Acc: 0.896 Test Loss: 0.502 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896291).  Saving model ...
Epoch: 39 cost time: 0.6790053844451904
Epoch: 39, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.482 Vali Acc: 0.904 Test Loss: 0.482 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 40 cost time: 0.6758823394775391
Epoch: 40, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.463 Vali Acc: 0.911 Test Loss: 0.463 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911106).  Saving model ...
Epoch: 41 cost time: 0.7287638187408447
Epoch: 41, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.445 Vali Acc: 0.915 Test Loss: 0.445 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 42 cost time: 0.6701180934906006
Epoch: 42, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.428 Vali Acc: 0.919 Test Loss: 0.428 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 43 cost time: 0.6965203285217285
Epoch: 43, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.413 Vali Acc: 0.919 Test Loss: 0.413 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 44 cost time: 0.6397671699523926
Epoch: 44, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.400 Vali Acc: 0.919 Test Loss: 0.400 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 45 cost time: 0.6762886047363281
Epoch: 45, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.388 Vali Acc: 0.915 Test Loss: 0.388 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.692305326461792
Epoch: 46, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.378 Vali Acc: 0.911 Test Loss: 0.378 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7050235271453857
Epoch: 47, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.368 Vali Acc: 0.911 Test Loss: 0.368 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5649909973144531
Epoch: 48, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6365134716033936
Epoch: 49, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.352 Vali Acc: 0.907 Test Loss: 0.352 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5431735515594482
Epoch: 50, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.344 Vali Acc: 0.911 Test Loss: 0.344 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5626327991485596
Epoch: 51, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.337 Vali Acc: 0.911 Test Loss: 0.337 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6644160747528076
Epoch: 52, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.332 Vali Acc: 0.911 Test Loss: 0.332 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.5359899997711182
Epoch: 53, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.325 Vali Acc: 0.915 Test Loss: 0.325 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5901741981506348
Epoch: 54, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 33030
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.325737953186035
Epoch: 1, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.745 Vali Acc: 0.211 Test Loss: 1.745 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 0.5240654945373535
Epoch: 2, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.708 Vali Acc: 0.252 Test Loss: 1.708 Test Acc: 0.252
Validation loss decreased (-0.211094 --> -0.251835).  Saving model ...
Epoch: 3 cost time: 0.5715622901916504
Epoch: 3, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.681 Vali Acc: 0.289 Test Loss: 1.681 Test Acc: 0.289
Validation loss decreased (-0.251835 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.5720193386077881
Epoch: 4, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.658 Vali Acc: 0.344 Test Loss: 1.658 Test Acc: 0.344
Validation loss decreased (-0.288872 --> -0.344428).  Saving model ...
Epoch: 5 cost time: 0.4798564910888672
Epoch: 5, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.631 Vali Acc: 0.374 Test Loss: 1.631 Test Acc: 0.374
Validation loss decreased (-0.344428 --> -0.374058).  Saving model ...
Epoch: 6 cost time: 0.5194602012634277
Epoch: 6, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.600 Vali Acc: 0.396 Test Loss: 1.600 Test Acc: 0.396
Validation loss decreased (-0.374058 --> -0.396280).  Saving model ...
Epoch: 7 cost time: 0.6011450290679932
Epoch: 7, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.566 Vali Acc: 0.404 Test Loss: 1.566 Test Acc: 0.404
Validation loss decreased (-0.396280 --> -0.403688).  Saving model ...
Epoch: 8 cost time: 0.6116025447845459
Epoch: 8, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.529 Vali Acc: 0.422 Test Loss: 1.529 Test Acc: 0.422
Validation loss decreased (-0.403688 --> -0.422207).  Saving model ...
Epoch: 9 cost time: 0.5874958038330078
Epoch: 9, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.488 Vali Acc: 0.448 Test Loss: 1.488 Test Acc: 0.448
Validation loss decreased (-0.422207 --> -0.448133).  Saving model ...
Epoch: 10 cost time: 0.5519442558288574
Epoch: 10, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.446 Vali Acc: 0.478 Test Loss: 1.446 Test Acc: 0.478
Validation loss decreased (-0.448133 --> -0.477763).  Saving model ...
Epoch: 11 cost time: 0.589076042175293
Epoch: 11, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.401 Vali Acc: 0.548 Test Loss: 1.401 Test Acc: 0.548
Validation loss decreased (-0.477763 --> -0.548134).  Saving model ...
Epoch: 12 cost time: 0.5233135223388672
Epoch: 12, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.354 Vali Acc: 0.596 Test Loss: 1.354 Test Acc: 0.596
Validation loss decreased (-0.548134 --> -0.596283).  Saving model ...
Epoch: 13 cost time: 0.5723884105682373
Epoch: 13, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.307 Vali Acc: 0.637 Test Loss: 1.307 Test Acc: 0.637
Validation loss decreased (-0.596283 --> -0.637024).  Saving model ...
Epoch: 14 cost time: 0.6117584705352783
Epoch: 14, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.259 Vali Acc: 0.681 Test Loss: 1.259 Test Acc: 0.681
Validation loss decreased (-0.637024 --> -0.681469).  Saving model ...
Epoch: 15 cost time: 0.5245795249938965
Epoch: 15, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.209 Vali Acc: 0.704 Test Loss: 1.209 Test Acc: 0.704
Validation loss decreased (-0.681469 --> -0.703692).  Saving model ...
Epoch: 16 cost time: 0.5891783237457275
Epoch: 16, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.160 Vali Acc: 0.726 Test Loss: 1.160 Test Acc: 0.726
Validation loss decreased (-0.703692 --> -0.725914).  Saving model ...
Epoch: 17 cost time: 0.5545907020568848
Epoch: 17, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.111 Vali Acc: 0.752 Test Loss: 1.111 Test Acc: 0.752
Validation loss decreased (-0.725914 --> -0.751841).  Saving model ...
Epoch: 18 cost time: 0.600440263748169
Epoch: 18, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.063 Vali Acc: 0.774 Test Loss: 1.063 Test Acc: 0.774
Validation loss decreased (-0.751841 --> -0.774063).  Saving model ...
Epoch: 19 cost time: 0.5859668254852295
Epoch: 19, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.018 Vali Acc: 0.804 Test Loss: 1.018 Test Acc: 0.804
Validation loss decreased (-0.774063 --> -0.803694).  Saving model ...
Epoch: 20 cost time: 0.5395040512084961
Epoch: 20, Steps: 2 | Train Loss: 1.025 Vali Loss: 0.974 Vali Acc: 0.844 Test Loss: 0.974 Test Acc: 0.844
Validation loss decreased (-0.803694 --> -0.844435).  Saving model ...
Epoch: 21 cost time: 0.6000134944915771
Epoch: 21, Steps: 2 | Train Loss: 0.985 Vali Loss: 0.931 Vali Acc: 0.859 Test Loss: 0.931 Test Acc: 0.859
Validation loss decreased (-0.844435 --> -0.859250).  Saving model ...
Epoch: 22 cost time: 0.5885939598083496
Epoch: 22, Steps: 2 | Train Loss: 0.925 Vali Loss: 0.890 Vali Acc: 0.874 Test Loss: 0.890 Test Acc: 0.874
Validation loss decreased (-0.859250 --> -0.874065).  Saving model ...
Epoch: 23 cost time: 0.5887234210968018
Epoch: 23, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.850 Vali Acc: 0.881 Test Loss: 0.850 Test Acc: 0.881
Validation loss decreased (-0.874065 --> -0.881473).  Saving model ...
Epoch: 24 cost time: 0.5132505893707275
Epoch: 24, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.810 Vali Acc: 0.889 Test Loss: 0.810 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888881).  Saving model ...
Epoch: 25 cost time: 0.46772193908691406
Epoch: 25, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.773 Vali Acc: 0.900 Test Loss: 0.773 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899992).  Saving model ...
Epoch: 26 cost time: 0.5899169445037842
Epoch: 26, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.735 Vali Acc: 0.911 Test Loss: 0.735 Test Acc: 0.911
Validation loss decreased (-0.899992 --> -0.911104).  Saving model ...
Epoch: 27 cost time: 0.5091581344604492
Epoch: 27, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.699 Vali Acc: 0.922 Test Loss: 0.699 Test Acc: 0.922
Validation loss decreased (-0.911104 --> -0.922215).  Saving model ...
Epoch: 28 cost time: 0.6064841747283936
Epoch: 28, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.666 Vali Acc: 0.926 Test Loss: 0.666 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 29 cost time: 0.5084562301635742
Epoch: 29, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.634 Vali Acc: 0.930 Test Loss: 0.634 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929623).  Saving model ...
Epoch: 30 cost time: 0.5800313949584961
Epoch: 30, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.605 Vali Acc: 0.930 Test Loss: 0.605 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 31 cost time: 0.5984907150268555
Epoch: 31, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.576 Vali Acc: 0.930 Test Loss: 0.576 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 32 cost time: 0.6310994625091553
Epoch: 32, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.549 Vali Acc: 0.930 Test Loss: 0.549 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 33 cost time: 0.4859459400177002
Epoch: 33, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.524 Vali Acc: 0.937 Test Loss: 0.524 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 34 cost time: 0.588996410369873
Epoch: 34, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.500 Vali Acc: 0.941 Test Loss: 0.500 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 35 cost time: 0.5828835964202881
Epoch: 35, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.478 Vali Acc: 0.941 Test Loss: 0.478 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 36 cost time: 0.49237871170043945
Epoch: 36, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.459 Vali Acc: 0.937 Test Loss: 0.459 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6015975475311279
Epoch: 37, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.440 Vali Acc: 0.937 Test Loss: 0.440 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5568253993988037
Epoch: 38, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.423 Vali Acc: 0.941 Test Loss: 0.423 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 39 cost time: 0.555908203125
Epoch: 39, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.406 Vali Acc: 0.941 Test Loss: 0.406 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 40 cost time: 0.5167787075042725
Epoch: 40, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.392 Vali Acc: 0.941 Test Loss: 0.392 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 41 cost time: 0.5032362937927246
Epoch: 41, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.379 Vali Acc: 0.937 Test Loss: 0.379 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7112641334533691
Epoch: 42, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.366 Vali Acc: 0.944 Test Loss: 0.366 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 43 cost time: 0.6188259124755859
Epoch: 43, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.354 Vali Acc: 0.944 Test Loss: 0.354 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 44 cost time: 0.5868830680847168
Epoch: 44, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.344 Vali Acc: 0.948 Test Loss: 0.344 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 45 cost time: 0.5732944011688232
Epoch: 45, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.334 Vali Acc: 0.948 Test Loss: 0.334 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 46 cost time: 0.5751502513885498
Epoch: 46, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.325 Vali Acc: 0.941 Test Loss: 0.325 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6577694416046143
Epoch: 47, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.317 Vali Acc: 0.941 Test Loss: 0.317 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5721032619476318
Epoch: 48, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.310 Vali Acc: 0.941 Test Loss: 0.310 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5591859817504883
Epoch: 49, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.57912278175354
Epoch: 50, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.5256741046905518
Epoch: 51, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.520881175994873
Epoch: 52, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.6716611385345459
Epoch: 53, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.278 Vali Acc: 0.952 Test Loss: 0.278 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 54 cost time: 0.5620687007904053
Epoch: 54, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.272 Vali Acc: 0.959 Test Loss: 0.272 Test Acc: 0.959
Validation loss decreased (-0.951849 --> -0.959257).  Saving model ...
Epoch: 55 cost time: 0.514507532119751
Epoch: 55, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.267 Vali Acc: 0.952 Test Loss: 0.267 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5550882816314697
Epoch: 56, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.263 Vali Acc: 0.956 Test Loss: 0.263 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5380051136016846
Epoch: 57, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.258 Vali Acc: 0.956 Test Loss: 0.258 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.535719633102417
Epoch: 58, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.254 Vali Acc: 0.956 Test Loss: 0.254 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.5055866241455078
Epoch: 59, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.250 Vali Acc: 0.956 Test Loss: 0.250 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.6102120876312256
Epoch: 60, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.246 Vali Acc: 0.956 Test Loss: 0.246 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.5492632389068604
Epoch: 61, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.244 Vali Acc: 0.956 Test Loss: 0.244 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.5923624038696289
Epoch: 62, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.241 Vali Acc: 0.956 Test Loss: 0.241 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.7722232341766357
Epoch: 63, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.239 Vali Acc: 0.956 Test Loss: 0.239 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.5746548175811768
Epoch: 64, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.236 Vali Acc: 0.956 Test Loss: 0.236 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm32_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 31622
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1959407329559326
Epoch: 1, Steps: 2 | Train Loss: 2.179 Vali Loss: 2.084 Vali Acc: 0.156 Test Loss: 2.084 Test Acc: 0.156
Validation loss decreased (inf --> -0.155535).  Saving model ...
Epoch: 2 cost time: 0.509516716003418
Epoch: 2, Steps: 2 | Train Loss: 2.206 Vali Loss: 2.000 Vali Acc: 0.193 Test Loss: 2.000 Test Acc: 0.193
Validation loss decreased (-0.155535 --> -0.192573).  Saving model ...
Epoch: 3 cost time: 0.5295305252075195
Epoch: 3, Steps: 2 | Train Loss: 2.042 Vali Loss: 1.925 Vali Acc: 0.237 Test Loss: 1.925 Test Acc: 0.237
Validation loss decreased (-0.192573 --> -0.237018).  Saving model ...
Epoch: 4 cost time: 0.6137053966522217
Epoch: 4, Steps: 2 | Train Loss: 1.931 Vali Loss: 1.837 Vali Acc: 0.278 Test Loss: 1.837 Test Acc: 0.278
Validation loss decreased (-0.237018 --> -0.277759).  Saving model ...
Epoch: 5 cost time: 0.48874425888061523
Epoch: 5, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.734 Vali Acc: 0.333 Test Loss: 1.734 Test Acc: 0.333
Validation loss decreased (-0.277759 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.524423360824585
Epoch: 6, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.622 Vali Acc: 0.385 Test Loss: 1.622 Test Acc: 0.385
Validation loss decreased (-0.333316 --> -0.385169).  Saving model ...
Epoch: 7 cost time: 0.5879402160644531
Epoch: 7, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.508 Vali Acc: 0.463 Test Loss: 1.508 Test Acc: 0.463
Validation loss decreased (-0.385169 --> -0.462948).  Saving model ...
Epoch: 8 cost time: 0.6650381088256836
Epoch: 8, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.392 Vali Acc: 0.541 Test Loss: 1.392 Test Acc: 0.541
Validation loss decreased (-0.462948 --> -0.540727).  Saving model ...
Epoch: 9 cost time: 0.5799956321716309
Epoch: 9, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.283 Vali Acc: 0.604 Test Loss: 1.283 Test Acc: 0.604
Validation loss decreased (-0.540727 --> -0.603691).  Saving model ...
Epoch: 10 cost time: 0.5858769416809082
Epoch: 10, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.177 Vali Acc: 0.681 Test Loss: 1.177 Test Acc: 0.681
Validation loss decreased (-0.603691 --> -0.681470).  Saving model ...
Epoch: 11 cost time: 0.5418336391448975
Epoch: 11, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.077 Vali Acc: 0.726 Test Loss: 1.077 Test Acc: 0.726
Validation loss decreased (-0.681470 --> -0.725915).  Saving model ...
Epoch: 12 cost time: 0.43648266792297363
Epoch: 12, Steps: 2 | Train Loss: 1.014 Vali Loss: 0.980 Vali Acc: 0.767 Test Loss: 0.980 Test Acc: 0.767
Validation loss decreased (-0.725915 --> -0.766657).  Saving model ...
Epoch: 13 cost time: 0.5398070812225342
Epoch: 13, Steps: 2 | Train Loss: 0.927 Vali Loss: 0.882 Vali Acc: 0.793 Test Loss: 0.882 Test Acc: 0.793
Validation loss decreased (-0.766657 --> -0.792584).  Saving model ...
Epoch: 14 cost time: 0.5448427200317383
Epoch: 14, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.792 Vali Acc: 0.811 Test Loss: 0.792 Test Acc: 0.811
Validation loss decreased (-0.792584 --> -0.811103).  Saving model ...
Epoch: 15 cost time: 0.510770320892334
Epoch: 15, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.712 Vali Acc: 0.830 Test Loss: 0.712 Test Acc: 0.830
Validation loss decreased (-0.811103 --> -0.829623).  Saving model ...
Epoch: 16 cost time: 0.5952455997467041
Epoch: 16, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.640 Vali Acc: 0.848 Test Loss: 0.640 Test Acc: 0.848
Validation loss decreased (-0.829623 --> -0.848142).  Saving model ...
Epoch: 17 cost time: 0.5225639343261719
Epoch: 17, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.580 Vali Acc: 0.848 Test Loss: 0.580 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 18 cost time: 0.6106226444244385
Epoch: 18, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
Validation loss decreased (-0.848142 --> -0.855550).  Saving model ...
Epoch: 19 cost time: 0.5074210166931152
Epoch: 19, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.470 Vali Acc: 0.874 Test Loss: 0.470 Test Acc: 0.874
Validation loss decreased (-0.855550 --> -0.874069).  Saving model ...
Epoch: 20 cost time: 0.6287322044372559
Epoch: 20, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.425 Vali Acc: 0.885 Test Loss: 0.425 Test Acc: 0.885
Validation loss decreased (-0.874069 --> -0.885181).  Saving model ...
Epoch: 21 cost time: 0.5583503246307373
Epoch: 21, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.387 Vali Acc: 0.904 Test Loss: 0.387 Test Acc: 0.904
Validation loss decreased (-0.885181 --> -0.903700).  Saving model ...
Epoch: 22 cost time: 0.4801504611968994
Epoch: 22, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.357 Vali Acc: 0.907 Test Loss: 0.357 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 23 cost time: 0.6901447772979736
Epoch: 23, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.335 Vali Acc: 0.904 Test Loss: 0.335 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.49820613861083984
Epoch: 24, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.314 Vali Acc: 0.904 Test Loss: 0.314 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5379743576049805
Epoch: 25, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.289 Vali Acc: 0.915 Test Loss: 0.289 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 0.5521371364593506
Epoch: 26, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.264 Vali Acc: 0.919 Test Loss: 0.264 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 27 cost time: 0.5495965480804443
Epoch: 27, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.5524206161499023
Epoch: 28, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 0.5530440807342529
Epoch: 29, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.5409071445465088
Epoch: 30, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.6653528213500977
Epoch: 31, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 32 cost time: 0.5542941093444824
Epoch: 32, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 33 cost time: 0.5299191474914551
Epoch: 33, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 34 cost time: 0.6491661071777344
Epoch: 34, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 35 cost time: 0.5918645858764648
Epoch: 35, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.5717933177947998
Epoch: 36, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.591721773147583
Epoch: 37, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6510429382324219
Epoch: 38, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 39 cost time: 0.6177735328674316
Epoch: 39, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 40 cost time: 0.6733152866363525
Epoch: 40, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 41 cost time: 0.6318497657775879
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 42 cost time: 0.574676513671875
Epoch: 42, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 43 cost time: 0.6285293102264404
Epoch: 43, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.5353419780731201
Epoch: 44, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.5352938175201416
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 46 cost time: 0.6244151592254639
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 47 cost time: 0.5956988334655762
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 48 cost time: 0.5454616546630859
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5887422561645508
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7866511344909668
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8796272277832031
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.5463225841522217
Epoch: 52, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.5725235939025879
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6765263080596924
Epoch: 54, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.5591738224029541
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.6713004112243652
Epoch: 56, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.487837553024292
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 53878
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.192345142364502
Epoch: 1, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.794 Vali Acc: 0.204 Test Loss: 1.794 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.6916723251342773
Epoch: 2, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.747 Vali Acc: 0.215 Test Loss: 1.747 Test Acc: 0.215
Validation loss decreased (-0.203686 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.6390488147735596
Epoch: 3, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.709 Vali Acc: 0.222 Test Loss: 1.709 Test Acc: 0.222
Validation loss decreased (-0.214797 --> -0.222205).  Saving model ...
Epoch: 4 cost time: 0.6540255546569824
Epoch: 4, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.670 Vali Acc: 0.241 Test Loss: 1.670 Test Acc: 0.241
Validation loss decreased (-0.222205 --> -0.240724).  Saving model ...
Epoch: 5 cost time: 0.7182300090789795
Epoch: 5, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.623 Vali Acc: 0.270 Test Loss: 1.623 Test Acc: 0.270
Validation loss decreased (-0.240724 --> -0.270354).  Saving model ...
Epoch: 6 cost time: 0.7238302230834961
Epoch: 6, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.569 Vali Acc: 0.307 Test Loss: 1.569 Test Acc: 0.307
Validation loss decreased (-0.270354 --> -0.307392).  Saving model ...
Epoch: 7 cost time: 0.6353938579559326
Epoch: 7, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.509 Vali Acc: 0.389 Test Loss: 1.509 Test Acc: 0.389
Validation loss decreased (-0.307392 --> -0.388874).  Saving model ...
Epoch: 8 cost time: 0.6511862277984619
Epoch: 8, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.444 Vali Acc: 0.478 Test Loss: 1.444 Test Acc: 0.478
Validation loss decreased (-0.388874 --> -0.477763).  Saving model ...
Epoch: 9 cost time: 0.5770351886749268
Epoch: 9, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.376 Vali Acc: 0.578 Test Loss: 1.376 Test Acc: 0.578
Validation loss decreased (-0.477763 --> -0.577764).  Saving model ...
Epoch: 10 cost time: 0.6539878845214844
Epoch: 10, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.305 Vali Acc: 0.626 Test Loss: 1.305 Test Acc: 0.626
Validation loss decreased (-0.577764 --> -0.625913).  Saving model ...
Epoch: 11 cost time: 0.6379756927490234
Epoch: 11, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.234 Vali Acc: 0.681 Test Loss: 1.234 Test Acc: 0.681
Validation loss decreased (-0.625913 --> -0.681469).  Saving model ...
Epoch: 12 cost time: 0.7016994953155518
Epoch: 12, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.162 Vali Acc: 0.719 Test Loss: 1.162 Test Acc: 0.719
Validation loss decreased (-0.681469 --> -0.718507).  Saving model ...
Epoch: 13 cost time: 0.5890443325042725
Epoch: 13, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.092 Vali Acc: 0.752 Test Loss: 1.092 Test Acc: 0.752
Validation loss decreased (-0.718507 --> -0.751841).  Saving model ...
Epoch: 14 cost time: 0.744966983795166
Epoch: 14, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.023 Vali Acc: 0.789 Test Loss: 1.023 Test Acc: 0.789
Validation loss decreased (-0.751841 --> -0.788879).  Saving model ...
Epoch: 15 cost time: 0.6390635967254639
Epoch: 15, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.955 Vali Acc: 0.804 Test Loss: 0.955 Test Acc: 0.804
Validation loss decreased (-0.788879 --> -0.803694).  Saving model ...
Epoch: 16 cost time: 0.6684532165527344
Epoch: 16, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.892 Vali Acc: 0.804 Test Loss: 0.892 Test Acc: 0.804
Validation loss decreased (-0.803694 --> -0.803695).  Saving model ...
Epoch: 17 cost time: 0.6796276569366455
Epoch: 17, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.833 Vali Acc: 0.815 Test Loss: 0.833 Test Acc: 0.815
Validation loss decreased (-0.803695 --> -0.814806).  Saving model ...
Epoch: 18 cost time: 0.6394321918487549
Epoch: 18, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.780 Vali Acc: 0.826 Test Loss: 0.780 Test Acc: 0.826
Validation loss decreased (-0.814806 --> -0.825918).  Saving model ...
Epoch: 19 cost time: 0.6250193119049072
Epoch: 19, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.727 Vali Acc: 0.848 Test Loss: 0.727 Test Acc: 0.848
Validation loss decreased (-0.825918 --> -0.848141).  Saving model ...
Epoch: 20 cost time: 0.595177412033081
Epoch: 20, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.678 Vali Acc: 0.863 Test Loss: 0.678 Test Acc: 0.863
Validation loss decreased (-0.848141 --> -0.862956).  Saving model ...
Epoch: 21 cost time: 0.6479780673980713
Epoch: 21, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.632 Vali Acc: 0.870 Test Loss: 0.632 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870364).  Saving model ...
Epoch: 22 cost time: 0.5812647342681885
Epoch: 22, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.589 Vali Acc: 0.878 Test Loss: 0.589 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 0.7247803211212158
Epoch: 23, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.551 Vali Acc: 0.885 Test Loss: 0.551 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885180).  Saving model ...
Epoch: 24 cost time: 0.6165111064910889
Epoch: 24, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.515 Vali Acc: 0.893 Test Loss: 0.515 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892587).  Saving model ...
Epoch: 25 cost time: 0.6016461849212646
Epoch: 25, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.484 Vali Acc: 0.893 Test Loss: 0.484 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892588).  Saving model ...
Epoch: 26 cost time: 0.6022875308990479
Epoch: 26, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
Validation loss decreased (-0.892588 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.7064201831817627
Epoch: 27, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.5921647548675537
Epoch: 28, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.408 Vali Acc: 0.904 Test Loss: 0.408 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 29 cost time: 0.6635699272155762
Epoch: 29, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.387 Vali Acc: 0.904 Test Loss: 0.387 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 30 cost time: 0.6002862453460693
Epoch: 30, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.369 Vali Acc: 0.904 Test Loss: 0.369 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 31 cost time: 0.6221487522125244
Epoch: 31, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.352 Vali Acc: 0.904 Test Loss: 0.352 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 32 cost time: 0.6458883285522461
Epoch: 32, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.339 Vali Acc: 0.907 Test Loss: 0.339 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 33 cost time: 0.5607490539550781
Epoch: 33, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 34 cost time: 0.6664555072784424
Epoch: 34, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.314 Vali Acc: 0.907 Test Loss: 0.314 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6248459815979004
Epoch: 35, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.305 Vali Acc: 0.915 Test Loss: 0.305 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 36 cost time: 0.7637746334075928
Epoch: 36, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.296 Vali Acc: 0.911 Test Loss: 0.296 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8690395355224609
Epoch: 37, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.860551118850708
Epoch: 38, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.282 Vali Acc: 0.919 Test Loss: 0.282 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 39 cost time: 0.789149284362793
Epoch: 39, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 40 cost time: 0.8790583610534668
Epoch: 40, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.273 Vali Acc: 0.919 Test Loss: 0.273 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 41 cost time: 0.7980401515960693
Epoch: 41, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 42 cost time: 0.7919142246246338
Epoch: 42, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 43 cost time: 1.1129696369171143
Epoch: 43, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 44 cost time: 0.7947750091552734
Epoch: 44, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 45 cost time: 0.8086135387420654
Epoch: 45, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 46 cost time: 0.7373921871185303
Epoch: 46, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 47 cost time: 0.8564083576202393
Epoch: 47, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 48 cost time: 0.8157951831817627
Epoch: 48, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 49 cost time: 0.8111405372619629
Epoch: 49, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.246 Vali Acc: 0.926 Test Loss: 0.246 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 50 cost time: 0.7514910697937012
Epoch: 50, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 51 cost time: 0.7061216831207275
Epoch: 51, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 52 cost time: 0.7953410148620605
Epoch: 52, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 53 cost time: 0.7419865131378174
Epoch: 53, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 54 cost time: 0.7759244441986084
Epoch: 54, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7812092304229736
Epoch: 55, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 56 cost time: 0.6554946899414062
Epoch: 56, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 57 cost time: 0.6594879627227783
Epoch: 57, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 58 cost time: 0.7147789001464844
Epoch: 58, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 59 cost time: 0.8023769855499268
Epoch: 59, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 60 cost time: 0.7996528148651123
Epoch: 60, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 61 cost time: 0.684992790222168
Epoch: 61, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 62 cost time: 0.685551643371582
Epoch: 62, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 63 cost time: 0.747154712677002
Epoch: 63, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 64 cost time: 0.835381031036377
Epoch: 64, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 65 cost time: 0.7515988349914551
Epoch: 65, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 66 cost time: 0.9173235893249512
Epoch: 66, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 67 cost time: 0.9772813320159912
Epoch: 67, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8080272674560547
Epoch: 68, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8567743301391602
Epoch: 69, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8060603141784668
Epoch: 70, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 71 cost time: 0.9188723564147949
Epoch: 71, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 72 cost time: 0.7435958385467529
Epoch: 72, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 73 cost time: 0.7718513011932373
Epoch: 73, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 74 cost time: 0.7414236068725586
Epoch: 74, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 75 cost time: 0.8489820957183838
Epoch: 75, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 76 cost time: 0.735133171081543
Epoch: 76, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 77 cost time: 0.7600984573364258
Epoch: 77, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 78 cost time: 0.7281050682067871
Epoch: 78, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 79 cost time: 0.8520107269287109
Epoch: 79, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 80 cost time: 0.8103446960449219
Epoch: 80, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.6645612716674805
Epoch: 81, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 82 cost time: 0.5652790069580078
Epoch: 82, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.779015064239502
Epoch: 83, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.6334521770477295
Epoch: 84, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 85 cost time: 0.630401611328125
Epoch: 85, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 86 cost time: 0.6606755256652832
Epoch: 86, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 87 cost time: 0.7046957015991211
Epoch: 87, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 88 cost time: 0.7190732955932617
Epoch: 88, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 89 cost time: 0.7119195461273193
Epoch: 89, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 90 cost time: 0.7267777919769287
Epoch: 90, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.8600256443023682
Epoch: 91, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.79256272315979
Epoch: 92, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.7410888671875
Epoch: 93, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.7512795925140381
Epoch: 94, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.7184033393859863
Epoch: 95, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 0.7946772575378418
Epoch: 96, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 0.773155689239502
Epoch: 97, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 0.7438304424285889
Epoch: 98, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 0.7336416244506836
Epoch: 99, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 41238
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.630902051925659
Epoch: 1, Steps: 2 | Train Loss: 1.933 Vali Loss: 1.804 Vali Acc: 0.130 Test Loss: 1.804 Test Acc: 0.130
Validation loss decreased (inf --> -0.129612).  Saving model ...
Epoch: 2 cost time: 0.6890342235565186
Epoch: 2, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.766 Vali Acc: 0.170 Test Loss: 1.766 Test Acc: 0.170
Validation loss decreased (-0.129612 --> -0.170353).  Saving model ...
Epoch: 3 cost time: 0.6710588932037354
Epoch: 3, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.736 Vali Acc: 0.204 Test Loss: 1.736 Test Acc: 0.204
Validation loss decreased (-0.170353 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.6204218864440918
Epoch: 4, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.706 Vali Acc: 0.259 Test Loss: 1.706 Test Acc: 0.259
Validation loss decreased (-0.203686 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 0.702869176864624
Epoch: 5, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.667 Vali Acc: 0.285 Test Loss: 1.667 Test Acc: 0.285
Validation loss decreased (-0.259242 --> -0.285169).  Saving model ...
Epoch: 6 cost time: 0.5777454376220703
Epoch: 6, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.621 Vali Acc: 0.341 Test Loss: 1.621 Test Acc: 0.341
Validation loss decreased (-0.285169 --> -0.340725).  Saving model ...
Epoch: 7 cost time: 0.5480480194091797
Epoch: 7, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.570 Vali Acc: 0.389 Test Loss: 1.570 Test Acc: 0.389
Validation loss decreased (-0.340725 --> -0.388873).  Saving model ...
Epoch: 8 cost time: 0.6407675743103027
Epoch: 8, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.512 Vali Acc: 0.459 Test Loss: 1.512 Test Acc: 0.459
Validation loss decreased (-0.388873 --> -0.459244).  Saving model ...
Epoch: 9 cost time: 0.5173518657684326
Epoch: 9, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.451 Vali Acc: 0.541 Test Loss: 1.451 Test Acc: 0.541
Validation loss decreased (-0.459244 --> -0.540726).  Saving model ...
Epoch: 10 cost time: 0.5907299518585205
Epoch: 10, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.387 Vali Acc: 0.652 Test Loss: 1.387 Test Acc: 0.652
Validation loss decreased (-0.540726 --> -0.651838).  Saving model ...
Epoch: 11 cost time: 0.5694561004638672
Epoch: 11, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.320 Vali Acc: 0.726 Test Loss: 1.320 Test Acc: 0.726
Validation loss decreased (-0.651838 --> -0.725913).  Saving model ...
Epoch: 12 cost time: 0.6050593852996826
Epoch: 12, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.252 Vali Acc: 0.767 Test Loss: 1.252 Test Acc: 0.767
Validation loss decreased (-0.725913 --> -0.766654).  Saving model ...
Epoch: 13 cost time: 0.6095926761627197
Epoch: 13, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.185 Vali Acc: 0.804 Test Loss: 1.185 Test Acc: 0.804
Validation loss decreased (-0.766654 --> -0.803692).  Saving model ...
Epoch: 14 cost time: 0.6461882591247559
Epoch: 14, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.118 Vali Acc: 0.826 Test Loss: 1.118 Test Acc: 0.826
Validation loss decreased (-0.803692 --> -0.825915).  Saving model ...
Epoch: 15 cost time: 0.5067672729492188
Epoch: 15, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.053 Vali Acc: 0.848 Test Loss: 1.053 Test Acc: 0.848
Validation loss decreased (-0.825915 --> -0.848138).  Saving model ...
Epoch: 16 cost time: 0.5517511367797852
Epoch: 16, Steps: 2 | Train Loss: 1.055 Vali Loss: 0.989 Vali Acc: 0.856 Test Loss: 0.989 Test Acc: 0.856
Validation loss decreased (-0.848138 --> -0.855546).  Saving model ...
Epoch: 17 cost time: 0.653160572052002
Epoch: 17, Steps: 2 | Train Loss: 0.916 Vali Loss: 0.927 Vali Acc: 0.878 Test Loss: 0.927 Test Acc: 0.878
Validation loss decreased (-0.855546 --> -0.877769).  Saving model ...
Epoch: 18 cost time: 0.5975668430328369
Epoch: 18, Steps: 2 | Train Loss: 0.962 Vali Loss: 0.868 Vali Acc: 0.881 Test Loss: 0.868 Test Acc: 0.881
Validation loss decreased (-0.877769 --> -0.881473).  Saving model ...
Epoch: 19 cost time: 0.6075317859649658
Epoch: 19, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.812 Vali Acc: 0.904 Test Loss: 0.812 Test Acc: 0.904
Validation loss decreased (-0.881473 --> -0.903696).  Saving model ...
Epoch: 20 cost time: 0.6579830646514893
Epoch: 20, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.759 Vali Acc: 0.911 Test Loss: 0.759 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 21 cost time: 0.5985527038574219
Epoch: 21, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.711 Vali Acc: 0.911 Test Loss: 0.711 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.7039930820465088
Epoch: 22, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.666 Vali Acc: 0.915 Test Loss: 0.666 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 23 cost time: 0.6307780742645264
Epoch: 23, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.624 Vali Acc: 0.915 Test Loss: 0.624 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 24 cost time: 0.7397546768188477
Epoch: 24, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.587 Vali Acc: 0.922 Test Loss: 0.587 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922216).  Saving model ...
Epoch: 25 cost time: 0.7375607490539551
Epoch: 25, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.552 Vali Acc: 0.930 Test Loss: 0.552 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 26 cost time: 0.6526682376861572
Epoch: 26, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.520 Vali Acc: 0.933 Test Loss: 0.520 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 27 cost time: 0.6464734077453613
Epoch: 27, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.490 Vali Acc: 0.937 Test Loss: 0.490 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 28 cost time: 0.675546407699585
Epoch: 28, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.462 Vali Acc: 0.937 Test Loss: 0.462 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 29 cost time: 0.6162700653076172
Epoch: 29, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.437 Vali Acc: 0.941 Test Loss: 0.437 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 30 cost time: 0.5791187286376953
Epoch: 30, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.415 Vali Acc: 0.948 Test Loss: 0.415 Test Acc: 0.948
Validation loss decreased (-0.940736 --> -0.948144).  Saving model ...
Epoch: 31 cost time: 0.5951151847839355
Epoch: 31, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.395 Vali Acc: 0.944 Test Loss: 0.395 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6304841041564941
Epoch: 32, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.377 Vali Acc: 0.944 Test Loss: 0.377 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6540608406066895
Epoch: 33, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.361 Vali Acc: 0.944 Test Loss: 0.361 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6517555713653564
Epoch: 34, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.345 Vali Acc: 0.944 Test Loss: 0.345 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6727566719055176
Epoch: 35, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.331 Vali Acc: 0.944 Test Loss: 0.331 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6110796928405762
Epoch: 36, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.319 Vali Acc: 0.944 Test Loss: 0.319 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6018271446228027
Epoch: 37, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5978007316589355
Epoch: 38, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.298 Vali Acc: 0.941 Test Loss: 0.298 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5378990173339844
Epoch: 39, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6658096313476562
Epoch: 40, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 37414
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3553216457366943
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 2.040 Vali Acc: 0.256 Test Loss: 2.040 Test Acc: 0.256
Validation loss decreased (inf --> -0.255535).  Saving model ...
Epoch: 2 cost time: 0.6216316223144531
Epoch: 2, Steps: 2 | Train Loss: 1.988 Vali Loss: 1.969 Vali Acc: 0.270 Test Loss: 1.969 Test Acc: 0.270
Validation loss decreased (-0.255535 --> -0.270351).  Saving model ...
Epoch: 3 cost time: 0.571751594543457
Epoch: 3, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.914 Vali Acc: 0.278 Test Loss: 1.914 Test Acc: 0.278
Validation loss decreased (-0.270351 --> -0.277759).  Saving model ...
Epoch: 4 cost time: 0.7748544216156006
Epoch: 4, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.868 Vali Acc: 0.278 Test Loss: 1.868 Test Acc: 0.278
Validation loss decreased (-0.277759 --> -0.277759).  Saving model ...
Epoch: 5 cost time: 0.7210700511932373
Epoch: 5, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.820 Vali Acc: 0.289 Test Loss: 1.820 Test Acc: 0.289
Validation loss decreased (-0.277759 --> -0.288871).  Saving model ...
Epoch: 6 cost time: 0.6299796104431152
Epoch: 6, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.770 Vali Acc: 0.293 Test Loss: 1.770 Test Acc: 0.293
Validation loss decreased (-0.288871 --> -0.292575).  Saving model ...
Epoch: 7 cost time: 0.5808279514312744
Epoch: 7, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.718 Vali Acc: 0.315 Test Loss: 1.718 Test Acc: 0.315
Validation loss decreased (-0.292575 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 0.6644492149353027
Epoch: 8, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.665 Vali Acc: 0.333 Test Loss: 1.665 Test Acc: 0.333
Validation loss decreased (-0.314798 --> -0.333317).  Saving model ...
Epoch: 9 cost time: 0.7020576000213623
Epoch: 9, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.611 Vali Acc: 0.341 Test Loss: 1.611 Test Acc: 0.341
Validation loss decreased (-0.333317 --> -0.340725).  Saving model ...
Epoch: 10 cost time: 0.6054885387420654
Epoch: 10, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.555 Vali Acc: 0.378 Test Loss: 1.555 Test Acc: 0.378
Validation loss decreased (-0.340725 --> -0.377762).  Saving model ...
Epoch: 11 cost time: 0.6108546257019043
Epoch: 11, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.497 Vali Acc: 0.422 Test Loss: 1.497 Test Acc: 0.422
Validation loss decreased (-0.377762 --> -0.422207).  Saving model ...
Epoch: 12 cost time: 0.6239380836486816
Epoch: 12, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.439 Vali Acc: 0.474 Test Loss: 1.439 Test Acc: 0.474
Validation loss decreased (-0.422207 --> -0.474060).  Saving model ...
Epoch: 13 cost time: 0.6383287906646729
Epoch: 13, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.380 Vali Acc: 0.522 Test Loss: 1.380 Test Acc: 0.522
Validation loss decreased (-0.474060 --> -0.522208).  Saving model ...
Epoch: 14 cost time: 0.6363265514373779
Epoch: 14, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.321 Vali Acc: 0.581 Test Loss: 1.321 Test Acc: 0.581
Validation loss decreased (-0.522208 --> -0.581468).  Saving model ...
Epoch: 15 cost time: 0.7249743938446045
Epoch: 15, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.263 Vali Acc: 0.622 Test Loss: 1.263 Test Acc: 0.622
Validation loss decreased (-0.581468 --> -0.622210).  Saving model ...
Epoch: 16 cost time: 0.5917973518371582
Epoch: 16, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.206 Vali Acc: 0.656 Test Loss: 1.206 Test Acc: 0.656
Validation loss decreased (-0.622210 --> -0.655543).  Saving model ...
Epoch: 17 cost time: 0.6582751274108887
Epoch: 17, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.149 Vali Acc: 0.689 Test Loss: 1.149 Test Acc: 0.689
Validation loss decreased (-0.655543 --> -0.688877).  Saving model ...
Epoch: 18 cost time: 0.7038893699645996
Epoch: 18, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.092 Vali Acc: 0.719 Test Loss: 1.092 Test Acc: 0.719
Validation loss decreased (-0.688877 --> -0.718508).  Saving model ...
Epoch: 19 cost time: 0.6257119178771973
Epoch: 19, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.038 Vali Acc: 0.767 Test Loss: 1.038 Test Acc: 0.767
Validation loss decreased (-0.718508 --> -0.766656).  Saving model ...
Epoch: 20 cost time: 0.6960816383361816
Epoch: 20, Steps: 2 | Train Loss: 0.965 Vali Loss: 0.987 Vali Acc: 0.781 Test Loss: 0.987 Test Acc: 0.781
Validation loss decreased (-0.766656 --> -0.781472).  Saving model ...
Epoch: 21 cost time: 0.6114046573638916
Epoch: 21, Steps: 2 | Train Loss: 0.923 Vali Loss: 0.937 Vali Acc: 0.811 Test Loss: 0.937 Test Acc: 0.811
Validation loss decreased (-0.781472 --> -0.811102).  Saving model ...
Epoch: 22 cost time: 0.6106607913970947
Epoch: 22, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.889 Vali Acc: 0.833 Test Loss: 0.889 Test Acc: 0.833
Validation loss decreased (-0.811102 --> -0.833324).  Saving model ...
Epoch: 23 cost time: 0.5557653903961182
Epoch: 23, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.843 Vali Acc: 0.859 Test Loss: 0.843 Test Acc: 0.859
Validation loss decreased (-0.833324 --> -0.859251).  Saving model ...
Epoch: 24 cost time: 0.6916525363922119
Epoch: 24, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.800 Vali Acc: 0.852 Test Loss: 0.800 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5704741477966309
Epoch: 25, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.759 Vali Acc: 0.852 Test Loss: 0.759 Test Acc: 0.852
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7424125671386719
Epoch: 26, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.721 Vali Acc: 0.859 Test Loss: 0.721 Test Acc: 0.859
Validation loss decreased (-0.859251 --> -0.859252).  Saving model ...
Epoch: 27 cost time: 0.719048261642456
Epoch: 27, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.684 Vali Acc: 0.874 Test Loss: 0.684 Test Acc: 0.874
Validation loss decreased (-0.859252 --> -0.874067).  Saving model ...
Epoch: 28 cost time: 0.5312561988830566
Epoch: 28, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.649 Vali Acc: 0.881 Test Loss: 0.649 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881475).  Saving model ...
Epoch: 29 cost time: 0.6067590713500977
Epoch: 29, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.617 Vali Acc: 0.885 Test Loss: 0.617 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 30 cost time: 0.6409070491790771
Epoch: 30, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.586 Vali Acc: 0.885 Test Loss: 0.586 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 31 cost time: 0.6663944721221924
Epoch: 31, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.558 Vali Acc: 0.893 Test Loss: 0.558 Test Acc: 0.893
Validation loss decreased (-0.885179 --> -0.892587).  Saving model ...
Epoch: 32 cost time: 0.6745421886444092
Epoch: 32, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.531 Vali Acc: 0.893 Test Loss: 0.531 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 33 cost time: 0.650383710861206
Epoch: 33, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.507 Vali Acc: 0.896 Test Loss: 0.507 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 34 cost time: 0.6073489189147949
Epoch: 34, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.484 Vali Acc: 0.911 Test Loss: 0.484 Test Acc: 0.911
Validation loss decreased (-0.896291 --> -0.911106).  Saving model ...
Epoch: 35 cost time: 0.5499804019927979
Epoch: 35, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.464 Vali Acc: 0.919 Test Loss: 0.464 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 36 cost time: 0.6385138034820557
Epoch: 36, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.447 Vali Acc: 0.926 Test Loss: 0.447 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925921).  Saving model ...
Epoch: 37 cost time: 0.6962263584136963
Epoch: 37, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.431 Vali Acc: 0.919 Test Loss: 0.431 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7480335235595703
Epoch: 38, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.416 Vali Acc: 0.922 Test Loss: 0.416 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7929892539978027
Epoch: 39, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.403 Vali Acc: 0.926 Test Loss: 0.403 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 40 cost time: 0.6477961540222168
Epoch: 40, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.390 Vali Acc: 0.930 Test Loss: 0.390 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 41 cost time: 0.6197566986083984
Epoch: 41, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.378 Vali Acc: 0.933 Test Loss: 0.378 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 42 cost time: 0.7003538608551025
Epoch: 42, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.368 Vali Acc: 0.930 Test Loss: 0.368 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.702824592590332
Epoch: 43, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.358 Vali Acc: 0.930 Test Loss: 0.358 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.656928539276123
Epoch: 44, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6581840515136719
Epoch: 45, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.340 Vali Acc: 0.933 Test Loss: 0.340 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 46 cost time: 0.6358914375305176
Epoch: 46, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.333 Vali Acc: 0.933 Test Loss: 0.333 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 47 cost time: 0.6326844692230225
Epoch: 47, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.325 Vali Acc: 0.933 Test Loss: 0.325 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 48 cost time: 0.6329762935638428
Epoch: 48, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.319 Vali Acc: 0.937 Test Loss: 0.319 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 49 cost time: 0.639427661895752
Epoch: 49, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.313 Vali Acc: 0.937 Test Loss: 0.313 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 50 cost time: 0.6883296966552734
Epoch: 50, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.308 Vali Acc: 0.937 Test Loss: 0.308 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 51 cost time: 0.5931527614593506
Epoch: 51, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.303 Vali Acc: 0.937 Test Loss: 0.303 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 52 cost time: 0.5977599620819092
Epoch: 52, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.298 Vali Acc: 0.937 Test Loss: 0.298 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 53 cost time: 0.8298525810241699
Epoch: 53, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.293 Vali Acc: 0.937 Test Loss: 0.293 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 54 cost time: 0.5915858745574951
Epoch: 54, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 55 cost time: 0.7303144931793213
Epoch: 55, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5670664310455322
Epoch: 56, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5088984966278076
Epoch: 57, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5994799137115479
Epoch: 58, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.5109503269195557
Epoch: 59, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 60 cost time: 0.6005465984344482
Epoch: 60, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 61 cost time: 0.6751494407653809
Epoch: 61, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 62 cost time: 0.7326302528381348
Epoch: 62, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5168306827545166
Epoch: 63, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.5682320594787598
Epoch: 64, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.5813634395599365
Epoch: 65, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.5995216369628906
Epoch: 66, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.6196625232696533
Epoch: 67, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.59079909324646
Epoch: 68, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.6718802452087402
Epoch: 69, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.7302322387695312
Epoch: 70, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.6347205638885498
Epoch: 71, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 35142
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.28248929977417
Epoch: 1, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.685 Vali Acc: 0.244 Test Loss: 1.685 Test Acc: 0.244
Validation loss decreased (inf --> -0.244428).  Saving model ...
Epoch: 2 cost time: 0.6948463916778564
Epoch: 2, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.648 Vali Acc: 0.259 Test Loss: 1.648 Test Acc: 0.259
Validation loss decreased (-0.244428 --> -0.259243).  Saving model ...
Epoch: 3 cost time: 0.6595883369445801
Epoch: 3, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.620 Vali Acc: 0.263 Test Loss: 1.620 Test Acc: 0.263
Validation loss decreased (-0.259243 --> -0.262947).  Saving model ...
Epoch: 4 cost time: 0.6036820411682129
Epoch: 4, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.596 Vali Acc: 0.274 Test Loss: 1.596 Test Acc: 0.274
Validation loss decreased (-0.262947 --> -0.274058).  Saving model ...
Epoch: 5 cost time: 0.6033143997192383
Epoch: 5, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.566 Vali Acc: 0.300 Test Loss: 1.566 Test Acc: 0.300
Validation loss decreased (-0.274058 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 0.7747640609741211
Epoch: 6, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.532 Vali Acc: 0.326 Test Loss: 1.532 Test Acc: 0.326
Validation loss decreased (-0.299984 --> -0.325911).  Saving model ...
Epoch: 7 cost time: 0.6415195465087891
Epoch: 7, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.497 Vali Acc: 0.341 Test Loss: 1.497 Test Acc: 0.341
Validation loss decreased (-0.325911 --> -0.340726).  Saving model ...
Epoch: 8 cost time: 0.5899736881256104
Epoch: 8, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.458 Vali Acc: 0.393 Test Loss: 1.458 Test Acc: 0.393
Validation loss decreased (-0.340726 --> -0.392578).  Saving model ...
Epoch: 9 cost time: 0.621694803237915
Epoch: 9, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.417 Vali Acc: 0.437 Test Loss: 1.417 Test Acc: 0.437
Validation loss decreased (-0.392578 --> -0.437023).  Saving model ...
Epoch: 10 cost time: 0.5458412170410156
Epoch: 10, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.375 Vali Acc: 0.489 Test Loss: 1.375 Test Acc: 0.489
Validation loss decreased (-0.437023 --> -0.488875).  Saving model ...
Epoch: 11 cost time: 0.5927426815032959
Epoch: 11, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.331 Vali Acc: 0.548 Test Loss: 1.331 Test Acc: 0.548
Validation loss decreased (-0.488875 --> -0.548135).  Saving model ...
Epoch: 12 cost time: 0.67018723487854
Epoch: 12, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.287 Vali Acc: 0.589 Test Loss: 1.287 Test Acc: 0.589
Validation loss decreased (-0.548135 --> -0.588876).  Saving model ...
Epoch: 13 cost time: 0.5554671287536621
Epoch: 13, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.243 Vali Acc: 0.615 Test Loss: 1.243 Test Acc: 0.615
Validation loss decreased (-0.588876 --> -0.614802).  Saving model ...
Epoch: 14 cost time: 0.6540687084197998
Epoch: 14, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.198 Vali Acc: 0.644 Test Loss: 1.198 Test Acc: 0.644
Validation loss decreased (-0.614802 --> -0.644432).  Saving model ...
Epoch: 15 cost time: 0.6591651439666748
Epoch: 15, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.155 Vali Acc: 0.674 Test Loss: 1.155 Test Acc: 0.674
Validation loss decreased (-0.644432 --> -0.674063).  Saving model ...
Epoch: 16 cost time: 0.6525423526763916
Epoch: 16, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.112 Vali Acc: 0.696 Test Loss: 1.112 Test Acc: 0.696
Validation loss decreased (-0.674063 --> -0.696285).  Saving model ...
Epoch: 17 cost time: 0.5576398372650146
Epoch: 17, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.070 Vali Acc: 0.719 Test Loss: 1.070 Test Acc: 0.719
Validation loss decreased (-0.696285 --> -0.718508).  Saving model ...
Epoch: 18 cost time: 0.6093404293060303
Epoch: 18, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.028 Vali Acc: 0.730 Test Loss: 1.028 Test Acc: 0.730
Validation loss decreased (-0.718508 --> -0.729619).  Saving model ...
Epoch: 19 cost time: 0.6070113182067871
Epoch: 19, Steps: 2 | Train Loss: 0.944 Vali Loss: 0.988 Vali Acc: 0.737 Test Loss: 0.988 Test Acc: 0.737
Validation loss decreased (-0.729619 --> -0.737027).  Saving model ...
Epoch: 20 cost time: 0.6416077613830566
Epoch: 20, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.947 Vali Acc: 0.763 Test Loss: 0.947 Test Acc: 0.763
Validation loss decreased (-0.737027 --> -0.762953).  Saving model ...
Epoch: 21 cost time: 0.6951239109039307
Epoch: 21, Steps: 2 | Train Loss: 0.914 Vali Loss: 0.908 Vali Acc: 0.774 Test Loss: 0.908 Test Acc: 0.774
Validation loss decreased (-0.762953 --> -0.774065).  Saving model ...
Epoch: 22 cost time: 0.5999341011047363
Epoch: 22, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.870 Vali Acc: 0.793 Test Loss: 0.870 Test Acc: 0.793
Validation loss decreased (-0.774065 --> -0.792584).  Saving model ...
Epoch: 23 cost time: 0.6038897037506104
Epoch: 23, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.831 Vali Acc: 0.822 Test Loss: 0.831 Test Acc: 0.822
Validation loss decreased (-0.792584 --> -0.822214).  Saving model ...
Epoch: 24 cost time: 0.6686663627624512
Epoch: 24, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.795 Vali Acc: 0.833 Test Loss: 0.795 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833325).  Saving model ...
Epoch: 25 cost time: 0.6563670635223389
Epoch: 25, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.760 Vali Acc: 0.844 Test Loss: 0.760 Test Acc: 0.844
Validation loss decreased (-0.833325 --> -0.844437).  Saving model ...
Epoch: 26 cost time: 0.7612481117248535
Epoch: 26, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.726 Vali Acc: 0.852 Test Loss: 0.726 Test Acc: 0.852
Validation loss decreased (-0.844437 --> -0.851845).  Saving model ...
Epoch: 27 cost time: 0.6957411766052246
Epoch: 27, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.693 Vali Acc: 0.856 Test Loss: 0.693 Test Acc: 0.856
Validation loss decreased (-0.851845 --> -0.855549).  Saving model ...
Epoch: 28 cost time: 0.7711782455444336
Epoch: 28, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.662 Vali Acc: 0.859 Test Loss: 0.662 Test Acc: 0.859
Validation loss decreased (-0.855549 --> -0.859253).  Saving model ...
Epoch: 29 cost time: 0.6787199974060059
Epoch: 29, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.634 Vali Acc: 0.881 Test Loss: 0.634 Test Acc: 0.881
Validation loss decreased (-0.859253 --> -0.881475).  Saving model ...
Epoch: 30 cost time: 0.6839280128479004
Epoch: 30, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.606 Vali Acc: 0.893 Test Loss: 0.606 Test Acc: 0.893
Validation loss decreased (-0.881475 --> -0.892587).  Saving model ...
Epoch: 31 cost time: 0.6181070804595947
Epoch: 31, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.580 Vali Acc: 0.896 Test Loss: 0.580 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896290).  Saving model ...
Epoch: 32 cost time: 0.5828342437744141
Epoch: 32, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.556 Vali Acc: 0.896 Test Loss: 0.556 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896291).  Saving model ...
Epoch: 33 cost time: 0.6953258514404297
Epoch: 33, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.534 Vali Acc: 0.904 Test Loss: 0.534 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903698).  Saving model ...
Epoch: 34 cost time: 0.6087548732757568
Epoch: 34, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.512 Vali Acc: 0.922 Test Loss: 0.512 Test Acc: 0.922
Validation loss decreased (-0.903698 --> -0.922217).  Saving model ...
Epoch: 35 cost time: 0.6910710334777832
Epoch: 35, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.492 Vali Acc: 0.926 Test Loss: 0.492 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 36 cost time: 0.7136945724487305
Epoch: 36, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.472 Vali Acc: 0.926 Test Loss: 0.472 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 37 cost time: 0.6626291275024414
Epoch: 37, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.454 Vali Acc: 0.933 Test Loss: 0.454 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 38 cost time: 0.6880214214324951
Epoch: 38, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.438 Vali Acc: 0.933 Test Loss: 0.438 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 0.7058401107788086
Epoch: 39, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.423 Vali Acc: 0.933 Test Loss: 0.423 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 40 cost time: 0.6360452175140381
Epoch: 40, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.409 Vali Acc: 0.933 Test Loss: 0.409 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 41 cost time: 0.7397382259368896
Epoch: 41, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.396 Vali Acc: 0.937 Test Loss: 0.396 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 42 cost time: 0.6866617202758789
Epoch: 42, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.385 Vali Acc: 0.937 Test Loss: 0.385 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 43 cost time: 0.6336381435394287
Epoch: 43, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.374 Vali Acc: 0.933 Test Loss: 0.374 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6674401760101318
Epoch: 44, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.364 Vali Acc: 0.937 Test Loss: 0.364 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 45 cost time: 0.6318259239196777
Epoch: 45, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.355 Vali Acc: 0.941 Test Loss: 0.355 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 46 cost time: 0.618762731552124
Epoch: 46, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.347 Vali Acc: 0.944 Test Loss: 0.347 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 47 cost time: 0.6728589534759521
Epoch: 47, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.339 Vali Acc: 0.944 Test Loss: 0.339 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 48 cost time: 0.6222512722015381
Epoch: 48, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.332 Vali Acc: 0.944 Test Loss: 0.332 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 49 cost time: 0.630162239074707
Epoch: 49, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.326 Vali Acc: 0.944 Test Loss: 0.326 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 50 cost time: 0.6195950508117676
Epoch: 50, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.320 Vali Acc: 0.944 Test Loss: 0.320 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 51 cost time: 0.5516469478607178
Epoch: 51, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.315 Vali Acc: 0.944 Test Loss: 0.315 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 52 cost time: 0.5982239246368408
Epoch: 52, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.309 Vali Acc: 0.944 Test Loss: 0.309 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 53 cost time: 0.5242111682891846
Epoch: 53, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.304 Vali Acc: 0.937 Test Loss: 0.304 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6511104106903076
Epoch: 54, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.704601526260376
Epoch: 55, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6432929039001465
Epoch: 56, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.7075090408325195
Epoch: 57, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.7274670600891113
Epoch: 58, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6670849323272705
Epoch: 59, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.280 Vali Acc: 0.933 Test Loss: 0.280 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.6949763298034668
Epoch: 60, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.6339383125305176
Epoch: 61, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.7023789882659912
Epoch: 62, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 34038
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3958261013031006
Epoch: 1, Steps: 2 | Train Loss: 2.068 Vali Loss: 1.999 Vali Acc: 0.126 Test Loss: 1.999 Test Acc: 0.126
Validation loss decreased (inf --> -0.125906).  Saving model ...
Epoch: 2 cost time: 0.5822858810424805
Epoch: 2, Steps: 2 | Train Loss: 2.167 Vali Loss: 1.965 Vali Acc: 0.137 Test Loss: 1.965 Test Acc: 0.137
Validation loss decreased (-0.125906 --> -0.137017).  Saving model ...
Epoch: 3 cost time: 0.5834410190582275
Epoch: 3, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.939 Vali Acc: 0.152 Test Loss: 1.939 Test Acc: 0.152
Validation loss decreased (-0.137017 --> -0.151832).  Saving model ...
Epoch: 4 cost time: 0.656191349029541
Epoch: 4, Steps: 2 | Train Loss: 2.076 Vali Loss: 1.919 Vali Acc: 0.144 Test Loss: 1.919 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5680587291717529
Epoch: 5, Steps: 2 | Train Loss: 2.043 Vali Loss: 1.896 Vali Acc: 0.144 Test Loss: 1.896 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.728846549987793
Epoch: 6, Steps: 2 | Train Loss: 1.984 Vali Loss: 1.869 Vali Acc: 0.144 Test Loss: 1.869 Test Acc: 0.144
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5808329582214355
Epoch: 7, Steps: 2 | Train Loss: 2.165 Vali Loss: 1.840 Vali Acc: 0.156 Test Loss: 1.840 Test Acc: 0.156
Validation loss decreased (-0.151832 --> -0.155537).  Saving model ...
Epoch: 8 cost time: 0.5831103324890137
Epoch: 8, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.808 Vali Acc: 0.170 Test Loss: 1.808 Test Acc: 0.170
Validation loss decreased (-0.155537 --> -0.170352).  Saving model ...
Epoch: 9 cost time: 0.6557767391204834
Epoch: 9, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.774 Vali Acc: 0.178 Test Loss: 1.774 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177760).  Saving model ...
Epoch: 10 cost time: 0.7516541481018066
Epoch: 10, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.739 Vali Acc: 0.189 Test Loss: 1.739 Test Acc: 0.189
Validation loss decreased (-0.177760 --> -0.188871).  Saving model ...
Epoch: 11 cost time: 0.5717129707336426
Epoch: 11, Steps: 2 | Train Loss: 1.881 Vali Loss: 1.702 Vali Acc: 0.215 Test Loss: 1.702 Test Acc: 0.215
Validation loss decreased (-0.188871 --> -0.214798).  Saving model ...
Epoch: 12 cost time: 0.6691896915435791
Epoch: 12, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.663 Vali Acc: 0.244 Test Loss: 1.663 Test Acc: 0.244
Validation loss decreased (-0.214798 --> -0.244428).  Saving model ...
Epoch: 13 cost time: 0.6387550830841064
Epoch: 13, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.621 Vali Acc: 0.293 Test Loss: 1.621 Test Acc: 0.293
Validation loss decreased (-0.244428 --> -0.292576).  Saving model ...
Epoch: 14 cost time: 0.5329842567443848
Epoch: 14, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.579 Vali Acc: 0.344 Test Loss: 1.579 Test Acc: 0.344
Validation loss decreased (-0.292576 --> -0.344429).  Saving model ...
Epoch: 15 cost time: 0.581648588180542
Epoch: 15, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.535 Vali Acc: 0.419 Test Loss: 1.535 Test Acc: 0.419
Validation loss decreased (-0.344429 --> -0.418503).  Saving model ...
Epoch: 16 cost time: 0.5694942474365234
Epoch: 16, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.490 Vali Acc: 0.456 Test Loss: 1.490 Test Acc: 0.456
Validation loss decreased (-0.418503 --> -0.455541).  Saving model ...
Epoch: 17 cost time: 0.6228609085083008
Epoch: 17, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.445 Vali Acc: 0.504 Test Loss: 1.445 Test Acc: 0.504
Validation loss decreased (-0.455541 --> -0.503689).  Saving model ...
Epoch: 18 cost time: 0.5306432247161865
Epoch: 18, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.400 Vali Acc: 0.530 Test Loss: 1.400 Test Acc: 0.530
Validation loss decreased (-0.503689 --> -0.529616).  Saving model ...
Epoch: 19 cost time: 0.6186652183532715
Epoch: 19, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.355 Vali Acc: 0.563 Test Loss: 1.355 Test Acc: 0.563
Validation loss decreased (-0.529616 --> -0.562949).  Saving model ...
Epoch: 20 cost time: 0.5799815654754639
Epoch: 20, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.310 Vali Acc: 0.593 Test Loss: 1.310 Test Acc: 0.593
Validation loss decreased (-0.562949 --> -0.592579).  Saving model ...
Epoch: 21 cost time: 0.6495981216430664
Epoch: 21, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.265 Vali Acc: 0.611 Test Loss: 1.265 Test Acc: 0.611
Validation loss decreased (-0.592579 --> -0.611098).  Saving model ...
Epoch: 22 cost time: 0.64150071144104
Epoch: 22, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.221 Vali Acc: 0.626 Test Loss: 1.221 Test Acc: 0.626
Validation loss decreased (-0.611098 --> -0.625914).  Saving model ...
Epoch: 23 cost time: 0.5427112579345703
Epoch: 23, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.180 Vali Acc: 0.667 Test Loss: 1.180 Test Acc: 0.667
Validation loss decreased (-0.625914 --> -0.666655).  Saving model ...
Epoch: 24 cost time: 0.6567568778991699
Epoch: 24, Steps: 2 | Train Loss: 1.110 Vali Loss: 1.138 Vali Acc: 0.689 Test Loss: 1.138 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688878).  Saving model ...
Epoch: 25 cost time: 0.7916443347930908
Epoch: 25, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.096 Vali Acc: 0.711 Test Loss: 1.096 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711100).  Saving model ...
Epoch: 26 cost time: 0.682807445526123
Epoch: 26, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.055 Vali Acc: 0.737 Test Loss: 1.055 Test Acc: 0.737
Validation loss decreased (-0.711100 --> -0.737026).  Saving model ...
Epoch: 27 cost time: 0.5898122787475586
Epoch: 27, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.015 Vali Acc: 0.748 Test Loss: 1.015 Test Acc: 0.748
Validation loss decreased (-0.737026 --> -0.748138).  Saving model ...
Epoch: 28 cost time: 0.6097934246063232
Epoch: 28, Steps: 2 | Train Loss: 0.976 Vali Loss: 0.978 Vali Acc: 0.770 Test Loss: 0.978 Test Acc: 0.770
Validation loss decreased (-0.748138 --> -0.770361).  Saving model ...
Epoch: 29 cost time: 0.5879635810852051
Epoch: 29, Steps: 2 | Train Loss: 1.055 Vali Loss: 0.941 Vali Acc: 0.763 Test Loss: 0.941 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6880137920379639
Epoch: 30, Steps: 2 | Train Loss: 0.969 Vali Loss: 0.905 Vali Acc: 0.770 Test Loss: 0.905 Test Acc: 0.770
Validation loss decreased (-0.770361 --> -0.770361).  Saving model ...
Epoch: 31 cost time: 0.6022744178771973
Epoch: 31, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.871 Vali Acc: 0.781 Test Loss: 0.871 Test Acc: 0.781
Validation loss decreased (-0.770361 --> -0.781473).  Saving model ...
Epoch: 32 cost time: 0.591111421585083
Epoch: 32, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.838 Vali Acc: 0.804 Test Loss: 0.838 Test Acc: 0.804
Validation loss decreased (-0.781473 --> -0.803695).  Saving model ...
Epoch: 33 cost time: 0.5997865200042725
Epoch: 33, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.807 Vali Acc: 0.807 Test Loss: 0.807 Test Acc: 0.807
Validation loss decreased (-0.803695 --> -0.807399).  Saving model ...
Epoch: 34 cost time: 0.6025481224060059
Epoch: 34, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.778 Vali Acc: 0.811 Test Loss: 0.778 Test Acc: 0.811
Validation loss decreased (-0.807399 --> -0.811103).  Saving model ...
Epoch: 35 cost time: 0.6333587169647217
Epoch: 35, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.749 Vali Acc: 0.815 Test Loss: 0.749 Test Acc: 0.815
Validation loss decreased (-0.811103 --> -0.814807).  Saving model ...
Epoch: 36 cost time: 0.6257987022399902
Epoch: 36, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.722 Vali Acc: 0.819 Test Loss: 0.722 Test Acc: 0.819
Validation loss decreased (-0.814807 --> -0.818511).  Saving model ...
Epoch: 37 cost time: 0.6741485595703125
Epoch: 37, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.696 Vali Acc: 0.830 Test Loss: 0.696 Test Acc: 0.830
Validation loss decreased (-0.818511 --> -0.829623).  Saving model ...
Epoch: 38 cost time: 0.6119551658630371
Epoch: 38, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.672 Vali Acc: 0.841 Test Loss: 0.672 Test Acc: 0.841
Validation loss decreased (-0.829623 --> -0.840734).  Saving model ...
Epoch: 39 cost time: 0.6619455814361572
Epoch: 39, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.648 Vali Acc: 0.848 Test Loss: 0.648 Test Acc: 0.848
Validation loss decreased (-0.840734 --> -0.848142).  Saving model ...
Epoch: 40 cost time: 0.5785834789276123
Epoch: 40, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.626 Vali Acc: 0.852 Test Loss: 0.626 Test Acc: 0.852
Validation loss decreased (-0.848142 --> -0.851846).  Saving model ...
Epoch: 41 cost time: 0.5778243541717529
Epoch: 41, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.605 Vali Acc: 0.852 Test Loss: 0.605 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 42 cost time: 0.5692877769470215
Epoch: 42, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 43 cost time: 0.5680580139160156
Epoch: 43, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.568 Vali Acc: 0.863 Test Loss: 0.568 Test Acc: 0.863
Validation loss decreased (-0.855550 --> -0.862957).  Saving model ...
Epoch: 44 cost time: 0.5373923778533936
Epoch: 44, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.551 Vali Acc: 0.859 Test Loss: 0.551 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5364272594451904
Epoch: 45, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.537 Vali Acc: 0.870 Test Loss: 0.537 Test Acc: 0.870
Validation loss decreased (-0.862957 --> -0.870365).  Saving model ...
Epoch: 46 cost time: 0.49008846282958984
Epoch: 46, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.521 Vali Acc: 0.874 Test Loss: 0.521 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 47 cost time: 0.569115400314331
Epoch: 47, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.506 Vali Acc: 0.889 Test Loss: 0.506 Test Acc: 0.889
Validation loss decreased (-0.874069 --> -0.888884).  Saving model ...
Epoch: 48 cost time: 0.6981406211853027
Epoch: 48, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.493 Vali Acc: 0.893 Test Loss: 0.493 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 49 cost time: 0.609215497970581
Epoch: 49, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.481 Vali Acc: 0.896 Test Loss: 0.481 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896291).  Saving model ...
Epoch: 50 cost time: 0.6647875308990479
Epoch: 50, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.470 Vali Acc: 0.896 Test Loss: 0.470 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 51 cost time: 0.5612888336181641
Epoch: 51, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899995).  Saving model ...
Epoch: 52 cost time: 0.7039918899536133
Epoch: 52, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.450 Vali Acc: 0.904 Test Loss: 0.450 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 53 cost time: 0.5986008644104004
Epoch: 53, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.441 Vali Acc: 0.907 Test Loss: 0.441 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 54 cost time: 0.6033875942230225
Epoch: 54, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.432 Vali Acc: 0.911 Test Loss: 0.432 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 55 cost time: 0.6512548923492432
Epoch: 55, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.424 Vali Acc: 0.919 Test Loss: 0.424 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918514).  Saving model ...
Epoch: 56 cost time: 0.6335527896881104
Epoch: 56, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.416 Vali Acc: 0.922 Test Loss: 0.416 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 57 cost time: 0.6902287006378174
Epoch: 57, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.409 Vali Acc: 0.919 Test Loss: 0.409 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6957557201385498
Epoch: 58, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.402 Vali Acc: 0.911 Test Loss: 0.402 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5607638359069824
Epoch: 59, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.395 Vali Acc: 0.915 Test Loss: 0.395 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.714564323425293
Epoch: 60, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.389 Vali Acc: 0.915 Test Loss: 0.389 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8243241310119629
Epoch: 61, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.383 Vali Acc: 0.915 Test Loss: 0.383 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.8057639598846436
Epoch: 62, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.378 Vali Acc: 0.911 Test Loss: 0.378 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.7084429264068604
Epoch: 63, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.373 Vali Acc: 0.911 Test Loss: 0.373 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.6452033519744873
Epoch: 64, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.368 Vali Acc: 0.911 Test Loss: 0.368 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.6684277057647705
Epoch: 65, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.363 Vali Acc: 0.915 Test Loss: 0.363 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.7184019088745117
Epoch: 66, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.360 Vali Acc: 0.915 Test Loss: 0.360 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 32550
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4107961654663086
Epoch: 1, Steps: 2 | Train Loss: 2.007 Vali Loss: 1.877 Vali Acc: 0.167 Test Loss: 1.877 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.639937162399292
Epoch: 2, Steps: 2 | Train Loss: 2.066 Vali Loss: 1.865 Vali Acc: 0.174 Test Loss: 1.865 Test Acc: 0.174
Validation loss decreased (-0.166648 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 0.6172797679901123
Epoch: 3, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.857 Vali Acc: 0.185 Test Loss: 1.857 Test Acc: 0.185
Validation loss decreased (-0.174055 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 0.5682113170623779
Epoch: 4, Steps: 2 | Train Loss: 2.008 Vali Loss: 1.850 Vali Acc: 0.163 Test Loss: 1.850 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6906914710998535
Epoch: 5, Steps: 2 | Train Loss: 1.994 Vali Loss: 1.841 Vali Acc: 0.167 Test Loss: 1.841 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5726602077484131
Epoch: 6, Steps: 2 | Train Loss: 1.943 Vali Loss: 1.828 Vali Acc: 0.170 Test Loss: 1.828 Test Acc: 0.170
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6617147922515869
Epoch: 7, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.813 Vali Acc: 0.185 Test Loss: 1.813 Test Acc: 0.185
Validation loss decreased (-0.185167 --> -0.185167).  Saving model ...
Epoch: 8 cost time: 0.5548222064971924
Epoch: 8, Steps: 2 | Train Loss: 1.966 Vali Loss: 1.794 Vali Acc: 0.181 Test Loss: 1.794 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6120815277099609
Epoch: 9, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.772 Vali Acc: 0.211 Test Loss: 1.772 Test Acc: 0.211
Validation loss decreased (-0.185167 --> -0.211093).  Saving model ...
Epoch: 10 cost time: 0.6367552280426025
Epoch: 10, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.748 Vali Acc: 0.241 Test Loss: 1.748 Test Acc: 0.241
Validation loss decreased (-0.211093 --> -0.240723).  Saving model ...
Epoch: 11 cost time: 0.5887479782104492
Epoch: 11, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.721 Vali Acc: 0.274 Test Loss: 1.721 Test Acc: 0.274
Validation loss decreased (-0.240723 --> -0.274057).  Saving model ...
Epoch: 12 cost time: 0.6079740524291992
Epoch: 12, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.693 Vali Acc: 0.300 Test Loss: 1.693 Test Acc: 0.300
Validation loss decreased (-0.274057 --> -0.299983).  Saving model ...
Epoch: 13 cost time: 0.6474580764770508
Epoch: 13, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.663 Vali Acc: 0.319 Test Loss: 1.663 Test Acc: 0.319
Validation loss decreased (-0.299983 --> -0.318502).  Saving model ...
Epoch: 14 cost time: 0.634742259979248
Epoch: 14, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.632 Vali Acc: 0.363 Test Loss: 1.632 Test Acc: 0.363
Validation loss decreased (-0.318502 --> -0.362947).  Saving model ...
Epoch: 15 cost time: 0.6271719932556152
Epoch: 15, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.600 Vali Acc: 0.411 Test Loss: 1.600 Test Acc: 0.411
Validation loss decreased (-0.362947 --> -0.411095).  Saving model ...
Epoch: 16 cost time: 0.6248378753662109
Epoch: 16, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.567 Vali Acc: 0.474 Test Loss: 1.567 Test Acc: 0.474
Validation loss decreased (-0.411095 --> -0.474058).  Saving model ...
Epoch: 17 cost time: 0.6349551677703857
Epoch: 17, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.533 Vali Acc: 0.522 Test Loss: 1.533 Test Acc: 0.522
Validation loss decreased (-0.474058 --> -0.522207).  Saving model ...
Epoch: 18 cost time: 0.6508257389068604
Epoch: 18, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.499 Vali Acc: 0.563 Test Loss: 1.499 Test Acc: 0.563
Validation loss decreased (-0.522207 --> -0.562948).  Saving model ...
Epoch: 19 cost time: 0.6978700160980225
Epoch: 19, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.462 Vali Acc: 0.578 Test Loss: 1.462 Test Acc: 0.578
Validation loss decreased (-0.562948 --> -0.577763).  Saving model ...
Epoch: 20 cost time: 0.5990021228790283
Epoch: 20, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.425 Vali Acc: 0.607 Test Loss: 1.425 Test Acc: 0.607
Validation loss decreased (-0.577763 --> -0.607393).  Saving model ...
Epoch: 21 cost time: 0.636268138885498
Epoch: 21, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.389 Vali Acc: 0.630 Test Loss: 1.389 Test Acc: 0.630
Validation loss decreased (-0.607393 --> -0.629616).  Saving model ...
Epoch: 22 cost time: 0.6296834945678711
Epoch: 22, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.351 Vali Acc: 0.652 Test Loss: 1.351 Test Acc: 0.652
Validation loss decreased (-0.629616 --> -0.651838).  Saving model ...
Epoch: 23 cost time: 0.7361011505126953
Epoch: 23, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.313 Vali Acc: 0.670 Test Loss: 1.313 Test Acc: 0.670
Validation loss decreased (-0.651838 --> -0.670357).  Saving model ...
Epoch: 24 cost time: 0.6679613590240479
Epoch: 24, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.275 Vali Acc: 0.681 Test Loss: 1.275 Test Acc: 0.681
Validation loss decreased (-0.670357 --> -0.681469).  Saving model ...
Epoch: 25 cost time: 0.7594015598297119
Epoch: 25, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.236 Vali Acc: 0.700 Test Loss: 1.236 Test Acc: 0.700
Validation loss decreased (-0.681469 --> -0.699988).  Saving model ...
Epoch: 26 cost time: 0.8076281547546387
Epoch: 26, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.200 Vali Acc: 0.711 Test Loss: 1.200 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711099).  Saving model ...
Epoch: 27 cost time: 0.7420556545257568
Epoch: 27, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.164 Vali Acc: 0.722 Test Loss: 1.164 Test Acc: 0.722
Validation loss decreased (-0.711099 --> -0.722211).  Saving model ...
Epoch: 28 cost time: 0.6220607757568359
Epoch: 28, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.127 Vali Acc: 0.726 Test Loss: 1.127 Test Acc: 0.726
Validation loss decreased (-0.722211 --> -0.725915).  Saving model ...
Epoch: 29 cost time: 0.6572651863098145
Epoch: 29, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.090 Vali Acc: 0.741 Test Loss: 1.090 Test Acc: 0.741
Validation loss decreased (-0.725915 --> -0.740730).  Saving model ...
Epoch: 30 cost time: 0.6975579261779785
Epoch: 30, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.053 Vali Acc: 0.770 Test Loss: 1.053 Test Acc: 0.770
Validation loss decreased (-0.740730 --> -0.770360).  Saving model ...
Epoch: 31 cost time: 0.6326510906219482
Epoch: 31, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.016 Vali Acc: 0.781 Test Loss: 1.016 Test Acc: 0.781
Validation loss decreased (-0.770360 --> -0.781471).  Saving model ...
Epoch: 32 cost time: 0.5825634002685547
Epoch: 32, Steps: 2 | Train Loss: 0.988 Vali Loss: 0.980 Vali Acc: 0.800 Test Loss: 0.980 Test Acc: 0.800
Validation loss decreased (-0.781471 --> -0.799990).  Saving model ...
Epoch: 33 cost time: 0.7333967685699463
Epoch: 33, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.944 Vali Acc: 0.807 Test Loss: 0.944 Test Acc: 0.807
Validation loss decreased (-0.799990 --> -0.807398).  Saving model ...
Epoch: 34 cost time: 0.7611324787139893
Epoch: 34, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.908 Vali Acc: 0.811 Test Loss: 0.908 Test Acc: 0.811
Validation loss decreased (-0.807398 --> -0.811102).  Saving model ...
Epoch: 35 cost time: 0.8482625484466553
Epoch: 35, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.875 Vali Acc: 0.819 Test Loss: 0.875 Test Acc: 0.819
Validation loss decreased (-0.811102 --> -0.818510).  Saving model ...
Epoch: 36 cost time: 0.7671496868133545
Epoch: 36, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.843 Vali Acc: 0.826 Test Loss: 0.843 Test Acc: 0.826
Validation loss decreased (-0.818510 --> -0.825917).  Saving model ...
Epoch: 37 cost time: 0.5916399955749512
Epoch: 37, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.812 Vali Acc: 0.826 Test Loss: 0.812 Test Acc: 0.826
Validation loss decreased (-0.825917 --> -0.825918).  Saving model ...
Epoch: 38 cost time: 0.624335527420044
Epoch: 38, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.783 Vali Acc: 0.830 Test Loss: 0.783 Test Acc: 0.830
Validation loss decreased (-0.825918 --> -0.829622).  Saving model ...
Epoch: 39 cost time: 0.6439974308013916
Epoch: 39, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.755 Vali Acc: 0.841 Test Loss: 0.755 Test Acc: 0.841
Validation loss decreased (-0.829622 --> -0.840733).  Saving model ...
Epoch: 40 cost time: 0.6527111530303955
Epoch: 40, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.729 Vali Acc: 0.841 Test Loss: 0.729 Test Acc: 0.841
Validation loss decreased (-0.840733 --> -0.840733).  Saving model ...
Epoch: 41 cost time: 0.5714819431304932
Epoch: 41, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.706 Vali Acc: 0.844 Test Loss: 0.706 Test Acc: 0.844
Validation loss decreased (-0.840733 --> -0.844437).  Saving model ...
Epoch: 42 cost time: 0.5250213146209717
Epoch: 42, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.683 Vali Acc: 0.856 Test Loss: 0.683 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855549).  Saving model ...
Epoch: 43 cost time: 0.5817286968231201
Epoch: 43, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.661 Vali Acc: 0.859 Test Loss: 0.661 Test Acc: 0.859
Validation loss decreased (-0.855549 --> -0.859253).  Saving model ...
Epoch: 44 cost time: 0.5922794342041016
Epoch: 44, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.640 Vali Acc: 0.863 Test Loss: 0.640 Test Acc: 0.863
Validation loss decreased (-0.859253 --> -0.862957).  Saving model ...
Epoch: 45 cost time: 0.5842041969299316
Epoch: 45, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.620 Vali Acc: 0.863 Test Loss: 0.620 Test Acc: 0.863
Validation loss decreased (-0.862957 --> -0.862957).  Saving model ...
Epoch: 46 cost time: 0.5591607093811035
Epoch: 46, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866661).  Saving model ...
Epoch: 47 cost time: 0.5995211601257324
Epoch: 47, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.583 Vali Acc: 0.874 Test Loss: 0.583 Test Acc: 0.874
Validation loss decreased (-0.866661 --> -0.874068).  Saving model ...
Epoch: 48 cost time: 0.8292529582977295
Epoch: 48, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.565 Vali Acc: 0.881 Test Loss: 0.565 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 49 cost time: 0.6611502170562744
Epoch: 49, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.550 Vali Acc: 0.881 Test Loss: 0.550 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 50 cost time: 0.6325984001159668
Epoch: 50, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.535 Vali Acc: 0.889 Test Loss: 0.535 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 51 cost time: 0.6456830501556396
Epoch: 51, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.520 Vali Acc: 0.893 Test Loss: 0.520 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892587).  Saving model ...
Epoch: 52 cost time: 0.6490492820739746
Epoch: 52, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 0.5760657787322998
Epoch: 53, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.495 Vali Acc: 0.904 Test Loss: 0.495 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 54 cost time: 0.6490039825439453
Epoch: 54, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.483 Vali Acc: 0.911 Test Loss: 0.483 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911106).  Saving model ...
Epoch: 55 cost time: 0.6234431266784668
Epoch: 55, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.471 Vali Acc: 0.919 Test Loss: 0.471 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 56 cost time: 0.7102615833282471
Epoch: 56, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.461 Vali Acc: 0.926 Test Loss: 0.461 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925921).  Saving model ...
Epoch: 57 cost time: 0.7360644340515137
Epoch: 57, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.451 Vali Acc: 0.930 Test Loss: 0.451 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 58 cost time: 0.6785199642181396
Epoch: 58, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.442 Vali Acc: 0.933 Test Loss: 0.442 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 59 cost time: 0.6683800220489502
Epoch: 59, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.433 Vali Acc: 0.933 Test Loss: 0.433 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 60 cost time: 0.678722620010376
Epoch: 60, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.424 Vali Acc: 0.933 Test Loss: 0.424 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 61 cost time: 0.5387358665466309
Epoch: 61, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.416 Vali Acc: 0.930 Test Loss: 0.416 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6581137180328369
Epoch: 62, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.409 Vali Acc: 0.933 Test Loss: 0.409 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 63 cost time: 0.6768968105316162
Epoch: 63, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.401 Vali Acc: 0.937 Test Loss: 0.401 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 64 cost time: 0.678903341293335
Epoch: 64, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.395 Vali Acc: 0.937 Test Loss: 0.395 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 65 cost time: 0.7634909152984619
Epoch: 65, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.388 Vali Acc: 0.937 Test Loss: 0.388 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 66 cost time: 0.6728408336639404
Epoch: 66, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.382 Vali Acc: 0.937 Test Loss: 0.382 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 67 cost time: 0.684363603591919
Epoch: 67, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.376 Vali Acc: 0.941 Test Loss: 0.376 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 68 cost time: 0.6732017993927002
Epoch: 68, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.371 Vali Acc: 0.941 Test Loss: 0.371 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 69 cost time: 0.6474082469940186
Epoch: 69, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.366 Vali Acc: 0.941 Test Loss: 0.366 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 70 cost time: 0.569218635559082
Epoch: 70, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.361 Vali Acc: 0.941 Test Loss: 0.361 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 71 cost time: 0.5752179622650146
Epoch: 71, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.357 Vali Acc: 0.937 Test Loss: 0.357 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6390082836151123
Epoch: 72, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.352 Vali Acc: 0.941 Test Loss: 0.352 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 73 cost time: 0.6340203285217285
Epoch: 73, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.348 Vali Acc: 0.941 Test Loss: 0.348 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 74 cost time: 0.592282772064209
Epoch: 74, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.343 Vali Acc: 0.948 Test Loss: 0.343 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 75 cost time: 0.49034929275512695
Epoch: 75, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.338 Vali Acc: 0.948 Test Loss: 0.338 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 76 cost time: 0.6476306915283203
Epoch: 76, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.332 Vali Acc: 0.952 Test Loss: 0.332 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 77 cost time: 0.7210397720336914
Epoch: 77, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.329 Vali Acc: 0.948 Test Loss: 0.329 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.6316382884979248
Epoch: 78, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.324 Vali Acc: 0.948 Test Loss: 0.324 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.6338894367218018
Epoch: 79, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.321 Vali Acc: 0.948 Test Loss: 0.321 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.6194260120391846
Epoch: 80, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.316 Vali Acc: 0.948 Test Loss: 0.316 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.6446831226348877
Epoch: 81, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.312 Vali Acc: 0.948 Test Loss: 0.312 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.6761636734008789
Epoch: 82, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.309 Vali Acc: 0.952 Test Loss: 0.309 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 83 cost time: 0.7244877815246582
Epoch: 83, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.305 Vali Acc: 0.952 Test Loss: 0.305 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 84 cost time: 0.671405553817749
Epoch: 84, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.302 Vali Acc: 0.952 Test Loss: 0.302 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 85 cost time: 0.7293086051940918
Epoch: 85, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.298 Vali Acc: 0.956 Test Loss: 0.298 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 86 cost time: 0.6056210994720459
Epoch: 86, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.294 Vali Acc: 0.956 Test Loss: 0.294 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 87 cost time: 0.6517643928527832
Epoch: 87, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.290 Vali Acc: 0.956 Test Loss: 0.290 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 88 cost time: 0.6537866592407227
Epoch: 88, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.287 Vali Acc: 0.956 Test Loss: 0.287 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 89 cost time: 0.675487756729126
Epoch: 89, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.284 Vali Acc: 0.956 Test Loss: 0.284 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 90 cost time: 0.7747149467468262
Epoch: 90, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.281 Vali Acc: 0.956 Test Loss: 0.281 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 91 cost time: 0.6598532199859619
Epoch: 91, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.279 Vali Acc: 0.956 Test Loss: 0.279 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 92 cost time: 0.6832141876220703
Epoch: 92, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.277 Vali Acc: 0.956 Test Loss: 0.277 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 93 cost time: 0.6206824779510498
Epoch: 93, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.274 Vali Acc: 0.956 Test Loss: 0.274 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 94 cost time: 0.7030754089355469
Epoch: 94, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.273 Vali Acc: 0.952 Test Loss: 0.273 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.6278910636901855
Epoch: 95, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.271 Vali Acc: 0.952 Test Loss: 0.271 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.5534217357635498
Epoch: 96, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.268 Vali Acc: 0.956 Test Loss: 0.268 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 97 cost time: 0.7373802661895752
Epoch: 97, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.267 Vali Acc: 0.956 Test Loss: 0.267 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 98 cost time: 0.6039953231811523
Epoch: 98, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.264 Vali Acc: 0.956 Test Loss: 0.264 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 99 cost time: 0.6443920135498047
Epoch: 99, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.262 Vali Acc: 0.956 Test Loss: 0.262 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 100 cost time: 0.7053000926971436
Epoch: 100, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.260 Vali Acc: 0.952 Test Loss: 0.260 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 31846
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.462014675140381
Epoch: 1, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.699 Vali Acc: 0.378 Test Loss: 1.699 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 0.6438310146331787
Epoch: 2, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.640 Vali Acc: 0.422 Test Loss: 1.640 Test Acc: 0.422
Validation loss decreased (-0.377761 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 0.6422224044799805
Epoch: 3, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.589 Vali Acc: 0.444 Test Loss: 1.589 Test Acc: 0.444
Validation loss decreased (-0.422206 --> -0.444429).  Saving model ...
Epoch: 4 cost time: 0.7099401950836182
Epoch: 4, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.532 Vali Acc: 0.474 Test Loss: 1.532 Test Acc: 0.474
Validation loss decreased (-0.444429 --> -0.474059).  Saving model ...
Epoch: 5 cost time: 0.7345952987670898
Epoch: 5, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.464 Vali Acc: 0.500 Test Loss: 1.464 Test Acc: 0.500
Validation loss decreased (-0.474059 --> -0.499985).  Saving model ...
Epoch: 6 cost time: 0.7489216327667236
Epoch: 6, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.388 Vali Acc: 0.530 Test Loss: 1.388 Test Acc: 0.530
Validation loss decreased (-0.499985 --> -0.529616).  Saving model ...
Epoch: 7 cost time: 0.6907844543457031
Epoch: 7, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.305 Vali Acc: 0.559 Test Loss: 1.305 Test Acc: 0.559
Validation loss decreased (-0.529616 --> -0.559246).  Saving model ...
Epoch: 8 cost time: 0.7626042366027832
Epoch: 8, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.222 Vali Acc: 0.574 Test Loss: 1.222 Test Acc: 0.574
Validation loss decreased (-0.559246 --> -0.574062).  Saving model ...
Epoch: 9 cost time: 0.6544485092163086
Epoch: 9, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.137 Vali Acc: 0.619 Test Loss: 1.137 Test Acc: 0.619
Validation loss decreased (-0.574062 --> -0.618507).  Saving model ...
Epoch: 10 cost time: 0.8011062145233154
Epoch: 10, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.051 Vali Acc: 0.685 Test Loss: 1.051 Test Acc: 0.685
Validation loss decreased (-0.618507 --> -0.685175).  Saving model ...
Epoch: 11 cost time: 0.740929126739502
Epoch: 11, Steps: 2 | Train Loss: 0.938 Vali Loss: 0.968 Vali Acc: 0.730 Test Loss: 0.968 Test Acc: 0.730
Validation loss decreased (-0.685175 --> -0.729620).  Saving model ...
Epoch: 12 cost time: 0.7693459987640381
Epoch: 12, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.886 Vali Acc: 0.785 Test Loss: 0.886 Test Acc: 0.785
Validation loss decreased (-0.729620 --> -0.785176).  Saving model ...
Epoch: 13 cost time: 0.6723973751068115
Epoch: 13, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.810 Vali Acc: 0.837 Test Loss: 0.810 Test Acc: 0.837
Validation loss decreased (-0.785176 --> -0.837029).  Saving model ...
Epoch: 14 cost time: 0.6473884582519531
Epoch: 14, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.738 Vali Acc: 0.856 Test Loss: 0.738 Test Acc: 0.856
Validation loss decreased (-0.837029 --> -0.855548).  Saving model ...
Epoch: 15 cost time: 0.6162528991699219
Epoch: 15, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.671 Vali Acc: 0.881 Test Loss: 0.671 Test Acc: 0.881
Validation loss decreased (-0.855548 --> -0.881475).  Saving model ...
Epoch: 16 cost time: 0.6765973567962646
Epoch: 16, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.611 Vali Acc: 0.900 Test Loss: 0.611 Test Acc: 0.900
Validation loss decreased (-0.881475 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.729576826095581
Epoch: 17, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.559 Vali Acc: 0.904 Test Loss: 0.559 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 18 cost time: 0.6108360290527344
Epoch: 18, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.512 Vali Acc: 0.907 Test Loss: 0.512 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 19 cost time: 0.7285525798797607
Epoch: 19, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.468 Vali Acc: 0.922 Test Loss: 0.468 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922218).  Saving model ...
Epoch: 20 cost time: 0.5683832168579102
Epoch: 20, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.429 Vali Acc: 0.930 Test Loss: 0.429 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929625).  Saving model ...
Epoch: 21 cost time: 0.5762031078338623
Epoch: 21, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.395 Vali Acc: 0.926 Test Loss: 0.395 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6439642906188965
Epoch: 22, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.366 Vali Acc: 0.933 Test Loss: 0.366 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933330).  Saving model ...
Epoch: 23 cost time: 0.6136445999145508
Epoch: 23, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.338 Vali Acc: 0.926 Test Loss: 0.338 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6357944011688232
Epoch: 24, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.316 Vali Acc: 0.926 Test Loss: 0.316 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6053729057312012
Epoch: 25, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6562809944152832
Epoch: 26, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.271 Vali Acc: 0.937 Test Loss: 0.271 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 27 cost time: 0.663644552230835
Epoch: 27, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
Validation loss decreased (-0.937034 --> -0.951849).  Saving model ...
Epoch: 28 cost time: 0.7390632629394531
Epoch: 28, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 29 cost time: 0.5960185527801514
Epoch: 29, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.5604822635650635
Epoch: 30, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6189062595367432
Epoch: 31, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6900982856750488
Epoch: 32, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7215001583099365
Epoch: 33, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.639970064163208
Epoch: 34, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6829085350036621
Epoch: 35, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7869296073913574
Epoch: 36, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8658163547515869
Epoch: 37, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7029833793640137
Epoch: 38, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.177 Vali Acc: 0.926 Test Loss: 0.177 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6644208431243896
Epoch: 39, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 41206
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4031450748443604
Epoch: 1, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.790 Vali Acc: 0.230 Test Loss: 1.790 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.6651787757873535
Epoch: 2, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.741 Vali Acc: 0.252 Test Loss: 1.741 Test Acc: 0.252
Validation loss decreased (-0.229612 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.6251296997070312
Epoch: 3, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.705 Vali Acc: 0.293 Test Loss: 1.705 Test Acc: 0.293
Validation loss decreased (-0.251834 --> -0.292576).  Saving model ...
Epoch: 4 cost time: 0.7190015316009521
Epoch: 4, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.672 Vali Acc: 0.307 Test Loss: 1.672 Test Acc: 0.307
Validation loss decreased (-0.292576 --> -0.307391).  Saving model ...
Epoch: 5 cost time: 0.5661072731018066
Epoch: 5, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.634 Vali Acc: 0.333 Test Loss: 1.634 Test Acc: 0.333
Validation loss decreased (-0.307391 --> -0.333317).  Saving model ...
Epoch: 6 cost time: 0.6195783615112305
Epoch: 6, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.590 Vali Acc: 0.359 Test Loss: 1.590 Test Acc: 0.359
Validation loss decreased (-0.333317 --> -0.359243).  Saving model ...
Epoch: 7 cost time: 0.554497241973877
Epoch: 7, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.542 Vali Acc: 0.385 Test Loss: 1.542 Test Acc: 0.385
Validation loss decreased (-0.359243 --> -0.385170).  Saving model ...
Epoch: 8 cost time: 0.6056878566741943
Epoch: 8, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.489 Vali Acc: 0.448 Test Loss: 1.489 Test Acc: 0.448
Validation loss decreased (-0.385170 --> -0.448133).  Saving model ...
Epoch: 9 cost time: 0.47753143310546875
Epoch: 9, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.431 Vali Acc: 0.511 Test Loss: 1.431 Test Acc: 0.511
Validation loss decreased (-0.448133 --> -0.511097).  Saving model ...
Epoch: 10 cost time: 0.45148301124572754
Epoch: 10, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.370 Vali Acc: 0.604 Test Loss: 1.370 Test Acc: 0.604
Validation loss decreased (-0.511097 --> -0.603690).  Saving model ...
Epoch: 11 cost time: 0.5201375484466553
Epoch: 11, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.308 Vali Acc: 0.656 Test Loss: 1.308 Test Acc: 0.656
Validation loss decreased (-0.603690 --> -0.655542).  Saving model ...
Epoch: 12 cost time: 0.5147209167480469
Epoch: 12, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.244 Vali Acc: 0.689 Test Loss: 1.244 Test Acc: 0.689
Validation loss decreased (-0.655542 --> -0.688876).  Saving model ...
Epoch: 13 cost time: 0.5643665790557861
Epoch: 13, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.180 Vali Acc: 0.741 Test Loss: 1.180 Test Acc: 0.741
Validation loss decreased (-0.688876 --> -0.740729).  Saving model ...
Epoch: 14 cost time: 0.6053340435028076
Epoch: 14, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.117 Vali Acc: 0.767 Test Loss: 1.117 Test Acc: 0.767
Validation loss decreased (-0.740729 --> -0.766655).  Saving model ...
Epoch: 15 cost time: 0.6297802925109863
Epoch: 15, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.054 Vali Acc: 0.785 Test Loss: 1.054 Test Acc: 0.785
Validation loss decreased (-0.766655 --> -0.785175).  Saving model ...
Epoch: 16 cost time: 0.5451333522796631
Epoch: 16, Steps: 2 | Train Loss: 0.941 Vali Loss: 0.993 Vali Acc: 0.815 Test Loss: 0.993 Test Acc: 0.815
Validation loss decreased (-0.785175 --> -0.814805).  Saving model ...
Epoch: 17 cost time: 0.659534215927124
Epoch: 17, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.934 Vali Acc: 0.819 Test Loss: 0.934 Test Acc: 0.819
Validation loss decreased (-0.814805 --> -0.818509).  Saving model ...
Epoch: 18 cost time: 0.6056609153747559
Epoch: 18, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.877 Vali Acc: 0.826 Test Loss: 0.877 Test Acc: 0.826
Validation loss decreased (-0.818509 --> -0.825917).  Saving model ...
Epoch: 19 cost time: 0.5776035785675049
Epoch: 19, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.825 Vali Acc: 0.848 Test Loss: 0.825 Test Acc: 0.848
Validation loss decreased (-0.825917 --> -0.848140).  Saving model ...
Epoch: 20 cost time: 0.6155283451080322
Epoch: 20, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.776 Vali Acc: 0.852 Test Loss: 0.776 Test Acc: 0.852
Validation loss decreased (-0.848140 --> -0.851844).  Saving model ...
Epoch: 21 cost time: 0.6193423271179199
Epoch: 21, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.729 Vali Acc: 0.859 Test Loss: 0.729 Test Acc: 0.859
Validation loss decreased (-0.851844 --> -0.859252).  Saving model ...
Epoch: 22 cost time: 0.6310243606567383
Epoch: 22, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.686 Vali Acc: 0.859 Test Loss: 0.686 Test Acc: 0.859
Validation loss decreased (-0.859252 --> -0.859252).  Saving model ...
Epoch: 23 cost time: 0.6302468776702881
Epoch: 23, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.645 Vali Acc: 0.867 Test Loss: 0.645 Test Acc: 0.867
Validation loss decreased (-0.859252 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 0.6181797981262207
Epoch: 24, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 0.5756139755249023
Epoch: 25, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.568 Vali Acc: 0.878 Test Loss: 0.568 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 0.5971720218658447
Epoch: 26, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.533 Vali Acc: 0.889 Test Loss: 0.533 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888884).  Saving model ...
Epoch: 27 cost time: 0.6129183769226074
Epoch: 27, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.500 Vali Acc: 0.885 Test Loss: 0.500 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5849955081939697
Epoch: 28, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.471 Vali Acc: 0.885 Test Loss: 0.471 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5710105895996094
Epoch: 29, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.446 Vali Acc: 0.885 Test Loss: 0.446 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6028549671173096
Epoch: 30, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 31 cost time: 0.6734871864318848
Epoch: 31, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.402 Vali Acc: 0.896 Test Loss: 0.402 Test Acc: 0.896
Validation loss decreased (-0.888885 --> -0.896292).  Saving model ...
Epoch: 32 cost time: 0.5924532413482666
Epoch: 32, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.383 Vali Acc: 0.893 Test Loss: 0.383 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.665482759475708
Epoch: 33, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 0.5401902198791504
Epoch: 34, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 0.6845495700836182
Epoch: 35, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.338 Vali Acc: 0.911 Test Loss: 0.338 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911108).  Saving model ...
Epoch: 36 cost time: 0.49812817573547363
Epoch: 36, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.325 Vali Acc: 0.915 Test Loss: 0.325 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 37 cost time: 0.5814628601074219
Epoch: 37, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922219).  Saving model ...
Epoch: 38 cost time: 0.6408407688140869
Epoch: 38, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 39 cost time: 0.5776090621948242
Epoch: 39, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.6324703693389893
Epoch: 40, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 41 cost time: 0.5466513633728027
Epoch: 41, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.5057520866394043
Epoch: 42, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.5484986305236816
Epoch: 43, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.5969734191894531
Epoch: 44, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.5715765953063965
Epoch: 45, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 46 cost time: 0.597858190536499
Epoch: 46, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.6499307155609131
Epoch: 47, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.6583104133605957
Epoch: 48, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6430027484893799
Epoch: 49, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6481914520263672
Epoch: 50, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6596148014068604
Epoch: 51, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6091992855072021
Epoch: 52, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6211650371551514
Epoch: 53, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6613132953643799
Epoch: 54, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6118745803833008
Epoch: 55, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.6035833358764648
Epoch: 56, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.6689615249633789
Epoch: 57, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 28566
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.15008807182312
Epoch: 1, Steps: 2 | Train Loss: 2.020 Vali Loss: 1.788 Vali Acc: 0.196 Test Loss: 1.788 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.5702159404754639
Epoch: 2, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.755 Vali Acc: 0.207 Test Loss: 1.755 Test Acc: 0.207
Validation loss decreased (-0.196278 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.5544435977935791
Epoch: 3, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.728 Vali Acc: 0.211 Test Loss: 1.728 Test Acc: 0.211
Validation loss decreased (-0.207390 --> -0.211094).  Saving model ...
Epoch: 4 cost time: 0.5576238632202148
Epoch: 4, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.701 Vali Acc: 0.215 Test Loss: 1.701 Test Acc: 0.215
Validation loss decreased (-0.211094 --> -0.214798).  Saving model ...
Epoch: 5 cost time: 0.6280500888824463
Epoch: 5, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.667 Vali Acc: 0.233 Test Loss: 1.667 Test Acc: 0.233
Validation loss decreased (-0.214798 --> -0.233317).  Saving model ...
Epoch: 6 cost time: 0.5613076686859131
Epoch: 6, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.627 Vali Acc: 0.248 Test Loss: 1.627 Test Acc: 0.248
Validation loss decreased (-0.233317 --> -0.248132).  Saving model ...
Epoch: 7 cost time: 0.550145149230957
Epoch: 7, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.581 Vali Acc: 0.267 Test Loss: 1.581 Test Acc: 0.267
Validation loss decreased (-0.248132 --> -0.266651).  Saving model ...
Epoch: 8 cost time: 0.5381355285644531
Epoch: 8, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.531 Vali Acc: 0.330 Test Loss: 1.531 Test Acc: 0.330
Validation loss decreased (-0.266651 --> -0.329614).  Saving model ...
Epoch: 9 cost time: 0.5309586524963379
Epoch: 9, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.477 Vali Acc: 0.389 Test Loss: 1.477 Test Acc: 0.389
Validation loss decreased (-0.329614 --> -0.388874).  Saving model ...
Epoch: 10 cost time: 0.4821953773498535
Epoch: 10, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.418 Vali Acc: 0.485 Test Loss: 1.418 Test Acc: 0.485
Validation loss decreased (-0.388874 --> -0.485171).  Saving model ...
Epoch: 11 cost time: 0.5476367473602295
Epoch: 11, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.357 Vali Acc: 0.548 Test Loss: 1.357 Test Acc: 0.548
Validation loss decreased (-0.485171 --> -0.548135).  Saving model ...
Epoch: 12 cost time: 0.4932210445404053
Epoch: 12, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.294 Vali Acc: 0.619 Test Loss: 1.294 Test Acc: 0.619
Validation loss decreased (-0.548135 --> -0.618506).  Saving model ...
Epoch: 13 cost time: 0.6938340663909912
Epoch: 13, Steps: 2 | Train Loss: 1.210 Vali Loss: 1.230 Vali Acc: 0.693 Test Loss: 1.230 Test Acc: 0.693
Validation loss decreased (-0.618506 --> -0.692580).  Saving model ...
Epoch: 14 cost time: 0.6120560169219971
Epoch: 14, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.165 Vali Acc: 0.730 Test Loss: 1.165 Test Acc: 0.730
Validation loss decreased (-0.692580 --> -0.729618).  Saving model ...
Epoch: 15 cost time: 0.6670515537261963
Epoch: 15, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.102 Vali Acc: 0.759 Test Loss: 1.102 Test Acc: 0.759
Validation loss decreased (-0.729618 --> -0.759248).  Saving model ...
Epoch: 16 cost time: 0.7274301052093506
Epoch: 16, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.040 Vali Acc: 0.763 Test Loss: 1.040 Test Acc: 0.763
Validation loss decreased (-0.759248 --> -0.762953).  Saving model ...
Epoch: 17 cost time: 0.6334209442138672
Epoch: 17, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.979 Vali Acc: 0.796 Test Loss: 0.979 Test Acc: 0.796
Validation loss decreased (-0.762953 --> -0.796287).  Saving model ...
Epoch: 18 cost time: 0.5914173126220703
Epoch: 18, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.920 Vali Acc: 0.811 Test Loss: 0.920 Test Acc: 0.811
Validation loss decreased (-0.796287 --> -0.811102).  Saving model ...
Epoch: 19 cost time: 0.7465493679046631
Epoch: 19, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.864 Vali Acc: 0.822 Test Loss: 0.864 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822214).  Saving model ...
Epoch: 20 cost time: 0.651024580001831
Epoch: 20, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.811 Vali Acc: 0.837 Test Loss: 0.811 Test Acc: 0.837
Validation loss decreased (-0.822214 --> -0.837029).  Saving model ...
Epoch: 21 cost time: 0.6254291534423828
Epoch: 21, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.762 Vali Acc: 0.841 Test Loss: 0.762 Test Acc: 0.841
Validation loss decreased (-0.837029 --> -0.840733).  Saving model ...
Epoch: 22 cost time: 0.5913758277893066
Epoch: 22, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.718 Vali Acc: 0.863 Test Loss: 0.718 Test Acc: 0.863
Validation loss decreased (-0.840733 --> -0.862956).  Saving model ...
Epoch: 23 cost time: 0.6406192779541016
Epoch: 23, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.676 Vali Acc: 0.874 Test Loss: 0.676 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874067).  Saving model ...
Epoch: 24 cost time: 0.6334853172302246
Epoch: 24, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.637 Vali Acc: 0.878 Test Loss: 0.637 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877771).  Saving model ...
Epoch: 25 cost time: 0.5922479629516602
Epoch: 25, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.600 Vali Acc: 0.885 Test Loss: 0.600 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885179).  Saving model ...
Epoch: 26 cost time: 0.5976827144622803
Epoch: 26, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.565 Vali Acc: 0.904 Test Loss: 0.565 Test Acc: 0.904
Validation loss decreased (-0.885179 --> -0.903698).  Saving model ...
Epoch: 27 cost time: 0.7128684520721436
Epoch: 27, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.532 Vali Acc: 0.915 Test Loss: 0.532 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914809).  Saving model ...
Epoch: 28 cost time: 0.6876828670501709
Epoch: 28, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.502 Vali Acc: 0.911 Test Loss: 0.502 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6197381019592285
Epoch: 29, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.474 Vali Acc: 0.915 Test Loss: 0.474 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 30 cost time: 0.5761685371398926
Epoch: 30, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.448 Vali Acc: 0.922 Test Loss: 0.448 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 31 cost time: 0.5643413066864014
Epoch: 31, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.425 Vali Acc: 0.922 Test Loss: 0.425 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 32 cost time: 0.6282267570495605
Epoch: 32, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.404 Vali Acc: 0.922 Test Loss: 0.404 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 33 cost time: 0.5498981475830078
Epoch: 33, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.386 Vali Acc: 0.930 Test Loss: 0.386 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 34 cost time: 0.6088047027587891
Epoch: 34, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.369 Vali Acc: 0.937 Test Loss: 0.369 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937033).  Saving model ...
Epoch: 35 cost time: 0.6596167087554932
Epoch: 35, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.355 Vali Acc: 0.941 Test Loss: 0.355 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 36 cost time: 0.6474344730377197
Epoch: 36, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.342 Vali Acc: 0.941 Test Loss: 0.342 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 37 cost time: 0.6315581798553467
Epoch: 37, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.329 Vali Acc: 0.944 Test Loss: 0.329 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.6125619411468506
Epoch: 38, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.319 Vali Acc: 0.944 Test Loss: 0.319 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 39 cost time: 0.5661265850067139
Epoch: 39, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 40 cost time: 0.5866944789886475
Epoch: 40, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 41 cost time: 0.5912413597106934
Epoch: 41, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5794720649719238
Epoch: 42, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6293189525604248
Epoch: 43, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5790889263153076
Epoch: 44, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6028623580932617
Epoch: 45, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6640317440032959
Epoch: 46, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.686964750289917
Epoch: 47, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6873123645782471
Epoch: 48, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7374179363250732
Epoch: 49, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5751245021820068
Epoch: 50, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.6218781471252441
Epoch: 51, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.6713459491729736
Epoch: 52, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.7064955234527588
Epoch: 53, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 24742
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3642396926879883
Epoch: 1, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.895 Vali Acc: 0.181 Test Loss: 1.895 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.6042852401733398
Epoch: 2, Steps: 2 | Train Loss: 2.037 Vali Loss: 1.866 Vali Acc: 0.207 Test Loss: 1.866 Test Acc: 0.207
Validation loss decreased (-0.181463 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 0.5929453372955322
Epoch: 3, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.845 Vali Acc: 0.222 Test Loss: 1.845 Test Acc: 0.222
Validation loss decreased (-0.207389 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.5198125839233398
Epoch: 4, Steps: 2 | Train Loss: 2.077 Vali Loss: 1.826 Vali Acc: 0.237 Test Loss: 1.826 Test Acc: 0.237
Validation loss decreased (-0.222204 --> -0.237019).  Saving model ...
Epoch: 5 cost time: 0.581040620803833
Epoch: 5, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.801 Vali Acc: 0.252 Test Loss: 1.801 Test Acc: 0.252
Validation loss decreased (-0.237019 --> -0.251834).  Saving model ...
Epoch: 6 cost time: 0.5187020301818848
Epoch: 6, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.770 Vali Acc: 0.270 Test Loss: 1.770 Test Acc: 0.270
Validation loss decreased (-0.251834 --> -0.270353).  Saving model ...
Epoch: 7 cost time: 0.6094985008239746
Epoch: 7, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.734 Vali Acc: 0.296 Test Loss: 1.734 Test Acc: 0.296
Validation loss decreased (-0.270353 --> -0.296279).  Saving model ...
Epoch: 8 cost time: 0.5892181396484375
Epoch: 8, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.694 Vali Acc: 0.344 Test Loss: 1.694 Test Acc: 0.344
Validation loss decreased (-0.296279 --> -0.344428).  Saving model ...
Epoch: 9 cost time: 0.5750586986541748
Epoch: 9, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.651 Vali Acc: 0.370 Test Loss: 1.651 Test Acc: 0.370
Validation loss decreased (-0.344428 --> -0.370354).  Saving model ...
Epoch: 10 cost time: 0.6087088584899902
Epoch: 10, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.606 Vali Acc: 0.407 Test Loss: 1.606 Test Acc: 0.407
Validation loss decreased (-0.370354 --> -0.407391).  Saving model ...
Epoch: 11 cost time: 0.6278891563415527
Epoch: 11, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.559 Vali Acc: 0.444 Test Loss: 1.559 Test Acc: 0.444
Validation loss decreased (-0.407391 --> -0.444429).  Saving model ...
Epoch: 12 cost time: 0.6238901615142822
Epoch: 12, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.511 Vali Acc: 0.459 Test Loss: 1.511 Test Acc: 0.459
Validation loss decreased (-0.444429 --> -0.459244).  Saving model ...
Epoch: 13 cost time: 0.5408930778503418
Epoch: 13, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.461 Vali Acc: 0.493 Test Loss: 1.461 Test Acc: 0.493
Validation loss decreased (-0.459244 --> -0.492578).  Saving model ...
Epoch: 14 cost time: 0.5555284023284912
Epoch: 14, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.410 Vali Acc: 0.533 Test Loss: 1.410 Test Acc: 0.533
Validation loss decreased (-0.492578 --> -0.533319).  Saving model ...
Epoch: 15 cost time: 0.6136956214904785
Epoch: 15, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.359 Vali Acc: 0.559 Test Loss: 1.359 Test Acc: 0.559
Validation loss decreased (-0.533319 --> -0.559246).  Saving model ...
Epoch: 16 cost time: 0.5913786888122559
Epoch: 16, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.308 Vali Acc: 0.593 Test Loss: 1.308 Test Acc: 0.593
Validation loss decreased (-0.559246 --> -0.592580).  Saving model ...
Epoch: 17 cost time: 0.6517517566680908
Epoch: 17, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.256 Vali Acc: 0.641 Test Loss: 1.256 Test Acc: 0.641
Validation loss decreased (-0.592580 --> -0.640728).  Saving model ...
Epoch: 18 cost time: 0.6184196472167969
Epoch: 18, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.204 Vali Acc: 0.685 Test Loss: 1.204 Test Acc: 0.685
Validation loss decreased (-0.640728 --> -0.685173).  Saving model ...
Epoch: 19 cost time: 0.591010332107544
Epoch: 19, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.154 Vali Acc: 0.711 Test Loss: 1.154 Test Acc: 0.711
Validation loss decreased (-0.685173 --> -0.711100).  Saving model ...
Epoch: 20 cost time: 0.6869289875030518
Epoch: 20, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.104 Vali Acc: 0.741 Test Loss: 1.104 Test Acc: 0.741
Validation loss decreased (-0.711100 --> -0.740730).  Saving model ...
Epoch: 21 cost time: 0.6672885417938232
Epoch: 21, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.056 Vali Acc: 0.767 Test Loss: 1.056 Test Acc: 0.767
Validation loss decreased (-0.740730 --> -0.766656).  Saving model ...
Epoch: 22 cost time: 0.5460586547851562
Epoch: 22, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.008 Vali Acc: 0.774 Test Loss: 1.008 Test Acc: 0.774
Validation loss decreased (-0.766656 --> -0.774064).  Saving model ...
Epoch: 23 cost time: 0.649430513381958
Epoch: 23, Steps: 2 | Train Loss: 0.917 Vali Loss: 0.964 Vali Acc: 0.793 Test Loss: 0.964 Test Acc: 0.793
Validation loss decreased (-0.774064 --> -0.792583).  Saving model ...
Epoch: 24 cost time: 0.6910943984985352
Epoch: 24, Steps: 2 | Train Loss: 0.930 Vali Loss: 0.920 Vali Acc: 0.815 Test Loss: 0.920 Test Acc: 0.815
Validation loss decreased (-0.792583 --> -0.814806).  Saving model ...
Epoch: 25 cost time: 0.7159464359283447
Epoch: 25, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.877 Vali Acc: 0.830 Test Loss: 0.877 Test Acc: 0.830
Validation loss decreased (-0.814806 --> -0.829621).  Saving model ...
Epoch: 26 cost time: 0.6372253894805908
Epoch: 26, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.835 Vali Acc: 0.841 Test Loss: 0.835 Test Acc: 0.841
Validation loss decreased (-0.829621 --> -0.840732).  Saving model ...
Epoch: 27 cost time: 0.635859489440918
Epoch: 27, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.795 Vali Acc: 0.856 Test Loss: 0.795 Test Acc: 0.856
Validation loss decreased (-0.840732 --> -0.855548).  Saving model ...
Epoch: 28 cost time: 0.6274018287658691
Epoch: 28, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.757 Vali Acc: 0.870 Test Loss: 0.757 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870363).  Saving model ...
Epoch: 29 cost time: 0.5775330066680908
Epoch: 29, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.719 Vali Acc: 0.874 Test Loss: 0.719 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 30 cost time: 0.6434130668640137
Epoch: 30, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.682 Vali Acc: 0.885 Test Loss: 0.682 Test Acc: 0.885
Validation loss decreased (-0.874067 --> -0.885178).  Saving model ...
Epoch: 31 cost time: 0.5997629165649414
Epoch: 31, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.647 Vali Acc: 0.896 Test Loss: 0.647 Test Acc: 0.896
Validation loss decreased (-0.885178 --> -0.896290).  Saving model ...
Epoch: 32 cost time: 0.5529923439025879
Epoch: 32, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.616 Vali Acc: 0.904 Test Loss: 0.616 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 33 cost time: 0.6513209342956543
Epoch: 33, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.588 Vali Acc: 0.907 Test Loss: 0.588 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 34 cost time: 0.5623190402984619
Epoch: 34, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.560 Vali Acc: 0.911 Test Loss: 0.560 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 35 cost time: 0.6285152435302734
Epoch: 35, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.536 Vali Acc: 0.911 Test Loss: 0.536 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 36 cost time: 0.5781559944152832
Epoch: 36, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.512 Vali Acc: 0.919 Test Loss: 0.512 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918513).  Saving model ...
Epoch: 37 cost time: 0.6702921390533447
Epoch: 37, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.490 Vali Acc: 0.922 Test Loss: 0.490 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 38 cost time: 0.5552933216094971
Epoch: 38, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.469 Vali Acc: 0.926 Test Loss: 0.469 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 39 cost time: 0.650393009185791
Epoch: 39, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.450 Vali Acc: 0.930 Test Loss: 0.450 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 40 cost time: 0.5693554878234863
Epoch: 40, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.432 Vali Acc: 0.941 Test Loss: 0.432 Test Acc: 0.941
Validation loss decreased (-0.929625 --> -0.940736).  Saving model ...
Epoch: 41 cost time: 0.5864977836608887
Epoch: 41, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.417 Vali Acc: 0.941 Test Loss: 0.417 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 42 cost time: 0.5841002464294434
Epoch: 42, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.403 Vali Acc: 0.941 Test Loss: 0.403 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 43 cost time: 0.5606043338775635
Epoch: 43, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.389 Vali Acc: 0.941 Test Loss: 0.389 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 44 cost time: 0.5990676879882812
Epoch: 44, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.377 Vali Acc: 0.941 Test Loss: 0.377 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 45 cost time: 0.48354434967041016
Epoch: 45, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.367 Vali Acc: 0.941 Test Loss: 0.367 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 46 cost time: 0.6457986831665039
Epoch: 46, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.357 Vali Acc: 0.937 Test Loss: 0.357 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5824687480926514
Epoch: 47, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.348 Vali Acc: 0.933 Test Loss: 0.348 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6206822395324707
Epoch: 48, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.339 Vali Acc: 0.941 Test Loss: 0.339 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 49 cost time: 0.704014778137207
Epoch: 49, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.330 Vali Acc: 0.941 Test Loss: 0.330 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 50 cost time: 0.6149322986602783
Epoch: 50, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.322 Vali Acc: 0.941 Test Loss: 0.322 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 51 cost time: 0.6778275966644287
Epoch: 51, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.315 Vali Acc: 0.941 Test Loss: 0.315 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 52 cost time: 0.6313259601593018
Epoch: 52, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.310 Vali Acc: 0.941 Test Loss: 0.310 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 53 cost time: 0.5969440937042236
Epoch: 53, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 54 cost time: 0.5957224369049072
Epoch: 54, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 55 cost time: 0.6258926391601562
Epoch: 55, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 56 cost time: 0.6168158054351807
Epoch: 56, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.292 Vali Acc: 0.941 Test Loss: 0.292 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 57 cost time: 0.6520271301269531
Epoch: 57, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7036314010620117
Epoch: 58, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.286 Vali Acc: 0.937 Test Loss: 0.286 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7615365982055664
Epoch: 59, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.637441873550415
Epoch: 60, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.279 Vali Acc: 0.937 Test Loss: 0.279 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.6424293518066406
Epoch: 61, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5402660369873047
Epoch: 62, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.6496994495391846
Epoch: 63, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.6521542072296143
Epoch: 64, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.5562746524810791
Epoch: 65, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.6719205379486084
Epoch: 66, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 22470
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.211292266845703
Epoch: 1, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.767 Vali Acc: 0.181 Test Loss: 1.767 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.5863385200500488
Epoch: 2, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.738 Vali Acc: 0.181 Test Loss: 1.738 Test Acc: 0.181
Validation loss decreased (-0.181464 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.6163163185119629
Epoch: 3, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.717 Vali Acc: 0.196 Test Loss: 1.717 Test Acc: 0.196
Validation loss decreased (-0.181464 --> -0.196279).  Saving model ...
Epoch: 4 cost time: 0.6275789737701416
Epoch: 4, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.701 Vali Acc: 0.226 Test Loss: 1.701 Test Acc: 0.226
Validation loss decreased (-0.196279 --> -0.225909).  Saving model ...
Epoch: 5 cost time: 0.6068615913391113
Epoch: 5, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.680 Vali Acc: 0.248 Test Loss: 1.680 Test Acc: 0.248
Validation loss decreased (-0.225909 --> -0.248131).  Saving model ...
Epoch: 6 cost time: 0.6117806434631348
Epoch: 6, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.654 Vali Acc: 0.259 Test Loss: 1.654 Test Acc: 0.259
Validation loss decreased (-0.248131 --> -0.259243).  Saving model ...
Epoch: 7 cost time: 0.5693259239196777
Epoch: 7, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.626 Vali Acc: 0.281 Test Loss: 1.626 Test Acc: 0.281
Validation loss decreased (-0.259243 --> -0.281465).  Saving model ...
Epoch: 8 cost time: 0.6199159622192383
Epoch: 8, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.594 Vali Acc: 0.307 Test Loss: 1.594 Test Acc: 0.307
Validation loss decreased (-0.281465 --> -0.307391).  Saving model ...
Epoch: 9 cost time: 0.6137628555297852
Epoch: 9, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.560 Vali Acc: 0.319 Test Loss: 1.560 Test Acc: 0.319
Validation loss decreased (-0.307391 --> -0.318503).  Saving model ...
Epoch: 10 cost time: 0.666266679763794
Epoch: 10, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.523 Vali Acc: 0.348 Test Loss: 1.523 Test Acc: 0.348
Validation loss decreased (-0.318503 --> -0.348133).  Saving model ...
Epoch: 11 cost time: 0.5811498165130615
Epoch: 11, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.484 Vali Acc: 0.404 Test Loss: 1.484 Test Acc: 0.404
Validation loss decreased (-0.348133 --> -0.403689).  Saving model ...
Epoch: 12 cost time: 0.5711328983306885
Epoch: 12, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.443 Vali Acc: 0.452 Test Loss: 1.443 Test Acc: 0.452
Validation loss decreased (-0.403689 --> -0.451837).  Saving model ...
Epoch: 13 cost time: 0.6347672939300537
Epoch: 13, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.401 Vali Acc: 0.474 Test Loss: 1.401 Test Acc: 0.474
Validation loss decreased (-0.451837 --> -0.474060).  Saving model ...
Epoch: 14 cost time: 0.6186301708221436
Epoch: 14, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.358 Vali Acc: 0.511 Test Loss: 1.358 Test Acc: 0.511
Validation loss decreased (-0.474060 --> -0.511098).  Saving model ...
Epoch: 15 cost time: 0.6255707740783691
Epoch: 15, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.315 Vali Acc: 0.567 Test Loss: 1.315 Test Acc: 0.567
Validation loss decreased (-0.511098 --> -0.566654).  Saving model ...
Epoch: 16 cost time: 0.651939868927002
Epoch: 16, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.270 Vali Acc: 0.626 Test Loss: 1.270 Test Acc: 0.626
Validation loss decreased (-0.566654 --> -0.625913).  Saving model ...
Epoch: 17 cost time: 0.5892927646636963
Epoch: 17, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.226 Vali Acc: 0.670 Test Loss: 1.226 Test Acc: 0.670
Validation loss decreased (-0.625913 --> -0.670358).  Saving model ...
Epoch: 18 cost time: 0.5546648502349854
Epoch: 18, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.181 Vali Acc: 0.700 Test Loss: 1.181 Test Acc: 0.700
Validation loss decreased (-0.670358 --> -0.699988).  Saving model ...
Epoch: 19 cost time: 0.6108989715576172
Epoch: 19, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.136 Vali Acc: 0.715 Test Loss: 1.136 Test Acc: 0.715
Validation loss decreased (-0.699988 --> -0.714803).  Saving model ...
Epoch: 20 cost time: 0.5545408725738525
Epoch: 20, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.091 Vali Acc: 0.741 Test Loss: 1.091 Test Acc: 0.741
Validation loss decreased (-0.714803 --> -0.740730).  Saving model ...
Epoch: 21 cost time: 0.6376681327819824
Epoch: 21, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.046 Vali Acc: 0.759 Test Loss: 1.046 Test Acc: 0.759
Validation loss decreased (-0.740730 --> -0.759249).  Saving model ...
Epoch: 22 cost time: 0.6450469493865967
Epoch: 22, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.002 Vali Acc: 0.770 Test Loss: 1.002 Test Acc: 0.770
Validation loss decreased (-0.759249 --> -0.770360).  Saving model ...
Epoch: 23 cost time: 0.6131701469421387
Epoch: 23, Steps: 2 | Train Loss: 0.957 Vali Loss: 0.959 Vali Acc: 0.781 Test Loss: 0.959 Test Acc: 0.781
Validation loss decreased (-0.770360 --> -0.781472).  Saving model ...
Epoch: 24 cost time: 0.5751919746398926
Epoch: 24, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.918 Vali Acc: 0.804 Test Loss: 0.918 Test Acc: 0.804
Validation loss decreased (-0.781472 --> -0.803695).  Saving model ...
Epoch: 25 cost time: 0.6108393669128418
Epoch: 25, Steps: 2 | Train Loss: 0.804 Vali Loss: 0.877 Vali Acc: 0.811 Test Loss: 0.877 Test Acc: 0.811
Validation loss decreased (-0.803695 --> -0.811102).  Saving model ...
Epoch: 26 cost time: 0.5342035293579102
Epoch: 26, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.837 Vali Acc: 0.830 Test Loss: 0.837 Test Acc: 0.830
Validation loss decreased (-0.811102 --> -0.829621).  Saving model ...
Epoch: 27 cost time: 0.5136632919311523
Epoch: 27, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.798 Vali Acc: 0.830 Test Loss: 0.798 Test Acc: 0.830
Validation loss decreased (-0.829621 --> -0.829622).  Saving model ...
Epoch: 28 cost time: 0.5498838424682617
Epoch: 28, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.763 Vali Acc: 0.837 Test Loss: 0.763 Test Acc: 0.837
Validation loss decreased (-0.829622 --> -0.837029).  Saving model ...
Epoch: 29 cost time: 0.5733482837677002
Epoch: 29, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.728 Vali Acc: 0.859 Test Loss: 0.728 Test Acc: 0.859
Validation loss decreased (-0.837029 --> -0.859252).  Saving model ...
Epoch: 30 cost time: 0.6439952850341797
Epoch: 30, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.695 Vali Acc: 0.867 Test Loss: 0.695 Test Acc: 0.867
Validation loss decreased (-0.859252 --> -0.866660).  Saving model ...
Epoch: 31 cost time: 0.5674905776977539
Epoch: 31, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.662 Vali Acc: 0.878 Test Loss: 0.662 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 32 cost time: 0.6256482601165771
Epoch: 32, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.633 Vali Acc: 0.885 Test Loss: 0.633 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885179).  Saving model ...
Epoch: 33 cost time: 0.6538774967193604
Epoch: 33, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.606 Vali Acc: 0.893 Test Loss: 0.606 Test Acc: 0.893
Validation loss decreased (-0.885179 --> -0.892587).  Saving model ...
Epoch: 34 cost time: 0.5582196712493896
Epoch: 34, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.579 Vali Acc: 0.893 Test Loss: 0.579 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 35 cost time: 0.5635910034179688
Epoch: 35, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.554 Vali Acc: 0.893 Test Loss: 0.554 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 36 cost time: 0.6692845821380615
Epoch: 36, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 37 cost time: 0.636735200881958
Epoch: 37, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.511 Vali Acc: 0.904 Test Loss: 0.511 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 38 cost time: 0.574517011642456
Epoch: 38, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.492 Vali Acc: 0.911 Test Loss: 0.492 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911106).  Saving model ...
Epoch: 39 cost time: 0.6893906593322754
Epoch: 39, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.474 Vali Acc: 0.907 Test Loss: 0.474 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5951862335205078
Epoch: 40, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.458 Vali Acc: 0.911 Test Loss: 0.458 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 41 cost time: 0.6122398376464844
Epoch: 41, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.442 Vali Acc: 0.911 Test Loss: 0.442 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 42 cost time: 0.6198780536651611
Epoch: 42, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.428 Vali Acc: 0.915 Test Loss: 0.428 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 43 cost time: 0.7150828838348389
Epoch: 43, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.415 Vali Acc: 0.919 Test Loss: 0.415 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918514).  Saving model ...
Epoch: 44 cost time: 0.6901755332946777
Epoch: 44, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.403 Vali Acc: 0.919 Test Loss: 0.403 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 45 cost time: 0.7229411602020264
Epoch: 45, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.392 Vali Acc: 0.919 Test Loss: 0.392 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 46 cost time: 0.6085813045501709
Epoch: 46, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.383 Vali Acc: 0.922 Test Loss: 0.383 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922218).  Saving model ...
Epoch: 47 cost time: 0.6380131244659424
Epoch: 47, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.373 Vali Acc: 0.926 Test Loss: 0.373 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 48 cost time: 0.6151001453399658
Epoch: 48, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.364 Vali Acc: 0.926 Test Loss: 0.364 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 49 cost time: 0.5574028491973877
Epoch: 49, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.356 Vali Acc: 0.930 Test Loss: 0.356 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 50 cost time: 0.5857720375061035
Epoch: 50, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.349 Vali Acc: 0.933 Test Loss: 0.349 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 51 cost time: 0.5988032817840576
Epoch: 51, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6402480602264404
Epoch: 52, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.336 Vali Acc: 0.926 Test Loss: 0.336 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6081855297088623
Epoch: 53, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.331 Vali Acc: 0.926 Test Loss: 0.331 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.606593132019043
Epoch: 54, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.327 Vali Acc: 0.926 Test Loss: 0.327 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5870795249938965
Epoch: 55, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.5510973930358887
Epoch: 56, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.318 Vali Acc: 0.926 Test Loss: 0.318 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.5858125686645508
Epoch: 57, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.5671288967132568
Epoch: 58, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.724013090133667
Epoch: 59, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.5968856811523438
Epoch: 60, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.300 Vali Acc: 0.926 Test Loss: 0.300 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 21366
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2486488819122314
Epoch: 1, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.864 Vali Acc: 0.181 Test Loss: 1.864 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.596710205078125
Epoch: 2, Steps: 2 | Train Loss: 1.993 Vali Loss: 1.834 Vali Acc: 0.196 Test Loss: 1.834 Test Acc: 0.196
Validation loss decreased (-0.181463 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.6386394500732422
Epoch: 3, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.813 Vali Acc: 0.200 Test Loss: 1.813 Test Acc: 0.200
Validation loss decreased (-0.196278 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.5639028549194336
Epoch: 4, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.798 Vali Acc: 0.215 Test Loss: 1.798 Test Acc: 0.215
Validation loss decreased (-0.199982 --> -0.214797).  Saving model ...
Epoch: 5 cost time: 0.615525484085083
Epoch: 5, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.780 Vali Acc: 0.211 Test Loss: 1.780 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6464052200317383
Epoch: 6, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.760 Vali Acc: 0.219 Test Loss: 1.760 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218501).  Saving model ...
Epoch: 7 cost time: 0.5517377853393555
Epoch: 7, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.737 Vali Acc: 0.241 Test Loss: 1.737 Test Acc: 0.241
Validation loss decreased (-0.218501 --> -0.240723).  Saving model ...
Epoch: 8 cost time: 0.5804109573364258
Epoch: 8, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.712 Vali Acc: 0.222 Test Loss: 1.712 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5829551219940186
Epoch: 9, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.686 Vali Acc: 0.230 Test Loss: 1.686 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5902309417724609
Epoch: 10, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.658 Vali Acc: 0.241 Test Loss: 1.658 Test Acc: 0.241
Validation loss decreased (-0.240723 --> -0.240724).  Saving model ...
Epoch: 11 cost time: 0.6114120483398438
Epoch: 11, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.628 Vali Acc: 0.278 Test Loss: 1.628 Test Acc: 0.278
Validation loss decreased (-0.240724 --> -0.277761).  Saving model ...
Epoch: 12 cost time: 0.7362287044525146
Epoch: 12, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.597 Vali Acc: 0.289 Test Loss: 1.597 Test Acc: 0.289
Validation loss decreased (-0.277761 --> -0.288873).  Saving model ...
Epoch: 13 cost time: 0.6224117279052734
Epoch: 13, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.564 Vali Acc: 0.341 Test Loss: 1.564 Test Acc: 0.341
Validation loss decreased (-0.288873 --> -0.340725).  Saving model ...
Epoch: 14 cost time: 0.6306312084197998
Epoch: 14, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.531 Vali Acc: 0.381 Test Loss: 1.531 Test Acc: 0.381
Validation loss decreased (-0.340725 --> -0.381466).  Saving model ...
Epoch: 15 cost time: 0.6378915309906006
Epoch: 15, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.496 Vali Acc: 0.422 Test Loss: 1.496 Test Acc: 0.422
Validation loss decreased (-0.381466 --> -0.422207).  Saving model ...
Epoch: 16 cost time: 0.6435513496398926
Epoch: 16, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.461 Vali Acc: 0.463 Test Loss: 1.461 Test Acc: 0.463
Validation loss decreased (-0.422207 --> -0.462948).  Saving model ...
Epoch: 17 cost time: 0.6057064533233643
Epoch: 17, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.425 Vali Acc: 0.489 Test Loss: 1.425 Test Acc: 0.489
Validation loss decreased (-0.462948 --> -0.488875).  Saving model ...
Epoch: 18 cost time: 0.6369881629943848
Epoch: 18, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.389 Vali Acc: 0.533 Test Loss: 1.389 Test Acc: 0.533
Validation loss decreased (-0.488875 --> -0.533319).  Saving model ...
Epoch: 19 cost time: 0.6173985004425049
Epoch: 19, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.352 Vali Acc: 0.559 Test Loss: 1.352 Test Acc: 0.559
Validation loss decreased (-0.533319 --> -0.559246).  Saving model ...
Epoch: 20 cost time: 0.5668425559997559
Epoch: 20, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.316 Vali Acc: 0.593 Test Loss: 1.316 Test Acc: 0.593
Validation loss decreased (-0.559246 --> -0.592579).  Saving model ...
Epoch: 21 cost time: 0.6027531623840332
Epoch: 21, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.278 Vali Acc: 0.630 Test Loss: 1.278 Test Acc: 0.630
Validation loss decreased (-0.592579 --> -0.629617).  Saving model ...
Epoch: 22 cost time: 0.563483476638794
Epoch: 22, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.241 Vali Acc: 0.652 Test Loss: 1.241 Test Acc: 0.652
Validation loss decreased (-0.629617 --> -0.651839).  Saving model ...
Epoch: 23 cost time: 0.7444348335266113
Epoch: 23, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.205 Vali Acc: 0.659 Test Loss: 1.205 Test Acc: 0.659
Validation loss decreased (-0.651839 --> -0.659247).  Saving model ...
Epoch: 24 cost time: 0.5309550762176514
Epoch: 24, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.168 Vali Acc: 0.667 Test Loss: 1.168 Test Acc: 0.667
Validation loss decreased (-0.659247 --> -0.666655).  Saving model ...
Epoch: 25 cost time: 0.5880229473114014
Epoch: 25, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.133 Vali Acc: 0.689 Test Loss: 1.133 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688878).  Saving model ...
Epoch: 26 cost time: 0.574732780456543
Epoch: 26, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.099 Vali Acc: 0.700 Test Loss: 1.099 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699989).  Saving model ...
Epoch: 27 cost time: 0.6318247318267822
Epoch: 27, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.065 Vali Acc: 0.704 Test Loss: 1.065 Test Acc: 0.704
Validation loss decreased (-0.699989 --> -0.703693).  Saving model ...
Epoch: 28 cost time: 0.5335931777954102
Epoch: 28, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.032 Vali Acc: 0.711 Test Loss: 1.032 Test Acc: 0.711
Validation loss decreased (-0.703693 --> -0.711101).  Saving model ...
Epoch: 29 cost time: 0.6850416660308838
Epoch: 29, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.999 Vali Acc: 0.726 Test Loss: 0.999 Test Acc: 0.726
Validation loss decreased (-0.711101 --> -0.725916).  Saving model ...
Epoch: 30 cost time: 0.5906310081481934
Epoch: 30, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.967 Vali Acc: 0.748 Test Loss: 0.967 Test Acc: 0.748
Validation loss decreased (-0.725916 --> -0.748138).  Saving model ...
Epoch: 31 cost time: 0.5652399063110352
Epoch: 31, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.936 Vali Acc: 0.770 Test Loss: 0.936 Test Acc: 0.770
Validation loss decreased (-0.748138 --> -0.770361).  Saving model ...
Epoch: 32 cost time: 0.669827938079834
Epoch: 32, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.906 Vali Acc: 0.774 Test Loss: 0.906 Test Acc: 0.774
Validation loss decreased (-0.770361 --> -0.774065).  Saving model ...
Epoch: 33 cost time: 0.6243579387664795
Epoch: 33, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.876 Vali Acc: 0.785 Test Loss: 0.876 Test Acc: 0.785
Validation loss decreased (-0.774065 --> -0.785176).  Saving model ...
Epoch: 34 cost time: 0.5213963985443115
Epoch: 34, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.847 Vali Acc: 0.800 Test Loss: 0.847 Test Acc: 0.800
Validation loss decreased (-0.785176 --> -0.799992).  Saving model ...
Epoch: 35 cost time: 0.5360856056213379
Epoch: 35, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.819 Vali Acc: 0.822 Test Loss: 0.819 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822214).  Saving model ...
Epoch: 36 cost time: 0.5959808826446533
Epoch: 36, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.791 Vali Acc: 0.826 Test Loss: 0.791 Test Acc: 0.826
Validation loss decreased (-0.822214 --> -0.825918).  Saving model ...
Epoch: 37 cost time: 0.5619785785675049
Epoch: 37, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.765 Vali Acc: 0.841 Test Loss: 0.765 Test Acc: 0.841
Validation loss decreased (-0.825918 --> -0.840733).  Saving model ...
Epoch: 38 cost time: 0.6719086170196533
Epoch: 38, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.740 Vali Acc: 0.844 Test Loss: 0.740 Test Acc: 0.844
Validation loss decreased (-0.840733 --> -0.844437).  Saving model ...
Epoch: 39 cost time: 0.5751147270202637
Epoch: 39, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.715 Vali Acc: 0.859 Test Loss: 0.715 Test Acc: 0.859
Validation loss decreased (-0.844437 --> -0.859252).  Saving model ...
Epoch: 40 cost time: 0.7927336692810059
Epoch: 40, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.691 Vali Acc: 0.870 Test Loss: 0.691 Test Acc: 0.870
Validation loss decreased (-0.859252 --> -0.870363).  Saving model ...
Epoch: 41 cost time: 0.8032863140106201
Epoch: 41, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.669 Vali Acc: 0.874 Test Loss: 0.669 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 42 cost time: 0.6148021221160889
Epoch: 42, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.648 Vali Acc: 0.878 Test Loss: 0.648 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877771).  Saving model ...
Epoch: 43 cost time: 0.6642813682556152
Epoch: 43, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.628 Vali Acc: 0.878 Test Loss: 0.628 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 44 cost time: 0.6706666946411133
Epoch: 44, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.610 Vali Acc: 0.889 Test Loss: 0.610 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888883).  Saving model ...
Epoch: 45 cost time: 0.721386194229126
Epoch: 45, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.593 Vali Acc: 0.889 Test Loss: 0.593 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 46 cost time: 0.6919827461242676
Epoch: 46, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.577 Vali Acc: 0.900 Test Loss: 0.577 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899994).  Saving model ...
Epoch: 47 cost time: 0.5967080593109131
Epoch: 47, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.562 Vali Acc: 0.900 Test Loss: 0.562 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 48 cost time: 0.6115186214447021
Epoch: 48, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.549 Vali Acc: 0.907 Test Loss: 0.549 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 49 cost time: 0.54681396484375
Epoch: 49, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.535 Vali Acc: 0.907 Test Loss: 0.535 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 50 cost time: 0.5855772495269775
Epoch: 50, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.522 Vali Acc: 0.904 Test Loss: 0.522 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.617293119430542
Epoch: 51, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.509 Vali Acc: 0.915 Test Loss: 0.509 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 52 cost time: 0.6553676128387451
Epoch: 52, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.497 Vali Acc: 0.919 Test Loss: 0.497 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 53 cost time: 0.6653594970703125
Epoch: 53, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.486 Vali Acc: 0.919 Test Loss: 0.486 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 54 cost time: 0.5503780841827393
Epoch: 54, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.476 Vali Acc: 0.922 Test Loss: 0.476 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922217).  Saving model ...
Epoch: 55 cost time: 0.6194844245910645
Epoch: 55, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.465 Vali Acc: 0.926 Test Loss: 0.465 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 56 cost time: 0.6953704357147217
Epoch: 56, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.457 Vali Acc: 0.926 Test Loss: 0.457 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 57 cost time: 0.5680091381072998
Epoch: 57, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.448 Vali Acc: 0.919 Test Loss: 0.448 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6220488548278809
Epoch: 58, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.440 Vali Acc: 0.919 Test Loss: 0.440 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.640967607498169
Epoch: 59, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.431 Vali Acc: 0.922 Test Loss: 0.431 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.625478982925415
Epoch: 60, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.424 Vali Acc: 0.926 Test Loss: 0.424 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 61 cost time: 0.6758790016174316
Epoch: 61, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.417 Vali Acc: 0.926 Test Loss: 0.417 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 62 cost time: 0.6260502338409424
Epoch: 62, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.411 Vali Acc: 0.930 Test Loss: 0.411 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 63 cost time: 0.622044563293457
Epoch: 63, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.405 Vali Acc: 0.930 Test Loss: 0.405 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 64 cost time: 0.6768972873687744
Epoch: 64, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.399 Vali Acc: 0.930 Test Loss: 0.399 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 65 cost time: 0.5519120693206787
Epoch: 65, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5836515426635742
Epoch: 66, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.389 Vali Acc: 0.919 Test Loss: 0.389 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.6303427219390869
Epoch: 67, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.383 Vali Acc: 0.922 Test Loss: 0.383 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.6737737655639648
Epoch: 68, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.378 Vali Acc: 0.922 Test Loss: 0.378 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.6262986660003662
Epoch: 69, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.373 Vali Acc: 0.930 Test Loss: 0.373 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 70 cost time: 0.6936326026916504
Epoch: 70, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.369 Vali Acc: 0.930 Test Loss: 0.369 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 71 cost time: 0.549166202545166
Epoch: 71, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.364 Vali Acc: 0.930 Test Loss: 0.364 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 72 cost time: 0.6661980152130127
Epoch: 72, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.360 Vali Acc: 0.930 Test Loss: 0.360 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 73 cost time: 0.5857100486755371
Epoch: 73, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.356 Vali Acc: 0.930 Test Loss: 0.356 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 74 cost time: 0.5944457054138184
Epoch: 74, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.352 Vali Acc: 0.930 Test Loss: 0.352 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 75 cost time: 0.6209661960601807
Epoch: 75, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.348 Vali Acc: 0.930 Test Loss: 0.348 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 76 cost time: 0.6338691711425781
Epoch: 76, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.344 Vali Acc: 0.930 Test Loss: 0.344 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 77 cost time: 0.6633765697479248
Epoch: 77, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.341 Vali Acc: 0.930 Test Loss: 0.341 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 78 cost time: 0.5839633941650391
Epoch: 78, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.337 Vali Acc: 0.930 Test Loss: 0.337 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 79 cost time: 0.5804924964904785
Epoch: 79, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.334 Vali Acc: 0.930 Test Loss: 0.334 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 80 cost time: 0.7016551494598389
Epoch: 80, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.331 Vali Acc: 0.930 Test Loss: 0.331 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 81 cost time: 0.58017897605896
Epoch: 81, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.328 Vali Acc: 0.930 Test Loss: 0.328 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 82 cost time: 0.7401092052459717
Epoch: 82, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.326 Vali Acc: 0.930 Test Loss: 0.326 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 83 cost time: 0.6614542007446289
Epoch: 83, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 84 cost time: 0.5156576633453369
Epoch: 84, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.321 Vali Acc: 0.930 Test Loss: 0.321 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 85 cost time: 0.5884349346160889
Epoch: 85, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 86 cost time: 0.6288764476776123
Epoch: 86, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.316 Vali Acc: 0.930 Test Loss: 0.316 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 87 cost time: 0.4959239959716797
Epoch: 87, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.313 Vali Acc: 0.930 Test Loss: 0.313 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 88 cost time: 0.4923539161682129
Epoch: 88, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.311 Vali Acc: 0.933 Test Loss: 0.311 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 89 cost time: 0.7012252807617188
Epoch: 89, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 90 cost time: 0.5620882511138916
Epoch: 90, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 91 cost time: 0.5715773105621338
Epoch: 91, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.304 Vali Acc: 0.937 Test Loss: 0.304 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 92 cost time: 0.586181640625
Epoch: 92, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.302 Vali Acc: 0.937 Test Loss: 0.302 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 93 cost time: 0.5694260597229004
Epoch: 93, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 94 cost time: 0.5583219528198242
Epoch: 94, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.6678464412689209
Epoch: 95, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.297 Vali Acc: 0.933 Test Loss: 0.297 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.5848162174224854
Epoch: 96, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.296 Vali Acc: 0.937 Test Loss: 0.296 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 97 cost time: 0.5810472965240479
Epoch: 97, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 98 cost time: 0.6240870952606201
Epoch: 98, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 99 cost time: 0.5778388977050781
Epoch: 99, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.294 Vali Acc: 0.937 Test Loss: 0.294 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 100 cost time: 0.6236088275909424
Epoch: 100, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.293 Vali Acc: 0.937 Test Loss: 0.293 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 19878
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.565418004989624
Epoch: 1, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.738 Vali Acc: 0.219 Test Loss: 1.738 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.6166532039642334
Epoch: 2, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.718 Vali Acc: 0.241 Test Loss: 1.718 Test Acc: 0.241
Validation loss decreased (-0.218501 --> -0.240724).  Saving model ...
Epoch: 3 cost time: 0.5775725841522217
Epoch: 3, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.705 Vali Acc: 0.237 Test Loss: 1.705 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7807300090789795
Epoch: 4, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.694 Vali Acc: 0.259 Test Loss: 1.694 Test Acc: 0.259
Validation loss decreased (-0.240724 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 0.5786850452423096
Epoch: 5, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.681 Vali Acc: 0.270 Test Loss: 1.681 Test Acc: 0.270
Validation loss decreased (-0.259242 --> -0.270354).  Saving model ...
Epoch: 6 cost time: 0.5677905082702637
Epoch: 6, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.665 Vali Acc: 0.285 Test Loss: 1.665 Test Acc: 0.285
Validation loss decreased (-0.270354 --> -0.285169).  Saving model ...
Epoch: 7 cost time: 0.5229206085205078
Epoch: 7, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.647 Vali Acc: 0.315 Test Loss: 1.647 Test Acc: 0.315
Validation loss decreased (-0.285169 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 0.7380974292755127
Epoch: 8, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.628 Vali Acc: 0.326 Test Loss: 1.628 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325910).  Saving model ...
Epoch: 9 cost time: 0.6036317348480225
Epoch: 9, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.606 Vali Acc: 0.356 Test Loss: 1.606 Test Acc: 0.356
Validation loss decreased (-0.325910 --> -0.355540).  Saving model ...
Epoch: 10 cost time: 0.7392380237579346
Epoch: 10, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.581 Vali Acc: 0.374 Test Loss: 1.581 Test Acc: 0.374
Validation loss decreased (-0.355540 --> -0.374058).  Saving model ...
Epoch: 11 cost time: 0.597679853439331
Epoch: 11, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.555 Vali Acc: 0.385 Test Loss: 1.555 Test Acc: 0.385
Validation loss decreased (-0.374058 --> -0.385170).  Saving model ...
Epoch: 12 cost time: 0.6780524253845215
Epoch: 12, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.527 Vali Acc: 0.404 Test Loss: 1.527 Test Acc: 0.404
Validation loss decreased (-0.385170 --> -0.403688).  Saving model ...
Epoch: 13 cost time: 0.6445102691650391
Epoch: 13, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.499 Vali Acc: 0.430 Test Loss: 1.499 Test Acc: 0.430
Validation loss decreased (-0.403688 --> -0.429615).  Saving model ...
Epoch: 14 cost time: 0.5355887413024902
Epoch: 14, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.468 Vali Acc: 0.467 Test Loss: 1.468 Test Acc: 0.467
Validation loss decreased (-0.429615 --> -0.466652).  Saving model ...
Epoch: 15 cost time: 0.6865658760070801
Epoch: 15, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.437 Vali Acc: 0.493 Test Loss: 1.437 Test Acc: 0.493
Validation loss decreased (-0.466652 --> -0.492578).  Saving model ...
Epoch: 16 cost time: 0.6499736309051514
Epoch: 16, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.405 Vali Acc: 0.515 Test Loss: 1.405 Test Acc: 0.515
Validation loss decreased (-0.492578 --> -0.514801).  Saving model ...
Epoch: 17 cost time: 0.5592083930969238
Epoch: 17, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.372 Vali Acc: 0.552 Test Loss: 1.372 Test Acc: 0.552
Validation loss decreased (-0.514801 --> -0.551838).  Saving model ...
Epoch: 18 cost time: 0.5994646549224854
Epoch: 18, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.339 Vali Acc: 0.585 Test Loss: 1.339 Test Acc: 0.585
Validation loss decreased (-0.551838 --> -0.585172).  Saving model ...
Epoch: 19 cost time: 0.576124906539917
Epoch: 19, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.305 Vali Acc: 0.607 Test Loss: 1.305 Test Acc: 0.607
Validation loss decreased (-0.585172 --> -0.607394).  Saving model ...
Epoch: 20 cost time: 0.5983161926269531
Epoch: 20, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.271 Vali Acc: 0.615 Test Loss: 1.271 Test Acc: 0.615
Validation loss decreased (-0.607394 --> -0.614802).  Saving model ...
Epoch: 21 cost time: 0.5571107864379883
Epoch: 21, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.237 Vali Acc: 0.652 Test Loss: 1.237 Test Acc: 0.652
Validation loss decreased (-0.614802 --> -0.651839).  Saving model ...
Epoch: 22 cost time: 0.5926268100738525
Epoch: 22, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.203 Vali Acc: 0.681 Test Loss: 1.203 Test Acc: 0.681
Validation loss decreased (-0.651839 --> -0.681469).  Saving model ...
Epoch: 23 cost time: 0.5407288074493408
Epoch: 23, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.170 Vali Acc: 0.700 Test Loss: 1.170 Test Acc: 0.700
Validation loss decreased (-0.681469 --> -0.699988).  Saving model ...
Epoch: 24 cost time: 0.5809814929962158
Epoch: 24, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.137 Vali Acc: 0.719 Test Loss: 1.137 Test Acc: 0.719
Validation loss decreased (-0.699988 --> -0.718507).  Saving model ...
Epoch: 25 cost time: 0.622783899307251
Epoch: 25, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.103 Vali Acc: 0.748 Test Loss: 1.103 Test Acc: 0.748
Validation loss decreased (-0.718507 --> -0.748137).  Saving model ...
Epoch: 26 cost time: 0.6880991458892822
Epoch: 26, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.071 Vali Acc: 0.759 Test Loss: 1.071 Test Acc: 0.759
Validation loss decreased (-0.748137 --> -0.759249).  Saving model ...
Epoch: 27 cost time: 0.4995908737182617
Epoch: 27, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.038 Vali Acc: 0.781 Test Loss: 1.038 Test Acc: 0.781
Validation loss decreased (-0.759249 --> -0.781471).  Saving model ...
Epoch: 28 cost time: 0.5084748268127441
Epoch: 28, Steps: 2 | Train Loss: 0.959 Vali Loss: 1.006 Vali Acc: 0.789 Test Loss: 1.006 Test Acc: 0.789
Validation loss decreased (-0.781471 --> -0.788879).  Saving model ...
Epoch: 29 cost time: 0.594475507736206
Epoch: 29, Steps: 2 | Train Loss: 0.928 Vali Loss: 0.975 Vali Acc: 0.815 Test Loss: 0.975 Test Acc: 0.815
Validation loss decreased (-0.788879 --> -0.814805).  Saving model ...
Epoch: 30 cost time: 0.5146183967590332
Epoch: 30, Steps: 2 | Train Loss: 0.845 Vali Loss: 0.943 Vali Acc: 0.822 Test Loss: 0.943 Test Acc: 0.822
Validation loss decreased (-0.814805 --> -0.822213).  Saving model ...
Epoch: 31 cost time: 0.6156761646270752
Epoch: 31, Steps: 2 | Train Loss: 0.943 Vali Loss: 0.912 Vali Acc: 0.833 Test Loss: 0.912 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833324).  Saving model ...
Epoch: 32 cost time: 0.5342268943786621
Epoch: 32, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.883 Vali Acc: 0.837 Test Loss: 0.883 Test Acc: 0.837
Validation loss decreased (-0.833324 --> -0.837028).  Saving model ...
Epoch: 33 cost time: 0.5477683544158936
Epoch: 33, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.854 Vali Acc: 0.848 Test Loss: 0.854 Test Acc: 0.848
Validation loss decreased (-0.837028 --> -0.848140).  Saving model ...
Epoch: 34 cost time: 0.5569393634796143
Epoch: 34, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.824 Vali Acc: 0.863 Test Loss: 0.824 Test Acc: 0.863
Validation loss decreased (-0.848140 --> -0.862955).  Saving model ...
Epoch: 35 cost time: 0.639134407043457
Epoch: 35, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.796 Vali Acc: 0.874 Test Loss: 0.796 Test Acc: 0.874
Validation loss decreased (-0.862955 --> -0.874066).  Saving model ...
Epoch: 36 cost time: 0.5990164279937744
Epoch: 36, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.770 Vali Acc: 0.885 Test Loss: 0.770 Test Acc: 0.885
Validation loss decreased (-0.874066 --> -0.885177).  Saving model ...
Epoch: 37 cost time: 0.6168525218963623
Epoch: 37, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.745 Vali Acc: 0.889 Test Loss: 0.745 Test Acc: 0.889
Validation loss decreased (-0.885177 --> -0.888881).  Saving model ...
Epoch: 38 cost time: 0.608659029006958
Epoch: 38, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.721 Vali Acc: 0.889 Test Loss: 0.721 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 39 cost time: 0.6465644836425781
Epoch: 39, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.700 Vali Acc: 0.881 Test Loss: 0.700 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7021501064300537
Epoch: 40, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.678 Vali Acc: 0.881 Test Loss: 0.678 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7355372905731201
Epoch: 41, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.658 Vali Acc: 0.885 Test Loss: 0.658 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6616132259368896
Epoch: 42, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.639 Vali Acc: 0.885 Test Loss: 0.639 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6240208148956299
Epoch: 43, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.622 Vali Acc: 0.889 Test Loss: 0.622 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 44 cost time: 0.6619415283203125
Epoch: 44, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.605 Vali Acc: 0.893 Test Loss: 0.605 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 45 cost time: 0.5947074890136719
Epoch: 45, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.588 Vali Acc: 0.896 Test Loss: 0.588 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896290).  Saving model ...
Epoch: 46 cost time: 0.6129412651062012
Epoch: 46, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.573 Vali Acc: 0.896 Test Loss: 0.573 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896291).  Saving model ...
Epoch: 47 cost time: 0.6211206912994385
Epoch: 47, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.558 Vali Acc: 0.900 Test Loss: 0.558 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899994).  Saving model ...
Epoch: 48 cost time: 0.6424643993377686
Epoch: 48, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.544 Vali Acc: 0.900 Test Loss: 0.544 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 0.6228470802307129
Epoch: 49, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 50 cost time: 0.5712244510650635
Epoch: 50, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.520 Vali Acc: 0.904 Test Loss: 0.520 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 51 cost time: 0.6631479263305664
Epoch: 51, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.508 Vali Acc: 0.904 Test Loss: 0.508 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 52 cost time: 0.6192295551300049
Epoch: 52, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.496 Vali Acc: 0.911 Test Loss: 0.496 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911106).  Saving model ...
Epoch: 53 cost time: 0.601015567779541
Epoch: 53, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.485 Vali Acc: 0.915 Test Loss: 0.485 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 54 cost time: 0.5688238143920898
Epoch: 54, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.475 Vali Acc: 0.915 Test Loss: 0.475 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 55 cost time: 0.6034467220306396
Epoch: 55, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.466 Vali Acc: 0.922 Test Loss: 0.466 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 56 cost time: 0.5614652633666992
Epoch: 56, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.456 Vali Acc: 0.930 Test Loss: 0.456 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929625).  Saving model ...
Epoch: 57 cost time: 0.5852944850921631
Epoch: 57, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.448 Vali Acc: 0.930 Test Loss: 0.448 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 58 cost time: 0.6365270614624023
Epoch: 58, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.440 Vali Acc: 0.930 Test Loss: 0.440 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 59 cost time: 0.5284683704376221
Epoch: 59, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.432 Vali Acc: 0.930 Test Loss: 0.432 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 60 cost time: 0.6881468296051025
Epoch: 60, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.424 Vali Acc: 0.930 Test Loss: 0.424 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 61 cost time: 0.5961236953735352
Epoch: 61, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.416 Vali Acc: 0.930 Test Loss: 0.416 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 62 cost time: 0.6813881397247314
Epoch: 62, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.409 Vali Acc: 0.926 Test Loss: 0.409 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5730969905853271
Epoch: 63, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.403 Vali Acc: 0.930 Test Loss: 0.403 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 64 cost time: 0.601445198059082
Epoch: 64, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.397 Vali Acc: 0.930 Test Loss: 0.397 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 65 cost time: 0.5895018577575684
Epoch: 65, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.391 Vali Acc: 0.933 Test Loss: 0.391 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933329).  Saving model ...
Epoch: 66 cost time: 0.6950969696044922
Epoch: 66, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.385 Vali Acc: 0.930 Test Loss: 0.385 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6535401344299316
Epoch: 67, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.379 Vali Acc: 0.933 Test Loss: 0.379 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 68 cost time: 0.6457335948944092
Epoch: 68, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.373 Vali Acc: 0.933 Test Loss: 0.373 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 69 cost time: 0.6033332347869873
Epoch: 69, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.368 Vali Acc: 0.933 Test Loss: 0.368 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 70 cost time: 0.6682534217834473
Epoch: 70, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.363 Vali Acc: 0.933 Test Loss: 0.363 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 71 cost time: 0.6288869380950928
Epoch: 71, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.358 Vali Acc: 0.930 Test Loss: 0.358 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6159801483154297
Epoch: 72, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.353 Vali Acc: 0.930 Test Loss: 0.353 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.5898175239562988
Epoch: 73, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.348 Vali Acc: 0.930 Test Loss: 0.348 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.6038124561309814
Epoch: 74, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.344 Vali Acc: 0.933 Test Loss: 0.344 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 75 cost time: 0.6623799800872803
Epoch: 75, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.340 Vali Acc: 0.933 Test Loss: 0.340 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 76 cost time: 0.6622204780578613
Epoch: 76, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.6394920349121094
Epoch: 77, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.332 Vali Acc: 0.930 Test Loss: 0.332 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.68363356590271
Epoch: 78, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.328 Vali Acc: 0.930 Test Loss: 0.328 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.5867698192596436
Epoch: 79, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.325 Vali Acc: 0.930 Test Loss: 0.325 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.6053829193115234
Epoch: 80, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.321 Vali Acc: 0.930 Test Loss: 0.321 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.6663815975189209
Epoch: 81, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.6047148704528809
Epoch: 82, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 83 cost time: 0.6102080345153809
Epoch: 83, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 84 cost time: 0.5330665111541748
Epoch: 84, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.5989048480987549
Epoch: 85, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.306 Vali Acc: 0.933 Test Loss: 0.306 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.6416208744049072
Epoch: 86, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.303 Vali Acc: 0.937 Test Loss: 0.303 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 87 cost time: 0.5754308700561523
Epoch: 87, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.300 Vali Acc: 0.941 Test Loss: 0.300 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 88 cost time: 0.5132529735565186
Epoch: 88, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.5505561828613281
Epoch: 89, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.5744905471801758
Epoch: 90, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.6487786769866943
Epoch: 91, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.289 Vali Acc: 0.941 Test Loss: 0.289 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 92 cost time: 0.6134316921234131
Epoch: 92, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 93 cost time: 0.5653870105743408
Epoch: 93, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 94 cost time: 0.6675057411193848
Epoch: 94, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.7353672981262207
Epoch: 95, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.281 Vali Acc: 0.941 Test Loss: 0.281 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.5606644153594971
Epoch: 96, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.607804536819458
Epoch: 97, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 0.5698413848876953
Epoch: 98, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 0.7301521301269531
Epoch: 99, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.274 Vali Acc: 0.941 Test Loss: 0.274 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 0.5664544105529785
Epoch: 100, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 19174
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3404541015625
Epoch: 1, Steps: 2 | Train Loss: 2.006 Vali Loss: 1.852 Vali Acc: 0.181 Test Loss: 1.852 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.6222953796386719
Epoch: 2, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.788 Vali Acc: 0.230 Test Loss: 1.788 Test Acc: 0.230
Validation loss decreased (-0.181463 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 0.578533411026001
Epoch: 3, Steps: 2 | Train Loss: 2.010 Vali Loss: 1.733 Vali Acc: 0.319 Test Loss: 1.733 Test Acc: 0.319
Validation loss decreased (-0.229612 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 0.6470668315887451
Epoch: 4, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.670 Vali Acc: 0.352 Test Loss: 1.670 Test Acc: 0.352
Validation loss decreased (-0.318501 --> -0.351835).  Saving model ...
Epoch: 5 cost time: 0.5715372562408447
Epoch: 5, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.593 Vali Acc: 0.400 Test Loss: 1.593 Test Acc: 0.400
Validation loss decreased (-0.351835 --> -0.399984).  Saving model ...
Epoch: 6 cost time: 0.6583824157714844
Epoch: 6, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.505 Vali Acc: 0.441 Test Loss: 1.505 Test Acc: 0.441
Validation loss decreased (-0.399984 --> -0.440726).  Saving model ...
Epoch: 7 cost time: 0.6087677478790283
Epoch: 7, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.411 Vali Acc: 0.515 Test Loss: 1.411 Test Acc: 0.515
Validation loss decreased (-0.440726 --> -0.514801).  Saving model ...
Epoch: 8 cost time: 0.6070311069488525
Epoch: 8, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.314 Vali Acc: 0.604 Test Loss: 1.314 Test Acc: 0.604
Validation loss decreased (-0.514801 --> -0.603691).  Saving model ...
Epoch: 9 cost time: 0.5683679580688477
Epoch: 9, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.216 Vali Acc: 0.704 Test Loss: 1.216 Test Acc: 0.704
Validation loss decreased (-0.603691 --> -0.703692).  Saving model ...
Epoch: 10 cost time: 0.632171630859375
Epoch: 10, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.119 Vali Acc: 0.759 Test Loss: 1.119 Test Acc: 0.759
Validation loss decreased (-0.703692 --> -0.759248).  Saving model ...
Epoch: 11 cost time: 0.5295822620391846
Epoch: 11, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.023 Vali Acc: 0.804 Test Loss: 1.023 Test Acc: 0.804
Validation loss decreased (-0.759248 --> -0.803693).  Saving model ...
Epoch: 12 cost time: 0.6749913692474365
Epoch: 12, Steps: 2 | Train Loss: 0.988 Vali Loss: 0.935 Vali Acc: 0.830 Test Loss: 0.935 Test Acc: 0.830
Validation loss decreased (-0.803693 --> -0.829620).  Saving model ...
Epoch: 13 cost time: 0.5344016551971436
Epoch: 13, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.852 Vali Acc: 0.844 Test Loss: 0.852 Test Acc: 0.844
Validation loss decreased (-0.829620 --> -0.844436).  Saving model ...
Epoch: 14 cost time: 0.659874439239502
Epoch: 14, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.780 Vali Acc: 0.852 Test Loss: 0.780 Test Acc: 0.852
Validation loss decreased (-0.844436 --> -0.851844).  Saving model ...
Epoch: 15 cost time: 0.6122510433197021
Epoch: 15, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.711 Vali Acc: 0.863 Test Loss: 0.711 Test Acc: 0.863
Validation loss decreased (-0.851844 --> -0.862956).  Saving model ...
Epoch: 16 cost time: 0.653740406036377
Epoch: 16, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.647 Vali Acc: 0.885 Test Loss: 0.647 Test Acc: 0.885
Validation loss decreased (-0.862956 --> -0.885179).  Saving model ...
Epoch: 17 cost time: 0.6285758018493652
Epoch: 17, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.585 Vali Acc: 0.911 Test Loss: 0.585 Test Acc: 0.911
Validation loss decreased (-0.885179 --> -0.911105).  Saving model ...
Epoch: 18 cost time: 0.7369232177734375
Epoch: 18, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.532 Vali Acc: 0.926 Test Loss: 0.532 Test Acc: 0.926
Validation loss decreased (-0.911105 --> -0.925921).  Saving model ...
Epoch: 19 cost time: 0.772881269454956
Epoch: 19, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.485 Vali Acc: 0.933 Test Loss: 0.485 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933328).  Saving model ...
Epoch: 20 cost time: 0.5998451709747314
Epoch: 20, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.445 Vali Acc: 0.937 Test Loss: 0.445 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937033).  Saving model ...
Epoch: 21 cost time: 0.6659717559814453
Epoch: 21, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.407 Vali Acc: 0.944 Test Loss: 0.407 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944440).  Saving model ...
Epoch: 22 cost time: 0.6422405242919922
Epoch: 22, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.375 Vali Acc: 0.944 Test Loss: 0.375 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 23 cost time: 0.6710100173950195
Epoch: 23, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.347 Vali Acc: 0.944 Test Loss: 0.347 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 24 cost time: 0.7200429439544678
Epoch: 24, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 25 cost time: 0.6476502418518066
Epoch: 25, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.301 Vali Acc: 0.937 Test Loss: 0.301 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6992847919464111
Epoch: 26, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7193887233734131
Epoch: 27, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5615963935852051
Epoch: 28, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7164332866668701
Epoch: 29, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6087265014648438
Epoch: 30, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.758836030960083
Epoch: 31, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6051714420318604
Epoch: 32, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5384066104888916
Epoch: 33, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.566340446472168
Epoch: 34, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.556640625
Epoch: 35, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6260714530944824
Epoch: 36, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8435261249542236
Epoch: 37, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6189925670623779
Epoch: 38, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6631078720092773
Epoch: 39, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7109005451202393
Epoch: 40, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7479026317596436
Epoch: 41, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6789908409118652
Epoch: 42, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 34870
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3627235889434814
Epoch: 1, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.755 Vali Acc: 0.263 Test Loss: 1.755 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 0.5955767631530762
Epoch: 2, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.718 Vali Acc: 0.307 Test Loss: 1.718 Test Acc: 0.307
Validation loss decreased (-0.262945 --> -0.307390).  Saving model ...
Epoch: 3 cost time: 0.7021522521972656
Epoch: 3, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.690 Vali Acc: 0.348 Test Loss: 1.690 Test Acc: 0.348
Validation loss decreased (-0.307390 --> -0.348131).  Saving model ...
Epoch: 4 cost time: 0.5008368492126465
Epoch: 4, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.662 Vali Acc: 0.393 Test Loss: 1.662 Test Acc: 0.393
Validation loss decreased (-0.348131 --> -0.392576).  Saving model ...
Epoch: 5 cost time: 0.5721313953399658
Epoch: 5, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.624 Vali Acc: 0.426 Test Loss: 1.624 Test Acc: 0.426
Validation loss decreased (-0.392576 --> -0.425910).  Saving model ...
Epoch: 6 cost time: 0.506737232208252
Epoch: 6, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.578 Vali Acc: 0.459 Test Loss: 1.578 Test Acc: 0.459
Validation loss decreased (-0.425910 --> -0.459243).  Saving model ...
Epoch: 7 cost time: 0.5978493690490723
Epoch: 7, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.526 Vali Acc: 0.478 Test Loss: 1.526 Test Acc: 0.478
Validation loss decreased (-0.459243 --> -0.477763).  Saving model ...
Epoch: 8 cost time: 0.5717117786407471
Epoch: 8, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.470 Vali Acc: 0.511 Test Loss: 1.470 Test Acc: 0.511
Validation loss decreased (-0.477763 --> -0.511096).  Saving model ...
Epoch: 9 cost time: 0.5804824829101562
Epoch: 9, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.410 Vali Acc: 0.548 Test Loss: 1.410 Test Acc: 0.548
Validation loss decreased (-0.511096 --> -0.548134).  Saving model ...
Epoch: 10 cost time: 0.6245131492614746
Epoch: 10, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.349 Vali Acc: 0.578 Test Loss: 1.349 Test Acc: 0.578
Validation loss decreased (-0.548134 --> -0.577764).  Saving model ...
Epoch: 11 cost time: 0.6274645328521729
Epoch: 11, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.287 Vali Acc: 0.619 Test Loss: 1.287 Test Acc: 0.619
Validation loss decreased (-0.577764 --> -0.618506).  Saving model ...
Epoch: 12 cost time: 0.6203434467315674
Epoch: 12, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.224 Vali Acc: 0.641 Test Loss: 1.224 Test Acc: 0.641
Validation loss decreased (-0.618506 --> -0.640728).  Saving model ...
Epoch: 13 cost time: 0.7685298919677734
Epoch: 13, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.162 Vali Acc: 0.681 Test Loss: 1.162 Test Acc: 0.681
Validation loss decreased (-0.640728 --> -0.681470).  Saving model ...
Epoch: 14 cost time: 0.6377842426300049
Epoch: 14, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.101 Vali Acc: 0.744 Test Loss: 1.101 Test Acc: 0.744
Validation loss decreased (-0.681470 --> -0.744433).  Saving model ...
Epoch: 15 cost time: 0.6867477893829346
Epoch: 15, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.041 Vali Acc: 0.789 Test Loss: 1.041 Test Acc: 0.789
Validation loss decreased (-0.744433 --> -0.788878).  Saving model ...
Epoch: 16 cost time: 0.7016990184783936
Epoch: 16, Steps: 2 | Train Loss: 1.036 Vali Loss: 0.983 Vali Acc: 0.807 Test Loss: 0.983 Test Acc: 0.807
Validation loss decreased (-0.788878 --> -0.807398).  Saving model ...
Epoch: 17 cost time: 0.6054332256317139
Epoch: 17, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.927 Vali Acc: 0.819 Test Loss: 0.927 Test Acc: 0.819
Validation loss decreased (-0.807398 --> -0.818509).  Saving model ...
Epoch: 18 cost time: 0.6431944370269775
Epoch: 18, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.873 Vali Acc: 0.852 Test Loss: 0.873 Test Acc: 0.852
Validation loss decreased (-0.818509 --> -0.851843).  Saving model ...
Epoch: 19 cost time: 0.6476006507873535
Epoch: 19, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.823 Vali Acc: 0.870 Test Loss: 0.823 Test Acc: 0.870
Validation loss decreased (-0.851843 --> -0.870362).  Saving model ...
Epoch: 20 cost time: 0.6671245098114014
Epoch: 20, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.775 Vali Acc: 0.874 Test Loss: 0.775 Test Acc: 0.874
Validation loss decreased (-0.870362 --> -0.874066).  Saving model ...
Epoch: 21 cost time: 0.6517443656921387
Epoch: 21, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.729 Vali Acc: 0.878 Test Loss: 0.729 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877770).  Saving model ...
Epoch: 22 cost time: 0.7044453620910645
Epoch: 22, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.685 Vali Acc: 0.881 Test Loss: 0.685 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881475).  Saving model ...
Epoch: 23 cost time: 0.6130774021148682
Epoch: 23, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.643 Vali Acc: 0.885 Test Loss: 0.643 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 24 cost time: 0.8221666812896729
Epoch: 24, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.604 Vali Acc: 0.900 Test Loss: 0.604 Test Acc: 0.900
Validation loss decreased (-0.885179 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.6746437549591064
Epoch: 25, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.568 Vali Acc: 0.915 Test Loss: 0.568 Test Acc: 0.915
Validation loss decreased (-0.899994 --> -0.914809).  Saving model ...
Epoch: 26 cost time: 0.6103246212005615
Epoch: 26, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.536 Vali Acc: 0.919 Test Loss: 0.536 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 27 cost time: 0.6032521724700928
Epoch: 27, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.503 Vali Acc: 0.922 Test Loss: 0.503 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 28 cost time: 0.593787431716919
Epoch: 28, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.475 Vali Acc: 0.915 Test Loss: 0.475 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6356353759765625
Epoch: 29, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.449 Vali Acc: 0.919 Test Loss: 0.449 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6408827304840088
Epoch: 30, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.428 Vali Acc: 0.919 Test Loss: 0.428 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5596535205841064
Epoch: 31, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.409 Vali Acc: 0.919 Test Loss: 0.409 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6198339462280273
Epoch: 32, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.392 Vali Acc: 0.922 Test Loss: 0.392 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 33 cost time: 0.55889892578125
Epoch: 33, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 34 cost time: 0.6771667003631592
Epoch: 34, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.363 Vali Acc: 0.919 Test Loss: 0.363 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6067979335784912
Epoch: 35, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.350 Vali Acc: 0.919 Test Loss: 0.350 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6599361896514893
Epoch: 36, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.337 Vali Acc: 0.919 Test Loss: 0.337 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6120071411132812
Epoch: 37, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.324 Vali Acc: 0.919 Test Loss: 0.324 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.638880729675293
Epoch: 38, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 39 cost time: 0.7536358833312988
Epoch: 39, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.300 Vali Acc: 0.926 Test Loss: 0.300 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 40 cost time: 0.7504498958587646
Epoch: 40, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.290 Vali Acc: 0.926 Test Loss: 0.290 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 41 cost time: 0.7312307357788086
Epoch: 41, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 42 cost time: 0.5811722278594971
Epoch: 42, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.271 Vali Acc: 0.926 Test Loss: 0.271 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 43 cost time: 0.6868200302124023
Epoch: 43, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5753488540649414
Epoch: 44, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6378686428070068
Epoch: 45, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.253 Vali Acc: 0.919 Test Loss: 0.253 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6693999767303467
Epoch: 46, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.248 Vali Acc: 0.919 Test Loss: 0.248 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6802120208740234
Epoch: 47, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.655815839767456
Epoch: 48, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5915493965148926
Epoch: 49, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7224280834197998
Epoch: 50, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 51 cost time: 0.6517419815063477
Epoch: 51, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 52 cost time: 0.6051433086395264
Epoch: 52, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 53 cost time: 0.6581389904022217
Epoch: 53, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 54 cost time: 0.5761315822601318
Epoch: 54, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 55 cost time: 0.6751589775085449
Epoch: 55, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 56 cost time: 0.6365180015563965
Epoch: 56, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 57 cost time: 0.726414680480957
Epoch: 57, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 58 cost time: 0.5928990840911865
Epoch: 58, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 0.5843026638031006
Epoch: 59, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 60 cost time: 0.6779158115386963
Epoch: 60, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 61 cost time: 0.581779956817627
Epoch: 61, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 62 cost time: 0.7753129005432129
Epoch: 62, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 63 cost time: 0.6195650100708008
Epoch: 63, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6853482723236084
Epoch: 64, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 65 cost time: 0.5758609771728516
Epoch: 65, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 66 cost time: 0.8163797855377197
Epoch: 66, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 67 cost time: 0.7326338291168213
Epoch: 67, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 68 cost time: 0.6450235843658447
Epoch: 68, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 69 cost time: 0.6141767501831055
Epoch: 69, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 70 cost time: 0.7110543251037598
Epoch: 70, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 71 cost time: 0.7399828433990479
Epoch: 71, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 72 cost time: 0.6422080993652344
Epoch: 72, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 73 cost time: 0.706106424331665
Epoch: 73, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 74 cost time: 0.7549715042114258
Epoch: 74, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 75 cost time: 0.6649751663208008
Epoch: 75, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 76 cost time: 0.6927609443664551
Epoch: 76, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 77 cost time: 0.5492942333221436
Epoch: 77, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 78 cost time: 0.5394546985626221
Epoch: 78, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.5962667465209961
Epoch: 79, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.6241714954376221
Epoch: 80, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.4945082664489746
Epoch: 81, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.6021652221679688
Epoch: 82, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.6933228969573975
Epoch: 83, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.5796651840209961
Epoch: 84, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.5935976505279541
Epoch: 85, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 86 cost time: 0.5888679027557373
Epoch: 86, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 87 cost time: 0.6590938568115234
Epoch: 87, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 88 cost time: 0.7092328071594238
Epoch: 88, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 89 cost time: 0.6298978328704834
Epoch: 89, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 90 cost time: 0.6443264484405518
Epoch: 90, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 91 cost time: 0.691875696182251
Epoch: 91, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 92 cost time: 0.7587912082672119
Epoch: 92, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 93 cost time: 0.6999702453613281
Epoch: 93, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 94 cost time: 0.6131608486175537
Epoch: 94, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 95 cost time: 0.6598937511444092
Epoch: 95, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.5981919765472412
Epoch: 96, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.6337957382202148
Epoch: 97, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.6565401554107666
Epoch: 98, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.6936273574829102
Epoch: 99, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 100 cost time: 0.6561901569366455
Epoch: 100, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 22230
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.153770685195923
Epoch: 1, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.942 Vali Acc: 0.189 Test Loss: 1.942 Test Acc: 0.189
Validation loss decreased (inf --> -0.188869).  Saving model ...
Epoch: 2 cost time: 0.5213594436645508
Epoch: 2, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.893 Vali Acc: 0.189 Test Loss: 1.893 Test Acc: 0.189
Validation loss decreased (-0.188869 --> -0.188870).  Saving model ...
Epoch: 3 cost time: 0.4895186424255371
Epoch: 3, Steps: 2 | Train Loss: 1.923 Vali Loss: 1.854 Vali Acc: 0.196 Test Loss: 1.854 Test Acc: 0.196
Validation loss decreased (-0.188870 --> -0.196278).  Saving model ...
Epoch: 4 cost time: 0.5049910545349121
Epoch: 4, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.817 Vali Acc: 0.207 Test Loss: 1.817 Test Acc: 0.207
Validation loss decreased (-0.196278 --> -0.207389).  Saving model ...
Epoch: 5 cost time: 0.5569403171539307
Epoch: 5, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.771 Vali Acc: 0.244 Test Loss: 1.771 Test Acc: 0.244
Validation loss decreased (-0.207389 --> -0.244427).  Saving model ...
Epoch: 6 cost time: 0.5890903472900391
Epoch: 6, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.719 Vali Acc: 0.263 Test Loss: 1.719 Test Acc: 0.263
Validation loss decreased (-0.244427 --> -0.262946).  Saving model ...
Epoch: 7 cost time: 0.5593733787536621
Epoch: 7, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.663 Vali Acc: 0.285 Test Loss: 1.663 Test Acc: 0.285
Validation loss decreased (-0.262946 --> -0.285169).  Saving model ...
Epoch: 8 cost time: 0.8133955001831055
Epoch: 8, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.603 Vali Acc: 0.315 Test Loss: 1.603 Test Acc: 0.315
Validation loss decreased (-0.285169 --> -0.314799).  Saving model ...
Epoch: 9 cost time: 0.600900411605835
Epoch: 9, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.539 Vali Acc: 0.367 Test Loss: 1.539 Test Acc: 0.367
Validation loss decreased (-0.314799 --> -0.366651).  Saving model ...
Epoch: 10 cost time: 0.5841398239135742
Epoch: 10, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.474 Vali Acc: 0.456 Test Loss: 1.474 Test Acc: 0.456
Validation loss decreased (-0.366651 --> -0.455541).  Saving model ...
Epoch: 11 cost time: 0.5931189060211182
Epoch: 11, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.408 Vali Acc: 0.519 Test Loss: 1.408 Test Acc: 0.519
Validation loss decreased (-0.455541 --> -0.518504).  Saving model ...
Epoch: 12 cost time: 0.6254444122314453
Epoch: 12, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.340 Vali Acc: 0.581 Test Loss: 1.340 Test Acc: 0.581
Validation loss decreased (-0.518504 --> -0.581468).  Saving model ...
Epoch: 13 cost time: 0.5840318202972412
Epoch: 13, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.273 Vali Acc: 0.637 Test Loss: 1.273 Test Acc: 0.637
Validation loss decreased (-0.581468 --> -0.637024).  Saving model ...
Epoch: 14 cost time: 0.5872256755828857
Epoch: 14, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.207 Vali Acc: 0.696 Test Loss: 1.207 Test Acc: 0.696
Validation loss decreased (-0.637024 --> -0.696284).  Saving model ...
Epoch: 15 cost time: 0.6951587200164795
Epoch: 15, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.143 Vali Acc: 0.759 Test Loss: 1.143 Test Acc: 0.759
Validation loss decreased (-0.696284 --> -0.759248).  Saving model ...
Epoch: 16 cost time: 0.6561298370361328
Epoch: 16, Steps: 2 | Train Loss: 1.119 Vali Loss: 1.082 Vali Acc: 0.770 Test Loss: 1.082 Test Acc: 0.770
Validation loss decreased (-0.759248 --> -0.770360).  Saving model ...
Epoch: 17 cost time: 0.5705363750457764
Epoch: 17, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.023 Vali Acc: 0.785 Test Loss: 1.023 Test Acc: 0.785
Validation loss decreased (-0.770360 --> -0.785175).  Saving model ...
Epoch: 18 cost time: 0.6304571628570557
Epoch: 18, Steps: 2 | Train Loss: 1.026 Vali Loss: 0.967 Vali Acc: 0.822 Test Loss: 0.967 Test Acc: 0.822
Validation loss decreased (-0.785175 --> -0.822213).  Saving model ...
Epoch: 19 cost time: 0.599233865737915
Epoch: 19, Steps: 2 | Train Loss: 0.930 Vali Loss: 0.913 Vali Acc: 0.841 Test Loss: 0.913 Test Acc: 0.841
Validation loss decreased (-0.822213 --> -0.840732).  Saving model ...
Epoch: 20 cost time: 0.695427417755127
Epoch: 20, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.861 Vali Acc: 0.856 Test Loss: 0.861 Test Acc: 0.856
Validation loss decreased (-0.840732 --> -0.855547).  Saving model ...
Epoch: 21 cost time: 0.6923208236694336
Epoch: 21, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.812 Vali Acc: 0.863 Test Loss: 0.812 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862955).  Saving model ...
Epoch: 22 cost time: 0.595073938369751
Epoch: 22, Steps: 2 | Train Loss: 0.716 Vali Loss: 0.765 Vali Acc: 0.870 Test Loss: 0.765 Test Acc: 0.870
Validation loss decreased (-0.862955 --> -0.870363).  Saving model ...
Epoch: 23 cost time: 0.5284416675567627
Epoch: 23, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.722 Vali Acc: 0.878 Test Loss: 0.722 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 24 cost time: 0.6298751831054688
Epoch: 24, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.681 Vali Acc: 0.881 Test Loss: 0.681 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 25 cost time: 0.6505789756774902
Epoch: 25, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.643 Vali Acc: 0.881 Test Loss: 0.643 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 26 cost time: 0.5868091583251953
Epoch: 26, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.607 Vali Acc: 0.904 Test Loss: 0.607 Test Acc: 0.904
Validation loss decreased (-0.881475 --> -0.903698).  Saving model ...
Epoch: 27 cost time: 0.48255228996276855
Epoch: 27, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.573 Vali Acc: 0.904 Test Loss: 0.573 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 28 cost time: 0.500436544418335
Epoch: 28, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.541 Vali Acc: 0.907 Test Loss: 0.541 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 29 cost time: 0.4577181339263916
Epoch: 29, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.511 Vali Acc: 0.911 Test Loss: 0.511 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 30 cost time: 0.5677027702331543
Epoch: 30, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.484 Vali Acc: 0.922 Test Loss: 0.484 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922217).  Saving model ...
Epoch: 31 cost time: 0.6046338081359863
Epoch: 31, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.458 Vali Acc: 0.919 Test Loss: 0.458 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.580394983291626
Epoch: 32, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.435 Vali Acc: 0.930 Test Loss: 0.435 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 33 cost time: 0.5732429027557373
Epoch: 33, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.414 Vali Acc: 0.930 Test Loss: 0.414 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 34 cost time: 0.5945389270782471
Epoch: 34, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.395 Vali Acc: 0.933 Test Loss: 0.395 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 35 cost time: 0.642315149307251
Epoch: 35, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.378 Vali Acc: 0.930 Test Loss: 0.378 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6206634044647217
Epoch: 36, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.362 Vali Acc: 0.937 Test Loss: 0.362 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 37 cost time: 0.6119973659515381
Epoch: 37, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6467604637145996
Epoch: 38, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.337 Vali Acc: 0.930 Test Loss: 0.337 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6108145713806152
Epoch: 39, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.633105993270874
Epoch: 40, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.317 Vali Acc: 0.922 Test Loss: 0.317 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5987222194671631
Epoch: 41, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.308 Vali Acc: 0.926 Test Loss: 0.308 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6462862491607666
Epoch: 42, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.300 Vali Acc: 0.926 Test Loss: 0.300 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5742666721343994
Epoch: 43, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6929929256439209
Epoch: 44, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5808980464935303
Epoch: 45, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6186091899871826
Epoch: 46, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.270 Vali Acc: 0.930 Test Loss: 0.270 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 18406
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.070629358291626
Epoch: 1, Steps: 2 | Train Loss: 2.048 Vali Loss: 2.000 Vali Acc: 0.167 Test Loss: 2.000 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.5212652683258057
Epoch: 2, Steps: 2 | Train Loss: 1.965 Vali Loss: 1.947 Vali Acc: 0.170 Test Loss: 1.947 Test Acc: 0.170
Validation loss decreased (-0.166647 --> -0.170351).  Saving model ...
Epoch: 3 cost time: 0.5311312675476074
Epoch: 3, Steps: 2 | Train Loss: 2.003 Vali Loss: 1.908 Vali Acc: 0.181 Test Loss: 1.908 Test Acc: 0.181
Validation loss decreased (-0.170351 --> -0.181462).  Saving model ...
Epoch: 4 cost time: 0.6152782440185547
Epoch: 4, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.877 Vali Acc: 0.193 Test Loss: 1.877 Test Acc: 0.193
Validation loss decreased (-0.181462 --> -0.192574).  Saving model ...
Epoch: 5 cost time: 0.5238513946533203
Epoch: 5, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.842 Vali Acc: 0.200 Test Loss: 1.842 Test Acc: 0.200
Validation loss decreased (-0.192574 --> -0.199982).  Saving model ...
Epoch: 6 cost time: 0.5610926151275635
Epoch: 6, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.807 Vali Acc: 0.226 Test Loss: 1.807 Test Acc: 0.226
Validation loss decreased (-0.199982 --> -0.225908).  Saving model ...
Epoch: 7 cost time: 0.5659730434417725
Epoch: 7, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.769 Vali Acc: 0.259 Test Loss: 1.769 Test Acc: 0.259
Validation loss decreased (-0.225908 --> -0.259242).  Saving model ...
Epoch: 8 cost time: 0.5435988903045654
Epoch: 8, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.728 Vali Acc: 0.289 Test Loss: 1.728 Test Acc: 0.289
Validation loss decreased (-0.259242 --> -0.288872).  Saving model ...
Epoch: 9 cost time: 0.5696368217468262
Epoch: 9, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.686 Vali Acc: 0.326 Test Loss: 1.686 Test Acc: 0.326
Validation loss decreased (-0.288872 --> -0.325909).  Saving model ...
Epoch: 10 cost time: 0.558936357498169
Epoch: 10, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.642 Vali Acc: 0.348 Test Loss: 1.642 Test Acc: 0.348
Validation loss decreased (-0.325909 --> -0.348132).  Saving model ...
Epoch: 11 cost time: 0.5305371284484863
Epoch: 11, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.597 Vali Acc: 0.378 Test Loss: 1.597 Test Acc: 0.378
Validation loss decreased (-0.348132 --> -0.377762).  Saving model ...
Epoch: 12 cost time: 0.5992653369903564
Epoch: 12, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.550 Vali Acc: 0.393 Test Loss: 1.550 Test Acc: 0.393
Validation loss decreased (-0.377762 --> -0.392577).  Saving model ...
Epoch: 13 cost time: 0.5714178085327148
Epoch: 13, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.502 Vali Acc: 0.426 Test Loss: 1.502 Test Acc: 0.426
Validation loss decreased (-0.392577 --> -0.425911).  Saving model ...
Epoch: 14 cost time: 0.6604018211364746
Epoch: 14, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.454 Vali Acc: 0.467 Test Loss: 1.454 Test Acc: 0.467
Validation loss decreased (-0.425911 --> -0.466652).  Saving model ...
Epoch: 15 cost time: 0.5445935726165771
Epoch: 15, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.405 Vali Acc: 0.537 Test Loss: 1.405 Test Acc: 0.537
Validation loss decreased (-0.466652 --> -0.537023).  Saving model ...
Epoch: 16 cost time: 0.677405834197998
Epoch: 16, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.354 Vali Acc: 0.604 Test Loss: 1.354 Test Acc: 0.604
Validation loss decreased (-0.537023 --> -0.603690).  Saving model ...
Epoch: 17 cost time: 0.6751389503479004
Epoch: 17, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.304 Vali Acc: 0.633 Test Loss: 1.304 Test Acc: 0.633
Validation loss decreased (-0.603690 --> -0.633320).  Saving model ...
Epoch: 18 cost time: 0.591989278793335
Epoch: 18, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.253 Vali Acc: 0.652 Test Loss: 1.253 Test Acc: 0.652
Validation loss decreased (-0.633320 --> -0.651839).  Saving model ...
Epoch: 19 cost time: 0.5724658966064453
Epoch: 19, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.203 Vali Acc: 0.678 Test Loss: 1.203 Test Acc: 0.678
Validation loss decreased (-0.651839 --> -0.677766).  Saving model ...
Epoch: 20 cost time: 0.5536527633666992
Epoch: 20, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.153 Vali Acc: 0.696 Test Loss: 1.153 Test Acc: 0.696
Validation loss decreased (-0.677766 --> -0.696285).  Saving model ...
Epoch: 21 cost time: 0.5532710552215576
Epoch: 21, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.103 Vali Acc: 0.733 Test Loss: 1.103 Test Acc: 0.733
Validation loss decreased (-0.696285 --> -0.733322).  Saving model ...
Epoch: 22 cost time: 0.560497522354126
Epoch: 22, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.055 Vali Acc: 0.737 Test Loss: 1.055 Test Acc: 0.737
Validation loss decreased (-0.733322 --> -0.737026).  Saving model ...
Epoch: 23 cost time: 0.6901867389678955
Epoch: 23, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.008 Vali Acc: 0.756 Test Loss: 1.008 Test Acc: 0.756
Validation loss decreased (-0.737026 --> -0.755545).  Saving model ...
Epoch: 24 cost time: 0.5358128547668457
Epoch: 24, Steps: 2 | Train Loss: 1.003 Vali Loss: 0.963 Vali Acc: 0.793 Test Loss: 0.963 Test Acc: 0.793
Validation loss decreased (-0.755545 --> -0.792583).  Saving model ...
Epoch: 25 cost time: 0.5395240783691406
Epoch: 25, Steps: 2 | Train Loss: 0.921 Vali Loss: 0.920 Vali Acc: 0.819 Test Loss: 0.920 Test Acc: 0.819
Validation loss decreased (-0.792583 --> -0.818509).  Saving model ...
Epoch: 26 cost time: 0.49269533157348633
Epoch: 26, Steps: 2 | Train Loss: 0.956 Vali Loss: 0.878 Vali Acc: 0.841 Test Loss: 0.878 Test Acc: 0.841
Validation loss decreased (-0.818509 --> -0.840732).  Saving model ...
Epoch: 27 cost time: 0.5432054996490479
Epoch: 27, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.838 Vali Acc: 0.863 Test Loss: 0.838 Test Acc: 0.863
Validation loss decreased (-0.840732 --> -0.862955).  Saving model ...
Epoch: 28 cost time: 0.4698789119720459
Epoch: 28, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.799 Vali Acc: 0.878 Test Loss: 0.799 Test Acc: 0.878
Validation loss decreased (-0.862955 --> -0.877770).  Saving model ...
Epoch: 29 cost time: 0.5988638401031494
Epoch: 29, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.764 Vali Acc: 0.881 Test Loss: 0.764 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 30 cost time: 0.5134687423706055
Epoch: 30, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.730 Vali Acc: 0.889 Test Loss: 0.730 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888882).  Saving model ...
Epoch: 31 cost time: 0.4929695129394531
Epoch: 31, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.697 Vali Acc: 0.896 Test Loss: 0.697 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896289).  Saving model ...
Epoch: 32 cost time: 0.6561086177825928
Epoch: 32, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.665 Vali Acc: 0.915 Test Loss: 0.665 Test Acc: 0.915
Validation loss decreased (-0.896289 --> -0.914808).  Saving model ...
Epoch: 33 cost time: 0.5845108032226562
Epoch: 33, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.635 Vali Acc: 0.922 Test Loss: 0.635 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 34 cost time: 0.529026985168457
Epoch: 34, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.604 Vali Acc: 0.926 Test Loss: 0.604 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 35 cost time: 0.5245654582977295
Epoch: 35, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.576 Vali Acc: 0.930 Test Loss: 0.576 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 36 cost time: 0.5310063362121582
Epoch: 36, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.549 Vali Acc: 0.926 Test Loss: 0.549 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6550745964050293
Epoch: 37, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.524 Vali Acc: 0.926 Test Loss: 0.524 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5967292785644531
Epoch: 38, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.501 Vali Acc: 0.937 Test Loss: 0.501 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 39 cost time: 0.6651101112365723
Epoch: 39, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.479 Vali Acc: 0.937 Test Loss: 0.479 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 40 cost time: 0.6219511032104492
Epoch: 40, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.460 Vali Acc: 0.941 Test Loss: 0.460 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 41 cost time: 0.6045024394989014
Epoch: 41, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.441 Vali Acc: 0.941 Test Loss: 0.441 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 42 cost time: 0.6106536388397217
Epoch: 42, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.424 Vali Acc: 0.937 Test Loss: 0.424 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6670224666595459
Epoch: 43, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.409 Vali Acc: 0.937 Test Loss: 0.409 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6302182674407959
Epoch: 44, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.392 Vali Acc: 0.944 Test Loss: 0.392 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944441).  Saving model ...
Epoch: 45 cost time: 0.6192820072174072
Epoch: 45, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.378 Vali Acc: 0.944 Test Loss: 0.378 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 46 cost time: 0.5766468048095703
Epoch: 46, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.365 Vali Acc: 0.941 Test Loss: 0.365 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6460692882537842
Epoch: 47, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.353 Vali Acc: 0.944 Test Loss: 0.353 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 48 cost time: 0.5862689018249512
Epoch: 48, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 49 cost time: 0.6937401294708252
Epoch: 49, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.334 Vali Acc: 0.944 Test Loss: 0.334 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 50 cost time: 0.5888469219207764
Epoch: 50, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5984616279602051
Epoch: 51, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.316 Vali Acc: 0.944 Test Loss: 0.316 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 52 cost time: 0.6598756313323975
Epoch: 52, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 53 cost time: 0.572422981262207
Epoch: 53, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.300 Vali Acc: 0.944 Test Loss: 0.300 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 54 cost time: 0.6339907646179199
Epoch: 54, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.5538678169250488
Epoch: 55, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.287 Vali Acc: 0.952 Test Loss: 0.287 Test Acc: 0.952
Validation loss decreased (-0.944442 --> -0.951849).  Saving model ...
Epoch: 56 cost time: 0.5597958564758301
Epoch: 56, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.282 Vali Acc: 0.952 Test Loss: 0.282 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 57 cost time: 0.5983307361602783
Epoch: 57, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.276 Vali Acc: 0.952 Test Loss: 0.276 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 58 cost time: 0.5250060558319092
Epoch: 58, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.272 Vali Acc: 0.948 Test Loss: 0.272 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5421125888824463
Epoch: 59, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.267 Vali Acc: 0.948 Test Loss: 0.267 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5470266342163086
Epoch: 60, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.263 Vali Acc: 0.948 Test Loss: 0.263 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5393960475921631
Epoch: 61, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.259 Vali Acc: 0.948 Test Loss: 0.259 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.5586166381835938
Epoch: 62, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.5323328971862793
Epoch: 63, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.6375622749328613
Epoch: 64, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.6218163967132568
Epoch: 65, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.626563549041748
Epoch: 66, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.6559803485870361
Epoch: 67, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 16134
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5339341163635254
Epoch: 1, Steps: 2 | Train Loss: 1.993 Vali Loss: 1.947 Vali Acc: 0.181 Test Loss: 1.947 Test Acc: 0.181
Validation loss decreased (inf --> -0.181462).  Saving model ...
Epoch: 2 cost time: 0.5989973545074463
Epoch: 2, Steps: 2 | Train Loss: 1.967 Vali Loss: 1.915 Vali Acc: 0.189 Test Loss: 1.915 Test Acc: 0.189
Validation loss decreased (-0.181462 --> -0.188870).  Saving model ...
Epoch: 3 cost time: 0.5923490524291992
Epoch: 3, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.892 Vali Acc: 0.215 Test Loss: 1.892 Test Acc: 0.215
Validation loss decreased (-0.188870 --> -0.214796).  Saving model ...
Epoch: 4 cost time: 0.6190142631530762
Epoch: 4, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.874 Vali Acc: 0.219 Test Loss: 1.874 Test Acc: 0.219
Validation loss decreased (-0.214796 --> -0.218500).  Saving model ...
Epoch: 5 cost time: 0.6344292163848877
Epoch: 5, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.852 Vali Acc: 0.230 Test Loss: 1.852 Test Acc: 0.230
Validation loss decreased (-0.218500 --> -0.229611).  Saving model ...
Epoch: 6 cost time: 0.6471173763275146
Epoch: 6, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.826 Vali Acc: 0.259 Test Loss: 1.826 Test Acc: 0.259
Validation loss decreased (-0.229611 --> -0.259241).  Saving model ...
Epoch: 7 cost time: 0.6197538375854492
Epoch: 7, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.797 Vali Acc: 0.278 Test Loss: 1.797 Test Acc: 0.278
Validation loss decreased (-0.259241 --> -0.277760).  Saving model ...
Epoch: 8 cost time: 0.6312768459320068
Epoch: 8, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.765 Vali Acc: 0.304 Test Loss: 1.765 Test Acc: 0.304
Validation loss decreased (-0.277760 --> -0.303686).  Saving model ...
Epoch: 9 cost time: 0.6167647838592529
Epoch: 9, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.731 Vali Acc: 0.333 Test Loss: 1.731 Test Acc: 0.333
Validation loss decreased (-0.303686 --> -0.333316).  Saving model ...
Epoch: 10 cost time: 0.7691819667816162
Epoch: 10, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.694 Vali Acc: 0.348 Test Loss: 1.694 Test Acc: 0.348
Validation loss decreased (-0.333316 --> -0.348131).  Saving model ...
Epoch: 11 cost time: 0.6861116886138916
Epoch: 11, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.655 Vali Acc: 0.389 Test Loss: 1.655 Test Acc: 0.389
Validation loss decreased (-0.348131 --> -0.388872).  Saving model ...
Epoch: 12 cost time: 0.7103452682495117
Epoch: 12, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.614 Vali Acc: 0.411 Test Loss: 1.614 Test Acc: 0.411
Validation loss decreased (-0.388872 --> -0.411095).  Saving model ...
Epoch: 13 cost time: 0.7028653621673584
Epoch: 13, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.572 Vali Acc: 0.452 Test Loss: 1.572 Test Acc: 0.452
Validation loss decreased (-0.411095 --> -0.451836).  Saving model ...
Epoch: 14 cost time: 0.5373783111572266
Epoch: 14, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.528 Vali Acc: 0.463 Test Loss: 1.528 Test Acc: 0.463
Validation loss decreased (-0.451836 --> -0.462948).  Saving model ...
Epoch: 15 cost time: 0.5190863609313965
Epoch: 15, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.485 Vali Acc: 0.481 Test Loss: 1.485 Test Acc: 0.481
Validation loss decreased (-0.462948 --> -0.481467).  Saving model ...
Epoch: 16 cost time: 0.5224902629852295
Epoch: 16, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.440 Vali Acc: 0.507 Test Loss: 1.440 Test Acc: 0.507
Validation loss decreased (-0.481467 --> -0.507393).  Saving model ...
Epoch: 17 cost time: 0.621823787689209
Epoch: 17, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.394 Vali Acc: 0.541 Test Loss: 1.394 Test Acc: 0.541
Validation loss decreased (-0.507393 --> -0.540727).  Saving model ...
Epoch: 18 cost time: 0.5595579147338867
Epoch: 18, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.348 Vali Acc: 0.556 Test Loss: 1.348 Test Acc: 0.556
Validation loss decreased (-0.540727 --> -0.555542).  Saving model ...
Epoch: 19 cost time: 0.526111364364624
Epoch: 19, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.302 Vali Acc: 0.570 Test Loss: 1.302 Test Acc: 0.570
Validation loss decreased (-0.555542 --> -0.570357).  Saving model ...
Epoch: 20 cost time: 0.5601546764373779
Epoch: 20, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.257 Vali Acc: 0.596 Test Loss: 1.257 Test Acc: 0.596
Validation loss decreased (-0.570357 --> -0.596284).  Saving model ...
Epoch: 21 cost time: 0.5479388236999512
Epoch: 21, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.212 Vali Acc: 0.619 Test Loss: 1.212 Test Acc: 0.619
Validation loss decreased (-0.596284 --> -0.618506).  Saving model ...
Epoch: 22 cost time: 0.640225887298584
Epoch: 22, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.170 Vali Acc: 0.630 Test Loss: 1.170 Test Acc: 0.630
Validation loss decreased (-0.618506 --> -0.629618).  Saving model ...
Epoch: 23 cost time: 0.6285843849182129
Epoch: 23, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.127 Vali Acc: 0.644 Test Loss: 1.127 Test Acc: 0.644
Validation loss decreased (-0.629618 --> -0.644433).  Saving model ...
Epoch: 24 cost time: 0.7124009132385254
Epoch: 24, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.086 Vali Acc: 0.659 Test Loss: 1.086 Test Acc: 0.659
Validation loss decreased (-0.644433 --> -0.659248).  Saving model ...
Epoch: 25 cost time: 0.5831356048583984
Epoch: 25, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.044 Vali Acc: 0.678 Test Loss: 1.044 Test Acc: 0.678
Validation loss decreased (-0.659248 --> -0.677767).  Saving model ...
Epoch: 26 cost time: 0.6485121250152588
Epoch: 26, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.004 Vali Acc: 0.689 Test Loss: 1.004 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 27 cost time: 0.5579040050506592
Epoch: 27, Steps: 2 | Train Loss: 0.882 Vali Loss: 0.964 Vali Acc: 0.711 Test Loss: 0.964 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711101).  Saving model ...
Epoch: 28 cost time: 0.6711678504943848
Epoch: 28, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.925 Vali Acc: 0.722 Test Loss: 0.925 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 29 cost time: 0.6292603015899658
Epoch: 29, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.888 Vali Acc: 0.741 Test Loss: 0.888 Test Acc: 0.741
Validation loss decreased (-0.722213 --> -0.740732).  Saving model ...
Epoch: 30 cost time: 0.5076217651367188
Epoch: 30, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.853 Vali Acc: 0.759 Test Loss: 0.853 Test Acc: 0.759
Validation loss decreased (-0.740732 --> -0.759251).  Saving model ...
Epoch: 31 cost time: 0.6268351078033447
Epoch: 31, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.819 Vali Acc: 0.778 Test Loss: 0.819 Test Acc: 0.778
Validation loss decreased (-0.759251 --> -0.777770).  Saving model ...
Epoch: 32 cost time: 0.6611371040344238
Epoch: 32, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.785 Vali Acc: 0.793 Test Loss: 0.785 Test Acc: 0.793
Validation loss decreased (-0.777770 --> -0.792585).  Saving model ...
Epoch: 33 cost time: 0.6309683322906494
Epoch: 33, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.752 Vali Acc: 0.807 Test Loss: 0.752 Test Acc: 0.807
Validation loss decreased (-0.792585 --> -0.807400).  Saving model ...
Epoch: 34 cost time: 0.5942223072052002
Epoch: 34, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.720 Vali Acc: 0.830 Test Loss: 0.720 Test Acc: 0.830
Validation loss decreased (-0.807400 --> -0.829622).  Saving model ...
Epoch: 35 cost time: 0.6271805763244629
Epoch: 35, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.690 Vali Acc: 0.826 Test Loss: 0.690 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5793144702911377
Epoch: 36, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.829622 --> -0.833327).  Saving model ...
Epoch: 37 cost time: 0.633976936340332
Epoch: 37, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 38 cost time: 0.7010388374328613
Epoch: 38, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 39 cost time: 0.5268034934997559
Epoch: 39, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.585 Vali Acc: 0.859 Test Loss: 0.585 Test Acc: 0.859
Validation loss decreased (-0.855549 --> -0.859253).  Saving model ...
Epoch: 40 cost time: 0.5720767974853516
Epoch: 40, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.562 Vali Acc: 0.870 Test Loss: 0.562 Test Acc: 0.870
Validation loss decreased (-0.859253 --> -0.870365).  Saving model ...
Epoch: 41 cost time: 0.5831770896911621
Epoch: 41, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.541 Vali Acc: 0.874 Test Loss: 0.541 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 42 cost time: 0.6744916439056396
Epoch: 42, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.521 Vali Acc: 0.870 Test Loss: 0.521 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6071445941925049
Epoch: 43, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.501 Vali Acc: 0.870 Test Loss: 0.501 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5073285102844238
Epoch: 44, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.483 Vali Acc: 0.893 Test Loss: 0.483 Test Acc: 0.893
Validation loss decreased (-0.874069 --> -0.892588).  Saving model ...
Epoch: 45 cost time: 0.48485898971557617
Epoch: 45, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.466 Vali Acc: 0.907 Test Loss: 0.466 Test Acc: 0.907
Validation loss decreased (-0.892588 --> -0.907403).  Saving model ...
Epoch: 46 cost time: 0.520737886428833
Epoch: 46, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.450 Vali Acc: 0.911 Test Loss: 0.450 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 47 cost time: 0.5435709953308105
Epoch: 47, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.436 Vali Acc: 0.911 Test Loss: 0.436 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 48 cost time: 0.5335240364074707
Epoch: 48, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.423 Vali Acc: 0.911 Test Loss: 0.423 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 49 cost time: 0.5038852691650391
Epoch: 49, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.410 Vali Acc: 0.919 Test Loss: 0.410 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918514).  Saving model ...
Epoch: 50 cost time: 0.643803596496582
Epoch: 50, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.398 Vali Acc: 0.919 Test Loss: 0.398 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 51 cost time: 0.7637603282928467
Epoch: 51, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.388 Vali Acc: 0.919 Test Loss: 0.388 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 52 cost time: 0.6366424560546875
Epoch: 52, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.379 Vali Acc: 0.915 Test Loss: 0.379 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5866243839263916
Epoch: 53, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.370 Vali Acc: 0.919 Test Loss: 0.370 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 54 cost time: 0.5978543758392334
Epoch: 54, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.362 Vali Acc: 0.919 Test Loss: 0.362 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 55 cost time: 0.6162171363830566
Epoch: 55, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.354 Vali Acc: 0.915 Test Loss: 0.354 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6575770378112793
Epoch: 56, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 57 cost time: 0.5953254699707031
Epoch: 57, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 58 cost time: 0.5508556365966797
Epoch: 58, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.335 Vali Acc: 0.922 Test Loss: 0.335 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 59 cost time: 0.5808143615722656
Epoch: 59, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 60 cost time: 0.6350662708282471
Epoch: 60, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.322 Vali Acc: 0.922 Test Loss: 0.322 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 61 cost time: 0.6293599605560303
Epoch: 61, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.317 Vali Acc: 0.922 Test Loss: 0.317 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 62 cost time: 0.7575170993804932
Epoch: 62, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 63 cost time: 0.6790132522583008
Epoch: 63, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.306 Vali Acc: 0.922 Test Loss: 0.306 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 64 cost time: 0.6000115871429443
Epoch: 64, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 65 cost time: 0.696617603302002
Epoch: 65, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 66 cost time: 0.588536262512207
Epoch: 66, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 67 cost time: 0.6251406669616699
Epoch: 67, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.288 Vali Acc: 0.926 Test Loss: 0.288 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 68 cost time: 0.5802009105682373
Epoch: 68, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 69 cost time: 0.5695855617523193
Epoch: 69, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.281 Vali Acc: 0.930 Test Loss: 0.281 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 70 cost time: 0.646395206451416
Epoch: 70, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 71 cost time: 0.5607762336730957
Epoch: 71, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 72 cost time: 0.4833714962005615
Epoch: 72, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 73 cost time: 0.5708959102630615
Epoch: 73, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.269 Vali Acc: 0.930 Test Loss: 0.269 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.5819995403289795
Epoch: 74, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.5557997226715088
Epoch: 75, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.7154335975646973
Epoch: 76, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.5286476612091064
Epoch: 77, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.5696685314178467
Epoch: 78, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.7861340045928955
Epoch: 79, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.6202347278594971
Epoch: 80, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.6132557392120361
Epoch: 81, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.6077406406402588
Epoch: 82, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 83 cost time: 0.6829149723052979
Epoch: 83, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 84 cost time: 0.5829288959503174
Epoch: 84, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 85 cost time: 0.6913106441497803
Epoch: 85, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 86 cost time: 0.5578911304473877
Epoch: 86, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 87 cost time: 0.630835771560669
Epoch: 87, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944442).  Saving model ...
Epoch: 88 cost time: 0.4771101474761963
Epoch: 88, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 89 cost time: 0.5594823360443115
Epoch: 89, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 90 cost time: 0.5662431716918945
Epoch: 90, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 91 cost time: 0.5857672691345215
Epoch: 91, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 92 cost time: 0.5905420780181885
Epoch: 92, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 93 cost time: 0.6154253482818604
Epoch: 93, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 94 cost time: 0.5735032558441162
Epoch: 94, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 95 cost time: 0.5930237770080566
Epoch: 95, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 96 cost time: 0.5799143314361572
Epoch: 96, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 97 cost time: 0.7079403400421143
Epoch: 97, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 98 cost time: 0.5945017337799072
Epoch: 98, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 99 cost time: 0.5550627708435059
Epoch: 99, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 100 cost time: 0.593125581741333
Epoch: 100, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 15030
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.400585412979126
Epoch: 1, Steps: 2 | Train Loss: 2.003 Vali Loss: 1.898 Vali Acc: 0.226 Test Loss: 1.898 Test Acc: 0.226
Validation loss decreased (inf --> -0.225907).  Saving model ...
Epoch: 2 cost time: 0.5886049270629883
Epoch: 2, Steps: 2 | Train Loss: 2.004 Vali Loss: 1.860 Vali Acc: 0.230 Test Loss: 1.860 Test Acc: 0.230
Validation loss decreased (-0.225907 --> -0.229611).  Saving model ...
Epoch: 3 cost time: 0.520219087600708
Epoch: 3, Steps: 2 | Train Loss: 1.994 Vali Loss: 1.834 Vali Acc: 0.237 Test Loss: 1.834 Test Acc: 0.237
Validation loss decreased (-0.229611 --> -0.237019).  Saving model ...
Epoch: 4 cost time: 0.694133996963501
Epoch: 4, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.814 Vali Acc: 0.233 Test Loss: 1.814 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6445186138153076
Epoch: 5, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.794 Vali Acc: 0.233 Test Loss: 1.794 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5844552516937256
Epoch: 6, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.771 Vali Acc: 0.230 Test Loss: 1.771 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7200205326080322
Epoch: 7, Steps: 2 | Train Loss: 1.881 Vali Loss: 1.747 Vali Acc: 0.233 Test Loss: 1.747 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6870744228363037
Epoch: 8, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.720 Vali Acc: 0.237 Test Loss: 1.720 Test Acc: 0.237
Validation loss decreased (-0.237019 --> -0.237020).  Saving model ...
Epoch: 9 cost time: 0.614837646484375
Epoch: 9, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.693 Vali Acc: 0.244 Test Loss: 1.693 Test Acc: 0.244
Validation loss decreased (-0.237020 --> -0.244428).  Saving model ...
Epoch: 10 cost time: 0.6844503879547119
Epoch: 10, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.664 Vali Acc: 0.267 Test Loss: 1.664 Test Acc: 0.267
Validation loss decreased (-0.244428 --> -0.266650).  Saving model ...
Epoch: 11 cost time: 0.5916087627410889
Epoch: 11, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.633 Vali Acc: 0.289 Test Loss: 1.633 Test Acc: 0.289
Validation loss decreased (-0.266650 --> -0.288873).  Saving model ...
Epoch: 12 cost time: 0.5429675579071045
Epoch: 12, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.601 Vali Acc: 0.315 Test Loss: 1.601 Test Acc: 0.315
Validation loss decreased (-0.288873 --> -0.314799).  Saving model ...
Epoch: 13 cost time: 0.6065998077392578
Epoch: 13, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.568 Vali Acc: 0.367 Test Loss: 1.568 Test Acc: 0.367
Validation loss decreased (-0.314799 --> -0.366651).  Saving model ...
Epoch: 14 cost time: 0.6686115264892578
Epoch: 14, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.534 Vali Acc: 0.400 Test Loss: 1.534 Test Acc: 0.400
Validation loss decreased (-0.366651 --> -0.399985).  Saving model ...
Epoch: 15 cost time: 0.6837570667266846
Epoch: 15, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.499 Vali Acc: 0.433 Test Loss: 1.499 Test Acc: 0.433
Validation loss decreased (-0.399985 --> -0.433318).  Saving model ...
Epoch: 16 cost time: 0.6663379669189453
Epoch: 16, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.464 Vali Acc: 0.467 Test Loss: 1.464 Test Acc: 0.467
Validation loss decreased (-0.433318 --> -0.466652).  Saving model ...
Epoch: 17 cost time: 0.6099374294281006
Epoch: 17, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.428 Vali Acc: 0.493 Test Loss: 1.428 Test Acc: 0.493
Validation loss decreased (-0.466652 --> -0.492578).  Saving model ...
Epoch: 18 cost time: 0.5979564189910889
Epoch: 18, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.391 Vali Acc: 0.541 Test Loss: 1.391 Test Acc: 0.541
Validation loss decreased (-0.492578 --> -0.540727).  Saving model ...
Epoch: 19 cost time: 0.7608242034912109
Epoch: 19, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.353 Vali Acc: 0.574 Test Loss: 1.353 Test Acc: 0.574
Validation loss decreased (-0.540727 --> -0.574061).  Saving model ...
Epoch: 20 cost time: 0.6354012489318848
Epoch: 20, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.316 Vali Acc: 0.593 Test Loss: 1.316 Test Acc: 0.593
Validation loss decreased (-0.574061 --> -0.592579).  Saving model ...
Epoch: 21 cost time: 0.5651929378509521
Epoch: 21, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.279 Vali Acc: 0.619 Test Loss: 1.279 Test Acc: 0.619
Validation loss decreased (-0.592579 --> -0.618506).  Saving model ...
Epoch: 22 cost time: 0.5412733554840088
Epoch: 22, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.242 Vali Acc: 0.656 Test Loss: 1.242 Test Acc: 0.656
Validation loss decreased (-0.618506 --> -0.655543).  Saving model ...
Epoch: 23 cost time: 0.5847880840301514
Epoch: 23, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.206 Vali Acc: 0.681 Test Loss: 1.206 Test Acc: 0.681
Validation loss decreased (-0.655543 --> -0.681469).  Saving model ...
Epoch: 24 cost time: 0.5577647686004639
Epoch: 24, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.168 Vali Acc: 0.707 Test Loss: 1.168 Test Acc: 0.707
Validation loss decreased (-0.681469 --> -0.707396).  Saving model ...
Epoch: 25 cost time: 0.5569021701812744
Epoch: 25, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.132 Vali Acc: 0.726 Test Loss: 1.132 Test Acc: 0.726
Validation loss decreased (-0.707396 --> -0.725915).  Saving model ...
Epoch: 26 cost time: 0.5477638244628906
Epoch: 26, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.096 Vali Acc: 0.744 Test Loss: 1.096 Test Acc: 0.744
Validation loss decreased (-0.725915 --> -0.744433).  Saving model ...
Epoch: 27 cost time: 0.5376131534576416
Epoch: 27, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.060 Vali Acc: 0.767 Test Loss: 1.060 Test Acc: 0.767
Validation loss decreased (-0.744433 --> -0.766656).  Saving model ...
Epoch: 28 cost time: 0.633868932723999
Epoch: 28, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.026 Vali Acc: 0.796 Test Loss: 1.026 Test Acc: 0.796
Validation loss decreased (-0.766656 --> -0.796286).  Saving model ...
Epoch: 29 cost time: 0.6328015327453613
Epoch: 29, Steps: 2 | Train Loss: 1.060 Vali Loss: 0.991 Vali Acc: 0.804 Test Loss: 0.991 Test Acc: 0.804
Validation loss decreased (-0.796286 --> -0.803694).  Saving model ...
Epoch: 30 cost time: 0.6503818035125732
Epoch: 30, Steps: 2 | Train Loss: 0.961 Vali Loss: 0.956 Vali Acc: 0.804 Test Loss: 0.956 Test Acc: 0.804
Validation loss decreased (-0.803694 --> -0.803694).  Saving model ...
Epoch: 31 cost time: 0.6717054843902588
Epoch: 31, Steps: 2 | Train Loss: 0.926 Vali Loss: 0.923 Vali Acc: 0.815 Test Loss: 0.923 Test Acc: 0.815
Validation loss decreased (-0.803694 --> -0.814806).  Saving model ...
Epoch: 32 cost time: 0.8120849132537842
Epoch: 32, Steps: 2 | Train Loss: 0.902 Vali Loss: 0.890 Vali Acc: 0.826 Test Loss: 0.890 Test Acc: 0.826
Validation loss decreased (-0.814806 --> -0.825917).  Saving model ...
Epoch: 33 cost time: 0.7214188575744629
Epoch: 33, Steps: 2 | Train Loss: 0.890 Vali Loss: 0.858 Vali Acc: 0.833 Test Loss: 0.858 Test Acc: 0.833
Validation loss decreased (-0.825917 --> -0.833325).  Saving model ...
Epoch: 34 cost time: 0.6960048675537109
Epoch: 34, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.826 Vali Acc: 0.841 Test Loss: 0.826 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840732).  Saving model ...
Epoch: 35 cost time: 0.8469109535217285
Epoch: 35, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.796 Vali Acc: 0.852 Test Loss: 0.796 Test Acc: 0.852
Validation loss decreased (-0.840732 --> -0.851844).  Saving model ...
Epoch: 36 cost time: 0.558586597442627
Epoch: 36, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.767 Vali Acc: 0.870 Test Loss: 0.767 Test Acc: 0.870
Validation loss decreased (-0.851844 --> -0.870363).  Saving model ...
Epoch: 37 cost time: 0.6396310329437256
Epoch: 37, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.739 Vali Acc: 0.881 Test Loss: 0.739 Test Acc: 0.881
Validation loss decreased (-0.870363 --> -0.881474).  Saving model ...
Epoch: 38 cost time: 0.6294255256652832
Epoch: 38, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.712 Vali Acc: 0.889 Test Loss: 0.712 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888882).  Saving model ...
Epoch: 39 cost time: 0.7323837280273438
Epoch: 39, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.686 Vali Acc: 0.896 Test Loss: 0.686 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896289).  Saving model ...
Epoch: 40 cost time: 0.807567834854126
Epoch: 40, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.662 Vali Acc: 0.896 Test Loss: 0.662 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896290).  Saving model ...
Epoch: 41 cost time: 0.6762585639953613
Epoch: 41, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.640 Vali Acc: 0.900 Test Loss: 0.640 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 42 cost time: 0.7613518238067627
Epoch: 42, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.619 Vali Acc: 0.904 Test Loss: 0.619 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 43 cost time: 0.8782660961151123
Epoch: 43, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.598 Vali Acc: 0.915 Test Loss: 0.598 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914809).  Saving model ...
Epoch: 44 cost time: 0.6678755283355713
Epoch: 44, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.579 Vali Acc: 0.915 Test Loss: 0.579 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 45 cost time: 0.7904627323150635
Epoch: 45, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.561 Vali Acc: 0.922 Test Loss: 0.561 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 46 cost time: 0.7585599422454834
Epoch: 46, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.544 Vali Acc: 0.926 Test Loss: 0.544 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925920).  Saving model ...
Epoch: 47 cost time: 0.7364873886108398
Epoch: 47, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.527 Vali Acc: 0.926 Test Loss: 0.527 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 48 cost time: 0.7006306648254395
Epoch: 48, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.511 Vali Acc: 0.926 Test Loss: 0.511 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 49 cost time: 0.6004393100738525
Epoch: 49, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.497 Vali Acc: 0.930 Test Loss: 0.497 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 50 cost time: 0.549889326095581
Epoch: 50, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.483 Vali Acc: 0.930 Test Loss: 0.483 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 51 cost time: 0.559856653213501
Epoch: 51, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.470 Vali Acc: 0.933 Test Loss: 0.470 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 52 cost time: 0.5689084529876709
Epoch: 52, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.459 Vali Acc: 0.933 Test Loss: 0.459 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 53 cost time: 0.6574501991271973
Epoch: 53, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.447 Vali Acc: 0.933 Test Loss: 0.447 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 54 cost time: 0.5403041839599609
Epoch: 54, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.437 Vali Acc: 0.937 Test Loss: 0.437 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 55 cost time: 0.5975296497344971
Epoch: 55, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.426 Vali Acc: 0.937 Test Loss: 0.426 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 56 cost time: 0.6546187400817871
Epoch: 56, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.417 Vali Acc: 0.937 Test Loss: 0.417 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 57 cost time: 0.7224380970001221
Epoch: 57, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.408 Vali Acc: 0.941 Test Loss: 0.408 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 58 cost time: 0.6042265892028809
Epoch: 58, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.400 Vali Acc: 0.941 Test Loss: 0.400 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 59 cost time: 0.6751618385314941
Epoch: 59, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.392 Vali Acc: 0.941 Test Loss: 0.392 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 60 cost time: 0.6599009037017822
Epoch: 60, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.385 Vali Acc: 0.941 Test Loss: 0.385 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 61 cost time: 0.7026863098144531
Epoch: 61, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.377 Vali Acc: 0.941 Test Loss: 0.377 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 62 cost time: 0.6554398536682129
Epoch: 62, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.371 Vali Acc: 0.941 Test Loss: 0.371 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 63 cost time: 0.7128829956054688
Epoch: 63, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.364 Vali Acc: 0.941 Test Loss: 0.364 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 64 cost time: 0.6915414333343506
Epoch: 64, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 65 cost time: 0.7480497360229492
Epoch: 65, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.353 Vali Acc: 0.941 Test Loss: 0.353 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 66 cost time: 0.6756546497344971
Epoch: 66, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.347 Vali Acc: 0.941 Test Loss: 0.347 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 67 cost time: 0.6338217258453369
Epoch: 67, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 68 cost time: 0.6489815711975098
Epoch: 68, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 69 cost time: 0.7328007221221924
Epoch: 69, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.332 Vali Acc: 0.941 Test Loss: 0.332 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 70 cost time: 0.6274888515472412
Epoch: 70, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 71 cost time: 0.6231534481048584
Epoch: 71, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.322 Vali Acc: 0.937 Test Loss: 0.322 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.9079852104187012
Epoch: 72, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.318 Vali Acc: 0.937 Test Loss: 0.318 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6095824241638184
Epoch: 73, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.314 Vali Acc: 0.937 Test Loss: 0.314 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.6363129615783691
Epoch: 74, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.310 Vali Acc: 0.937 Test Loss: 0.310 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.614830732345581
Epoch: 75, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.6999585628509521
Epoch: 76, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.303 Vali Acc: 0.937 Test Loss: 0.303 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.6818487644195557
Epoch: 77, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.5901713371276855
Epoch: 78, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.297 Vali Acc: 0.941 Test Loss: 0.297 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 79 cost time: 0.6532812118530273
Epoch: 79, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.295 Vali Acc: 0.941 Test Loss: 0.295 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 80 cost time: 0.5972628593444824
Epoch: 80, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.293 Vali Acc: 0.941 Test Loss: 0.293 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 81 cost time: 0.6547408103942871
Epoch: 81, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 82 cost time: 0.6434781551361084
Epoch: 82, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 83 cost time: 0.7213594913482666
Epoch: 83, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.285 Vali Acc: 0.941 Test Loss: 0.285 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 84 cost time: 0.656402587890625
Epoch: 84, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 85 cost time: 0.6822361946105957
Epoch: 85, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.281 Vali Acc: 0.941 Test Loss: 0.281 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 86 cost time: 0.6039867401123047
Epoch: 86, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 87 cost time: 0.7803983688354492
Epoch: 87, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 88 cost time: 0.657442569732666
Epoch: 88, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.275 Vali Acc: 0.941 Test Loss: 0.275 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 89 cost time: 0.6971700191497803
Epoch: 89, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 90 cost time: 0.6147513389587402
Epoch: 90, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 91 cost time: 0.7606010437011719
Epoch: 91, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.269 Vali Acc: 0.941 Test Loss: 0.269 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 92 cost time: 0.7323870658874512
Epoch: 92, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 93 cost time: 0.7124440670013428
Epoch: 93, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 94 cost time: 0.7266592979431152
Epoch: 94, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 95 cost time: 0.7189321517944336
Epoch: 95, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 96 cost time: 0.6807510852813721
Epoch: 96, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.261 Vali Acc: 0.941 Test Loss: 0.261 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 97 cost time: 0.7037923336029053
Epoch: 97, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 98 cost time: 0.647921085357666
Epoch: 98, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 99 cost time: 0.6256189346313477
Epoch: 99, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.256 Vali Acc: 0.941 Test Loss: 0.256 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 100 cost time: 0.7306511402130127
Epoch: 100, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 13542
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1712517738342285
Epoch: 1, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.857 Vali Acc: 0.204 Test Loss: 1.857 Test Acc: 0.204
Validation loss decreased (inf --> -0.203685).  Saving model ...
Epoch: 2 cost time: 0.5358679294586182
Epoch: 2, Steps: 2 | Train Loss: 1.945 Vali Loss: 1.813 Vali Acc: 0.259 Test Loss: 1.813 Test Acc: 0.259
Validation loss decreased (-0.203685 --> -0.259241).  Saving model ...
Epoch: 3 cost time: 0.6074609756469727
Epoch: 3, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.782 Vali Acc: 0.319 Test Loss: 1.782 Test Acc: 0.319
Validation loss decreased (-0.259241 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 0.6148686408996582
Epoch: 4, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.761 Vali Acc: 0.341 Test Loss: 1.761 Test Acc: 0.341
Validation loss decreased (-0.318501 --> -0.340723).  Saving model ...
Epoch: 5 cost time: 0.5787434577941895
Epoch: 5, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.742 Vali Acc: 0.333 Test Loss: 1.742 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7166850566864014
Epoch: 6, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.724 Vali Acc: 0.304 Test Loss: 1.724 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7300558090209961
Epoch: 7, Steps: 2 | Train Loss: 1.910 Vali Loss: 1.706 Vali Acc: 0.304 Test Loss: 1.706 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6544218063354492
Epoch: 8, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.687 Vali Acc: 0.304 Test Loss: 1.687 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7244369983673096
Epoch: 9, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.667 Vali Acc: 0.326 Test Loss: 1.667 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7386250495910645
Epoch: 10, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.646 Vali Acc: 0.333 Test Loss: 1.646 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6209559440612793
Epoch: 11, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.624 Vali Acc: 0.344 Test Loss: 1.624 Test Acc: 0.344
Validation loss decreased (-0.340723 --> -0.344428).  Saving model ...
Epoch: 12 cost time: 0.6992440223693848
Epoch: 12, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.601 Vali Acc: 0.359 Test Loss: 1.601 Test Acc: 0.359
Validation loss decreased (-0.344428 --> -0.359243).  Saving model ...
Epoch: 13 cost time: 0.6150765419006348
Epoch: 13, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.577 Vali Acc: 0.374 Test Loss: 1.577 Test Acc: 0.374
Validation loss decreased (-0.359243 --> -0.374058).  Saving model ...
Epoch: 14 cost time: 0.7308030128479004
Epoch: 14, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.552 Vali Acc: 0.404 Test Loss: 1.552 Test Acc: 0.404
Validation loss decreased (-0.374058 --> -0.403688).  Saving model ...
Epoch: 15 cost time: 0.661494255065918
Epoch: 15, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.526 Vali Acc: 0.411 Test Loss: 1.526 Test Acc: 0.411
Validation loss decreased (-0.403688 --> -0.411096).  Saving model ...
Epoch: 16 cost time: 0.6660761833190918
Epoch: 16, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.500 Vali Acc: 0.433 Test Loss: 1.500 Test Acc: 0.433
Validation loss decreased (-0.411096 --> -0.433318).  Saving model ...
Epoch: 17 cost time: 0.6204431056976318
Epoch: 17, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.473 Vali Acc: 0.448 Test Loss: 1.473 Test Acc: 0.448
Validation loss decreased (-0.433318 --> -0.448133).  Saving model ...
Epoch: 18 cost time: 0.636725664138794
Epoch: 18, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.445 Vali Acc: 0.474 Test Loss: 1.445 Test Acc: 0.474
Validation loss decreased (-0.448133 --> -0.474060).  Saving model ...
Epoch: 19 cost time: 0.6003639698028564
Epoch: 19, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.416 Vali Acc: 0.500 Test Loss: 1.416 Test Acc: 0.500
Validation loss decreased (-0.474060 --> -0.499986).  Saving model ...
Epoch: 20 cost time: 0.6372320652008057
Epoch: 20, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.387 Vali Acc: 0.515 Test Loss: 1.387 Test Acc: 0.515
Validation loss decreased (-0.499986 --> -0.514801).  Saving model ...
Epoch: 21 cost time: 0.6642882823944092
Epoch: 21, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.358 Vali Acc: 0.541 Test Loss: 1.358 Test Acc: 0.541
Validation loss decreased (-0.514801 --> -0.540727).  Saving model ...
Epoch: 22 cost time: 0.6874618530273438
Epoch: 22, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.329 Vali Acc: 0.574 Test Loss: 1.329 Test Acc: 0.574
Validation loss decreased (-0.540727 --> -0.574061).  Saving model ...
Epoch: 23 cost time: 0.6543021202087402
Epoch: 23, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.300 Vali Acc: 0.607 Test Loss: 1.300 Test Acc: 0.607
Validation loss decreased (-0.574061 --> -0.607394).  Saving model ...
Epoch: 24 cost time: 0.8027749061584473
Epoch: 24, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.270 Vali Acc: 0.622 Test Loss: 1.270 Test Acc: 0.622
Validation loss decreased (-0.607394 --> -0.622210).  Saving model ...
Epoch: 25 cost time: 0.6737825870513916
Epoch: 25, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.241 Vali Acc: 0.637 Test Loss: 1.241 Test Acc: 0.637
Validation loss decreased (-0.622210 --> -0.637025).  Saving model ...
Epoch: 26 cost time: 0.739105224609375
Epoch: 26, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.211 Vali Acc: 0.663 Test Loss: 1.211 Test Acc: 0.663
Validation loss decreased (-0.637025 --> -0.662951).  Saving model ...
Epoch: 27 cost time: 0.7333700656890869
Epoch: 27, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.181 Vali Acc: 0.674 Test Loss: 1.181 Test Acc: 0.674
Validation loss decreased (-0.662951 --> -0.674062).  Saving model ...
Epoch: 28 cost time: 0.6968264579772949
Epoch: 28, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.151 Vali Acc: 0.696 Test Loss: 1.151 Test Acc: 0.696
Validation loss decreased (-0.674062 --> -0.696285).  Saving model ...
Epoch: 29 cost time: 0.6822447776794434
Epoch: 29, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.123 Vali Acc: 0.707 Test Loss: 1.123 Test Acc: 0.707
Validation loss decreased (-0.696285 --> -0.707396).  Saving model ...
Epoch: 30 cost time: 0.7258069515228271
Epoch: 30, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.094 Vali Acc: 0.719 Test Loss: 1.094 Test Acc: 0.719
Validation loss decreased (-0.707396 --> -0.718508).  Saving model ...
Epoch: 31 cost time: 0.6692132949829102
Epoch: 31, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.065 Vali Acc: 0.730 Test Loss: 1.065 Test Acc: 0.730
Validation loss decreased (-0.718508 --> -0.729619).  Saving model ...
Epoch: 32 cost time: 0.6380677223205566
Epoch: 32, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.035 Vali Acc: 0.752 Test Loss: 1.035 Test Acc: 0.752
Validation loss decreased (-0.729619 --> -0.751841).  Saving model ...
Epoch: 33 cost time: 0.6290364265441895
Epoch: 33, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.006 Vali Acc: 0.759 Test Loss: 1.006 Test Acc: 0.759
Validation loss decreased (-0.751841 --> -0.759249).  Saving model ...
Epoch: 34 cost time: 0.5670537948608398
Epoch: 34, Steps: 2 | Train Loss: 0.945 Vali Loss: 0.977 Vali Acc: 0.770 Test Loss: 0.977 Test Acc: 0.770
Validation loss decreased (-0.759249 --> -0.770361).  Saving model ...
Epoch: 35 cost time: 0.6466414928436279
Epoch: 35, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.949 Vali Acc: 0.785 Test Loss: 0.949 Test Acc: 0.785
Validation loss decreased (-0.770361 --> -0.785176).  Saving model ...
Epoch: 36 cost time: 0.6644463539123535
Epoch: 36, Steps: 2 | Train Loss: 0.973 Vali Loss: 0.922 Vali Acc: 0.785 Test Loss: 0.922 Test Acc: 0.785
Validation loss decreased (-0.785176 --> -0.785176).  Saving model ...
Epoch: 37 cost time: 0.7222104072570801
Epoch: 37, Steps: 2 | Train Loss: 0.947 Vali Loss: 0.893 Vali Acc: 0.785 Test Loss: 0.893 Test Acc: 0.785
Validation loss decreased (-0.785176 --> -0.785176).  Saving model ...
Epoch: 38 cost time: 0.653815746307373
Epoch: 38, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.867 Vali Acc: 0.796 Test Loss: 0.867 Test Acc: 0.796
Validation loss decreased (-0.785176 --> -0.796288).  Saving model ...
Epoch: 39 cost time: 0.7123422622680664
Epoch: 39, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.841 Vali Acc: 0.807 Test Loss: 0.841 Test Acc: 0.807
Validation loss decreased (-0.796288 --> -0.807399).  Saving model ...
Epoch: 40 cost time: 0.6814947128295898
Epoch: 40, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.816 Vali Acc: 0.819 Test Loss: 0.816 Test Acc: 0.819
Validation loss decreased (-0.807399 --> -0.818510).  Saving model ...
Epoch: 41 cost time: 0.6810624599456787
Epoch: 41, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.792 Vali Acc: 0.837 Test Loss: 0.792 Test Acc: 0.837
Validation loss decreased (-0.818510 --> -0.837029).  Saving model ...
Epoch: 42 cost time: 0.6929185390472412
Epoch: 42, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.769 Vali Acc: 0.844 Test Loss: 0.769 Test Acc: 0.844
Validation loss decreased (-0.837029 --> -0.844437).  Saving model ...
Epoch: 43 cost time: 0.6480231285095215
Epoch: 43, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.746 Vali Acc: 0.852 Test Loss: 0.746 Test Acc: 0.852
Validation loss decreased (-0.844437 --> -0.851844).  Saving model ...
Epoch: 44 cost time: 0.6096956729888916
Epoch: 44, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.725 Vali Acc: 0.863 Test Loss: 0.725 Test Acc: 0.863
Validation loss decreased (-0.851844 --> -0.862956).  Saving model ...
Epoch: 45 cost time: 0.6429753303527832
Epoch: 45, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.705 Vali Acc: 0.881 Test Loss: 0.705 Test Acc: 0.881
Validation loss decreased (-0.862956 --> -0.881474).  Saving model ...
Epoch: 46 cost time: 0.6625320911407471
Epoch: 46, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.686 Vali Acc: 0.881 Test Loss: 0.686 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881475).  Saving model ...
Epoch: 47 cost time: 0.6612980365753174
Epoch: 47, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.668 Vali Acc: 0.889 Test Loss: 0.668 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888882).  Saving model ...
Epoch: 48 cost time: 0.5663623809814453
Epoch: 48, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.649 Vali Acc: 0.885 Test Loss: 0.649 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5648903846740723
Epoch: 49, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.633 Vali Acc: 0.889 Test Loss: 0.633 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 50 cost time: 0.5642368793487549
Epoch: 50, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 51 cost time: 0.6985070705413818
Epoch: 51, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.601 Vali Acc: 0.885 Test Loss: 0.601 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7071080207824707
Epoch: 52, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.587 Vali Acc: 0.885 Test Loss: 0.587 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7621285915374756
Epoch: 53, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.573 Vali Acc: 0.885 Test Loss: 0.573 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.7062993049621582
Epoch: 54, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 55 cost time: 0.7995095252990723
Epoch: 55, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.549 Vali Acc: 0.893 Test Loss: 0.549 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 56 cost time: 0.841472864151001
Epoch: 56, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.537 Vali Acc: 0.889 Test Loss: 0.537 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6672120094299316
Epoch: 57, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.527 Vali Acc: 0.896 Test Loss: 0.527 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 58 cost time: 0.642143964767456
Epoch: 58, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 59 cost time: 0.7738785743713379
Epoch: 59, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.506 Vali Acc: 0.904 Test Loss: 0.506 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 60 cost time: 0.6714823246002197
Epoch: 60, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.496 Vali Acc: 0.904 Test Loss: 0.496 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 61 cost time: 0.6417648792266846
Epoch: 61, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.486 Vali Acc: 0.904 Test Loss: 0.486 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 62 cost time: 0.6766543388366699
Epoch: 62, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.477 Vali Acc: 0.919 Test Loss: 0.477 Test Acc: 0.919
Validation loss decreased (-0.903699 --> -0.918514).  Saving model ...
Epoch: 63 cost time: 0.8219115734100342
Epoch: 63, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.468 Vali Acc: 0.919 Test Loss: 0.468 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 64 cost time: 0.7875049114227295
Epoch: 64, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.460 Vali Acc: 0.919 Test Loss: 0.460 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 65 cost time: 0.6724717617034912
Epoch: 65, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.452 Vali Acc: 0.919 Test Loss: 0.452 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 66 cost time: 0.7185928821563721
Epoch: 66, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.444 Vali Acc: 0.926 Test Loss: 0.444 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925921).  Saving model ...
Epoch: 67 cost time: 0.6294870376586914
Epoch: 67, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.437 Vali Acc: 0.926 Test Loss: 0.437 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 68 cost time: 0.595733642578125
Epoch: 68, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.430 Vali Acc: 0.930 Test Loss: 0.430 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929625).  Saving model ...
Epoch: 69 cost time: 0.6243832111358643
Epoch: 69, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.422 Vali Acc: 0.933 Test Loss: 0.422 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 70 cost time: 0.5900406837463379
Epoch: 70, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.416 Vali Acc: 0.937 Test Loss: 0.416 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 71 cost time: 0.617464542388916
Epoch: 71, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.409 Vali Acc: 0.937 Test Loss: 0.409 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 72 cost time: 0.603097677230835
Epoch: 72, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.404 Vali Acc: 0.937 Test Loss: 0.404 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 73 cost time: 0.6087493896484375
Epoch: 73, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.398 Vali Acc: 0.933 Test Loss: 0.398 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.6200370788574219
Epoch: 74, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.393 Vali Acc: 0.933 Test Loss: 0.393 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.6397531032562256
Epoch: 75, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.388 Vali Acc: 0.930 Test Loss: 0.388 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.8021135330200195
Epoch: 76, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.383 Vali Acc: 0.930 Test Loss: 0.383 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.7401828765869141
Epoch: 77, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.379 Vali Acc: 0.930 Test Loss: 0.379 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.7668449878692627
Epoch: 78, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.375 Vali Acc: 0.930 Test Loss: 0.375 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.7179124355316162
Epoch: 79, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.6781079769134521
Epoch: 80, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.366 Vali Acc: 0.919 Test Loss: 0.366 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.6622633934020996
Epoch: 81, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.362 Vali Acc: 0.919 Test Loss: 0.362 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.7088119983673096
Epoch: 82, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.359 Vali Acc: 0.926 Test Loss: 0.359 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el3_dm16_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 12838
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.513698101043701
Epoch: 1, Steps: 2 | Train Loss: 2.185 Vali Loss: 1.830 Vali Acc: 0.163 Test Loss: 1.830 Test Acc: 0.163
Validation loss decreased (inf --> -0.162945).  Saving model ...
Epoch: 2 cost time: 0.7394862174987793
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.650 Vali Acc: 0.363 Test Loss: 1.650 Test Acc: 0.363
Validation loss decreased (-0.162945 --> -0.362946).  Saving model ...
Epoch: 3 cost time: 0.7333986759185791
Epoch: 3, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.392 Vali Acc: 0.522 Test Loss: 1.392 Test Acc: 0.522
Validation loss decreased (-0.362946 --> -0.522208).  Saving model ...
Epoch: 4 cost time: 0.7211298942565918
Epoch: 4, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.034 Vali Acc: 0.681 Test Loss: 1.034 Test Acc: 0.681
Validation loss decreased (-0.522208 --> -0.681471).  Saving model ...
Epoch: 5 cost time: 0.6687777042388916
Epoch: 5, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.762 Vali Acc: 0.737 Test Loss: 0.762 Test Acc: 0.737
Validation loss decreased (-0.681471 --> -0.737029).  Saving model ...
Epoch: 6 cost time: 0.6474089622497559
Epoch: 6, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.521 Vali Acc: 0.870 Test Loss: 0.521 Test Acc: 0.870
Validation loss decreased (-0.737029 --> -0.870365).  Saving model ...
Epoch: 7 cost time: 0.6813867092132568
Epoch: 7, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.368 Vali Acc: 0.926 Test Loss: 0.368 Test Acc: 0.926
Validation loss decreased (-0.870365 --> -0.925922).  Saving model ...
Epoch: 8 cost time: 0.7083230018615723
Epoch: 8, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.279 Vali Acc: 0.937 Test Loss: 0.279 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937034).  Saving model ...
Epoch: 9 cost time: 0.6853916645050049
Epoch: 9, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940739).  Saving model ...
Epoch: 10 cost time: 0.668114423751831
Epoch: 10, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 0.7036690711975098
Epoch: 11, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7511491775512695
Epoch: 12, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7067358493804932
Epoch: 13, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
Validation loss decreased (-0.944443 --> -0.951850).  Saving model ...
Epoch: 14 cost time: 0.7614974975585938
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.952 Test Loss: 0.150 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 15 cost time: 0.816272497177124
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7010245323181152
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.952 Test Loss: 0.154 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7135505676269531
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8014853000640869
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9227476119995117
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8626320362091064
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7161896228790283
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7648212909698486
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8266785144805908
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.783672571182251
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 465158
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1630754470825195
Epoch: 1, Steps: 2 | Train Loss: 2.035 Vali Loss: 1.843 Vali Acc: 0.215 Test Loss: 1.843 Test Acc: 0.215
Validation loss decreased (inf --> -0.214796).  Saving model ...
Epoch: 2 cost time: 0.611581563949585
Epoch: 2, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.726 Vali Acc: 0.267 Test Loss: 1.726 Test Acc: 0.267
Validation loss decreased (-0.214796 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 0.723926305770874
Epoch: 3, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.583 Vali Acc: 0.385 Test Loss: 1.583 Test Acc: 0.385
Validation loss decreased (-0.266649 --> -0.385169).  Saving model ...
Epoch: 4 cost time: 0.5142679214477539
Epoch: 4, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.363 Vali Acc: 0.607 Test Loss: 1.363 Test Acc: 0.607
Validation loss decreased (-0.385169 --> -0.607394).  Saving model ...
Epoch: 5 cost time: 0.6992700099945068
Epoch: 5, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.125 Vali Acc: 0.685 Test Loss: 1.125 Test Acc: 0.685
Validation loss decreased (-0.607394 --> -0.685174).  Saving model ...
Epoch: 6 cost time: 0.6387066841125488
Epoch: 6, Steps: 2 | Train Loss: 0.995 Vali Loss: 0.907 Vali Acc: 0.730 Test Loss: 0.907 Test Acc: 0.730
Validation loss decreased (-0.685174 --> -0.729621).  Saving model ...
Epoch: 7 cost time: 0.666024923324585
Epoch: 7, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.738 Vali Acc: 0.763 Test Loss: 0.738 Test Acc: 0.763
Validation loss decreased (-0.729621 --> -0.762956).  Saving model ...
Epoch: 8 cost time: 0.8056900501251221
Epoch: 8, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.593 Vali Acc: 0.815 Test Loss: 0.593 Test Acc: 0.815
Validation loss decreased (-0.762956 --> -0.814809).  Saving model ...
Epoch: 9 cost time: 0.6566758155822754
Epoch: 9, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
Validation loss decreased (-0.814809 --> -0.844440).  Saving model ...
Epoch: 10 cost time: 0.6309335231781006
Epoch: 10, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.387 Vali Acc: 0.896 Test Loss: 0.387 Test Acc: 0.896
Validation loss decreased (-0.844440 --> -0.896292).  Saving model ...
Epoch: 11 cost time: 0.5671792030334473
Epoch: 11, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.321 Vali Acc: 0.915 Test Loss: 0.321 Test Acc: 0.915
Validation loss decreased (-0.896292 --> -0.914812).  Saving model ...
Epoch: 12 cost time: 0.6265647411346436
Epoch: 12, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922219).  Saving model ...
Epoch: 13 cost time: 0.6383252143859863
Epoch: 13, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 14 cost time: 0.7100512981414795
Epoch: 14, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6069176197052002
Epoch: 15, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5801527500152588
Epoch: 16, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6373965740203857
Epoch: 17, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6964855194091797
Epoch: 18, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6794373989105225
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933332).  Saving model ...
Epoch: 20 cost time: 0.6810710430145264
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 21 cost time: 0.6241815090179443
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.933332 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.6465983390808105
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.5913527011871338
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6341776847839355
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6159083843231201
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5860605239868164
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5908718109130859
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6058602333068848
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5789794921875
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6145782470703125
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6498336791992188
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6411306858062744
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 364038
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4680628776550293
Epoch: 1, Steps: 2 | Train Loss: 2.073 Vali Loss: 1.969 Vali Acc: 0.159 Test Loss: 1.969 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.6796407699584961
Epoch: 2, Steps: 2 | Train Loss: 1.997 Vali Loss: 1.857 Vali Acc: 0.252 Test Loss: 1.857 Test Acc: 0.252
Validation loss decreased (-0.159240 --> -0.251833).  Saving model ...
Epoch: 3 cost time: 0.6419758796691895
Epoch: 3, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.731 Vali Acc: 0.333 Test Loss: 1.731 Test Acc: 0.333
Validation loss decreased (-0.251833 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 0.5917155742645264
Epoch: 4, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.538 Vali Acc: 0.481 Test Loss: 1.538 Test Acc: 0.481
Validation loss decreased (-0.333316 --> -0.481466).  Saving model ...
Epoch: 5 cost time: 0.6448779106140137
Epoch: 5, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.314 Vali Acc: 0.604 Test Loss: 1.314 Test Acc: 0.604
Validation loss decreased (-0.481466 --> -0.603691).  Saving model ...
Epoch: 6 cost time: 0.5933055877685547
Epoch: 6, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.095 Vali Acc: 0.730 Test Loss: 1.095 Test Acc: 0.730
Validation loss decreased (-0.603691 --> -0.729619).  Saving model ...
Epoch: 7 cost time: 0.6717333793640137
Epoch: 7, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.899 Vali Acc: 0.781 Test Loss: 0.899 Test Acc: 0.781
Validation loss decreased (-0.729619 --> -0.781472).  Saving model ...
Epoch: 8 cost time: 0.6466488838195801
Epoch: 8, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.738 Vali Acc: 0.856 Test Loss: 0.738 Test Acc: 0.856
Validation loss decreased (-0.781472 --> -0.855548).  Saving model ...
Epoch: 9 cost time: 0.6026096343994141
Epoch: 9, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.608 Vali Acc: 0.878 Test Loss: 0.608 Test Acc: 0.878
Validation loss decreased (-0.855548 --> -0.877772).  Saving model ...
Epoch: 10 cost time: 0.7654287815093994
Epoch: 10, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.503 Vali Acc: 0.896 Test Loss: 0.503 Test Acc: 0.896
Validation loss decreased (-0.877772 --> -0.896291).  Saving model ...
Epoch: 11 cost time: 0.6496541500091553
Epoch: 11, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.416 Vali Acc: 0.911 Test Loss: 0.416 Test Acc: 0.911
Validation loss decreased (-0.896291 --> -0.911107).  Saving model ...
Epoch: 12 cost time: 0.5689356327056885
Epoch: 12, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 13 cost time: 0.8114092350006104
Epoch: 13, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 14 cost time: 0.6653914451599121
Epoch: 14, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 15 cost time: 0.657080888748169
Epoch: 15, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.711585283279419
Epoch: 16, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7864229679107666
Epoch: 17, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.5810537338256836
Epoch: 18, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 0.767158031463623
Epoch: 19, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.7600572109222412
Epoch: 20, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.7079939842224121
Epoch: 21, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.6121273040771484
Epoch: 22, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.6608757972717285
Epoch: 23, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6915493011474609
Epoch: 24, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7331430912017822
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7467262744903564
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5922486782073975
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8330867290496826
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8686320781707764
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6720213890075684
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7167530059814453
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6676948070526123
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 333446
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4100708961486816
Epoch: 1, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.678 Vali Acc: 0.222 Test Loss: 1.678 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 0.7840795516967773
Epoch: 2, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.577 Vali Acc: 0.352 Test Loss: 1.577 Test Acc: 0.352
Validation loss decreased (-0.222205 --> -0.351836).  Saving model ...
Epoch: 3 cost time: 0.661207914352417
Epoch: 3, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.474 Vali Acc: 0.496 Test Loss: 1.474 Test Acc: 0.496
Validation loss decreased (-0.351836 --> -0.496282).  Saving model ...
Epoch: 4 cost time: 0.663921594619751
Epoch: 4, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.337 Vali Acc: 0.600 Test Loss: 1.337 Test Acc: 0.600
Validation loss decreased (-0.496282 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 0.6128647327423096
Epoch: 5, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.181 Vali Acc: 0.681 Test Loss: 1.181 Test Acc: 0.681
Validation loss decreased (-0.599987 --> -0.681470).  Saving model ...
Epoch: 6 cost time: 0.5690903663635254
Epoch: 6, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.025 Vali Acc: 0.756 Test Loss: 1.025 Test Acc: 0.756
Validation loss decreased (-0.681470 --> -0.755545).  Saving model ...
Epoch: 7 cost time: 0.5378403663635254
Epoch: 7, Steps: 2 | Train Loss: 0.963 Vali Loss: 0.878 Vali Acc: 0.793 Test Loss: 0.878 Test Acc: 0.793
Validation loss decreased (-0.755545 --> -0.792584).  Saving model ...
Epoch: 8 cost time: 0.6428055763244629
Epoch: 8, Steps: 2 | Train Loss: 0.716 Vali Loss: 0.751 Vali Acc: 0.815 Test Loss: 0.751 Test Acc: 0.815
Validation loss decreased (-0.792584 --> -0.814807).  Saving model ...
Epoch: 9 cost time: 0.7431027889251709
Epoch: 9, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.814807 --> -0.822216).  Saving model ...
Epoch: 10 cost time: 0.7206845283508301
Epoch: 10, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
Validation loss decreased (-0.822216 --> -0.855550).  Saving model ...
Epoch: 11 cost time: 0.7041478157043457
Epoch: 11, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.472 Vali Acc: 0.893 Test Loss: 0.472 Test Acc: 0.893
Validation loss decreased (-0.855550 --> -0.892588).  Saving model ...
Epoch: 12 cost time: 0.6858148574829102
Epoch: 12, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.407 Vali Acc: 0.911 Test Loss: 0.407 Test Acc: 0.911
Validation loss decreased (-0.892588 --> -0.911107).  Saving model ...
Epoch: 13 cost time: 0.7102200984954834
Epoch: 13, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.354 Vali Acc: 0.926 Test Loss: 0.354 Test Acc: 0.926
Validation loss decreased (-0.911107 --> -0.925922).  Saving model ...
Epoch: 14 cost time: 0.6489064693450928
Epoch: 14, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.315 Vali Acc: 0.926 Test Loss: 0.315 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 15 cost time: 0.590782880783081
Epoch: 15, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.285 Vali Acc: 0.926 Test Loss: 0.285 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 16 cost time: 0.5805506706237793
Epoch: 16, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6431376934051514
Epoch: 17, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 18 cost time: 0.7192873954772949
Epoch: 18, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.925924 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.642725944519043
Epoch: 19, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.6381778717041016
Epoch: 20, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.6643180847167969
Epoch: 21, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.6716499328613281
Epoch: 22, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6829912662506104
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7745630741119385
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6546216011047363
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6895153522491455
Epoch: 26, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6546435356140137
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6316502094268799
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6498579978942871
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7140533924102783
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5545904636383057
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 315270
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3094637393951416
Epoch: 1, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.932 Vali Acc: 0.296 Test Loss: 1.932 Test Acc: 0.296
Validation loss decreased (inf --> -0.296277).  Saving model ...
Epoch: 2 cost time: 0.5694561004638672
Epoch: 2, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.821 Vali Acc: 0.341 Test Loss: 1.821 Test Acc: 0.341
Validation loss decreased (-0.296277 --> -0.340723).  Saving model ...
Epoch: 3 cost time: 0.625993013381958
Epoch: 3, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.710 Vali Acc: 0.415 Test Loss: 1.710 Test Acc: 0.415
Validation loss decreased (-0.340723 --> -0.414798).  Saving model ...
Epoch: 4 cost time: 0.7868645191192627
Epoch: 4, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.568 Vali Acc: 0.481 Test Loss: 1.568 Test Acc: 0.481
Validation loss decreased (-0.414798 --> -0.481466).  Saving model ...
Epoch: 5 cost time: 0.5851070880889893
Epoch: 5, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.404 Vali Acc: 0.511 Test Loss: 1.404 Test Acc: 0.511
Validation loss decreased (-0.481466 --> -0.511097).  Saving model ...
Epoch: 6 cost time: 0.5716993808746338
Epoch: 6, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.237 Vali Acc: 0.589 Test Loss: 1.237 Test Acc: 0.589
Validation loss decreased (-0.511097 --> -0.588877).  Saving model ...
Epoch: 7 cost time: 0.5521132946014404
Epoch: 7, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.077 Vali Acc: 0.711 Test Loss: 1.077 Test Acc: 0.711
Validation loss decreased (-0.588877 --> -0.711100).  Saving model ...
Epoch: 8 cost time: 0.573753833770752
Epoch: 8, Steps: 2 | Train Loss: 0.953 Vali Loss: 0.932 Vali Acc: 0.789 Test Loss: 0.932 Test Acc: 0.789
Validation loss decreased (-0.711100 --> -0.788880).  Saving model ...
Epoch: 9 cost time: 0.5719964504241943
Epoch: 9, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.805 Vali Acc: 0.841 Test Loss: 0.805 Test Acc: 0.841
Validation loss decreased (-0.788880 --> -0.840733).  Saving model ...
Epoch: 10 cost time: 0.5214824676513672
Epoch: 10, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.695 Vali Acc: 0.859 Test Loss: 0.695 Test Acc: 0.859
Validation loss decreased (-0.840733 --> -0.859252).  Saving model ...
Epoch: 11 cost time: 0.5966484546661377
Epoch: 11, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.599 Vali Acc: 0.881 Test Loss: 0.599 Test Acc: 0.881
Validation loss decreased (-0.859252 --> -0.881475).  Saving model ...
Epoch: 12 cost time: 0.5370476245880127
Epoch: 12, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888884).  Saving model ...
Epoch: 13 cost time: 0.5704200267791748
Epoch: 13, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.446 Vali Acc: 0.896 Test Loss: 0.446 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896292).  Saving model ...
Epoch: 14 cost time: 0.5670666694641113
Epoch: 14, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.388 Vali Acc: 0.907 Test Loss: 0.388 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907404).  Saving model ...
Epoch: 15 cost time: 0.6294682025909424
Epoch: 15, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.349 Vali Acc: 0.911 Test Loss: 0.349 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 0.5131635665893555
Epoch: 16, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.315 Vali Acc: 0.904 Test Loss: 0.315 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5649576187133789
Epoch: 17, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.291 Vali Acc: 0.904 Test Loss: 0.291 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6141650676727295
Epoch: 18, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 0.5860800743103027
Epoch: 19, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 0.5084109306335449
Epoch: 20, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5845189094543457
Epoch: 21, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.6910109519958496
Epoch: 22, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5466742515563965
Epoch: 23, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5977530479431152
Epoch: 24, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7004375457763672
Epoch: 25, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5578176975250244
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.926 Test Loss: 0.176 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5691268444061279
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.926 Test Loss: 0.177 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5821878910064697
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.926 Test Loss: 0.176 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5314590930938721
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.926 Test Loss: 0.177 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5942716598510742
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.926 Test Loss: 0.177 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.451077938079834
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.926 Test Loss: 0.176 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 306438
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5455100536346436
Epoch: 1, Steps: 2 | Train Loss: 2.175 Vali Loss: 1.973 Vali Acc: 0.115 Test Loss: 1.973 Test Acc: 0.115
Validation loss decreased (inf --> -0.114795).  Saving model ...
Epoch: 2 cost time: 0.5705599784851074
Epoch: 2, Steps: 2 | Train Loss: 2.014 Vali Loss: 1.880 Vali Acc: 0.126 Test Loss: 1.880 Test Acc: 0.126
Validation loss decreased (-0.114795 --> -0.125907).  Saving model ...
Epoch: 3 cost time: 0.5147190093994141
Epoch: 3, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.794 Vali Acc: 0.163 Test Loss: 1.794 Test Acc: 0.163
Validation loss decreased (-0.125907 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 0.520327091217041
Epoch: 4, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.686 Vali Acc: 0.219 Test Loss: 1.686 Test Acc: 0.219
Validation loss decreased (-0.162945 --> -0.218502).  Saving model ...
Epoch: 5 cost time: 0.5739951133728027
Epoch: 5, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.558 Vali Acc: 0.341 Test Loss: 1.558 Test Acc: 0.341
Validation loss decreased (-0.218502 --> -0.340725).  Saving model ...
Epoch: 6 cost time: 0.5594093799591064
Epoch: 6, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.416 Vali Acc: 0.456 Test Loss: 1.416 Test Acc: 0.456
Validation loss decreased (-0.340725 --> -0.455541).  Saving model ...
Epoch: 7 cost time: 0.5068364143371582
Epoch: 7, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.269 Vali Acc: 0.604 Test Loss: 1.269 Test Acc: 0.604
Validation loss decreased (-0.455541 --> -0.603691).  Saving model ...
Epoch: 8 cost time: 0.5760433673858643
Epoch: 8, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.124 Vali Acc: 0.741 Test Loss: 1.124 Test Acc: 0.741
Validation loss decreased (-0.603691 --> -0.740730).  Saving model ...
Epoch: 9 cost time: 0.6927661895751953
Epoch: 9, Steps: 2 | Train Loss: 1.026 Vali Loss: 0.988 Vali Acc: 0.833 Test Loss: 0.988 Test Acc: 0.833
Validation loss decreased (-0.740730 --> -0.833323).  Saving model ...
Epoch: 10 cost time: 0.48685359954833984
Epoch: 10, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.864 Vali Acc: 0.867 Test Loss: 0.864 Test Acc: 0.867
Validation loss decreased (-0.833323 --> -0.866658).  Saving model ...
Epoch: 11 cost time: 0.49373459815979004
Epoch: 11, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.754 Vali Acc: 0.889 Test Loss: 0.754 Test Acc: 0.889
Validation loss decreased (-0.866658 --> -0.888881).  Saving model ...
Epoch: 12 cost time: 0.5185766220092773
Epoch: 12, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.656 Vali Acc: 0.907 Test Loss: 0.656 Test Acc: 0.907
Validation loss decreased (-0.888881 --> -0.907401).  Saving model ...
Epoch: 13 cost time: 0.5282986164093018
Epoch: 13, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.576 Vali Acc: 0.919 Test Loss: 0.576 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 14 cost time: 0.5957963466644287
Epoch: 14, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.505 Vali Acc: 0.926 Test Loss: 0.505 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 15 cost time: 0.597937822341919
Epoch: 15, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.444 Vali Acc: 0.926 Test Loss: 0.444 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 16 cost time: 0.5823819637298584
Epoch: 16, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.393 Vali Acc: 0.933 Test Loss: 0.393 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 17 cost time: 0.6763598918914795
Epoch: 17, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.350 Vali Acc: 0.937 Test Loss: 0.350 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937034).  Saving model ...
Epoch: 18 cost time: 0.51346755027771
Epoch: 18, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.313 Vali Acc: 0.941 Test Loss: 0.313 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 19 cost time: 0.6940460205078125
Epoch: 19, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 20 cost time: 0.6184618473052979
Epoch: 20, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.259 Vali Acc: 0.948 Test Loss: 0.259 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.6326913833618164
Epoch: 21, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6879384517669678
Epoch: 22, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6820845603942871
Epoch: 23, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6712424755096436
Epoch: 24, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5947465896606445
Epoch: 25, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8030917644500732
Epoch: 26, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6997153759002686
Epoch: 27, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.727938175201416
Epoch: 28, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6010117530822754
Epoch: 29, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5830657482147217
Epoch: 30, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 294534
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.176910161972046
Epoch: 1, Steps: 2 | Train Loss: 2.059 Vali Loss: 1.953 Vali Acc: 0.167 Test Loss: 1.953 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.5617473125457764
Epoch: 2, Steps: 2 | Train Loss: 2.010 Vali Loss: 1.883 Vali Acc: 0.178 Test Loss: 1.883 Test Acc: 0.178
Validation loss decreased (-0.166647 --> -0.177759).  Saving model ...
Epoch: 3 cost time: 0.6005816459655762
Epoch: 3, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.819 Vali Acc: 0.233 Test Loss: 1.819 Test Acc: 0.233
Validation loss decreased (-0.177759 --> -0.233315).  Saving model ...
Epoch: 4 cost time: 0.5186727046966553
Epoch: 4, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.738 Vali Acc: 0.296 Test Loss: 1.738 Test Acc: 0.296
Validation loss decreased (-0.233315 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 0.5558016300201416
Epoch: 5, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.635 Vali Acc: 0.404 Test Loss: 1.635 Test Acc: 0.404
Validation loss decreased (-0.296279 --> -0.403687).  Saving model ...
Epoch: 6 cost time: 0.7343356609344482
Epoch: 6, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.517 Vali Acc: 0.485 Test Loss: 1.517 Test Acc: 0.485
Validation loss decreased (-0.403687 --> -0.485170).  Saving model ...
Epoch: 7 cost time: 0.5828754901885986
Epoch: 7, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.390 Vali Acc: 0.589 Test Loss: 1.390 Test Acc: 0.589
Validation loss decreased (-0.485170 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 0.6287338733673096
Epoch: 8, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.261 Vali Acc: 0.648 Test Loss: 1.261 Test Acc: 0.648
Validation loss decreased (-0.588875 --> -0.648136).  Saving model ...
Epoch: 9 cost time: 0.5346713066101074
Epoch: 9, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.133 Vali Acc: 0.726 Test Loss: 1.133 Test Acc: 0.726
Validation loss decreased (-0.648136 --> -0.725915).  Saving model ...
Epoch: 10 cost time: 0.5644772052764893
Epoch: 10, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.010 Vali Acc: 0.789 Test Loss: 1.010 Test Acc: 0.789
Validation loss decreased (-0.725915 --> -0.788879).  Saving model ...
Epoch: 11 cost time: 0.5913231372833252
Epoch: 11, Steps: 2 | Train Loss: 0.908 Vali Loss: 0.898 Vali Acc: 0.826 Test Loss: 0.898 Test Acc: 0.826
Validation loss decreased (-0.788879 --> -0.825917).  Saving model ...
Epoch: 12 cost time: 0.6070692539215088
Epoch: 12, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.796 Vali Acc: 0.863 Test Loss: 0.796 Test Acc: 0.863
Validation loss decreased (-0.825917 --> -0.862955).  Saving model ...
Epoch: 13 cost time: 0.5963022708892822
Epoch: 13, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.708 Vali Acc: 0.885 Test Loss: 0.708 Test Acc: 0.885
Validation loss decreased (-0.862955 --> -0.885178).  Saving model ...
Epoch: 14 cost time: 0.5987653732299805
Epoch: 14, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.631 Vali Acc: 0.889 Test Loss: 0.631 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888883).  Saving model ...
Epoch: 15 cost time: 0.5671379566192627
Epoch: 15, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.563 Vali Acc: 0.893 Test Loss: 0.563 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 16 cost time: 0.6138396263122559
Epoch: 16, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6086161136627197
Epoch: 17, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.454 Vali Acc: 0.893 Test Loss: 0.454 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892588).  Saving model ...
Epoch: 18 cost time: 0.47403979301452637
Epoch: 18, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.411 Vali Acc: 0.896 Test Loss: 0.411 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 19 cost time: 0.553471565246582
Epoch: 19, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.373 Vali Acc: 0.904 Test Loss: 0.373 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903700).  Saving model ...
Epoch: 20 cost time: 0.5507221221923828
Epoch: 20, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.343 Vali Acc: 0.904 Test Loss: 0.343 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 21 cost time: 0.6543464660644531
Epoch: 21, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.318 Vali Acc: 0.904 Test Loss: 0.318 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903701).  Saving model ...
Epoch: 22 cost time: 0.5873651504516602
Epoch: 22, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.296 Vali Acc: 0.911 Test Loss: 0.296 Test Acc: 0.911
Validation loss decreased (-0.903701 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 0.571061372756958
Epoch: 23, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 0.5902338027954102
Epoch: 24, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.262 Vali Acc: 0.930 Test Loss: 0.262 Test Acc: 0.930
Validation loss decreased (-0.911108 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.6044464111328125
Epoch: 25, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5659959316253662
Epoch: 26, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 0.5533056259155273
Epoch: 27, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6804037094116211
Epoch: 28, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4611475467681885
Epoch: 29, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5923972129821777
Epoch: 30, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5448529720306396
Epoch: 31, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5748438835144043
Epoch: 32, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5918920040130615
Epoch: 33, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5598752498626709
Epoch: 34, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5558438301086426
Epoch: 35, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.926 Test Loss: 0.198 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6763708591461182
Epoch: 36, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.926 Test Loss: 0.197 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 288902
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3331639766693115
Epoch: 1, Steps: 2 | Train Loss: 2.018 Vali Loss: 1.816 Vali Acc: 0.207 Test Loss: 1.816 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 0.6565907001495361
Epoch: 2, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.639 Vali Acc: 0.315 Test Loss: 1.639 Test Acc: 0.315
Validation loss decreased (-0.207389 --> -0.314798).  Saving model ...
Epoch: 3 cost time: 0.5898580551147461
Epoch: 3, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.395 Vali Acc: 0.407 Test Loss: 1.395 Test Acc: 0.407
Validation loss decreased (-0.314798 --> -0.407393).  Saving model ...
Epoch: 4 cost time: 0.617178201675415
Epoch: 4, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.052 Vali Acc: 0.585 Test Loss: 1.052 Test Acc: 0.585
Validation loss decreased (-0.407393 --> -0.585175).  Saving model ...
Epoch: 5 cost time: 0.6275858879089355
Epoch: 5, Steps: 2 | Train Loss: 0.907 Vali Loss: 0.736 Vali Acc: 0.852 Test Loss: 0.736 Test Acc: 0.852
Validation loss decreased (-0.585175 --> -0.851844).  Saving model ...
Epoch: 6 cost time: 0.6240503787994385
Epoch: 6, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.502 Vali Acc: 0.926 Test Loss: 0.502 Test Acc: 0.926
Validation loss decreased (-0.851844 --> -0.925921).  Saving model ...
Epoch: 7 cost time: 0.6366081237792969
Epoch: 7, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.367 Vali Acc: 0.922 Test Loss: 0.367 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.654360294342041
Epoch: 8, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6647913455963135
Epoch: 9, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.925921 --> -0.937035).  Saving model ...
Epoch: 10 cost time: 0.6225705146789551
Epoch: 10, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 11 cost time: 0.8255760669708252
Epoch: 11, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 12 cost time: 0.7835404872894287
Epoch: 12, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 13 cost time: 0.7440426349639893
Epoch: 13, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.930 Test Loss: 0.165 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7120280265808105
Epoch: 14, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.926 Test Loss: 0.172 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6468338966369629
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.926 Test Loss: 0.179 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7037103176116943
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.926 Test Loss: 0.185 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7477045059204102
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.926 Test Loss: 0.191 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.616584300994873
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.926 Test Loss: 0.195 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7290060520172119
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7763345241546631
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7573728561401367
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8607275485992432
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 399366
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.503014087677002
Epoch: 1, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.557 Vali Acc: 0.189 Test Loss: 1.557 Test Acc: 0.189
Validation loss decreased (inf --> -0.188873).  Saving model ...
Epoch: 2 cost time: 0.7464885711669922
Epoch: 2, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.433 Vali Acc: 0.389 Test Loss: 1.433 Test Acc: 0.389
Validation loss decreased (-0.188873 --> -0.388875).  Saving model ...
Epoch: 3 cost time: 0.7307314872741699
Epoch: 3, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.278 Vali Acc: 0.544 Test Loss: 1.278 Test Acc: 0.544
Validation loss decreased (-0.388875 --> -0.544432).  Saving model ...
Epoch: 4 cost time: 0.600907564163208
Epoch: 4, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.063 Vali Acc: 0.748 Test Loss: 1.063 Test Acc: 0.748
Validation loss decreased (-0.544432 --> -0.748138).  Saving model ...
Epoch: 5 cost time: 0.5777416229248047
Epoch: 5, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.858 Vali Acc: 0.867 Test Loss: 0.858 Test Acc: 0.867
Validation loss decreased (-0.748138 --> -0.866658).  Saving model ...
Epoch: 6 cost time: 0.6032655239105225
Epoch: 6, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.690 Vali Acc: 0.889 Test Loss: 0.690 Test Acc: 0.889
Validation loss decreased (-0.866658 --> -0.888882).  Saving model ...
Epoch: 7 cost time: 0.6462030410766602
Epoch: 7, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.562 Vali Acc: 0.889 Test Loss: 0.562 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 0.6099116802215576
Epoch: 8, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.6639635562896729
Epoch: 9, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.371 Vali Acc: 0.930 Test Loss: 0.371 Test Acc: 0.930
Validation loss decreased (-0.888884 --> -0.929626).  Saving model ...
Epoch: 10 cost time: 0.6280508041381836
Epoch: 10, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.315 Vali Acc: 0.926 Test Loss: 0.315 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.675117015838623
Epoch: 11, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 12 cost time: 0.6279699802398682
Epoch: 12, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 13 cost time: 0.6520390510559082
Epoch: 13, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 14 cost time: 0.600480318069458
Epoch: 14, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5853762626647949
Epoch: 15, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6277332305908203
Epoch: 16, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.186 Vali Acc: 0.926 Test Loss: 0.186 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6957464218139648
Epoch: 17, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.68105149269104
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6706974506378174
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6380815505981445
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6768982410430908
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.5479841232299805
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.665785551071167
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.6560933589935303
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6057124137878418
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.65836501121521
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.618840217590332
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5789835453033447
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6441030502319336
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6128103733062744
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6146478652954102
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6488423347473145
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6923031806945801
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 298246
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.238504409790039
Epoch: 1, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.662 Vali Acc: 0.289 Test Loss: 1.662 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 0.6019580364227295
Epoch: 2, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.563 Vali Acc: 0.344 Test Loss: 1.563 Test Acc: 0.344
Validation loss decreased (-0.288872 --> -0.344429).  Saving model ...
Epoch: 3 cost time: 0.5891084671020508
Epoch: 3, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.452 Vali Acc: 0.411 Test Loss: 1.452 Test Acc: 0.411
Validation loss decreased (-0.344429 --> -0.411097).  Saving model ...
Epoch: 4 cost time: 0.7022404670715332
Epoch: 4, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.284 Vali Acc: 0.593 Test Loss: 1.284 Test Acc: 0.593
Validation loss decreased (-0.411097 --> -0.592580).  Saving model ...
Epoch: 5 cost time: 0.6342241764068604
Epoch: 5, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.091 Vali Acc: 0.748 Test Loss: 1.091 Test Acc: 0.748
Validation loss decreased (-0.592580 --> -0.748137).  Saving model ...
Epoch: 6 cost time: 0.6295578479766846
Epoch: 6, Steps: 2 | Train Loss: 0.947 Vali Loss: 0.907 Vali Acc: 0.796 Test Loss: 0.907 Test Acc: 0.796
Validation loss decreased (-0.748137 --> -0.796287).  Saving model ...
Epoch: 7 cost time: 0.6135644912719727
Epoch: 7, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.750 Vali Acc: 0.837 Test Loss: 0.750 Test Acc: 0.837
Validation loss decreased (-0.796287 --> -0.837030).  Saving model ...
Epoch: 8 cost time: 0.6388452053070068
Epoch: 8, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.620 Vali Acc: 0.874 Test Loss: 0.620 Test Acc: 0.874
Validation loss decreased (-0.837030 --> -0.874068).  Saving model ...
Epoch: 9 cost time: 0.8029947280883789
Epoch: 9, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
Validation loss decreased (-0.874068 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 0.6233124732971191
Epoch: 10, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.441 Vali Acc: 0.911 Test Loss: 0.441 Test Acc: 0.911
Validation loss decreased (-0.888884 --> -0.911107).  Saving model ...
Epoch: 11 cost time: 0.6377475261688232
Epoch: 11, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.379 Vali Acc: 0.911 Test Loss: 0.379 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 12 cost time: 0.689021110534668
Epoch: 12, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.329 Vali Acc: 0.926 Test Loss: 0.329 Test Acc: 0.926
Validation loss decreased (-0.911107 --> -0.925923).  Saving model ...
Epoch: 13 cost time: 0.647089958190918
Epoch: 13, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933330).  Saving model ...
Epoch: 14 cost time: 0.6735339164733887
Epoch: 14, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6436705589294434
Epoch: 15, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5974130630493164
Epoch: 16, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.5873303413391113
Epoch: 17, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
Validation loss decreased (-0.937035 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.5975534915924072
Epoch: 18, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.948146 --> -0.955554).  Saving model ...
Epoch: 19 cost time: 0.7197010517120361
Epoch: 19, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 20 cost time: 0.6663546562194824
Epoch: 20, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 21 cost time: 0.5806877613067627
Epoch: 21, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5811374187469482
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5892407894134521
Epoch: 23, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6427257061004639
Epoch: 24, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6660988330841064
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6017289161682129
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7656228542327881
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6264925003051758
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6679306030273438
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6505258083343506
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 267654
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.208059072494507
Epoch: 1, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.622 Vali Acc: 0.381 Test Loss: 1.622 Test Acc: 0.381
Validation loss decreased (inf --> -0.381465).  Saving model ...
Epoch: 2 cost time: 0.7753026485443115
Epoch: 2, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.534 Vali Acc: 0.419 Test Loss: 1.534 Test Acc: 0.419
Validation loss decreased (-0.381465 --> -0.418503).  Saving model ...
Epoch: 3 cost time: 0.6495683193206787
Epoch: 3, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.444 Vali Acc: 0.444 Test Loss: 1.444 Test Acc: 0.444
Validation loss decreased (-0.418503 --> -0.444430).  Saving model ...
Epoch: 4 cost time: 0.653235912322998
Epoch: 4, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.323 Vali Acc: 0.493 Test Loss: 1.323 Test Acc: 0.493
Validation loss decreased (-0.444430 --> -0.492579).  Saving model ...
Epoch: 5 cost time: 0.5720162391662598
Epoch: 5, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.184 Vali Acc: 0.589 Test Loss: 1.184 Test Acc: 0.589
Validation loss decreased (-0.492579 --> -0.588877).  Saving model ...
Epoch: 6 cost time: 0.664910078048706
Epoch: 6, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.040 Vali Acc: 0.693 Test Loss: 1.040 Test Acc: 0.693
Validation loss decreased (-0.588877 --> -0.692582).  Saving model ...
Epoch: 7 cost time: 0.6452085971832275
Epoch: 7, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.906 Vali Acc: 0.789 Test Loss: 0.906 Test Acc: 0.789
Validation loss decreased (-0.692582 --> -0.788880).  Saving model ...
Epoch: 8 cost time: 0.5998280048370361
Epoch: 8, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.784 Vali Acc: 0.830 Test Loss: 0.784 Test Acc: 0.830
Validation loss decreased (-0.788880 --> -0.829622).  Saving model ...
Epoch: 9 cost time: 0.6694183349609375
Epoch: 9, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.674 Vali Acc: 0.881 Test Loss: 0.674 Test Acc: 0.881
Validation loss decreased (-0.829622 --> -0.881475).  Saving model ...
Epoch: 10 cost time: 0.5881068706512451
Epoch: 10, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.579 Vali Acc: 0.922 Test Loss: 0.579 Test Acc: 0.922
Validation loss decreased (-0.881475 --> -0.922216).  Saving model ...
Epoch: 11 cost time: 0.7657530307769775
Epoch: 11, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.497 Vali Acc: 0.941 Test Loss: 0.497 Test Acc: 0.941
Validation loss decreased (-0.922216 --> -0.940736).  Saving model ...
Epoch: 12 cost time: 0.7802989482879639
Epoch: 12, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.429 Vali Acc: 0.941 Test Loss: 0.429 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 13 cost time: 0.5934774875640869
Epoch: 13, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.376 Vali Acc: 0.933 Test Loss: 0.376 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7365818023681641
Epoch: 14, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.329 Vali Acc: 0.944 Test Loss: 0.329 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.6853675842285156
Epoch: 15, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.7325148582458496
Epoch: 16, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.6882915496826172
Epoch: 17, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.6540977954864502
Epoch: 18, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.633965015411377
Epoch: 19, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6779654026031494
Epoch: 20, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6989765167236328
Epoch: 21, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6286036968231201
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7361392974853516
Epoch: 23, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6451833248138428
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.654545783996582
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6627094745635986
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7089903354644775
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7563834190368652
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 249478
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3454742431640625
Epoch: 1, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.803 Vali Acc: 0.167 Test Loss: 1.803 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.6706445217132568
Epoch: 2, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.729 Vali Acc: 0.207 Test Loss: 1.729 Test Acc: 0.207
Validation loss decreased (-0.166649 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.6697108745574951
Epoch: 3, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.650 Vali Acc: 0.300 Test Loss: 1.650 Test Acc: 0.300
Validation loss decreased (-0.207390 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.6514496803283691
Epoch: 4, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.536 Vali Acc: 0.444 Test Loss: 1.536 Test Acc: 0.444
Validation loss decreased (-0.299983 --> -0.444429).  Saving model ...
Epoch: 5 cost time: 0.5747113227844238
Epoch: 5, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.397 Vali Acc: 0.570 Test Loss: 1.397 Test Acc: 0.570
Validation loss decreased (-0.444429 --> -0.570356).  Saving model ...
Epoch: 6 cost time: 0.7144126892089844
Epoch: 6, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.248 Vali Acc: 0.685 Test Loss: 1.248 Test Acc: 0.685
Validation loss decreased (-0.570356 --> -0.685173).  Saving model ...
Epoch: 7 cost time: 0.6059305667877197
Epoch: 7, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.100 Vali Acc: 0.748 Test Loss: 1.100 Test Acc: 0.748
Validation loss decreased (-0.685173 --> -0.748137).  Saving model ...
Epoch: 8 cost time: 0.617311954498291
Epoch: 8, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.958 Vali Acc: 0.781 Test Loss: 0.958 Test Acc: 0.781
Validation loss decreased (-0.748137 --> -0.781472).  Saving model ...
Epoch: 9 cost time: 0.5443086624145508
Epoch: 9, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.833 Vali Acc: 0.819 Test Loss: 0.833 Test Acc: 0.819
Validation loss decreased (-0.781472 --> -0.818510).  Saving model ...
Epoch: 10 cost time: 0.623431921005249
Epoch: 10, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.728 Vali Acc: 0.837 Test Loss: 0.728 Test Acc: 0.837
Validation loss decreased (-0.818510 --> -0.837030).  Saving model ...
Epoch: 11 cost time: 0.6082329750061035
Epoch: 11, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.636 Vali Acc: 0.859 Test Loss: 0.636 Test Acc: 0.859
Validation loss decreased (-0.837030 --> -0.859253).  Saving model ...
Epoch: 12 cost time: 0.5511693954467773
Epoch: 12, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866661).  Saving model ...
Epoch: 13 cost time: 0.6232132911682129
Epoch: 13, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.494 Vali Acc: 0.874 Test Loss: 0.494 Test Acc: 0.874
Validation loss decreased (-0.866661 --> -0.874069).  Saving model ...
Epoch: 14 cost time: 0.5880563259124756
Epoch: 14, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.874069 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 0.5681748390197754
Epoch: 15, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.386 Vali Acc: 0.915 Test Loss: 0.386 Test Acc: 0.915
Validation loss decreased (-0.899996 --> -0.914811).  Saving model ...
Epoch: 16 cost time: 0.5158820152282715
Epoch: 16, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.337 Vali Acc: 0.930 Test Loss: 0.337 Test Acc: 0.930
Validation loss decreased (-0.914811 --> -0.929626).  Saving model ...
Epoch: 17 cost time: 0.5413823127746582
Epoch: 17, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940738).  Saving model ...
Epoch: 18 cost time: 0.7845313549041748
Epoch: 18, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5472545623779297
Epoch: 19, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7134711742401123
Epoch: 20, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6237359046936035
Epoch: 21, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.242 Vali Acc: 0.915 Test Loss: 0.242 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5972590446472168
Epoch: 22, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6750602722167969
Epoch: 23, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.231 Vali Acc: 0.915 Test Loss: 0.231 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6101350784301758
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6425707340240479
Epoch: 25, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.665332555770874
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.602820634841919
Epoch: 27, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 240646
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.479658842086792
Epoch: 1, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.771 Vali Acc: 0.193 Test Loss: 1.771 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.5333175659179688
Epoch: 2, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.701 Vali Acc: 0.263 Test Loss: 1.701 Test Acc: 0.263
Validation loss decreased (-0.192575 --> -0.262946).  Saving model ...
Epoch: 3 cost time: 0.6067438125610352
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.632 Vali Acc: 0.337 Test Loss: 1.632 Test Acc: 0.337
Validation loss decreased (-0.262946 --> -0.337021).  Saving model ...
Epoch: 4 cost time: 0.6274280548095703
Epoch: 4, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.542 Vali Acc: 0.437 Test Loss: 1.542 Test Acc: 0.437
Validation loss decreased (-0.337021 --> -0.437022).  Saving model ...
Epoch: 5 cost time: 0.5372970104217529
Epoch: 5, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.428 Vali Acc: 0.526 Test Loss: 1.428 Test Acc: 0.526
Validation loss decreased (-0.437022 --> -0.525912).  Saving model ...
Epoch: 6 cost time: 0.6070880889892578
Epoch: 6, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.300 Vali Acc: 0.641 Test Loss: 1.300 Test Acc: 0.641
Validation loss decreased (-0.525912 --> -0.640728).  Saving model ...
Epoch: 7 cost time: 0.6243453025817871
Epoch: 7, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.169 Vali Acc: 0.752 Test Loss: 1.169 Test Acc: 0.752
Validation loss decreased (-0.640728 --> -0.751840).  Saving model ...
Epoch: 8 cost time: 0.6267647743225098
Epoch: 8, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.040 Vali Acc: 0.800 Test Loss: 1.040 Test Acc: 0.800
Validation loss decreased (-0.751840 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.5596320629119873
Epoch: 9, Steps: 2 | Train Loss: 0.972 Vali Loss: 0.917 Vali Acc: 0.848 Test Loss: 0.917 Test Acc: 0.848
Validation loss decreased (-0.799990 --> -0.848139).  Saving model ...
Epoch: 10 cost time: 0.6016709804534912
Epoch: 10, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.805 Vali Acc: 0.889 Test Loss: 0.805 Test Acc: 0.889
Validation loss decreased (-0.848139 --> -0.888881).  Saving model ...
Epoch: 11 cost time: 0.5877773761749268
Epoch: 11, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.705 Vali Acc: 0.900 Test Loss: 0.705 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.5718615055084229
Epoch: 12, Steps: 2 | Train Loss: 0.559 Vali Loss: 0.619 Vali Acc: 0.911 Test Loss: 0.619 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.911105).  Saving model ...
Epoch: 13 cost time: 0.5356085300445557
Epoch: 13, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.546 Vali Acc: 0.915 Test Loss: 0.546 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 14 cost time: 0.5888495445251465
Epoch: 14, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.485 Vali Acc: 0.930 Test Loss: 0.485 Test Acc: 0.930
Validation loss decreased (-0.914809 --> -0.929625).  Saving model ...
Epoch: 15 cost time: 0.5838007926940918
Epoch: 15, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.430 Vali Acc: 0.933 Test Loss: 0.430 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 16 cost time: 0.617046594619751
Epoch: 16, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.388 Vali Acc: 0.937 Test Loss: 0.388 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 17 cost time: 0.551551342010498
Epoch: 17, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.351 Vali Acc: 0.941 Test Loss: 0.351 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 18 cost time: 0.6506412029266357
Epoch: 18, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.319 Vali Acc: 0.941 Test Loss: 0.319 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 19 cost time: 0.6887285709381104
Epoch: 19, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6109805107116699
Epoch: 20, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5889112949371338
Epoch: 21, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4967689514160156
Epoch: 22, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5843234062194824
Epoch: 23, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7018013000488281
Epoch: 24, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6082420349121094
Epoch: 25, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5023131370544434
Epoch: 26, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6302471160888672
Epoch: 27, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4833402633666992
Epoch: 28, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5840997695922852
Epoch: 29, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.6746580600738525
Epoch: 30, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.6054286956787109
Epoch: 31, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 0.523097038269043
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.5616815090179443
Epoch: 33, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.5531871318817139
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.658113956451416
Epoch: 35, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5586884021759033
Epoch: 36, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6446635723114014
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5394167900085449
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.616133451461792
Epoch: 39, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6962673664093018
Epoch: 40, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6123871803283691
Epoch: 41, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5684373378753662
Epoch: 42, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6329388618469238
Epoch: 43, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 228742
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2189362049102783
Epoch: 1, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.822 Vali Acc: 0.119 Test Loss: 1.822 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.49351978302001953
Epoch: 2, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.747 Vali Acc: 0.141 Test Loss: 1.747 Test Acc: 0.141
Validation loss decreased (-0.118500 --> -0.140723).  Saving model ...
Epoch: 3 cost time: 0.5800418853759766
Epoch: 3, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.683 Vali Acc: 0.200 Test Loss: 1.683 Test Acc: 0.200
Validation loss decreased (-0.140723 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 0.5721139907836914
Epoch: 4, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.607 Vali Acc: 0.274 Test Loss: 1.607 Test Acc: 0.274
Validation loss decreased (-0.199983 --> -0.274058).  Saving model ...
Epoch: 5 cost time: 0.6004674434661865
Epoch: 5, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.513 Vali Acc: 0.478 Test Loss: 1.513 Test Acc: 0.478
Validation loss decreased (-0.274058 --> -0.477763).  Saving model ...
Epoch: 6 cost time: 0.5658502578735352
Epoch: 6, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.407 Vali Acc: 0.607 Test Loss: 1.407 Test Acc: 0.607
Validation loss decreased (-0.477763 --> -0.607393).  Saving model ...
Epoch: 7 cost time: 0.47631382942199707
Epoch: 7, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.294 Vali Acc: 0.670 Test Loss: 1.294 Test Acc: 0.670
Validation loss decreased (-0.607393 --> -0.670357).  Saving model ...
Epoch: 8 cost time: 0.578758955001831
Epoch: 8, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.179 Vali Acc: 0.707 Test Loss: 1.179 Test Acc: 0.707
Validation loss decreased (-0.670357 --> -0.707396).  Saving model ...
Epoch: 9 cost time: 0.5948808193206787
Epoch: 9, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.066 Vali Acc: 0.759 Test Loss: 1.066 Test Acc: 0.759
Validation loss decreased (-0.707396 --> -0.759249).  Saving model ...
Epoch: 10 cost time: 0.4816563129425049
Epoch: 10, Steps: 2 | Train Loss: 0.959 Vali Loss: 0.959 Vali Acc: 0.789 Test Loss: 0.959 Test Acc: 0.789
Validation loss decreased (-0.759249 --> -0.788879).  Saving model ...
Epoch: 11 cost time: 0.5067660808563232
Epoch: 11, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.859 Vali Acc: 0.822 Test Loss: 0.859 Test Acc: 0.822
Validation loss decreased (-0.788879 --> -0.822214).  Saving model ...
Epoch: 12 cost time: 0.5166125297546387
Epoch: 12, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.770 Vali Acc: 0.841 Test Loss: 0.770 Test Acc: 0.841
Validation loss decreased (-0.822214 --> -0.840733).  Saving model ...
Epoch: 13 cost time: 0.5372347831726074
Epoch: 13, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.692 Vali Acc: 0.859 Test Loss: 0.692 Test Acc: 0.859
Validation loss decreased (-0.840733 --> -0.859252).  Saving model ...
Epoch: 14 cost time: 0.5999248027801514
Epoch: 14, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.624 Vali Acc: 0.881 Test Loss: 0.624 Test Acc: 0.881
Validation loss decreased (-0.859252 --> -0.881475).  Saving model ...
Epoch: 15 cost time: 0.6068472862243652
Epoch: 15, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.562 Vali Acc: 0.896 Test Loss: 0.562 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896291).  Saving model ...
Epoch: 16 cost time: 0.5816259384155273
Epoch: 16, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.507 Vali Acc: 0.915 Test Loss: 0.507 Test Acc: 0.915
Validation loss decreased (-0.896291 --> -0.914810).  Saving model ...
Epoch: 17 cost time: 0.5214285850524902
Epoch: 17, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.458 Vali Acc: 0.922 Test Loss: 0.458 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 18 cost time: 0.6177563667297363
Epoch: 18, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.417 Vali Acc: 0.937 Test Loss: 0.417 Test Acc: 0.937
Validation loss decreased (-0.922218 --> -0.937033).  Saving model ...
Epoch: 19 cost time: 0.5300619602203369
Epoch: 19, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.380 Vali Acc: 0.941 Test Loss: 0.380 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 20 cost time: 0.5777425765991211
Epoch: 20, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.350 Vali Acc: 0.933 Test Loss: 0.350 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5353052616119385
Epoch: 21, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5962958335876465
Epoch: 22, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5532360076904297
Epoch: 23, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5280365943908691
Epoch: 24, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6228036880493164
Epoch: 25, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.49843263626098633
Epoch: 26, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.5986676216125488
Epoch: 27, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.5560741424560547
Epoch: 28, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.220 Vali Acc: 0.948 Test Loss: 0.220 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.5494673252105713
Epoch: 29, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.5460376739501953
Epoch: 30, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.5827586650848389
Epoch: 31, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.4793703556060791
Epoch: 32, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.5173549652099609
Epoch: 33, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.5189430713653564
Epoch: 34, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.5343155860900879
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.714970588684082
Epoch: 36, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6357560157775879
Epoch: 37, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.198 Vali Acc: 0.952 Test Loss: 0.198 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.5811030864715576
Epoch: 38, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.5198469161987305
Epoch: 39, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.5393187999725342
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.5296618938446045
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.5828518867492676
Epoch: 42, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.5790812969207764
Epoch: 43, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.5329709053039551
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 45 cost time: 0.6184272766113281
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 46 cost time: 0.609290599822998
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 47 cost time: 0.5956447124481201
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 48 cost time: 0.6641557216644287
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.6712024211883545
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.5311510562896729
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 51 cost time: 0.5839781761169434
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6165115833282471
Epoch: 52, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5726709365844727
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.5553073883056641
Epoch: 54, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.47667694091796875
Epoch: 55, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.5901920795440674
Epoch: 56, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.48531126976013184
Epoch: 57, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.6302263736724854
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.6588490009307861
Epoch: 59, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.5597600936889648
Epoch: 60, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 223110
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.679044008255005
Epoch: 1, Steps: 2 | Train Loss: 2.043 Vali Loss: 1.774 Vali Acc: 0.256 Test Loss: 1.774 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 0.8308637142181396
Epoch: 2, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.611 Vali Acc: 0.367 Test Loss: 1.611 Test Acc: 0.367
Validation loss decreased (-0.255538 --> -0.366651).  Saving model ...
Epoch: 3 cost time: 0.652738094329834
Epoch: 3, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.370 Vali Acc: 0.507 Test Loss: 1.370 Test Acc: 0.507
Validation loss decreased (-0.366651 --> -0.507394).  Saving model ...
Epoch: 4 cost time: 0.8603775501251221
Epoch: 4, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.038 Vali Acc: 0.659 Test Loss: 1.038 Test Acc: 0.659
Validation loss decreased (-0.507394 --> -0.659249).  Saving model ...
Epoch: 5 cost time: 0.6535475254058838
Epoch: 5, Steps: 2 | Train Loss: 0.848 Vali Loss: 0.771 Vali Acc: 0.763 Test Loss: 0.771 Test Acc: 0.763
Validation loss decreased (-0.659249 --> -0.762955).  Saving model ...
Epoch: 6 cost time: 0.7219562530517578
Epoch: 6, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
Validation loss decreased (-0.762955 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.7344250679016113
Epoch: 7, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
Validation loss decreased (-0.833328 --> -0.899996).  Saving model ...
Epoch: 8 cost time: 0.7646756172180176
Epoch: 8, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.336 Vali Acc: 0.911 Test Loss: 0.336 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911108).  Saving model ...
Epoch: 9 cost time: 0.7279384136199951
Epoch: 9, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.306 Vali Acc: 0.896 Test Loss: 0.306 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8887636661529541
Epoch: 10, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.270 Vali Acc: 0.896 Test Loss: 0.270 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8162288665771484
Epoch: 11, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
Validation loss decreased (-0.911108 --> -0.929627).  Saving model ...
Epoch: 12 cost time: 0.7868974208831787
Epoch: 12, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 13 cost time: 0.7464549541473389
Epoch: 13, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 14 cost time: 0.7887430191040039
Epoch: 14, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7714242935180664
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.926 Test Loss: 0.177 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7833542823791504
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7348144054412842
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.926 Test Loss: 0.195 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7089293003082275
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7853338718414307
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7195966243743896
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.713172435760498
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.733494758605957
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6369590759277344
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 366470
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4682669639587402
Epoch: 1, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.834 Vali Acc: 0.167 Test Loss: 1.834 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.6931984424591064
Epoch: 2, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.663 Vali Acc: 0.178 Test Loss: 1.663 Test Acc: 0.178
Validation loss decreased (-0.166648 --> -0.177761).  Saving model ...
Epoch: 3 cost time: 0.6348035335540771
Epoch: 3, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.483 Vali Acc: 0.267 Test Loss: 1.483 Test Acc: 0.267
Validation loss decreased (-0.177761 --> -0.266652).  Saving model ...
Epoch: 4 cost time: 0.6708850860595703
Epoch: 4, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.248 Vali Acc: 0.544 Test Loss: 1.248 Test Acc: 0.544
Validation loss decreased (-0.266652 --> -0.544432).  Saving model ...
Epoch: 5 cost time: 0.7190675735473633
Epoch: 5, Steps: 2 | Train Loss: 1.027 Vali Loss: 1.018 Vali Acc: 0.685 Test Loss: 1.018 Test Acc: 0.685
Validation loss decreased (-0.544432 --> -0.685175).  Saving model ...
Epoch: 6 cost time: 0.6757466793060303
Epoch: 6, Steps: 2 | Train Loss: 0.791 Vali Loss: 0.811 Vali Acc: 0.770 Test Loss: 0.811 Test Acc: 0.770
Validation loss decreased (-0.685175 --> -0.770362).  Saving model ...
Epoch: 7 cost time: 0.6166150569915771
Epoch: 7, Steps: 2 | Train Loss: 0.559 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
Validation loss decreased (-0.770362 --> -0.822216).  Saving model ...
Epoch: 8 cost time: 0.6307506561279297
Epoch: 8, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.518 Vali Acc: 0.896 Test Loss: 0.518 Test Acc: 0.896
Validation loss decreased (-0.822216 --> -0.896291).  Saving model ...
Epoch: 9 cost time: 0.603585958480835
Epoch: 9, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.433 Vali Acc: 0.893 Test Loss: 0.433 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6379451751708984
Epoch: 10, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.369 Vali Acc: 0.904 Test Loss: 0.369 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903700).  Saving model ...
Epoch: 11 cost time: 0.74635910987854
Epoch: 11, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
Validation loss decreased (-0.903700 --> -0.918515).  Saving model ...
Epoch: 12 cost time: 0.5972046852111816
Epoch: 12, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
Validation loss decreased (-0.918515 --> -0.940738).  Saving model ...
Epoch: 13 cost time: 0.6936678886413574
Epoch: 13, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.6772334575653076
Epoch: 14, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.6138992309570312
Epoch: 15, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6242821216583252
Epoch: 16, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6698627471923828
Epoch: 17, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6444032192230225
Epoch: 18, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6257989406585693
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6519250869750977
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.930 Test Loss: 0.177 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6925754547119141
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7478406429290771
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.68338942527771
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7230980396270752
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 265350
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2450921535491943
Epoch: 1, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.845 Vali Acc: 0.326 Test Loss: 1.845 Test Acc: 0.326
Validation loss decreased (inf --> -0.325907).  Saving model ...
Epoch: 2 cost time: 0.6316695213317871
Epoch: 2, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.725 Vali Acc: 0.333 Test Loss: 1.725 Test Acc: 0.333
Validation loss decreased (-0.325907 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 0.6524546146392822
Epoch: 3, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.593 Vali Acc: 0.363 Test Loss: 1.593 Test Acc: 0.363
Validation loss decreased (-0.333316 --> -0.362947).  Saving model ...
Epoch: 4 cost time: 0.6571412086486816
Epoch: 4, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.408 Vali Acc: 0.456 Test Loss: 1.408 Test Acc: 0.456
Validation loss decreased (-0.362947 --> -0.455541).  Saving model ...
Epoch: 5 cost time: 0.6008281707763672
Epoch: 5, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.202 Vali Acc: 0.648 Test Loss: 1.202 Test Acc: 0.648
Validation loss decreased (-0.455541 --> -0.648136).  Saving model ...
Epoch: 6 cost time: 0.7235488891601562
Epoch: 6, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.003 Vali Acc: 0.722 Test Loss: 1.003 Test Acc: 0.722
Validation loss decreased (-0.648136 --> -0.722212).  Saving model ...
Epoch: 7 cost time: 0.6552722454071045
Epoch: 7, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.834 Vali Acc: 0.781 Test Loss: 0.834 Test Acc: 0.781
Validation loss decreased (-0.722212 --> -0.781473).  Saving model ...
Epoch: 8 cost time: 0.6661944389343262
Epoch: 8, Steps: 2 | Train Loss: 0.559 Vali Loss: 0.688 Vali Acc: 0.819 Test Loss: 0.688 Test Acc: 0.819
Validation loss decreased (-0.781473 --> -0.818512).  Saving model ...
Epoch: 9 cost time: 0.5897195339202881
Epoch: 9, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.564 Vali Acc: 0.874 Test Loss: 0.564 Test Acc: 0.874
Validation loss decreased (-0.818512 --> -0.874068).  Saving model ...
Epoch: 10 cost time: 0.5834403038024902
Epoch: 10, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.469 Vali Acc: 0.911 Test Loss: 0.469 Test Acc: 0.911
Validation loss decreased (-0.874068 --> -0.911106).  Saving model ...
Epoch: 11 cost time: 0.7193546295166016
Epoch: 11, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.393 Vali Acc: 0.915 Test Loss: 0.393 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914811).  Saving model ...
Epoch: 12 cost time: 0.663776159286499
Epoch: 12, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.333 Vali Acc: 0.926 Test Loss: 0.333 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925923).  Saving model ...
Epoch: 13 cost time: 0.6776440143585205
Epoch: 13, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.285 Vali Acc: 0.937 Test Loss: 0.285 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937034).  Saving model ...
Epoch: 14 cost time: 0.6414215564727783
Epoch: 14, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 15 cost time: 0.6676249504089355
Epoch: 15, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.6471419334411621
Epoch: 16, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6017978191375732
Epoch: 17, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6364219188690186
Epoch: 18, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5723285675048828
Epoch: 19, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5875296592712402
Epoch: 20, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6348180770874023
Epoch: 21, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6764786243438721
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5721352100372314
Epoch: 23, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6873509883880615
Epoch: 24, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.937 Test Loss: 0.166 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6520891189575195
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.937 Test Loss: 0.164 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 234758
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.156621217727661
Epoch: 1, Steps: 2 | Train Loss: 2.008 Vali Loss: 1.768 Vali Acc: 0.307 Test Loss: 1.768 Test Acc: 0.307
Validation loss decreased (inf --> -0.307390).  Saving model ...
Epoch: 2 cost time: 0.5475058555603027
Epoch: 2, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.672 Vali Acc: 0.385 Test Loss: 1.672 Test Acc: 0.385
Validation loss decreased (-0.307390 --> -0.385168).  Saving model ...
Epoch: 3 cost time: 0.7857275009155273
Epoch: 3, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.573 Vali Acc: 0.452 Test Loss: 1.573 Test Acc: 0.452
Validation loss decreased (-0.385168 --> -0.451836).  Saving model ...
Epoch: 4 cost time: 0.6767797470092773
Epoch: 4, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.438 Vali Acc: 0.526 Test Loss: 1.438 Test Acc: 0.526
Validation loss decreased (-0.451836 --> -0.525912).  Saving model ...
Epoch: 5 cost time: 0.6386427879333496
Epoch: 5, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.277 Vali Acc: 0.707 Test Loss: 1.277 Test Acc: 0.707
Validation loss decreased (-0.525912 --> -0.707395).  Saving model ...
Epoch: 6 cost time: 0.6450080871582031
Epoch: 6, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.106 Vali Acc: 0.819 Test Loss: 1.106 Test Acc: 0.819
Validation loss decreased (-0.707395 --> -0.818507).  Saving model ...
Epoch: 7 cost time: 0.6559631824493408
Epoch: 7, Steps: 2 | Train Loss: 0.989 Vali Loss: 0.940 Vali Acc: 0.859 Test Loss: 0.940 Test Acc: 0.859
Validation loss decreased (-0.818507 --> -0.859250).  Saving model ...
Epoch: 8 cost time: 0.7221288681030273
Epoch: 8, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.791 Vali Acc: 0.878 Test Loss: 0.791 Test Acc: 0.878
Validation loss decreased (-0.859250 --> -0.877770).  Saving model ...
Epoch: 9 cost time: 0.6488902568817139
Epoch: 9, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.668 Vali Acc: 0.907 Test Loss: 0.668 Test Acc: 0.907
Validation loss decreased (-0.877770 --> -0.907401).  Saving model ...
Epoch: 10 cost time: 0.7097187042236328
Epoch: 10, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.573 Vali Acc: 0.915 Test Loss: 0.573 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 11 cost time: 0.6878926753997803
Epoch: 11, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.491 Vali Acc: 0.930 Test Loss: 0.491 Test Acc: 0.930
Validation loss decreased (-0.914809 --> -0.929625).  Saving model ...
Epoch: 12 cost time: 0.5697081089019775
Epoch: 12, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.422 Vali Acc: 0.937 Test Loss: 0.422 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 13 cost time: 0.6226263046264648
Epoch: 13, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.365 Vali Acc: 0.933 Test Loss: 0.365 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6819713115692139
Epoch: 14, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7528409957885742
Epoch: 15, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940738).  Saving model ...
Epoch: 16 cost time: 0.5956106185913086
Epoch: 16, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.260 Vali Acc: 0.948 Test Loss: 0.260 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 17 cost time: 0.5733778476715088
Epoch: 17, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.236 Vali Acc: 0.948 Test Loss: 0.236 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.5931565761566162
Epoch: 18, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.5876109600067139
Epoch: 19, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6320984363555908
Epoch: 20, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6787474155426025
Epoch: 21, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5731832981109619
Epoch: 22, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6714057922363281
Epoch: 23, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6577117443084717
Epoch: 24, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7044723033905029
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7036995887756348
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.602827787399292
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5826771259307861
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 216582
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.359051465988159
Epoch: 1, Steps: 2 | Train Loss: 1.968 Vali Loss: 1.713 Vali Acc: 0.281 Test Loss: 1.713 Test Acc: 0.281
Validation loss decreased (inf --> -0.281464).  Saving model ...
Epoch: 2 cost time: 0.592766284942627
Epoch: 2, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.637 Vali Acc: 0.322 Test Loss: 1.637 Test Acc: 0.322
Validation loss decreased (-0.281464 --> -0.322206).  Saving model ...
Epoch: 3 cost time: 0.5898997783660889
Epoch: 3, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.563 Vali Acc: 0.385 Test Loss: 1.563 Test Acc: 0.385
Validation loss decreased (-0.322206 --> -0.385170).  Saving model ...
Epoch: 4 cost time: 0.8183615207672119
Epoch: 4, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.460 Vali Acc: 0.448 Test Loss: 1.460 Test Acc: 0.448
Validation loss decreased (-0.385170 --> -0.448134).  Saving model ...
Epoch: 5 cost time: 0.607224702835083
Epoch: 5, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.338 Vali Acc: 0.522 Test Loss: 1.338 Test Acc: 0.522
Validation loss decreased (-0.448134 --> -0.522209).  Saving model ...
Epoch: 6 cost time: 0.5735559463500977
Epoch: 6, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.203 Vali Acc: 0.630 Test Loss: 1.203 Test Acc: 0.630
Validation loss decreased (-0.522209 --> -0.629618).  Saving model ...
Epoch: 7 cost time: 0.6511681079864502
Epoch: 7, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.064 Vali Acc: 0.752 Test Loss: 1.064 Test Acc: 0.752
Validation loss decreased (-0.629618 --> -0.751841).  Saving model ...
Epoch: 8 cost time: 0.5332276821136475
Epoch: 8, Steps: 2 | Train Loss: 0.977 Vali Loss: 0.933 Vali Acc: 0.833 Test Loss: 0.933 Test Acc: 0.833
Validation loss decreased (-0.751841 --> -0.833324).  Saving model ...
Epoch: 9 cost time: 0.5866374969482422
Epoch: 9, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.811 Vali Acc: 0.859 Test Loss: 0.811 Test Acc: 0.859
Validation loss decreased (-0.833324 --> -0.859251).  Saving model ...
Epoch: 10 cost time: 0.6157913208007812
Epoch: 10, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.702 Vali Acc: 0.881 Test Loss: 0.702 Test Acc: 0.881
Validation loss decreased (-0.859251 --> -0.881474).  Saving model ...
Epoch: 11 cost time: 0.765031099319458
Epoch: 11, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.607 Vali Acc: 0.922 Test Loss: 0.607 Test Acc: 0.922
Validation loss decreased (-0.881474 --> -0.922216).  Saving model ...
Epoch: 12 cost time: 0.6264808177947998
Epoch: 12, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.527 Vali Acc: 0.919 Test Loss: 0.527 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5951762199401855
Epoch: 13, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.464 Vali Acc: 0.904 Test Loss: 0.464 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5874314308166504
Epoch: 14, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.409 Vali Acc: 0.904 Test Loss: 0.409 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5327780246734619
Epoch: 15, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.361 Vali Acc: 0.904 Test Loss: 0.361 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6394908428192139
Epoch: 16, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.321 Vali Acc: 0.911 Test Loss: 0.321 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5954394340515137
Epoch: 17, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922219).  Saving model ...
Epoch: 18 cost time: 0.6078684329986572
Epoch: 18, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6185340881347656
Epoch: 19, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 0.6011326313018799
Epoch: 20, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 21 cost time: 0.6839253902435303
Epoch: 21, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.7580797672271729
Epoch: 22, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5988047122955322
Epoch: 23, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
Validation loss decreased (-0.944442 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.5492374897003174
Epoch: 24, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.7515571117401123
Epoch: 25, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.672476053237915
Epoch: 26, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6250772476196289
Epoch: 27, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6196846961975098
Epoch: 28, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5443031787872314
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5422008037567139
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6194305419921875
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6607751846313477
Epoch: 32, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6010982990264893
Epoch: 33, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6593039035797119
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 207750
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1053054332733154
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.854 Vali Acc: 0.133 Test Loss: 1.854 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 0.5562067031860352
Epoch: 2, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.766 Vali Acc: 0.204 Test Loss: 1.766 Test Acc: 0.204
Validation loss decreased (-0.133315 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.5968227386474609
Epoch: 3, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.686 Vali Acc: 0.296 Test Loss: 1.686 Test Acc: 0.296
Validation loss decreased (-0.203686 --> -0.296279).  Saving model ...
Epoch: 4 cost time: 0.5481853485107422
Epoch: 4, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.590 Vali Acc: 0.359 Test Loss: 1.590 Test Acc: 0.359
Validation loss decreased (-0.296279 --> -0.359243).  Saving model ...
Epoch: 5 cost time: 0.6011042594909668
Epoch: 5, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.475 Vali Acc: 0.474 Test Loss: 1.475 Test Acc: 0.474
Validation loss decreased (-0.359243 --> -0.474059).  Saving model ...
Epoch: 6 cost time: 0.5122265815734863
Epoch: 6, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.350 Vali Acc: 0.556 Test Loss: 1.350 Test Acc: 0.556
Validation loss decreased (-0.474059 --> -0.555542).  Saving model ...
Epoch: 7 cost time: 0.6394147872924805
Epoch: 7, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.219 Vali Acc: 0.633 Test Loss: 1.219 Test Acc: 0.633
Validation loss decreased (-0.555542 --> -0.633321).  Saving model ...
Epoch: 8 cost time: 0.5766518115997314
Epoch: 8, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.090 Vali Acc: 0.707 Test Loss: 1.090 Test Acc: 0.707
Validation loss decreased (-0.633321 --> -0.707397).  Saving model ...
Epoch: 9 cost time: 0.5231893062591553
Epoch: 9, Steps: 2 | Train Loss: 0.926 Vali Loss: 0.967 Vali Acc: 0.763 Test Loss: 0.967 Test Acc: 0.763
Validation loss decreased (-0.707397 --> -0.762953).  Saving model ...
Epoch: 10 cost time: 0.5519976615905762
Epoch: 10, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.854 Vali Acc: 0.800 Test Loss: 0.854 Test Acc: 0.800
Validation loss decreased (-0.762953 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 0.5396912097930908
Epoch: 11, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.754 Vali Acc: 0.811 Test Loss: 0.754 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 0.501166582107544
Epoch: 12, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.666 Vali Acc: 0.833 Test Loss: 0.666 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 0.8768954277038574
Epoch: 13, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840735).  Saving model ...
Epoch: 14 cost time: 0.6107828617095947
Epoch: 14, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.522 Vali Acc: 0.859 Test Loss: 0.522 Test Acc: 0.859
Validation loss decreased (-0.840735 --> -0.859254).  Saving model ...
Epoch: 15 cost time: 0.5593867301940918
Epoch: 15, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.465 Vali Acc: 0.881 Test Loss: 0.465 Test Acc: 0.881
Validation loss decreased (-0.859254 --> -0.881477).  Saving model ...
Epoch: 16 cost time: 0.5518167018890381
Epoch: 16, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.881477 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 0.6911764144897461
Epoch: 17, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.379 Vali Acc: 0.907 Test Loss: 0.379 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907404).  Saving model ...
Epoch: 18 cost time: 0.7768690586090088
Epoch: 18, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.346 Vali Acc: 0.911 Test Loss: 0.346 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 0.5770299434661865
Epoch: 19, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.316 Vali Acc: 0.919 Test Loss: 0.316 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.5409364700317383
Epoch: 20, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.294 Vali Acc: 0.915 Test Loss: 0.294 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5582764148712158
Epoch: 21, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.273 Vali Acc: 0.915 Test Loss: 0.273 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5935671329498291
Epoch: 22, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.257 Vali Acc: 0.915 Test Loss: 0.257 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.542050838470459
Epoch: 23, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.245 Vali Acc: 0.915 Test Loss: 0.245 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.597785234451294
Epoch: 24, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925924).  Saving model ...
Epoch: 25 cost time: 0.5717027187347412
Epoch: 25, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.925924 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.5483834743499756
Epoch: 26, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.6211230754852295
Epoch: 27, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7684838771820068
Epoch: 28, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6610689163208008
Epoch: 29, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.5239353179931641
Epoch: 30, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.5204281806945801
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.6054964065551758
Epoch: 32, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.6154906749725342
Epoch: 33, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6130409240722656
Epoch: 34, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.555727481842041
Epoch: 35, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6200625896453857
Epoch: 36, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5828161239624023
Epoch: 37, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5556173324584961
Epoch: 38, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5337586402893066
Epoch: 39, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6189975738525391
Epoch: 40, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5433993339538574
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5912497043609619
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 195846
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.423234462738037
Epoch: 1, Steps: 2 | Train Loss: 2.144 Vali Loss: 2.046 Vali Acc: 0.015 Test Loss: 2.046 Test Acc: 0.015
Validation loss decreased (inf --> -0.014794).  Saving model ...
Epoch: 2 cost time: 0.5807082653045654
Epoch: 2, Steps: 2 | Train Loss: 1.908 Vali Loss: 1.962 Vali Acc: 0.048 Test Loss: 1.962 Test Acc: 0.048
Validation loss decreased (-0.014794 --> -0.048129).  Saving model ...
Epoch: 3 cost time: 0.5620794296264648
Epoch: 3, Steps: 2 | Train Loss: 1.963 Vali Loss: 1.888 Vali Acc: 0.130 Test Loss: 1.888 Test Acc: 0.130
Validation loss decreased (-0.048129 --> -0.129611).  Saving model ...
Epoch: 4 cost time: 0.6393229961395264
Epoch: 4, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.803 Vali Acc: 0.215 Test Loss: 1.803 Test Acc: 0.215
Validation loss decreased (-0.129611 --> -0.214797).  Saving model ...
Epoch: 5 cost time: 0.5558185577392578
Epoch: 5, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.698 Vali Acc: 0.356 Test Loss: 1.698 Test Acc: 0.356
Validation loss decreased (-0.214797 --> -0.355539).  Saving model ...
Epoch: 6 cost time: 0.6552808284759521
Epoch: 6, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.578 Vali Acc: 0.470 Test Loss: 1.578 Test Acc: 0.470
Validation loss decreased (-0.355539 --> -0.470355).  Saving model ...
Epoch: 7 cost time: 0.6069045066833496
Epoch: 7, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.451 Vali Acc: 0.559 Test Loss: 1.451 Test Acc: 0.559
Validation loss decreased (-0.470355 --> -0.559245).  Saving model ...
Epoch: 8 cost time: 0.594963550567627
Epoch: 8, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.320 Vali Acc: 0.667 Test Loss: 1.320 Test Acc: 0.667
Validation loss decreased (-0.559245 --> -0.666653).  Saving model ...
Epoch: 9 cost time: 0.6603426933288574
Epoch: 9, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.190 Vali Acc: 0.733 Test Loss: 1.190 Test Acc: 0.733
Validation loss decreased (-0.666653 --> -0.733321).  Saving model ...
Epoch: 10 cost time: 0.8195004463195801
Epoch: 10, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.067 Vali Acc: 0.774 Test Loss: 1.067 Test Acc: 0.774
Validation loss decreased (-0.733321 --> -0.774063).  Saving model ...
Epoch: 11 cost time: 0.5785622596740723
Epoch: 11, Steps: 2 | Train Loss: 0.925 Vali Loss: 0.953 Vali Acc: 0.796 Test Loss: 0.953 Test Acc: 0.796
Validation loss decreased (-0.774063 --> -0.796287).  Saving model ...
Epoch: 12 cost time: 0.5702459812164307
Epoch: 12, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.848 Vali Acc: 0.819 Test Loss: 0.848 Test Acc: 0.819
Validation loss decreased (-0.796287 --> -0.818510).  Saving model ...
Epoch: 13 cost time: 0.6154172420501709
Epoch: 13, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.755 Vali Acc: 0.841 Test Loss: 0.755 Test Acc: 0.841
Validation loss decreased (-0.818510 --> -0.840733).  Saving model ...
Epoch: 14 cost time: 0.5995335578918457
Epoch: 14, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.674 Vali Acc: 0.867 Test Loss: 0.674 Test Acc: 0.867
Validation loss decreased (-0.840733 --> -0.866660).  Saving model ...
Epoch: 15 cost time: 0.6422052383422852
Epoch: 15, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.606 Vali Acc: 0.874 Test Loss: 0.606 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874068).  Saving model ...
Epoch: 16 cost time: 0.5272424221038818
Epoch: 16, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.546 Vali Acc: 0.881 Test Loss: 0.546 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 17 cost time: 0.7829217910766602
Epoch: 17, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.493 Vali Acc: 0.896 Test Loss: 0.493 Test Acc: 0.896
Validation loss decreased (-0.881476 --> -0.896291).  Saving model ...
Epoch: 18 cost time: 0.5968670845031738
Epoch: 18, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.5633859634399414
Epoch: 19, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.5897316932678223
Epoch: 20, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.377 Vali Acc: 0.911 Test Loss: 0.377 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911107).  Saving model ...
Epoch: 21 cost time: 0.707622766494751
Epoch: 21, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.347 Vali Acc: 0.926 Test Loss: 0.347 Test Acc: 0.926
Validation loss decreased (-0.911107 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.6053075790405273
Epoch: 22, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 23 cost time: 0.5795252323150635
Epoch: 23, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.301 Vali Acc: 0.933 Test Loss: 0.301 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 24 cost time: 0.5414774417877197
Epoch: 24, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.6715826988220215
Epoch: 25, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 26 cost time: 0.6195895671844482
Epoch: 26, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 27 cost time: 0.7294094562530518
Epoch: 27, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 28 cost time: 0.5914719104766846
Epoch: 28, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.609738826751709
Epoch: 29, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5410463809967041
Epoch: 30, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.466599702835083
Epoch: 31, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6937098503112793
Epoch: 32, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7249937057495117
Epoch: 33, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7060389518737793
Epoch: 34, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5466578006744385
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6020309925079346
Epoch: 36, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7096347808837891
Epoch: 37, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7921552658081055
Epoch: 38, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm128_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 190214
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4367756843566895
Epoch: 1, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.663 Vali Acc: 0.374 Test Loss: 1.663 Test Acc: 0.374
Validation loss decreased (inf --> -0.374057).  Saving model ...
Epoch: 2 cost time: 0.6290209293365479
Epoch: 2, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.547 Vali Acc: 0.411 Test Loss: 1.547 Test Acc: 0.411
Validation loss decreased (-0.374057 --> -0.411096).  Saving model ...
Epoch: 3 cost time: 0.5692038536071777
Epoch: 3, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.405 Vali Acc: 0.470 Test Loss: 1.405 Test Acc: 0.470
Validation loss decreased (-0.411096 --> -0.470356).  Saving model ...
Epoch: 4 cost time: 0.5908405780792236
Epoch: 4, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.198 Vali Acc: 0.581 Test Loss: 1.198 Test Acc: 0.581
Validation loss decreased (-0.470356 --> -0.581470).  Saving model ...
Epoch: 5 cost time: 0.7044641971588135
Epoch: 5, Steps: 2 | Train Loss: 1.064 Vali Loss: 0.989 Vali Acc: 0.722 Test Loss: 0.989 Test Acc: 0.722
Validation loss decreased (-0.581470 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 0.7005369663238525
Epoch: 6, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.796 Vali Acc: 0.822 Test Loss: 0.796 Test Acc: 0.822
Validation loss decreased (-0.722212 --> -0.822214).  Saving model ...
Epoch: 7 cost time: 0.6648807525634766
Epoch: 7, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.637 Vali Acc: 0.881 Test Loss: 0.637 Test Acc: 0.881
Validation loss decreased (-0.822214 --> -0.881475).  Saving model ...
Epoch: 8 cost time: 0.6881439685821533
Epoch: 8, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.523 Vali Acc: 0.893 Test Loss: 0.523 Test Acc: 0.893
Validation loss decreased (-0.881475 --> -0.892587).  Saving model ...
Epoch: 9 cost time: 0.7039737701416016
Epoch: 9, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.434 Vali Acc: 0.919 Test Loss: 0.434 Test Acc: 0.919
Validation loss decreased (-0.892587 --> -0.918514).  Saving model ...
Epoch: 10 cost time: 0.627434253692627
Epoch: 10, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.359 Vali Acc: 0.926 Test Loss: 0.359 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 11 cost time: 0.767601490020752
Epoch: 11, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7073442935943604
Epoch: 12, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.267 Vali Acc: 0.919 Test Loss: 0.267 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7160348892211914
Epoch: 13, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7902109622955322
Epoch: 14, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933331).  Saving model ...
Epoch: 15 cost time: 0.6714661121368408
Epoch: 15, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 16 cost time: 0.7214968204498291
Epoch: 16, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.6527059078216553
Epoch: 17, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.7458655834197998
Epoch: 18, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.7024350166320801
Epoch: 19, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.6728684902191162
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6540913581848145
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6692132949829102
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5896756649017334
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9316320419311523
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7052462100982666
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7362978458404541
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7453591823577881
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9055652618408203
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6993803977966309
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 200070
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.234851360321045
Epoch: 1, Steps: 2 | Train Loss: 1.983 Vali Loss: 1.802 Vali Acc: 0.259 Test Loss: 1.802 Test Acc: 0.259
Validation loss decreased (inf --> -0.259241).  Saving model ...
Epoch: 2 cost time: 0.73288893699646
Epoch: 2, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.705 Vali Acc: 0.337 Test Loss: 1.705 Test Acc: 0.337
Validation loss decreased (-0.259241 --> -0.337020).  Saving model ...
Epoch: 3 cost time: 0.623314619064331
Epoch: 3, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.605 Vali Acc: 0.404 Test Loss: 1.605 Test Acc: 0.404
Validation loss decreased (-0.337020 --> -0.403688).  Saving model ...
Epoch: 4 cost time: 0.6274664402008057
Epoch: 4, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.474 Vali Acc: 0.478 Test Loss: 1.474 Test Acc: 0.478
Validation loss decreased (-0.403688 --> -0.477763).  Saving model ...
Epoch: 5 cost time: 0.6731729507446289
Epoch: 5, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.321 Vali Acc: 0.607 Test Loss: 1.321 Test Acc: 0.607
Validation loss decreased (-0.477763 --> -0.607394).  Saving model ...
Epoch: 6 cost time: 0.6642045974731445
Epoch: 6, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.159 Vali Acc: 0.681 Test Loss: 1.159 Test Acc: 0.681
Validation loss decreased (-0.607394 --> -0.681470).  Saving model ...
Epoch: 7 cost time: 0.5940651893615723
Epoch: 7, Steps: 2 | Train Loss: 1.011 Vali Loss: 0.998 Vali Acc: 0.722 Test Loss: 0.998 Test Acc: 0.722
Validation loss decreased (-0.681470 --> -0.722212).  Saving model ...
Epoch: 8 cost time: 0.5381662845611572
Epoch: 8, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.853 Vali Acc: 0.778 Test Loss: 0.853 Test Acc: 0.778
Validation loss decreased (-0.722212 --> -0.777769).  Saving model ...
Epoch: 9 cost time: 0.640610933303833
Epoch: 9, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.728 Vali Acc: 0.819 Test Loss: 0.728 Test Acc: 0.819
Validation loss decreased (-0.777769 --> -0.818511).  Saving model ...
Epoch: 10 cost time: 0.6006402969360352
Epoch: 10, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.619 Vali Acc: 0.889 Test Loss: 0.619 Test Acc: 0.889
Validation loss decreased (-0.818511 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 0.6945033073425293
Epoch: 11, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.531 Vali Acc: 0.911 Test Loss: 0.531 Test Acc: 0.911
Validation loss decreased (-0.888883 --> -0.911106).  Saving model ...
Epoch: 12 cost time: 0.6239585876464844
Epoch: 12, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.463 Vali Acc: 0.911 Test Loss: 0.463 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 13 cost time: 0.6889872550964355
Epoch: 13, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.403 Vali Acc: 0.915 Test Loss: 0.403 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914811).  Saving model ...
Epoch: 14 cost time: 0.6264305114746094
Epoch: 14, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 15 cost time: 0.6476831436157227
Epoch: 15, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 16 cost time: 0.592897891998291
Epoch: 16, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.288 Vali Acc: 0.926 Test Loss: 0.288 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 17 cost time: 0.6623892784118652
Epoch: 17, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.605689525604248
Epoch: 18, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.729665994644165
Epoch: 19, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6246397495269775
Epoch: 20, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6302292346954346
Epoch: 21, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6812143325805664
Epoch: 22, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.5807561874389648
Epoch: 23, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.7294671535491943
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.5944797992706299
Epoch: 25, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.6521625518798828
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.7160518169403076
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7129440307617188
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6306977272033691
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6200172901153564
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6489839553833008
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7146272659301758
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5916833877563477
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6721444129943848
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6959996223449707
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6476233005523682
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 149510
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.750666856765747
Epoch: 1, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.674 Vali Acc: 0.370 Test Loss: 1.674 Test Acc: 0.370
Validation loss decreased (inf --> -0.370354).  Saving model ...
Epoch: 2 cost time: 0.6147148609161377
Epoch: 2, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.607 Vali Acc: 0.404 Test Loss: 1.607 Test Acc: 0.404
Validation loss decreased (-0.370354 --> -0.403688).  Saving model ...
Epoch: 3 cost time: 0.6441805362701416
Epoch: 3, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.541 Vali Acc: 0.433 Test Loss: 1.541 Test Acc: 0.433
Validation loss decreased (-0.403688 --> -0.433318).  Saving model ...
Epoch: 4 cost time: 0.6860120296478271
Epoch: 4, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.453 Vali Acc: 0.463 Test Loss: 1.453 Test Acc: 0.463
Validation loss decreased (-0.433318 --> -0.462948).  Saving model ...
Epoch: 5 cost time: 0.6804616451263428
Epoch: 5, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.348 Vali Acc: 0.552 Test Loss: 1.348 Test Acc: 0.552
Validation loss decreased (-0.462948 --> -0.551838).  Saving model ...
Epoch: 6 cost time: 0.808830976486206
Epoch: 6, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.231 Vali Acc: 0.659 Test Loss: 1.231 Test Acc: 0.659
Validation loss decreased (-0.551838 --> -0.659247).  Saving model ...
Epoch: 7 cost time: 0.5894055366516113
Epoch: 7, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.110 Vali Acc: 0.700 Test Loss: 1.110 Test Acc: 0.700
Validation loss decreased (-0.659247 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.5659031867980957
Epoch: 8, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.994 Vali Acc: 0.741 Test Loss: 0.994 Test Acc: 0.741
Validation loss decreased (-0.699989 --> -0.740731).  Saving model ...
Epoch: 9 cost time: 0.6463899612426758
Epoch: 9, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.882 Vali Acc: 0.770 Test Loss: 0.882 Test Acc: 0.770
Validation loss decreased (-0.740731 --> -0.770362).  Saving model ...
Epoch: 10 cost time: 0.706251859664917
Epoch: 10, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.777 Vali Acc: 0.796 Test Loss: 0.777 Test Acc: 0.796
Validation loss decreased (-0.770362 --> -0.796289).  Saving model ...
Epoch: 11 cost time: 0.594310998916626
Epoch: 11, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.683 Vali Acc: 0.819 Test Loss: 0.683 Test Acc: 0.819
Validation loss decreased (-0.796289 --> -0.818512).  Saving model ...
Epoch: 12 cost time: 0.681267499923706
Epoch: 12, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.597 Vali Acc: 0.848 Test Loss: 0.597 Test Acc: 0.848
Validation loss decreased (-0.818512 --> -0.848142).  Saving model ...
Epoch: 13 cost time: 0.6014814376831055
Epoch: 13, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.526 Vali Acc: 0.870 Test Loss: 0.526 Test Acc: 0.870
Validation loss decreased (-0.848142 --> -0.870365).  Saving model ...
Epoch: 14 cost time: 0.6331348419189453
Epoch: 14, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.870365 --> -0.888884).  Saving model ...
Epoch: 15 cost time: 0.6087026596069336
Epoch: 15, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.408 Vali Acc: 0.911 Test Loss: 0.408 Test Acc: 0.911
Validation loss decreased (-0.888884 --> -0.911107).  Saving model ...
Epoch: 16 cost time: 0.5939593315124512
Epoch: 16, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.364 Vali Acc: 0.922 Test Loss: 0.364 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.6196503639221191
Epoch: 17, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 18 cost time: 0.6497879028320312
Epoch: 18, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 19 cost time: 0.593576192855835
Epoch: 19, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 20 cost time: 0.5652365684509277
Epoch: 20, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.260 Vali Acc: 0.926 Test Loss: 0.260 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 21 cost time: 0.5921449661254883
Epoch: 21, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 22 cost time: 0.7318525314331055
Epoch: 22, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 0.6102688312530518
Epoch: 23, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.6254286766052246
Epoch: 24, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.556246280670166
Epoch: 25, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5180563926696777
Epoch: 26, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5750265121459961
Epoch: 27, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.5427913665771484
Epoch: 28, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.5983133316040039
Epoch: 29, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.5810387134552002
Epoch: 30, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.6851956844329834
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.6636579036712646
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.6018013954162598
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.5395603179931641
Epoch: 34, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.6498336791992188
Epoch: 35, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.6049869060516357
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.5459303855895996
Epoch: 37, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.6091170310974121
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6271603107452393
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5047311782836914
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5992703437805176
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5848243236541748
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6403567790985107
Epoch: 43, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6107792854309082
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5539312362670898
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5985631942749023
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6083576679229736
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 134214
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3814449310302734
Epoch: 1, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.830 Vali Acc: 0.156 Test Loss: 1.830 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 0.6092796325683594
Epoch: 2, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.762 Vali Acc: 0.181 Test Loss: 1.762 Test Acc: 0.181
Validation loss decreased (-0.155537 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.5297014713287354
Epoch: 3, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.700 Vali Acc: 0.222 Test Loss: 1.700 Test Acc: 0.222
Validation loss decreased (-0.181464 --> -0.222205).  Saving model ...
Epoch: 4 cost time: 0.5385196208953857
Epoch: 4, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.624 Vali Acc: 0.278 Test Loss: 1.624 Test Acc: 0.278
Validation loss decreased (-0.222205 --> -0.277762).  Saving model ...
Epoch: 5 cost time: 0.6517684459686279
Epoch: 5, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.527 Vali Acc: 0.378 Test Loss: 1.527 Test Acc: 0.378
Validation loss decreased (-0.277762 --> -0.377763).  Saving model ...
Epoch: 6 cost time: 0.5576112270355225
Epoch: 6, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.416 Vali Acc: 0.581 Test Loss: 1.416 Test Acc: 0.581
Validation loss decreased (-0.377763 --> -0.581467).  Saving model ...
Epoch: 7 cost time: 0.517388105392456
Epoch: 7, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.298 Vali Acc: 0.663 Test Loss: 1.298 Test Acc: 0.663
Validation loss decreased (-0.581467 --> -0.662950).  Saving model ...
Epoch: 8 cost time: 0.553607702255249
Epoch: 8, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.176 Vali Acc: 0.707 Test Loss: 1.176 Test Acc: 0.707
Validation loss decreased (-0.662950 --> -0.707396).  Saving model ...
Epoch: 9 cost time: 0.5761618614196777
Epoch: 9, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.060 Vali Acc: 0.759 Test Loss: 1.060 Test Acc: 0.759
Validation loss decreased (-0.707396 --> -0.759249).  Saving model ...
Epoch: 10 cost time: 0.6283683776855469
Epoch: 10, Steps: 2 | Train Loss: 0.987 Vali Loss: 0.951 Vali Acc: 0.785 Test Loss: 0.951 Test Acc: 0.785
Validation loss decreased (-0.759249 --> -0.785176).  Saving model ...
Epoch: 11 cost time: 0.5465664863586426
Epoch: 11, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.852 Vali Acc: 0.819 Test Loss: 0.852 Test Acc: 0.819
Validation loss decreased (-0.785176 --> -0.818510).  Saving model ...
Epoch: 12 cost time: 0.5507590770721436
Epoch: 12, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.764 Vali Acc: 0.844 Test Loss: 0.764 Test Acc: 0.844
Validation loss decreased (-0.818510 --> -0.844437).  Saving model ...
Epoch: 13 cost time: 0.6239421367645264
Epoch: 13, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.685 Vali Acc: 0.874 Test Loss: 0.685 Test Acc: 0.874
Validation loss decreased (-0.844437 --> -0.874067).  Saving model ...
Epoch: 14 cost time: 0.5670642852783203
Epoch: 14, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.614 Vali Acc: 0.885 Test Loss: 0.614 Test Acc: 0.885
Validation loss decreased (-0.874067 --> -0.885179).  Saving model ...
Epoch: 15 cost time: 0.6303739547729492
Epoch: 15, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.550 Vali Acc: 0.896 Test Loss: 0.550 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896291).  Saving model ...
Epoch: 16 cost time: 0.5502018928527832
Epoch: 16, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.495 Vali Acc: 0.907 Test Loss: 0.495 Test Acc: 0.907
Validation loss decreased (-0.896291 --> -0.907402).  Saving model ...
Epoch: 17 cost time: 0.5639386177062988
Epoch: 17, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.447 Vali Acc: 0.915 Test Loss: 0.447 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 18 cost time: 0.5516600608825684
Epoch: 18, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.407 Vali Acc: 0.930 Test Loss: 0.407 Test Acc: 0.930
Validation loss decreased (-0.914810 --> -0.929626).  Saving model ...
Epoch: 19 cost time: 0.5976848602294922
Epoch: 19, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.372 Vali Acc: 0.926 Test Loss: 0.372 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5467379093170166
Epoch: 20, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.341 Vali Acc: 0.930 Test Loss: 0.341 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 21 cost time: 0.5255968570709229
Epoch: 21, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.316 Vali Acc: 0.937 Test Loss: 0.316 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 0.6340956687927246
Epoch: 22, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 23 cost time: 0.5284080505371094
Epoch: 23, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4705080986022949
Epoch: 24, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6002750396728516
Epoch: 25, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5934021472930908
Epoch: 26, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.6031143665313721
Epoch: 27, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.7304883003234863
Epoch: 28, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.6583676338195801
Epoch: 29, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6932389736175537
Epoch: 30, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.6368608474731445
Epoch: 31, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.6109724044799805
Epoch: 32, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.6652333736419678
Epoch: 33, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.7387661933898926
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.5639247894287109
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.5930101871490479
Epoch: 36, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.5709569454193115
Epoch: 37, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 38 cost time: 0.5972640514373779
Epoch: 38, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 39 cost time: 0.513256311416626
Epoch: 39, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 40 cost time: 0.6262290477752686
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 41 cost time: 0.7615742683410645
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 42 cost time: 0.5907731056213379
Epoch: 42, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 43 cost time: 0.5855109691619873
Epoch: 43, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.7976574897766113
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.6014754772186279
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 46 cost time: 0.6403918266296387
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 47 cost time: 0.6729841232299805
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 48 cost time: 0.7097091674804688
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 49 cost time: 0.6246333122253418
Epoch: 49, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 50 cost time: 0.5873351097106934
Epoch: 50, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 51 cost time: 0.748445987701416
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 52 cost time: 0.6807942390441895
Epoch: 52, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 53 cost time: 0.6311216354370117
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 54 cost time: 0.5830461978912354
Epoch: 54, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 55 cost time: 0.563227653503418
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 56 cost time: 0.5959389209747314
Epoch: 56, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 57 cost time: 0.5641264915466309
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 58 cost time: 0.573108434677124
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5889902114868164
Epoch: 59, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9214015007019043
Epoch: 60, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.6915700435638428
Epoch: 61, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.659834623336792
Epoch: 62, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.5486705303192139
Epoch: 63, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.5544238090515137
Epoch: 64, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.7118303775787354
Epoch: 65, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.5587937831878662
Epoch: 66, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.6236062049865723
Epoch: 67, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 125126
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.315727472305298
Epoch: 1, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.950 Vali Acc: 0.167 Test Loss: 1.950 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.6737630367279053
Epoch: 2, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.862 Vali Acc: 0.181 Test Loss: 1.862 Test Acc: 0.181
Validation loss decreased (-0.166647 --> -0.181463).  Saving model ...
Epoch: 3 cost time: 0.5961980819702148
Epoch: 3, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.789 Vali Acc: 0.185 Test Loss: 1.789 Test Acc: 0.185
Validation loss decreased (-0.181463 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 0.5448150634765625
Epoch: 4, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.708 Vali Acc: 0.215 Test Loss: 1.708 Test Acc: 0.215
Validation loss decreased (-0.185167 --> -0.214798).  Saving model ...
Epoch: 5 cost time: 0.5538110733032227
Epoch: 5, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.613 Vali Acc: 0.248 Test Loss: 1.613 Test Acc: 0.248
Validation loss decreased (-0.214798 --> -0.248132).  Saving model ...
Epoch: 6 cost time: 0.5088984966278076
Epoch: 6, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.506 Vali Acc: 0.326 Test Loss: 1.506 Test Acc: 0.326
Validation loss decreased (-0.248132 --> -0.325911).  Saving model ...
Epoch: 7 cost time: 0.6679675579071045
Epoch: 7, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.394 Vali Acc: 0.459 Test Loss: 1.394 Test Acc: 0.459
Validation loss decreased (-0.325911 --> -0.459245).  Saving model ...
Epoch: 8 cost time: 0.6468887329101562
Epoch: 8, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.279 Vali Acc: 0.615 Test Loss: 1.279 Test Acc: 0.615
Validation loss decreased (-0.459245 --> -0.614802).  Saving model ...
Epoch: 9 cost time: 0.6529660224914551
Epoch: 9, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.164 Vali Acc: 0.707 Test Loss: 1.164 Test Acc: 0.707
Validation loss decreased (-0.614802 --> -0.707396).  Saving model ...
Epoch: 10 cost time: 0.6482391357421875
Epoch: 10, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.052 Vali Acc: 0.767 Test Loss: 1.052 Test Acc: 0.767
Validation loss decreased (-0.707396 --> -0.766656).  Saving model ...
Epoch: 11 cost time: 0.641249418258667
Epoch: 11, Steps: 2 | Train Loss: 0.992 Vali Loss: 0.948 Vali Acc: 0.811 Test Loss: 0.948 Test Acc: 0.811
Validation loss decreased (-0.766656 --> -0.811102).  Saving model ...
Epoch: 12 cost time: 0.6617770195007324
Epoch: 12, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.851 Vali Acc: 0.837 Test Loss: 0.851 Test Acc: 0.837
Validation loss decreased (-0.811102 --> -0.837029).  Saving model ...
Epoch: 13 cost time: 0.5913581848144531
Epoch: 13, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.763 Vali Acc: 0.874 Test Loss: 0.763 Test Acc: 0.874
Validation loss decreased (-0.837029 --> -0.874066).  Saving model ...
Epoch: 14 cost time: 0.6256158351898193
Epoch: 14, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.686 Vali Acc: 0.878 Test Loss: 0.686 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877771).  Saving model ...
Epoch: 15 cost time: 0.6047506332397461
Epoch: 15, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.617 Vali Acc: 0.893 Test Loss: 0.617 Test Acc: 0.893
Validation loss decreased (-0.877771 --> -0.892586).  Saving model ...
Epoch: 16 cost time: 0.6164696216583252
Epoch: 16, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.559 Vali Acc: 0.911 Test Loss: 0.559 Test Acc: 0.911
Validation loss decreased (-0.892586 --> -0.911106).  Saving model ...
Epoch: 17 cost time: 0.6526799201965332
Epoch: 17, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.507 Vali Acc: 0.911 Test Loss: 0.507 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 0.7335977554321289
Epoch: 18, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.462 Vali Acc: 0.915 Test Loss: 0.462 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 19 cost time: 0.5642139911651611
Epoch: 19, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.423 Vali Acc: 0.915 Test Loss: 0.423 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 0.5496823787689209
Epoch: 20, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.387 Vali Acc: 0.922 Test Loss: 0.387 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922218).  Saving model ...
Epoch: 21 cost time: 0.6353809833526611
Epoch: 21, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 22 cost time: 0.5747222900390625
Epoch: 22, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940737).  Saving model ...
Epoch: 23 cost time: 0.562077522277832
Epoch: 23, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.300 Vali Acc: 0.941 Test Loss: 0.300 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 24 cost time: 0.7687788009643555
Epoch: 24, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5596122741699219
Epoch: 25, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5186097621917725
Epoch: 26, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6157875061035156
Epoch: 27, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 28 cost time: 0.5920898914337158
Epoch: 28, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.570497989654541
Epoch: 29, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.6556706428527832
Epoch: 30, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.5761375427246094
Epoch: 31, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7254459857940674
Epoch: 32, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6281766891479492
Epoch: 33, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5148224830627441
Epoch: 34, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5863258838653564
Epoch: 35, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6431844234466553
Epoch: 36, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5517845153808594
Epoch: 37, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6897671222686768
Epoch: 38, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5470714569091797
Epoch: 39, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5888321399688721
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 120710
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.306960105895996
Epoch: 1, Steps: 2 | Train Loss: 2.334 Vali Loss: 2.073 Vali Acc: 0.056 Test Loss: 2.073 Test Acc: 0.056
Validation loss decreased (inf --> -0.055535).  Saving model ...
Epoch: 2 cost time: 0.5650162696838379
Epoch: 2, Steps: 2 | Train Loss: 2.205 Vali Loss: 2.016 Vali Acc: 0.067 Test Loss: 2.016 Test Acc: 0.067
Validation loss decreased (-0.055535 --> -0.066647).  Saving model ...
Epoch: 3 cost time: 0.5376377105712891
Epoch: 3, Steps: 2 | Train Loss: 2.066 Vali Loss: 1.970 Vali Acc: 0.067 Test Loss: 1.970 Test Acc: 0.067
Validation loss decreased (-0.066647 --> -0.066647).  Saving model ...
Epoch: 4 cost time: 0.6143600940704346
Epoch: 4, Steps: 2 | Train Loss: 1.986 Vali Loss: 1.918 Vali Acc: 0.096 Test Loss: 1.918 Test Acc: 0.096
Validation loss decreased (-0.066647 --> -0.096277).  Saving model ...
Epoch: 5 cost time: 0.4671802520751953
Epoch: 5, Steps: 2 | Train Loss: 2.006 Vali Loss: 1.849 Vali Acc: 0.126 Test Loss: 1.849 Test Acc: 0.126
Validation loss decreased (-0.096277 --> -0.125907).  Saving model ...
Epoch: 6 cost time: 0.47910070419311523
Epoch: 6, Steps: 2 | Train Loss: 1.955 Vali Loss: 1.768 Vali Acc: 0.148 Test Loss: 1.768 Test Acc: 0.148
Validation loss decreased (-0.125907 --> -0.148130).  Saving model ...
Epoch: 7 cost time: 0.6492021083831787
Epoch: 7, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.676 Vali Acc: 0.233 Test Loss: 1.676 Test Acc: 0.233
Validation loss decreased (-0.148130 --> -0.233317).  Saving model ...
Epoch: 8 cost time: 0.6059515476226807
Epoch: 8, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.578 Vali Acc: 0.381 Test Loss: 1.578 Test Acc: 0.381
Validation loss decreased (-0.233317 --> -0.381466).  Saving model ...
Epoch: 9 cost time: 0.5461795330047607
Epoch: 9, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.475 Vali Acc: 0.530 Test Loss: 1.475 Test Acc: 0.530
Validation loss decreased (-0.381466 --> -0.529615).  Saving model ...
Epoch: 10 cost time: 0.6250228881835938
Epoch: 10, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.370 Vali Acc: 0.633 Test Loss: 1.370 Test Acc: 0.633
Validation loss decreased (-0.529615 --> -0.633320).  Saving model ...
Epoch: 11 cost time: 0.6776165962219238
Epoch: 11, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.265 Vali Acc: 0.704 Test Loss: 1.265 Test Acc: 0.704
Validation loss decreased (-0.633320 --> -0.703691).  Saving model ...
Epoch: 12 cost time: 0.5684418678283691
Epoch: 12, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.162 Vali Acc: 0.726 Test Loss: 1.162 Test Acc: 0.726
Validation loss decreased (-0.703691 --> -0.725914).  Saving model ...
Epoch: 13 cost time: 0.6376364231109619
Epoch: 13, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.064 Vali Acc: 0.756 Test Loss: 1.064 Test Acc: 0.756
Validation loss decreased (-0.725914 --> -0.755545).  Saving model ...
Epoch: 14 cost time: 0.6673533916473389
Epoch: 14, Steps: 2 | Train Loss: 1.087 Vali Loss: 0.972 Vali Acc: 0.781 Test Loss: 0.972 Test Acc: 0.781
Validation loss decreased (-0.755545 --> -0.781472).  Saving model ...
Epoch: 15 cost time: 0.5991806983947754
Epoch: 15, Steps: 2 | Train Loss: 0.968 Vali Loss: 0.886 Vali Acc: 0.800 Test Loss: 0.886 Test Acc: 0.800
Validation loss decreased (-0.781472 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 0.5418930053710938
Epoch: 16, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.809 Vali Acc: 0.830 Test Loss: 0.809 Test Acc: 0.830
Validation loss decreased (-0.799991 --> -0.829622).  Saving model ...
Epoch: 17 cost time: 0.6199233531951904
Epoch: 17, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.739 Vali Acc: 0.848 Test Loss: 0.739 Test Acc: 0.848
Validation loss decreased (-0.829622 --> -0.848141).  Saving model ...
Epoch: 18 cost time: 0.5832822322845459
Epoch: 18, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.677 Vali Acc: 0.867 Test Loss: 0.677 Test Acc: 0.867
Validation loss decreased (-0.848141 --> -0.866660).  Saving model ...
Epoch: 19 cost time: 0.5422725677490234
Epoch: 19, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.620 Vali Acc: 0.878 Test Loss: 0.620 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 20 cost time: 0.6014938354492188
Epoch: 20, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.569 Vali Acc: 0.893 Test Loss: 0.569 Test Acc: 0.893
Validation loss decreased (-0.877772 --> -0.892587).  Saving model ...
Epoch: 21 cost time: 0.5459752082824707
Epoch: 21, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.525 Vali Acc: 0.896 Test Loss: 0.525 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 22 cost time: 0.6294898986816406
Epoch: 22, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.488 Vali Acc: 0.893 Test Loss: 0.488 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5712840557098389
Epoch: 23, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.454 Vali Acc: 0.896 Test Loss: 0.454 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 24 cost time: 0.6250219345092773
Epoch: 24, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.427 Vali Acc: 0.889 Test Loss: 0.427 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5617475509643555
Epoch: 25, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.401 Vali Acc: 0.893 Test Loss: 0.401 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5828759670257568
Epoch: 26, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.379 Vali Acc: 0.896 Test Loss: 0.379 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896293).  Saving model ...
Epoch: 27 cost time: 0.6057631969451904
Epoch: 27, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.359 Vali Acc: 0.893 Test Loss: 0.359 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5852847099304199
Epoch: 28, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 0.6031894683837891
Epoch: 29, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 0.5132379531860352
Epoch: 30, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 0.53839111328125
Epoch: 31, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.292 Vali Acc: 0.904 Test Loss: 0.292 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903701).  Saving model ...
Epoch: 32 cost time: 0.6152245998382568
Epoch: 32, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.281 Vali Acc: 0.907 Test Loss: 0.281 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 33 cost time: 0.6458766460418701
Epoch: 33, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.270 Vali Acc: 0.907 Test Loss: 0.270 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 34 cost time: 0.5114924907684326
Epoch: 34, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911109).  Saving model ...
Epoch: 35 cost time: 0.5753278732299805
Epoch: 35, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 36 cost time: 0.5182931423187256
Epoch: 36, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.5630605220794678
Epoch: 37, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.6512658596038818
Epoch: 38, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.6102380752563477
Epoch: 39, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.6277034282684326
Epoch: 40, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.5945029258728027
Epoch: 41, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5343043804168701
Epoch: 42, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.57637619972229
Epoch: 43, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5768280029296875
Epoch: 44, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.531602144241333
Epoch: 45, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6549935340881348
Epoch: 46, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7044055461883545
Epoch: 47, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6026484966278076
Epoch: 48, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.656867504119873
Epoch: 49, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.561652660369873
Epoch: 50, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 114758
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.277933359146118
Epoch: 1, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.770 Vali Acc: 0.248 Test Loss: 1.770 Test Acc: 0.248
Validation loss decreased (inf --> -0.248130).  Saving model ...
Epoch: 2 cost time: 0.6266791820526123
Epoch: 2, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.716 Vali Acc: 0.281 Test Loss: 1.716 Test Acc: 0.281
Validation loss decreased (-0.248130 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 0.6570611000061035
Epoch: 3, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.672 Vali Acc: 0.319 Test Loss: 1.672 Test Acc: 0.319
Validation loss decreased (-0.281464 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.6412539482116699
Epoch: 4, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.626 Vali Acc: 0.385 Test Loss: 1.626 Test Acc: 0.385
Validation loss decreased (-0.318502 --> -0.385169).  Saving model ...
Epoch: 5 cost time: 0.5604448318481445
Epoch: 5, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.571 Vali Acc: 0.441 Test Loss: 1.571 Test Acc: 0.441
Validation loss decreased (-0.385169 --> -0.440725).  Saving model ...
Epoch: 6 cost time: 0.5410103797912598
Epoch: 6, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.507 Vali Acc: 0.485 Test Loss: 1.507 Test Acc: 0.485
Validation loss decreased (-0.440725 --> -0.485170).  Saving model ...
Epoch: 7 cost time: 0.6000843048095703
Epoch: 7, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.439 Vali Acc: 0.541 Test Loss: 1.439 Test Acc: 0.541
Validation loss decreased (-0.485170 --> -0.540726).  Saving model ...
Epoch: 8 cost time: 0.5567481517791748
Epoch: 8, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.366 Vali Acc: 0.615 Test Loss: 1.366 Test Acc: 0.615
Validation loss decreased (-0.540726 --> -0.614801).  Saving model ...
Epoch: 9 cost time: 0.6616153717041016
Epoch: 9, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.290 Vali Acc: 0.656 Test Loss: 1.290 Test Acc: 0.656
Validation loss decreased (-0.614801 --> -0.655543).  Saving model ...
Epoch: 10 cost time: 0.6022818088531494
Epoch: 10, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.213 Vali Acc: 0.707 Test Loss: 1.213 Test Acc: 0.707
Validation loss decreased (-0.655543 --> -0.707395).  Saving model ...
Epoch: 11 cost time: 0.5853381156921387
Epoch: 11, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.137 Vali Acc: 0.741 Test Loss: 1.137 Test Acc: 0.741
Validation loss decreased (-0.707395 --> -0.740729).  Saving model ...
Epoch: 12 cost time: 0.5814831256866455
Epoch: 12, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.062 Vali Acc: 0.763 Test Loss: 1.062 Test Acc: 0.763
Validation loss decreased (-0.740729 --> -0.762952).  Saving model ...
Epoch: 13 cost time: 0.6473770141601562
Epoch: 13, Steps: 2 | Train Loss: 1.088 Vali Loss: 0.990 Vali Acc: 0.789 Test Loss: 0.990 Test Acc: 0.789
Validation loss decreased (-0.762952 --> -0.788879).  Saving model ...
Epoch: 14 cost time: 0.5784449577331543
Epoch: 14, Steps: 2 | Train Loss: 0.941 Vali Loss: 0.921 Vali Acc: 0.811 Test Loss: 0.921 Test Acc: 0.811
Validation loss decreased (-0.788879 --> -0.811102).  Saving model ...
Epoch: 15 cost time: 0.5445570945739746
Epoch: 15, Steps: 2 | Train Loss: 0.942 Vali Loss: 0.855 Vali Acc: 0.844 Test Loss: 0.855 Test Acc: 0.844
Validation loss decreased (-0.811102 --> -0.844436).  Saving model ...
Epoch: 16 cost time: 0.5292634963989258
Epoch: 16, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.793 Vali Acc: 0.848 Test Loss: 0.793 Test Acc: 0.848
Validation loss decreased (-0.844436 --> -0.848140).  Saving model ...
Epoch: 17 cost time: 0.5660793781280518
Epoch: 17, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.734 Vali Acc: 0.867 Test Loss: 0.734 Test Acc: 0.867
Validation loss decreased (-0.848140 --> -0.866659).  Saving model ...
Epoch: 18 cost time: 0.5697269439697266
Epoch: 18, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.679 Vali Acc: 0.885 Test Loss: 0.679 Test Acc: 0.885
Validation loss decreased (-0.866659 --> -0.885178).  Saving model ...
Epoch: 19 cost time: 0.570244312286377
Epoch: 19, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.628 Vali Acc: 0.911 Test Loss: 0.628 Test Acc: 0.911
Validation loss decreased (-0.885178 --> -0.911105).  Saving model ...
Epoch: 20 cost time: 0.6067047119140625
Epoch: 20, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.582 Vali Acc: 0.930 Test Loss: 0.582 Test Acc: 0.930
Validation loss decreased (-0.911105 --> -0.929624).  Saving model ...
Epoch: 21 cost time: 0.551520586013794
Epoch: 21, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.540 Vali Acc: 0.933 Test Loss: 0.540 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 22 cost time: 0.5449249744415283
Epoch: 22, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.501 Vali Acc: 0.941 Test Loss: 0.501 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 23 cost time: 0.5861914157867432
Epoch: 23, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.465 Vali Acc: 0.937 Test Loss: 0.465 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5824127197265625
Epoch: 24, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.434 Vali Acc: 0.941 Test Loss: 0.434 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 25 cost time: 0.5941727161407471
Epoch: 25, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.406 Vali Acc: 0.933 Test Loss: 0.406 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5594625473022461
Epoch: 26, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.380 Vali Acc: 0.941 Test Loss: 0.380 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 27 cost time: 0.6582646369934082
Epoch: 27, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.359 Vali Acc: 0.948 Test Loss: 0.359 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 28 cost time: 0.623110294342041
Epoch: 28, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.340 Vali Acc: 0.948 Test Loss: 0.340 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 29 cost time: 0.6189486980438232
Epoch: 29, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.324 Vali Acc: 0.952 Test Loss: 0.324 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 30 cost time: 0.5856716632843018
Epoch: 30, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.309 Vali Acc: 0.952 Test Loss: 0.309 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 31 cost time: 0.648754358291626
Epoch: 31, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.297 Vali Acc: 0.956 Test Loss: 0.297 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 32 cost time: 0.6117711067199707
Epoch: 32, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.287 Vali Acc: 0.952 Test Loss: 0.287 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6452345848083496
Epoch: 33, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.277 Vali Acc: 0.952 Test Loss: 0.277 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5619981288909912
Epoch: 34, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.268 Vali Acc: 0.952 Test Loss: 0.268 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5857748985290527
Epoch: 35, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.260 Vali Acc: 0.952 Test Loss: 0.260 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5898206233978271
Epoch: 36, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.253 Vali Acc: 0.952 Test Loss: 0.253 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5094301700592041
Epoch: 37, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.246 Vali Acc: 0.952 Test Loss: 0.246 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5694601535797119
Epoch: 38, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 39 cost time: 0.6236324310302734
Epoch: 39, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.234 Vali Acc: 0.956 Test Loss: 0.234 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 40 cost time: 0.568824291229248
Epoch: 40, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.229 Vali Acc: 0.956 Test Loss: 0.229 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 41 cost time: 0.602553129196167
Epoch: 41, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.225 Vali Acc: 0.956 Test Loss: 0.225 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 42 cost time: 0.6528401374816895
Epoch: 42, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.221 Vali Acc: 0.956 Test Loss: 0.221 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.6047465801239014
Epoch: 43, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 44 cost time: 0.6437249183654785
Epoch: 44, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6529073715209961
Epoch: 45, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6628158092498779
Epoch: 46, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6280303001403809
Epoch: 47, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.209 Vali Acc: 0.956 Test Loss: 0.209 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5831027030944824
Epoch: 48, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6563377380371094
Epoch: 49, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7892084121704102
Epoch: 50, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 51 cost time: 0.6095170974731445
Epoch: 51, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6100022792816162
Epoch: 52, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 53 cost time: 0.6317803859710693
Epoch: 53, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 54 cost time: 0.5845236778259277
Epoch: 54, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6578769683837891
Epoch: 55, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5505518913269043
Epoch: 56, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5073821544647217
Epoch: 57, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.5463230609893799
Epoch: 58, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5927364826202393
Epoch: 59, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.4865274429321289
Epoch: 60, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.5477962493896484
Epoch: 61, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 62 cost time: 0.589012622833252
Epoch: 62, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 63 cost time: 0.5556886196136475
Epoch: 63, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 64 cost time: 0.5990874767303467
Epoch: 64, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6562695503234863
Epoch: 65, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.5513522624969482
Epoch: 66, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.5869302749633789
Epoch: 67, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.5524656772613525
Epoch: 68, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.6357545852661133
Epoch: 69, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.6614480018615723
Epoch: 70, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.5821609497070312
Epoch: 71, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.6230988502502441
Epoch: 72, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.6488406658172607
Epoch: 73, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 74 cost time: 0.5465373992919922
Epoch: 74, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 75 cost time: 0.48076510429382324
Epoch: 75, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 76 cost time: 0.52876877784729
Epoch: 76, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 77 cost time: 0.5723831653594971
Epoch: 77, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 78 cost time: 0.5499138832092285
Epoch: 78, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959258).  Saving model ...
Epoch: 79 cost time: 0.5615518093109131
Epoch: 79, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 80 cost time: 0.6219303607940674
Epoch: 80, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 81 cost time: 0.6247663497924805
Epoch: 81, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 82 cost time: 0.5589525699615479
Epoch: 82, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 83 cost time: 0.5667219161987305
Epoch: 83, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6157593727111816
Epoch: 84, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.5522198677062988
Epoch: 85, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.5779023170471191
Epoch: 86, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.624755859375
Epoch: 87, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 88 cost time: 0.6186232566833496
Epoch: 88, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.6908950805664062
Epoch: 89, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.6904447078704834
Epoch: 90, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 91 cost time: 0.5742473602294922
Epoch: 91, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 92 cost time: 0.6776785850524902
Epoch: 92, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 93 cost time: 0.6121492385864258
Epoch: 93, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 94 cost time: 0.6428072452545166
Epoch: 94, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 95 cost time: 0.6697571277618408
Epoch: 95, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 96 cost time: 0.5898160934448242
Epoch: 96, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 97 cost time: 0.6371090412139893
Epoch: 97, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 98 cost time: 0.6235296726226807
Epoch: 98, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 99 cost time: 0.49567079544067383
Epoch: 99, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 100 cost time: 0.5497739315032959
Epoch: 100, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 111942
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.733304262161255
Epoch: 1, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.699 Vali Acc: 0.185 Test Loss: 1.699 Test Acc: 0.185
Validation loss decreased (inf --> -0.185168).  Saving model ...
Epoch: 2 cost time: 0.6153936386108398
Epoch: 2, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.583 Vali Acc: 0.393 Test Loss: 1.583 Test Acc: 0.393
Validation loss decreased (-0.185168 --> -0.392577).  Saving model ...
Epoch: 3 cost time: 0.6986174583435059
Epoch: 3, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.443 Vali Acc: 0.567 Test Loss: 1.443 Test Acc: 0.567
Validation loss decreased (-0.392577 --> -0.566652).  Saving model ...
Epoch: 4 cost time: 0.7624022960662842
Epoch: 4, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.236 Vali Acc: 0.648 Test Loss: 1.236 Test Acc: 0.648
Validation loss decreased (-0.566652 --> -0.648136).  Saving model ...
Epoch: 5 cost time: 0.7514443397521973
Epoch: 5, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.019 Vali Acc: 0.726 Test Loss: 1.019 Test Acc: 0.726
Validation loss decreased (-0.648136 --> -0.725916).  Saving model ...
Epoch: 6 cost time: 0.7392961978912354
Epoch: 6, Steps: 2 | Train Loss: 0.994 Vali Loss: 0.834 Vali Acc: 0.748 Test Loss: 0.834 Test Acc: 0.748
Validation loss decreased (-0.725916 --> -0.748140).  Saving model ...
Epoch: 7 cost time: 0.6173841953277588
Epoch: 7, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.669 Vali Acc: 0.833 Test Loss: 0.669 Test Acc: 0.833
Validation loss decreased (-0.748140 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 0.6269016265869141
Epoch: 8, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.533 Vali Acc: 0.893 Test Loss: 0.533 Test Acc: 0.893
Validation loss decreased (-0.833327 --> -0.892587).  Saving model ...
Epoch: 9 cost time: 0.6241335868835449
Epoch: 9, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.420 Vali Acc: 0.933 Test Loss: 0.420 Test Acc: 0.933
Validation loss decreased (-0.892587 --> -0.933329).  Saving model ...
Epoch: 10 cost time: 0.6491215229034424
Epoch: 10, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.343 Vali Acc: 0.948 Test Loss: 0.343 Test Acc: 0.948
Validation loss decreased (-0.933329 --> -0.948145).  Saving model ...
Epoch: 11 cost time: 0.594313383102417
Epoch: 11, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.289 Vali Acc: 0.948 Test Loss: 0.289 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 12 cost time: 0.7046267986297607
Epoch: 12, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 13 cost time: 0.687995195388794
Epoch: 13, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8145782947540283
Epoch: 14, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6426992416381836
Epoch: 15, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6764769554138184
Epoch: 16, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7640612125396729
Epoch: 17, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.948 Test Loss: 0.158 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7199246883392334
Epoch: 18, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.952 Test Loss: 0.150 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 19 cost time: 0.7018566131591797
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.952 Test Loss: 0.146 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 20 cost time: 0.5507209300994873
Epoch: 20, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.145 Vali Acc: 0.944 Test Loss: 0.145 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6205494403839111
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.944 Test Loss: 0.146 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.615687370300293
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.941 Test Loss: 0.150 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.601524829864502
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.941 Test Loss: 0.156 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6770317554473877
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.937 Test Loss: 0.163 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7111752033233643
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6922166347503662
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7141525745391846
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.127058982849121
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6999485492706299
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 167046
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.336367130279541
Epoch: 1, Steps: 2 | Train Loss: 1.936 Vali Loss: 1.922 Vali Acc: 0.074 Test Loss: 1.922 Test Acc: 0.074
Validation loss decreased (inf --> -0.074055).  Saving model ...
Epoch: 2 cost time: 0.6536040306091309
Epoch: 2, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.821 Vali Acc: 0.156 Test Loss: 1.821 Test Acc: 0.156
Validation loss decreased (-0.074055 --> -0.155537).  Saving model ...
Epoch: 3 cost time: 0.7257487773895264
Epoch: 3, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.723 Vali Acc: 0.230 Test Loss: 1.723 Test Acc: 0.230
Validation loss decreased (-0.155537 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.6510167121887207
Epoch: 4, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.587 Vali Acc: 0.330 Test Loss: 1.587 Test Acc: 0.330
Validation loss decreased (-0.229612 --> -0.329614).  Saving model ...
Epoch: 5 cost time: 0.6610064506530762
Epoch: 5, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.425 Vali Acc: 0.522 Test Loss: 1.425 Test Acc: 0.522
Validation loss decreased (-0.329614 --> -0.522208).  Saving model ...
Epoch: 6 cost time: 0.7019858360290527
Epoch: 6, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.252 Vali Acc: 0.648 Test Loss: 1.252 Test Acc: 0.648
Validation loss decreased (-0.522208 --> -0.648136).  Saving model ...
Epoch: 7 cost time: 0.6286699771881104
Epoch: 7, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.082 Vali Acc: 0.722 Test Loss: 1.082 Test Acc: 0.722
Validation loss decreased (-0.648136 --> -0.722211).  Saving model ...
Epoch: 8 cost time: 0.5584771633148193
Epoch: 8, Steps: 2 | Train Loss: 0.901 Vali Loss: 0.929 Vali Acc: 0.804 Test Loss: 0.929 Test Acc: 0.804
Validation loss decreased (-0.722211 --> -0.803694).  Saving model ...
Epoch: 9 cost time: 0.6774322986602783
Epoch: 9, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.794 Vali Acc: 0.830 Test Loss: 0.794 Test Acc: 0.830
Validation loss decreased (-0.803694 --> -0.829622).  Saving model ...
Epoch: 10 cost time: 0.6085803508758545
Epoch: 10, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.676 Vali Acc: 0.863 Test Loss: 0.676 Test Acc: 0.863
Validation loss decreased (-0.829622 --> -0.862956).  Saving model ...
Epoch: 11 cost time: 0.9600429534912109
Epoch: 11, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.576 Vali Acc: 0.893 Test Loss: 0.576 Test Acc: 0.893
Validation loss decreased (-0.862956 --> -0.892587).  Saving model ...
Epoch: 12 cost time: 0.7914164066314697
Epoch: 12, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.493 Vali Acc: 0.915 Test Loss: 0.493 Test Acc: 0.915
Validation loss decreased (-0.892587 --> -0.914810).  Saving model ...
Epoch: 13 cost time: 0.8562521934509277
Epoch: 13, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.429 Vali Acc: 0.919 Test Loss: 0.429 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 14 cost time: 0.5802876949310303
Epoch: 14, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.372 Vali Acc: 0.944 Test Loss: 0.372 Test Acc: 0.944
Validation loss decreased (-0.918514 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.704749345779419
Epoch: 15, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.328 Vali Acc: 0.944 Test Loss: 0.328 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.6307857036590576
Epoch: 16, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.6636950969696045
Epoch: 17, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.790900468826294
Epoch: 18, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6888072490692139
Epoch: 19, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.718956470489502
Epoch: 20, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7054347991943359
Epoch: 21, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.6437556743621826
Epoch: 22, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8126025199890137
Epoch: 23, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6437258720397949
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.7547585964202881
Epoch: 25, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.625530481338501
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7097713947296143
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5929150581359863
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.732428789138794
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5551164150238037
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6843650341033936
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7496793270111084
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6321547031402588
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.6492655277252197
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.7421886920928955
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6872260570526123
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7694039344787598
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.6474971771240234
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.6596574783325195
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.7499361038208008
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.6816864013671875
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.7052805423736572
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6768677234649658
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7679543495178223
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7674620151519775
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6217145919799805
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5648801326751709
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.5748064517974854
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.587827205657959
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.689645528793335
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.6975250244140625
Epoch: 51, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 116486
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2604432106018066
Epoch: 1, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.745 Vali Acc: 0.322 Test Loss: 1.745 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 0.6288361549377441
Epoch: 2, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.655 Vali Acc: 0.344 Test Loss: 1.655 Test Acc: 0.344
Validation loss decreased (-0.322205 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 0.5230793952941895
Epoch: 3, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.570 Vali Acc: 0.378 Test Loss: 1.570 Test Acc: 0.378
Validation loss decreased (-0.344428 --> -0.377762).  Saving model ...
Epoch: 4 cost time: 0.5752542018890381
Epoch: 4, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.468 Vali Acc: 0.478 Test Loss: 1.468 Test Acc: 0.478
Validation loss decreased (-0.377762 --> -0.477763).  Saving model ...
Epoch: 5 cost time: 0.57832932472229
Epoch: 5, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.350 Vali Acc: 0.556 Test Loss: 1.350 Test Acc: 0.556
Validation loss decreased (-0.477763 --> -0.555542).  Saving model ...
Epoch: 6 cost time: 0.5534870624542236
Epoch: 6, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.223 Vali Acc: 0.652 Test Loss: 1.223 Test Acc: 0.652
Validation loss decreased (-0.555542 --> -0.651840).  Saving model ...
Epoch: 7 cost time: 0.5388972759246826
Epoch: 7, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.097 Vali Acc: 0.741 Test Loss: 1.097 Test Acc: 0.741
Validation loss decreased (-0.651840 --> -0.740730).  Saving model ...
Epoch: 8 cost time: 0.5758593082427979
Epoch: 8, Steps: 2 | Train Loss: 0.938 Vali Loss: 0.976 Vali Acc: 0.781 Test Loss: 0.976 Test Acc: 0.781
Validation loss decreased (-0.740730 --> -0.781472).  Saving model ...
Epoch: 9 cost time: 0.6955769062042236
Epoch: 9, Steps: 2 | Train Loss: 0.910 Vali Loss: 0.866 Vali Acc: 0.833 Test Loss: 0.866 Test Acc: 0.833
Validation loss decreased (-0.781472 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 0.6627249717712402
Epoch: 10, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.764 Vali Acc: 0.856 Test Loss: 0.764 Test Acc: 0.856
Validation loss decreased (-0.833325 --> -0.855548).  Saving model ...
Epoch: 11 cost time: 0.7842864990234375
Epoch: 11, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.674 Vali Acc: 0.870 Test Loss: 0.674 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870364).  Saving model ...
Epoch: 12 cost time: 0.7836217880249023
Epoch: 12, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.598 Vali Acc: 0.900 Test Loss: 0.598 Test Acc: 0.900
Validation loss decreased (-0.870364 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.716710090637207
Epoch: 13, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 0.7466332912445068
Epoch: 14, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.478 Vali Acc: 0.911 Test Loss: 0.478 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911106).  Saving model ...
Epoch: 15 cost time: 0.7439417839050293
Epoch: 15, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.430 Vali Acc: 0.911 Test Loss: 0.430 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 16 cost time: 0.6481056213378906
Epoch: 16, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.388 Vali Acc: 0.919 Test Loss: 0.388 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 17 cost time: 0.7335281372070312
Epoch: 17, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.354 Vali Acc: 0.919 Test Loss: 0.354 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 18 cost time: 0.5820953845977783
Epoch: 18, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 19 cost time: 0.5537135601043701
Epoch: 19, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.293 Vali Acc: 0.933 Test Loss: 0.293 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933330).  Saving model ...
Epoch: 20 cost time: 0.655909538269043
Epoch: 20, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.632392406463623
Epoch: 21, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.250 Vali Acc: 0.948 Test Loss: 0.250 Test Acc: 0.948
Validation loss decreased (-0.933331 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.6134436130523682
Epoch: 22, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.6524257659912109
Epoch: 23, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6893050670623779
Epoch: 24, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7659063339233398
Epoch: 25, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5931987762451172
Epoch: 26, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6046490669250488
Epoch: 27, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6165943145751953
Epoch: 28, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6223545074462891
Epoch: 29, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6552093029022217
Epoch: 30, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6254045963287354
Epoch: 31, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6054036617279053
Epoch: 32, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 101190
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1865108013153076
Epoch: 1, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.681 Vali Acc: 0.226 Test Loss: 1.681 Test Acc: 0.226
Validation loss decreased (inf --> -0.225909).  Saving model ...
Epoch: 2 cost time: 0.6343486309051514
Epoch: 2, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.612 Vali Acc: 0.311 Test Loss: 1.612 Test Acc: 0.311
Validation loss decreased (-0.225909 --> -0.311095).  Saving model ...
Epoch: 3 cost time: 0.5731594562530518
Epoch: 3, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.552 Vali Acc: 0.411 Test Loss: 1.552 Test Acc: 0.411
Validation loss decreased (-0.311095 --> -0.411096).  Saving model ...
Epoch: 4 cost time: 0.5857419967651367
Epoch: 4, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.479 Vali Acc: 0.544 Test Loss: 1.479 Test Acc: 0.544
Validation loss decreased (-0.411096 --> -0.544430).  Saving model ...
Epoch: 5 cost time: 0.6624956130981445
Epoch: 5, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.390 Vali Acc: 0.641 Test Loss: 1.390 Test Acc: 0.641
Validation loss decreased (-0.544430 --> -0.640727).  Saving model ...
Epoch: 6 cost time: 0.4931066036224365
Epoch: 6, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.288 Vali Acc: 0.722 Test Loss: 1.288 Test Acc: 0.722
Validation loss decreased (-0.640727 --> -0.722209).  Saving model ...
Epoch: 7 cost time: 0.6401941776275635
Epoch: 7, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.180 Vali Acc: 0.789 Test Loss: 1.180 Test Acc: 0.789
Validation loss decreased (-0.722209 --> -0.788877).  Saving model ...
Epoch: 8 cost time: 0.656487226486206
Epoch: 8, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.070 Vali Acc: 0.841 Test Loss: 1.070 Test Acc: 0.841
Validation loss decreased (-0.788877 --> -0.840730).  Saving model ...
Epoch: 9 cost time: 0.5174596309661865
Epoch: 9, Steps: 2 | Train Loss: 0.956 Vali Loss: 0.965 Vali Acc: 0.867 Test Loss: 0.965 Test Acc: 0.867
Validation loss decreased (-0.840730 --> -0.866657).  Saving model ...
Epoch: 10 cost time: 0.5860013961791992
Epoch: 10, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.865 Vali Acc: 0.896 Test Loss: 0.865 Test Acc: 0.896
Validation loss decreased (-0.866657 --> -0.896288).  Saving model ...
Epoch: 11 cost time: 0.5414719581604004
Epoch: 11, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.775 Vali Acc: 0.907 Test Loss: 0.775 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907400).  Saving model ...
Epoch: 12 cost time: 0.535855770111084
Epoch: 12, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.694 Vali Acc: 0.926 Test Loss: 0.694 Test Acc: 0.926
Validation loss decreased (-0.907400 --> -0.925919).  Saving model ...
Epoch: 13 cost time: 0.5507159233093262
Epoch: 13, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.621 Vali Acc: 0.930 Test Loss: 0.621 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929623).  Saving model ...
Epoch: 14 cost time: 0.5926792621612549
Epoch: 14, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.557 Vali Acc: 0.926 Test Loss: 0.557 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5557031631469727
Epoch: 15, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.503 Vali Acc: 0.933 Test Loss: 0.503 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933328).  Saving model ...
Epoch: 16 cost time: 0.5989656448364258
Epoch: 16, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.454 Vali Acc: 0.937 Test Loss: 0.454 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 17 cost time: 0.5726544857025146
Epoch: 17, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.412 Vali Acc: 0.933 Test Loss: 0.412 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5348639488220215
Epoch: 18, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.377 Vali Acc: 0.933 Test Loss: 0.377 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5383403301239014
Epoch: 19, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.347 Vali Acc: 0.933 Test Loss: 0.347 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5310699939727783
Epoch: 20, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.322 Vali Acc: 0.922 Test Loss: 0.322 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5071022510528564
Epoch: 21, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6913542747497559
Epoch: 22, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.286 Vali Acc: 0.919 Test Loss: 0.286 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6822950839996338
Epoch: 23, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6547219753265381
Epoch: 24, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5749263763427734
Epoch: 25, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5729060173034668
Epoch: 26, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 92102
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3758575916290283
Epoch: 1, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.887 Vali Acc: 0.207 Test Loss: 1.887 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 0.5843396186828613
Epoch: 2, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.822 Vali Acc: 0.237 Test Loss: 1.822 Test Acc: 0.237
Validation loss decreased (-0.207389 --> -0.237019).  Saving model ...
Epoch: 3 cost time: 0.6460616588592529
Epoch: 3, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.765 Vali Acc: 0.256 Test Loss: 1.765 Test Acc: 0.256
Validation loss decreased (-0.237019 --> -0.255538).  Saving model ...
Epoch: 4 cost time: 0.6281075477600098
Epoch: 4, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.698 Vali Acc: 0.281 Test Loss: 1.698 Test Acc: 0.281
Validation loss decreased (-0.255538 --> -0.281464).  Saving model ...
Epoch: 5 cost time: 0.568061113357544
Epoch: 5, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.615 Vali Acc: 0.344 Test Loss: 1.615 Test Acc: 0.344
Validation loss decreased (-0.281464 --> -0.344428).  Saving model ...
Epoch: 6 cost time: 0.5157833099365234
Epoch: 6, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.521 Vali Acc: 0.478 Test Loss: 1.521 Test Acc: 0.478
Validation loss decreased (-0.344428 --> -0.477763).  Saving model ...
Epoch: 7 cost time: 0.5735931396484375
Epoch: 7, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.419 Vali Acc: 0.559 Test Loss: 1.419 Test Acc: 0.559
Validation loss decreased (-0.477763 --> -0.559245).  Saving model ...
Epoch: 8 cost time: 0.5780339241027832
Epoch: 8, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.313 Vali Acc: 0.615 Test Loss: 1.313 Test Acc: 0.615
Validation loss decreased (-0.559245 --> -0.614802).  Saving model ...
Epoch: 9 cost time: 0.5889778137207031
Epoch: 9, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.206 Vali Acc: 0.641 Test Loss: 1.206 Test Acc: 0.641
Validation loss decreased (-0.614802 --> -0.640729).  Saving model ...
Epoch: 10 cost time: 0.4715883731842041
Epoch: 10, Steps: 2 | Train Loss: 0.982 Vali Loss: 1.102 Vali Acc: 0.696 Test Loss: 1.102 Test Acc: 0.696
Validation loss decreased (-0.640729 --> -0.696285).  Saving model ...
Epoch: 11 cost time: 0.5503387451171875
Epoch: 11, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.003 Vali Acc: 0.741 Test Loss: 1.003 Test Acc: 0.741
Validation loss decreased (-0.696285 --> -0.740731).  Saving model ...
Epoch: 12 cost time: 0.4651148319244385
Epoch: 12, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.911 Vali Acc: 0.770 Test Loss: 0.911 Test Acc: 0.770
Validation loss decreased (-0.740731 --> -0.770361).  Saving model ...
Epoch: 13 cost time: 0.5279586315155029
Epoch: 13, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.825 Vali Acc: 0.796 Test Loss: 0.825 Test Acc: 0.796
Validation loss decreased (-0.770361 --> -0.796288).  Saving model ...
Epoch: 14 cost time: 0.5637552738189697
Epoch: 14, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.748 Vali Acc: 0.826 Test Loss: 0.748 Test Acc: 0.826
Validation loss decreased (-0.796288 --> -0.825918).  Saving model ...
Epoch: 15 cost time: 0.6175873279571533
Epoch: 15, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.679 Vali Acc: 0.863 Test Loss: 0.679 Test Acc: 0.863
Validation loss decreased (-0.825918 --> -0.862956).  Saving model ...
Epoch: 16 cost time: 0.6281037330627441
Epoch: 16, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.619 Vali Acc: 0.874 Test Loss: 0.619 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874068).  Saving model ...
Epoch: 17 cost time: 0.6586916446685791
Epoch: 17, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.566 Vali Acc: 0.889 Test Loss: 0.566 Test Acc: 0.889
Validation loss decreased (-0.874068 --> -0.888883).  Saving model ...
Epoch: 18 cost time: 0.49323511123657227
Epoch: 18, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.519 Vali Acc: 0.896 Test Loss: 0.519 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 19 cost time: 0.5559923648834229
Epoch: 19, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.475 Vali Acc: 0.896 Test Loss: 0.475 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 20 cost time: 0.5461244583129883
Epoch: 20, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.434 Vali Acc: 0.907 Test Loss: 0.434 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907403).  Saving model ...
Epoch: 21 cost time: 0.5270936489105225
Epoch: 21, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.398 Vali Acc: 0.915 Test Loss: 0.398 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 22 cost time: 0.5696308612823486
Epoch: 22, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.366 Vali Acc: 0.926 Test Loss: 0.366 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925922).  Saving model ...
Epoch: 23 cost time: 0.5942909717559814
Epoch: 23, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.339 Vali Acc: 0.933 Test Loss: 0.339 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 24 cost time: 0.6128854751586914
Epoch: 24, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.318 Vali Acc: 0.933 Test Loss: 0.318 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 25 cost time: 0.7002341747283936
Epoch: 25, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 26 cost time: 0.5743808746337891
Epoch: 26, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 27 cost time: 0.547271728515625
Epoch: 27, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 28 cost time: 0.6135072708129883
Epoch: 28, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5671639442443848
Epoch: 29, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.623455286026001
Epoch: 30, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6720001697540283
Epoch: 31, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6080021858215332
Epoch: 32, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6462492942810059
Epoch: 33, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7342634201049805
Epoch: 34, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6547408103942871
Epoch: 35, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6443569660186768
Epoch: 36, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5699551105499268
Epoch: 37, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6281495094299316
Epoch: 38, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 39 cost time: 0.6416010856628418
Epoch: 39, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 40 cost time: 0.7030696868896484
Epoch: 40, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 41 cost time: 0.6712143421173096
Epoch: 41, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 42 cost time: 0.6927728652954102
Epoch: 42, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 43 cost time: 0.5616896152496338
Epoch: 43, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.5575439929962158
Epoch: 44, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.6819710731506348
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 46 cost time: 0.6684012413024902
Epoch: 46, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 47 cost time: 0.6481120586395264
Epoch: 47, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.6122326850891113
Epoch: 48, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.6560628414154053
Epoch: 49, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.6795949935913086
Epoch: 50, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 0.5737450122833252
Epoch: 51, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 0.6028015613555908
Epoch: 52, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 0.5394976139068604
Epoch: 53, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5711824893951416
Epoch: 54, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 0.656775951385498
Epoch: 55, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 0.6510398387908936
Epoch: 56, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 57 cost time: 0.5517327785491943
Epoch: 57, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6324672698974609
Epoch: 58, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7498602867126465
Epoch: 59, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.6791250705718994
Epoch: 60, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.6623880863189697
Epoch: 61, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.8009035587310791
Epoch: 62, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.6584069728851318
Epoch: 63, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.6230571269989014
Epoch: 64, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.5783774852752686
Epoch: 65, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.696073055267334
Epoch: 66, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 87686
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.369016647338867
Epoch: 1, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.961 Vali Acc: 0.085 Test Loss: 1.961 Test Acc: 0.085
Validation loss decreased (inf --> -0.085166).  Saving model ...
Epoch: 2 cost time: 0.6294105052947998
Epoch: 2, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.897 Vali Acc: 0.133 Test Loss: 1.897 Test Acc: 0.133
Validation loss decreased (-0.085166 --> -0.133314).  Saving model ...
Epoch: 3 cost time: 0.6397662162780762
Epoch: 3, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.844 Vali Acc: 0.200 Test Loss: 1.844 Test Acc: 0.200
Validation loss decreased (-0.133314 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.6423420906066895
Epoch: 4, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.790 Vali Acc: 0.237 Test Loss: 1.790 Test Acc: 0.237
Validation loss decreased (-0.199982 --> -0.237019).  Saving model ...
Epoch: 5 cost time: 0.6359000205993652
Epoch: 5, Steps: 2 | Train Loss: 1.925 Vali Loss: 1.721 Vali Acc: 0.256 Test Loss: 1.721 Test Acc: 0.256
Validation loss decreased (-0.237019 --> -0.255538).  Saving model ...
Epoch: 6 cost time: 0.6288614273071289
Epoch: 6, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.643 Vali Acc: 0.300 Test Loss: 1.643 Test Acc: 0.300
Validation loss decreased (-0.255538 --> -0.299984).  Saving model ...
Epoch: 7 cost time: 0.6153039932250977
Epoch: 7, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.558 Vali Acc: 0.337 Test Loss: 1.558 Test Acc: 0.337
Validation loss decreased (-0.299984 --> -0.337021).  Saving model ...
Epoch: 8 cost time: 0.5599117279052734
Epoch: 8, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.467 Vali Acc: 0.400 Test Loss: 1.467 Test Acc: 0.400
Validation loss decreased (-0.337021 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 0.5711193084716797
Epoch: 9, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.374 Vali Acc: 0.511 Test Loss: 1.374 Test Acc: 0.511
Validation loss decreased (-0.399985 --> -0.511097).  Saving model ...
Epoch: 10 cost time: 0.5681266784667969
Epoch: 10, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.280 Vali Acc: 0.574 Test Loss: 1.280 Test Acc: 0.574
Validation loss decreased (-0.511097 --> -0.574061).  Saving model ...
Epoch: 11 cost time: 0.5903019905090332
Epoch: 11, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.188 Vali Acc: 0.667 Test Loss: 1.188 Test Acc: 0.667
Validation loss decreased (-0.574061 --> -0.666655).  Saving model ...
Epoch: 12 cost time: 0.5633525848388672
Epoch: 12, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.098 Vali Acc: 0.707 Test Loss: 1.098 Test Acc: 0.707
Validation loss decreased (-0.666655 --> -0.707396).  Saving model ...
Epoch: 13 cost time: 0.5200107097625732
Epoch: 13, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.012 Vali Acc: 0.752 Test Loss: 1.012 Test Acc: 0.752
Validation loss decreased (-0.707396 --> -0.751842).  Saving model ...
Epoch: 14 cost time: 0.46668386459350586
Epoch: 14, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.932 Vali Acc: 0.778 Test Loss: 0.932 Test Acc: 0.778
Validation loss decreased (-0.751842 --> -0.777768).  Saving model ...
Epoch: 15 cost time: 0.6699671745300293
Epoch: 15, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
Validation loss decreased (-0.777768 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 0.6332337856292725
Epoch: 16, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.793 Vali Acc: 0.815 Test Loss: 0.793 Test Acc: 0.815
Validation loss decreased (-0.799991 --> -0.814807).  Saving model ...
Epoch: 17 cost time: 0.5509295463562012
Epoch: 17, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.732 Vali Acc: 0.833 Test Loss: 0.732 Test Acc: 0.833
Validation loss decreased (-0.814807 --> -0.833326).  Saving model ...
Epoch: 18 cost time: 0.5452451705932617
Epoch: 18, Steps: 2 | Train Loss: 0.575 Vali Loss: 0.679 Vali Acc: 0.837 Test Loss: 0.679 Test Acc: 0.837
Validation loss decreased (-0.833326 --> -0.837030).  Saving model ...
Epoch: 19 cost time: 0.6700921058654785
Epoch: 19, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
Validation loss decreased (-0.837030 --> -0.866660).  Saving model ...
Epoch: 20 cost time: 0.6246476173400879
Epoch: 20, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.583 Vali Acc: 0.881 Test Loss: 0.583 Test Acc: 0.881
Validation loss decreased (-0.866660 --> -0.881476).  Saving model ...
Epoch: 21 cost time: 0.6451256275177002
Epoch: 21, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.543 Vali Acc: 0.896 Test Loss: 0.543 Test Acc: 0.896
Validation loss decreased (-0.881476 --> -0.896291).  Saving model ...
Epoch: 22 cost time: 0.6619384288787842
Epoch: 22, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.505 Vali Acc: 0.900 Test Loss: 0.505 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 0.5778889656066895
Epoch: 23, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.5922756195068359
Epoch: 24, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.436 Vali Acc: 0.904 Test Loss: 0.436 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 25 cost time: 0.6251754760742188
Epoch: 25, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.408 Vali Acc: 0.907 Test Loss: 0.408 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 26 cost time: 0.6533298492431641
Epoch: 26, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.383 Vali Acc: 0.911 Test Loss: 0.383 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 27 cost time: 0.7066829204559326
Epoch: 27, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.363 Vali Acc: 0.911 Test Loss: 0.363 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 28 cost time: 0.5976314544677734
Epoch: 28, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.347 Vali Acc: 0.915 Test Loss: 0.347 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 29 cost time: 0.6745831966400146
Epoch: 29, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5886471271514893
Epoch: 30, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.322 Vali Acc: 0.915 Test Loss: 0.322 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 31 cost time: 0.6208865642547607
Epoch: 31, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.312 Vali Acc: 0.915 Test Loss: 0.312 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 32 cost time: 0.5877015590667725
Epoch: 32, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.300 Vali Acc: 0.919 Test Loss: 0.300 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 33 cost time: 0.6712841987609863
Epoch: 33, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922219).  Saving model ...
Epoch: 34 cost time: 0.653918981552124
Epoch: 34, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 35 cost time: 0.5924553871154785
Epoch: 35, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.270 Vali Acc: 0.926 Test Loss: 0.270 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.669304609298706
Epoch: 36, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.263 Vali Acc: 0.926 Test Loss: 0.263 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5908834934234619
Epoch: 37, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6006083488464355
Epoch: 38, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.629070520401001
Epoch: 39, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5625455379486084
Epoch: 40, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6259462833404541
Epoch: 41, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.242 Vali Acc: 0.915 Test Loss: 0.242 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5612087249755859
Epoch: 42, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.241 Vali Acc: 0.915 Test Loss: 0.241 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6675584316253662
Epoch: 43, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.239 Vali Acc: 0.915 Test Loss: 0.239 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.666473388671875
Epoch: 44, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.238 Vali Acc: 0.915 Test Loss: 0.238 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 81734
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.036449670791626
Epoch: 1, Steps: 2 | Train Loss: 2.180 Vali Loss: 2.062 Vali Acc: 0.126 Test Loss: 2.062 Test Acc: 0.126
Validation loss decreased (inf --> -0.125905).  Saving model ...
Epoch: 2 cost time: 0.6122779846191406
Epoch: 2, Steps: 2 | Train Loss: 1.972 Vali Loss: 2.003 Vali Acc: 0.163 Test Loss: 2.003 Test Acc: 0.163
Validation loss decreased (-0.125905 --> -0.162943).  Saving model ...
Epoch: 3 cost time: 0.470961332321167
Epoch: 3, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.957 Vali Acc: 0.185 Test Loss: 1.957 Test Acc: 0.185
Validation loss decreased (-0.162943 --> -0.185166).  Saving model ...
Epoch: 4 cost time: 0.6228179931640625
Epoch: 4, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.912 Vali Acc: 0.196 Test Loss: 1.912 Test Acc: 0.196
Validation loss decreased (-0.185166 --> -0.196277).  Saving model ...
Epoch: 5 cost time: 0.5302121639251709
Epoch: 5, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.857 Vali Acc: 0.219 Test Loss: 1.857 Test Acc: 0.219
Validation loss decreased (-0.196277 --> -0.218500).  Saving model ...
Epoch: 6 cost time: 0.5731778144836426
Epoch: 6, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.793 Vali Acc: 0.244 Test Loss: 1.793 Test Acc: 0.244
Validation loss decreased (-0.218500 --> -0.244427).  Saving model ...
Epoch: 7 cost time: 0.584204912185669
Epoch: 7, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.722 Vali Acc: 0.263 Test Loss: 1.722 Test Acc: 0.263
Validation loss decreased (-0.244427 --> -0.262946).  Saving model ...
Epoch: 8 cost time: 0.594759464263916
Epoch: 8, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.645 Vali Acc: 0.319 Test Loss: 1.645 Test Acc: 0.319
Validation loss decreased (-0.262946 --> -0.318502).  Saving model ...
Epoch: 9 cost time: 0.5617625713348389
Epoch: 9, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.563 Vali Acc: 0.400 Test Loss: 1.563 Test Acc: 0.400
Validation loss decreased (-0.318502 --> -0.399984).  Saving model ...
Epoch: 10 cost time: 0.5388517379760742
Epoch: 10, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.479 Vali Acc: 0.474 Test Loss: 1.479 Test Acc: 0.474
Validation loss decreased (-0.399984 --> -0.474059).  Saving model ...
Epoch: 11 cost time: 0.6064610481262207
Epoch: 11, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.395 Vali Acc: 0.530 Test Loss: 1.395 Test Acc: 0.530
Validation loss decreased (-0.474059 --> -0.529616).  Saving model ...
Epoch: 12 cost time: 0.6634361743927002
Epoch: 12, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.310 Vali Acc: 0.589 Test Loss: 1.310 Test Acc: 0.589
Validation loss decreased (-0.529616 --> -0.588876).  Saving model ...
Epoch: 13 cost time: 0.6737165451049805
Epoch: 13, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.227 Vali Acc: 0.637 Test Loss: 1.227 Test Acc: 0.637
Validation loss decreased (-0.588876 --> -0.637025).  Saving model ...
Epoch: 14 cost time: 0.6178073883056641
Epoch: 14, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.146 Vali Acc: 0.700 Test Loss: 1.146 Test Acc: 0.700
Validation loss decreased (-0.637025 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.5414764881134033
Epoch: 15, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.068 Vali Acc: 0.722 Test Loss: 1.068 Test Acc: 0.722
Validation loss decreased (-0.699989 --> -0.722212).  Saving model ...
Epoch: 16 cost time: 0.676755428314209
Epoch: 16, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.994 Vali Acc: 0.737 Test Loss: 0.994 Test Acc: 0.737
Validation loss decreased (-0.722212 --> -0.737027).  Saving model ...
Epoch: 17 cost time: 0.5786161422729492
Epoch: 17, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.924 Vali Acc: 0.759 Test Loss: 0.924 Test Acc: 0.759
Validation loss decreased (-0.737027 --> -0.759250).  Saving model ...
Epoch: 18 cost time: 0.6420838832855225
Epoch: 18, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.858 Vali Acc: 0.789 Test Loss: 0.858 Test Acc: 0.789
Validation loss decreased (-0.759250 --> -0.788880).  Saving model ...
Epoch: 19 cost time: 0.5406749248504639
Epoch: 19, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.797 Vali Acc: 0.807 Test Loss: 0.797 Test Acc: 0.807
Validation loss decreased (-0.788880 --> -0.807399).  Saving model ...
Epoch: 20 cost time: 0.5942783355712891
Epoch: 20, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.741 Vali Acc: 0.833 Test Loss: 0.741 Test Acc: 0.833
Validation loss decreased (-0.807399 --> -0.833326).  Saving model ...
Epoch: 21 cost time: 0.6142380237579346
Epoch: 21, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.688 Vali Acc: 0.859 Test Loss: 0.688 Test Acc: 0.859
Validation loss decreased (-0.833326 --> -0.859252).  Saving model ...
Epoch: 22 cost time: 0.5548622608184814
Epoch: 22, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.639 Vali Acc: 0.874 Test Loss: 0.639 Test Acc: 0.874
Validation loss decreased (-0.859252 --> -0.874068).  Saving model ...
Epoch: 23 cost time: 0.6306841373443604
Epoch: 23, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
Validation loss decreased (-0.874068 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.5387628078460693
Epoch: 24, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.554 Vali Acc: 0.904 Test Loss: 0.554 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 25 cost time: 0.5827960968017578
Epoch: 25, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.518 Vali Acc: 0.907 Test Loss: 0.518 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 26 cost time: 0.5629403591156006
Epoch: 26, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.485 Vali Acc: 0.915 Test Loss: 0.485 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 27 cost time: 0.5626485347747803
Epoch: 27, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.456 Vali Acc: 0.919 Test Loss: 0.456 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 28 cost time: 0.6902561187744141
Epoch: 28, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.428 Vali Acc: 0.919 Test Loss: 0.428 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 29 cost time: 0.6262431144714355
Epoch: 29, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.404 Vali Acc: 0.915 Test Loss: 0.404 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5466747283935547
Epoch: 30, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.382 Vali Acc: 0.919 Test Loss: 0.382 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 31 cost time: 0.6168417930603027
Epoch: 31, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.362 Vali Acc: 0.919 Test Loss: 0.362 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 32 cost time: 0.5845901966094971
Epoch: 32, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.345 Vali Acc: 0.926 Test Loss: 0.345 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925922).  Saving model ...
Epoch: 33 cost time: 0.6311066150665283
Epoch: 33, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.330 Vali Acc: 0.926 Test Loss: 0.330 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 34 cost time: 0.5090744495391846
Epoch: 34, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.316 Vali Acc: 0.926 Test Loss: 0.316 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 35 cost time: 0.6640889644622803
Epoch: 35, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 36 cost time: 0.4972865581512451
Epoch: 36, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 37 cost time: 0.5405409336090088
Epoch: 37, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 38 cost time: 0.6437227725982666
Epoch: 38, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.5487613677978516
Epoch: 39, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.6170072555541992
Epoch: 40, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.6292407512664795
Epoch: 41, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 0.602130651473999
Epoch: 42, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 43 cost time: 0.7952032089233398
Epoch: 43, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.7063417434692383
Epoch: 44, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.6374852657318115
Epoch: 45, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.5755040645599365
Epoch: 46, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5346620082855225
Epoch: 47, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5998470783233643
Epoch: 48, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6263573169708252
Epoch: 49, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5884239673614502
Epoch: 50, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.48697805404663086
Epoch: 51, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6522119045257568
Epoch: 52, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6317477226257324
Epoch: 53, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.578148365020752
Epoch: 54, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.590705156326294
Epoch: 55, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 56 cost time: 0.7242588996887207
Epoch: 56, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 57 cost time: 0.723966121673584
Epoch: 57, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 58 cost time: 0.7235944271087646
Epoch: 58, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.956 Test Loss: 0.209 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 59 cost time: 0.6161863803863525
Epoch: 59, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6671018600463867
Epoch: 60, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6448574066162109
Epoch: 61, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.6000103950500488
Epoch: 62, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.5681905746459961
Epoch: 63, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.48723649978637695
Epoch: 64, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.6015396118164062
Epoch: 65, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.5771486759185791
Epoch: 66, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.69856858253479
Epoch: 67, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.5016028881072998
Epoch: 68, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 78918
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3456711769104004
Epoch: 1, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.610 Vali Acc: 0.452 Test Loss: 1.610 Test Acc: 0.452
Validation loss decreased (inf --> -0.451836).  Saving model ...
Epoch: 2 cost time: 0.6224229335784912
Epoch: 2, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.501 Vali Acc: 0.552 Test Loss: 1.501 Test Acc: 0.552
Validation loss decreased (-0.451836 --> -0.551837).  Saving model ...
Epoch: 3 cost time: 0.6944007873535156
Epoch: 3, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.365 Vali Acc: 0.659 Test Loss: 1.365 Test Acc: 0.659
Validation loss decreased (-0.551837 --> -0.659246).  Saving model ...
Epoch: 4 cost time: 0.6218364238739014
Epoch: 4, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.166 Vali Acc: 0.744 Test Loss: 1.166 Test Acc: 0.744
Validation loss decreased (-0.659246 --> -0.744433).  Saving model ...
Epoch: 5 cost time: 0.6176295280456543
Epoch: 5, Steps: 2 | Train Loss: 0.995 Vali Loss: 0.959 Vali Acc: 0.811 Test Loss: 0.959 Test Acc: 0.811
Validation loss decreased (-0.744433 --> -0.811102).  Saving model ...
Epoch: 6 cost time: 0.6583149433135986
Epoch: 6, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.769 Vali Acc: 0.863 Test Loss: 0.769 Test Acc: 0.863
Validation loss decreased (-0.811102 --> -0.862955).  Saving model ...
Epoch: 7 cost time: 0.5791506767272949
Epoch: 7, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.618 Vali Acc: 0.900 Test Loss: 0.618 Test Acc: 0.900
Validation loss decreased (-0.862955 --> -0.899994).  Saving model ...
Epoch: 8 cost time: 0.53403639793396
Epoch: 8, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.499 Vali Acc: 0.896 Test Loss: 0.499 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7470195293426514
Epoch: 9, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.412 Vali Acc: 0.904 Test Loss: 0.412 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903700).  Saving model ...
Epoch: 10 cost time: 0.6897048950195312
Epoch: 10, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
Validation loss decreased (-0.903700 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 0.6541249752044678
Epoch: 11, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.302 Vali Acc: 0.941 Test Loss: 0.302 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6710124015808105
Epoch: 12, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.726794958114624
Epoch: 13, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.691882848739624
Epoch: 14, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6410882472991943
Epoch: 15, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6820390224456787
Epoch: 16, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7427186965942383
Epoch: 17, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 0.7942466735839844
Epoch: 18, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.5863339900970459
Epoch: 19, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5620636940002441
Epoch: 20, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.617283821105957
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6313328742980957
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.72395920753479
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6515436172485352
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6006510257720947
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6893203258514404
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.926 Test Loss: 0.191 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6672821044921875
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.926 Test Loss: 0.192 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6762216091156006
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.926 Test Loss: 0.192 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 150534
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4813530445098877
Epoch: 1, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.881 Vali Acc: 0.104 Test Loss: 1.881 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 0.6314873695373535
Epoch: 2, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.765 Vali Acc: 0.167 Test Loss: 1.765 Test Acc: 0.167
Validation loss decreased (-0.103685 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.6187677383422852
Epoch: 3, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.653 Vali Acc: 0.226 Test Loss: 1.653 Test Acc: 0.226
Validation loss decreased (-0.166649 --> -0.225909).  Saving model ...
Epoch: 4 cost time: 0.5332300662994385
Epoch: 4, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.506 Vali Acc: 0.363 Test Loss: 1.506 Test Acc: 0.363
Validation loss decreased (-0.225909 --> -0.362948).  Saving model ...
Epoch: 5 cost time: 0.5998728275299072
Epoch: 5, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.338 Vali Acc: 0.593 Test Loss: 1.338 Test Acc: 0.593
Validation loss decreased (-0.362948 --> -0.592579).  Saving model ...
Epoch: 6 cost time: 0.6313714981079102
Epoch: 6, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.169 Vali Acc: 0.722 Test Loss: 1.169 Test Acc: 0.722
Validation loss decreased (-0.592579 --> -0.722211).  Saving model ...
Epoch: 7 cost time: 0.6029095649719238
Epoch: 7, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.008 Vali Acc: 0.789 Test Loss: 1.008 Test Acc: 0.789
Validation loss decreased (-0.722211 --> -0.788879).  Saving model ...
Epoch: 8 cost time: 0.5563104152679443
Epoch: 8, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.866 Vali Acc: 0.804 Test Loss: 0.866 Test Acc: 0.804
Validation loss decreased (-0.788879 --> -0.803695).  Saving model ...
Epoch: 9 cost time: 0.5696892738342285
Epoch: 9, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.744 Vali Acc: 0.833 Test Loss: 0.744 Test Acc: 0.833
Validation loss decreased (-0.803695 --> -0.833326).  Saving model ...
Epoch: 10 cost time: 0.5317318439483643
Epoch: 10, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.640 Vali Acc: 0.867 Test Loss: 0.640 Test Acc: 0.867
Validation loss decreased (-0.833326 --> -0.866660).  Saving model ...
Epoch: 11 cost time: 0.6105048656463623
Epoch: 11, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.551 Vali Acc: 0.893 Test Loss: 0.551 Test Acc: 0.893
Validation loss decreased (-0.866660 --> -0.892587).  Saving model ...
Epoch: 12 cost time: 0.7401285171508789
Epoch: 12, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.482 Vali Acc: 0.907 Test Loss: 0.482 Test Acc: 0.907
Validation loss decreased (-0.892587 --> -0.907403).  Saving model ...
Epoch: 13 cost time: 0.6891570091247559
Epoch: 13, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5840494632720947
Epoch: 14, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.377 Vali Acc: 0.919 Test Loss: 0.377 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918515).  Saving model ...
Epoch: 15 cost time: 0.6428720951080322
Epoch: 15, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.333 Vali Acc: 0.941 Test Loss: 0.333 Test Acc: 0.941
Validation loss decreased (-0.918515 --> -0.940737).  Saving model ...
Epoch: 16 cost time: 0.5818872451782227
Epoch: 16, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.5687682628631592
Epoch: 17, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5661616325378418
Epoch: 18, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.6123788356781006
Epoch: 19, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5050897598266602
Epoch: 20, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5693449974060059
Epoch: 21, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6410202980041504
Epoch: 22, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5274066925048828
Epoch: 23, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.7360751628875732
Epoch: 24, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.5558428764343262
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.6737031936645508
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.6646873950958252
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.5954289436340332
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.616032600402832
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.638359546661377
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6629455089569092
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7246642112731934
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6444711685180664
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5562276840209961
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5167679786682129
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6025710105895996
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5881359577178955
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 99974
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.23726749420166
Epoch: 1, Steps: 2 | Train Loss: 2.025 Vali Loss: 1.944 Vali Acc: 0.159 Test Loss: 1.944 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.4998629093170166
Epoch: 2, Steps: 2 | Train Loss: 2.006 Vali Loss: 1.870 Vali Acc: 0.230 Test Loss: 1.870 Test Acc: 0.230
Validation loss decreased (-0.159240 --> -0.229611).  Saving model ...
Epoch: 3 cost time: 0.527867317199707
Epoch: 3, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.797 Vali Acc: 0.311 Test Loss: 1.797 Test Acc: 0.311
Validation loss decreased (-0.229611 --> -0.311093).  Saving model ...
Epoch: 4 cost time: 0.5032248497009277
Epoch: 4, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.694 Vali Acc: 0.448 Test Loss: 1.694 Test Acc: 0.448
Validation loss decreased (-0.311093 --> -0.448131).  Saving model ...
Epoch: 5 cost time: 0.5204050540924072
Epoch: 5, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.566 Vali Acc: 0.530 Test Loss: 1.566 Test Acc: 0.530
Validation loss decreased (-0.448131 --> -0.529614).  Saving model ...
Epoch: 6 cost time: 0.5326032638549805
Epoch: 6, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.421 Vali Acc: 0.578 Test Loss: 1.421 Test Acc: 0.578
Validation loss decreased (-0.529614 --> -0.577764).  Saving model ...
Epoch: 7 cost time: 0.5566794872283936
Epoch: 7, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.273 Vali Acc: 0.589 Test Loss: 1.273 Test Acc: 0.589
Validation loss decreased (-0.577764 --> -0.588876).  Saving model ...
Epoch: 8 cost time: 0.5712134838104248
Epoch: 8, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.131 Vali Acc: 0.633 Test Loss: 1.131 Test Acc: 0.633
Validation loss decreased (-0.588876 --> -0.633322).  Saving model ...
Epoch: 9 cost time: 0.5667593479156494
Epoch: 9, Steps: 2 | Train Loss: 1.000 Vali Loss: 0.999 Vali Acc: 0.674 Test Loss: 0.999 Test Acc: 0.674
Validation loss decreased (-0.633322 --> -0.674064).  Saving model ...
Epoch: 10 cost time: 0.5043087005615234
Epoch: 10, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.882 Vali Acc: 0.748 Test Loss: 0.882 Test Acc: 0.748
Validation loss decreased (-0.674064 --> -0.748139).  Saving model ...
Epoch: 11 cost time: 0.5288469791412354
Epoch: 11, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.748139 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 0.5825693607330322
Epoch: 12, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.684 Vali Acc: 0.833 Test Loss: 0.684 Test Acc: 0.833
Validation loss decreased (-0.799992 --> -0.833326).  Saving model ...
Epoch: 13 cost time: 0.5358774662017822
Epoch: 13, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.605 Vali Acc: 0.863 Test Loss: 0.605 Test Acc: 0.863
Validation loss decreased (-0.833326 --> -0.862957).  Saving model ...
Epoch: 14 cost time: 0.6587495803833008
Epoch: 14, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.538 Vali Acc: 0.874 Test Loss: 0.538 Test Acc: 0.874
Validation loss decreased (-0.862957 --> -0.874069).  Saving model ...
Epoch: 15 cost time: 0.6201798915863037
Epoch: 15, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.480 Vali Acc: 0.889 Test Loss: 0.480 Test Acc: 0.889
Validation loss decreased (-0.874069 --> -0.888884).  Saving model ...
Epoch: 16 cost time: 0.6402242183685303
Epoch: 16, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.429 Vali Acc: 0.896 Test Loss: 0.429 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896292).  Saving model ...
Epoch: 17 cost time: 0.5678718090057373
Epoch: 17, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.389 Vali Acc: 0.907 Test Loss: 0.389 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907404).  Saving model ...
Epoch: 18 cost time: 0.611487627029419
Epoch: 18, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.355 Vali Acc: 0.915 Test Loss: 0.355 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 0.5056207180023193
Epoch: 19, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.325 Vali Acc: 0.919 Test Loss: 0.325 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.5917572975158691
Epoch: 20, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.299 Vali Acc: 0.922 Test Loss: 0.299 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 0.5423176288604736
Epoch: 21, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 22 cost time: 0.7102296352386475
Epoch: 22, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 0.6156179904937744
Epoch: 23, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.7474236488342285
Epoch: 24, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.7103018760681152
Epoch: 25, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 26 cost time: 0.7677907943725586
Epoch: 26, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.6766929626464844
Epoch: 27, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.645714521408081
Epoch: 28, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.614569902420044
Epoch: 29, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.5867669582366943
Epoch: 30, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.5972983837127686
Epoch: 31, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.6300938129425049
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.6222515106201172
Epoch: 33, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.5529465675354004
Epoch: 34, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.6476740837097168
Epoch: 35, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6540284156799316
Epoch: 36, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6208586692810059
Epoch: 37, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5582990646362305
Epoch: 38, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7538340091705322
Epoch: 39, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7072484493255615
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5661320686340332
Epoch: 41, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5920932292938232
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5891392230987549
Epoch: 43, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.551485538482666
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 84678
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.249643564224243
Epoch: 1, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.797 Vali Acc: 0.196 Test Loss: 1.797 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.6101617813110352
Epoch: 2, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.737 Vali Acc: 0.263 Test Loss: 1.737 Test Acc: 0.263
Validation loss decreased (-0.196278 --> -0.262946).  Saving model ...
Epoch: 3 cost time: 0.5919685363769531
Epoch: 3, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.682 Vali Acc: 0.311 Test Loss: 1.682 Test Acc: 0.311
Validation loss decreased (-0.262946 --> -0.311094).  Saving model ...
Epoch: 4 cost time: 0.5917420387268066
Epoch: 4, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.612 Vali Acc: 0.363 Test Loss: 1.612 Test Acc: 0.363
Validation loss decreased (-0.311094 --> -0.362947).  Saving model ...
Epoch: 5 cost time: 0.5777730941772461
Epoch: 5, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.524 Vali Acc: 0.474 Test Loss: 1.524 Test Acc: 0.474
Validation loss decreased (-0.362947 --> -0.474059).  Saving model ...
Epoch: 6 cost time: 0.5882081985473633
Epoch: 6, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.427 Vali Acc: 0.596 Test Loss: 1.427 Test Acc: 0.596
Validation loss decreased (-0.474059 --> -0.596282).  Saving model ...
Epoch: 7 cost time: 0.6144924163818359
Epoch: 7, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.320 Vali Acc: 0.659 Test Loss: 1.320 Test Acc: 0.659
Validation loss decreased (-0.596282 --> -0.659246).  Saving model ...
Epoch: 8 cost time: 0.6883902549743652
Epoch: 8, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.209 Vali Acc: 0.730 Test Loss: 1.209 Test Acc: 0.730
Validation loss decreased (-0.659246 --> -0.729618).  Saving model ...
Epoch: 9 cost time: 0.588238000869751
Epoch: 9, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.101 Vali Acc: 0.770 Test Loss: 1.101 Test Acc: 0.770
Validation loss decreased (-0.729618 --> -0.770359).  Saving model ...
Epoch: 10 cost time: 0.6138291358947754
Epoch: 10, Steps: 2 | Train Loss: 1.008 Vali Loss: 0.996 Vali Acc: 0.807 Test Loss: 0.996 Test Acc: 0.807
Validation loss decreased (-0.770359 --> -0.807397).  Saving model ...
Epoch: 11 cost time: 0.6689436435699463
Epoch: 11, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.897 Vali Acc: 0.822 Test Loss: 0.897 Test Acc: 0.822
Validation loss decreased (-0.807397 --> -0.822213).  Saving model ...
Epoch: 12 cost time: 0.6454403400421143
Epoch: 12, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.807 Vali Acc: 0.848 Test Loss: 0.807 Test Acc: 0.848
Validation loss decreased (-0.822213 --> -0.848140).  Saving model ...
Epoch: 13 cost time: 0.6274538040161133
Epoch: 13, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.725 Vali Acc: 0.885 Test Loss: 0.725 Test Acc: 0.885
Validation loss decreased (-0.848140 --> -0.885178).  Saving model ...
Epoch: 14 cost time: 0.5981583595275879
Epoch: 14, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.651 Vali Acc: 0.904 Test Loss: 0.651 Test Acc: 0.904
Validation loss decreased (-0.885178 --> -0.903697).  Saving model ...
Epoch: 15 cost time: 0.6129815578460693
Epoch: 15, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.585 Vali Acc: 0.907 Test Loss: 0.585 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907402).  Saving model ...
Epoch: 16 cost time: 0.6199774742126465
Epoch: 16, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.528 Vali Acc: 0.919 Test Loss: 0.528 Test Acc: 0.919
Validation loss decreased (-0.907402 --> -0.918513).  Saving model ...
Epoch: 17 cost time: 0.6853041648864746
Epoch: 17, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.478 Vali Acc: 0.919 Test Loss: 0.478 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 18 cost time: 0.6708853244781494
Epoch: 18, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.434 Vali Acc: 0.919 Test Loss: 0.434 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 19 cost time: 0.6545596122741699
Epoch: 19, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.396 Vali Acc: 0.926 Test Loss: 0.396 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 20 cost time: 0.6649179458618164
Epoch: 20, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.363 Vali Acc: 0.926 Test Loss: 0.363 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 0.7004327774047852
Epoch: 21, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.334 Vali Acc: 0.926 Test Loss: 0.334 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 22 cost time: 0.587111234664917
Epoch: 22, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.308 Vali Acc: 0.937 Test Loss: 0.308 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937034).  Saving model ...
Epoch: 23 cost time: 0.6359834671020508
Epoch: 23, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.286 Vali Acc: 0.941 Test Loss: 0.286 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 24 cost time: 0.536022424697876
Epoch: 24, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.269 Vali Acc: 0.941 Test Loss: 0.269 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 25 cost time: 0.5786943435668945
Epoch: 25, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6300528049468994
Epoch: 26, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.6373555660247803
Epoch: 27, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6984491348266602
Epoch: 28, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7716889381408691
Epoch: 29, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7469053268432617
Epoch: 30, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6571614742279053
Epoch: 31, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5793828964233398
Epoch: 32, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5958530902862549
Epoch: 33, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7123777866363525
Epoch: 34, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6022684574127197
Epoch: 35, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5923209190368652
Epoch: 36, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 75590
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3748106956481934
Epoch: 1, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.787 Vali Acc: 0.259 Test Loss: 1.787 Test Acc: 0.259
Validation loss decreased (inf --> -0.259241).  Saving model ...
Epoch: 2 cost time: 0.7839515209197998
Epoch: 2, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.724 Vali Acc: 0.296 Test Loss: 1.724 Test Acc: 0.296
Validation loss decreased (-0.259241 --> -0.296279).  Saving model ...
Epoch: 3 cost time: 0.5470249652862549
Epoch: 3, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.671 Vali Acc: 0.344 Test Loss: 1.671 Test Acc: 0.344
Validation loss decreased (-0.296279 --> -0.344428).  Saving model ...
Epoch: 4 cost time: 0.5780022144317627
Epoch: 4, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.610 Vali Acc: 0.415 Test Loss: 1.610 Test Acc: 0.415
Validation loss decreased (-0.344428 --> -0.414799).  Saving model ...
Epoch: 5 cost time: 0.562389612197876
Epoch: 5, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.532 Vali Acc: 0.504 Test Loss: 1.532 Test Acc: 0.504
Validation loss decreased (-0.414799 --> -0.503688).  Saving model ...
Epoch: 6 cost time: 0.6055083274841309
Epoch: 6, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.441 Vali Acc: 0.585 Test Loss: 1.441 Test Acc: 0.585
Validation loss decreased (-0.503688 --> -0.585171).  Saving model ...
Epoch: 7 cost time: 0.5358145236968994
Epoch: 7, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.342 Vali Acc: 0.630 Test Loss: 1.342 Test Acc: 0.630
Validation loss decreased (-0.585171 --> -0.629616).  Saving model ...
Epoch: 8 cost time: 0.6451821327209473
Epoch: 8, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.239 Vali Acc: 0.648 Test Loss: 1.239 Test Acc: 0.648
Validation loss decreased (-0.629616 --> -0.648136).  Saving model ...
Epoch: 9 cost time: 0.7240839004516602
Epoch: 9, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.136 Vali Acc: 0.696 Test Loss: 1.136 Test Acc: 0.696
Validation loss decreased (-0.648136 --> -0.696285).  Saving model ...
Epoch: 10 cost time: 0.6458165645599365
Epoch: 10, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.035 Vali Acc: 0.744 Test Loss: 1.035 Test Acc: 0.744
Validation loss decreased (-0.696285 --> -0.744434).  Saving model ...
Epoch: 11 cost time: 0.8180160522460938
Epoch: 11, Steps: 2 | Train Loss: 0.953 Vali Loss: 0.939 Vali Acc: 0.807 Test Loss: 0.939 Test Acc: 0.807
Validation loss decreased (-0.744434 --> -0.807398).  Saving model ...
Epoch: 12 cost time: 0.5437359809875488
Epoch: 12, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.850 Vali Acc: 0.848 Test Loss: 0.850 Test Acc: 0.848
Validation loss decreased (-0.807398 --> -0.848140).  Saving model ...
Epoch: 13 cost time: 0.524660587310791
Epoch: 13, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.766 Vali Acc: 0.874 Test Loss: 0.766 Test Acc: 0.874
Validation loss decreased (-0.848140 --> -0.874066).  Saving model ...
Epoch: 14 cost time: 0.5091111660003662
Epoch: 14, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.691 Vali Acc: 0.885 Test Loss: 0.691 Test Acc: 0.885
Validation loss decreased (-0.874066 --> -0.885178).  Saving model ...
Epoch: 15 cost time: 0.49936485290527344
Epoch: 15, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.625 Vali Acc: 0.904 Test Loss: 0.625 Test Acc: 0.904
Validation loss decreased (-0.885178 --> -0.903697).  Saving model ...
Epoch: 16 cost time: 0.6638243198394775
Epoch: 16, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.567 Vali Acc: 0.911 Test Loss: 0.567 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 17 cost time: 0.6157631874084473
Epoch: 17, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.515 Vali Acc: 0.915 Test Loss: 0.515 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914810).  Saving model ...
Epoch: 18 cost time: 0.5694420337677002
Epoch: 18, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.467 Vali Acc: 0.930 Test Loss: 0.467 Test Acc: 0.930
Validation loss decreased (-0.914810 --> -0.929625).  Saving model ...
Epoch: 19 cost time: 0.5627801418304443
Epoch: 19, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.426 Vali Acc: 0.933 Test Loss: 0.426 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 20 cost time: 0.6372125148773193
Epoch: 20, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.390 Vali Acc: 0.933 Test Loss: 0.390 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 21 cost time: 0.6092984676361084
Epoch: 21, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.360 Vali Acc: 0.937 Test Loss: 0.360 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 22 cost time: 0.5402190685272217
Epoch: 22, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.334 Vali Acc: 0.933 Test Loss: 0.334 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6418807506561279
Epoch: 23, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6512405872344971
Epoch: 24, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6564009189605713
Epoch: 25, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.564821720123291
Epoch: 26, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6040513515472412
Epoch: 27, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.4815785884857178
Epoch: 28, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6015889644622803
Epoch: 29, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6226029396057129
Epoch: 30, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.225 Vali Acc: 0.926 Test Loss: 0.225 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6472342014312744
Epoch: 31, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 71174
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.234567165374756
Epoch: 1, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.931 Vali Acc: 0.167 Test Loss: 1.931 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.6846809387207031
Epoch: 2, Steps: 2 | Train Loss: 1.922 Vali Loss: 1.864 Vali Acc: 0.163 Test Loss: 1.864 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.633885383605957
Epoch: 3, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.809 Vali Acc: 0.163 Test Loss: 1.809 Test Acc: 0.163
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.525623083114624
Epoch: 4, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.756 Vali Acc: 0.170 Test Loss: 1.756 Test Acc: 0.170
Validation loss decreased (-0.166647 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 0.6296846866607666
Epoch: 5, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.691 Vali Acc: 0.196 Test Loss: 1.691 Test Acc: 0.196
Validation loss decreased (-0.170353 --> -0.196279).  Saving model ...
Epoch: 6 cost time: 0.6002812385559082
Epoch: 6, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.620 Vali Acc: 0.259 Test Loss: 1.620 Test Acc: 0.259
Validation loss decreased (-0.196279 --> -0.259243).  Saving model ...
Epoch: 7 cost time: 0.6137559413909912
Epoch: 7, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.541 Vali Acc: 0.359 Test Loss: 1.541 Test Acc: 0.359
Validation loss decreased (-0.259243 --> -0.359244).  Saving model ...
Epoch: 8 cost time: 0.5989053249359131
Epoch: 8, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.457 Vali Acc: 0.456 Test Loss: 1.457 Test Acc: 0.456
Validation loss decreased (-0.359244 --> -0.455541).  Saving model ...
Epoch: 9 cost time: 0.5710325241088867
Epoch: 9, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.369 Vali Acc: 0.515 Test Loss: 1.369 Test Acc: 0.515
Validation loss decreased (-0.455541 --> -0.514801).  Saving model ...
Epoch: 10 cost time: 0.652376651763916
Epoch: 10, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.282 Vali Acc: 0.563 Test Loss: 1.282 Test Acc: 0.563
Validation loss decreased (-0.514801 --> -0.562950).  Saving model ...
Epoch: 11 cost time: 0.6333386898040771
Epoch: 11, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.194 Vali Acc: 0.622 Test Loss: 1.194 Test Acc: 0.622
Validation loss decreased (-0.562950 --> -0.622210).  Saving model ...
Epoch: 12 cost time: 0.6032702922821045
Epoch: 12, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.110 Vali Acc: 0.689 Test Loss: 1.110 Test Acc: 0.689
Validation loss decreased (-0.622210 --> -0.688878).  Saving model ...
Epoch: 13 cost time: 0.5246667861938477
Epoch: 13, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.028 Vali Acc: 0.752 Test Loss: 1.028 Test Acc: 0.752
Validation loss decreased (-0.688878 --> -0.751842).  Saving model ...
Epoch: 14 cost time: 0.5855965614318848
Epoch: 14, Steps: 2 | Train Loss: 0.973 Vali Loss: 0.951 Vali Acc: 0.778 Test Loss: 0.951 Test Acc: 0.778
Validation loss decreased (-0.751842 --> -0.777768).  Saving model ...
Epoch: 15 cost time: 0.5767943859100342
Epoch: 15, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.877 Vali Acc: 0.833 Test Loss: 0.877 Test Acc: 0.833
Validation loss decreased (-0.777768 --> -0.833325).  Saving model ...
Epoch: 16 cost time: 0.586738109588623
Epoch: 16, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.809 Vali Acc: 0.852 Test Loss: 0.809 Test Acc: 0.852
Validation loss decreased (-0.833325 --> -0.851844).  Saving model ...
Epoch: 17 cost time: 0.6170263290405273
Epoch: 17, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.745 Vali Acc: 0.870 Test Loss: 0.745 Test Acc: 0.870
Validation loss decreased (-0.851844 --> -0.870363).  Saving model ...
Epoch: 18 cost time: 0.5089385509490967
Epoch: 18, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.685 Vali Acc: 0.889 Test Loss: 0.685 Test Acc: 0.889
Validation loss decreased (-0.870363 --> -0.888882).  Saving model ...
Epoch: 19 cost time: 0.8555593490600586
Epoch: 19, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.631 Vali Acc: 0.893 Test Loss: 0.631 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 20 cost time: 0.5416922569274902
Epoch: 20, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.581 Vali Acc: 0.907 Test Loss: 0.581 Test Acc: 0.907
Validation loss decreased (-0.892586 --> -0.907402).  Saving model ...
Epoch: 21 cost time: 0.529944658279419
Epoch: 21, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.535 Vali Acc: 0.907 Test Loss: 0.535 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 22 cost time: 0.5656905174255371
Epoch: 22, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.494 Vali Acc: 0.915 Test Loss: 0.494 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 23 cost time: 0.6577932834625244
Epoch: 23, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.456 Vali Acc: 0.926 Test Loss: 0.456 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925921).  Saving model ...
Epoch: 24 cost time: 0.6211137771606445
Epoch: 24, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.422 Vali Acc: 0.930 Test Loss: 0.422 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 25 cost time: 0.5960969924926758
Epoch: 25, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.392 Vali Acc: 0.933 Test Loss: 0.392 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 26 cost time: 0.6786799430847168
Epoch: 26, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.365 Vali Acc: 0.933 Test Loss: 0.365 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 27 cost time: 0.597832202911377
Epoch: 27, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.343 Vali Acc: 0.933 Test Loss: 0.343 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 28 cost time: 0.6735432147979736
Epoch: 28, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 29 cost time: 0.5788934230804443
Epoch: 29, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.308 Vali Acc: 0.937 Test Loss: 0.308 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 30 cost time: 0.557999849319458
Epoch: 30, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.295 Vali Acc: 0.933 Test Loss: 0.295 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6308202743530273
Epoch: 31, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5743083953857422
Epoch: 32, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.274 Vali Acc: 0.937 Test Loss: 0.274 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 33 cost time: 0.6129302978515625
Epoch: 33, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 34 cost time: 0.5147740840911865
Epoch: 34, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 35 cost time: 0.6504015922546387
Epoch: 35, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.5867037773132324
Epoch: 36, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6980137825012207
Epoch: 37, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5698633193969727
Epoch: 38, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.549274206161499
Epoch: 39, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5311322212219238
Epoch: 40, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5894525051116943
Epoch: 41, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5746943950653076
Epoch: 42, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.6483426094055176
Epoch: 43, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.6809704303741455
Epoch: 44, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.629103422164917
Epoch: 45, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6363437175750732
Epoch: 46, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5804312229156494
Epoch: 47, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.591038703918457
Epoch: 48, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6483516693115234
Epoch: 49, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6322534084320068
Epoch: 50, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.6394169330596924
Epoch: 51, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.600982666015625
Epoch: 52, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.5071268081665039
Epoch: 53, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5853137969970703
Epoch: 54, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 65222
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4094388484954834
Epoch: 1, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.857 Vali Acc: 0.181 Test Loss: 1.857 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.5733106136322021
Epoch: 2, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.813 Vali Acc: 0.189 Test Loss: 1.813 Test Acc: 0.189
Validation loss decreased (-0.181463 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.6533751487731934
Epoch: 3, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.777 Vali Acc: 0.196 Test Loss: 1.777 Test Acc: 0.196
Validation loss decreased (-0.188871 --> -0.196279).  Saving model ...
Epoch: 4 cost time: 0.6951136589050293
Epoch: 4, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.740 Vali Acc: 0.204 Test Loss: 1.740 Test Acc: 0.204
Validation loss decreased (-0.196279 --> -0.203686).  Saving model ...
Epoch: 5 cost time: 0.5389821529388428
Epoch: 5, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.695 Vali Acc: 0.219 Test Loss: 1.695 Test Acc: 0.219
Validation loss decreased (-0.203686 --> -0.218502).  Saving model ...
Epoch: 6 cost time: 0.5211215019226074
Epoch: 6, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.641 Vali Acc: 0.237 Test Loss: 1.641 Test Acc: 0.237
Validation loss decreased (-0.218502 --> -0.237021).  Saving model ...
Epoch: 7 cost time: 0.6341037750244141
Epoch: 7, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.580 Vali Acc: 0.281 Test Loss: 1.580 Test Acc: 0.281
Validation loss decreased (-0.237021 --> -0.281466).  Saving model ...
Epoch: 8 cost time: 0.6451079845428467
Epoch: 8, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.513 Vali Acc: 0.385 Test Loss: 1.513 Test Acc: 0.385
Validation loss decreased (-0.281466 --> -0.385170).  Saving model ...
Epoch: 9 cost time: 0.6129112243652344
Epoch: 9, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.442 Vali Acc: 0.481 Test Loss: 1.442 Test Acc: 0.481
Validation loss decreased (-0.385170 --> -0.481467).  Saving model ...
Epoch: 10 cost time: 0.5740697383880615
Epoch: 10, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.368 Vali Acc: 0.548 Test Loss: 1.368 Test Acc: 0.548
Validation loss decreased (-0.481467 --> -0.548134).  Saving model ...
Epoch: 11 cost time: 0.5611472129821777
Epoch: 11, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.292 Vali Acc: 0.611 Test Loss: 1.292 Test Acc: 0.611
Validation loss decreased (-0.548134 --> -0.611098).  Saving model ...
Epoch: 12 cost time: 0.6435739994049072
Epoch: 12, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.216 Vali Acc: 0.656 Test Loss: 1.216 Test Acc: 0.656
Validation loss decreased (-0.611098 --> -0.655543).  Saving model ...
Epoch: 13 cost time: 0.5844728946685791
Epoch: 13, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.140 Vali Acc: 0.722 Test Loss: 1.140 Test Acc: 0.722
Validation loss decreased (-0.655543 --> -0.722211).  Saving model ...
Epoch: 14 cost time: 0.5676865577697754
Epoch: 14, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.065 Vali Acc: 0.759 Test Loss: 1.065 Test Acc: 0.759
Validation loss decreased (-0.722211 --> -0.759249).  Saving model ...
Epoch: 15 cost time: 0.6421029567718506
Epoch: 15, Steps: 2 | Train Loss: 1.074 Vali Loss: 0.996 Vali Acc: 0.819 Test Loss: 0.996 Test Acc: 0.819
Validation loss decreased (-0.759249 --> -0.818509).  Saving model ...
Epoch: 16 cost time: 0.5444552898406982
Epoch: 16, Steps: 2 | Train Loss: 0.938 Vali Loss: 0.929 Vali Acc: 0.844 Test Loss: 0.929 Test Acc: 0.844
Validation loss decreased (-0.818509 --> -0.844435).  Saving model ...
Epoch: 17 cost time: 0.597034215927124
Epoch: 17, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.865 Vali Acc: 0.863 Test Loss: 0.865 Test Acc: 0.863
Validation loss decreased (-0.844435 --> -0.862954).  Saving model ...
Epoch: 18 cost time: 0.5866680145263672
Epoch: 18, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.805 Vali Acc: 0.889 Test Loss: 0.805 Test Acc: 0.889
Validation loss decreased (-0.862954 --> -0.888881).  Saving model ...
Epoch: 19 cost time: 0.5471274852752686
Epoch: 19, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.749 Vali Acc: 0.907 Test Loss: 0.749 Test Acc: 0.907
Validation loss decreased (-0.888881 --> -0.907400).  Saving model ...
Epoch: 20 cost time: 0.5849685668945312
Epoch: 20, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.698 Vali Acc: 0.922 Test Loss: 0.698 Test Acc: 0.922
Validation loss decreased (-0.907400 --> -0.922215).  Saving model ...
Epoch: 21 cost time: 0.6366939544677734
Epoch: 21, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.651 Vali Acc: 0.926 Test Loss: 0.651 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 22 cost time: 0.6400778293609619
Epoch: 22, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.608 Vali Acc: 0.930 Test Loss: 0.608 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929624).  Saving model ...
Epoch: 23 cost time: 0.5782461166381836
Epoch: 23, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.567 Vali Acc: 0.930 Test Loss: 0.567 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 24 cost time: 0.5689866542816162
Epoch: 24, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.530 Vali Acc: 0.930 Test Loss: 0.530 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 25 cost time: 0.5901210308074951
Epoch: 25, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.496 Vali Acc: 0.930 Test Loss: 0.496 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 26 cost time: 0.5984911918640137
Epoch: 26, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.466 Vali Acc: 0.930 Test Loss: 0.466 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 27 cost time: 0.5594813823699951
Epoch: 27, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.438 Vali Acc: 0.930 Test Loss: 0.438 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 28 cost time: 0.6534128189086914
Epoch: 28, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.414 Vali Acc: 0.930 Test Loss: 0.414 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 29 cost time: 0.64288330078125
Epoch: 29, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.390 Vali Acc: 0.933 Test Loss: 0.390 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 30 cost time: 0.6688327789306641
Epoch: 30, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.370 Vali Acc: 0.933 Test Loss: 0.370 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 31 cost time: 0.6356174945831299
Epoch: 31, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.350 Vali Acc: 0.933 Test Loss: 0.350 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 32 cost time: 0.6860644817352295
Epoch: 32, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.332 Vali Acc: 0.937 Test Loss: 0.332 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 33 cost time: 0.7333800792694092
Epoch: 33, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.316 Vali Acc: 0.937 Test Loss: 0.316 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 34 cost time: 0.6257858276367188
Epoch: 34, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.302 Vali Acc: 0.937 Test Loss: 0.302 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 35 cost time: 0.6009571552276611
Epoch: 35, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.290 Vali Acc: 0.937 Test Loss: 0.290 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 36 cost time: 0.6209943294525146
Epoch: 36, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.280 Vali Acc: 0.941 Test Loss: 0.280 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.5690922737121582
Epoch: 37, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.270 Vali Acc: 0.941 Test Loss: 0.270 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.5791668891906738
Epoch: 38, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 39 cost time: 0.5457603931427002
Epoch: 39, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 40 cost time: 0.5042648315429688
Epoch: 40, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 41 cost time: 0.522937536239624
Epoch: 41, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 42 cost time: 0.5725035667419434
Epoch: 42, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 43 cost time: 0.523421049118042
Epoch: 43, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.6337735652923584
Epoch: 44, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.6305594444274902
Epoch: 45, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.6070184707641602
Epoch: 46, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.6240289211273193
Epoch: 47, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5968387126922607
Epoch: 48, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.5311253070831299
Epoch: 49, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.6070380210876465
Epoch: 50, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.5492022037506104
Epoch: 51, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.6468853950500488
Epoch: 52, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.6022725105285645
Epoch: 53, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.5502090454101562
Epoch: 54, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 55 cost time: 0.5138030052185059
Epoch: 55, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 56 cost time: 0.6124711036682129
Epoch: 56, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 57 cost time: 0.6515293121337891
Epoch: 57, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 58 cost time: 0.5932247638702393
Epoch: 58, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 59 cost time: 0.6960456371307373
Epoch: 59, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 60 cost time: 0.5858447551727295
Epoch: 60, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 61 cost time: 0.5676393508911133
Epoch: 61, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 62 cost time: 0.5861911773681641
Epoch: 62, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 63 cost time: 0.5259373188018799
Epoch: 63, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 64 cost time: 0.5313997268676758
Epoch: 64, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 65 cost time: 0.4933147430419922
Epoch: 65, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 66 cost time: 0.5403380393981934
Epoch: 66, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 67 cost time: 0.5436317920684814
Epoch: 67, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 68 cost time: 0.6245467662811279
Epoch: 68, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 69 cost time: 0.48644137382507324
Epoch: 69, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 70 cost time: 0.56868577003479
Epoch: 70, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 71 cost time: 0.5984313488006592
Epoch: 71, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 72 cost time: 0.6704497337341309
Epoch: 72, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 73 cost time: 0.5845544338226318
Epoch: 73, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.5238945484161377
Epoch: 74, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.562401294708252
Epoch: 75, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.6853485107421875
Epoch: 76, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.6237995624542236
Epoch: 77, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 78 cost time: 0.5339643955230713
Epoch: 78, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 79 cost time: 0.4917714595794678
Epoch: 79, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 80 cost time: 0.5549170970916748
Epoch: 80, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 81 cost time: 0.5071365833282471
Epoch: 81, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 82 cost time: 0.5089783668518066
Epoch: 82, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 83 cost time: 0.48460912704467773
Epoch: 83, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 84 cost time: 0.5414724349975586
Epoch: 84, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 85 cost time: 0.6002538204193115
Epoch: 85, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 86 cost time: 0.5280745029449463
Epoch: 86, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 87 cost time: 0.6114132404327393
Epoch: 87, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 88 cost time: 0.5754306316375732
Epoch: 88, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 89 cost time: 0.5273683071136475
Epoch: 89, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 90 cost time: 0.5850784778594971
Epoch: 90, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 91 cost time: 0.5855121612548828
Epoch: 91, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.6034884452819824
Epoch: 92, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 93 cost time: 0.575944185256958
Epoch: 93, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 94 cost time: 0.5909194946289062
Epoch: 94, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 95 cost time: 0.7060577869415283
Epoch: 95, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 96 cost time: 0.6235501766204834
Epoch: 96, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 97 cost time: 0.607548713684082
Epoch: 97, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 98 cost time: 0.5478305816650391
Epoch: 98, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 99 cost time: 0.4957594871520996
Epoch: 99, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 100 cost time: 0.5166060924530029
Epoch: 100, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm64_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 62406
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2930355072021484
Epoch: 1, Steps: 2 | Train Loss: 2.055 Vali Loss: 1.907 Vali Acc: 0.104 Test Loss: 1.907 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 0.6269540786743164
Epoch: 2, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.800 Vali Acc: 0.133 Test Loss: 1.800 Test Acc: 0.133
Validation loss decreased (-0.103685 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 0.58453369140625
Epoch: 3, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.695 Vali Acc: 0.207 Test Loss: 1.695 Test Acc: 0.207
Validation loss decreased (-0.133315 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.6298110485076904
Epoch: 4, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.558 Vali Acc: 0.337 Test Loss: 1.558 Test Acc: 0.337
Validation loss decreased (-0.207390 --> -0.337021).  Saving model ...
Epoch: 5 cost time: 0.5795562267303467
Epoch: 5, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.402 Vali Acc: 0.507 Test Loss: 1.402 Test Acc: 0.507
Validation loss decreased (-0.337021 --> -0.507393).  Saving model ...
Epoch: 6 cost time: 0.6542062759399414
Epoch: 6, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.240 Vali Acc: 0.700 Test Loss: 1.240 Test Acc: 0.700
Validation loss decreased (-0.507393 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 0.5931599140167236
Epoch: 7, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.076 Vali Acc: 0.781 Test Loss: 1.076 Test Acc: 0.781
Validation loss decreased (-0.699988 --> -0.781471).  Saving model ...
Epoch: 8 cost time: 0.6004810333251953
Epoch: 8, Steps: 2 | Train Loss: 1.001 Vali Loss: 0.925 Vali Acc: 0.852 Test Loss: 0.925 Test Acc: 0.852
Validation loss decreased (-0.781471 --> -0.851843).  Saving model ...
Epoch: 9 cost time: 0.5902743339538574
Epoch: 9, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.787 Vali Acc: 0.885 Test Loss: 0.787 Test Acc: 0.885
Validation loss decreased (-0.851843 --> -0.885177).  Saving model ...
Epoch: 10 cost time: 0.6786472797393799
Epoch: 10, Steps: 2 | Train Loss: 0.640 Vali Loss: 0.669 Vali Acc: 0.889 Test Loss: 0.669 Test Acc: 0.889
Validation loss decreased (-0.885177 --> -0.888882).  Saving model ...
Epoch: 11 cost time: 0.6986360549926758
Epoch: 11, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.569 Vali Acc: 0.915 Test Loss: 0.569 Test Acc: 0.915
Validation loss decreased (-0.888882 --> -0.914809).  Saving model ...
Epoch: 12 cost time: 0.6265778541564941
Epoch: 12, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.487 Vali Acc: 0.926 Test Loss: 0.487 Test Acc: 0.926
Validation loss decreased (-0.914809 --> -0.925921).  Saving model ...
Epoch: 13 cost time: 0.6527993679046631
Epoch: 13, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.422 Vali Acc: 0.944 Test Loss: 0.422 Test Acc: 0.944
Validation loss decreased (-0.925921 --> -0.944440).  Saving model ...
Epoch: 14 cost time: 0.6329007148742676
Epoch: 14, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.366 Vali Acc: 0.944 Test Loss: 0.366 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.5870208740234375
Epoch: 15, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.322 Vali Acc: 0.941 Test Loss: 0.322 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6262905597686768
Epoch: 16, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.736069917678833
Epoch: 17, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5705914497375488
Epoch: 18, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7214927673339844
Epoch: 19, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5862267017364502
Epoch: 20, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5957961082458496
Epoch: 21, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.5548546314239502
Epoch: 22, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5020511150360107
Epoch: 23, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5477426052093506
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6529967784881592
Epoch: 25, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6045346260070801
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6642851829528809
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.49750232696533203
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6153314113616943
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6546995639801025
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6132514476776123
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.926 Test Loss: 0.188 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 92102
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1688313484191895
Epoch: 1, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.773 Vali Acc: 0.178 Test Loss: 1.773 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.4776885509490967
Epoch: 2, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.704 Vali Acc: 0.241 Test Loss: 1.704 Test Acc: 0.241
Validation loss decreased (-0.177760 --> -0.240724).  Saving model ...
Epoch: 3 cost time: 0.4924616813659668
Epoch: 3, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.642 Vali Acc: 0.333 Test Loss: 1.642 Test Acc: 0.333
Validation loss decreased (-0.240724 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 0.5057778358459473
Epoch: 4, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.567 Vali Acc: 0.407 Test Loss: 1.567 Test Acc: 0.407
Validation loss decreased (-0.333317 --> -0.407392).  Saving model ...
Epoch: 5 cost time: 0.564622163772583
Epoch: 5, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.474 Vali Acc: 0.537 Test Loss: 1.474 Test Acc: 0.537
Validation loss decreased (-0.407392 --> -0.537022).  Saving model ...
Epoch: 6 cost time: 0.5449388027191162
Epoch: 6, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.371 Vali Acc: 0.604 Test Loss: 1.371 Test Acc: 0.604
Validation loss decreased (-0.537022 --> -0.603690).  Saving model ...
Epoch: 7 cost time: 0.5063254833221436
Epoch: 7, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.262 Vali Acc: 0.648 Test Loss: 1.262 Test Acc: 0.648
Validation loss decreased (-0.603690 --> -0.648136).  Saving model ...
Epoch: 8 cost time: 0.5233283042907715
Epoch: 8, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.153 Vali Acc: 0.685 Test Loss: 1.153 Test Acc: 0.685
Validation loss decreased (-0.648136 --> -0.685174).  Saving model ...
Epoch: 9 cost time: 0.5543866157531738
Epoch: 9, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.049 Vali Acc: 0.715 Test Loss: 1.049 Test Acc: 0.715
Validation loss decreased (-0.685174 --> -0.714804).  Saving model ...
Epoch: 10 cost time: 0.5105676651000977
Epoch: 10, Steps: 2 | Train Loss: 1.005 Vali Loss: 0.952 Vali Acc: 0.741 Test Loss: 0.952 Test Acc: 0.741
Validation loss decreased (-0.714804 --> -0.740731).  Saving model ...
Epoch: 11 cost time: 0.5313282012939453
Epoch: 11, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.863 Vali Acc: 0.785 Test Loss: 0.863 Test Acc: 0.785
Validation loss decreased (-0.740731 --> -0.785177).  Saving model ...
Epoch: 12 cost time: 0.5773317813873291
Epoch: 12, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.780 Vali Acc: 0.819 Test Loss: 0.780 Test Acc: 0.819
Validation loss decreased (-0.785177 --> -0.818511).  Saving model ...
Epoch: 13 cost time: 0.6993224620819092
Epoch: 13, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.708 Vali Acc: 0.841 Test Loss: 0.708 Test Acc: 0.841
Validation loss decreased (-0.818511 --> -0.840734).  Saving model ...
Epoch: 14 cost time: 0.6188087463378906
Epoch: 14, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.639 Vali Acc: 0.874 Test Loss: 0.639 Test Acc: 0.874
Validation loss decreased (-0.840734 --> -0.874068).  Saving model ...
Epoch: 15 cost time: 0.538872241973877
Epoch: 15, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.578 Vali Acc: 0.904 Test Loss: 0.578 Test Acc: 0.904
Validation loss decreased (-0.874068 --> -0.903698).  Saving model ...
Epoch: 16 cost time: 0.5531103610992432
Epoch: 16, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.525 Vali Acc: 0.907 Test Loss: 0.525 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 17 cost time: 0.5292830467224121
Epoch: 17, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6786730289459229
Epoch: 18, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.442 Vali Acc: 0.915 Test Loss: 0.442 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 19 cost time: 0.5904338359832764
Epoch: 19, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.407 Vali Acc: 0.922 Test Loss: 0.407 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 20 cost time: 0.533599853515625
Epoch: 20, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.374 Vali Acc: 0.922 Test Loss: 0.374 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 21 cost time: 0.5739231109619141
Epoch: 21, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.7115087509155273
Epoch: 22, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.321 Vali Acc: 0.926 Test Loss: 0.321 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 23 cost time: 0.6109554767608643
Epoch: 23, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6809322834014893
Epoch: 24, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6562714576721191
Epoch: 25, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.585747480392456
Epoch: 26, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 27 cost time: 0.6838300228118896
Epoch: 27, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5706779956817627
Epoch: 28, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.5888230800628662
Epoch: 29, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6290481090545654
Epoch: 30, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.5550353527069092
Epoch: 31, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 32 cost time: 0.5185611248016357
Epoch: 32, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.5381150245666504
Epoch: 33, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.5888104438781738
Epoch: 34, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.573472261428833
Epoch: 35, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.6182270050048828
Epoch: 36, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.5567102432250977
Epoch: 37, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.536017656326294
Epoch: 38, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.6024632453918457
Epoch: 39, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.52933669090271
Epoch: 40, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6150639057159424
Epoch: 41, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5240781307220459
Epoch: 42, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6599054336547852
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6121759414672852
Epoch: 44, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.575505256652832
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6022293567657471
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.4593665599822998
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.48875904083251953
Epoch: 48, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 66822
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1498172283172607
Epoch: 1, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.753 Vali Acc: 0.207 Test Loss: 1.753 Test Acc: 0.207
Validation loss decreased (inf --> -0.207390).  Saving model ...
Epoch: 2 cost time: 0.4944486618041992
Epoch: 2, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.704 Vali Acc: 0.222 Test Loss: 1.704 Test Acc: 0.222
Validation loss decreased (-0.207390 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 0.548314094543457
Epoch: 3, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.660 Vali Acc: 0.237 Test Loss: 1.660 Test Acc: 0.237
Validation loss decreased (-0.222205 --> -0.237020).  Saving model ...
Epoch: 4 cost time: 0.5821652412414551
Epoch: 4, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.608 Vali Acc: 0.285 Test Loss: 1.608 Test Acc: 0.285
Validation loss decreased (-0.237020 --> -0.285169).  Saving model ...
Epoch: 5 cost time: 0.49141645431518555
Epoch: 5, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.540 Vali Acc: 0.396 Test Loss: 1.540 Test Acc: 0.396
Validation loss decreased (-0.285169 --> -0.396281).  Saving model ...
Epoch: 6 cost time: 0.569077730178833
Epoch: 6, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.462 Vali Acc: 0.522 Test Loss: 1.462 Test Acc: 0.522
Validation loss decreased (-0.396281 --> -0.522208).  Saving model ...
Epoch: 7 cost time: 0.5063192844390869
Epoch: 7, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.376 Vali Acc: 0.570 Test Loss: 1.376 Test Acc: 0.570
Validation loss decreased (-0.522208 --> -0.570357).  Saving model ...
Epoch: 8 cost time: 0.48149776458740234
Epoch: 8, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.286 Vali Acc: 0.611 Test Loss: 1.286 Test Acc: 0.611
Validation loss decreased (-0.570357 --> -0.611098).  Saving model ...
Epoch: 9 cost time: 0.462615966796875
Epoch: 9, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.195 Vali Acc: 0.667 Test Loss: 1.195 Test Acc: 0.667
Validation loss decreased (-0.611098 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 0.5724804401397705
Epoch: 10, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.105 Vali Acc: 0.704 Test Loss: 1.105 Test Acc: 0.704
Validation loss decreased (-0.666655 --> -0.703693).  Saving model ...
Epoch: 11 cost time: 0.4733402729034424
Epoch: 11, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.020 Vali Acc: 0.763 Test Loss: 1.020 Test Acc: 0.763
Validation loss decreased (-0.703693 --> -0.762953).  Saving model ...
Epoch: 12 cost time: 0.6018664836883545
Epoch: 12, Steps: 2 | Train Loss: 0.919 Vali Loss: 0.943 Vali Acc: 0.781 Test Loss: 0.943 Test Acc: 0.781
Validation loss decreased (-0.762953 --> -0.781472).  Saving model ...
Epoch: 13 cost time: 0.6039369106292725
Epoch: 13, Steps: 2 | Train Loss: 0.918 Vali Loss: 0.871 Vali Acc: 0.815 Test Loss: 0.871 Test Acc: 0.815
Validation loss decreased (-0.781472 --> -0.814806).  Saving model ...
Epoch: 14 cost time: 0.6214025020599365
Epoch: 14, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.805 Vali Acc: 0.826 Test Loss: 0.805 Test Acc: 0.826
Validation loss decreased (-0.814806 --> -0.825918).  Saving model ...
Epoch: 15 cost time: 0.5311694145202637
Epoch: 15, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.745 Vali Acc: 0.830 Test Loss: 0.745 Test Acc: 0.830
Validation loss decreased (-0.825918 --> -0.829622).  Saving model ...
Epoch: 16 cost time: 0.5105171203613281
Epoch: 16, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.688 Vali Acc: 0.844 Test Loss: 0.688 Test Acc: 0.844
Validation loss decreased (-0.829622 --> -0.844438).  Saving model ...
Epoch: 17 cost time: 0.5765748023986816
Epoch: 17, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.636 Vali Acc: 0.856 Test Loss: 0.636 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 18 cost time: 0.5844829082489014
Epoch: 18, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.587 Vali Acc: 0.859 Test Loss: 0.587 Test Acc: 0.859
Validation loss decreased (-0.855549 --> -0.859253).  Saving model ...
Epoch: 19 cost time: 0.6008305549621582
Epoch: 19, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
Validation loss decreased (-0.859253 --> -0.870365).  Saving model ...
Epoch: 20 cost time: 0.5195779800415039
Epoch: 20, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.499 Vali Acc: 0.885 Test Loss: 0.499 Test Acc: 0.885
Validation loss decreased (-0.870365 --> -0.885180).  Saving model ...
Epoch: 21 cost time: 0.567690372467041
Epoch: 21, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.459 Vali Acc: 0.911 Test Loss: 0.459 Test Acc: 0.911
Validation loss decreased (-0.885180 --> -0.911107).  Saving model ...
Epoch: 22 cost time: 0.5351085662841797
Epoch: 22, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.422 Vali Acc: 0.907 Test Loss: 0.422 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5777585506439209
Epoch: 23, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.392 Vali Acc: 0.919 Test Loss: 0.392 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 24 cost time: 0.6382057666778564
Epoch: 24, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.366 Vali Acc: 0.922 Test Loss: 0.366 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 25 cost time: 0.5749328136444092
Epoch: 25, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.343 Vali Acc: 0.930 Test Loss: 0.343 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929626).  Saving model ...
Epoch: 26 cost time: 0.52024245262146
Epoch: 26, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.322 Vali Acc: 0.933 Test Loss: 0.322 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 27 cost time: 0.55000901222229
Epoch: 27, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6970951557159424
Epoch: 28, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 29 cost time: 0.5041470527648926
Epoch: 29, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.5834517478942871
Epoch: 30, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5594432353973389
Epoch: 31, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4785592555999756
Epoch: 32, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5048165321350098
Epoch: 33, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5665287971496582
Epoch: 34, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5974810123443604
Epoch: 35, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.49591732025146484
Epoch: 36, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.232 Vali Acc: 0.919 Test Loss: 0.232 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5677838325500488
Epoch: 37, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5529935359954834
Epoch: 38, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5289580821990967
Epoch: 39, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 59174
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0347301959991455
Epoch: 1, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.777 Vali Acc: 0.107 Test Loss: 1.777 Test Acc: 0.107
Validation loss decreased (inf --> -0.107390).  Saving model ...
Epoch: 2 cost time: 0.5328590869903564
Epoch: 2, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.736 Vali Acc: 0.141 Test Loss: 1.736 Test Acc: 0.141
Validation loss decreased (-0.107390 --> -0.140723).  Saving model ...
Epoch: 3 cost time: 0.5072238445281982
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.701 Vali Acc: 0.159 Test Loss: 1.701 Test Acc: 0.159
Validation loss decreased (-0.140723 --> -0.159242).  Saving model ...
Epoch: 4 cost time: 0.5656702518463135
Epoch: 4, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.662 Vali Acc: 0.181 Test Loss: 1.662 Test Acc: 0.181
Validation loss decreased (-0.159242 --> -0.181465).  Saving model ...
Epoch: 5 cost time: 0.5423421859741211
Epoch: 5, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.613 Vali Acc: 0.248 Test Loss: 1.613 Test Acc: 0.248
Validation loss decreased (-0.181465 --> -0.248132).  Saving model ...
Epoch: 6 cost time: 0.647636890411377
Epoch: 6, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.554 Vali Acc: 0.389 Test Loss: 1.554 Test Acc: 0.389
Validation loss decreased (-0.248132 --> -0.388873).  Saving model ...
Epoch: 7 cost time: 0.533257007598877
Epoch: 7, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.491 Vali Acc: 0.496 Test Loss: 1.491 Test Acc: 0.496
Validation loss decreased (-0.388873 --> -0.496281).  Saving model ...
Epoch: 8 cost time: 0.5141074657440186
Epoch: 8, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.421 Vali Acc: 0.552 Test Loss: 1.421 Test Acc: 0.552
Validation loss decreased (-0.496281 --> -0.551838).  Saving model ...
Epoch: 9 cost time: 0.6122598648071289
Epoch: 9, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.349 Vali Acc: 0.633 Test Loss: 1.349 Test Acc: 0.633
Validation loss decreased (-0.551838 --> -0.633320).  Saving model ...
Epoch: 10 cost time: 0.5762233734130859
Epoch: 10, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.273 Vali Acc: 0.685 Test Loss: 1.273 Test Acc: 0.685
Validation loss decreased (-0.633320 --> -0.685172).  Saving model ...
Epoch: 11 cost time: 0.559455156326294
Epoch: 11, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.197 Vali Acc: 0.719 Test Loss: 1.197 Test Acc: 0.719
Validation loss decreased (-0.685172 --> -0.718507).  Saving model ...
Epoch: 12 cost time: 0.4912097454071045
Epoch: 12, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.122 Vali Acc: 0.759 Test Loss: 1.122 Test Acc: 0.759
Validation loss decreased (-0.718507 --> -0.759248).  Saving model ...
Epoch: 13 cost time: 0.5901520252227783
Epoch: 13, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.049 Vali Acc: 0.781 Test Loss: 1.049 Test Acc: 0.781
Validation loss decreased (-0.759248 --> -0.781471).  Saving model ...
Epoch: 14 cost time: 0.4645814895629883
Epoch: 14, Steps: 2 | Train Loss: 1.037 Vali Loss: 0.980 Vali Acc: 0.793 Test Loss: 0.980 Test Acc: 0.793
Validation loss decreased (-0.781471 --> -0.792583).  Saving model ...
Epoch: 15 cost time: 0.6283431053161621
Epoch: 15, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.914 Vali Acc: 0.800 Test Loss: 0.914 Test Acc: 0.800
Validation loss decreased (-0.792583 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 0.560171365737915
Epoch: 16, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.852 Vali Acc: 0.822 Test Loss: 0.852 Test Acc: 0.822
Validation loss decreased (-0.799991 --> -0.822214).  Saving model ...
Epoch: 17 cost time: 0.6734714508056641
Epoch: 17, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.791 Vali Acc: 0.841 Test Loss: 0.791 Test Acc: 0.841
Validation loss decreased (-0.822214 --> -0.840733).  Saving model ...
Epoch: 18 cost time: 0.631458044052124
Epoch: 18, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.736 Vali Acc: 0.863 Test Loss: 0.736 Test Acc: 0.863
Validation loss decreased (-0.840733 --> -0.862956).  Saving model ...
Epoch: 19 cost time: 0.5231666564941406
Epoch: 19, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.686 Vali Acc: 0.874 Test Loss: 0.686 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874067).  Saving model ...
Epoch: 20 cost time: 0.49303698539733887
Epoch: 20, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.638 Vali Acc: 0.881 Test Loss: 0.638 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881475).  Saving model ...
Epoch: 21 cost time: 0.6090347766876221
Epoch: 21, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.594 Vali Acc: 0.881 Test Loss: 0.594 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 22 cost time: 0.5883665084838867
Epoch: 22, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.553 Vali Acc: 0.915 Test Loss: 0.553 Test Acc: 0.915
Validation loss decreased (-0.881476 --> -0.914809).  Saving model ...
Epoch: 23 cost time: 0.5310814380645752
Epoch: 23, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.516 Vali Acc: 0.919 Test Loss: 0.516 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 0.5631170272827148
Epoch: 24, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.483 Vali Acc: 0.926 Test Loss: 0.483 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 25 cost time: 0.5747628211975098
Epoch: 25, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.451 Vali Acc: 0.922 Test Loss: 0.451 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.613520622253418
Epoch: 26, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.424 Vali Acc: 0.930 Test Loss: 0.424 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 27 cost time: 0.598839521408081
Epoch: 27, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.401 Vali Acc: 0.926 Test Loss: 0.401 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6120765209197998
Epoch: 28, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.380 Vali Acc: 0.922 Test Loss: 0.380 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5562937259674072
Epoch: 29, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.361 Vali Acc: 0.919 Test Loss: 0.361 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5585658550262451
Epoch: 30, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.344 Vali Acc: 0.919 Test Loss: 0.344 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.48078322410583496
Epoch: 31, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4969809055328369
Epoch: 32, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5892312526702881
Epoch: 33, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6269104480743408
Epoch: 34, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5009360313415527
Epoch: 35, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.5413904190063477
Epoch: 36, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 37 cost time: 0.6601216793060303
Epoch: 37, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 38 cost time: 0.5354518890380859
Epoch: 38, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 0.5464820861816406
Epoch: 39, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.5512583255767822
Epoch: 40, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.5838243961334229
Epoch: 41, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.5758881568908691
Epoch: 42, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.552323579788208
Epoch: 43, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.5299074649810791
Epoch: 44, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.5704731941223145
Epoch: 45, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.5227890014648438
Epoch: 46, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.6015241146087646
Epoch: 47, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.5554330348968506
Epoch: 48, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5983402729034424
Epoch: 49, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5919616222381592
Epoch: 50, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5388128757476807
Epoch: 51, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.55428147315979
Epoch: 52, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.55523681640625
Epoch: 53, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6009182929992676
Epoch: 54, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6433839797973633
Epoch: 55, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.5837082862854004
Epoch: 56, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.5438838005065918
Epoch: 57, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 54630
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1793441772460938
Epoch: 1, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.753 Vali Acc: 0.381 Test Loss: 1.753 Test Acc: 0.381
Validation loss decreased (inf --> -0.381464).  Saving model ...
Epoch: 2 cost time: 0.5570204257965088
Epoch: 2, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.692 Vali Acc: 0.411 Test Loss: 1.692 Test Acc: 0.411
Validation loss decreased (-0.381464 --> -0.411094).  Saving model ...
Epoch: 3 cost time: 0.4877440929412842
Epoch: 3, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.644 Vali Acc: 0.430 Test Loss: 1.644 Test Acc: 0.430
Validation loss decreased (-0.411094 --> -0.429613).  Saving model ...
Epoch: 4 cost time: 0.47278451919555664
Epoch: 4, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.599 Vali Acc: 0.437 Test Loss: 1.599 Test Acc: 0.437
Validation loss decreased (-0.429613 --> -0.437021).  Saving model ...
Epoch: 5 cost time: 0.4978799819946289
Epoch: 5, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.548 Vali Acc: 0.441 Test Loss: 1.548 Test Acc: 0.441
Validation loss decreased (-0.437021 --> -0.440725).  Saving model ...
Epoch: 6 cost time: 0.5172662734985352
Epoch: 6, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.493 Vali Acc: 0.448 Test Loss: 1.493 Test Acc: 0.448
Validation loss decreased (-0.440725 --> -0.448133).  Saving model ...
Epoch: 7 cost time: 0.5442194938659668
Epoch: 7, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.434 Vali Acc: 0.467 Test Loss: 1.434 Test Acc: 0.467
Validation loss decreased (-0.448133 --> -0.466652).  Saving model ...
Epoch: 8 cost time: 0.5225083827972412
Epoch: 8, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.371 Vali Acc: 0.519 Test Loss: 1.371 Test Acc: 0.519
Validation loss decreased (-0.466652 --> -0.518505).  Saving model ...
Epoch: 9 cost time: 0.5139200687408447
Epoch: 9, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.306 Vali Acc: 0.585 Test Loss: 1.306 Test Acc: 0.585
Validation loss decreased (-0.518505 --> -0.585172).  Saving model ...
Epoch: 10 cost time: 0.5588090419769287
Epoch: 10, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.240 Vali Acc: 0.670 Test Loss: 1.240 Test Acc: 0.670
Validation loss decreased (-0.585172 --> -0.670358).  Saving model ...
Epoch: 11 cost time: 0.5396416187286377
Epoch: 11, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.172 Vali Acc: 0.689 Test Loss: 1.172 Test Acc: 0.689
Validation loss decreased (-0.670358 --> -0.688877).  Saving model ...
Epoch: 12 cost time: 0.5074729919433594
Epoch: 12, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.106 Vali Acc: 0.700 Test Loss: 1.106 Test Acc: 0.700
Validation loss decreased (-0.688877 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.5219149589538574
Epoch: 13, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.041 Vali Acc: 0.730 Test Loss: 1.041 Test Acc: 0.730
Validation loss decreased (-0.699989 --> -0.729619).  Saving model ...
Epoch: 14 cost time: 0.6052525043487549
Epoch: 14, Steps: 2 | Train Loss: 0.977 Vali Loss: 0.980 Vali Acc: 0.767 Test Loss: 0.980 Test Acc: 0.767
Validation loss decreased (-0.729619 --> -0.766657).  Saving model ...
Epoch: 15 cost time: 0.4988217353820801
Epoch: 15, Steps: 2 | Train Loss: 0.932 Vali Loss: 0.921 Vali Acc: 0.774 Test Loss: 0.921 Test Acc: 0.774
Validation loss decreased (-0.766657 --> -0.774065).  Saving model ...
Epoch: 16 cost time: 0.4993572235107422
Epoch: 16, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.864 Vali Acc: 0.796 Test Loss: 0.864 Test Acc: 0.796
Validation loss decreased (-0.774065 --> -0.796288).  Saving model ...
Epoch: 17 cost time: 0.48523378372192383
Epoch: 17, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.810 Vali Acc: 0.826 Test Loss: 0.810 Test Acc: 0.826
Validation loss decreased (-0.796288 --> -0.825918).  Saving model ...
Epoch: 18 cost time: 0.5417914390563965
Epoch: 18, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.760 Vali Acc: 0.833 Test Loss: 0.760 Test Acc: 0.833
Validation loss decreased (-0.825918 --> -0.833326).  Saving model ...
Epoch: 19 cost time: 0.5508875846862793
Epoch: 19, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.713 Vali Acc: 0.863 Test Loss: 0.713 Test Acc: 0.863
Validation loss decreased (-0.833326 --> -0.862956).  Saving model ...
Epoch: 20 cost time: 0.5483660697937012
Epoch: 20, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.670 Vali Acc: 0.878 Test Loss: 0.670 Test Acc: 0.878
Validation loss decreased (-0.862956 --> -0.877771).  Saving model ...
Epoch: 21 cost time: 0.4387655258178711
Epoch: 21, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.631 Vali Acc: 0.889 Test Loss: 0.631 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888883).  Saving model ...
Epoch: 22 cost time: 0.435347318649292
Epoch: 22, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.595 Vali Acc: 0.893 Test Loss: 0.595 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 23 cost time: 0.5663909912109375
Epoch: 23, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.559 Vali Acc: 0.896 Test Loss: 0.559 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 24 cost time: 0.5496668815612793
Epoch: 24, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 0.5504100322723389
Epoch: 25, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.498 Vali Acc: 0.904 Test Loss: 0.498 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 26 cost time: 0.5217640399932861
Epoch: 26, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.470 Vali Acc: 0.907 Test Loss: 0.470 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 27 cost time: 0.5464587211608887
Epoch: 27, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.445 Vali Acc: 0.907 Test Loss: 0.445 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 28 cost time: 0.4961845874786377
Epoch: 28, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.421 Vali Acc: 0.919 Test Loss: 0.421 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918514).  Saving model ...
Epoch: 29 cost time: 0.5628201961517334
Epoch: 29, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.400 Vali Acc: 0.915 Test Loss: 0.400 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5926318168640137
Epoch: 30, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.380 Vali Acc: 0.919 Test Loss: 0.380 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 31 cost time: 0.4764125347137451
Epoch: 31, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.363 Vali Acc: 0.922 Test Loss: 0.363 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 32 cost time: 0.4860379695892334
Epoch: 32, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.348 Vali Acc: 0.926 Test Loss: 0.348 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925922).  Saving model ...
Epoch: 33 cost time: 0.5799679756164551
Epoch: 33, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.334 Vali Acc: 0.930 Test Loss: 0.334 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 34 cost time: 0.5028948783874512
Epoch: 34, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.321 Vali Acc: 0.930 Test Loss: 0.321 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 35 cost time: 0.5108242034912109
Epoch: 35, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.310 Vali Acc: 0.933 Test Loss: 0.310 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 36 cost time: 0.5552065372467041
Epoch: 36, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 0.5386693477630615
Epoch: 37, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 38 cost time: 0.5636823177337646
Epoch: 38, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5139994621276855
Epoch: 39, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6165530681610107
Epoch: 40, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6112866401672363
Epoch: 41, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5183272361755371
Epoch: 42, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5100271701812744
Epoch: 43, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5037133693695068
Epoch: 44, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5514416694641113
Epoch: 45, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5329644680023193
Epoch: 46, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.4916374683380127
Epoch: 47, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 52422
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.224597454071045
Epoch: 1, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.930 Vali Acc: 0.204 Test Loss: 1.930 Test Acc: 0.204
Validation loss decreased (inf --> -0.203684).  Saving model ...
Epoch: 2 cost time: 0.6215713024139404
Epoch: 2, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.868 Vali Acc: 0.226 Test Loss: 1.868 Test Acc: 0.226
Validation loss decreased (-0.203684 --> -0.225907).  Saving model ...
Epoch: 3 cost time: 0.6086738109588623
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.822 Vali Acc: 0.237 Test Loss: 1.822 Test Acc: 0.237
Validation loss decreased (-0.225907 --> -0.237019).  Saving model ...
Epoch: 4 cost time: 0.634730339050293
Epoch: 4, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.782 Vali Acc: 0.244 Test Loss: 1.782 Test Acc: 0.244
Validation loss decreased (-0.237019 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 0.5771992206573486
Epoch: 5, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.737 Vali Acc: 0.259 Test Loss: 1.737 Test Acc: 0.259
Validation loss decreased (-0.244427 --> -0.259242).  Saving model ...
Epoch: 6 cost time: 0.58194899559021
Epoch: 6, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.687 Vali Acc: 0.270 Test Loss: 1.687 Test Acc: 0.270
Validation loss decreased (-0.259242 --> -0.270354).  Saving model ...
Epoch: 7 cost time: 0.6112523078918457
Epoch: 7, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.632 Vali Acc: 0.304 Test Loss: 1.632 Test Acc: 0.304
Validation loss decreased (-0.270354 --> -0.303687).  Saving model ...
Epoch: 8 cost time: 0.600827693939209
Epoch: 8, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.574 Vali Acc: 0.396 Test Loss: 1.574 Test Acc: 0.396
Validation loss decreased (-0.303687 --> -0.396281).  Saving model ...
Epoch: 9 cost time: 0.49913907051086426
Epoch: 9, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.514 Vali Acc: 0.467 Test Loss: 1.514 Test Acc: 0.467
Validation loss decreased (-0.396281 --> -0.466652).  Saving model ...
Epoch: 10 cost time: 0.563490629196167
Epoch: 10, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.452 Vali Acc: 0.533 Test Loss: 1.452 Test Acc: 0.533
Validation loss decreased (-0.466652 --> -0.533319).  Saving model ...
Epoch: 11 cost time: 0.5956459045410156
Epoch: 11, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.390 Vali Acc: 0.574 Test Loss: 1.390 Test Acc: 0.574
Validation loss decreased (-0.533319 --> -0.574060).  Saving model ...
Epoch: 12 cost time: 0.5766363143920898
Epoch: 12, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.327 Vali Acc: 0.615 Test Loss: 1.327 Test Acc: 0.615
Validation loss decreased (-0.574060 --> -0.614802).  Saving model ...
Epoch: 13 cost time: 0.5881671905517578
Epoch: 13, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.265 Vali Acc: 0.652 Test Loss: 1.265 Test Acc: 0.652
Validation loss decreased (-0.614802 --> -0.651839).  Saving model ...
Epoch: 14 cost time: 0.5372917652130127
Epoch: 14, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.202 Vali Acc: 0.681 Test Loss: 1.202 Test Acc: 0.681
Validation loss decreased (-0.651839 --> -0.681469).  Saving model ...
Epoch: 15 cost time: 0.5214624404907227
Epoch: 15, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.142 Vali Acc: 0.700 Test Loss: 1.142 Test Acc: 0.700
Validation loss decreased (-0.681469 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.5957586765289307
Epoch: 16, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.084 Vali Acc: 0.722 Test Loss: 1.084 Test Acc: 0.722
Validation loss decreased (-0.699989 --> -0.722211).  Saving model ...
Epoch: 17 cost time: 0.5548954010009766
Epoch: 17, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
Validation loss decreased (-0.722211 --> -0.733323).  Saving model ...
Epoch: 18 cost time: 0.5100886821746826
Epoch: 18, Steps: 2 | Train Loss: 1.026 Vali Loss: 0.972 Vali Acc: 0.752 Test Loss: 0.972 Test Acc: 0.752
Validation loss decreased (-0.733323 --> -0.751842).  Saving model ...
Epoch: 19 cost time: 0.5778131484985352
Epoch: 19, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.919 Vali Acc: 0.789 Test Loss: 0.919 Test Acc: 0.789
Validation loss decreased (-0.751842 --> -0.788880).  Saving model ...
Epoch: 20 cost time: 0.5341923236846924
Epoch: 20, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.5988724231719971
Epoch: 21, Steps: 2 | Train Loss: 0.864 Vali Loss: 0.817 Vali Acc: 0.822 Test Loss: 0.817 Test Acc: 0.822
Validation loss decreased (-0.799991 --> -0.822214).  Saving model ...
Epoch: 22 cost time: 0.588756799697876
Epoch: 22, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.770 Vali Acc: 0.837 Test Loss: 0.770 Test Acc: 0.837
Validation loss decreased (-0.822214 --> -0.837029).  Saving model ...
Epoch: 23 cost time: 0.551771879196167
Epoch: 23, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.726 Vali Acc: 0.852 Test Loss: 0.726 Test Acc: 0.852
Validation loss decreased (-0.837029 --> -0.851845).  Saving model ...
Epoch: 24 cost time: 0.6026136875152588
Epoch: 24, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.685 Vali Acc: 0.863 Test Loss: 0.685 Test Acc: 0.863
Validation loss decreased (-0.851845 --> -0.862956).  Saving model ...
Epoch: 25 cost time: 0.5460970401763916
Epoch: 25, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.647 Vali Acc: 0.885 Test Loss: 0.647 Test Acc: 0.885
Validation loss decreased (-0.862956 --> -0.885179).  Saving model ...
Epoch: 26 cost time: 0.5487997531890869
Epoch: 26, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.611 Vali Acc: 0.896 Test Loss: 0.611 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896290).  Saving model ...
Epoch: 27 cost time: 0.5681469440460205
Epoch: 27, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.577 Vali Acc: 0.900 Test Loss: 0.577 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.5869450569152832
Epoch: 28, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.545 Vali Acc: 0.907 Test Loss: 0.545 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 29 cost time: 0.666283130645752
Epoch: 29, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.515 Vali Acc: 0.911 Test Loss: 0.515 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 30 cost time: 0.5194246768951416
Epoch: 30, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.489 Vali Acc: 0.919 Test Loss: 0.489 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 31 cost time: 0.7369928359985352
Epoch: 31, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.465 Vali Acc: 0.919 Test Loss: 0.465 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 32 cost time: 0.5645334720611572
Epoch: 32, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.444 Vali Acc: 0.915 Test Loss: 0.444 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5531933307647705
Epoch: 33, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.424 Vali Acc: 0.911 Test Loss: 0.424 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6213369369506836
Epoch: 34, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.405 Vali Acc: 0.911 Test Loss: 0.405 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5366833209991455
Epoch: 35, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.389 Vali Acc: 0.911 Test Loss: 0.389 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5471911430358887
Epoch: 36, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.374 Vali Acc: 0.915 Test Loss: 0.374 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6649210453033447
Epoch: 37, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.361 Vali Acc: 0.919 Test Loss: 0.361 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 38 cost time: 0.49916863441467285
Epoch: 38, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.349 Vali Acc: 0.915 Test Loss: 0.349 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7059643268585205
Epoch: 39, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.338 Vali Acc: 0.915 Test Loss: 0.338 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5809109210968018
Epoch: 40, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.329 Vali Acc: 0.915 Test Loss: 0.329 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5575721263885498
Epoch: 41, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.321 Vali Acc: 0.915 Test Loss: 0.321 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5921151638031006
Epoch: 42, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.314 Vali Acc: 0.919 Test Loss: 0.314 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 43 cost time: 0.5751962661743164
Epoch: 43, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 44 cost time: 0.4936866760253906
Epoch: 44, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 45 cost time: 0.49890613555908203
Epoch: 45, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 46 cost time: 0.5360751152038574
Epoch: 46, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.293 Vali Acc: 0.915 Test Loss: 0.293 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6500370502471924
Epoch: 47, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 48 cost time: 0.5823118686676025
Epoch: 48, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.286 Vali Acc: 0.919 Test Loss: 0.286 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 49 cost time: 0.5802280902862549
Epoch: 49, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.283 Vali Acc: 0.919 Test Loss: 0.283 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 50 cost time: 0.5350017547607422
Epoch: 50, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.280 Vali Acc: 0.919 Test Loss: 0.280 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 51 cost time: 0.5583138465881348
Epoch: 51, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.276 Vali Acc: 0.919 Test Loss: 0.276 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 52 cost time: 0.5925898551940918
Epoch: 52, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 53 cost time: 0.6280362606048584
Epoch: 53, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 54 cost time: 0.6003823280334473
Epoch: 54, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 55 cost time: 0.5359692573547363
Epoch: 55, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 56 cost time: 0.5059912204742432
Epoch: 56, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 57 cost time: 0.5388579368591309
Epoch: 57, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 58 cost time: 0.6069419384002686
Epoch: 58, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 59 cost time: 0.696129560470581
Epoch: 59, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 60 cost time: 0.5967063903808594
Epoch: 60, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 61 cost time: 0.6072022914886475
Epoch: 61, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 62 cost time: 0.54498291015625
Epoch: 62, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.246 Vali Acc: 0.926 Test Loss: 0.246 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 63 cost time: 0.5547666549682617
Epoch: 63, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 64 cost time: 0.6502988338470459
Epoch: 64, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 65 cost time: 0.5075666904449463
Epoch: 65, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 66 cost time: 0.571631908416748
Epoch: 66, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6240267753601074
Epoch: 67, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5925345420837402
Epoch: 68, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.7566483020782471
Epoch: 69, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.6547658443450928
Epoch: 70, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.6968014240264893
Epoch: 71, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.6707382202148438
Epoch: 72, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.6298060417175293
Epoch: 73, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 74 cost time: 0.5846617221832275
Epoch: 74, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 75 cost time: 0.6366560459136963
Epoch: 75, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 76 cost time: 0.5815215110778809
Epoch: 76, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 77 cost time: 0.6423630714416504
Epoch: 77, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 78 cost time: 0.6422374248504639
Epoch: 78, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 79 cost time: 0.6570262908935547
Epoch: 79, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 80 cost time: 0.6981918811798096
Epoch: 80, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 81 cost time: 0.702897310256958
Epoch: 81, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 82 cost time: 0.6249315738677979
Epoch: 82, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 83 cost time: 0.653174877166748
Epoch: 83, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 84 cost time: 0.624962329864502
Epoch: 84, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 85 cost time: 0.5588850975036621
Epoch: 85, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.225 Vali Acc: 0.926 Test Loss: 0.225 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 86 cost time: 0.5876100063323975
Epoch: 86, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.225 Vali Acc: 0.926 Test Loss: 0.225 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 87 cost time: 0.6645426750183105
Epoch: 87, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 88 cost time: 0.5902338027954102
Epoch: 88, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 89 cost time: 0.647068977355957
Epoch: 89, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 90 cost time: 0.6093757152557373
Epoch: 90, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 91 cost time: 0.5603902339935303
Epoch: 91, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 92 cost time: 0.6079728603363037
Epoch: 92, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 93 cost time: 0.6833431720733643
Epoch: 93, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 94 cost time: 0.5940167903900146
Epoch: 94, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 95 cost time: 0.7310044765472412
Epoch: 95, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 96 cost time: 0.6791791915893555
Epoch: 96, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 97 cost time: 0.5974526405334473
Epoch: 97, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 98 cost time: 0.7135944366455078
Epoch: 98, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 99 cost time: 0.6595847606658936
Epoch: 99, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 100 cost time: 0.6257503032684326
Epoch: 100, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 49446
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2335760593414307
Epoch: 1, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.949 Vali Acc: 0.111 Test Loss: 1.949 Test Acc: 0.111
Validation loss decreased (inf --> -0.111092).  Saving model ...
Epoch: 2 cost time: 0.6541450023651123
Epoch: 2, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.901 Vali Acc: 0.119 Test Loss: 1.901 Test Acc: 0.119
Validation loss decreased (-0.111092 --> -0.118500).  Saving model ...
Epoch: 3 cost time: 0.5177347660064697
Epoch: 3, Steps: 2 | Train Loss: 1.911 Vali Loss: 1.864 Vali Acc: 0.141 Test Loss: 1.864 Test Acc: 0.141
Validation loss decreased (-0.118500 --> -0.140722).  Saving model ...
Epoch: 4 cost time: 0.5681073665618896
Epoch: 4, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.834 Vali Acc: 0.204 Test Loss: 1.834 Test Acc: 0.204
Validation loss decreased (-0.140722 --> -0.203685).  Saving model ...
Epoch: 5 cost time: 0.4895040988922119
Epoch: 5, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.800 Vali Acc: 0.241 Test Loss: 1.800 Test Acc: 0.241
Validation loss decreased (-0.203685 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 0.533261775970459
Epoch: 6, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.762 Vali Acc: 0.278 Test Loss: 1.762 Test Acc: 0.278
Validation loss decreased (-0.240723 --> -0.277760).  Saving model ...
Epoch: 7 cost time: 0.534630537033081
Epoch: 7, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.722 Vali Acc: 0.304 Test Loss: 1.722 Test Acc: 0.304
Validation loss decreased (-0.277760 --> -0.303686).  Saving model ...
Epoch: 8 cost time: 0.5112807750701904
Epoch: 8, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.677 Vali Acc: 0.381 Test Loss: 1.677 Test Acc: 0.381
Validation loss decreased (-0.303686 --> -0.381465).  Saving model ...
Epoch: 9 cost time: 0.49492359161376953
Epoch: 9, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.630 Vali Acc: 0.441 Test Loss: 1.630 Test Acc: 0.441
Validation loss decreased (-0.381465 --> -0.440724).  Saving model ...
Epoch: 10 cost time: 0.47544121742248535
Epoch: 10, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.581 Vali Acc: 0.470 Test Loss: 1.581 Test Acc: 0.470
Validation loss decreased (-0.440724 --> -0.470355).  Saving model ...
Epoch: 11 cost time: 0.5103394985198975
Epoch: 11, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.529 Vali Acc: 0.515 Test Loss: 1.529 Test Acc: 0.515
Validation loss decreased (-0.470355 --> -0.514800).  Saving model ...
Epoch: 12 cost time: 0.5539202690124512
Epoch: 12, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.476 Vali Acc: 0.533 Test Loss: 1.476 Test Acc: 0.533
Validation loss decreased (-0.514800 --> -0.533319).  Saving model ...
Epoch: 13 cost time: 0.6979565620422363
Epoch: 13, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.423 Vali Acc: 0.563 Test Loss: 1.423 Test Acc: 0.563
Validation loss decreased (-0.533319 --> -0.562949).  Saving model ...
Epoch: 14 cost time: 0.6061351299285889
Epoch: 14, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.368 Vali Acc: 0.600 Test Loss: 1.368 Test Acc: 0.600
Validation loss decreased (-0.562949 --> -0.599986).  Saving model ...
Epoch: 15 cost time: 0.4996373653411865
Epoch: 15, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.314 Vali Acc: 0.626 Test Loss: 1.314 Test Acc: 0.626
Validation loss decreased (-0.599986 --> -0.625913).  Saving model ...
Epoch: 16 cost time: 0.5591127872467041
Epoch: 16, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.259 Vali Acc: 0.648 Test Loss: 1.259 Test Acc: 0.648
Validation loss decreased (-0.625913 --> -0.648136).  Saving model ...
Epoch: 17 cost time: 0.5915923118591309
Epoch: 17, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.206 Vali Acc: 0.659 Test Loss: 1.206 Test Acc: 0.659
Validation loss decreased (-0.648136 --> -0.659247).  Saving model ...
Epoch: 18 cost time: 0.5276045799255371
Epoch: 18, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.152 Vali Acc: 0.674 Test Loss: 1.152 Test Acc: 0.674
Validation loss decreased (-0.659247 --> -0.674063).  Saving model ...
Epoch: 19 cost time: 0.551882266998291
Epoch: 19, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.102 Vali Acc: 0.711 Test Loss: 1.102 Test Acc: 0.711
Validation loss decreased (-0.674063 --> -0.711100).  Saving model ...
Epoch: 20 cost time: 0.5107488632202148
Epoch: 20, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.052 Vali Acc: 0.715 Test Loss: 1.052 Test Acc: 0.715
Validation loss decreased (-0.711100 --> -0.714804).  Saving model ...
Epoch: 21 cost time: 0.7009508609771729
Epoch: 21, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.005 Vali Acc: 0.756 Test Loss: 1.005 Test Acc: 0.756
Validation loss decreased (-0.714804 --> -0.755546).  Saving model ...
Epoch: 22 cost time: 0.5284214019775391
Epoch: 22, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.957 Vali Acc: 0.785 Test Loss: 0.957 Test Acc: 0.785
Validation loss decreased (-0.755546 --> -0.785176).  Saving model ...
Epoch: 23 cost time: 0.6700682640075684
Epoch: 23, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.912 Vali Acc: 0.822 Test Loss: 0.912 Test Acc: 0.822
Validation loss decreased (-0.785176 --> -0.822213).  Saving model ...
Epoch: 24 cost time: 0.6077160835266113
Epoch: 24, Steps: 2 | Train Loss: 0.804 Vali Loss: 0.868 Vali Acc: 0.848 Test Loss: 0.868 Test Acc: 0.848
Validation loss decreased (-0.822213 --> -0.848139).  Saving model ...
Epoch: 25 cost time: 0.5738861560821533
Epoch: 25, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.825 Vali Acc: 0.870 Test Loss: 0.825 Test Acc: 0.870
Validation loss decreased (-0.848139 --> -0.870362).  Saving model ...
Epoch: 26 cost time: 0.492631196975708
Epoch: 26, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.785 Vali Acc: 0.889 Test Loss: 0.785 Test Acc: 0.889
Validation loss decreased (-0.870362 --> -0.888881).  Saving model ...
Epoch: 27 cost time: 0.5533478260040283
Epoch: 27, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.746 Vali Acc: 0.893 Test Loss: 0.746 Test Acc: 0.893
Validation loss decreased (-0.888881 --> -0.892585).  Saving model ...
Epoch: 28 cost time: 0.5378904342651367
Epoch: 28, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.711 Vali Acc: 0.893 Test Loss: 0.711 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892585).  Saving model ...
Epoch: 29 cost time: 0.4939603805541992
Epoch: 29, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.676 Vali Acc: 0.896 Test Loss: 0.676 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896290).  Saving model ...
Epoch: 30 cost time: 0.5525166988372803
Epoch: 30, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 31 cost time: 0.5538656711578369
Epoch: 31, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.611 Vali Acc: 0.904 Test Loss: 0.611 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 32 cost time: 0.5727946758270264
Epoch: 32, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.581 Vali Acc: 0.907 Test Loss: 0.581 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 33 cost time: 0.5098884105682373
Epoch: 33, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.553 Vali Acc: 0.915 Test Loss: 0.553 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914809).  Saving model ...
Epoch: 34 cost time: 0.5199825763702393
Epoch: 34, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.528 Vali Acc: 0.922 Test Loss: 0.528 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 35 cost time: 0.5125606060028076
Epoch: 35, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.505 Vali Acc: 0.926 Test Loss: 0.505 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 36 cost time: 0.5847156047821045
Epoch: 36, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.485 Vali Acc: 0.930 Test Loss: 0.485 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 37 cost time: 0.5332825183868408
Epoch: 37, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.465 Vali Acc: 0.933 Test Loss: 0.465 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 38 cost time: 0.6213877201080322
Epoch: 38, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.448 Vali Acc: 0.933 Test Loss: 0.448 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 0.5287573337554932
Epoch: 39, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.431 Vali Acc: 0.937 Test Loss: 0.431 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 40 cost time: 0.5223078727722168
Epoch: 40, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.416 Vali Acc: 0.937 Test Loss: 0.416 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 41 cost time: 0.5447850227355957
Epoch: 41, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.403 Vali Acc: 0.944 Test Loss: 0.403 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944440).  Saving model ...
Epoch: 42 cost time: 0.5821638107299805
Epoch: 42, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.391 Vali Acc: 0.944 Test Loss: 0.391 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 43 cost time: 0.580533504486084
Epoch: 43, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.379 Vali Acc: 0.944 Test Loss: 0.379 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 44 cost time: 0.5218899250030518
Epoch: 44, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.369 Vali Acc: 0.944 Test Loss: 0.369 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 45 cost time: 0.5599486827850342
Epoch: 45, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.359 Vali Acc: 0.944 Test Loss: 0.359 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 46 cost time: 0.5841460227966309
Epoch: 46, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.350 Vali Acc: 0.944 Test Loss: 0.350 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 47 cost time: 0.5143554210662842
Epoch: 47, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.342 Vali Acc: 0.941 Test Loss: 0.342 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7858664989471436
Epoch: 48, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.335 Vali Acc: 0.941 Test Loss: 0.335 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5644638538360596
Epoch: 49, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.328 Vali Acc: 0.941 Test Loss: 0.328 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.49654555320739746
Epoch: 50, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.322 Vali Acc: 0.937 Test Loss: 0.322 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6669278144836426
Epoch: 51, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.316 Vali Acc: 0.930 Test Loss: 0.316 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.570676326751709
Epoch: 52, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.49126219749450684
Epoch: 53, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.5399494171142578
Epoch: 54, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.5899498462677002
Epoch: 55, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.6253211498260498
Epoch: 56, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 48038
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.213489055633545
Epoch: 1, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.850 Vali Acc: 0.200 Test Loss: 1.850 Test Acc: 0.200
Validation loss decreased (inf --> -0.199981).  Saving model ...
Epoch: 2 cost time: 0.6618497371673584
Epoch: 2, Steps: 2 | Train Loss: 1.949 Vali Loss: 1.755 Vali Acc: 0.222 Test Loss: 1.755 Test Acc: 0.222
Validation loss decreased (-0.199981 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 0.703789472579956
Epoch: 3, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.656 Vali Acc: 0.281 Test Loss: 1.656 Test Acc: 0.281
Validation loss decreased (-0.222205 --> -0.281465).  Saving model ...
Epoch: 4 cost time: 0.6291959285736084
Epoch: 4, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.520 Vali Acc: 0.441 Test Loss: 1.520 Test Acc: 0.441
Validation loss decreased (-0.281465 --> -0.440726).  Saving model ...
Epoch: 5 cost time: 0.6833248138427734
Epoch: 5, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.366 Vali Acc: 0.604 Test Loss: 1.366 Test Acc: 0.604
Validation loss decreased (-0.440726 --> -0.603690).  Saving model ...
Epoch: 6 cost time: 0.5652506351470947
Epoch: 6, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.205 Vali Acc: 0.744 Test Loss: 1.205 Test Acc: 0.744
Validation loss decreased (-0.603690 --> -0.744432).  Saving model ...
Epoch: 7 cost time: 0.5863752365112305
Epoch: 7, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.052 Vali Acc: 0.796 Test Loss: 1.052 Test Acc: 0.796
Validation loss decreased (-0.744432 --> -0.796286).  Saving model ...
Epoch: 8 cost time: 0.5947265625
Epoch: 8, Steps: 2 | Train Loss: 0.915 Vali Loss: 0.908 Vali Acc: 0.848 Test Loss: 0.908 Test Acc: 0.848
Validation loss decreased (-0.796286 --> -0.848139).  Saving model ...
Epoch: 9 cost time: 0.5964922904968262
Epoch: 9, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.781 Vali Acc: 0.874 Test Loss: 0.781 Test Acc: 0.874
Validation loss decreased (-0.848139 --> -0.874066).  Saving model ...
Epoch: 10 cost time: 0.629539966583252
Epoch: 10, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.670 Vali Acc: 0.893 Test Loss: 0.670 Test Acc: 0.893
Validation loss decreased (-0.874066 --> -0.892586).  Saving model ...
Epoch: 11 cost time: 0.545447587966919
Epoch: 11, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.584 Vali Acc: 0.885 Test Loss: 0.584 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6450538635253906
Epoch: 12, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.518 Vali Acc: 0.889 Test Loss: 0.518 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6630291938781738
Epoch: 13, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.454 Vali Acc: 0.893 Test Loss: 0.454 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892588).  Saving model ...
Epoch: 14 cost time: 0.66353440284729
Epoch: 14, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.395 Vali Acc: 0.922 Test Loss: 0.395 Test Acc: 0.922
Validation loss decreased (-0.892588 --> -0.922218).  Saving model ...
Epoch: 15 cost time: 0.6156108379364014
Epoch: 15, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.344 Vali Acc: 0.941 Test Loss: 0.344 Test Acc: 0.941
Validation loss decreased (-0.922218 --> -0.940737).  Saving model ...
Epoch: 16 cost time: 0.6211550235748291
Epoch: 16, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.307 Vali Acc: 0.941 Test Loss: 0.307 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.5811543464660645
Epoch: 17, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5301761627197266
Epoch: 18, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5839264392852783
Epoch: 19, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.6802084445953369
Epoch: 20, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5839557647705078
Epoch: 21, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6593892574310303
Epoch: 22, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.668449878692627
Epoch: 23, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6275978088378906
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6082518100738525
Epoch: 25, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5494232177734375
Epoch: 26, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.6009693145751953
Epoch: 27, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5964136123657227
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5677697658538818
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5796627998352051
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7393641471862793
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.591050386428833
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6241374015808105
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5625739097595215
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5767862796783447
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5791182518005371
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 75462
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.101858615875244
Epoch: 1, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.769 Vali Acc: 0.289 Test Loss: 1.769 Test Acc: 0.289
Validation loss decreased (inf --> -0.288871).  Saving model ...
Epoch: 2 cost time: 0.5169069766998291
Epoch: 2, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.693 Vali Acc: 0.311 Test Loss: 1.693 Test Acc: 0.311
Validation loss decreased (-0.288871 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 0.5671863555908203
Epoch: 3, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.627 Vali Acc: 0.359 Test Loss: 1.627 Test Acc: 0.359
Validation loss decreased (-0.311094 --> -0.359243).  Saving model ...
Epoch: 4 cost time: 0.5823278427124023
Epoch: 4, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.551 Vali Acc: 0.441 Test Loss: 1.551 Test Acc: 0.441
Validation loss decreased (-0.359243 --> -0.440725).  Saving model ...
Epoch: 5 cost time: 0.5406098365783691
Epoch: 5, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.461 Vali Acc: 0.526 Test Loss: 1.461 Test Acc: 0.526
Validation loss decreased (-0.440725 --> -0.525911).  Saving model ...
Epoch: 6 cost time: 0.5235002040863037
Epoch: 6, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.367 Vali Acc: 0.574 Test Loss: 1.367 Test Acc: 0.574
Validation loss decreased (-0.525911 --> -0.574060).  Saving model ...
Epoch: 7 cost time: 0.6068556308746338
Epoch: 7, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.269 Vali Acc: 0.604 Test Loss: 1.269 Test Acc: 0.604
Validation loss decreased (-0.574060 --> -0.603691).  Saving model ...
Epoch: 8 cost time: 0.5165281295776367
Epoch: 8, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.169 Vali Acc: 0.659 Test Loss: 1.169 Test Acc: 0.659
Validation loss decreased (-0.603691 --> -0.659248).  Saving model ...
Epoch: 9 cost time: 0.6127853393554688
Epoch: 9, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.073 Vali Acc: 0.700 Test Loss: 1.073 Test Acc: 0.700
Validation loss decreased (-0.659248 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 0.5365304946899414
Epoch: 10, Steps: 2 | Train Loss: 0.955 Vali Loss: 0.981 Vali Acc: 0.748 Test Loss: 0.981 Test Acc: 0.748
Validation loss decreased (-0.699989 --> -0.748138).  Saving model ...
Epoch: 11 cost time: 0.5847995281219482
Epoch: 11, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.897 Vali Acc: 0.756 Test Loss: 0.897 Test Acc: 0.756
Validation loss decreased (-0.748138 --> -0.755547).  Saving model ...
Epoch: 12 cost time: 0.53867506980896
Epoch: 12, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.821 Vali Acc: 0.800 Test Loss: 0.821 Test Acc: 0.800
Validation loss decreased (-0.755547 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 0.5026185512542725
Epoch: 13, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.750 Vali Acc: 0.841 Test Loss: 0.750 Test Acc: 0.841
Validation loss decreased (-0.799992 --> -0.840733).  Saving model ...
Epoch: 14 cost time: 0.5130586624145508
Epoch: 14, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.685 Vali Acc: 0.859 Test Loss: 0.685 Test Acc: 0.859
Validation loss decreased (-0.840733 --> -0.859252).  Saving model ...
Epoch: 15 cost time: 0.6442193984985352
Epoch: 15, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.622 Vali Acc: 0.878 Test Loss: 0.622 Test Acc: 0.878
Validation loss decreased (-0.859252 --> -0.877772).  Saving model ...
Epoch: 16 cost time: 0.5394997596740723
Epoch: 16, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.563 Vali Acc: 0.889 Test Loss: 0.563 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 17 cost time: 0.47495055198669434
Epoch: 17, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.513 Vali Acc: 0.904 Test Loss: 0.513 Test Acc: 0.904
Validation loss decreased (-0.888883 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 0.5533008575439453
Epoch: 18, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.471 Vali Acc: 0.922 Test Loss: 0.471 Test Acc: 0.922
Validation loss decreased (-0.903699 --> -0.922218).  Saving model ...
Epoch: 19 cost time: 0.4855382442474365
Epoch: 19, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.431 Vali Acc: 0.930 Test Loss: 0.431 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929625).  Saving model ...
Epoch: 20 cost time: 0.5436773300170898
Epoch: 20, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.396 Vali Acc: 0.926 Test Loss: 0.396 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5413296222686768
Epoch: 21, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.366 Vali Acc: 0.919 Test Loss: 0.366 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.595001220703125
Epoch: 22, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.342 Vali Acc: 0.911 Test Loss: 0.342 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6857421398162842
Epoch: 23, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.322 Vali Acc: 0.915 Test Loss: 0.322 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6078295707702637
Epoch: 24, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.306 Vali Acc: 0.915 Test Loss: 0.306 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6024291515350342
Epoch: 25, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5432577133178711
Epoch: 26, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5129921436309814
Epoch: 27, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.263 Vali Acc: 0.907 Test Loss: 0.263 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5987606048583984
Epoch: 28, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.250 Vali Acc: 0.907 Test Loss: 0.250 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5616281032562256
Epoch: 29, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.239 Vali Acc: 0.915 Test Loss: 0.239 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 50182
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.170928955078125
Epoch: 1, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.820 Vali Acc: 0.244 Test Loss: 1.820 Test Acc: 0.244
Validation loss decreased (inf --> -0.244426).  Saving model ...
Epoch: 2 cost time: 0.5111911296844482
Epoch: 2, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.757 Vali Acc: 0.274 Test Loss: 1.757 Test Acc: 0.274
Validation loss decreased (-0.244426 --> -0.274057).  Saving model ...
Epoch: 3 cost time: 0.49619269371032715
Epoch: 3, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.705 Vali Acc: 0.296 Test Loss: 1.705 Test Acc: 0.296
Validation loss decreased (-0.274057 --> -0.296279).  Saving model ...
Epoch: 4 cost time: 0.5898182392120361
Epoch: 4, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.648 Vali Acc: 0.330 Test Loss: 1.648 Test Acc: 0.330
Validation loss decreased (-0.296279 --> -0.329613).  Saving model ...
Epoch: 5 cost time: 0.6603772640228271
Epoch: 5, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.578 Vali Acc: 0.374 Test Loss: 1.578 Test Acc: 0.374
Validation loss decreased (-0.329613 --> -0.374058).  Saving model ...
Epoch: 6 cost time: 0.5083630084991455
Epoch: 6, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.500 Vali Acc: 0.422 Test Loss: 1.500 Test Acc: 0.422
Validation loss decreased (-0.374058 --> -0.422207).  Saving model ...
Epoch: 7 cost time: 0.5636591911315918
Epoch: 7, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.416 Vali Acc: 0.485 Test Loss: 1.416 Test Acc: 0.485
Validation loss decreased (-0.422207 --> -0.485171).  Saving model ...
Epoch: 8 cost time: 0.6143853664398193
Epoch: 8, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.330 Vali Acc: 0.507 Test Loss: 1.330 Test Acc: 0.507
Validation loss decreased (-0.485171 --> -0.507394).  Saving model ...
Epoch: 9 cost time: 0.49089813232421875
Epoch: 9, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.243 Vali Acc: 0.574 Test Loss: 1.243 Test Acc: 0.574
Validation loss decreased (-0.507394 --> -0.574062).  Saving model ...
Epoch: 10 cost time: 0.595822811126709
Epoch: 10, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.157 Vali Acc: 0.615 Test Loss: 1.157 Test Acc: 0.615
Validation loss decreased (-0.574062 --> -0.614803).  Saving model ...
Epoch: 11 cost time: 0.5361731052398682
Epoch: 11, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.073 Vali Acc: 0.715 Test Loss: 1.073 Test Acc: 0.715
Validation loss decreased (-0.614803 --> -0.714804).  Saving model ...
Epoch: 12 cost time: 0.528294563293457
Epoch: 12, Steps: 2 | Train Loss: 1.016 Vali Loss: 0.995 Vali Acc: 0.770 Test Loss: 0.995 Test Acc: 0.770
Validation loss decreased (-0.714804 --> -0.770360).  Saving model ...
Epoch: 13 cost time: 0.636040449142456
Epoch: 13, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.922 Vali Acc: 0.796 Test Loss: 0.922 Test Acc: 0.796
Validation loss decreased (-0.770360 --> -0.796287).  Saving model ...
Epoch: 14 cost time: 0.5117359161376953
Epoch: 14, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.851 Vali Acc: 0.830 Test Loss: 0.851 Test Acc: 0.830
Validation loss decreased (-0.796287 --> -0.829621).  Saving model ...
Epoch: 15 cost time: 0.5528101921081543
Epoch: 15, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.785 Vali Acc: 0.844 Test Loss: 0.785 Test Acc: 0.844
Validation loss decreased (-0.829621 --> -0.844437).  Saving model ...
Epoch: 16 cost time: 0.5698788166046143
Epoch: 16, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.723 Vali Acc: 0.867 Test Loss: 0.723 Test Acc: 0.867
Validation loss decreased (-0.844437 --> -0.866659).  Saving model ...
Epoch: 17 cost time: 0.4974048137664795
Epoch: 17, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.669 Vali Acc: 0.881 Test Loss: 0.669 Test Acc: 0.881
Validation loss decreased (-0.866659 --> -0.881475).  Saving model ...
Epoch: 18 cost time: 0.5361487865447998
Epoch: 18, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.617 Vali Acc: 0.885 Test Loss: 0.617 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 19 cost time: 0.6516361236572266
Epoch: 19, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.569 Vali Acc: 0.900 Test Loss: 0.569 Test Acc: 0.900
Validation loss decreased (-0.885179 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 0.573676347732544
Epoch: 20, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.526 Vali Acc: 0.893 Test Loss: 0.526 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4513211250305176
Epoch: 21, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.486 Vali Acc: 0.911 Test Loss: 0.486 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911106).  Saving model ...
Epoch: 22 cost time: 0.5074455738067627
Epoch: 22, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.449 Vali Acc: 0.915 Test Loss: 0.449 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 23 cost time: 0.5149896144866943
Epoch: 23, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.417 Vali Acc: 0.911 Test Loss: 0.417 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5433833599090576
Epoch: 24, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.387 Vali Acc: 0.922 Test Loss: 0.387 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 25 cost time: 0.5269606113433838
Epoch: 25, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.360 Vali Acc: 0.933 Test Loss: 0.360 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933330).  Saving model ...
Epoch: 26 cost time: 0.5658643245697021
Epoch: 26, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.337 Vali Acc: 0.933 Test Loss: 0.337 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 27 cost time: 0.5255887508392334
Epoch: 27, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.318 Vali Acc: 0.933 Test Loss: 0.318 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 28 cost time: 0.5393221378326416
Epoch: 28, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5154831409454346
Epoch: 29, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6224968433380127
Epoch: 30, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.5560073852539062
Epoch: 31, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.262 Vali Acc: 0.930 Test Loss: 0.262 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5595057010650635
Epoch: 32, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5478858947753906
Epoch: 33, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5618031024932861
Epoch: 34, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5419387817382812
Epoch: 35, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6039090156555176
Epoch: 36, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5568835735321045
Epoch: 37, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5124366283416748
Epoch: 38, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5135288238525391
Epoch: 39, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5412476062774658
Epoch: 40, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 42534
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3083150386810303
Epoch: 1, Steps: 2 | Train Loss: 2.120 Vali Loss: 1.952 Vali Acc: 0.067 Test Loss: 1.952 Test Acc: 0.067
Validation loss decreased (inf --> -0.066647).  Saving model ...
Epoch: 2 cost time: 0.47769856452941895
Epoch: 2, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.897 Vali Acc: 0.100 Test Loss: 1.897 Test Acc: 0.100
Validation loss decreased (-0.066647 --> -0.099981).  Saving model ...
Epoch: 3 cost time: 0.5289056301116943
Epoch: 3, Steps: 2 | Train Loss: 2.062 Vali Loss: 1.852 Vali Acc: 0.130 Test Loss: 1.852 Test Acc: 0.130
Validation loss decreased (-0.099981 --> -0.129611).  Saving model ...
Epoch: 4 cost time: 0.5216662883758545
Epoch: 4, Steps: 2 | Train Loss: 1.984 Vali Loss: 1.806 Vali Acc: 0.174 Test Loss: 1.806 Test Acc: 0.174
Validation loss decreased (-0.129611 --> -0.174056).  Saving model ...
Epoch: 5 cost time: 0.533383846282959
Epoch: 5, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.747 Vali Acc: 0.226 Test Loss: 1.747 Test Acc: 0.226
Validation loss decreased (-0.174056 --> -0.225908).  Saving model ...
Epoch: 6 cost time: 0.5253353118896484
Epoch: 6, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.677 Vali Acc: 0.278 Test Loss: 1.677 Test Acc: 0.278
Validation loss decreased (-0.225908 --> -0.277761).  Saving model ...
Epoch: 7 cost time: 0.49503278732299805
Epoch: 7, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.602 Vali Acc: 0.378 Test Loss: 1.602 Test Acc: 0.378
Validation loss decreased (-0.277761 --> -0.377762).  Saving model ...
Epoch: 8 cost time: 0.49913525581359863
Epoch: 8, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.523 Vali Acc: 0.474 Test Loss: 1.523 Test Acc: 0.474
Validation loss decreased (-0.377762 --> -0.474059).  Saving model ...
Epoch: 9 cost time: 0.6240959167480469
Epoch: 9, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.439 Vali Acc: 0.556 Test Loss: 1.439 Test Acc: 0.556
Validation loss decreased (-0.474059 --> -0.555541).  Saving model ...
Epoch: 10 cost time: 0.5495481491088867
Epoch: 10, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.353 Vali Acc: 0.615 Test Loss: 1.353 Test Acc: 0.615
Validation loss decreased (-0.555541 --> -0.614801).  Saving model ...
Epoch: 11 cost time: 0.4968085289001465
Epoch: 11, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.266 Vali Acc: 0.667 Test Loss: 1.266 Test Acc: 0.667
Validation loss decreased (-0.614801 --> -0.666654).  Saving model ...
Epoch: 12 cost time: 0.4529762268066406
Epoch: 12, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.179 Vali Acc: 0.722 Test Loss: 1.179 Test Acc: 0.722
Validation loss decreased (-0.666654 --> -0.722210).  Saving model ...
Epoch: 13 cost time: 0.5142335891723633
Epoch: 13, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.097 Vali Acc: 0.744 Test Loss: 1.097 Test Acc: 0.744
Validation loss decreased (-0.722210 --> -0.744433).  Saving model ...
Epoch: 14 cost time: 0.5826175212860107
Epoch: 14, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.018 Vali Acc: 0.774 Test Loss: 1.018 Test Acc: 0.774
Validation loss decreased (-0.744433 --> -0.774064).  Saving model ...
Epoch: 15 cost time: 0.5020208358764648
Epoch: 15, Steps: 2 | Train Loss: 0.882 Vali Loss: 0.945 Vali Acc: 0.796 Test Loss: 0.945 Test Acc: 0.796
Validation loss decreased (-0.774064 --> -0.796287).  Saving model ...
Epoch: 16 cost time: 0.4938344955444336
Epoch: 16, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.876 Vali Acc: 0.822 Test Loss: 0.876 Test Acc: 0.822
Validation loss decreased (-0.796287 --> -0.822213).  Saving model ...
Epoch: 17 cost time: 0.4883720874786377
Epoch: 17, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.813 Vali Acc: 0.848 Test Loss: 0.813 Test Acc: 0.848
Validation loss decreased (-0.822213 --> -0.848140).  Saving model ...
Epoch: 18 cost time: 0.533902645111084
Epoch: 18, Steps: 2 | Train Loss: 0.778 Vali Loss: 0.755 Vali Acc: 0.856 Test Loss: 0.755 Test Acc: 0.856
Validation loss decreased (-0.848140 --> -0.855548).  Saving model ...
Epoch: 19 cost time: 0.5330605506896973
Epoch: 19, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.701 Vali Acc: 0.867 Test Loss: 0.701 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866660).  Saving model ...
Epoch: 20 cost time: 0.5818295478820801
Epoch: 20, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.653 Vali Acc: 0.874 Test Loss: 0.653 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874068).  Saving model ...
Epoch: 21 cost time: 0.4992704391479492
Epoch: 21, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.608 Vali Acc: 0.881 Test Loss: 0.608 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881475).  Saving model ...
Epoch: 22 cost time: 0.48722410202026367
Epoch: 22, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.569 Vali Acc: 0.896 Test Loss: 0.569 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896291).  Saving model ...
Epoch: 23 cost time: 0.565788745880127
Epoch: 23, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.5208439826965332
Epoch: 24, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 0.6112000942230225
Epoch: 25, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.42092132568359375
Epoch: 26, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.443 Vali Acc: 0.896 Test Loss: 0.443 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5728778839111328
Epoch: 27, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.420 Vali Acc: 0.896 Test Loss: 0.420 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5886051654815674
Epoch: 28, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.399 Vali Acc: 0.896 Test Loss: 0.399 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5726697444915771
Epoch: 29, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.380 Vali Acc: 0.896 Test Loss: 0.380 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4594762325286865
Epoch: 30, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.364 Vali Acc: 0.904 Test Loss: 0.364 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903700).  Saving model ...
Epoch: 31 cost time: 0.6404116153717041
Epoch: 31, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.350 Vali Acc: 0.911 Test Loss: 0.350 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911108).  Saving model ...
Epoch: 32 cost time: 0.4862024784088135
Epoch: 32, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.336 Vali Acc: 0.915 Test Loss: 0.336 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914811).  Saving model ...
Epoch: 33 cost time: 0.6184713840484619
Epoch: 33, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.323 Vali Acc: 0.919 Test Loss: 0.323 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 34 cost time: 0.5049707889556885
Epoch: 34, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.311 Vali Acc: 0.919 Test Loss: 0.311 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 35 cost time: 0.45040464401245117
Epoch: 35, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.918515 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.527172327041626
Epoch: 36, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 0.514052152633667
Epoch: 37, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.5230810642242432
Epoch: 38, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.5146529674530029
Epoch: 39, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.5483837127685547
Epoch: 40, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.46349525451660156
Epoch: 41, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.518836259841919
Epoch: 42, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6145439147949219
Epoch: 43, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5426230430603027
Epoch: 44, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.4736347198486328
Epoch: 45, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4889793395996094
Epoch: 46, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5680897235870361
Epoch: 47, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5584900379180908
Epoch: 48, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6115603446960449
Epoch: 49, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 37990
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0108749866485596
Epoch: 1, Steps: 2 | Train Loss: 2.060 Vali Loss: 1.997 Vali Acc: 0.126 Test Loss: 1.997 Test Acc: 0.126
Validation loss decreased (inf --> -0.125906).  Saving model ...
Epoch: 2 cost time: 0.4556896686553955
Epoch: 2, Steps: 2 | Train Loss: 2.139 Vali Loss: 1.939 Vali Acc: 0.119 Test Loss: 1.939 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4564802646636963
Epoch: 3, Steps: 2 | Train Loss: 2.089 Vali Loss: 1.894 Vali Acc: 0.111 Test Loss: 1.894 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4769628047943115
Epoch: 4, Steps: 2 | Train Loss: 2.024 Vali Loss: 1.853 Vali Acc: 0.133 Test Loss: 1.853 Test Acc: 0.133
Validation loss decreased (-0.125906 --> -0.133315).  Saving model ...
Epoch: 5 cost time: 0.5659220218658447
Epoch: 5, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.803 Vali Acc: 0.141 Test Loss: 1.803 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140723).  Saving model ...
Epoch: 6 cost time: 0.5417993068695068
Epoch: 6, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.748 Vali Acc: 0.156 Test Loss: 1.748 Test Acc: 0.156
Validation loss decreased (-0.140723 --> -0.155538).  Saving model ...
Epoch: 7 cost time: 0.47171950340270996
Epoch: 7, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.687 Vali Acc: 0.181 Test Loss: 1.687 Test Acc: 0.181
Validation loss decreased (-0.155538 --> -0.181465).  Saving model ...
Epoch: 8 cost time: 0.5051779747009277
Epoch: 8, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.621 Vali Acc: 0.237 Test Loss: 1.621 Test Acc: 0.237
Validation loss decreased (-0.181465 --> -0.237021).  Saving model ...
Epoch: 9 cost time: 0.5957632064819336
Epoch: 9, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.551 Vali Acc: 0.311 Test Loss: 1.551 Test Acc: 0.311
Validation loss decreased (-0.237021 --> -0.311096).  Saving model ...
Epoch: 10 cost time: 0.5669288635253906
Epoch: 10, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.478 Vali Acc: 0.419 Test Loss: 1.478 Test Acc: 0.419
Validation loss decreased (-0.311096 --> -0.418504).  Saving model ...
Epoch: 11 cost time: 0.5214440822601318
Epoch: 11, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.403 Vali Acc: 0.548 Test Loss: 1.403 Test Acc: 0.548
Validation loss decreased (-0.418504 --> -0.548134).  Saving model ...
Epoch: 12 cost time: 0.49874353408813477
Epoch: 12, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.328 Vali Acc: 0.619 Test Loss: 1.328 Test Acc: 0.619
Validation loss decreased (-0.548134 --> -0.618505).  Saving model ...
Epoch: 13 cost time: 0.5682764053344727
Epoch: 13, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.254 Vali Acc: 0.663 Test Loss: 1.254 Test Acc: 0.663
Validation loss decreased (-0.618505 --> -0.662950).  Saving model ...
Epoch: 14 cost time: 0.6472852230072021
Epoch: 14, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.181 Vali Acc: 0.696 Test Loss: 1.181 Test Acc: 0.696
Validation loss decreased (-0.662950 --> -0.696284).  Saving model ...
Epoch: 15 cost time: 0.5541577339172363
Epoch: 15, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.110 Vali Acc: 0.719 Test Loss: 1.110 Test Acc: 0.719
Validation loss decreased (-0.696284 --> -0.718507).  Saving model ...
Epoch: 16 cost time: 0.5234737396240234
Epoch: 16, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.041 Vali Acc: 0.763 Test Loss: 1.041 Test Acc: 0.763
Validation loss decreased (-0.718507 --> -0.762953).  Saving model ...
Epoch: 17 cost time: 0.4213104248046875
Epoch: 17, Steps: 2 | Train Loss: 1.024 Vali Loss: 0.976 Vali Acc: 0.781 Test Loss: 0.976 Test Acc: 0.781
Validation loss decreased (-0.762953 --> -0.781472).  Saving model ...
Epoch: 18 cost time: 0.5149850845336914
Epoch: 18, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.914 Vali Acc: 0.789 Test Loss: 0.914 Test Acc: 0.789
Validation loss decreased (-0.781472 --> -0.788880).  Saving model ...
Epoch: 19 cost time: 0.5110397338867188
Epoch: 19, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.856 Vali Acc: 0.811 Test Loss: 0.856 Test Acc: 0.811
Validation loss decreased (-0.788880 --> -0.811103).  Saving model ...
Epoch: 20 cost time: 0.5614099502563477
Epoch: 20, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.802 Vali Acc: 0.830 Test Loss: 0.802 Test Acc: 0.830
Validation loss decreased (-0.811103 --> -0.829622).  Saving model ...
Epoch: 21 cost time: 0.5597760677337646
Epoch: 21, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.751 Vali Acc: 0.841 Test Loss: 0.751 Test Acc: 0.841
Validation loss decreased (-0.829622 --> -0.840733).  Saving model ...
Epoch: 22 cost time: 0.6787924766540527
Epoch: 22, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.705 Vali Acc: 0.844 Test Loss: 0.705 Test Acc: 0.844
Validation loss decreased (-0.840733 --> -0.844437).  Saving model ...
Epoch: 23 cost time: 0.5768351554870605
Epoch: 23, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.661 Vali Acc: 0.856 Test Loss: 0.661 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855549).  Saving model ...
Epoch: 24 cost time: 0.6179027557373047
Epoch: 24, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 25 cost time: 0.5736074447631836
Epoch: 25, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.584 Vali Acc: 0.870 Test Loss: 0.584 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870365).  Saving model ...
Epoch: 26 cost time: 0.5812771320343018
Epoch: 26, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.550 Vali Acc: 0.870 Test Loss: 0.550 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 27 cost time: 0.5504488945007324
Epoch: 27, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
Validation loss decreased (-0.870365 --> -0.877773).  Saving model ...
Epoch: 28 cost time: 0.45726919174194336
Epoch: 28, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 0.5524158477783203
Epoch: 29, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 30 cost time: 0.5353703498840332
Epoch: 30, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.436 Vali Acc: 0.904 Test Loss: 0.436 Test Acc: 0.904
Validation loss decreased (-0.888884 --> -0.903699).  Saving model ...
Epoch: 31 cost time: 0.5216987133026123
Epoch: 31, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.414 Vali Acc: 0.907 Test Loss: 0.414 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 32 cost time: 0.5809578895568848
Epoch: 32, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.393 Vali Acc: 0.915 Test Loss: 0.393 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 33 cost time: 0.5122363567352295
Epoch: 33, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.374 Vali Acc: 0.926 Test Loss: 0.374 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925922).  Saving model ...
Epoch: 34 cost time: 0.4900832176208496
Epoch: 34, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.47932910919189453
Epoch: 35, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.342 Vali Acc: 0.933 Test Loss: 0.342 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 36 cost time: 0.5244624614715576
Epoch: 36, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.328 Vali Acc: 0.937 Test Loss: 0.328 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 37 cost time: 0.5161769390106201
Epoch: 37, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.617767333984375
Epoch: 38, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.304 Vali Acc: 0.933 Test Loss: 0.304 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4519805908203125
Epoch: 39, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.568429708480835
Epoch: 40, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5095820426940918
Epoch: 41, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 0.6120645999908447
Epoch: 42, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.271 Vali Acc: 0.937 Test Loss: 0.271 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 43 cost time: 0.5969829559326172
Epoch: 43, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 44 cost time: 0.5500047206878662
Epoch: 44, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 45 cost time: 0.5618267059326172
Epoch: 45, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5921227931976318
Epoch: 46, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.550126314163208
Epoch: 47, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5623569488525391
Epoch: 48, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.480452299118042
Epoch: 49, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.4895951747894287
Epoch: 50, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5064771175384521
Epoch: 51, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5500342845916748
Epoch: 52, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.6272287368774414
Epoch: 53, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5772814750671387
Epoch: 54, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 35782
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0735979080200195
Epoch: 1, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.964 Vali Acc: 0.030 Test Loss: 1.964 Test Acc: 0.030
Validation loss decreased (inf --> -0.029610).  Saving model ...
Epoch: 2 cost time: 0.5139195919036865
Epoch: 2, Steps: 2 | Train Loss: 2.018 Vali Loss: 1.924 Vali Acc: 0.052 Test Loss: 1.924 Test Acc: 0.052
Validation loss decreased (-0.029610 --> -0.051833).  Saving model ...
Epoch: 3 cost time: 0.49079394340515137
Epoch: 3, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.897 Vali Acc: 0.063 Test Loss: 1.897 Test Acc: 0.063
Validation loss decreased (-0.051833 --> -0.062944).  Saving model ...
Epoch: 4 cost time: 0.49303317070007324
Epoch: 4, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.873 Vali Acc: 0.074 Test Loss: 1.873 Test Acc: 0.074
Validation loss decreased (-0.062944 --> -0.074055).  Saving model ...
Epoch: 5 cost time: 0.5586819648742676
Epoch: 5, Steps: 2 | Train Loss: 1.894 Vali Loss: 1.841 Vali Acc: 0.107 Test Loss: 1.841 Test Acc: 0.107
Validation loss decreased (-0.074055 --> -0.107389).  Saving model ...
Epoch: 6 cost time: 0.5008997917175293
Epoch: 6, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.804 Vali Acc: 0.144 Test Loss: 1.804 Test Acc: 0.144
Validation loss decreased (-0.107389 --> -0.144426).  Saving model ...
Epoch: 7 cost time: 0.5982687473297119
Epoch: 7, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.761 Vali Acc: 0.178 Test Loss: 1.761 Test Acc: 0.178
Validation loss decreased (-0.144426 --> -0.177760).  Saving model ...
Epoch: 8 cost time: 0.5042998790740967
Epoch: 8, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.714 Vali Acc: 0.248 Test Loss: 1.714 Test Acc: 0.248
Validation loss decreased (-0.177760 --> -0.248131).  Saving model ...
Epoch: 9 cost time: 0.539696216583252
Epoch: 9, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.664 Vali Acc: 0.322 Test Loss: 1.664 Test Acc: 0.322
Validation loss decreased (-0.248131 --> -0.322206).  Saving model ...
Epoch: 10 cost time: 0.5860018730163574
Epoch: 10, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.610 Vali Acc: 0.396 Test Loss: 1.610 Test Acc: 0.396
Validation loss decreased (-0.322206 --> -0.396280).  Saving model ...
Epoch: 11 cost time: 0.6123018264770508
Epoch: 11, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.554 Vali Acc: 0.426 Test Loss: 1.554 Test Acc: 0.426
Validation loss decreased (-0.396280 --> -0.425910).  Saving model ...
Epoch: 12 cost time: 0.5922482013702393
Epoch: 12, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.496 Vali Acc: 0.481 Test Loss: 1.496 Test Acc: 0.481
Validation loss decreased (-0.425910 --> -0.481467).  Saving model ...
Epoch: 13 cost time: 0.5714962482452393
Epoch: 13, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.437 Vali Acc: 0.526 Test Loss: 1.437 Test Acc: 0.526
Validation loss decreased (-0.481467 --> -0.525912).  Saving model ...
Epoch: 14 cost time: 0.47971653938293457
Epoch: 14, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.377 Vali Acc: 0.552 Test Loss: 1.377 Test Acc: 0.552
Validation loss decreased (-0.525912 --> -0.551838).  Saving model ...
Epoch: 15 cost time: 0.6127653121948242
Epoch: 15, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.318 Vali Acc: 0.585 Test Loss: 1.318 Test Acc: 0.585
Validation loss decreased (-0.551838 --> -0.585172).  Saving model ...
Epoch: 16 cost time: 0.5502142906188965
Epoch: 16, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.259 Vali Acc: 0.615 Test Loss: 1.259 Test Acc: 0.615
Validation loss decreased (-0.585172 --> -0.614802).  Saving model ...
Epoch: 17 cost time: 0.48784613609313965
Epoch: 17, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.201 Vali Acc: 0.648 Test Loss: 1.201 Test Acc: 0.648
Validation loss decreased (-0.614802 --> -0.648136).  Saving model ...
Epoch: 18 cost time: 0.564629077911377
Epoch: 18, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.144 Vali Acc: 0.693 Test Loss: 1.144 Test Acc: 0.693
Validation loss decreased (-0.648136 --> -0.692581).  Saving model ...
Epoch: 19 cost time: 0.4778447151184082
Epoch: 19, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.089 Vali Acc: 0.726 Test Loss: 1.089 Test Acc: 0.726
Validation loss decreased (-0.692581 --> -0.725915).  Saving model ...
Epoch: 20 cost time: 0.5485062599182129
Epoch: 20, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.036 Vali Acc: 0.744 Test Loss: 1.036 Test Acc: 0.744
Validation loss decreased (-0.725915 --> -0.744434).  Saving model ...
Epoch: 21 cost time: 0.5683987140655518
Epoch: 21, Steps: 2 | Train Loss: 0.949 Vali Loss: 0.983 Vali Acc: 0.774 Test Loss: 0.983 Test Acc: 0.774
Validation loss decreased (-0.744434 --> -0.774064).  Saving model ...
Epoch: 22 cost time: 0.5022480487823486
Epoch: 22, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.933 Vali Acc: 0.778 Test Loss: 0.933 Test Acc: 0.778
Validation loss decreased (-0.774064 --> -0.777768).  Saving model ...
Epoch: 23 cost time: 0.5884101390838623
Epoch: 23, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.884 Vali Acc: 0.796 Test Loss: 0.884 Test Acc: 0.796
Validation loss decreased (-0.777768 --> -0.796287).  Saving model ...
Epoch: 24 cost time: 0.47847604751586914
Epoch: 24, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.837 Vali Acc: 0.811 Test Loss: 0.837 Test Acc: 0.811
Validation loss decreased (-0.796287 --> -0.811103).  Saving model ...
Epoch: 25 cost time: 0.561835765838623
Epoch: 25, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.791 Vali Acc: 0.830 Test Loss: 0.791 Test Acc: 0.830
Validation loss decreased (-0.811103 --> -0.829622).  Saving model ...
Epoch: 26 cost time: 0.5184221267700195
Epoch: 26, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.747 Vali Acc: 0.852 Test Loss: 0.747 Test Acc: 0.852
Validation loss decreased (-0.829622 --> -0.851844).  Saving model ...
Epoch: 27 cost time: 0.5879213809967041
Epoch: 27, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.706 Vali Acc: 0.870 Test Loss: 0.706 Test Acc: 0.870
Validation loss decreased (-0.851844 --> -0.870363).  Saving model ...
Epoch: 28 cost time: 0.580162763595581
Epoch: 28, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.666 Vali Acc: 0.874 Test Loss: 0.666 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 29 cost time: 0.5604507923126221
Epoch: 29, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.629 Vali Acc: 0.874 Test Loss: 0.629 Test Acc: 0.874
Validation loss decreased (-0.874067 --> -0.874068).  Saving model ...
Epoch: 30 cost time: 0.5263717174530029
Epoch: 30, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.593 Vali Acc: 0.885 Test Loss: 0.593 Test Acc: 0.885
Validation loss decreased (-0.874068 --> -0.885179).  Saving model ...
Epoch: 31 cost time: 0.5906581878662109
Epoch: 31, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 32 cost time: 0.5551974773406982
Epoch: 32, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.532 Vali Acc: 0.896 Test Loss: 0.532 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 33 cost time: 0.5930216312408447
Epoch: 33, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.506 Vali Acc: 0.896 Test Loss: 0.506 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 34 cost time: 0.5047521591186523
Epoch: 34, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.482 Vali Acc: 0.904 Test Loss: 0.482 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 35 cost time: 0.5443501472473145
Epoch: 35, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.460 Vali Acc: 0.907 Test Loss: 0.460 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 36 cost time: 0.6611244678497314
Epoch: 36, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.441 Vali Acc: 0.907 Test Loss: 0.441 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 37 cost time: 0.49826955795288086
Epoch: 37, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.422 Vali Acc: 0.915 Test Loss: 0.422 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 38 cost time: 0.5544018745422363
Epoch: 38, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.406 Vali Acc: 0.922 Test Loss: 0.406 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922218).  Saving model ...
Epoch: 39 cost time: 0.5011322498321533
Epoch: 39, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.389 Vali Acc: 0.919 Test Loss: 0.389 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5607693195343018
Epoch: 40, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.374 Vali Acc: 0.922 Test Loss: 0.374 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 41 cost time: 0.5226414203643799
Epoch: 41, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.361 Vali Acc: 0.926 Test Loss: 0.361 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 42 cost time: 0.5117011070251465
Epoch: 42, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.349 Vali Acc: 0.926 Test Loss: 0.349 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 43 cost time: 0.5068607330322266
Epoch: 43, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.338 Vali Acc: 0.926 Test Loss: 0.338 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 44 cost time: 0.5060231685638428
Epoch: 44, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 45 cost time: 0.6170485019683838
Epoch: 45, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5341856479644775
Epoch: 46, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.313 Vali Acc: 0.922 Test Loss: 0.313 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6954052448272705
Epoch: 47, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.306 Vali Acc: 0.922 Test Loss: 0.306 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.4913945198059082
Epoch: 48, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5341043472290039
Epoch: 49, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.601945161819458
Epoch: 50, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5212488174438477
Epoch: 51, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5273535251617432
Epoch: 52, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.5312340259552002
Epoch: 53, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.279 Vali Acc: 0.919 Test Loss: 0.279 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5448181629180908
Epoch: 54, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 32806
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.129638910293579
Epoch: 1, Steps: 2 | Train Loss: 2.035 Vali Loss: 2.006 Vali Acc: 0.078 Test Loss: 2.006 Test Acc: 0.078
Validation loss decreased (inf --> -0.077758).  Saving model ...
Epoch: 2 cost time: 0.4886186122894287
Epoch: 2, Steps: 2 | Train Loss: 1.963 Vali Loss: 1.958 Vali Acc: 0.096 Test Loss: 1.958 Test Acc: 0.096
Validation loss decreased (-0.077758 --> -0.096277).  Saving model ...
Epoch: 3 cost time: 0.5019173622131348
Epoch: 3, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.920 Vali Acc: 0.096 Test Loss: 1.920 Test Acc: 0.096
Validation loss decreased (-0.096277 --> -0.096277).  Saving model ...
Epoch: 4 cost time: 0.5849959850311279
Epoch: 4, Steps: 2 | Train Loss: 2.005 Vali Loss: 1.890 Vali Acc: 0.119 Test Loss: 1.890 Test Acc: 0.119
Validation loss decreased (-0.096277 --> -0.118500).  Saving model ...
Epoch: 5 cost time: 0.6119575500488281
Epoch: 5, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.857 Vali Acc: 0.141 Test Loss: 1.857 Test Acc: 0.141
Validation loss decreased (-0.118500 --> -0.140722).  Saving model ...
Epoch: 6 cost time: 0.5958085060119629
Epoch: 6, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.822 Vali Acc: 0.156 Test Loss: 1.822 Test Acc: 0.156
Validation loss decreased (-0.140722 --> -0.155537).  Saving model ...
Epoch: 7 cost time: 0.590796709060669
Epoch: 7, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.785 Vali Acc: 0.196 Test Loss: 1.785 Test Acc: 0.196
Validation loss decreased (-0.155537 --> -0.196278).  Saving model ...
Epoch: 8 cost time: 0.5382020473480225
Epoch: 8, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.745 Vali Acc: 0.226 Test Loss: 1.745 Test Acc: 0.226
Validation loss decreased (-0.196278 --> -0.225908).  Saving model ...
Epoch: 9 cost time: 0.43436717987060547
Epoch: 9, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.704 Vali Acc: 0.270 Test Loss: 1.704 Test Acc: 0.270
Validation loss decreased (-0.225908 --> -0.270353).  Saving model ...
Epoch: 10 cost time: 0.4745633602142334
Epoch: 10, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.659 Vali Acc: 0.322 Test Loss: 1.659 Test Acc: 0.322
Validation loss decreased (-0.270353 --> -0.322206).  Saving model ...
Epoch: 11 cost time: 0.46901798248291016
Epoch: 11, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.613 Vali Acc: 0.389 Test Loss: 1.613 Test Acc: 0.389
Validation loss decreased (-0.322206 --> -0.388873).  Saving model ...
Epoch: 12 cost time: 0.4715147018432617
Epoch: 12, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.565 Vali Acc: 0.463 Test Loss: 1.565 Test Acc: 0.463
Validation loss decreased (-0.388873 --> -0.462947).  Saving model ...
Epoch: 13 cost time: 0.5286865234375
Epoch: 13, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.516 Vali Acc: 0.504 Test Loss: 1.516 Test Acc: 0.504
Validation loss decreased (-0.462947 --> -0.503689).  Saving model ...
Epoch: 14 cost time: 0.4793250560760498
Epoch: 14, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.467 Vali Acc: 0.533 Test Loss: 1.467 Test Acc: 0.533
Validation loss decreased (-0.503689 --> -0.533319).  Saving model ...
Epoch: 15 cost time: 0.5006880760192871
Epoch: 15, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.418 Vali Acc: 0.563 Test Loss: 1.418 Test Acc: 0.563
Validation loss decreased (-0.533319 --> -0.562949).  Saving model ...
Epoch: 16 cost time: 0.4566614627838135
Epoch: 16, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.368 Vali Acc: 0.589 Test Loss: 1.368 Test Acc: 0.589
Validation loss decreased (-0.562949 --> -0.588875).  Saving model ...
Epoch: 17 cost time: 0.5150060653686523
Epoch: 17, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.319 Vali Acc: 0.622 Test Loss: 1.319 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622209).  Saving model ...
Epoch: 18 cost time: 0.4895365238189697
Epoch: 18, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.270 Vali Acc: 0.630 Test Loss: 1.270 Test Acc: 0.630
Validation loss decreased (-0.622209 --> -0.629617).  Saving model ...
Epoch: 19 cost time: 0.6100976467132568
Epoch: 19, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.221 Vali Acc: 0.663 Test Loss: 1.221 Test Acc: 0.663
Validation loss decreased (-0.629617 --> -0.662951).  Saving model ...
Epoch: 20 cost time: 0.5096523761749268
Epoch: 20, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.172 Vali Acc: 0.689 Test Loss: 1.172 Test Acc: 0.689
Validation loss decreased (-0.662951 --> -0.688877).  Saving model ...
Epoch: 21 cost time: 0.6050639152526855
Epoch: 21, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.124 Vali Acc: 0.707 Test Loss: 1.124 Test Acc: 0.707
Validation loss decreased (-0.688877 --> -0.707396).  Saving model ...
Epoch: 22 cost time: 0.6079256534576416
Epoch: 22, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.076 Vali Acc: 0.715 Test Loss: 1.076 Test Acc: 0.715
Validation loss decreased (-0.707396 --> -0.714804).  Saving model ...
Epoch: 23 cost time: 0.43366289138793945
Epoch: 23, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.030 Vali Acc: 0.737 Test Loss: 1.030 Test Acc: 0.737
Validation loss decreased (-0.714804 --> -0.737027).  Saving model ...
Epoch: 24 cost time: 0.5383782386779785
Epoch: 24, Steps: 2 | Train Loss: 0.986 Vali Loss: 0.986 Vali Acc: 0.763 Test Loss: 0.986 Test Acc: 0.763
Validation loss decreased (-0.737027 --> -0.762953).  Saving model ...
Epoch: 25 cost time: 0.5530581474304199
Epoch: 25, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.943 Vali Acc: 0.778 Test Loss: 0.943 Test Acc: 0.778
Validation loss decreased (-0.762953 --> -0.777768).  Saving model ...
Epoch: 26 cost time: 0.5293397903442383
Epoch: 26, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.902 Vali Acc: 0.800 Test Loss: 0.902 Test Acc: 0.800
Validation loss decreased (-0.777768 --> -0.799991).  Saving model ...
Epoch: 27 cost time: 0.4820737838745117
Epoch: 27, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.861 Vali Acc: 0.822 Test Loss: 0.861 Test Acc: 0.822
Validation loss decreased (-0.799991 --> -0.822214).  Saving model ...
Epoch: 28 cost time: 0.5317723751068115
Epoch: 28, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.823 Vali Acc: 0.826 Test Loss: 0.823 Test Acc: 0.826
Validation loss decreased (-0.822214 --> -0.825918).  Saving model ...
Epoch: 29 cost time: 0.5560109615325928
Epoch: 29, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.785 Vali Acc: 0.844 Test Loss: 0.785 Test Acc: 0.844
Validation loss decreased (-0.825918 --> -0.844437).  Saving model ...
Epoch: 30 cost time: 0.5094430446624756
Epoch: 30, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.749 Vali Acc: 0.863 Test Loss: 0.749 Test Acc: 0.863
Validation loss decreased (-0.844437 --> -0.862955).  Saving model ...
Epoch: 31 cost time: 0.5294294357299805
Epoch: 31, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.714 Vali Acc: 0.863 Test Loss: 0.714 Test Acc: 0.863
Validation loss decreased (-0.862955 --> -0.862956).  Saving model ...
Epoch: 32 cost time: 0.5983924865722656
Epoch: 32, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.682 Vali Acc: 0.874 Test Loss: 0.682 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874067).  Saving model ...
Epoch: 33 cost time: 0.5046548843383789
Epoch: 33, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.651 Vali Acc: 0.878 Test Loss: 0.651 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877771).  Saving model ...
Epoch: 34 cost time: 0.5006504058837891
Epoch: 34, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.621 Vali Acc: 0.878 Test Loss: 0.621 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877772).  Saving model ...
Epoch: 35 cost time: 0.48258018493652344
Epoch: 35, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.592 Vali Acc: 0.896 Test Loss: 0.592 Test Acc: 0.896
Validation loss decreased (-0.877772 --> -0.896290).  Saving model ...
Epoch: 36 cost time: 0.4593477249145508
Epoch: 36, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.565 Vali Acc: 0.904 Test Loss: 0.565 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 37 cost time: 0.5418941974639893
Epoch: 37, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.540 Vali Acc: 0.904 Test Loss: 0.540 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 38 cost time: 0.5346639156341553
Epoch: 38, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.518 Vali Acc: 0.907 Test Loss: 0.518 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 39 cost time: 0.517627477645874
Epoch: 39, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.497 Vali Acc: 0.911 Test Loss: 0.497 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 40 cost time: 0.5297074317932129
Epoch: 40, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.478 Vali Acc: 0.922 Test Loss: 0.478 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922217).  Saving model ...
Epoch: 41 cost time: 0.5168731212615967
Epoch: 41, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.461 Vali Acc: 0.926 Test Loss: 0.461 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 42 cost time: 0.5153689384460449
Epoch: 42, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.445 Vali Acc: 0.930 Test Loss: 0.445 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 43 cost time: 0.47023510932922363
Epoch: 43, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.429 Vali Acc: 0.937 Test Loss: 0.429 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 44 cost time: 0.5616552829742432
Epoch: 44, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.414 Vali Acc: 0.933 Test Loss: 0.414 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.44291138648986816
Epoch: 45, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.401 Vali Acc: 0.937 Test Loss: 0.401 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 46 cost time: 0.534764289855957
Epoch: 46, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.388 Vali Acc: 0.937 Test Loss: 0.388 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 47 cost time: 0.5739917755126953
Epoch: 47, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.376 Vali Acc: 0.937 Test Loss: 0.376 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 48 cost time: 0.5359866619110107
Epoch: 48, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.365 Vali Acc: 0.937 Test Loss: 0.365 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 49 cost time: 0.5202863216400146
Epoch: 49, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 50 cost time: 0.44239306449890137
Epoch: 50, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.346 Vali Acc: 0.937 Test Loss: 0.346 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 51 cost time: 0.45757293701171875
Epoch: 51, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.338 Vali Acc: 0.941 Test Loss: 0.338 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940737).  Saving model ...
Epoch: 52 cost time: 0.5696642398834229
Epoch: 52, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.330 Vali Acc: 0.941 Test Loss: 0.330 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 53 cost time: 0.5261430740356445
Epoch: 53, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 54 cost time: 0.5243234634399414
Epoch: 54, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.318 Vali Acc: 0.941 Test Loss: 0.318 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 55 cost time: 0.5105495452880859
Epoch: 55, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.312 Vali Acc: 0.941 Test Loss: 0.312 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 56 cost time: 0.5423083305358887
Epoch: 56, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.306 Vali Acc: 0.941 Test Loss: 0.306 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 57 cost time: 0.4327216148376465
Epoch: 57, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.301 Vali Acc: 0.941 Test Loss: 0.301 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 58 cost time: 0.44646573066711426
Epoch: 58, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.296 Vali Acc: 0.937 Test Loss: 0.296 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.49971842765808105
Epoch: 59, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.291 Vali Acc: 0.937 Test Loss: 0.291 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5590825080871582
Epoch: 60, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.286 Vali Acc: 0.937 Test Loss: 0.286 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5674502849578857
Epoch: 61, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.5165913105010986
Epoch: 62, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.5297050476074219
Epoch: 63, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.47322654724121094
Epoch: 64, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.269 Vali Acc: 0.937 Test Loss: 0.269 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.5702934265136719
Epoch: 65, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.48293161392211914
Epoch: 66, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.6301119327545166
Epoch: 67, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 31398
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.203549385070801
Epoch: 1, Steps: 2 | Train Loss: 2.079 Vali Loss: 1.823 Vali Acc: 0.256 Test Loss: 1.823 Test Acc: 0.256
Validation loss decreased (inf --> -0.255537).  Saving model ...
Epoch: 2 cost time: 0.6041474342346191
Epoch: 2, Steps: 2 | Train Loss: 2.086 Vali Loss: 1.739 Vali Acc: 0.333 Test Loss: 1.739 Test Acc: 0.333
Validation loss decreased (-0.255537 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 0.568406343460083
Epoch: 3, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.644 Vali Acc: 0.400 Test Loss: 1.644 Test Acc: 0.400
Validation loss decreased (-0.333316 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 0.5692663192749023
Epoch: 4, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.509 Vali Acc: 0.452 Test Loss: 1.509 Test Acc: 0.452
Validation loss decreased (-0.399984 --> -0.451837).  Saving model ...
Epoch: 5 cost time: 0.6152851581573486
Epoch: 5, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.351 Vali Acc: 0.530 Test Loss: 1.351 Test Acc: 0.530
Validation loss decreased (-0.451837 --> -0.529616).  Saving model ...
Epoch: 6 cost time: 0.5629651546478271
Epoch: 6, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.186 Vali Acc: 0.744 Test Loss: 1.186 Test Acc: 0.744
Validation loss decreased (-0.529616 --> -0.744433).  Saving model ...
Epoch: 7 cost time: 0.5774543285369873
Epoch: 7, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.028 Vali Acc: 0.848 Test Loss: 1.028 Test Acc: 0.848
Validation loss decreased (-0.744433 --> -0.848138).  Saving model ...
Epoch: 8 cost time: 0.5461006164550781
Epoch: 8, Steps: 2 | Train Loss: 0.954 Vali Loss: 0.884 Vali Acc: 0.859 Test Loss: 0.884 Test Acc: 0.859
Validation loss decreased (-0.848138 --> -0.859250).  Saving model ...
Epoch: 9 cost time: 0.49990224838256836
Epoch: 9, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.761 Vali Acc: 0.885 Test Loss: 0.761 Test Acc: 0.885
Validation loss decreased (-0.859250 --> -0.885178).  Saving model ...
Epoch: 10 cost time: 0.6157271862030029
Epoch: 10, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.651 Vali Acc: 0.919 Test Loss: 0.651 Test Acc: 0.919
Validation loss decreased (-0.885178 --> -0.918512).  Saving model ...
Epoch: 11 cost time: 0.5746755599975586
Epoch: 11, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.555 Vali Acc: 0.930 Test Loss: 0.555 Test Acc: 0.930
Validation loss decreased (-0.918512 --> -0.929624).  Saving model ...
Epoch: 12 cost time: 0.5666191577911377
Epoch: 12, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.477 Vali Acc: 0.930 Test Loss: 0.477 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 13 cost time: 0.575416088104248
Epoch: 13, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.419 Vali Acc: 0.926 Test Loss: 0.419 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6361207962036133
Epoch: 14, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.368 Vali Acc: 0.937 Test Loss: 0.368 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 15 cost time: 0.6187038421630859
Epoch: 15, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.335 Vali Acc: 0.933 Test Loss: 0.335 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5780856609344482
Epoch: 16, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.305 Vali Acc: 0.941 Test Loss: 0.305 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.6768498420715332
Epoch: 17, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.6038708686828613
Epoch: 18, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5668530464172363
Epoch: 19, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6402528285980225
Epoch: 20, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5746681690216064
Epoch: 21, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5535504817962646
Epoch: 22, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5930428504943848
Epoch: 23, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5458693504333496
Epoch: 24, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.5378632545471191
Epoch: 25, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.6454765796661377
Epoch: 26, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6154391765594482
Epoch: 27, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6128098964691162
Epoch: 28, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5945620536804199
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.937 Test Loss: 0.159 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.48551106452941895
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.5561084747314453
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6579740047454834
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.941 Test Loss: 0.159 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6821293830871582
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.937 Test Loss: 0.160 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6350517272949219
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5752570629119873
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.577742338180542
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5797591209411621
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.937 Test Loss: 0.160 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5621302127838135
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.937 Test Loss: 0.160 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6130249500274658
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.937 Test Loss: 0.159 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.551379919052124
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.937 Test Loss: 0.158 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 67142
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1907880306243896
Epoch: 1, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.804 Vali Acc: 0.278 Test Loss: 1.804 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 0.4551510810852051
Epoch: 2, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.732 Vali Acc: 0.307 Test Loss: 1.732 Test Acc: 0.307
Validation loss decreased (-0.277760 --> -0.307390).  Saving model ...
Epoch: 3 cost time: 0.5198400020599365
Epoch: 3, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.671 Vali Acc: 0.359 Test Loss: 1.671 Test Acc: 0.359
Validation loss decreased (-0.307390 --> -0.359243).  Saving model ...
Epoch: 4 cost time: 0.5229685306549072
Epoch: 4, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.599 Vali Acc: 0.404 Test Loss: 1.599 Test Acc: 0.404
Validation loss decreased (-0.359243 --> -0.403688).  Saving model ...
Epoch: 5 cost time: 0.4965653419494629
Epoch: 5, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.510 Vali Acc: 0.430 Test Loss: 1.510 Test Acc: 0.430
Validation loss decreased (-0.403688 --> -0.429615).  Saving model ...
Epoch: 6 cost time: 0.5402283668518066
Epoch: 6, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.408 Vali Acc: 0.519 Test Loss: 1.408 Test Acc: 0.519
Validation loss decreased (-0.429615 --> -0.518504).  Saving model ...
Epoch: 7 cost time: 0.5509459972381592
Epoch: 7, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.298 Vali Acc: 0.670 Test Loss: 1.298 Test Acc: 0.670
Validation loss decreased (-0.518504 --> -0.670357).  Saving model ...
Epoch: 8 cost time: 0.5993893146514893
Epoch: 8, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.186 Vali Acc: 0.696 Test Loss: 1.186 Test Acc: 0.696
Validation loss decreased (-0.670357 --> -0.696284).  Saving model ...
Epoch: 9 cost time: 0.4955024719238281
Epoch: 9, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.076 Vali Acc: 0.730 Test Loss: 1.076 Test Acc: 0.730
Validation loss decreased (-0.696284 --> -0.729619).  Saving model ...
Epoch: 10 cost time: 0.5394577980041504
Epoch: 10, Steps: 2 | Train Loss: 0.943 Vali Loss: 0.974 Vali Acc: 0.744 Test Loss: 0.974 Test Acc: 0.744
Validation loss decreased (-0.729619 --> -0.744435).  Saving model ...
Epoch: 11 cost time: 0.538640022277832
Epoch: 11, Steps: 2 | Train Loss: 0.902 Vali Loss: 0.879 Vali Acc: 0.770 Test Loss: 0.879 Test Acc: 0.770
Validation loss decreased (-0.744435 --> -0.770362).  Saving model ...
Epoch: 12 cost time: 0.6234230995178223
Epoch: 12, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.795 Vali Acc: 0.793 Test Loss: 0.795 Test Acc: 0.793
Validation loss decreased (-0.770362 --> -0.792585).  Saving model ...
Epoch: 13 cost time: 0.582329511642456
Epoch: 13, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.717 Vali Acc: 0.819 Test Loss: 0.717 Test Acc: 0.819
Validation loss decreased (-0.792585 --> -0.818511).  Saving model ...
Epoch: 14 cost time: 0.49338412284851074
Epoch: 14, Steps: 2 | Train Loss: 0.575 Vali Loss: 0.645 Vali Acc: 0.856 Test Loss: 0.645 Test Acc: 0.856
Validation loss decreased (-0.818511 --> -0.855549).  Saving model ...
Epoch: 15 cost time: 0.4967045783996582
Epoch: 15, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.583 Vali Acc: 0.874 Test Loss: 0.583 Test Acc: 0.874
Validation loss decreased (-0.855549 --> -0.874068).  Saving model ...
Epoch: 16 cost time: 0.5460026264190674
Epoch: 16, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.532 Vali Acc: 0.885 Test Loss: 0.532 Test Acc: 0.885
Validation loss decreased (-0.874068 --> -0.885180).  Saving model ...
Epoch: 17 cost time: 0.6157445907592773
Epoch: 17, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.487 Vali Acc: 0.889 Test Loss: 0.487 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 18 cost time: 0.49379539489746094
Epoch: 18, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.446 Vali Acc: 0.893 Test Loss: 0.446 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 19 cost time: 0.5464799404144287
Epoch: 19, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.414 Vali Acc: 0.896 Test Loss: 0.414 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 20 cost time: 0.49256443977355957
Epoch: 20, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.384 Vali Acc: 0.907 Test Loss: 0.384 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907404).  Saving model ...
Epoch: 21 cost time: 0.5381417274475098
Epoch: 21, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6230638027191162
Epoch: 22, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6373703479766846
Epoch: 23, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.322 Vali Acc: 0.893 Test Loss: 0.322 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4545717239379883
Epoch: 24, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5543360710144043
Epoch: 25, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.295 Vali Acc: 0.896 Test Loss: 0.295 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5606451034545898
Epoch: 26, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.276 Vali Acc: 0.907 Test Loss: 0.276 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907405).  Saving model ...
Epoch: 27 cost time: 0.5460796356201172
Epoch: 27, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911108).  Saving model ...
Epoch: 28 cost time: 0.5690765380859375
Epoch: 28, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 29 cost time: 0.5128328800201416
Epoch: 29, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 30 cost time: 0.5518460273742676
Epoch: 30, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.233 Vali Acc: 0.915 Test Loss: 0.233 Test Acc: 0.915
Validation loss decreased (-0.911109 --> -0.914812).  Saving model ...
Epoch: 31 cost time: 0.5568838119506836
Epoch: 31, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.228 Vali Acc: 0.915 Test Loss: 0.228 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914813).  Saving model ...
Epoch: 32 cost time: 0.578784704208374
Epoch: 32, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.224 Vali Acc: 0.915 Test Loss: 0.224 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 33 cost time: 0.6023764610290527
Epoch: 33, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.222 Vali Acc: 0.915 Test Loss: 0.222 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 34 cost time: 0.5344741344451904
Epoch: 34, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7391693592071533
Epoch: 35, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.548497200012207
Epoch: 36, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.540550947189331
Epoch: 37, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5385138988494873
Epoch: 38, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.907 Test Loss: 0.213 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4893672466278076
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.211 Vali Acc: 0.911 Test Loss: 0.211 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4813838005065918
Epoch: 40, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5769248008728027
Epoch: 41, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.915 Test Loss: 0.209 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 42 cost time: 0.533348798751831
Epoch: 42, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.915 Test Loss: 0.208 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 43 cost time: 0.4913926124572754
Epoch: 43, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.915 Test Loss: 0.206 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 44 cost time: 0.5181241035461426
Epoch: 44, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.915 Test Loss: 0.204 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 45 cost time: 0.5194544792175293
Epoch: 45, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.915 Test Loss: 0.201 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 46 cost time: 0.5865697860717773
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.911 Test Loss: 0.200 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.524115800857544
Epoch: 47, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.915 Test Loss: 0.198 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 48 cost time: 0.6072242259979248
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.915 Test Loss: 0.198 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 49 cost time: 0.5528147220611572
Epoch: 49, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.198 Vali Acc: 0.915 Test Loss: 0.198 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 50 cost time: 0.5282666683197021
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.915 Test Loss: 0.198 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.596254825592041
Epoch: 51, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.915 Test Loss: 0.199 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5862722396850586
Epoch: 52, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.915 Test Loss: 0.200 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5275981426239014
Epoch: 53, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.915 Test Loss: 0.200 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5797257423400879
Epoch: 54, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.915 Test Loss: 0.201 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5852146148681641
Epoch: 55, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.915 Test Loss: 0.201 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.5154476165771484
Epoch: 56, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.915 Test Loss: 0.202 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.5489728450775146
Epoch: 57, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.202 Vali Acc: 0.919 Test Loss: 0.202 Test Acc: 0.919
Validation loss decreased (-0.914813 --> -0.918517).  Saving model ...
Epoch: 58 cost time: 0.4887068271636963
Epoch: 58, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.919 Test Loss: 0.201 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 59 cost time: 0.5661652088165283
Epoch: 59, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.919 Test Loss: 0.199 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 60 cost time: 0.5154011249542236
Epoch: 60, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.919 Test Loss: 0.198 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 61 cost time: 0.49654650688171387
Epoch: 61, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.919 Test Loss: 0.197 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 62 cost time: 0.5540871620178223
Epoch: 62, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.919 Test Loss: 0.197 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 63 cost time: 0.5450868606567383
Epoch: 63, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.919 Test Loss: 0.196 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 64 cost time: 0.5424420833587646
Epoch: 64, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.919 Test Loss: 0.196 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 65 cost time: 0.5620908737182617
Epoch: 65, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.919 Test Loss: 0.196 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 66 cost time: 0.580284595489502
Epoch: 66, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.919 Test Loss: 0.195 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 67 cost time: 0.556572675704956
Epoch: 67, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.919 Test Loss: 0.194 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 68 cost time: 0.5493841171264648
Epoch: 68, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.919 Test Loss: 0.192 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 69 cost time: 0.49507737159729004
Epoch: 69, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.919 Test Loss: 0.191 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 70 cost time: 0.5078632831573486
Epoch: 70, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
Validation loss decreased (-0.918517 --> -0.929628).  Saving model ...
Epoch: 71 cost time: 0.5734543800354004
Epoch: 71, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 72 cost time: 0.5220339298248291
Epoch: 72, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.5094008445739746
Epoch: 73, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.5797219276428223
Epoch: 74, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.926 Test Loss: 0.189 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.5250701904296875
Epoch: 75, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.4783976078033447
Epoch: 76, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.45243358612060547
Epoch: 77, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.926 Test Loss: 0.192 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.5646655559539795
Epoch: 78, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.5014450550079346
Epoch: 79, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.919 Test Loss: 0.194 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.6003754138946533
Epoch: 80, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.919 Test Loss: 0.194 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.6006038188934326
Epoch: 81, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.919 Test Loss: 0.195 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 41862
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9529037475585938
Epoch: 1, Steps: 2 | Train Loss: 2.032 Vali Loss: 1.888 Vali Acc: 0.144 Test Loss: 1.888 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.6639652252197266
Epoch: 2, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.825 Vali Acc: 0.148 Test Loss: 1.825 Test Acc: 0.148
Validation loss decreased (-0.144426 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 0.6600601673126221
Epoch: 3, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.773 Vali Acc: 0.185 Test Loss: 1.773 Test Acc: 0.185
Validation loss decreased (-0.148130 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 0.48798322677612305
Epoch: 4, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.718 Vali Acc: 0.222 Test Loss: 1.718 Test Acc: 0.222
Validation loss decreased (-0.185167 --> -0.222205).  Saving model ...
Epoch: 5 cost time: 0.5477919578552246
Epoch: 5, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.648 Vali Acc: 0.293 Test Loss: 1.648 Test Acc: 0.293
Validation loss decreased (-0.222205 --> -0.292576).  Saving model ...
Epoch: 6 cost time: 0.5534369945526123
Epoch: 6, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.569 Vali Acc: 0.378 Test Loss: 1.569 Test Acc: 0.378
Validation loss decreased (-0.292576 --> -0.377762).  Saving model ...
Epoch: 7 cost time: 0.6515631675720215
Epoch: 7, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.482 Vali Acc: 0.426 Test Loss: 1.482 Test Acc: 0.426
Validation loss decreased (-0.377762 --> -0.425911).  Saving model ...
Epoch: 8 cost time: 0.5730254650115967
Epoch: 8, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.389 Vali Acc: 0.537 Test Loss: 1.389 Test Acc: 0.537
Validation loss decreased (-0.425911 --> -0.537023).  Saving model ...
Epoch: 9 cost time: 0.4678795337677002
Epoch: 9, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.293 Vali Acc: 0.607 Test Loss: 1.293 Test Acc: 0.607
Validation loss decreased (-0.537023 --> -0.607394).  Saving model ...
Epoch: 10 cost time: 0.4900932312011719
Epoch: 10, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.197 Vali Acc: 0.704 Test Loss: 1.197 Test Acc: 0.704
Validation loss decreased (-0.607394 --> -0.703692).  Saving model ...
Epoch: 11 cost time: 0.6188838481903076
Epoch: 11, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.101 Vali Acc: 0.756 Test Loss: 1.101 Test Acc: 0.756
Validation loss decreased (-0.703692 --> -0.755545).  Saving model ...
Epoch: 12 cost time: 0.48500847816467285
Epoch: 12, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.009 Vali Acc: 0.807 Test Loss: 1.009 Test Acc: 0.807
Validation loss decreased (-0.755545 --> -0.807397).  Saving model ...
Epoch: 13 cost time: 0.5209393501281738
Epoch: 13, Steps: 2 | Train Loss: 1.007 Vali Loss: 0.921 Vali Acc: 0.848 Test Loss: 0.921 Test Acc: 0.848
Validation loss decreased (-0.807397 --> -0.848139).  Saving model ...
Epoch: 14 cost time: 0.559553861618042
Epoch: 14, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.840 Vali Acc: 0.859 Test Loss: 0.840 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 15 cost time: 0.5369341373443604
Epoch: 15, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.767 Vali Acc: 0.878 Test Loss: 0.767 Test Acc: 0.878
Validation loss decreased (-0.859251 --> -0.877770).  Saving model ...
Epoch: 16 cost time: 0.5757379531860352
Epoch: 16, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.701 Vali Acc: 0.893 Test Loss: 0.701 Test Acc: 0.893
Validation loss decreased (-0.877770 --> -0.892586).  Saving model ...
Epoch: 17 cost time: 0.6013894081115723
Epoch: 17, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.642 Vali Acc: 0.904 Test Loss: 0.642 Test Acc: 0.904
Validation loss decreased (-0.892586 --> -0.903697).  Saving model ...
Epoch: 18 cost time: 0.57607102394104
Epoch: 18, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.590 Vali Acc: 0.911 Test Loss: 0.590 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 19 cost time: 0.5567467212677002
Epoch: 19, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.543 Vali Acc: 0.915 Test Loss: 0.543 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 20 cost time: 0.5185003280639648
Epoch: 20, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.500 Vali Acc: 0.915 Test Loss: 0.500 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 21 cost time: 0.5345308780670166
Epoch: 21, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.463 Vali Acc: 0.926 Test Loss: 0.463 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925921).  Saving model ...
Epoch: 22 cost time: 0.5471889972686768
Epoch: 22, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.430 Vali Acc: 0.919 Test Loss: 0.430 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5415499210357666
Epoch: 23, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.402 Vali Acc: 0.922 Test Loss: 0.402 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5605406761169434
Epoch: 24, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4666430950164795
Epoch: 25, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.356 Vali Acc: 0.919 Test Loss: 0.356 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.47362422943115234
Epoch: 26, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.335 Vali Acc: 0.926 Test Loss: 0.335 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925923).  Saving model ...
Epoch: 27 cost time: 0.535759687423706
Epoch: 27, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.317 Vali Acc: 0.933 Test Loss: 0.317 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933330).  Saving model ...
Epoch: 28 cost time: 0.5230071544647217
Epoch: 28, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.302 Vali Acc: 0.941 Test Loss: 0.302 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.44734930992126465
Epoch: 29, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.49808740615844727
Epoch: 30, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.275 Vali Acc: 0.941 Test Loss: 0.275 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5733752250671387
Epoch: 31, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5865199565887451
Epoch: 32, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.52408766746521
Epoch: 33, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5477845668792725
Epoch: 34, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5214822292327881
Epoch: 35, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5396370887756348
Epoch: 36, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7015864849090576
Epoch: 37, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5223329067230225
Epoch: 38, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.47536659240722656
Epoch: 39, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 34214
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.958707571029663
Epoch: 1, Steps: 2 | Train Loss: 2.024 Vali Loss: 1.896 Vali Acc: 0.148 Test Loss: 1.896 Test Acc: 0.148
Validation loss decreased (inf --> -0.148129).  Saving model ...
Epoch: 2 cost time: 0.5548191070556641
Epoch: 2, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.850 Vali Acc: 0.207 Test Loss: 1.850 Test Acc: 0.207
Validation loss decreased (-0.148129 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 0.4642336368560791
Epoch: 3, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.811 Vali Acc: 0.222 Test Loss: 1.811 Test Acc: 0.222
Validation loss decreased (-0.207389 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.5492713451385498
Epoch: 4, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.771 Vali Acc: 0.248 Test Loss: 1.771 Test Acc: 0.248
Validation loss decreased (-0.222204 --> -0.248130).  Saving model ...
Epoch: 5 cost time: 0.48235392570495605
Epoch: 5, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.721 Vali Acc: 0.293 Test Loss: 1.721 Test Acc: 0.293
Validation loss decreased (-0.248130 --> -0.292575).  Saving model ...
Epoch: 6 cost time: 0.511772871017456
Epoch: 6, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.663 Vali Acc: 0.344 Test Loss: 1.663 Test Acc: 0.344
Validation loss decreased (-0.292575 --> -0.344428).  Saving model ...
Epoch: 7 cost time: 0.47217369079589844
Epoch: 7, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.598 Vali Acc: 0.407 Test Loss: 1.598 Test Acc: 0.407
Validation loss decreased (-0.344428 --> -0.407391).  Saving model ...
Epoch: 8 cost time: 0.571448802947998
Epoch: 8, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.528 Vali Acc: 0.456 Test Loss: 1.528 Test Acc: 0.456
Validation loss decreased (-0.407391 --> -0.455540).  Saving model ...
Epoch: 9 cost time: 0.5713565349578857
Epoch: 9, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.455 Vali Acc: 0.519 Test Loss: 1.455 Test Acc: 0.519
Validation loss decreased (-0.455540 --> -0.518504).  Saving model ...
Epoch: 10 cost time: 0.5058398246765137
Epoch: 10, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.380 Vali Acc: 0.574 Test Loss: 1.380 Test Acc: 0.574
Validation loss decreased (-0.518504 --> -0.574060).  Saving model ...
Epoch: 11 cost time: 0.5388016700744629
Epoch: 11, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.305 Vali Acc: 0.626 Test Loss: 1.305 Test Acc: 0.626
Validation loss decreased (-0.574060 --> -0.625913).  Saving model ...
Epoch: 12 cost time: 0.5126068592071533
Epoch: 12, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.229 Vali Acc: 0.681 Test Loss: 1.229 Test Acc: 0.681
Validation loss decreased (-0.625913 --> -0.681469).  Saving model ...
Epoch: 13 cost time: 0.4756650924682617
Epoch: 13, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.155 Vali Acc: 0.711 Test Loss: 1.155 Test Acc: 0.711
Validation loss decreased (-0.681469 --> -0.711100).  Saving model ...
Epoch: 14 cost time: 0.5602700710296631
Epoch: 14, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.083 Vali Acc: 0.748 Test Loss: 1.083 Test Acc: 0.748
Validation loss decreased (-0.711100 --> -0.748137).  Saving model ...
Epoch: 15 cost time: 0.48657655715942383
Epoch: 15, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.015 Vali Acc: 0.789 Test Loss: 1.015 Test Acc: 0.789
Validation loss decreased (-0.748137 --> -0.788879).  Saving model ...
Epoch: 16 cost time: 0.4721193313598633
Epoch: 16, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.950 Vali Acc: 0.793 Test Loss: 0.950 Test Acc: 0.793
Validation loss decreased (-0.788879 --> -0.792583).  Saving model ...
Epoch: 17 cost time: 0.5162441730499268
Epoch: 17, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.889 Vali Acc: 0.807 Test Loss: 0.889 Test Acc: 0.807
Validation loss decreased (-0.792583 --> -0.807399).  Saving model ...
Epoch: 18 cost time: 0.47444748878479004
Epoch: 18, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.831 Vali Acc: 0.822 Test Loss: 0.831 Test Acc: 0.822
Validation loss decreased (-0.807399 --> -0.822214).  Saving model ...
Epoch: 19 cost time: 0.5262801647186279
Epoch: 19, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.776 Vali Acc: 0.833 Test Loss: 0.776 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833326).  Saving model ...
Epoch: 20 cost time: 0.5114386081695557
Epoch: 20, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.725 Vali Acc: 0.841 Test Loss: 0.725 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840733).  Saving model ...
Epoch: 21 cost time: 0.5817685127258301
Epoch: 21, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.679 Vali Acc: 0.837 Test Loss: 0.679 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4531424045562744
Epoch: 22, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.513486385345459
Epoch: 23, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
Validation loss decreased (-0.840733 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 0.5616679191589355
Epoch: 24, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.560 Vali Acc: 0.859 Test Loss: 0.560 Test Acc: 0.859
Validation loss decreased (-0.844438 --> -0.859254).  Saving model ...
Epoch: 25 cost time: 0.5485482215881348
Epoch: 25, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.523 Vali Acc: 0.885 Test Loss: 0.523 Test Acc: 0.885
Validation loss decreased (-0.859254 --> -0.885180).  Saving model ...
Epoch: 26 cost time: 0.5467171669006348
Epoch: 26, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
Validation loss decreased (-0.885180 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.4442307949066162
Epoch: 27, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.462 Vali Acc: 0.907 Test Loss: 0.462 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 28 cost time: 0.5122864246368408
Epoch: 28, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.436 Vali Acc: 0.907 Test Loss: 0.436 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 29 cost time: 0.5833382606506348
Epoch: 29, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.413 Vali Acc: 0.915 Test Loss: 0.413 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 30 cost time: 0.6024320125579834
Epoch: 30, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.394 Vali Acc: 0.915 Test Loss: 0.394 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 31 cost time: 0.5593292713165283
Epoch: 31, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.377 Vali Acc: 0.915 Test Loss: 0.377 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.5946929454803467
Epoch: 32, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.360 Vali Acc: 0.926 Test Loss: 0.360 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925922).  Saving model ...
Epoch: 33 cost time: 0.5006203651428223
Epoch: 33, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5019543170928955
Epoch: 34, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.329 Vali Acc: 0.930 Test Loss: 0.329 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 35 cost time: 0.5166819095611572
Epoch: 35, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.317 Vali Acc: 0.930 Test Loss: 0.317 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 36 cost time: 0.5079696178436279
Epoch: 36, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.307 Vali Acc: 0.926 Test Loss: 0.307 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5306694507598877
Epoch: 37, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 38 cost time: 0.6236891746520996
Epoch: 38, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 0.44277501106262207
Epoch: 39, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 40 cost time: 0.5036060810089111
Epoch: 40, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.48993754386901855
Epoch: 41, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.5006563663482666
Epoch: 42, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.5404086112976074
Epoch: 43, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.4891183376312256
Epoch: 44, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.5885324478149414
Epoch: 45, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.5424988269805908
Epoch: 46, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.5857341289520264
Epoch: 47, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.580864429473877
Epoch: 48, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.5901498794555664
Epoch: 49, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 50 cost time: 0.5550401210784912
Epoch: 50, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 51 cost time: 0.5612075328826904
Epoch: 51, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 52 cost time: 0.5310001373291016
Epoch: 52, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 53 cost time: 0.5430507659912109
Epoch: 53, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5529952049255371
Epoch: 54, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5398650169372559
Epoch: 55, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.552879810333252
Epoch: 56, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.4729182720184326
Epoch: 57, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5365400314331055
Epoch: 58, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.5339078903198242
Epoch: 59, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.5513756275177002
Epoch: 60, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.566462516784668
Epoch: 61, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.5350868701934814
Epoch: 62, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 29670
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.100076198577881
Epoch: 1, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.777 Vali Acc: 0.296 Test Loss: 1.777 Test Acc: 0.296
Validation loss decreased (inf --> -0.296279).  Saving model ...
Epoch: 2 cost time: 0.5385708808898926
Epoch: 2, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.731 Vali Acc: 0.315 Test Loss: 1.731 Test Acc: 0.315
Validation loss decreased (-0.296279 --> -0.314798).  Saving model ...
Epoch: 3 cost time: 0.4935774803161621
Epoch: 3, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.695 Vali Acc: 0.330 Test Loss: 1.695 Test Acc: 0.330
Validation loss decreased (-0.314798 --> -0.329613).  Saving model ...
Epoch: 4 cost time: 0.49353599548339844
Epoch: 4, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.662 Vali Acc: 0.337 Test Loss: 1.662 Test Acc: 0.337
Validation loss decreased (-0.329613 --> -0.337020).  Saving model ...
Epoch: 5 cost time: 0.5047619342803955
Epoch: 5, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.622 Vali Acc: 0.344 Test Loss: 1.622 Test Acc: 0.344
Validation loss decreased (-0.337020 --> -0.344428).  Saving model ...
Epoch: 6 cost time: 0.5270745754241943
Epoch: 6, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.577 Vali Acc: 0.363 Test Loss: 1.577 Test Acc: 0.363
Validation loss decreased (-0.344428 --> -0.362947).  Saving model ...
Epoch: 7 cost time: 0.529937744140625
Epoch: 7, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.525 Vali Acc: 0.422 Test Loss: 1.525 Test Acc: 0.422
Validation loss decreased (-0.362947 --> -0.422207).  Saving model ...
Epoch: 8 cost time: 0.5498189926147461
Epoch: 8, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.470 Vali Acc: 0.456 Test Loss: 1.470 Test Acc: 0.456
Validation loss decreased (-0.422207 --> -0.455541).  Saving model ...
Epoch: 9 cost time: 0.5616705417633057
Epoch: 9, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.411 Vali Acc: 0.496 Test Loss: 1.411 Test Acc: 0.496
Validation loss decreased (-0.455541 --> -0.496282).  Saving model ...
Epoch: 10 cost time: 0.4443352222442627
Epoch: 10, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.351 Vali Acc: 0.548 Test Loss: 1.351 Test Acc: 0.548
Validation loss decreased (-0.496282 --> -0.548135).  Saving model ...
Epoch: 11 cost time: 0.5203242301940918
Epoch: 11, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.290 Vali Acc: 0.581 Test Loss: 1.290 Test Acc: 0.581
Validation loss decreased (-0.548135 --> -0.581469).  Saving model ...
Epoch: 12 cost time: 0.5149190425872803
Epoch: 12, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.227 Vali Acc: 0.619 Test Loss: 1.227 Test Acc: 0.619
Validation loss decreased (-0.581469 --> -0.618506).  Saving model ...
Epoch: 13 cost time: 0.5124292373657227
Epoch: 13, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.166 Vali Acc: 0.652 Test Loss: 1.166 Test Acc: 0.652
Validation loss decreased (-0.618506 --> -0.651840).  Saving model ...
Epoch: 14 cost time: 0.504152774810791
Epoch: 14, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.105 Vali Acc: 0.693 Test Loss: 1.105 Test Acc: 0.693
Validation loss decreased (-0.651840 --> -0.692582).  Saving model ...
Epoch: 15 cost time: 0.4800300598144531
Epoch: 15, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.046 Vali Acc: 0.719 Test Loss: 1.046 Test Acc: 0.719
Validation loss decreased (-0.692582 --> -0.718508).  Saving model ...
Epoch: 16 cost time: 0.475191593170166
Epoch: 16, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.989 Vali Acc: 0.733 Test Loss: 0.989 Test Acc: 0.733
Validation loss decreased (-0.718508 --> -0.733323).  Saving model ...
Epoch: 17 cost time: 0.466839075088501
Epoch: 17, Steps: 2 | Train Loss: 0.796 Vali Loss: 0.933 Vali Acc: 0.752 Test Loss: 0.933 Test Acc: 0.752
Validation loss decreased (-0.733323 --> -0.751843).  Saving model ...
Epoch: 18 cost time: 0.510500431060791
Epoch: 18, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.880 Vali Acc: 0.781 Test Loss: 0.880 Test Acc: 0.781
Validation loss decreased (-0.751843 --> -0.781473).  Saving model ...
Epoch: 19 cost time: 0.46851563453674316
Epoch: 19, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.829 Vali Acc: 0.804 Test Loss: 0.829 Test Acc: 0.804
Validation loss decreased (-0.781473 --> -0.803695).  Saving model ...
Epoch: 20 cost time: 0.48859643936157227
Epoch: 20, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.780 Vali Acc: 0.837 Test Loss: 0.780 Test Acc: 0.837
Validation loss decreased (-0.803695 --> -0.837029).  Saving model ...
Epoch: 21 cost time: 0.4719243049621582
Epoch: 21, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.734 Vali Acc: 0.852 Test Loss: 0.734 Test Acc: 0.852
Validation loss decreased (-0.837029 --> -0.851845).  Saving model ...
Epoch: 22 cost time: 0.5014302730560303
Epoch: 22, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.692 Vali Acc: 0.863 Test Loss: 0.692 Test Acc: 0.863
Validation loss decreased (-0.851845 --> -0.862956).  Saving model ...
Epoch: 23 cost time: 0.5305988788604736
Epoch: 23, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.652 Vali Acc: 0.867 Test Loss: 0.652 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 0.5117743015289307
Epoch: 24, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.614 Vali Acc: 0.878 Test Loss: 0.614 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 0.5435745716094971
Epoch: 25, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.579 Vali Acc: 0.881 Test Loss: 0.579 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 26 cost time: 0.508155107498169
Epoch: 26, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.546 Vali Acc: 0.904 Test Loss: 0.546 Test Acc: 0.904
Validation loss decreased (-0.881476 --> -0.903698).  Saving model ...
Epoch: 27 cost time: 0.45975208282470703
Epoch: 27, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.515 Vali Acc: 0.907 Test Loss: 0.515 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 28 cost time: 0.4856071472167969
Epoch: 28, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.485 Vali Acc: 0.911 Test Loss: 0.485 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 29 cost time: 0.4631662368774414
Epoch: 29, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.457 Vali Acc: 0.919 Test Loss: 0.457 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 30 cost time: 0.5111403465270996
Epoch: 30, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.433 Vali Acc: 0.922 Test Loss: 0.433 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 31 cost time: 0.45795202255249023
Epoch: 31, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.411 Vali Acc: 0.922 Test Loss: 0.411 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 32 cost time: 0.569821834564209
Epoch: 32, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.392 Vali Acc: 0.922 Test Loss: 0.392 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 33 cost time: 0.5007913112640381
Epoch: 33, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 34 cost time: 0.5493364334106445
Epoch: 34, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.364 Vali Acc: 0.911 Test Loss: 0.364 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5394971370697021
Epoch: 35, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.354 Vali Acc: 0.915 Test Loss: 0.354 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5273480415344238
Epoch: 36, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.343 Vali Acc: 0.915 Test Loss: 0.343 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5015876293182373
Epoch: 37, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.332 Vali Acc: 0.911 Test Loss: 0.332 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5302848815917969
Epoch: 38, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.321 Vali Acc: 0.911 Test Loss: 0.321 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6127510070800781
Epoch: 39, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.311 Vali Acc: 0.915 Test Loss: 0.311 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5613489151000977
Epoch: 40, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 41 cost time: 0.5258529186248779
Epoch: 41, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 42 cost time: 0.6977438926696777
Epoch: 42, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 43 cost time: 0.49420714378356934
Epoch: 43, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 44 cost time: 0.4421203136444092
Epoch: 44, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 45 cost time: 0.4766366481781006
Epoch: 45, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.269 Vali Acc: 0.930 Test Loss: 0.269 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 46 cost time: 0.4783806800842285
Epoch: 46, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 47 cost time: 0.43983888626098633
Epoch: 47, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 48 cost time: 0.4991793632507324
Epoch: 48, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 49 cost time: 0.47739577293395996
Epoch: 49, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 50 cost time: 0.4984130859375
Epoch: 50, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 51 cost time: 0.586118221282959
Epoch: 51, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 52 cost time: 0.5603814125061035
Epoch: 52, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 53 cost time: 0.6117746829986572
Epoch: 53, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.44055962562561035
Epoch: 54, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.4937419891357422
Epoch: 55, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5383622646331787
Epoch: 56, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.4902205467224121
Epoch: 57, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5297291278839111
Epoch: 58, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.5280370712280273
Epoch: 59, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.48961806297302246
Epoch: 60, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.5296456813812256
Epoch: 61, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.5776281356811523
Epoch: 62, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 27462
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9729926586151123
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.729 Vali Acc: 0.278 Test Loss: 1.729 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 0.4558382034301758
Epoch: 2, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.692 Vali Acc: 0.300 Test Loss: 1.692 Test Acc: 0.300
Validation loss decreased (-0.277760 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 0.43631744384765625
Epoch: 3, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.664 Vali Acc: 0.300 Test Loss: 1.664 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.45137715339660645
Epoch: 4, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.640 Vali Acc: 0.307 Test Loss: 1.640 Test Acc: 0.307
Validation loss decreased (-0.299983 --> -0.307391).  Saving model ...
Epoch: 5 cost time: 0.5066556930541992
Epoch: 5, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.612 Vali Acc: 0.322 Test Loss: 1.612 Test Acc: 0.322
Validation loss decreased (-0.307391 --> -0.322206).  Saving model ...
Epoch: 6 cost time: 0.4684734344482422
Epoch: 6, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.578 Vali Acc: 0.356 Test Loss: 1.578 Test Acc: 0.356
Validation loss decreased (-0.322206 --> -0.355540).  Saving model ...
Epoch: 7 cost time: 0.5255677700042725
Epoch: 7, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.541 Vali Acc: 0.407 Test Loss: 1.541 Test Acc: 0.407
Validation loss decreased (-0.355540 --> -0.407392).  Saving model ...
Epoch: 8 cost time: 0.5135762691497803
Epoch: 8, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.500 Vali Acc: 0.426 Test Loss: 1.500 Test Acc: 0.426
Validation loss decreased (-0.407392 --> -0.425911).  Saving model ...
Epoch: 9 cost time: 0.5225346088409424
Epoch: 9, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.456 Vali Acc: 0.456 Test Loss: 1.456 Test Acc: 0.456
Validation loss decreased (-0.425911 --> -0.455541).  Saving model ...
Epoch: 10 cost time: 0.5635833740234375
Epoch: 10, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.410 Vali Acc: 0.493 Test Loss: 1.410 Test Acc: 0.493
Validation loss decreased (-0.455541 --> -0.492578).  Saving model ...
Epoch: 11 cost time: 0.4794628620147705
Epoch: 11, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.363 Vali Acc: 0.533 Test Loss: 1.363 Test Acc: 0.533
Validation loss decreased (-0.492578 --> -0.533320).  Saving model ...
Epoch: 12 cost time: 0.49703001976013184
Epoch: 12, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.315 Vali Acc: 0.559 Test Loss: 1.315 Test Acc: 0.559
Validation loss decreased (-0.533320 --> -0.559246).  Saving model ...
Epoch: 13 cost time: 0.4060184955596924
Epoch: 13, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.267 Vali Acc: 0.585 Test Loss: 1.267 Test Acc: 0.585
Validation loss decreased (-0.559246 --> -0.585173).  Saving model ...
Epoch: 14 cost time: 0.53277587890625
Epoch: 14, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.216 Vali Acc: 0.615 Test Loss: 1.216 Test Acc: 0.615
Validation loss decreased (-0.585173 --> -0.614803).  Saving model ...
Epoch: 15 cost time: 0.5541534423828125
Epoch: 15, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.166 Vali Acc: 0.656 Test Loss: 1.166 Test Acc: 0.656
Validation loss decreased (-0.614803 --> -0.655544).  Saving model ...
Epoch: 16 cost time: 0.48336148262023926
Epoch: 16, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.116 Vali Acc: 0.681 Test Loss: 1.116 Test Acc: 0.681
Validation loss decreased (-0.655544 --> -0.681470).  Saving model ...
Epoch: 17 cost time: 0.4537088871002197
Epoch: 17, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.068 Vali Acc: 0.726 Test Loss: 1.068 Test Acc: 0.726
Validation loss decreased (-0.681470 --> -0.725915).  Saving model ...
Epoch: 18 cost time: 0.4452669620513916
Epoch: 18, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.021 Vali Acc: 0.756 Test Loss: 1.021 Test Acc: 0.756
Validation loss decreased (-0.725915 --> -0.755545).  Saving model ...
Epoch: 19 cost time: 0.43410634994506836
Epoch: 19, Steps: 2 | Train Loss: 1.045 Vali Loss: 0.975 Vali Acc: 0.781 Test Loss: 0.975 Test Acc: 0.781
Validation loss decreased (-0.755545 --> -0.781472).  Saving model ...
Epoch: 20 cost time: 0.5152766704559326
Epoch: 20, Steps: 2 | Train Loss: 1.036 Vali Loss: 0.931 Vali Acc: 0.793 Test Loss: 0.931 Test Acc: 0.793
Validation loss decreased (-0.781472 --> -0.792583).  Saving model ...
Epoch: 21 cost time: 0.45462846755981445
Epoch: 21, Steps: 2 | Train Loss: 1.120 Vali Loss: 0.888 Vali Acc: 0.815 Test Loss: 0.888 Test Acc: 0.815
Validation loss decreased (-0.792583 --> -0.814806).  Saving model ...
Epoch: 22 cost time: 0.565985918045044
Epoch: 22, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.847 Vali Acc: 0.830 Test Loss: 0.847 Test Acc: 0.830
Validation loss decreased (-0.814806 --> -0.829621).  Saving model ...
Epoch: 23 cost time: 0.5060343742370605
Epoch: 23, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.807 Vali Acc: 0.867 Test Loss: 0.807 Test Acc: 0.867
Validation loss decreased (-0.829621 --> -0.866659).  Saving model ...
Epoch: 24 cost time: 0.4840259552001953
Epoch: 24, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.769 Vali Acc: 0.874 Test Loss: 0.769 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874066).  Saving model ...
Epoch: 25 cost time: 0.490537166595459
Epoch: 25, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.733 Vali Acc: 0.893 Test Loss: 0.733 Test Acc: 0.893
Validation loss decreased (-0.874066 --> -0.892585).  Saving model ...
Epoch: 26 cost time: 0.5288815498352051
Epoch: 26, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.699 Vali Acc: 0.893 Test Loss: 0.699 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892586).  Saving model ...
Epoch: 27 cost time: 0.5073750019073486
Epoch: 27, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.667 Vali Acc: 0.893 Test Loss: 0.667 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 28 cost time: 0.516505241394043
Epoch: 28, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.636 Vali Acc: 0.900 Test Loss: 0.636 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 0.47311949729919434
Epoch: 29, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.606 Vali Acc: 0.904 Test Loss: 0.606 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 30 cost time: 0.5513577461242676
Epoch: 30, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.577 Vali Acc: 0.907 Test Loss: 0.577 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 31 cost time: 0.5109126567840576
Epoch: 31, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.551 Vali Acc: 0.915 Test Loss: 0.551 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914809).  Saving model ...
Epoch: 32 cost time: 0.4891531467437744
Epoch: 32, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.525 Vali Acc: 0.922 Test Loss: 0.525 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 33 cost time: 0.5569729804992676
Epoch: 33, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.501 Vali Acc: 0.922 Test Loss: 0.501 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 34 cost time: 0.48578858375549316
Epoch: 34, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.478 Vali Acc: 0.922 Test Loss: 0.478 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 35 cost time: 0.4985358715057373
Epoch: 35, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.456 Vali Acc: 0.926 Test Loss: 0.456 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 36 cost time: 0.5209696292877197
Epoch: 36, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.437 Vali Acc: 0.922 Test Loss: 0.437 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5368847846984863
Epoch: 37, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.417 Vali Acc: 0.922 Test Loss: 0.417 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5327930450439453
Epoch: 38, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.400 Vali Acc: 0.922 Test Loss: 0.400 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.47132205963134766
Epoch: 39, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.385 Vali Acc: 0.930 Test Loss: 0.385 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929626).  Saving model ...
Epoch: 40 cost time: 0.481975793838501
Epoch: 40, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.371 Vali Acc: 0.930 Test Loss: 0.371 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 41 cost time: 0.5008399486541748
Epoch: 41, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.358 Vali Acc: 0.933 Test Loss: 0.358 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 42 cost time: 0.5176575183868408
Epoch: 42, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.346 Vali Acc: 0.937 Test Loss: 0.346 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 43 cost time: 0.5014688968658447
Epoch: 43, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.335 Vali Acc: 0.937 Test Loss: 0.335 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 44 cost time: 0.5272300243377686
Epoch: 44, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.326 Vali Acc: 0.933 Test Loss: 0.326 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.49486827850341797
Epoch: 45, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.316 Vali Acc: 0.933 Test Loss: 0.316 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5469567775726318
Epoch: 46, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5011990070343018
Epoch: 47, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.45229458808898926
Epoch: 48, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.293 Vali Acc: 0.933 Test Loss: 0.293 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.52524733543396
Epoch: 49, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5375502109527588
Epoch: 50, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.48612022399902344
Epoch: 51, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5657880306243896
Epoch: 52, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5504570007324219
Epoch: 53, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 24486
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2531604766845703
Epoch: 1, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.755 Vali Acc: 0.296 Test Loss: 1.755 Test Acc: 0.296
Validation loss decreased (inf --> -0.296279).  Saving model ...
Epoch: 2 cost time: 0.5206904411315918
Epoch: 2, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.701 Vali Acc: 0.319 Test Loss: 1.701 Test Acc: 0.319
Validation loss decreased (-0.296279 --> -0.318502).  Saving model ...
Epoch: 3 cost time: 0.4788482189178467
Epoch: 3, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.662 Vali Acc: 0.333 Test Loss: 1.662 Test Acc: 0.333
Validation loss decreased (-0.318502 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 0.49172472953796387
Epoch: 4, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.632 Vali Acc: 0.356 Test Loss: 1.632 Test Acc: 0.356
Validation loss decreased (-0.333317 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 0.5460257530212402
Epoch: 5, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.599 Vali Acc: 0.370 Test Loss: 1.599 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 6 cost time: 0.5452356338500977
Epoch: 6, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.564 Vali Acc: 0.385 Test Loss: 1.564 Test Acc: 0.385
Validation loss decreased (-0.370354 --> -0.385170).  Saving model ...
Epoch: 7 cost time: 0.5340235233306885
Epoch: 7, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.527 Vali Acc: 0.419 Test Loss: 1.527 Test Acc: 0.419
Validation loss decreased (-0.385170 --> -0.418503).  Saving model ...
Epoch: 8 cost time: 0.5270359516143799
Epoch: 8, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.488 Vali Acc: 0.444 Test Loss: 1.488 Test Acc: 0.444
Validation loss decreased (-0.418503 --> -0.444430).  Saving model ...
Epoch: 9 cost time: 0.5773289203643799
Epoch: 9, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.447 Vali Acc: 0.478 Test Loss: 1.447 Test Acc: 0.478
Validation loss decreased (-0.444430 --> -0.477763).  Saving model ...
Epoch: 10 cost time: 0.5057377815246582
Epoch: 10, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.405 Vali Acc: 0.500 Test Loss: 1.405 Test Acc: 0.500
Validation loss decreased (-0.477763 --> -0.499986).  Saving model ...
Epoch: 11 cost time: 0.5641043186187744
Epoch: 11, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.362 Vali Acc: 0.530 Test Loss: 1.362 Test Acc: 0.530
Validation loss decreased (-0.499986 --> -0.529616).  Saving model ...
Epoch: 12 cost time: 0.5466625690460205
Epoch: 12, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.317 Vali Acc: 0.556 Test Loss: 1.317 Test Acc: 0.556
Validation loss decreased (-0.529616 --> -0.555542).  Saving model ...
Epoch: 13 cost time: 0.5247745513916016
Epoch: 13, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.271 Vali Acc: 0.581 Test Loss: 1.271 Test Acc: 0.581
Validation loss decreased (-0.555542 --> -0.581469).  Saving model ...
Epoch: 14 cost time: 0.5105259418487549
Epoch: 14, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.225 Vali Acc: 0.604 Test Loss: 1.225 Test Acc: 0.604
Validation loss decreased (-0.581469 --> -0.603691).  Saving model ...
Epoch: 15 cost time: 0.539513349533081
Epoch: 15, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.180 Vali Acc: 0.622 Test Loss: 1.180 Test Acc: 0.622
Validation loss decreased (-0.603691 --> -0.622210).  Saving model ...
Epoch: 16 cost time: 0.5469658374786377
Epoch: 16, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.134 Vali Acc: 0.652 Test Loss: 1.134 Test Acc: 0.652
Validation loss decreased (-0.622210 --> -0.651841).  Saving model ...
Epoch: 17 cost time: 0.6298229694366455
Epoch: 17, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.089 Vali Acc: 0.696 Test Loss: 1.089 Test Acc: 0.696
Validation loss decreased (-0.651841 --> -0.696285).  Saving model ...
Epoch: 18 cost time: 0.5415661334991455
Epoch: 18, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.045 Vali Acc: 0.737 Test Loss: 1.045 Test Acc: 0.737
Validation loss decreased (-0.696285 --> -0.737027).  Saving model ...
Epoch: 19 cost time: 0.46646690368652344
Epoch: 19, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.002 Vali Acc: 0.778 Test Loss: 1.002 Test Acc: 0.778
Validation loss decreased (-0.737027 --> -0.777768).  Saving model ...
Epoch: 20 cost time: 0.5591812133789062
Epoch: 20, Steps: 2 | Train Loss: 0.961 Vali Loss: 0.961 Vali Acc: 0.796 Test Loss: 0.961 Test Acc: 0.796
Validation loss decreased (-0.777768 --> -0.796287).  Saving model ...
Epoch: 21 cost time: 0.4906437397003174
Epoch: 21, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.922 Vali Acc: 0.830 Test Loss: 0.922 Test Acc: 0.830
Validation loss decreased (-0.796287 --> -0.829620).  Saving model ...
Epoch: 22 cost time: 0.5500516891479492
Epoch: 22, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.884 Vali Acc: 0.848 Test Loss: 0.884 Test Acc: 0.848
Validation loss decreased (-0.829620 --> -0.848139).  Saving model ...
Epoch: 23 cost time: 0.5618579387664795
Epoch: 23, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.848 Vali Acc: 0.856 Test Loss: 0.848 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855547).  Saving model ...
Epoch: 24 cost time: 0.5866732597351074
Epoch: 24, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.813 Vali Acc: 0.859 Test Loss: 0.813 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859251).  Saving model ...
Epoch: 25 cost time: 0.5143067836761475
Epoch: 25, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.779 Vali Acc: 0.870 Test Loss: 0.779 Test Acc: 0.870
Validation loss decreased (-0.859251 --> -0.870363).  Saving model ...
Epoch: 26 cost time: 0.54398512840271
Epoch: 26, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.746 Vali Acc: 0.881 Test Loss: 0.746 Test Acc: 0.881
Validation loss decreased (-0.870363 --> -0.881474).  Saving model ...
Epoch: 27 cost time: 0.5376834869384766
Epoch: 27, Steps: 2 | Train Loss: 0.640 Vali Loss: 0.714 Vali Acc: 0.896 Test Loss: 0.714 Test Acc: 0.896
Validation loss decreased (-0.881474 --> -0.896289).  Saving model ...
Epoch: 28 cost time: 0.5107159614562988
Epoch: 28, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.683 Vali Acc: 0.900 Test Loss: 0.683 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 0.5265135765075684
Epoch: 29, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.654 Vali Acc: 0.904 Test Loss: 0.654 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 30 cost time: 0.5678062438964844
Epoch: 30, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.626 Vali Acc: 0.907 Test Loss: 0.626 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 31 cost time: 0.5256102085113525
Epoch: 31, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.599 Vali Acc: 0.915 Test Loss: 0.599 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 32 cost time: 0.5129837989807129
Epoch: 32, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.575 Vali Acc: 0.922 Test Loss: 0.575 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922216).  Saving model ...
Epoch: 33 cost time: 0.4928476810455322
Epoch: 33, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.553 Vali Acc: 0.922 Test Loss: 0.553 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 34 cost time: 0.6200287342071533
Epoch: 34, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.532 Vali Acc: 0.926 Test Loss: 0.532 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 35 cost time: 0.4922828674316406
Epoch: 35, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.511 Vali Acc: 0.930 Test Loss: 0.511 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 36 cost time: 0.4854738712310791
Epoch: 36, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.493 Vali Acc: 0.930 Test Loss: 0.493 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 37 cost time: 0.5533547401428223
Epoch: 37, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.476 Vali Acc: 0.933 Test Loss: 0.476 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 38 cost time: 0.474078893661499
Epoch: 38, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.459 Vali Acc: 0.933 Test Loss: 0.459 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 0.5251510143280029
Epoch: 39, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.443 Vali Acc: 0.933 Test Loss: 0.443 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 40 cost time: 0.48819828033447266
Epoch: 40, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.429 Vali Acc: 0.937 Test Loss: 0.429 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 41 cost time: 0.5580341815948486
Epoch: 41, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.416 Vali Acc: 0.941 Test Loss: 0.416 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 42 cost time: 0.62406325340271
Epoch: 42, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.403 Vali Acc: 0.941 Test Loss: 0.403 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 43 cost time: 0.5756494998931885
Epoch: 43, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.392 Vali Acc: 0.941 Test Loss: 0.392 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 44 cost time: 0.44668030738830566
Epoch: 44, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.381 Vali Acc: 0.941 Test Loss: 0.381 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 45 cost time: 0.5383200645446777
Epoch: 45, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.372 Vali Acc: 0.944 Test Loss: 0.372 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 46 cost time: 0.5152454376220703
Epoch: 46, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.364 Vali Acc: 0.944 Test Loss: 0.364 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 47 cost time: 0.5075533390045166
Epoch: 47, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.355 Vali Acc: 0.944 Test Loss: 0.355 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 48 cost time: 0.5962023735046387
Epoch: 48, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.348 Vali Acc: 0.941 Test Loss: 0.348 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5342135429382324
Epoch: 49, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.340 Vali Acc: 0.944 Test Loss: 0.340 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 50 cost time: 0.4593939781188965
Epoch: 50, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.334 Vali Acc: 0.944 Test Loss: 0.334 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 51 cost time: 0.5247316360473633
Epoch: 51, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.328 Vali Acc: 0.944 Test Loss: 0.328 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 52 cost time: 0.5719857215881348
Epoch: 52, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 53 cost time: 0.5132007598876953
Epoch: 53, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.316 Vali Acc: 0.948 Test Loss: 0.316 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 54 cost time: 0.49881768226623535
Epoch: 54, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.311 Vali Acc: 0.937 Test Loss: 0.311 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6134188175201416
Epoch: 55, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.4814610481262207
Epoch: 56, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.302 Vali Acc: 0.937 Test Loss: 0.302 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5559349060058594
Epoch: 57, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.297 Vali Acc: 0.937 Test Loss: 0.297 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.5197453498840332
Epoch: 58, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.294 Vali Acc: 0.937 Test Loss: 0.294 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5508747100830078
Epoch: 59, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.290 Vali Acc: 0.937 Test Loss: 0.290 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.5297760963439941
Epoch: 60, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.286 Vali Acc: 0.937 Test Loss: 0.286 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.5401184558868408
Epoch: 61, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.5229439735412598
Epoch: 62, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.279 Vali Acc: 0.937 Test Loss: 0.279 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.549952507019043
Epoch: 63, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm32_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 23078
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0473787784576416
Epoch: 1, Steps: 2 | Train Loss: 2.073 Vali Loss: 1.895 Vali Acc: 0.167 Test Loss: 1.895 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.46590399742126465
Epoch: 2, Steps: 2 | Train Loss: 2.127 Vali Loss: 1.838 Vali Acc: 0.178 Test Loss: 1.838 Test Acc: 0.178
Validation loss decreased (-0.166648 --> -0.177759).  Saving model ...
Epoch: 3 cost time: 0.5405178070068359
Epoch: 3, Steps: 2 | Train Loss: 1.960 Vali Loss: 1.789 Vali Acc: 0.196 Test Loss: 1.789 Test Acc: 0.196
Validation loss decreased (-0.177759 --> -0.196278).  Saving model ...
Epoch: 4 cost time: 0.510819673538208
Epoch: 4, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.729 Vali Acc: 0.230 Test Loss: 1.729 Test Acc: 0.230
Validation loss decreased (-0.196278 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.5169484615325928
Epoch: 5, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.651 Vali Acc: 0.304 Test Loss: 1.651 Test Acc: 0.304
Validation loss decreased (-0.229612 --> -0.303687).  Saving model ...
Epoch: 6 cost time: 0.5243525505065918
Epoch: 6, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.563 Vali Acc: 0.452 Test Loss: 1.563 Test Acc: 0.452
Validation loss decreased (-0.303687 --> -0.451836).  Saving model ...
Epoch: 7 cost time: 0.5057957172393799
Epoch: 7, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.466 Vali Acc: 0.537 Test Loss: 1.466 Test Acc: 0.537
Validation loss decreased (-0.451836 --> -0.537022).  Saving model ...
Epoch: 8 cost time: 0.5352261066436768
Epoch: 8, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.363 Vali Acc: 0.626 Test Loss: 1.363 Test Acc: 0.626
Validation loss decreased (-0.537022 --> -0.625912).  Saving model ...
Epoch: 9 cost time: 0.5834071636199951
Epoch: 9, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.256 Vali Acc: 0.693 Test Loss: 1.256 Test Acc: 0.693
Validation loss decreased (-0.625912 --> -0.692580).  Saving model ...
Epoch: 10 cost time: 0.5522937774658203
Epoch: 10, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.147 Vali Acc: 0.748 Test Loss: 1.147 Test Acc: 0.748
Validation loss decreased (-0.692580 --> -0.748137).  Saving model ...
Epoch: 11 cost time: 0.5527651309967041
Epoch: 11, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.042 Vali Acc: 0.778 Test Loss: 1.042 Test Acc: 0.778
Validation loss decreased (-0.748137 --> -0.777767).  Saving model ...
Epoch: 12 cost time: 0.5837631225585938
Epoch: 12, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.945 Vali Acc: 0.789 Test Loss: 0.945 Test Acc: 0.789
Validation loss decreased (-0.777767 --> -0.788879).  Saving model ...
Epoch: 13 cost time: 0.5046243667602539
Epoch: 13, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.853 Vali Acc: 0.826 Test Loss: 0.853 Test Acc: 0.826
Validation loss decreased (-0.788879 --> -0.825917).  Saving model ...
Epoch: 14 cost time: 0.5335757732391357
Epoch: 14, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.770 Vali Acc: 0.885 Test Loss: 0.770 Test Acc: 0.885
Validation loss decreased (-0.825917 --> -0.885177).  Saving model ...
Epoch: 15 cost time: 0.5454845428466797
Epoch: 15, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.695 Vali Acc: 0.900 Test Loss: 0.695 Test Acc: 0.900
Validation loss decreased (-0.885177 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 0.5488879680633545
Epoch: 16, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.630 Vali Acc: 0.907 Test Loss: 0.630 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907401).  Saving model ...
Epoch: 17 cost time: 0.47771120071411133
Epoch: 17, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.571 Vali Acc: 0.907 Test Loss: 0.571 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 18 cost time: 0.5074379444122314
Epoch: 18, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.519 Vali Acc: 0.915 Test Loss: 0.519 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 19 cost time: 0.5333099365234375
Epoch: 19, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.472 Vali Acc: 0.911 Test Loss: 0.472 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5534770488739014
Epoch: 20, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.429 Vali Acc: 0.922 Test Loss: 0.429 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 21 cost time: 0.5130245685577393
Epoch: 21, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.390 Vali Acc: 0.926 Test Loss: 0.390 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.48520731925964355
Epoch: 22, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.356 Vali Acc: 0.930 Test Loss: 0.356 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 23 cost time: 0.5935835838317871
Epoch: 23, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.327 Vali Acc: 0.933 Test Loss: 0.327 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 24 cost time: 0.588761568069458
Epoch: 24, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 25 cost time: 0.6256453990936279
Epoch: 25, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.5359373092651367
Epoch: 26, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.510061502456665
Epoch: 27, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.5259685516357422
Epoch: 28, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.49219703674316406
Epoch: 29, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5150926113128662
Epoch: 30, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6702933311462402
Epoch: 31, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5310554504394531
Epoch: 32, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6319429874420166
Epoch: 33, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.498368501663208
Epoch: 34, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5451226234436035
Epoch: 35, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5456476211547852
Epoch: 36, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.591388463973999
Epoch: 37, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5075497627258301
Epoch: 38, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6436662673950195
Epoch: 39, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5854384899139404
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.49524950981140137
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5223090648651123
Epoch: 42, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5495448112487793
Epoch: 43, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 44262
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1094019412994385
Epoch: 1, Steps: 2 | Train Loss: 1.968 Vali Loss: 1.819 Vali Acc: 0.119 Test Loss: 1.819 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.6494204998016357
Epoch: 2, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.786 Vali Acc: 0.141 Test Loss: 1.786 Test Acc: 0.141
Validation loss decreased (-0.118500 --> -0.140723).  Saving model ...
Epoch: 3 cost time: 0.5564918518066406
Epoch: 3, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.759 Vali Acc: 0.200 Test Loss: 1.759 Test Acc: 0.200
Validation loss decreased (-0.140723 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.4939560890197754
Epoch: 4, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.732 Vali Acc: 0.270 Test Loss: 1.732 Test Acc: 0.270
Validation loss decreased (-0.199982 --> -0.270353).  Saving model ...
Epoch: 5 cost time: 0.4781820774078369
Epoch: 5, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.696 Vali Acc: 0.307 Test Loss: 1.696 Test Acc: 0.307
Validation loss decreased (-0.270353 --> -0.307390).  Saving model ...
Epoch: 6 cost time: 0.5411112308502197
Epoch: 6, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.652 Vali Acc: 0.330 Test Loss: 1.652 Test Acc: 0.330
Validation loss decreased (-0.307390 --> -0.329613).  Saving model ...
Epoch: 7 cost time: 0.44904136657714844
Epoch: 7, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.601 Vali Acc: 0.352 Test Loss: 1.601 Test Acc: 0.352
Validation loss decreased (-0.329613 --> -0.351836).  Saving model ...
Epoch: 8 cost time: 0.5230965614318848
Epoch: 8, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.544 Vali Acc: 0.381 Test Loss: 1.544 Test Acc: 0.381
Validation loss decreased (-0.351836 --> -0.381466).  Saving model ...
Epoch: 9 cost time: 0.44095873832702637
Epoch: 9, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.482 Vali Acc: 0.415 Test Loss: 1.482 Test Acc: 0.415
Validation loss decreased (-0.381466 --> -0.414800).  Saving model ...
Epoch: 10 cost time: 0.43698787689208984
Epoch: 10, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.417 Vali Acc: 0.489 Test Loss: 1.417 Test Acc: 0.489
Validation loss decreased (-0.414800 --> -0.488875).  Saving model ...
Epoch: 11 cost time: 0.5148026943206787
Epoch: 11, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.350 Vali Acc: 0.530 Test Loss: 1.350 Test Acc: 0.530
Validation loss decreased (-0.488875 --> -0.529616).  Saving model ...
Epoch: 12 cost time: 0.49596309661865234
Epoch: 12, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.281 Vali Acc: 0.570 Test Loss: 1.281 Test Acc: 0.570
Validation loss decreased (-0.529616 --> -0.570358).  Saving model ...
Epoch: 13 cost time: 0.5679111480712891
Epoch: 13, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.213 Vali Acc: 0.619 Test Loss: 1.213 Test Acc: 0.619
Validation loss decreased (-0.570358 --> -0.618506).  Saving model ...
Epoch: 14 cost time: 0.5485639572143555
Epoch: 14, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.145 Vali Acc: 0.674 Test Loss: 1.145 Test Acc: 0.674
Validation loss decreased (-0.618506 --> -0.674063).  Saving model ...
Epoch: 15 cost time: 0.4827260971069336
Epoch: 15, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.079 Vali Acc: 0.715 Test Loss: 1.079 Test Acc: 0.715
Validation loss decreased (-0.674063 --> -0.714804).  Saving model ...
Epoch: 16 cost time: 0.5589983463287354
Epoch: 16, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.013 Vali Acc: 0.748 Test Loss: 1.013 Test Acc: 0.748
Validation loss decreased (-0.714804 --> -0.748138).  Saving model ...
Epoch: 17 cost time: 0.5008258819580078
Epoch: 17, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.950 Vali Acc: 0.778 Test Loss: 0.950 Test Acc: 0.778
Validation loss decreased (-0.748138 --> -0.777768).  Saving model ...
Epoch: 18 cost time: 0.43361687660217285
Epoch: 18, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.887 Vali Acc: 0.793 Test Loss: 0.887 Test Acc: 0.793
Validation loss decreased (-0.777768 --> -0.792584).  Saving model ...
Epoch: 19 cost time: 0.48880577087402344
Epoch: 19, Steps: 2 | Train Loss: 0.726 Vali Loss: 0.827 Vali Acc: 0.807 Test Loss: 0.827 Test Acc: 0.807
Validation loss decreased (-0.792584 --> -0.807399).  Saving model ...
Epoch: 20 cost time: 0.5339183807373047
Epoch: 20, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.770 Vali Acc: 0.822 Test Loss: 0.770 Test Acc: 0.822
Validation loss decreased (-0.807399 --> -0.822215).  Saving model ...
Epoch: 21 cost time: 0.4334256649017334
Epoch: 21, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.715 Vali Acc: 0.859 Test Loss: 0.715 Test Acc: 0.859
Validation loss decreased (-0.822215 --> -0.859252).  Saving model ...
Epoch: 22 cost time: 0.5509021282196045
Epoch: 22, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.666 Vali Acc: 0.878 Test Loss: 0.666 Test Acc: 0.878
Validation loss decreased (-0.859252 --> -0.877771).  Saving model ...
Epoch: 23 cost time: 0.4847240447998047
Epoch: 23, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.621 Vali Acc: 0.881 Test Loss: 0.621 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 24 cost time: 0.45381617546081543
Epoch: 24, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.580 Vali Acc: 0.885 Test Loss: 0.580 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 25 cost time: 0.4671173095703125
Epoch: 25, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.541 Vali Acc: 0.889 Test Loss: 0.541 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 26 cost time: 0.47286295890808105
Epoch: 26, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.509 Vali Acc: 0.893 Test Loss: 0.509 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892588).  Saving model ...
Epoch: 27 cost time: 0.5242364406585693
Epoch: 27, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.481 Vali Acc: 0.893 Test Loss: 0.481 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 28 cost time: 0.4600338935852051
Epoch: 28, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.454 Vali Acc: 0.893 Test Loss: 0.454 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 29 cost time: 0.4800410270690918
Epoch: 29, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
Validation loss decreased (-0.892588 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 0.5361497402191162
Epoch: 30, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.407 Vali Acc: 0.907 Test Loss: 0.407 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907403).  Saving model ...
Epoch: 31 cost time: 0.5524067878723145
Epoch: 31, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.388 Vali Acc: 0.907 Test Loss: 0.388 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 32 cost time: 0.5433323383331299
Epoch: 32, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.373 Vali Acc: 0.911 Test Loss: 0.373 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911107).  Saving model ...
Epoch: 33 cost time: 0.5133230686187744
Epoch: 33, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.358 Vali Acc: 0.911 Test Loss: 0.358 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 34 cost time: 0.492647647857666
Epoch: 34, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.346 Vali Acc: 0.915 Test Loss: 0.346 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914811).  Saving model ...
Epoch: 35 cost time: 0.6107590198516846
Epoch: 35, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.336 Vali Acc: 0.915 Test Loss: 0.336 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 36 cost time: 0.5816788673400879
Epoch: 36, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.326 Vali Acc: 0.915 Test Loss: 0.326 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 37 cost time: 0.5349562168121338
Epoch: 37, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.318 Vali Acc: 0.915 Test Loss: 0.318 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 38 cost time: 0.48586416244506836
Epoch: 38, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.310 Vali Acc: 0.915 Test Loss: 0.310 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 39 cost time: 0.5680806636810303
Epoch: 39, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.302 Vali Acc: 0.915 Test Loss: 0.302 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 40 cost time: 0.5845315456390381
Epoch: 40, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 41 cost time: 0.5338661670684814
Epoch: 41, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 42 cost time: 0.6252617835998535
Epoch: 42, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.285 Vali Acc: 0.919 Test Loss: 0.285 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 43 cost time: 0.5232493877410889
Epoch: 43, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.280 Vali Acc: 0.919 Test Loss: 0.280 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 44 cost time: 0.48865604400634766
Epoch: 44, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.275 Vali Acc: 0.919 Test Loss: 0.275 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 45 cost time: 0.5314810276031494
Epoch: 45, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 46 cost time: 0.4552631378173828
Epoch: 46, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 47 cost time: 0.5196244716644287
Epoch: 47, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.266 Vali Acc: 0.919 Test Loss: 0.266 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 48 cost time: 0.5491507053375244
Epoch: 48, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 49 cost time: 0.4989490509033203
Epoch: 49, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 50 cost time: 0.5189971923828125
Epoch: 50, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 51 cost time: 0.4884834289550781
Epoch: 51, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.257 Vali Acc: 0.922 Test Loss: 0.257 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 52 cost time: 0.4702134132385254
Epoch: 52, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 53 cost time: 0.5159151554107666
Epoch: 53, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 54 cost time: 0.5763697624206543
Epoch: 54, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 55 cost time: 0.5276749134063721
Epoch: 55, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 56 cost time: 0.46744275093078613
Epoch: 56, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 57 cost time: 0.5356194972991943
Epoch: 57, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 58 cost time: 0.5279297828674316
Epoch: 58, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 59 cost time: 0.5581557750701904
Epoch: 59, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 60 cost time: 0.620079755783081
Epoch: 60, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 61 cost time: 0.44608449935913086
Epoch: 61, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 62 cost time: 0.46619367599487305
Epoch: 62, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 63 cost time: 0.546044111251831
Epoch: 63, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 64 cost time: 0.456958532333374
Epoch: 64, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 65 cost time: 0.4332432746887207
Epoch: 65, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 66 cost time: 0.5242407321929932
Epoch: 66, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 67 cost time: 0.46726274490356445
Epoch: 67, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 68 cost time: 0.4967982769012451
Epoch: 68, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 69 cost time: 0.49059009552001953
Epoch: 69, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 70 cost time: 0.48708558082580566
Epoch: 70, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 71 cost time: 0.4734189510345459
Epoch: 71, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 72 cost time: 0.5058009624481201
Epoch: 72, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 73 cost time: 0.47462892532348633
Epoch: 73, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 74 cost time: 0.46718835830688477
Epoch: 74, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 75 cost time: 0.45818138122558594
Epoch: 75, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 76 cost time: 0.5477452278137207
Epoch: 76, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 77 cost time: 0.5063176155090332
Epoch: 77, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 78 cost time: 0.5031616687774658
Epoch: 78, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 79 cost time: 0.5583109855651855
Epoch: 79, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 80 cost time: 0.5009281635284424
Epoch: 80, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 81 cost time: 0.5863699913024902
Epoch: 81, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 82 cost time: 0.43555188179016113
Epoch: 82, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 83 cost time: 0.46404170989990234
Epoch: 83, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 84 cost time: 0.442608118057251
Epoch: 84, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 85 cost time: 0.5323958396911621
Epoch: 85, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 86 cost time: 0.47139430046081543
Epoch: 86, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.46773529052734375
Epoch: 87, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 88 cost time: 0.44783616065979004
Epoch: 88, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 89 cost time: 0.4940605163574219
Epoch: 89, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 90 cost time: 0.469775915145874
Epoch: 90, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 91 cost time: 0.4552948474884033
Epoch: 91, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 92 cost time: 0.3976130485534668
Epoch: 92, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 93 cost time: 0.558464527130127
Epoch: 93, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 94 cost time: 0.47205066680908203
Epoch: 94, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 95 cost time: 0.49747228622436523
Epoch: 95, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 96 cost time: 0.5416719913482666
Epoch: 96, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 97 cost time: 0.5180304050445557
Epoch: 97, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 98 cost time: 0.5259828567504883
Epoch: 98, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 99 cost time: 0.5232787132263184
Epoch: 99, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 100 cost time: 0.4769020080566406
Epoch: 100, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 31622
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0551443099975586
Epoch: 1, Steps: 2 | Train Loss: 2.049 Vali Loss: 2.030 Vali Acc: 0.219 Test Loss: 2.030 Test Acc: 0.219
Validation loss decreased (inf --> -0.218498).  Saving model ...
Epoch: 2 cost time: 0.6069574356079102
Epoch: 2, Steps: 2 | Train Loss: 2.060 Vali Loss: 1.982 Vali Acc: 0.230 Test Loss: 1.982 Test Acc: 0.230
Validation loss decreased (-0.218498 --> -0.229610).  Saving model ...
Epoch: 3 cost time: 0.5350940227508545
Epoch: 3, Steps: 2 | Train Loss: 1.923 Vali Loss: 1.946 Vali Acc: 0.226 Test Loss: 1.946 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4339289665222168
Epoch: 4, Steps: 2 | Train Loss: 1.961 Vali Loss: 1.912 Vali Acc: 0.237 Test Loss: 1.912 Test Acc: 0.237
Validation loss decreased (-0.229610 --> -0.237018).  Saving model ...
Epoch: 5 cost time: 0.4981679916381836
Epoch: 5, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.870 Vali Acc: 0.241 Test Loss: 1.870 Test Acc: 0.241
Validation loss decreased (-0.237018 --> -0.240722).  Saving model ...
Epoch: 6 cost time: 0.519240140914917
Epoch: 6, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.821 Vali Acc: 0.244 Test Loss: 1.821 Test Acc: 0.244
Validation loss decreased (-0.240722 --> -0.244426).  Saving model ...
Epoch: 7 cost time: 0.48018717765808105
Epoch: 7, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.767 Vali Acc: 0.267 Test Loss: 1.767 Test Acc: 0.267
Validation loss decreased (-0.244426 --> -0.266649).  Saving model ...
Epoch: 8 cost time: 0.5224342346191406
Epoch: 8, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.707 Vali Acc: 0.289 Test Loss: 1.707 Test Acc: 0.289
Validation loss decreased (-0.266649 --> -0.288872).  Saving model ...
Epoch: 9 cost time: 0.5516932010650635
Epoch: 9, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.644 Vali Acc: 0.315 Test Loss: 1.644 Test Acc: 0.315
Validation loss decreased (-0.288872 --> -0.314798).  Saving model ...
Epoch: 10 cost time: 0.4745604991912842
Epoch: 10, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.577 Vali Acc: 0.356 Test Loss: 1.577 Test Acc: 0.356
Validation loss decreased (-0.314798 --> -0.355540).  Saving model ...
Epoch: 11 cost time: 0.5143427848815918
Epoch: 11, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.510 Vali Acc: 0.426 Test Loss: 1.510 Test Acc: 0.426
Validation loss decreased (-0.355540 --> -0.425911).  Saving model ...
Epoch: 12 cost time: 0.5080299377441406
Epoch: 12, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.441 Vali Acc: 0.470 Test Loss: 1.441 Test Acc: 0.470
Validation loss decreased (-0.425911 --> -0.470356).  Saving model ...
Epoch: 13 cost time: 0.504814624786377
Epoch: 13, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.371 Vali Acc: 0.507 Test Loss: 1.371 Test Acc: 0.507
Validation loss decreased (-0.470356 --> -0.507394).  Saving model ...
Epoch: 14 cost time: 0.5746212005615234
Epoch: 14, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.302 Vali Acc: 0.556 Test Loss: 1.302 Test Acc: 0.556
Validation loss decreased (-0.507394 --> -0.555543).  Saving model ...
Epoch: 15 cost time: 0.5209074020385742
Epoch: 15, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.235 Vali Acc: 0.630 Test Loss: 1.235 Test Acc: 0.630
Validation loss decreased (-0.555543 --> -0.629617).  Saving model ...
Epoch: 16 cost time: 0.5150768756866455
Epoch: 16, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.168 Vali Acc: 0.681 Test Loss: 1.168 Test Acc: 0.681
Validation loss decreased (-0.629617 --> -0.681470).  Saving model ...
Epoch: 17 cost time: 0.5194737911224365
Epoch: 17, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.102 Vali Acc: 0.711 Test Loss: 1.102 Test Acc: 0.711
Validation loss decreased (-0.681470 --> -0.711100).  Saving model ...
Epoch: 18 cost time: 0.6208159923553467
Epoch: 18, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.038 Vali Acc: 0.748 Test Loss: 1.038 Test Acc: 0.748
Validation loss decreased (-0.711100 --> -0.748138).  Saving model ...
Epoch: 19 cost time: 0.5132982730865479
Epoch: 19, Steps: 2 | Train Loss: 0.900 Vali Loss: 0.975 Vali Acc: 0.789 Test Loss: 0.975 Test Acc: 0.789
Validation loss decreased (-0.748138 --> -0.788879).  Saving model ...
Epoch: 20 cost time: 0.541557788848877
Epoch: 20, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.915 Vali Acc: 0.819 Test Loss: 0.915 Test Acc: 0.819
Validation loss decreased (-0.788879 --> -0.818509).  Saving model ...
Epoch: 21 cost time: 0.469646692276001
Epoch: 21, Steps: 2 | Train Loss: 0.852 Vali Loss: 0.859 Vali Acc: 0.830 Test Loss: 0.859 Test Acc: 0.830
Validation loss decreased (-0.818509 --> -0.829621).  Saving model ...
Epoch: 22 cost time: 0.4906275272369385
Epoch: 22, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.805 Vali Acc: 0.848 Test Loss: 0.805 Test Acc: 0.848
Validation loss decreased (-0.829621 --> -0.848140).  Saving model ...
Epoch: 23 cost time: 0.5000529289245605
Epoch: 23, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.754 Vali Acc: 0.852 Test Loss: 0.754 Test Acc: 0.852
Validation loss decreased (-0.848140 --> -0.851844).  Saving model ...
Epoch: 24 cost time: 0.5491721630096436
Epoch: 24, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.705 Vali Acc: 0.867 Test Loss: 0.705 Test Acc: 0.867
Validation loss decreased (-0.851844 --> -0.866660).  Saving model ...
Epoch: 25 cost time: 0.5336661338806152
Epoch: 25, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.660 Vali Acc: 0.874 Test Loss: 0.660 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874067).  Saving model ...
Epoch: 26 cost time: 0.5494363307952881
Epoch: 26, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.618 Vali Acc: 0.889 Test Loss: 0.618 Test Acc: 0.889
Validation loss decreased (-0.874067 --> -0.888883).  Saving model ...
Epoch: 27 cost time: 0.5247476100921631
Epoch: 27, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.581 Vali Acc: 0.893 Test Loss: 0.581 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 28 cost time: 0.5164361000061035
Epoch: 28, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.6141223907470703
Epoch: 29, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.512 Vali Acc: 0.904 Test Loss: 0.512 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 30 cost time: 0.49798059463500977
Epoch: 30, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.483 Vali Acc: 0.907 Test Loss: 0.483 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 31 cost time: 0.49746227264404297
Epoch: 31, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.457 Vali Acc: 0.915 Test Loss: 0.457 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914810).  Saving model ...
Epoch: 32 cost time: 0.4628443717956543
Epoch: 32, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.434 Vali Acc: 0.919 Test Loss: 0.434 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 33 cost time: 0.547705888748169
Epoch: 33, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.413 Vali Acc: 0.919 Test Loss: 0.413 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 34 cost time: 0.5956110954284668
Epoch: 34, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 35 cost time: 0.5284931659698486
Epoch: 35, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 36 cost time: 0.46066784858703613
Epoch: 36, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.362 Vali Acc: 0.922 Test Loss: 0.362 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 37 cost time: 0.5193383693695068
Epoch: 37, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.349 Vali Acc: 0.926 Test Loss: 0.349 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925922).  Saving model ...
Epoch: 38 cost time: 0.567603588104248
Epoch: 38, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.338 Vali Acc: 0.926 Test Loss: 0.338 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 39 cost time: 0.4903833866119385
Epoch: 39, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 40 cost time: 0.581777811050415
Epoch: 40, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.319 Vali Acc: 0.926 Test Loss: 0.319 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 41 cost time: 0.5884785652160645
Epoch: 41, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.311 Vali Acc: 0.926 Test Loss: 0.311 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 42 cost time: 0.5630366802215576
Epoch: 42, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.303 Vali Acc: 0.926 Test Loss: 0.303 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 43 cost time: 0.49382638931274414
Epoch: 43, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.297 Vali Acc: 0.926 Test Loss: 0.297 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 44 cost time: 0.5333573818206787
Epoch: 44, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.292 Vali Acc: 0.926 Test Loss: 0.292 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 45 cost time: 0.5682239532470703
Epoch: 45, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 46 cost time: 0.5169281959533691
Epoch: 46, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.281 Vali Acc: 0.926 Test Loss: 0.281 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 47 cost time: 0.506091833114624
Epoch: 47, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5867083072662354
Epoch: 48, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5536308288574219
Epoch: 49, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5235860347747803
Epoch: 50, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.48423027992248535
Epoch: 51, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6214220523834229
Epoch: 52, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5348138809204102
Epoch: 53, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.5520892143249512
Epoch: 54, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.5565807819366455
Epoch: 55, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 56 cost time: 0.44184064865112305
Epoch: 56, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 57 cost time: 0.5907702445983887
Epoch: 57, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 58 cost time: 0.6650800704956055
Epoch: 58, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 0.538963794708252
Epoch: 59, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 60 cost time: 0.5315775871276855
Epoch: 60, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 61 cost time: 0.5558393001556396
Epoch: 61, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 62 cost time: 0.5490608215332031
Epoch: 62, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 63 cost time: 0.611213207244873
Epoch: 63, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 64 cost time: 0.5578010082244873
Epoch: 64, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 65 cost time: 0.5056955814361572
Epoch: 65, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 66 cost time: 0.552473783493042
Epoch: 66, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 67 cost time: 0.5320048332214355
Epoch: 67, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 68 cost time: 0.54598069190979
Epoch: 68, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 69 cost time: 0.5548205375671387
Epoch: 69, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 70 cost time: 0.5371723175048828
Epoch: 70, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 71 cost time: 0.5014433860778809
Epoch: 71, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 72 cost time: 0.5003376007080078
Epoch: 72, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 73 cost time: 0.5156805515289307
Epoch: 73, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 74 cost time: 0.5086259841918945
Epoch: 74, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 75 cost time: 0.5146756172180176
Epoch: 75, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 76 cost time: 0.5723059177398682
Epoch: 76, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 77 cost time: 0.5826706886291504
Epoch: 77, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 78 cost time: 0.4935007095336914
Epoch: 78, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 79 cost time: 0.4886510372161865
Epoch: 79, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 80 cost time: 0.48551416397094727
Epoch: 80, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 81 cost time: 0.7630488872528076
Epoch: 81, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 82 cost time: 0.593428373336792
Epoch: 82, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 83 cost time: 0.6308441162109375
Epoch: 83, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 84 cost time: 0.5657045841217041
Epoch: 84, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 85 cost time: 0.5370736122131348
Epoch: 85, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 86 cost time: 0.5766854286193848
Epoch: 86, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 87 cost time: 0.4935417175292969
Epoch: 87, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 88 cost time: 0.45782041549682617
Epoch: 88, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 89 cost time: 0.5027320384979248
Epoch: 89, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 90 cost time: 0.5393917560577393
Epoch: 90, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 91 cost time: 0.5811812877655029
Epoch: 91, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 92 cost time: 0.562274694442749
Epoch: 92, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 93 cost time: 0.491469144821167
Epoch: 93, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 94 cost time: 0.5327177047729492
Epoch: 94, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 95 cost time: 0.5474140644073486
Epoch: 95, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 96 cost time: 0.541637659072876
Epoch: 96, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 97 cost time: 0.6025643348693848
Epoch: 97, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 98 cost time: 0.5212752819061279
Epoch: 98, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 99 cost time: 0.5422985553741455
Epoch: 99, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 100 cost time: 0.4705336093902588
Epoch: 100, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 27798
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8965938091278076
Epoch: 1, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.635 Vali Acc: 0.300 Test Loss: 1.635 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.5511586666107178
Epoch: 2, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.602 Vali Acc: 0.348 Test Loss: 1.602 Test Acc: 0.348
Validation loss decreased (-0.299984 --> -0.348132).  Saving model ...
Epoch: 3 cost time: 0.5852973461151123
Epoch: 3, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.576 Vali Acc: 0.396 Test Loss: 1.576 Test Acc: 0.396
Validation loss decreased (-0.348132 --> -0.396281).  Saving model ...
Epoch: 4 cost time: 0.4635307788848877
Epoch: 4, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.553 Vali Acc: 0.415 Test Loss: 1.553 Test Acc: 0.415
Validation loss decreased (-0.396281 --> -0.414799).  Saving model ...
Epoch: 5 cost time: 0.5101723670959473
Epoch: 5, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.526 Vali Acc: 0.452 Test Loss: 1.526 Test Acc: 0.452
Validation loss decreased (-0.414799 --> -0.451837).  Saving model ...
Epoch: 6 cost time: 0.47078657150268555
Epoch: 6, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.497 Vali Acc: 0.481 Test Loss: 1.497 Test Acc: 0.481
Validation loss decreased (-0.451837 --> -0.481467).  Saving model ...
Epoch: 7 cost time: 0.5348141193389893
Epoch: 7, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.464 Vali Acc: 0.507 Test Loss: 1.464 Test Acc: 0.507
Validation loss decreased (-0.481467 --> -0.507393).  Saving model ...
Epoch: 8 cost time: 0.4733712673187256
Epoch: 8, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.430 Vali Acc: 0.541 Test Loss: 1.430 Test Acc: 0.541
Validation loss decreased (-0.507393 --> -0.540726).  Saving model ...
Epoch: 9 cost time: 0.5119414329528809
Epoch: 9, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.392 Vali Acc: 0.567 Test Loss: 1.392 Test Acc: 0.567
Validation loss decreased (-0.540726 --> -0.566653).  Saving model ...
Epoch: 10 cost time: 0.5629165172576904
Epoch: 10, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.352 Vali Acc: 0.585 Test Loss: 1.352 Test Acc: 0.585
Validation loss decreased (-0.566653 --> -0.585172).  Saving model ...
Epoch: 11 cost time: 0.5007717609405518
Epoch: 11, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.311 Vali Acc: 0.611 Test Loss: 1.311 Test Acc: 0.611
Validation loss decreased (-0.585172 --> -0.611098).  Saving model ...
Epoch: 12 cost time: 0.5009453296661377
Epoch: 12, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.270 Vali Acc: 0.630 Test Loss: 1.270 Test Acc: 0.630
Validation loss decreased (-0.611098 --> -0.629617).  Saving model ...
Epoch: 13 cost time: 0.4843311309814453
Epoch: 13, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.228 Vali Acc: 0.648 Test Loss: 1.228 Test Acc: 0.648
Validation loss decreased (-0.629617 --> -0.648136).  Saving model ...
Epoch: 14 cost time: 0.4942162036895752
Epoch: 14, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.186 Vali Acc: 0.681 Test Loss: 1.186 Test Acc: 0.681
Validation loss decreased (-0.648136 --> -0.681470).  Saving model ...
Epoch: 15 cost time: 0.40932440757751465
Epoch: 15, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.143 Vali Acc: 0.700 Test Loss: 1.143 Test Acc: 0.700
Validation loss decreased (-0.681470 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.4681406021118164
Epoch: 16, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.099 Vali Acc: 0.726 Test Loss: 1.099 Test Acc: 0.726
Validation loss decreased (-0.699989 --> -0.725915).  Saving model ...
Epoch: 17 cost time: 0.47316741943359375
Epoch: 17, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.057 Vali Acc: 0.741 Test Loss: 1.057 Test Acc: 0.741
Validation loss decreased (-0.725915 --> -0.740730).  Saving model ...
Epoch: 18 cost time: 0.5029821395874023
Epoch: 18, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.015 Vali Acc: 0.759 Test Loss: 1.015 Test Acc: 0.759
Validation loss decreased (-0.740730 --> -0.759249).  Saving model ...
Epoch: 19 cost time: 0.48546791076660156
Epoch: 19, Steps: 2 | Train Loss: 0.894 Vali Loss: 0.973 Vali Acc: 0.774 Test Loss: 0.973 Test Acc: 0.774
Validation loss decreased (-0.759249 --> -0.774064).  Saving model ...
Epoch: 20 cost time: 0.5423171520233154
Epoch: 20, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.931 Vali Acc: 0.807 Test Loss: 0.931 Test Acc: 0.807
Validation loss decreased (-0.774064 --> -0.807398).  Saving model ...
Epoch: 21 cost time: 0.5176033973693848
Epoch: 21, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.889 Vali Acc: 0.822 Test Loss: 0.889 Test Acc: 0.822
Validation loss decreased (-0.807398 --> -0.822213).  Saving model ...
Epoch: 22 cost time: 0.5243229866027832
Epoch: 22, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.850 Vali Acc: 0.859 Test Loss: 0.850 Test Acc: 0.859
Validation loss decreased (-0.822213 --> -0.859251).  Saving model ...
Epoch: 23 cost time: 0.5513567924499512
Epoch: 23, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.812 Vali Acc: 0.863 Test Loss: 0.812 Test Acc: 0.863
Validation loss decreased (-0.859251 --> -0.862955).  Saving model ...
Epoch: 24 cost time: 0.5001914501190186
Epoch: 24, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.776 Vali Acc: 0.867 Test Loss: 0.776 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866659).  Saving model ...
Epoch: 25 cost time: 0.5038571357727051
Epoch: 25, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.741 Vali Acc: 0.870 Test Loss: 0.741 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 26 cost time: 0.5266232490539551
Epoch: 26, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.709 Vali Acc: 0.874 Test Loss: 0.709 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 27 cost time: 0.5033016204833984
Epoch: 27, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.677 Vali Acc: 0.881 Test Loss: 0.677 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881475).  Saving model ...
Epoch: 28 cost time: 0.42787694931030273
Epoch: 28, Steps: 2 | Train Loss: 0.559 Vali Loss: 0.647 Vali Acc: 0.885 Test Loss: 0.647 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 29 cost time: 0.4979367256164551
Epoch: 29, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.619 Vali Acc: 0.896 Test Loss: 0.619 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896290).  Saving model ...
Epoch: 30 cost time: 0.48746395111083984
Epoch: 30, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.592 Vali Acc: 0.893 Test Loss: 0.592 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4681816101074219
Epoch: 31, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.567 Vali Acc: 0.904 Test Loss: 0.567 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 32 cost time: 0.47397589683532715
Epoch: 32, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.544 Vali Acc: 0.907 Test Loss: 0.544 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 33 cost time: 0.4466273784637451
Epoch: 33, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.523 Vali Acc: 0.911 Test Loss: 0.523 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 34 cost time: 0.444033145904541
Epoch: 34, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.503 Vali Acc: 0.911 Test Loss: 0.503 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 35 cost time: 0.5045933723449707
Epoch: 35, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.485 Vali Acc: 0.919 Test Loss: 0.485 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 36 cost time: 0.4911155700683594
Epoch: 36, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.467 Vali Acc: 0.919 Test Loss: 0.467 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 37 cost time: 0.5338325500488281
Epoch: 37, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.450 Vali Acc: 0.919 Test Loss: 0.450 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 38 cost time: 0.5034451484680176
Epoch: 38, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.436 Vali Acc: 0.915 Test Loss: 0.436 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.49851226806640625
Epoch: 39, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.422 Vali Acc: 0.915 Test Loss: 0.422 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5116922855377197
Epoch: 40, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.411 Vali Acc: 0.911 Test Loss: 0.411 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4900026321411133
Epoch: 41, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.399 Vali Acc: 0.911 Test Loss: 0.399 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4786980152130127
Epoch: 42, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.389 Vali Acc: 0.911 Test Loss: 0.389 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.4339284896850586
Epoch: 43, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.381 Vali Acc: 0.915 Test Loss: 0.381 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5402114391326904
Epoch: 44, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.373 Vali Acc: 0.915 Test Loss: 0.373 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.4291844367980957
Epoch: 45, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.364 Vali Acc: 0.915 Test Loss: 0.364 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.585702657699585
Epoch: 46, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.355 Vali Acc: 0.919 Test Loss: 0.355 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 47 cost time: 0.5921268463134766
Epoch: 47, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 48 cost time: 0.4892573356628418
Epoch: 48, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.42949604988098145
Epoch: 49, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.331 Vali Acc: 0.919 Test Loss: 0.331 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5125913619995117
Epoch: 50, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.325 Vali Acc: 0.922 Test Loss: 0.325 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 51 cost time: 0.4662189483642578
Epoch: 51, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.318 Vali Acc: 0.926 Test Loss: 0.318 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 52 cost time: 0.5518581867218018
Epoch: 52, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 53 cost time: 0.5708904266357422
Epoch: 53, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 54 cost time: 0.5269424915313721
Epoch: 54, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.4679605960845947
Epoch: 55, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 56 cost time: 0.5255491733551025
Epoch: 56, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 57 cost time: 0.4905552864074707
Epoch: 57, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 58 cost time: 0.5200371742248535
Epoch: 58, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 0.5414433479309082
Epoch: 59, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.280 Vali Acc: 0.933 Test Loss: 0.280 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 60 cost time: 0.46853113174438477
Epoch: 60, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 61 cost time: 0.5856344699859619
Epoch: 61, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.273 Vali Acc: 0.933 Test Loss: 0.273 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 62 cost time: 0.49233484268188477
Epoch: 62, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 63 cost time: 0.539790153503418
Epoch: 63, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 64 cost time: 0.4784262180328369
Epoch: 64, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 65 cost time: 0.5079426765441895
Epoch: 65, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5436403751373291
Epoch: 66, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 67 cost time: 0.5449600219726562
Epoch: 67, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 68 cost time: 0.6739232540130615
Epoch: 68, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 69 cost time: 0.46062564849853516
Epoch: 69, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 70 cost time: 0.4376358985900879
Epoch: 70, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 71 cost time: 0.4579312801361084
Epoch: 71, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 72 cost time: 0.5687432289123535
Epoch: 72, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 73 cost time: 0.48741698265075684
Epoch: 73, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 74 cost time: 0.5089576244354248
Epoch: 74, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 75 cost time: 0.4748551845550537
Epoch: 75, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 76 cost time: 0.4138627052307129
Epoch: 76, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 77 cost time: 0.5218651294708252
Epoch: 77, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 78 cost time: 0.5107169151306152
Epoch: 78, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 79 cost time: 0.5065329074859619
Epoch: 79, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 80 cost time: 0.5371723175048828
Epoch: 80, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.4580092430114746
Epoch: 81, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.5542538166046143
Epoch: 82, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.4309413433074951
Epoch: 83, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.475200891494751
Epoch: 84, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.5075256824493408
Epoch: 85, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.49129271507263184
Epoch: 86, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.4716322422027588
Epoch: 87, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.5052721500396729
Epoch: 88, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.5366406440734863
Epoch: 89, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 25526
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8874843120574951
Epoch: 1, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.686 Vali Acc: 0.381 Test Loss: 1.686 Test Acc: 0.381
Validation loss decreased (inf --> -0.381465).  Saving model ...
Epoch: 2 cost time: 0.6350061893463135
Epoch: 2, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.654 Vali Acc: 0.396 Test Loss: 1.654 Test Acc: 0.396
Validation loss decreased (-0.381465 --> -0.396280).  Saving model ...
Epoch: 3 cost time: 0.5585925579071045
Epoch: 3, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.632 Vali Acc: 0.411 Test Loss: 1.632 Test Acc: 0.411
Validation loss decreased (-0.396280 --> -0.411095).  Saving model ...
Epoch: 4 cost time: 0.5829520225524902
Epoch: 4, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.612 Vali Acc: 0.422 Test Loss: 1.612 Test Acc: 0.422
Validation loss decreased (-0.411095 --> -0.422206).  Saving model ...
Epoch: 5 cost time: 0.5527369976043701
Epoch: 5, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.588 Vali Acc: 0.448 Test Loss: 1.588 Test Acc: 0.448
Validation loss decreased (-0.422206 --> -0.448132).  Saving model ...
Epoch: 6 cost time: 0.5225882530212402
Epoch: 6, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.560 Vali Acc: 0.478 Test Loss: 1.560 Test Acc: 0.478
Validation loss decreased (-0.448132 --> -0.477762).  Saving model ...
Epoch: 7 cost time: 0.6054098606109619
Epoch: 7, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.528 Vali Acc: 0.515 Test Loss: 1.528 Test Acc: 0.515
Validation loss decreased (-0.477762 --> -0.514800).  Saving model ...
Epoch: 8 cost time: 0.4532628059387207
Epoch: 8, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.493 Vali Acc: 0.530 Test Loss: 1.493 Test Acc: 0.530
Validation loss decreased (-0.514800 --> -0.529615).  Saving model ...
Epoch: 9 cost time: 0.5603492259979248
Epoch: 9, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.456 Vali Acc: 0.548 Test Loss: 1.456 Test Acc: 0.548
Validation loss decreased (-0.529615 --> -0.548134).  Saving model ...
Epoch: 10 cost time: 0.5301549434661865
Epoch: 10, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.415 Vali Acc: 0.570 Test Loss: 1.415 Test Acc: 0.570
Validation loss decreased (-0.548134 --> -0.570356).  Saving model ...
Epoch: 11 cost time: 0.5792891979217529
Epoch: 11, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.373 Vali Acc: 0.585 Test Loss: 1.373 Test Acc: 0.585
Validation loss decreased (-0.570356 --> -0.585171).  Saving model ...
Epoch: 12 cost time: 0.5254385471343994
Epoch: 12, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.330 Vali Acc: 0.596 Test Loss: 1.330 Test Acc: 0.596
Validation loss decreased (-0.585171 --> -0.596283).  Saving model ...
Epoch: 13 cost time: 0.5388779640197754
Epoch: 13, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.286 Vali Acc: 0.611 Test Loss: 1.286 Test Acc: 0.611
Validation loss decreased (-0.596283 --> -0.611098).  Saving model ...
Epoch: 14 cost time: 0.5186009407043457
Epoch: 14, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.242 Vali Acc: 0.622 Test Loss: 1.242 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 15 cost time: 0.522392749786377
Epoch: 15, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.199 Vali Acc: 0.644 Test Loss: 1.199 Test Acc: 0.644
Validation loss decreased (-0.622210 --> -0.644432).  Saving model ...
Epoch: 16 cost time: 0.5019006729125977
Epoch: 16, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.156 Vali Acc: 0.667 Test Loss: 1.156 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666655).  Saving model ...
Epoch: 17 cost time: 0.46697211265563965
Epoch: 17, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.113 Vali Acc: 0.678 Test Loss: 1.113 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 18 cost time: 0.509453296661377
Epoch: 18, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.071 Vali Acc: 0.696 Test Loss: 1.071 Test Acc: 0.696
Validation loss decreased (-0.677767 --> -0.696286).  Saving model ...
Epoch: 19 cost time: 0.5278902053833008
Epoch: 19, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.030 Vali Acc: 0.704 Test Loss: 1.030 Test Acc: 0.704
Validation loss decreased (-0.696286 --> -0.703693).  Saving model ...
Epoch: 20 cost time: 0.5213453769683838
Epoch: 20, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.990 Vali Acc: 0.722 Test Loss: 0.990 Test Acc: 0.722
Validation loss decreased (-0.703693 --> -0.722212).  Saving model ...
Epoch: 21 cost time: 0.5707435607910156
Epoch: 21, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.951 Vali Acc: 0.737 Test Loss: 0.951 Test Acc: 0.737
Validation loss decreased (-0.722212 --> -0.737028).  Saving model ...
Epoch: 22 cost time: 0.4805574417114258
Epoch: 22, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.912 Vali Acc: 0.752 Test Loss: 0.912 Test Acc: 0.752
Validation loss decreased (-0.737028 --> -0.751843).  Saving model ...
Epoch: 23 cost time: 0.5127007961273193
Epoch: 23, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.875 Vali Acc: 0.770 Test Loss: 0.875 Test Acc: 0.770
Validation loss decreased (-0.751843 --> -0.770362).  Saving model ...
Epoch: 24 cost time: 0.46309709548950195
Epoch: 24, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.839 Vali Acc: 0.785 Test Loss: 0.839 Test Acc: 0.785
Validation loss decreased (-0.770362 --> -0.785177).  Saving model ...
Epoch: 25 cost time: 0.4698629379272461
Epoch: 25, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.804 Vali Acc: 0.793 Test Loss: 0.804 Test Acc: 0.793
Validation loss decreased (-0.785177 --> -0.792585).  Saving model ...
Epoch: 26 cost time: 0.42888498306274414
Epoch: 26, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.771 Vali Acc: 0.800 Test Loss: 0.771 Test Acc: 0.800
Validation loss decreased (-0.792585 --> -0.799992).  Saving model ...
Epoch: 27 cost time: 0.4654874801635742
Epoch: 27, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.739 Vali Acc: 0.819 Test Loss: 0.739 Test Acc: 0.819
Validation loss decreased (-0.799992 --> -0.818511).  Saving model ...
Epoch: 28 cost time: 0.48282909393310547
Epoch: 28, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.708 Vali Acc: 0.826 Test Loss: 0.708 Test Acc: 0.826
Validation loss decreased (-0.818511 --> -0.825919).  Saving model ...
Epoch: 29 cost time: 0.4711437225341797
Epoch: 29, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.678 Vali Acc: 0.830 Test Loss: 0.678 Test Acc: 0.830
Validation loss decreased (-0.825919 --> -0.829623).  Saving model ...
Epoch: 30 cost time: 0.5877134799957275
Epoch: 30, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833327).  Saving model ...
Epoch: 31 cost time: 0.5442125797271729
Epoch: 31, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.624 Vali Acc: 0.841 Test Loss: 0.624 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840735).  Saving model ...
Epoch: 32 cost time: 0.5570929050445557
Epoch: 32, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.599 Vali Acc: 0.859 Test Loss: 0.599 Test Acc: 0.859
Validation loss decreased (-0.840735 --> -0.859253).  Saving model ...
Epoch: 33 cost time: 0.4834129810333252
Epoch: 33, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 0.5988264083862305
Epoch: 34, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 0.5992217063903809
Epoch: 35, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.535 Vali Acc: 0.874 Test Loss: 0.535 Test Acc: 0.874
Validation loss decreased (-0.866661 --> -0.874069).  Saving model ...
Epoch: 36 cost time: 0.5437467098236084
Epoch: 36, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.516 Vali Acc: 0.885 Test Loss: 0.516 Test Acc: 0.885
Validation loss decreased (-0.874069 --> -0.885180).  Saving model ...
Epoch: 37 cost time: 0.5188844203948975
Epoch: 37, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 38 cost time: 0.5132315158843994
Epoch: 38, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.482 Vali Acc: 0.896 Test Loss: 0.482 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896291).  Saving model ...
Epoch: 39 cost time: 0.5592412948608398
Epoch: 39, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 40 cost time: 0.5392954349517822
Epoch: 40, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 41 cost time: 0.5428099632263184
Epoch: 41, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.439 Vali Acc: 0.904 Test Loss: 0.439 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 42 cost time: 0.4766569137573242
Epoch: 42, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.426 Vali Acc: 0.904 Test Loss: 0.426 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 43 cost time: 0.5159366130828857
Epoch: 43, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.415 Vali Acc: 0.904 Test Loss: 0.415 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903700).  Saving model ...
Epoch: 44 cost time: 0.4547617435455322
Epoch: 44, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.405 Vali Acc: 0.904 Test Loss: 0.405 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 45 cost time: 0.4737558364868164
Epoch: 45, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.394 Vali Acc: 0.915 Test Loss: 0.394 Test Acc: 0.915
Validation loss decreased (-0.903700 --> -0.914811).  Saving model ...
Epoch: 46 cost time: 0.5651242733001709
Epoch: 46, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.385 Vali Acc: 0.919 Test Loss: 0.385 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 47 cost time: 0.54132080078125
Epoch: 47, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.375 Vali Acc: 0.907 Test Loss: 0.375 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5457093715667725
Epoch: 48, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.367 Vali Acc: 0.915 Test Loss: 0.367 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5405540466308594
Epoch: 49, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.359 Vali Acc: 0.915 Test Loss: 0.359 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5407161712646484
Epoch: 50, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.353 Vali Acc: 0.915 Test Loss: 0.353 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5810785293579102
Epoch: 51, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.346 Vali Acc: 0.915 Test Loss: 0.346 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.534454345703125
Epoch: 52, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.340 Vali Acc: 0.915 Test Loss: 0.340 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.44698047637939453
Epoch: 53, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.5074484348297119
Epoch: 54, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.329 Vali Acc: 0.911 Test Loss: 0.329 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.49840450286865234
Epoch: 55, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.324 Vali Acc: 0.911 Test Loss: 0.324 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.5222725868225098
Epoch: 56, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.320 Vali Acc: 0.907 Test Loss: 0.320 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 24422
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8491356372833252
Epoch: 1, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.794 Vali Acc: 0.144 Test Loss: 1.794 Test Acc: 0.144
Validation loss decreased (inf --> -0.144427).  Saving model ...
Epoch: 2 cost time: 0.5074856281280518
Epoch: 2, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.751 Vali Acc: 0.163 Test Loss: 1.751 Test Acc: 0.163
Validation loss decreased (-0.144427 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 0.4608731269836426
Epoch: 3, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.721 Vali Acc: 0.185 Test Loss: 1.721 Test Acc: 0.185
Validation loss decreased (-0.162945 --> -0.185168).  Saving model ...
Epoch: 4 cost time: 0.487321138381958
Epoch: 4, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.696 Vali Acc: 0.204 Test Loss: 1.696 Test Acc: 0.204
Validation loss decreased (-0.185168 --> -0.203687).  Saving model ...
Epoch: 5 cost time: 0.48623228073120117
Epoch: 5, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.667 Vali Acc: 0.215 Test Loss: 1.667 Test Acc: 0.215
Validation loss decreased (-0.203687 --> -0.214798).  Saving model ...
Epoch: 6 cost time: 0.4568028450012207
Epoch: 6, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.635 Vali Acc: 0.263 Test Loss: 1.635 Test Acc: 0.263
Validation loss decreased (-0.214798 --> -0.262947).  Saving model ...
Epoch: 7 cost time: 0.41743993759155273
Epoch: 7, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.601 Vali Acc: 0.296 Test Loss: 1.601 Test Acc: 0.296
Validation loss decreased (-0.262947 --> -0.296280).  Saving model ...
Epoch: 8 cost time: 0.4119992256164551
Epoch: 8, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.564 Vali Acc: 0.359 Test Loss: 1.564 Test Acc: 0.359
Validation loss decreased (-0.296280 --> -0.359244).  Saving model ...
Epoch: 9 cost time: 0.4228332042694092
Epoch: 9, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.525 Vali Acc: 0.400 Test Loss: 1.525 Test Acc: 0.400
Validation loss decreased (-0.359244 --> -0.399985).  Saving model ...
Epoch: 10 cost time: 0.42026662826538086
Epoch: 10, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.484 Vali Acc: 0.456 Test Loss: 1.484 Test Acc: 0.456
Validation loss decreased (-0.399985 --> -0.455541).  Saving model ...
Epoch: 11 cost time: 0.4446094036102295
Epoch: 11, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.442 Vali Acc: 0.537 Test Loss: 1.442 Test Acc: 0.537
Validation loss decreased (-0.455541 --> -0.537023).  Saving model ...
Epoch: 12 cost time: 0.43257784843444824
Epoch: 12, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.399 Vali Acc: 0.581 Test Loss: 1.399 Test Acc: 0.581
Validation loss decreased (-0.537023 --> -0.581467).  Saving model ...
Epoch: 13 cost time: 0.456937313079834
Epoch: 13, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.357 Vali Acc: 0.622 Test Loss: 1.357 Test Acc: 0.622
Validation loss decreased (-0.581467 --> -0.622209).  Saving model ...
Epoch: 14 cost time: 0.4118459224700928
Epoch: 14, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.314 Vali Acc: 0.689 Test Loss: 1.314 Test Acc: 0.689
Validation loss decreased (-0.622209 --> -0.688876).  Saving model ...
Epoch: 15 cost time: 0.49578022956848145
Epoch: 15, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.271 Vali Acc: 0.707 Test Loss: 1.271 Test Acc: 0.707
Validation loss decreased (-0.688876 --> -0.707395).  Saving model ...
Epoch: 16 cost time: 0.534937858581543
Epoch: 16, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.228 Vali Acc: 0.726 Test Loss: 1.228 Test Acc: 0.726
Validation loss decreased (-0.707395 --> -0.725914).  Saving model ...
Epoch: 17 cost time: 0.5285887718200684
Epoch: 17, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.186 Vali Acc: 0.741 Test Loss: 1.186 Test Acc: 0.741
Validation loss decreased (-0.725914 --> -0.740729).  Saving model ...
Epoch: 18 cost time: 0.4303903579711914
Epoch: 18, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.146 Vali Acc: 0.767 Test Loss: 1.146 Test Acc: 0.767
Validation loss decreased (-0.740729 --> -0.766655).  Saving model ...
Epoch: 19 cost time: 0.43454480171203613
Epoch: 19, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.108 Vali Acc: 0.781 Test Loss: 1.108 Test Acc: 0.781
Validation loss decreased (-0.766655 --> -0.781470).  Saving model ...
Epoch: 20 cost time: 0.5341050624847412
Epoch: 20, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.070 Vali Acc: 0.796 Test Loss: 1.070 Test Acc: 0.796
Validation loss decreased (-0.781470 --> -0.796286).  Saving model ...
Epoch: 21 cost time: 0.4830305576324463
Epoch: 21, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.034 Vali Acc: 0.811 Test Loss: 1.034 Test Acc: 0.811
Validation loss decreased (-0.796286 --> -0.811101).  Saving model ...
Epoch: 22 cost time: 0.50229811668396
Epoch: 22, Steps: 2 | Train Loss: 1.077 Vali Loss: 0.997 Vali Acc: 0.819 Test Loss: 0.997 Test Acc: 0.819
Validation loss decreased (-0.811101 --> -0.818509).  Saving model ...
Epoch: 23 cost time: 0.4131431579589844
Epoch: 23, Steps: 2 | Train Loss: 0.945 Vali Loss: 0.961 Vali Acc: 0.833 Test Loss: 0.961 Test Acc: 0.833
Validation loss decreased (-0.818509 --> -0.833324).  Saving model ...
Epoch: 24 cost time: 0.4142031669616699
Epoch: 24, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.928 Vali Acc: 0.856 Test Loss: 0.928 Test Acc: 0.856
Validation loss decreased (-0.833324 --> -0.855546).  Saving model ...
Epoch: 25 cost time: 0.43806004524230957
Epoch: 25, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.895 Vali Acc: 0.863 Test Loss: 0.895 Test Acc: 0.863
Validation loss decreased (-0.855546 --> -0.862954).  Saving model ...
Epoch: 26 cost time: 0.4303879737854004
Epoch: 26, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.863 Vali Acc: 0.874 Test Loss: 0.863 Test Acc: 0.874
Validation loss decreased (-0.862954 --> -0.874065).  Saving model ...
Epoch: 27 cost time: 0.4768514633178711
Epoch: 27, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.833 Vali Acc: 0.874 Test Loss: 0.833 Test Acc: 0.874
Validation loss decreased (-0.874065 --> -0.874066).  Saving model ...
Epoch: 28 cost time: 0.42976927757263184
Epoch: 28, Steps: 2 | Train Loss: 0.840 Vali Loss: 0.803 Vali Acc: 0.881 Test Loss: 0.803 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881473).  Saving model ...
Epoch: 29 cost time: 0.47522830963134766
Epoch: 29, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.774 Vali Acc: 0.889 Test Loss: 0.774 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888881).  Saving model ...
Epoch: 30 cost time: 0.4243030548095703
Epoch: 30, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.747 Vali Acc: 0.893 Test Loss: 0.747 Test Acc: 0.893
Validation loss decreased (-0.888881 --> -0.892585).  Saving model ...
Epoch: 31 cost time: 0.49459171295166016
Epoch: 31, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.720 Vali Acc: 0.896 Test Loss: 0.720 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896289).  Saving model ...
Epoch: 32 cost time: 0.47640442848205566
Epoch: 32, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.695 Vali Acc: 0.896 Test Loss: 0.695 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896289).  Saving model ...
Epoch: 33 cost time: 0.4845147132873535
Epoch: 33, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.670 Vali Acc: 0.900 Test Loss: 0.670 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 34 cost time: 0.5065374374389648
Epoch: 34, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.646 Vali Acc: 0.907 Test Loss: 0.646 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907401).  Saving model ...
Epoch: 35 cost time: 0.5055224895477295
Epoch: 35, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.623 Vali Acc: 0.907 Test Loss: 0.623 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 36 cost time: 0.5086522102355957
Epoch: 36, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.601 Vali Acc: 0.907 Test Loss: 0.601 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 37 cost time: 0.4577674865722656
Epoch: 37, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.581 Vali Acc: 0.911 Test Loss: 0.581 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 38 cost time: 0.48021578788757324
Epoch: 38, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.562 Vali Acc: 0.919 Test Loss: 0.562 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 39 cost time: 0.5440099239349365
Epoch: 39, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.543 Vali Acc: 0.919 Test Loss: 0.543 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 40 cost time: 0.5878729820251465
Epoch: 40, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.526 Vali Acc: 0.919 Test Loss: 0.526 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 41 cost time: 0.5359137058258057
Epoch: 41, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.511 Vali Acc: 0.922 Test Loss: 0.511 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 42 cost time: 0.5413670539855957
Epoch: 42, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.496 Vali Acc: 0.926 Test Loss: 0.496 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 43 cost time: 0.5009238719940186
Epoch: 43, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.482 Vali Acc: 0.930 Test Loss: 0.482 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 44 cost time: 0.5130949020385742
Epoch: 44, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.468 Vali Acc: 0.933 Test Loss: 0.468 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 45 cost time: 0.49851298332214355
Epoch: 45, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.456 Vali Acc: 0.937 Test Loss: 0.456 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937032).  Saving model ...
Epoch: 46 cost time: 0.4141960144042969
Epoch: 46, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.444 Vali Acc: 0.937 Test Loss: 0.444 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 47 cost time: 0.6481063365936279
Epoch: 47, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.433 Vali Acc: 0.937 Test Loss: 0.433 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 48 cost time: 0.4784080982208252
Epoch: 48, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.423 Vali Acc: 0.937 Test Loss: 0.423 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 49 cost time: 0.46357107162475586
Epoch: 49, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.412 Vali Acc: 0.937 Test Loss: 0.412 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 50 cost time: 0.4994983673095703
Epoch: 50, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.403 Vali Acc: 0.937 Test Loss: 0.403 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 51 cost time: 0.49391746520996094
Epoch: 51, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.395 Vali Acc: 0.937 Test Loss: 0.395 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 52 cost time: 0.4670674800872803
Epoch: 52, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.386 Vali Acc: 0.937 Test Loss: 0.386 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 53 cost time: 0.5005419254302979
Epoch: 53, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.378 Vali Acc: 0.941 Test Loss: 0.378 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 54 cost time: 0.4901280403137207
Epoch: 54, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.371 Vali Acc: 0.941 Test Loss: 0.371 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 55 cost time: 0.5175416469573975
Epoch: 55, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.364 Vali Acc: 0.941 Test Loss: 0.364 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 56 cost time: 0.44666433334350586
Epoch: 56, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 57 cost time: 0.4959883689880371
Epoch: 57, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.352 Vali Acc: 0.941 Test Loss: 0.352 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 58 cost time: 0.5651440620422363
Epoch: 58, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.347 Vali Acc: 0.941 Test Loss: 0.347 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 59 cost time: 0.5689177513122559
Epoch: 59, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 60 cost time: 0.5011410713195801
Epoch: 60, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 61 cost time: 0.5055537223815918
Epoch: 61, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 62 cost time: 0.5001621246337891
Epoch: 62, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 63 cost time: 0.5584638118743896
Epoch: 63, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.322 Vali Acc: 0.941 Test Loss: 0.322 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 64 cost time: 0.5053684711456299
Epoch: 64, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.318 Vali Acc: 0.941 Test Loss: 0.318 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 65 cost time: 0.5089097023010254
Epoch: 65, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.314 Vali Acc: 0.941 Test Loss: 0.314 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 66 cost time: 0.4979851245880127
Epoch: 66, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.310 Vali Acc: 0.941 Test Loss: 0.310 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 67 cost time: 0.43965744972229004
Epoch: 67, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.307 Vali Acc: 0.941 Test Loss: 0.307 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 68 cost time: 0.48872995376586914
Epoch: 68, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 69 cost time: 0.48253965377807617
Epoch: 69, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.301 Vali Acc: 0.941 Test Loss: 0.301 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 70 cost time: 0.5335710048675537
Epoch: 70, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.298 Vali Acc: 0.941 Test Loss: 0.298 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 71 cost time: 0.4573085308074951
Epoch: 71, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.295 Vali Acc: 0.941 Test Loss: 0.295 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 72 cost time: 0.45318603515625
Epoch: 72, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.292 Vali Acc: 0.941 Test Loss: 0.292 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 73 cost time: 0.4602835178375244
Epoch: 73, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 74 cost time: 0.5193545818328857
Epoch: 74, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 75 cost time: 0.5303518772125244
Epoch: 75, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 76 cost time: 0.5383250713348389
Epoch: 76, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 77 cost time: 0.5311081409454346
Epoch: 77, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 0.5032517910003662
Epoch: 78, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 79 cost time: 0.5014235973358154
Epoch: 79, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 80 cost time: 0.4656524658203125
Epoch: 80, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 81 cost time: 0.5418031215667725
Epoch: 81, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 82 cost time: 0.527604341506958
Epoch: 82, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 0.6712958812713623
Epoch: 83, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.266 Vali Acc: 0.948 Test Loss: 0.266 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 84 cost time: 0.5339818000793457
Epoch: 84, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.264 Vali Acc: 0.948 Test Loss: 0.264 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 85 cost time: 0.4774351119995117
Epoch: 85, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.261 Vali Acc: 0.948 Test Loss: 0.261 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 86 cost time: 0.5534255504608154
Epoch: 86, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.259 Vali Acc: 0.948 Test Loss: 0.259 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 87 cost time: 0.5794448852539062
Epoch: 87, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 88 cost time: 0.5805296897888184
Epoch: 88, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.256 Vali Acc: 0.948 Test Loss: 0.256 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 89 cost time: 0.4319956302642822
Epoch: 89, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.254 Vali Acc: 0.948 Test Loss: 0.254 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 90 cost time: 0.47064733505249023
Epoch: 90, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 91 cost time: 0.5213038921356201
Epoch: 91, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.250 Vali Acc: 0.948 Test Loss: 0.250 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 92 cost time: 0.5456974506378174
Epoch: 92, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.249 Vali Acc: 0.948 Test Loss: 0.249 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 93 cost time: 0.5174610614776611
Epoch: 93, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 94 cost time: 0.4568023681640625
Epoch: 94, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.246 Vali Acc: 0.948 Test Loss: 0.246 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 95 cost time: 0.5324845314025879
Epoch: 95, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 96 cost time: 0.5407335758209229
Epoch: 96, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 97 cost time: 0.44745564460754395
Epoch: 97, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 98 cost time: 0.4334523677825928
Epoch: 98, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.5621387958526611
Epoch: 99, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.5372283458709717
Epoch: 100, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 22934
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9725065231323242
Epoch: 1, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.837 Vali Acc: 0.178 Test Loss: 1.837 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.5324389934539795
Epoch: 2, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.818 Vali Acc: 0.189 Test Loss: 1.818 Test Acc: 0.189
Validation loss decreased (-0.177759 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.5985560417175293
Epoch: 3, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.805 Vali Acc: 0.189 Test Loss: 1.805 Test Acc: 0.189
Validation loss decreased (-0.188871 --> -0.188871).  Saving model ...
Epoch: 4 cost time: 0.5532329082489014
Epoch: 4, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.796 Vali Acc: 0.193 Test Loss: 1.796 Test Acc: 0.193
Validation loss decreased (-0.188871 --> -0.192575).  Saving model ...
Epoch: 5 cost time: 0.5370998382568359
Epoch: 5, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.783 Vali Acc: 0.204 Test Loss: 1.783 Test Acc: 0.204
Validation loss decreased (-0.192575 --> -0.203686).  Saving model ...
Epoch: 6 cost time: 0.6429152488708496
Epoch: 6, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.767 Vali Acc: 0.204 Test Loss: 1.767 Test Acc: 0.204
Validation loss decreased (-0.203686 --> -0.203686).  Saving model ...
Epoch: 7 cost time: 0.48353123664855957
Epoch: 7, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.749 Vali Acc: 0.233 Test Loss: 1.749 Test Acc: 0.233
Validation loss decreased (-0.203686 --> -0.233316).  Saving model ...
Epoch: 8 cost time: 0.5032784938812256
Epoch: 8, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.729 Vali Acc: 0.248 Test Loss: 1.729 Test Acc: 0.248
Validation loss decreased (-0.233316 --> -0.248131).  Saving model ...
Epoch: 9 cost time: 0.6242771148681641
Epoch: 9, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.708 Vali Acc: 0.278 Test Loss: 1.708 Test Acc: 0.278
Validation loss decreased (-0.248131 --> -0.277761).  Saving model ...
Epoch: 10 cost time: 0.5606644153594971
Epoch: 10, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.684 Vali Acc: 0.304 Test Loss: 1.684 Test Acc: 0.304
Validation loss decreased (-0.277761 --> -0.303687).  Saving model ...
Epoch: 11 cost time: 0.5473058223724365
Epoch: 11, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.659 Vali Acc: 0.333 Test Loss: 1.659 Test Acc: 0.333
Validation loss decreased (-0.303687 --> -0.333317).  Saving model ...
Epoch: 12 cost time: 0.48140525817871094
Epoch: 12, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.632 Vali Acc: 0.367 Test Loss: 1.632 Test Acc: 0.367
Validation loss decreased (-0.333317 --> -0.366650).  Saving model ...
Epoch: 13 cost time: 0.5432620048522949
Epoch: 13, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.605 Vali Acc: 0.389 Test Loss: 1.605 Test Acc: 0.389
Validation loss decreased (-0.366650 --> -0.388873).  Saving model ...
Epoch: 14 cost time: 0.5465517044067383
Epoch: 14, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.576 Vali Acc: 0.422 Test Loss: 1.576 Test Acc: 0.422
Validation loss decreased (-0.388873 --> -0.422206).  Saving model ...
Epoch: 15 cost time: 0.5225355625152588
Epoch: 15, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.546 Vali Acc: 0.478 Test Loss: 1.546 Test Acc: 0.478
Validation loss decreased (-0.422206 --> -0.477762).  Saving model ...
Epoch: 16 cost time: 0.6489925384521484
Epoch: 16, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.516 Vali Acc: 0.496 Test Loss: 1.516 Test Acc: 0.496
Validation loss decreased (-0.477762 --> -0.496281).  Saving model ...
Epoch: 17 cost time: 0.518519401550293
Epoch: 17, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.485 Vali Acc: 0.515 Test Loss: 1.485 Test Acc: 0.515
Validation loss decreased (-0.496281 --> -0.514800).  Saving model ...
Epoch: 18 cost time: 0.5719425678253174
Epoch: 18, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.454 Vali Acc: 0.552 Test Loss: 1.454 Test Acc: 0.552
Validation loss decreased (-0.514800 --> -0.551837).  Saving model ...
Epoch: 19 cost time: 0.650327205657959
Epoch: 19, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.423 Vali Acc: 0.567 Test Loss: 1.423 Test Acc: 0.567
Validation loss decreased (-0.551837 --> -0.566652).  Saving model ...
Epoch: 20 cost time: 0.503720760345459
Epoch: 20, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.392 Vali Acc: 0.593 Test Loss: 1.392 Test Acc: 0.593
Validation loss decreased (-0.566652 --> -0.592579).  Saving model ...
Epoch: 21 cost time: 0.5495615005493164
Epoch: 21, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.360 Vali Acc: 0.604 Test Loss: 1.360 Test Acc: 0.604
Validation loss decreased (-0.592579 --> -0.603690).  Saving model ...
Epoch: 22 cost time: 0.5233705043792725
Epoch: 22, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.329 Vali Acc: 0.630 Test Loss: 1.329 Test Acc: 0.630
Validation loss decreased (-0.603690 --> -0.629616).  Saving model ...
Epoch: 23 cost time: 0.5944983959197998
Epoch: 23, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.295 Vali Acc: 0.652 Test Loss: 1.295 Test Acc: 0.652
Validation loss decreased (-0.629616 --> -0.651839).  Saving model ...
Epoch: 24 cost time: 0.4470100402832031
Epoch: 24, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.263 Vali Acc: 0.667 Test Loss: 1.263 Test Acc: 0.667
Validation loss decreased (-0.651839 --> -0.666654).  Saving model ...
Epoch: 25 cost time: 0.5420458316802979
Epoch: 25, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.230 Vali Acc: 0.689 Test Loss: 1.230 Test Acc: 0.689
Validation loss decreased (-0.666654 --> -0.688877).  Saving model ...
Epoch: 26 cost time: 0.5215251445770264
Epoch: 26, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.196 Vali Acc: 0.704 Test Loss: 1.196 Test Acc: 0.704
Validation loss decreased (-0.688877 --> -0.703692).  Saving model ...
Epoch: 27 cost time: 0.5320107936859131
Epoch: 27, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.163 Vali Acc: 0.711 Test Loss: 1.163 Test Acc: 0.711
Validation loss decreased (-0.703692 --> -0.711099).  Saving model ...
Epoch: 28 cost time: 0.5089454650878906
Epoch: 28, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.130 Vali Acc: 0.719 Test Loss: 1.130 Test Acc: 0.719
Validation loss decreased (-0.711099 --> -0.718507).  Saving model ...
Epoch: 29 cost time: 0.6407914161682129
Epoch: 29, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.097 Vali Acc: 0.719 Test Loss: 1.097 Test Acc: 0.719
Validation loss decreased (-0.718507 --> -0.718508).  Saving model ...
Epoch: 30 cost time: 0.4752476215362549
Epoch: 30, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.065 Vali Acc: 0.726 Test Loss: 1.065 Test Acc: 0.726
Validation loss decreased (-0.718508 --> -0.725915).  Saving model ...
Epoch: 31 cost time: 0.586402416229248
Epoch: 31, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.033 Vali Acc: 0.737 Test Loss: 1.033 Test Acc: 0.737
Validation loss decreased (-0.725915 --> -0.737027).  Saving model ...
Epoch: 32 cost time: 0.5404603481292725
Epoch: 32, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.002 Vali Acc: 0.752 Test Loss: 1.002 Test Acc: 0.752
Validation loss decreased (-0.737027 --> -0.751842).  Saving model ...
Epoch: 33 cost time: 0.5433077812194824
Epoch: 33, Steps: 2 | Train Loss: 1.023 Vali Loss: 0.971 Vali Acc: 0.756 Test Loss: 0.971 Test Acc: 0.756
Validation loss decreased (-0.751842 --> -0.755546).  Saving model ...
Epoch: 34 cost time: 0.5534610748291016
Epoch: 34, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.942 Vali Acc: 0.763 Test Loss: 0.942 Test Acc: 0.763
Validation loss decreased (-0.755546 --> -0.762954).  Saving model ...
Epoch: 35 cost time: 0.5422859191894531
Epoch: 35, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.912 Vali Acc: 0.774 Test Loss: 0.912 Test Acc: 0.774
Validation loss decreased (-0.762954 --> -0.774065).  Saving model ...
Epoch: 36 cost time: 0.6720418930053711
Epoch: 36, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.885 Vali Acc: 0.781 Test Loss: 0.885 Test Acc: 0.781
Validation loss decreased (-0.774065 --> -0.781473).  Saving model ...
Epoch: 37 cost time: 0.5450699329376221
Epoch: 37, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.858 Vali Acc: 0.793 Test Loss: 0.858 Test Acc: 0.793
Validation loss decreased (-0.781473 --> -0.792584).  Saving model ...
Epoch: 38 cost time: 0.5635857582092285
Epoch: 38, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.832 Vali Acc: 0.807 Test Loss: 0.832 Test Acc: 0.807
Validation loss decreased (-0.792584 --> -0.807399).  Saving model ...
Epoch: 39 cost time: 0.5541443824768066
Epoch: 39, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.808 Vali Acc: 0.807 Test Loss: 0.808 Test Acc: 0.807
Validation loss decreased (-0.807399 --> -0.807399).  Saving model ...
Epoch: 40 cost time: 0.5990457534790039
Epoch: 40, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.783 Vali Acc: 0.815 Test Loss: 0.783 Test Acc: 0.815
Validation loss decreased (-0.807399 --> -0.814807).  Saving model ...
Epoch: 41 cost time: 0.49312329292297363
Epoch: 41, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.760 Vali Acc: 0.826 Test Loss: 0.760 Test Acc: 0.826
Validation loss decreased (-0.814807 --> -0.825918).  Saving model ...
Epoch: 42 cost time: 0.5016307830810547
Epoch: 42, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.738 Vali Acc: 0.833 Test Loss: 0.738 Test Acc: 0.833
Validation loss decreased (-0.825918 --> -0.833326).  Saving model ...
Epoch: 43 cost time: 0.5109732151031494
Epoch: 43, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.715 Vali Acc: 0.837 Test Loss: 0.715 Test Acc: 0.837
Validation loss decreased (-0.833326 --> -0.837030).  Saving model ...
Epoch: 44 cost time: 0.4649026393890381
Epoch: 44, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.694 Vali Acc: 0.837 Test Loss: 0.694 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 45 cost time: 0.556096076965332
Epoch: 45, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.674 Vali Acc: 0.844 Test Loss: 0.674 Test Acc: 0.844
Validation loss decreased (-0.837030 --> -0.844438).  Saving model ...
Epoch: 46 cost time: 0.46797752380371094
Epoch: 46, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.656 Vali Acc: 0.856 Test Loss: 0.656 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 47 cost time: 0.4632411003112793
Epoch: 47, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.638 Vali Acc: 0.856 Test Loss: 0.638 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 48 cost time: 0.569239616394043
Epoch: 48, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 49 cost time: 0.5414345264434814
Epoch: 49, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.608 Vali Acc: 0.859 Test Loss: 0.608 Test Acc: 0.859
Validation loss decreased (-0.855549 --> -0.859253).  Saving model ...
Epoch: 50 cost time: 0.49252915382385254
Epoch: 50, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866661).  Saving model ...
Epoch: 51 cost time: 0.46418070793151855
Epoch: 51, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.577 Vali Acc: 0.870 Test Loss: 0.577 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.870365).  Saving model ...
Epoch: 52 cost time: 0.5093657970428467
Epoch: 52, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.564 Vali Acc: 0.870 Test Loss: 0.564 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 53 cost time: 0.520557165145874
Epoch: 53, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.552 Vali Acc: 0.881 Test Loss: 0.552 Test Acc: 0.881
Validation loss decreased (-0.870365 --> -0.881476).  Saving model ...
Epoch: 54 cost time: 0.5613753795623779
Epoch: 54, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.540 Vali Acc: 0.881 Test Loss: 0.540 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 55 cost time: 0.5133521556854248
Epoch: 55, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.528 Vali Acc: 0.885 Test Loss: 0.528 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 56 cost time: 0.513786792755127
Epoch: 56, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.517 Vali Acc: 0.896 Test Loss: 0.517 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896291).  Saving model ...
Epoch: 57 cost time: 0.5994362831115723
Epoch: 57, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.507 Vali Acc: 0.896 Test Loss: 0.507 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 58 cost time: 0.5211124420166016
Epoch: 58, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.497 Vali Acc: 0.896 Test Loss: 0.497 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 59 cost time: 0.5353093147277832
Epoch: 59, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.488 Vali Acc: 0.896 Test Loss: 0.488 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 60 cost time: 0.5160088539123535
Epoch: 60, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.479 Vali Acc: 0.896 Test Loss: 0.479 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 61 cost time: 0.8003959655761719
Epoch: 61, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899995).  Saving model ...
Epoch: 62 cost time: 0.5023486614227295
Epoch: 62, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.461 Vali Acc: 0.904 Test Loss: 0.461 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 63 cost time: 0.5137903690338135
Epoch: 63, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911107).  Saving model ...
Epoch: 64 cost time: 0.5579285621643066
Epoch: 64, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.445 Vali Acc: 0.911 Test Loss: 0.445 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 65 cost time: 0.4370417594909668
Epoch: 65, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.437 Vali Acc: 0.911 Test Loss: 0.437 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 66 cost time: 0.6030302047729492
Epoch: 66, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.431 Vali Acc: 0.915 Test Loss: 0.431 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 67 cost time: 0.4868659973144531
Epoch: 67, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.424 Vali Acc: 0.915 Test Loss: 0.424 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 68 cost time: 0.47490596771240234
Epoch: 68, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.418 Vali Acc: 0.915 Test Loss: 0.418 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 69 cost time: 0.5336980819702148
Epoch: 69, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.412 Vali Acc: 0.915 Test Loss: 0.412 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 70 cost time: 0.5532727241516113
Epoch: 70, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.406 Vali Acc: 0.915 Test Loss: 0.406 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 71 cost time: 0.590857744216919
Epoch: 71, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.400 Vali Acc: 0.915 Test Loss: 0.400 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 72 cost time: 0.47333407402038574
Epoch: 72, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.395 Vali Acc: 0.919 Test Loss: 0.395 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 73 cost time: 0.5379717350006104
Epoch: 73, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.390 Vali Acc: 0.919 Test Loss: 0.390 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 74 cost time: 0.5318067073822021
Epoch: 74, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.385 Vali Acc: 0.922 Test Loss: 0.385 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922218).  Saving model ...
Epoch: 75 cost time: 0.5213661193847656
Epoch: 75, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.380 Vali Acc: 0.922 Test Loss: 0.380 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 76 cost time: 0.4677455425262451
Epoch: 76, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.376 Vali Acc: 0.922 Test Loss: 0.376 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 77 cost time: 0.5472145080566406
Epoch: 77, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.371 Vali Acc: 0.922 Test Loss: 0.371 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 78 cost time: 0.5778131484985352
Epoch: 78, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.367 Vali Acc: 0.922 Test Loss: 0.367 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 79 cost time: 0.5342698097229004
Epoch: 79, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.362 Vali Acc: 0.922 Test Loss: 0.362 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 80 cost time: 0.5347530841827393
Epoch: 80, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 81 cost time: 0.5743286609649658
Epoch: 81, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.355 Vali Acc: 0.922 Test Loss: 0.355 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 82 cost time: 0.6091516017913818
Epoch: 82, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.351 Vali Acc: 0.922 Test Loss: 0.351 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 83 cost time: 0.5034327507019043
Epoch: 83, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 84 cost time: 0.48886752128601074
Epoch: 84, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 85 cost time: 0.43837618827819824
Epoch: 85, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.340 Vali Acc: 0.922 Test Loss: 0.340 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 86 cost time: 0.5014848709106445
Epoch: 86, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 87 cost time: 0.49763035774230957
Epoch: 87, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.333 Vali Acc: 0.922 Test Loss: 0.333 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 88 cost time: 0.5478363037109375
Epoch: 88, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 89 cost time: 0.46045541763305664
Epoch: 89, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.326 Vali Acc: 0.922 Test Loss: 0.326 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 90 cost time: 0.5101900100708008
Epoch: 90, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.322 Vali Acc: 0.922 Test Loss: 0.322 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 91 cost time: 0.5808160305023193
Epoch: 91, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.319 Vali Acc: 0.922 Test Loss: 0.319 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 92 cost time: 0.5342016220092773
Epoch: 92, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.316 Vali Acc: 0.922 Test Loss: 0.316 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 93 cost time: 0.48664355278015137
Epoch: 93, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.313 Vali Acc: 0.926 Test Loss: 0.313 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 94 cost time: 0.4785327911376953
Epoch: 94, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 95 cost time: 0.4823155403137207
Epoch: 95, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.307 Vali Acc: 0.926 Test Loss: 0.307 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 96 cost time: 0.5382797718048096
Epoch: 96, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 97 cost time: 0.47553515434265137
Epoch: 97, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 98 cost time: 0.5812828540802002
Epoch: 98, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 99 cost time: 0.5115089416503906
Epoch: 99, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.298 Vali Acc: 0.930 Test Loss: 0.298 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 100 cost time: 0.5064496994018555
Epoch: 100, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 22230
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9429750442504883
Epoch: 1, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.883 Vali Acc: 0.211 Test Loss: 1.883 Test Acc: 0.211
Validation loss decreased (inf --> -0.211092).  Saving model ...
Epoch: 2 cost time: 0.4333329200744629
Epoch: 2, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.824 Vali Acc: 0.248 Test Loss: 1.824 Test Acc: 0.248
Validation loss decreased (-0.211092 --> -0.248130).  Saving model ...
Epoch: 3 cost time: 0.4906575679779053
Epoch: 3, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.772 Vali Acc: 0.278 Test Loss: 1.772 Test Acc: 0.278
Validation loss decreased (-0.248130 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 0.4999878406524658
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.710 Vali Acc: 0.322 Test Loss: 1.710 Test Acc: 0.322
Validation loss decreased (-0.277760 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 0.5247535705566406
Epoch: 5, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.634 Vali Acc: 0.352 Test Loss: 1.634 Test Acc: 0.352
Validation loss decreased (-0.322205 --> -0.351836).  Saving model ...
Epoch: 6 cost time: 0.49054741859436035
Epoch: 6, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.548 Vali Acc: 0.419 Test Loss: 1.548 Test Acc: 0.419
Validation loss decreased (-0.351836 --> -0.418503).  Saving model ...
Epoch: 7 cost time: 0.4762427806854248
Epoch: 7, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.454 Vali Acc: 0.485 Test Loss: 1.454 Test Acc: 0.485
Validation loss decreased (-0.418503 --> -0.485171).  Saving model ...
Epoch: 8 cost time: 0.5648632049560547
Epoch: 8, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.357 Vali Acc: 0.570 Test Loss: 1.357 Test Acc: 0.570
Validation loss decreased (-0.485171 --> -0.570357).  Saving model ...
Epoch: 9 cost time: 0.4778604507446289
Epoch: 9, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.257 Vali Acc: 0.633 Test Loss: 1.257 Test Acc: 0.633
Validation loss decreased (-0.570357 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 0.49186182022094727
Epoch: 10, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.159 Vali Acc: 0.689 Test Loss: 1.159 Test Acc: 0.689
Validation loss decreased (-0.633321 --> -0.688877).  Saving model ...
Epoch: 11 cost time: 0.4789872169494629
Epoch: 11, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.063 Vali Acc: 0.730 Test Loss: 1.063 Test Acc: 0.730
Validation loss decreased (-0.688877 --> -0.729619).  Saving model ...
Epoch: 12 cost time: 0.5059099197387695
Epoch: 12, Steps: 2 | Train Loss: 0.944 Vali Loss: 0.969 Vali Acc: 0.793 Test Loss: 0.969 Test Acc: 0.793
Validation loss decreased (-0.729619 --> -0.792583).  Saving model ...
Epoch: 13 cost time: 0.4974958896636963
Epoch: 13, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.884 Vali Acc: 0.822 Test Loss: 0.884 Test Acc: 0.822
Validation loss decreased (-0.792583 --> -0.822213).  Saving model ...
Epoch: 14 cost time: 0.48488831520080566
Epoch: 14, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.807 Vali Acc: 0.841 Test Loss: 0.807 Test Acc: 0.841
Validation loss decreased (-0.822213 --> -0.840733).  Saving model ...
Epoch: 15 cost time: 0.49718308448791504
Epoch: 15, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.736 Vali Acc: 0.870 Test Loss: 0.736 Test Acc: 0.870
Validation loss decreased (-0.840733 --> -0.870363).  Saving model ...
Epoch: 16 cost time: 0.481677770614624
Epoch: 16, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.672 Vali Acc: 0.900 Test Loss: 0.672 Test Acc: 0.900
Validation loss decreased (-0.870363 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.48552942276000977
Epoch: 17, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.614 Vali Acc: 0.922 Test Loss: 0.614 Test Acc: 0.922
Validation loss decreased (-0.899993 --> -0.922216).  Saving model ...
Epoch: 18 cost time: 0.4279825687408447
Epoch: 18, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.564 Vali Acc: 0.933 Test Loss: 0.564 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933328).  Saving model ...
Epoch: 19 cost time: 0.4695472717285156
Epoch: 19, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.522 Vali Acc: 0.904 Test Loss: 0.522 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.42677807807922363
Epoch: 20, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.481 Vali Acc: 0.937 Test Loss: 0.481 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 21 cost time: 0.41138720512390137
Epoch: 21, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.442 Vali Acc: 0.944 Test Loss: 0.442 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944440).  Saving model ...
Epoch: 22 cost time: 0.5026311874389648
Epoch: 22, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.409 Vali Acc: 0.941 Test Loss: 0.409 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4840114116668701
Epoch: 23, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.381 Vali Acc: 0.926 Test Loss: 0.381 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.43897414207458496
Epoch: 24, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.358 Vali Acc: 0.919 Test Loss: 0.358 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4460151195526123
Epoch: 25, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.333 Vali Acc: 0.937 Test Loss: 0.333 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5129861831665039
Epoch: 26, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.4645822048187256
Epoch: 27, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.4879028797149658
Epoch: 28, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.4985508918762207
Epoch: 29, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.256 Vali Acc: 0.941 Test Loss: 0.256 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4295773506164551
Epoch: 30, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4857363700866699
Epoch: 31, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.48515963554382324
Epoch: 32, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.49495959281921387
Epoch: 33, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5514202117919922
Epoch: 34, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.635246992111206
Epoch: 35, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5037288665771484
Epoch: 36, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4926319122314453
Epoch: 37, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.583141565322876
Epoch: 38, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5258147716522217
Epoch: 39, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5250692367553711
Epoch: 40, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.49381470680236816
Epoch: 41, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.45077061653137207
Epoch: 42, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.4906625747680664
Epoch: 43, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4468693733215332
Epoch: 44, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4908430576324463
Epoch: 45, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.4818763732910156
Epoch: 46, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.5110642910003662
Epoch: 47, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5132062435150146
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.544593095779419
Epoch: 49, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.48296451568603516
Epoch: 50, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.4834437370300293
Epoch: 51, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.49770402908325195
Epoch: 52, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.4145832061767578
Epoch: 53, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.551154375076294
Epoch: 54, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.5123813152313232
Epoch: 55, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.5388908386230469
Epoch: 56, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 35814
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0369231700897217
Epoch: 1, Steps: 2 | Train Loss: 2.053 Vali Loss: 1.991 Vali Acc: 0.200 Test Loss: 1.991 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 0.6314806938171387
Epoch: 2, Steps: 2 | Train Loss: 2.037 Vali Loss: 1.936 Vali Acc: 0.200 Test Loss: 1.936 Test Acc: 0.200
Validation loss decreased (-0.199980 --> -0.199981).  Saving model ...
Epoch: 3 cost time: 0.5069894790649414
Epoch: 3, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.895 Vali Acc: 0.215 Test Loss: 1.895 Test Acc: 0.215
Validation loss decreased (-0.199981 --> -0.214796).  Saving model ...
Epoch: 4 cost time: 0.5061776638031006
Epoch: 4, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.855 Vali Acc: 0.222 Test Loss: 1.855 Test Acc: 0.222
Validation loss decreased (-0.214796 --> -0.222204).  Saving model ...
Epoch: 5 cost time: 0.5161182880401611
Epoch: 5, Steps: 2 | Train Loss: 1.930 Vali Loss: 1.808 Vali Acc: 0.226 Test Loss: 1.808 Test Acc: 0.226
Validation loss decreased (-0.222204 --> -0.225908).  Saving model ...
Epoch: 6 cost time: 0.4883389472961426
Epoch: 6, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.754 Vali Acc: 0.241 Test Loss: 1.754 Test Acc: 0.241
Validation loss decreased (-0.225908 --> -0.240723).  Saving model ...
Epoch: 7 cost time: 0.49614858627319336
Epoch: 7, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.694 Vali Acc: 0.274 Test Loss: 1.694 Test Acc: 0.274
Validation loss decreased (-0.240723 --> -0.274057).  Saving model ...
Epoch: 8 cost time: 0.4605987071990967
Epoch: 8, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.629 Vali Acc: 0.319 Test Loss: 1.629 Test Acc: 0.319
Validation loss decreased (-0.274057 --> -0.318502).  Saving model ...
Epoch: 9 cost time: 0.4750792980194092
Epoch: 9, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.560 Vali Acc: 0.363 Test Loss: 1.560 Test Acc: 0.363
Validation loss decreased (-0.318502 --> -0.362947).  Saving model ...
Epoch: 10 cost time: 0.550011157989502
Epoch: 10, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.488 Vali Acc: 0.481 Test Loss: 1.488 Test Acc: 0.481
Validation loss decreased (-0.362947 --> -0.481467).  Saving model ...
Epoch: 11 cost time: 0.4912686347961426
Epoch: 11, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.415 Vali Acc: 0.574 Test Loss: 1.415 Test Acc: 0.574
Validation loss decreased (-0.481467 --> -0.574060).  Saving model ...
Epoch: 12 cost time: 0.541405200958252
Epoch: 12, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.340 Vali Acc: 0.656 Test Loss: 1.340 Test Acc: 0.656
Validation loss decreased (-0.574060 --> -0.655542).  Saving model ...
Epoch: 13 cost time: 0.48891305923461914
Epoch: 13, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.265 Vali Acc: 0.700 Test Loss: 1.265 Test Acc: 0.700
Validation loss decreased (-0.655542 --> -0.699987).  Saving model ...
Epoch: 14 cost time: 0.48520874977111816
Epoch: 14, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.190 Vali Acc: 0.741 Test Loss: 1.190 Test Acc: 0.741
Validation loss decreased (-0.699987 --> -0.740729).  Saving model ...
Epoch: 15 cost time: 0.5821919441223145
Epoch: 15, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.117 Vali Acc: 0.785 Test Loss: 1.117 Test Acc: 0.785
Validation loss decreased (-0.740729 --> -0.785174).  Saving model ...
Epoch: 16 cost time: 0.5120739936828613
Epoch: 16, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.047 Vali Acc: 0.815 Test Loss: 1.047 Test Acc: 0.815
Validation loss decreased (-0.785174 --> -0.814804).  Saving model ...
Epoch: 17 cost time: 0.49030017852783203
Epoch: 17, Steps: 2 | Train Loss: 0.957 Vali Loss: 0.979 Vali Acc: 0.830 Test Loss: 0.979 Test Acc: 0.830
Validation loss decreased (-0.814804 --> -0.829620).  Saving model ...
Epoch: 18 cost time: 0.5415627956390381
Epoch: 18, Steps: 2 | Train Loss: 0.952 Vali Loss: 0.916 Vali Acc: 0.833 Test Loss: 0.916 Test Acc: 0.833
Validation loss decreased (-0.829620 --> -0.833324).  Saving model ...
Epoch: 19 cost time: 0.5472009181976318
Epoch: 19, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.855 Vali Acc: 0.863 Test Loss: 0.855 Test Acc: 0.863
Validation loss decreased (-0.833324 --> -0.862954).  Saving model ...
Epoch: 20 cost time: 0.579704999923706
Epoch: 20, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.799 Vali Acc: 0.867 Test Loss: 0.799 Test Acc: 0.867
Validation loss decreased (-0.862954 --> -0.866659).  Saving model ...
Epoch: 21 cost time: 0.5434176921844482
Epoch: 21, Steps: 2 | Train Loss: 0.716 Vali Loss: 0.746 Vali Acc: 0.881 Test Loss: 0.746 Test Acc: 0.881
Validation loss decreased (-0.866659 --> -0.881474).  Saving model ...
Epoch: 22 cost time: 0.4743218421936035
Epoch: 22, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.697 Vali Acc: 0.900 Test Loss: 0.697 Test Acc: 0.900
Validation loss decreased (-0.881474 --> -0.899993).  Saving model ...
Epoch: 23 cost time: 0.5334644317626953
Epoch: 23, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.651 Vali Acc: 0.904 Test Loss: 0.651 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 24 cost time: 0.517392635345459
Epoch: 24, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.606 Vali Acc: 0.915 Test Loss: 0.606 Test Acc: 0.915
Validation loss decreased (-0.903697 --> -0.914809).  Saving model ...
Epoch: 25 cost time: 0.5122342109680176
Epoch: 25, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.566 Vali Acc: 0.930 Test Loss: 0.566 Test Acc: 0.930
Validation loss decreased (-0.914809 --> -0.929624).  Saving model ...
Epoch: 26 cost time: 0.46099853515625
Epoch: 26, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.529 Vali Acc: 0.930 Test Loss: 0.529 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 27 cost time: 0.5080006122589111
Epoch: 27, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.494 Vali Acc: 0.926 Test Loss: 0.494 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.48464202880859375
Epoch: 28, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.461 Vali Acc: 0.926 Test Loss: 0.461 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5734457969665527
Epoch: 29, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.431 Vali Acc: 0.933 Test Loss: 0.431 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933329).  Saving model ...
Epoch: 30 cost time: 0.4829428195953369
Epoch: 30, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.405 Vali Acc: 0.930 Test Loss: 0.405 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.3993709087371826
Epoch: 31, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.382 Vali Acc: 0.930 Test Loss: 0.382 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.45522284507751465
Epoch: 32, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.362 Vali Acc: 0.933 Test Loss: 0.362 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 33 cost time: 0.5712063312530518
Epoch: 33, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.344 Vali Acc: 0.933 Test Loss: 0.344 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 34 cost time: 0.6665971279144287
Epoch: 34, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.327 Vali Acc: 0.937 Test Loss: 0.327 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 35 cost time: 0.5052876472473145
Epoch: 35, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.311 Vali Acc: 0.937 Test Loss: 0.311 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 36 cost time: 0.5293996334075928
Epoch: 36, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.298 Vali Acc: 0.937 Test Loss: 0.298 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 37 cost time: 0.5984649658203125
Epoch: 37, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.287 Vali Acc: 0.941 Test Loss: 0.287 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.5407242774963379
Epoch: 38, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5020525455474854
Epoch: 39, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5299489498138428
Epoch: 40, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5853061676025391
Epoch: 41, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5768966674804688
Epoch: 42, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.5026893615722656
Epoch: 43, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5216717720031738
Epoch: 44, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.4365842342376709
Epoch: 45, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.4921393394470215
Epoch: 46, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.4947779178619385
Epoch: 47, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5033659934997559
Epoch: 48, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.4651913642883301
Epoch: 49, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.4824533462524414
Epoch: 50, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6096737384796143
Epoch: 51, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.215 Vali Acc: 0.952 Test Loss: 0.215 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 52 cost time: 0.4805119037628174
Epoch: 52, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5857579708099365
Epoch: 53, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.211 Vali Acc: 0.952 Test Loss: 0.211 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 54 cost time: 0.5008378028869629
Epoch: 54, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.4309415817260742
Epoch: 55, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5382506847381592
Epoch: 56, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.48085522651672363
Epoch: 57, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.5086431503295898
Epoch: 58, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.47637438774108887
Epoch: 59, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.5096561908721924
Epoch: 60, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.5260474681854248
Epoch: 61, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.5323290824890137
Epoch: 62, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.5649580955505371
Epoch: 63, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 23174
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.962893009185791
Epoch: 1, Steps: 2 | Train Loss: 2.021 Vali Loss: 1.886 Vali Acc: 0.193 Test Loss: 1.886 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.5646331310272217
Epoch: 2, Steps: 2 | Train Loss: 1.979 Vali Loss: 1.848 Vali Acc: 0.200 Test Loss: 1.848 Test Acc: 0.200
Validation loss decreased (-0.192574 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.5171000957489014
Epoch: 3, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.819 Vali Acc: 0.207 Test Loss: 1.819 Test Acc: 0.207
Validation loss decreased (-0.199982 --> -0.207389).  Saving model ...
Epoch: 4 cost time: 0.6039023399353027
Epoch: 4, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.792 Vali Acc: 0.219 Test Loss: 1.792 Test Acc: 0.219
Validation loss decreased (-0.207389 --> -0.218501).  Saving model ...
Epoch: 5 cost time: 0.4963521957397461
Epoch: 5, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.757 Vali Acc: 0.237 Test Loss: 1.757 Test Acc: 0.237
Validation loss decreased (-0.218501 --> -0.237019).  Saving model ...
Epoch: 6 cost time: 0.5513961315155029
Epoch: 6, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.713 Vali Acc: 0.289 Test Loss: 1.713 Test Acc: 0.289
Validation loss decreased (-0.237019 --> -0.288872).  Saving model ...
Epoch: 7 cost time: 0.5230119228363037
Epoch: 7, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.665 Vali Acc: 0.315 Test Loss: 1.665 Test Acc: 0.315
Validation loss decreased (-0.288872 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 0.575411319732666
Epoch: 8, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.611 Vali Acc: 0.356 Test Loss: 1.611 Test Acc: 0.356
Validation loss decreased (-0.314798 --> -0.355539).  Saving model ...
Epoch: 9 cost time: 0.47559547424316406
Epoch: 9, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.553 Vali Acc: 0.378 Test Loss: 1.553 Test Acc: 0.378
Validation loss decreased (-0.355539 --> -0.377762).  Saving model ...
Epoch: 10 cost time: 0.44367098808288574
Epoch: 10, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.492 Vali Acc: 0.411 Test Loss: 1.492 Test Acc: 0.411
Validation loss decreased (-0.377762 --> -0.411096).  Saving model ...
Epoch: 11 cost time: 0.4754488468170166
Epoch: 11, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.428 Vali Acc: 0.474 Test Loss: 1.428 Test Acc: 0.474
Validation loss decreased (-0.411096 --> -0.474060).  Saving model ...
Epoch: 12 cost time: 0.5802834033966064
Epoch: 12, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.363 Vali Acc: 0.541 Test Loss: 1.363 Test Acc: 0.541
Validation loss decreased (-0.474060 --> -0.540727).  Saving model ...
Epoch: 13 cost time: 0.6177809238433838
Epoch: 13, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.298 Vali Acc: 0.607 Test Loss: 1.298 Test Acc: 0.607
Validation loss decreased (-0.540727 --> -0.607394).  Saving model ...
Epoch: 14 cost time: 0.5626742839813232
Epoch: 14, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.232 Vali Acc: 0.659 Test Loss: 1.232 Test Acc: 0.659
Validation loss decreased (-0.607394 --> -0.659247).  Saving model ...
Epoch: 15 cost time: 0.5100357532501221
Epoch: 15, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.169 Vali Acc: 0.678 Test Loss: 1.169 Test Acc: 0.678
Validation loss decreased (-0.659247 --> -0.677766).  Saving model ...
Epoch: 16 cost time: 0.5009448528289795
Epoch: 16, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.106 Vali Acc: 0.704 Test Loss: 1.106 Test Acc: 0.704
Validation loss decreased (-0.677766 --> -0.703693).  Saving model ...
Epoch: 17 cost time: 0.610562801361084
Epoch: 17, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.045 Vali Acc: 0.722 Test Loss: 1.045 Test Acc: 0.722
Validation loss decreased (-0.703693 --> -0.722212).  Saving model ...
Epoch: 18 cost time: 0.5346555709838867
Epoch: 18, Steps: 2 | Train Loss: 0.941 Vali Loss: 0.987 Vali Acc: 0.748 Test Loss: 0.987 Test Acc: 0.748
Validation loss decreased (-0.722212 --> -0.748138).  Saving model ...
Epoch: 19 cost time: 0.4318094253540039
Epoch: 19, Steps: 2 | Train Loss: 0.926 Vali Loss: 0.931 Vali Acc: 0.763 Test Loss: 0.931 Test Acc: 0.763
Validation loss decreased (-0.748138 --> -0.762954).  Saving model ...
Epoch: 20 cost time: 0.4962015151977539
Epoch: 20, Steps: 2 | Train Loss: 0.890 Vali Loss: 0.878 Vali Acc: 0.793 Test Loss: 0.878 Test Acc: 0.793
Validation loss decreased (-0.762954 --> -0.792584).  Saving model ...
Epoch: 21 cost time: 0.4445011615753174
Epoch: 21, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.827 Vali Acc: 0.819 Test Loss: 0.827 Test Acc: 0.819
Validation loss decreased (-0.792584 --> -0.818510).  Saving model ...
Epoch: 22 cost time: 0.5230014324188232
Epoch: 22, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.780 Vali Acc: 0.830 Test Loss: 0.780 Test Acc: 0.830
Validation loss decreased (-0.818510 --> -0.829622).  Saving model ...
Epoch: 23 cost time: 0.4936554431915283
Epoch: 23, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.735 Vali Acc: 0.848 Test Loss: 0.735 Test Acc: 0.848
Validation loss decreased (-0.829622 --> -0.848141).  Saving model ...
Epoch: 24 cost time: 0.4185006618499756
Epoch: 24, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.693 Vali Acc: 0.848 Test Loss: 0.693 Test Acc: 0.848
Validation loss decreased (-0.848141 --> -0.848141).  Saving model ...
Epoch: 25 cost time: 0.5262801647186279
Epoch: 25, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.652 Vali Acc: 0.852 Test Loss: 0.652 Test Acc: 0.852
Validation loss decreased (-0.848141 --> -0.851845).  Saving model ...
Epoch: 26 cost time: 0.5608866214752197
Epoch: 26, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.616 Vali Acc: 0.859 Test Loss: 0.616 Test Acc: 0.859
Validation loss decreased (-0.851845 --> -0.859253).  Saving model ...
Epoch: 27 cost time: 0.5449755191802979
Epoch: 27, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.581 Vali Acc: 0.870 Test Loss: 0.581 Test Acc: 0.870
Validation loss decreased (-0.859253 --> -0.870365).  Saving model ...
Epoch: 28 cost time: 0.5108494758605957
Epoch: 28, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.549 Vali Acc: 0.889 Test Loss: 0.549 Test Acc: 0.889
Validation loss decreased (-0.870365 --> -0.888883).  Saving model ...
Epoch: 29 cost time: 0.4950721263885498
Epoch: 29, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.5078175067901611
Epoch: 30, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.490 Vali Acc: 0.911 Test Loss: 0.490 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911106).  Saving model ...
Epoch: 31 cost time: 0.48937296867370605
Epoch: 31, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.465 Vali Acc: 0.915 Test Loss: 0.465 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 32 cost time: 0.5522656440734863
Epoch: 32, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.442 Vali Acc: 0.926 Test Loss: 0.442 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925922).  Saving model ...
Epoch: 33 cost time: 0.6053500175476074
Epoch: 33, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.421 Vali Acc: 0.930 Test Loss: 0.421 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929625).  Saving model ...
Epoch: 34 cost time: 0.6334450244903564
Epoch: 34, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.401 Vali Acc: 0.937 Test Loss: 0.401 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 35 cost time: 0.5748732089996338
Epoch: 35, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.384 Vali Acc: 0.937 Test Loss: 0.384 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 36 cost time: 0.5416238307952881
Epoch: 36, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.368 Vali Acc: 0.937 Test Loss: 0.368 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 37 cost time: 0.549004077911377
Epoch: 37, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.354 Vali Acc: 0.937 Test Loss: 0.354 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 38 cost time: 0.5196950435638428
Epoch: 38, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 39 cost time: 0.5500326156616211
Epoch: 39, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.329 Vali Acc: 0.937 Test Loss: 0.329 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 0.5125882625579834
Epoch: 40, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.319 Vali Acc: 0.937 Test Loss: 0.319 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.537459135055542
Epoch: 41, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 42 cost time: 0.5522208213806152
Epoch: 42, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.300 Vali Acc: 0.941 Test Loss: 0.300 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 43 cost time: 0.6389789581298828
Epoch: 43, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.293 Vali Acc: 0.941 Test Loss: 0.293 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.5128374099731445
Epoch: 44, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.287 Vali Acc: 0.937 Test Loss: 0.287 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5166120529174805
Epoch: 45, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5290923118591309
Epoch: 46, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.512833833694458
Epoch: 47, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.271 Vali Acc: 0.937 Test Loss: 0.271 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.49250102043151855
Epoch: 48, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6070220470428467
Epoch: 49, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5349595546722412
Epoch: 50, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5206372737884521
Epoch: 51, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5570173263549805
Epoch: 52, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5242753028869629
Epoch: 53, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 19350
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.016416549682617
Epoch: 1, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.840 Vali Acc: 0.222 Test Loss: 1.840 Test Acc: 0.222
Validation loss decreased (inf --> -0.222204).  Saving model ...
Epoch: 2 cost time: 0.4972803592681885
Epoch: 2, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.802 Vali Acc: 0.248 Test Loss: 1.802 Test Acc: 0.248
Validation loss decreased (-0.222204 --> -0.248130).  Saving model ...
Epoch: 3 cost time: 0.5745227336883545
Epoch: 3, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.774 Vali Acc: 0.278 Test Loss: 1.774 Test Acc: 0.278
Validation loss decreased (-0.248130 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 0.4742708206176758
Epoch: 4, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.749 Vali Acc: 0.300 Test Loss: 1.749 Test Acc: 0.300
Validation loss decreased (-0.277760 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 0.49764204025268555
Epoch: 5, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.720 Vali Acc: 0.326 Test Loss: 1.720 Test Acc: 0.326
Validation loss decreased (-0.299983 --> -0.325909).  Saving model ...
Epoch: 6 cost time: 0.5011146068572998
Epoch: 6, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.686 Vali Acc: 0.352 Test Loss: 1.686 Test Acc: 0.352
Validation loss decreased (-0.325909 --> -0.351835).  Saving model ...
Epoch: 7 cost time: 0.5825259685516357
Epoch: 7, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.649 Vali Acc: 0.393 Test Loss: 1.649 Test Acc: 0.393
Validation loss decreased (-0.351835 --> -0.392576).  Saving model ...
Epoch: 8 cost time: 0.5877285003662109
Epoch: 8, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.607 Vali Acc: 0.419 Test Loss: 1.607 Test Acc: 0.419
Validation loss decreased (-0.392576 --> -0.418502).  Saving model ...
Epoch: 9 cost time: 0.5061254501342773
Epoch: 9, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.563 Vali Acc: 0.470 Test Loss: 1.563 Test Acc: 0.470
Validation loss decreased (-0.418502 --> -0.470355).  Saving model ...
Epoch: 10 cost time: 0.525261640548706
Epoch: 10, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.517 Vali Acc: 0.504 Test Loss: 1.517 Test Acc: 0.504
Validation loss decreased (-0.470355 --> -0.503689).  Saving model ...
Epoch: 11 cost time: 0.47742724418640137
Epoch: 11, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.469 Vali Acc: 0.515 Test Loss: 1.469 Test Acc: 0.515
Validation loss decreased (-0.503689 --> -0.514800).  Saving model ...
Epoch: 12 cost time: 0.5808255672454834
Epoch: 12, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.419 Vali Acc: 0.544 Test Loss: 1.419 Test Acc: 0.544
Validation loss decreased (-0.514800 --> -0.544430).  Saving model ...
Epoch: 13 cost time: 0.5023269653320312
Epoch: 13, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.368 Vali Acc: 0.589 Test Loss: 1.368 Test Acc: 0.589
Validation loss decreased (-0.544430 --> -0.588875).  Saving model ...
Epoch: 14 cost time: 0.5075118541717529
Epoch: 14, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.318 Vali Acc: 0.596 Test Loss: 1.318 Test Acc: 0.596
Validation loss decreased (-0.588875 --> -0.596283).  Saving model ...
Epoch: 15 cost time: 0.5009233951568604
Epoch: 15, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.268 Vali Acc: 0.633 Test Loss: 1.268 Test Acc: 0.633
Validation loss decreased (-0.596283 --> -0.633321).  Saving model ...
Epoch: 16 cost time: 0.5680427551269531
Epoch: 16, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.219 Vali Acc: 0.659 Test Loss: 1.219 Test Acc: 0.659
Validation loss decreased (-0.633321 --> -0.659247).  Saving model ...
Epoch: 17 cost time: 0.610715389251709
Epoch: 17, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.170 Vali Acc: 0.689 Test Loss: 1.170 Test Acc: 0.689
Validation loss decreased (-0.659247 --> -0.688877).  Saving model ...
Epoch: 18 cost time: 0.441788911819458
Epoch: 18, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.121 Vali Acc: 0.707 Test Loss: 1.121 Test Acc: 0.707
Validation loss decreased (-0.688877 --> -0.707396).  Saving model ...
Epoch: 19 cost time: 0.5148305892944336
Epoch: 19, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.074 Vali Acc: 0.726 Test Loss: 1.074 Test Acc: 0.726
Validation loss decreased (-0.707396 --> -0.725915).  Saving model ...
Epoch: 20 cost time: 0.4689826965332031
Epoch: 20, Steps: 2 | Train Loss: 0.917 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
Validation loss decreased (-0.725915 --> -0.733323).  Saving model ...
Epoch: 21 cost time: 0.5308713912963867
Epoch: 21, Steps: 2 | Train Loss: 0.928 Vali Loss: 0.981 Vali Acc: 0.744 Test Loss: 0.981 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744435).  Saving model ...
Epoch: 22 cost time: 0.4781625270843506
Epoch: 22, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.939 Vali Acc: 0.763 Test Loss: 0.939 Test Acc: 0.763
Validation loss decreased (-0.744435 --> -0.762954).  Saving model ...
Epoch: 23 cost time: 0.45226263999938965
Epoch: 23, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.898 Vali Acc: 0.767 Test Loss: 0.898 Test Acc: 0.767
Validation loss decreased (-0.762954 --> -0.766658).  Saving model ...
Epoch: 24 cost time: 0.530958890914917
Epoch: 24, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.860 Vali Acc: 0.774 Test Loss: 0.860 Test Acc: 0.774
Validation loss decreased (-0.766658 --> -0.774065).  Saving model ...
Epoch: 25 cost time: 0.6294543743133545
Epoch: 25, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.823 Vali Acc: 0.789 Test Loss: 0.823 Test Acc: 0.789
Validation loss decreased (-0.774065 --> -0.788881).  Saving model ...
Epoch: 26 cost time: 0.4220740795135498
Epoch: 26, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.787 Vali Acc: 0.804 Test Loss: 0.787 Test Acc: 0.804
Validation loss decreased (-0.788881 --> -0.803696).  Saving model ...
Epoch: 27 cost time: 0.46778273582458496
Epoch: 27, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.754 Vali Acc: 0.811 Test Loss: 0.754 Test Acc: 0.811
Validation loss decreased (-0.803696 --> -0.811104).  Saving model ...
Epoch: 28 cost time: 0.4319722652435303
Epoch: 28, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.722 Vali Acc: 0.830 Test Loss: 0.722 Test Acc: 0.830
Validation loss decreased (-0.811104 --> -0.829622).  Saving model ...
Epoch: 29 cost time: 0.457319974899292
Epoch: 29, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.691 Vali Acc: 0.841 Test Loss: 0.691 Test Acc: 0.841
Validation loss decreased (-0.829622 --> -0.840734).  Saving model ...
Epoch: 30 cost time: 0.5175952911376953
Epoch: 30, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
Validation loss decreased (-0.840734 --> -0.844438).  Saving model ...
Epoch: 31 cost time: 0.48488831520080566
Epoch: 31, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.636 Vali Acc: 0.852 Test Loss: 0.636 Test Acc: 0.852
Validation loss decreased (-0.844438 --> -0.851845).  Saving model ...
Epoch: 32 cost time: 0.5227696895599365
Epoch: 32, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.611 Vali Acc: 0.859 Test Loss: 0.611 Test Acc: 0.859
Validation loss decreased (-0.851845 --> -0.859253).  Saving model ...
Epoch: 33 cost time: 0.5004367828369141
Epoch: 33, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 0.5041875839233398
Epoch: 34, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.565 Vali Acc: 0.878 Test Loss: 0.565 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 35 cost time: 0.508589506149292
Epoch: 35, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.545 Vali Acc: 0.878 Test Loss: 0.545 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 36 cost time: 0.5780808925628662
Epoch: 36, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 37 cost time: 0.5655527114868164
Epoch: 37, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.509 Vali Acc: 0.885 Test Loss: 0.509 Test Acc: 0.885
Validation loss decreased (-0.877773 --> -0.885180).  Saving model ...
Epoch: 38 cost time: 0.4772341251373291
Epoch: 38, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.492 Vali Acc: 0.893 Test Loss: 0.492 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892588).  Saving model ...
Epoch: 39 cost time: 0.5422861576080322
Epoch: 39, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.476 Vali Acc: 0.893 Test Loss: 0.476 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 40 cost time: 0.614508867263794
Epoch: 40, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.461 Vali Acc: 0.896 Test Loss: 0.461 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 41 cost time: 0.45343923568725586
Epoch: 41, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 42 cost time: 0.470794677734375
Epoch: 42, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 0.5870218276977539
Epoch: 43, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 0.5461344718933105
Epoch: 44, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 0.5454213619232178
Epoch: 45, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 0.46745824813842773
Epoch: 46, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.391 Vali Acc: 0.904 Test Loss: 0.391 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 47 cost time: 0.4947185516357422
Epoch: 47, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.383 Vali Acc: 0.904 Test Loss: 0.383 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 48 cost time: 0.4994802474975586
Epoch: 48, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5539238452911377
Epoch: 49, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4916989803314209
Epoch: 50, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.4878709316253662
Epoch: 51, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.48304176330566406
Epoch: 52, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.353 Vali Acc: 0.896 Test Loss: 0.353 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.5405278205871582
Epoch: 53, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.42690300941467285
Epoch: 54, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.57904052734375
Epoch: 55, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.44220447540283203
Epoch: 56, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.332 Vali Acc: 0.904 Test Loss: 0.332 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 57 cost time: 0.5137753486633301
Epoch: 57, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5169639587402344
Epoch: 58, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5157513618469238
Epoch: 59, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5651340484619141
Epoch: 60, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.580397367477417
Epoch: 61, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5281777381896973
Epoch: 62, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.307 Vali Acc: 0.904 Test Loss: 0.307 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903701).  Saving model ...
Epoch: 63 cost time: 0.5425519943237305
Epoch: 63, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.304 Vali Acc: 0.907 Test Loss: 0.304 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907404).  Saving model ...
Epoch: 64 cost time: 0.5490062236785889
Epoch: 64, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.301 Vali Acc: 0.907 Test Loss: 0.301 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 65 cost time: 0.5479247570037842
Epoch: 65, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.299 Vali Acc: 0.907 Test Loss: 0.299 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 66 cost time: 0.517113208770752
Epoch: 66, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.296 Vali Acc: 0.907 Test Loss: 0.296 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 67 cost time: 0.5303401947021484
Epoch: 67, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.293 Vali Acc: 0.907 Test Loss: 0.293 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 68 cost time: 0.4902212619781494
Epoch: 68, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.291 Vali Acc: 0.907 Test Loss: 0.291 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907405).  Saving model ...
Epoch: 69 cost time: 0.5740447044372559
Epoch: 69, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.288 Vali Acc: 0.907 Test Loss: 0.288 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 70 cost time: 0.519296407699585
Epoch: 70, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.285 Vali Acc: 0.907 Test Loss: 0.285 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 71 cost time: 0.4729914665222168
Epoch: 71, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.282 Vali Acc: 0.907 Test Loss: 0.282 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 72 cost time: 0.4938344955444336
Epoch: 72, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.280 Vali Acc: 0.907 Test Loss: 0.280 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 73 cost time: 0.505406379699707
Epoch: 73, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911108).  Saving model ...
Epoch: 74 cost time: 0.46158552169799805
Epoch: 74, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 75 cost time: 0.4263467788696289
Epoch: 75, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 76 cost time: 0.4524216651916504
Epoch: 76, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 77 cost time: 0.5033454895019531
Epoch: 77, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 78 cost time: 0.4196145534515381
Epoch: 78, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 79 cost time: 0.46169233322143555
Epoch: 79, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 80 cost time: 0.5404458045959473
Epoch: 80, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 81 cost time: 0.476909875869751
Epoch: 81, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.268 Vali Acc: 0.911 Test Loss: 0.268 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 82 cost time: 0.49683499336242676
Epoch: 82, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 83 cost time: 0.4839460849761963
Epoch: 83, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.266 Vali Acc: 0.915 Test Loss: 0.266 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 84 cost time: 0.5378499031066895
Epoch: 84, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.263 Vali Acc: 0.915 Test Loss: 0.263 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 85 cost time: 0.5717167854309082
Epoch: 85, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.261 Vali Acc: 0.915 Test Loss: 0.261 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 86 cost time: 0.5190870761871338
Epoch: 86, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.258 Vali Acc: 0.919 Test Loss: 0.258 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 87 cost time: 0.49967479705810547
Epoch: 87, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 88 cost time: 0.502953290939331
Epoch: 88, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.254 Vali Acc: 0.919 Test Loss: 0.254 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 89 cost time: 0.5472750663757324
Epoch: 89, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 90 cost time: 0.49100565910339355
Epoch: 90, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 91 cost time: 0.4602174758911133
Epoch: 91, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.5386126041412354
Epoch: 92, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.583817720413208
Epoch: 93, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.5039811134338379
Epoch: 94, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.249 Vali Acc: 0.919 Test Loss: 0.249 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.500096321105957
Epoch: 95, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.248 Vali Acc: 0.919 Test Loss: 0.248 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.5381298065185547
Epoch: 96, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.248 Vali Acc: 0.919 Test Loss: 0.248 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.4943816661834717
Epoch: 97, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.6054182052612305
Epoch: 98, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.5928151607513428
Epoch: 99, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 0.5669958591461182
Epoch: 100, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 17078
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.306112051010132
Epoch: 1, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.927 Vali Acc: 0.252 Test Loss: 1.927 Test Acc: 0.252
Validation loss decreased (inf --> -0.251833).  Saving model ...
Epoch: 2 cost time: 0.5409882068634033
Epoch: 2, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.890 Vali Acc: 0.259 Test Loss: 1.890 Test Acc: 0.259
Validation loss decreased (-0.251833 --> -0.259240).  Saving model ...
Epoch: 3 cost time: 0.6069681644439697
Epoch: 3, Steps: 2 | Train Loss: 2.005 Vali Loss: 1.861 Vali Acc: 0.267 Test Loss: 1.861 Test Acc: 0.267
Validation loss decreased (-0.259240 --> -0.266648).  Saving model ...
Epoch: 4 cost time: 0.5022497177124023
Epoch: 4, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.837 Vali Acc: 0.267 Test Loss: 1.837 Test Acc: 0.267
Validation loss decreased (-0.266648 --> -0.266648).  Saving model ...
Epoch: 5 cost time: 0.6278767585754395
Epoch: 5, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.809 Vali Acc: 0.281 Test Loss: 1.809 Test Acc: 0.281
Validation loss decreased (-0.266648 --> -0.281463).  Saving model ...
Epoch: 6 cost time: 0.5837593078613281
Epoch: 6, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.776 Vali Acc: 0.293 Test Loss: 1.776 Test Acc: 0.293
Validation loss decreased (-0.281463 --> -0.292575).  Saving model ...
Epoch: 7 cost time: 0.48099565505981445
Epoch: 7, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.738 Vali Acc: 0.307 Test Loss: 1.738 Test Acc: 0.307
Validation loss decreased (-0.292575 --> -0.307390).  Saving model ...
Epoch: 8 cost time: 0.5496118068695068
Epoch: 8, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.698 Vali Acc: 0.341 Test Loss: 1.698 Test Acc: 0.341
Validation loss decreased (-0.307390 --> -0.340724).  Saving model ...
Epoch: 9 cost time: 0.4696645736694336
Epoch: 9, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.655 Vali Acc: 0.370 Test Loss: 1.655 Test Acc: 0.370
Validation loss decreased (-0.340724 --> -0.370354).  Saving model ...
Epoch: 10 cost time: 0.5447578430175781
Epoch: 10, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.611 Vali Acc: 0.430 Test Loss: 1.611 Test Acc: 0.430
Validation loss decreased (-0.370354 --> -0.429614).  Saving model ...
Epoch: 11 cost time: 0.40738487243652344
Epoch: 11, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.564 Vali Acc: 0.470 Test Loss: 1.564 Test Acc: 0.470
Validation loss decreased (-0.429614 --> -0.470355).  Saving model ...
Epoch: 12 cost time: 0.503373384475708
Epoch: 12, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.515 Vali Acc: 0.511 Test Loss: 1.515 Test Acc: 0.511
Validation loss decreased (-0.470355 --> -0.511096).  Saving model ...
Epoch: 13 cost time: 0.5455057621002197
Epoch: 13, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.466 Vali Acc: 0.530 Test Loss: 1.466 Test Acc: 0.530
Validation loss decreased (-0.511096 --> -0.529615).  Saving model ...
Epoch: 14 cost time: 0.49762701988220215
Epoch: 14, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.418 Vali Acc: 0.563 Test Loss: 1.418 Test Acc: 0.563
Validation loss decreased (-0.529615 --> -0.562949).  Saving model ...
Epoch: 15 cost time: 0.5634644031524658
Epoch: 15, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.368 Vali Acc: 0.585 Test Loss: 1.368 Test Acc: 0.585
Validation loss decreased (-0.562949 --> -0.585172).  Saving model ...
Epoch: 16 cost time: 0.509906530380249
Epoch: 16, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.320 Vali Acc: 0.604 Test Loss: 1.320 Test Acc: 0.604
Validation loss decreased (-0.585172 --> -0.603691).  Saving model ...
Epoch: 17 cost time: 0.5143530368804932
Epoch: 17, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.272 Vali Acc: 0.622 Test Loss: 1.272 Test Acc: 0.622
Validation loss decreased (-0.603691 --> -0.622210).  Saving model ...
Epoch: 18 cost time: 0.5429327487945557
Epoch: 18, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.225 Vali Acc: 0.648 Test Loss: 1.225 Test Acc: 0.648
Validation loss decreased (-0.622210 --> -0.648136).  Saving model ...
Epoch: 19 cost time: 0.5270717144012451
Epoch: 19, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.178 Vali Acc: 0.678 Test Loss: 1.178 Test Acc: 0.678
Validation loss decreased (-0.648136 --> -0.677766).  Saving model ...
Epoch: 20 cost time: 0.5833532810211182
Epoch: 20, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.132 Vali Acc: 0.696 Test Loss: 1.132 Test Acc: 0.696
Validation loss decreased (-0.677766 --> -0.696285).  Saving model ...
Epoch: 21 cost time: 0.44812917709350586
Epoch: 21, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.088 Vali Acc: 0.704 Test Loss: 1.088 Test Acc: 0.704
Validation loss decreased (-0.696285 --> -0.703693).  Saving model ...
Epoch: 22 cost time: 0.4502415657043457
Epoch: 22, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.043 Vali Acc: 0.722 Test Loss: 1.043 Test Acc: 0.722
Validation loss decreased (-0.703693 --> -0.722212).  Saving model ...
Epoch: 23 cost time: 0.4336278438568115
Epoch: 23, Steps: 2 | Train Loss: 1.003 Vali Loss: 0.999 Vali Acc: 0.752 Test Loss: 0.999 Test Acc: 0.752
Validation loss decreased (-0.722212 --> -0.751842).  Saving model ...
Epoch: 24 cost time: 0.5690445899963379
Epoch: 24, Steps: 2 | Train Loss: 1.015 Vali Loss: 0.957 Vali Acc: 0.789 Test Loss: 0.957 Test Acc: 0.789
Validation loss decreased (-0.751842 --> -0.788879).  Saving model ...
Epoch: 25 cost time: 0.6895315647125244
Epoch: 25, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.917 Vali Acc: 0.804 Test Loss: 0.917 Test Acc: 0.804
Validation loss decreased (-0.788879 --> -0.803695).  Saving model ...
Epoch: 26 cost time: 0.5051462650299072
Epoch: 26, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.878 Vali Acc: 0.815 Test Loss: 0.878 Test Acc: 0.815
Validation loss decreased (-0.803695 --> -0.814806).  Saving model ...
Epoch: 27 cost time: 0.56020188331604
Epoch: 27, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.841 Vali Acc: 0.833 Test Loss: 0.841 Test Acc: 0.833
Validation loss decreased (-0.814806 --> -0.833325).  Saving model ...
Epoch: 28 cost time: 0.500413179397583
Epoch: 28, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.805 Vali Acc: 0.852 Test Loss: 0.805 Test Acc: 0.852
Validation loss decreased (-0.833325 --> -0.851844).  Saving model ...
Epoch: 29 cost time: 0.5845305919647217
Epoch: 29, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.770 Vali Acc: 0.863 Test Loss: 0.770 Test Acc: 0.863
Validation loss decreased (-0.851844 --> -0.862955).  Saving model ...
Epoch: 30 cost time: 0.47426390647888184
Epoch: 30, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.736 Vali Acc: 0.867 Test Loss: 0.736 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866659).  Saving model ...
Epoch: 31 cost time: 0.5495197772979736
Epoch: 31, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.703 Vali Acc: 0.867 Test Loss: 0.703 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866660).  Saving model ...
Epoch: 32 cost time: 0.5034637451171875
Epoch: 32, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.671 Vali Acc: 0.878 Test Loss: 0.671 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 33 cost time: 0.54598069190979
Epoch: 33, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.641 Vali Acc: 0.885 Test Loss: 0.641 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885179).  Saving model ...
Epoch: 34 cost time: 0.4411008358001709
Epoch: 34, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.612 Vali Acc: 0.896 Test Loss: 0.612 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896290).  Saving model ...
Epoch: 35 cost time: 0.5173051357269287
Epoch: 35, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.584 Vali Acc: 0.911 Test Loss: 0.584 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911105).  Saving model ...
Epoch: 36 cost time: 0.4477205276489258
Epoch: 36, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.558 Vali Acc: 0.919 Test Loss: 0.558 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 37 cost time: 0.5223939418792725
Epoch: 37, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.533 Vali Acc: 0.922 Test Loss: 0.533 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 38 cost time: 0.5375440120697021
Epoch: 38, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.510 Vali Acc: 0.922 Test Loss: 0.510 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 39 cost time: 0.5207343101501465
Epoch: 39, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.489 Vali Acc: 0.933 Test Loss: 0.489 Test Acc: 0.933
Validation loss decreased (-0.922217 --> -0.933328).  Saving model ...
Epoch: 40 cost time: 0.5653774738311768
Epoch: 40, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.468 Vali Acc: 0.937 Test Loss: 0.468 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 41 cost time: 0.5561895370483398
Epoch: 41, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.451 Vali Acc: 0.937 Test Loss: 0.451 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 42 cost time: 0.5381252765655518
Epoch: 42, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.435 Vali Acc: 0.937 Test Loss: 0.435 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 43 cost time: 0.5154540538787842
Epoch: 43, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.419 Vali Acc: 0.937 Test Loss: 0.419 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 44 cost time: 0.4514200687408447
Epoch: 44, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.405 Vali Acc: 0.937 Test Loss: 0.405 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 45 cost time: 0.5117051601409912
Epoch: 45, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.393 Vali Acc: 0.937 Test Loss: 0.393 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 46 cost time: 0.45622730255126953
Epoch: 46, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.381 Vali Acc: 0.941 Test Loss: 0.381 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 47 cost time: 0.5399594306945801
Epoch: 47, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.370 Vali Acc: 0.944 Test Loss: 0.370 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 48 cost time: 0.5391836166381836
Epoch: 48, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.361 Vali Acc: 0.944 Test Loss: 0.361 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 49 cost time: 0.5016083717346191
Epoch: 49, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.351 Vali Acc: 0.944 Test Loss: 0.351 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 50 cost time: 0.5302467346191406
Epoch: 50, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.342 Vali Acc: 0.948 Test Loss: 0.342 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 51 cost time: 0.5002849102020264
Epoch: 51, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5147731304168701
Epoch: 52, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.326 Vali Acc: 0.944 Test Loss: 0.326 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.4963870048522949
Epoch: 53, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.319 Vali Acc: 0.941 Test Loss: 0.319 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.4763913154602051
Epoch: 54, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.312 Vali Acc: 0.941 Test Loss: 0.312 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.494457483291626
Epoch: 55, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.306 Vali Acc: 0.941 Test Loss: 0.306 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.49288201332092285
Epoch: 56, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.300 Vali Acc: 0.941 Test Loss: 0.300 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.4853947162628174
Epoch: 57, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.4478011131286621
Epoch: 58, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.289 Vali Acc: 0.941 Test Loss: 0.289 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.4464151859283447
Epoch: 59, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.284 Vali Acc: 0.941 Test Loss: 0.284 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.5053653717041016
Epoch: 60, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.280 Vali Acc: 0.941 Test Loss: 0.280 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 15974
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0815536975860596
Epoch: 1, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.889 Vali Acc: 0.226 Test Loss: 1.889 Test Acc: 0.226
Validation loss decreased (inf --> -0.225907).  Saving model ...
Epoch: 2 cost time: 0.44090747833251953
Epoch: 2, Steps: 2 | Train Loss: 2.055 Vali Loss: 1.861 Vali Acc: 0.237 Test Loss: 1.861 Test Acc: 0.237
Validation loss decreased (-0.225907 --> -0.237018).  Saving model ...
Epoch: 3 cost time: 0.5501773357391357
Epoch: 3, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.841 Vali Acc: 0.241 Test Loss: 1.841 Test Acc: 0.241
Validation loss decreased (-0.237018 --> -0.240722).  Saving model ...
Epoch: 4 cost time: 0.5046358108520508
Epoch: 4, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.828 Vali Acc: 0.241 Test Loss: 1.828 Test Acc: 0.241
Validation loss decreased (-0.240722 --> -0.240722).  Saving model ...
Epoch: 5 cost time: 0.4477972984313965
Epoch: 5, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.812 Vali Acc: 0.244 Test Loss: 1.812 Test Acc: 0.244
Validation loss decreased (-0.240722 --> -0.244426).  Saving model ...
Epoch: 6 cost time: 0.4917788505554199
Epoch: 6, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.793 Vali Acc: 0.248 Test Loss: 1.793 Test Acc: 0.248
Validation loss decreased (-0.244426 --> -0.248130).  Saving model ...
Epoch: 7 cost time: 0.5488801002502441
Epoch: 7, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.773 Vali Acc: 0.252 Test Loss: 1.773 Test Acc: 0.252
Validation loss decreased (-0.248130 --> -0.251834).  Saving model ...
Epoch: 8 cost time: 0.49856114387512207
Epoch: 8, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.750 Vali Acc: 0.278 Test Loss: 1.750 Test Acc: 0.278
Validation loss decreased (-0.251834 --> -0.277760).  Saving model ...
Epoch: 9 cost time: 0.502640962600708
Epoch: 9, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.724 Vali Acc: 0.274 Test Loss: 1.724 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4667849540710449
Epoch: 10, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.696 Vali Acc: 0.289 Test Loss: 1.696 Test Acc: 0.289
Validation loss decreased (-0.277760 --> -0.288872).  Saving model ...
Epoch: 11 cost time: 0.5079019069671631
Epoch: 11, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.665 Vali Acc: 0.300 Test Loss: 1.665 Test Acc: 0.300
Validation loss decreased (-0.288872 --> -0.299983).  Saving model ...
Epoch: 12 cost time: 0.6197428703308105
Epoch: 12, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.633 Vali Acc: 0.315 Test Loss: 1.633 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 13 cost time: 0.48100996017456055
Epoch: 13, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.600 Vali Acc: 0.330 Test Loss: 1.600 Test Acc: 0.330
Validation loss decreased (-0.314798 --> -0.329614).  Saving model ...
Epoch: 14 cost time: 0.45650696754455566
Epoch: 14, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.565 Vali Acc: 0.356 Test Loss: 1.565 Test Acc: 0.356
Validation loss decreased (-0.329614 --> -0.355540).  Saving model ...
Epoch: 15 cost time: 0.49935078620910645
Epoch: 15, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.530 Vali Acc: 0.381 Test Loss: 1.530 Test Acc: 0.381
Validation loss decreased (-0.355540 --> -0.381466).  Saving model ...
Epoch: 16 cost time: 0.5032939910888672
Epoch: 16, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.493 Vali Acc: 0.407 Test Loss: 1.493 Test Acc: 0.407
Validation loss decreased (-0.381466 --> -0.407392).  Saving model ...
Epoch: 17 cost time: 0.4906156063079834
Epoch: 17, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.455 Vali Acc: 0.437 Test Loss: 1.455 Test Acc: 0.437
Validation loss decreased (-0.407392 --> -0.437022).  Saving model ...
Epoch: 18 cost time: 0.5174844264984131
Epoch: 18, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.416 Vali Acc: 0.459 Test Loss: 1.416 Test Acc: 0.459
Validation loss decreased (-0.437022 --> -0.459245).  Saving model ...
Epoch: 19 cost time: 0.6269996166229248
Epoch: 19, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.377 Vali Acc: 0.526 Test Loss: 1.377 Test Acc: 0.526
Validation loss decreased (-0.459245 --> -0.525912).  Saving model ...
Epoch: 20 cost time: 0.490062952041626
Epoch: 20, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.339 Vali Acc: 0.589 Test Loss: 1.339 Test Acc: 0.589
Validation loss decreased (-0.525912 --> -0.588876).  Saving model ...
Epoch: 21 cost time: 0.5270364284515381
Epoch: 21, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.299 Vali Acc: 0.641 Test Loss: 1.299 Test Acc: 0.641
Validation loss decreased (-0.588876 --> -0.640728).  Saving model ...
Epoch: 22 cost time: 0.514646053314209
Epoch: 22, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.260 Vali Acc: 0.674 Test Loss: 1.260 Test Acc: 0.674
Validation loss decreased (-0.640728 --> -0.674061).  Saving model ...
Epoch: 23 cost time: 0.5257129669189453
Epoch: 23, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.221 Vali Acc: 0.700 Test Loss: 1.221 Test Acc: 0.700
Validation loss decreased (-0.674061 --> -0.699988).  Saving model ...
Epoch: 24 cost time: 0.566925048828125
Epoch: 24, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.183 Vali Acc: 0.704 Test Loss: 1.183 Test Acc: 0.704
Validation loss decreased (-0.699988 --> -0.703692).  Saving model ...
Epoch: 25 cost time: 0.603492021560669
Epoch: 25, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.145 Vali Acc: 0.722 Test Loss: 1.145 Test Acc: 0.722
Validation loss decreased (-0.703692 --> -0.722211).  Saving model ...
Epoch: 26 cost time: 0.49828219413757324
Epoch: 26, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.108 Vali Acc: 0.744 Test Loss: 1.108 Test Acc: 0.744
Validation loss decreased (-0.722211 --> -0.744433).  Saving model ...
Epoch: 27 cost time: 0.4933328628540039
Epoch: 27, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.072 Vali Acc: 0.763 Test Loss: 1.072 Test Acc: 0.763
Validation loss decreased (-0.744433 --> -0.762952).  Saving model ...
Epoch: 28 cost time: 0.5128111839294434
Epoch: 28, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.036 Vali Acc: 0.778 Test Loss: 1.036 Test Acc: 0.778
Validation loss decreased (-0.762952 --> -0.777767).  Saving model ...
Epoch: 29 cost time: 0.5005145072937012
Epoch: 29, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.000 Vali Acc: 0.804 Test Loss: 1.000 Test Acc: 0.804
Validation loss decreased (-0.777767 --> -0.803694).  Saving model ...
Epoch: 30 cost time: 0.5354955196380615
Epoch: 30, Steps: 2 | Train Loss: 0.975 Vali Loss: 0.965 Vali Acc: 0.826 Test Loss: 0.965 Test Acc: 0.826
Validation loss decreased (-0.803694 --> -0.825916).  Saving model ...
Epoch: 31 cost time: 0.5165698528289795
Epoch: 31, Steps: 2 | Train Loss: 0.968 Vali Loss: 0.931 Vali Acc: 0.841 Test Loss: 0.931 Test Acc: 0.841
Validation loss decreased (-0.825916 --> -0.840731).  Saving model ...
Epoch: 32 cost time: 0.47387027740478516
Epoch: 32, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.899 Vali Acc: 0.852 Test Loss: 0.899 Test Acc: 0.852
Validation loss decreased (-0.840731 --> -0.851843).  Saving model ...
Epoch: 33 cost time: 0.5733613967895508
Epoch: 33, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.867 Vali Acc: 0.863 Test Loss: 0.867 Test Acc: 0.863
Validation loss decreased (-0.851843 --> -0.862954).  Saving model ...
Epoch: 34 cost time: 0.5925061702728271
Epoch: 34, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.837 Vali Acc: 0.863 Test Loss: 0.837 Test Acc: 0.863
Validation loss decreased (-0.862954 --> -0.862955).  Saving model ...
Epoch: 35 cost time: 0.5559842586517334
Epoch: 35, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.807 Vali Acc: 0.878 Test Loss: 0.807 Test Acc: 0.878
Validation loss decreased (-0.862955 --> -0.877770).  Saving model ...
Epoch: 36 cost time: 0.5076043605804443
Epoch: 36, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.780 Vali Acc: 0.885 Test Loss: 0.780 Test Acc: 0.885
Validation loss decreased (-0.877770 --> -0.885177).  Saving model ...
Epoch: 37 cost time: 0.4702622890472412
Epoch: 37, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.753 Vali Acc: 0.889 Test Loss: 0.753 Test Acc: 0.889
Validation loss decreased (-0.885177 --> -0.888881).  Saving model ...
Epoch: 38 cost time: 0.5961172580718994
Epoch: 38, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.727 Vali Acc: 0.900 Test Loss: 0.727 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899993).  Saving model ...
Epoch: 39 cost time: 0.43195366859436035
Epoch: 39, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.702 Vali Acc: 0.900 Test Loss: 0.702 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 40 cost time: 0.6202328205108643
Epoch: 40, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.678 Vali Acc: 0.904 Test Loss: 0.678 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 41 cost time: 0.5328009128570557
Epoch: 41, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.656 Vali Acc: 0.904 Test Loss: 0.656 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 42 cost time: 0.4885547161102295
Epoch: 42, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.636 Vali Acc: 0.904 Test Loss: 0.636 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 43 cost time: 0.5455982685089111
Epoch: 43, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.616 Vali Acc: 0.904 Test Loss: 0.616 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 44 cost time: 0.47046971321105957
Epoch: 44, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.597 Vali Acc: 0.904 Test Loss: 0.597 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 45 cost time: 0.42305445671081543
Epoch: 45, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.579 Vali Acc: 0.907 Test Loss: 0.579 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 46 cost time: 0.5037169456481934
Epoch: 46, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.562 Vali Acc: 0.915 Test Loss: 0.562 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914809).  Saving model ...
Epoch: 47 cost time: 0.481675386428833
Epoch: 47, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.547 Vali Acc: 0.919 Test Loss: 0.547 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 48 cost time: 0.5911109447479248
Epoch: 48, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.531 Vali Acc: 0.919 Test Loss: 0.531 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 49 cost time: 0.5452766418457031
Epoch: 49, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.517 Vali Acc: 0.919 Test Loss: 0.517 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 50 cost time: 0.5301611423492432
Epoch: 50, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.503 Vali Acc: 0.922 Test Loss: 0.503 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 51 cost time: 0.5123283863067627
Epoch: 51, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.491 Vali Acc: 0.926 Test Loss: 0.491 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 52 cost time: 0.7386770248413086
Epoch: 52, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.479 Vali Acc: 0.919 Test Loss: 0.479 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5476241111755371
Epoch: 53, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.467 Vali Acc: 0.919 Test Loss: 0.467 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6032121181488037
Epoch: 54, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.456 Vali Acc: 0.922 Test Loss: 0.456 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.46529459953308105
Epoch: 55, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.446 Vali Acc: 0.922 Test Loss: 0.446 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.5393309593200684
Epoch: 56, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.437 Vali Acc: 0.922 Test Loss: 0.437 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.6068942546844482
Epoch: 57, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.428 Vali Acc: 0.922 Test Loss: 0.428 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.5486743450164795
Epoch: 58, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.419 Vali Acc: 0.926 Test Loss: 0.419 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 59 cost time: 0.6477341651916504
Epoch: 59, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.411 Vali Acc: 0.926 Test Loss: 0.411 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 60 cost time: 0.529299259185791
Epoch: 60, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.403 Vali Acc: 0.926 Test Loss: 0.403 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 61 cost time: 0.5199282169342041
Epoch: 61, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.395 Vali Acc: 0.926 Test Loss: 0.395 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 62 cost time: 0.6288578510284424
Epoch: 62, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.388 Vali Acc: 0.926 Test Loss: 0.388 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 63 cost time: 0.5961451530456543
Epoch: 63, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.382 Vali Acc: 0.926 Test Loss: 0.382 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 64 cost time: 0.5890207290649414
Epoch: 64, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.375 Vali Acc: 0.926 Test Loss: 0.375 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 65 cost time: 0.5178408622741699
Epoch: 65, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.369 Vali Acc: 0.926 Test Loss: 0.369 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 66 cost time: 0.5470492839813232
Epoch: 66, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.363 Vali Acc: 0.926 Test Loss: 0.363 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 67 cost time: 0.5709514617919922
Epoch: 67, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.358 Vali Acc: 0.922 Test Loss: 0.358 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.5243546962738037
Epoch: 68, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.353 Vali Acc: 0.922 Test Loss: 0.353 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.4826803207397461
Epoch: 69, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.348 Vali Acc: 0.922 Test Loss: 0.348 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.5602710247039795
Epoch: 70, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.5205597877502441
Epoch: 71, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.340 Vali Acc: 0.922 Test Loss: 0.340 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.5197794437408447
Epoch: 72, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.336 Vali Acc: 0.926 Test Loss: 0.336 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 73 cost time: 0.578981876373291
Epoch: 73, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.332 Vali Acc: 0.926 Test Loss: 0.332 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 74 cost time: 0.44577598571777344
Epoch: 74, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.327 Vali Acc: 0.930 Test Loss: 0.327 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929626).  Saving model ...
Epoch: 75 cost time: 0.45386385917663574
Epoch: 75, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.323 Vali Acc: 0.933 Test Loss: 0.323 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 76 cost time: 0.5850870609283447
Epoch: 76, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 77 cost time: 0.48436927795410156
Epoch: 77, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.316 Vali Acc: 0.933 Test Loss: 0.316 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 78 cost time: 0.6186113357543945
Epoch: 78, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.313 Vali Acc: 0.933 Test Loss: 0.313 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 79 cost time: 0.6319618225097656
Epoch: 79, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.5947694778442383
Epoch: 80, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.307 Vali Acc: 0.930 Test Loss: 0.307 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.5121772289276123
Epoch: 81, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.6229870319366455
Epoch: 82, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.301 Vali Acc: 0.930 Test Loss: 0.301 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.484112024307251
Epoch: 83, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.5029983520507812
Epoch: 84, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.5317220687866211
Epoch: 85, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.5210585594177246
Epoch: 86, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.47725534439086914
Epoch: 87, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.4881281852722168
Epoch: 88, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 14486
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9753191471099854
Epoch: 1, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.953 Vali Acc: 0.219 Test Loss: 1.953 Test Acc: 0.219
Validation loss decreased (inf --> -0.218499).  Saving model ...
Epoch: 2 cost time: 0.4566476345062256
Epoch: 2, Steps: 2 | Train Loss: 1.949 Vali Loss: 1.912 Vali Acc: 0.237 Test Loss: 1.912 Test Acc: 0.237
Validation loss decreased (-0.218499 --> -0.237018).  Saving model ...
Epoch: 3 cost time: 0.4111948013305664
Epoch: 3, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.883 Vali Acc: 0.241 Test Loss: 1.883 Test Acc: 0.241
Validation loss decreased (-0.237018 --> -0.240722).  Saving model ...
Epoch: 4 cost time: 0.5292432308197021
Epoch: 4, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.860 Vali Acc: 0.241 Test Loss: 1.860 Test Acc: 0.241
Validation loss decreased (-0.240722 --> -0.240722).  Saving model ...
Epoch: 5 cost time: 0.43477511405944824
Epoch: 5, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.837 Vali Acc: 0.241 Test Loss: 1.837 Test Acc: 0.241
Validation loss decreased (-0.240722 --> -0.240722).  Saving model ...
Epoch: 6 cost time: 0.39955925941467285
Epoch: 6, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.813 Vali Acc: 0.237 Test Loss: 1.813 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.46455836296081543
Epoch: 7, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.788 Vali Acc: 0.248 Test Loss: 1.788 Test Acc: 0.248
Validation loss decreased (-0.240722 --> -0.248130).  Saving model ...
Epoch: 8 cost time: 0.4882843494415283
Epoch: 8, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.762 Vali Acc: 0.244 Test Loss: 1.762 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5257024765014648
Epoch: 9, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.734 Vali Acc: 0.256 Test Loss: 1.734 Test Acc: 0.256
Validation loss decreased (-0.248130 --> -0.255538).  Saving model ...
Epoch: 10 cost time: 0.5134458541870117
Epoch: 10, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.705 Vali Acc: 0.263 Test Loss: 1.705 Test Acc: 0.263
Validation loss decreased (-0.255538 --> -0.262946).  Saving model ...
Epoch: 11 cost time: 0.4696948528289795
Epoch: 11, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.676 Vali Acc: 0.285 Test Loss: 1.676 Test Acc: 0.285
Validation loss decreased (-0.262946 --> -0.285168).  Saving model ...
Epoch: 12 cost time: 0.4602055549621582
Epoch: 12, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.645 Vali Acc: 0.296 Test Loss: 1.645 Test Acc: 0.296
Validation loss decreased (-0.285168 --> -0.296280).  Saving model ...
Epoch: 13 cost time: 0.5174100399017334
Epoch: 13, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.614 Vali Acc: 0.307 Test Loss: 1.614 Test Acc: 0.307
Validation loss decreased (-0.296280 --> -0.307391).  Saving model ...
Epoch: 14 cost time: 0.5552821159362793
Epoch: 14, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.582 Vali Acc: 0.337 Test Loss: 1.582 Test Acc: 0.337
Validation loss decreased (-0.307391 --> -0.337021).  Saving model ...
Epoch: 15 cost time: 0.4873671531677246
Epoch: 15, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.549 Vali Acc: 0.381 Test Loss: 1.549 Test Acc: 0.381
Validation loss decreased (-0.337021 --> -0.381466).  Saving model ...
Epoch: 16 cost time: 0.4283418655395508
Epoch: 16, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.516 Vali Acc: 0.407 Test Loss: 1.516 Test Acc: 0.407
Validation loss decreased (-0.381466 --> -0.407392).  Saving model ...
Epoch: 17 cost time: 0.45114564895629883
Epoch: 17, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.484 Vali Acc: 0.459 Test Loss: 1.484 Test Acc: 0.459
Validation loss decreased (-0.407392 --> -0.459244).  Saving model ...
Epoch: 18 cost time: 0.4800748825073242
Epoch: 18, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.450 Vali Acc: 0.478 Test Loss: 1.450 Test Acc: 0.478
Validation loss decreased (-0.459244 --> -0.477763).  Saving model ...
Epoch: 19 cost time: 0.5215938091278076
Epoch: 19, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.417 Vali Acc: 0.541 Test Loss: 1.417 Test Acc: 0.541
Validation loss decreased (-0.477763 --> -0.540727).  Saving model ...
Epoch: 20 cost time: 0.4983546733856201
Epoch: 20, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.382 Vali Acc: 0.574 Test Loss: 1.382 Test Acc: 0.574
Validation loss decreased (-0.540727 --> -0.574060).  Saving model ...
Epoch: 21 cost time: 0.43852806091308594
Epoch: 21, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.348 Vali Acc: 0.615 Test Loss: 1.348 Test Acc: 0.615
Validation loss decreased (-0.574060 --> -0.614801).  Saving model ...
Epoch: 22 cost time: 0.461106538772583
Epoch: 22, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.314 Vali Acc: 0.648 Test Loss: 1.314 Test Acc: 0.648
Validation loss decreased (-0.614801 --> -0.648135).  Saving model ...
Epoch: 23 cost time: 0.5222644805908203
Epoch: 23, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.279 Vali Acc: 0.685 Test Loss: 1.279 Test Acc: 0.685
Validation loss decreased (-0.648135 --> -0.685172).  Saving model ...
Epoch: 24 cost time: 0.43903517723083496
Epoch: 24, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.245 Vali Acc: 0.722 Test Loss: 1.245 Test Acc: 0.722
Validation loss decreased (-0.685172 --> -0.722210).  Saving model ...
Epoch: 25 cost time: 0.5025217533111572
Epoch: 25, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.212 Vali Acc: 0.756 Test Loss: 1.212 Test Acc: 0.756
Validation loss decreased (-0.722210 --> -0.755543).  Saving model ...
Epoch: 26 cost time: 0.4447143077850342
Epoch: 26, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.176 Vali Acc: 0.778 Test Loss: 1.176 Test Acc: 0.778
Validation loss decreased (-0.755543 --> -0.777766).  Saving model ...
Epoch: 27 cost time: 0.4902942180633545
Epoch: 27, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.142 Vali Acc: 0.796 Test Loss: 1.142 Test Acc: 0.796
Validation loss decreased (-0.777766 --> -0.796285).  Saving model ...
Epoch: 28 cost time: 0.504666805267334
Epoch: 28, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.109 Vali Acc: 0.822 Test Loss: 1.109 Test Acc: 0.822
Validation loss decreased (-0.796285 --> -0.822211).  Saving model ...
Epoch: 29 cost time: 0.5236613750457764
Epoch: 29, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.076 Vali Acc: 0.856 Test Loss: 1.076 Test Acc: 0.856
Validation loss decreased (-0.822211 --> -0.855545).  Saving model ...
Epoch: 30 cost time: 0.5394852161407471
Epoch: 30, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.042 Vali Acc: 0.856 Test Loss: 1.042 Test Acc: 0.856
Validation loss decreased (-0.855545 --> -0.855545).  Saving model ...
Epoch: 31 cost time: 0.548093318939209
Epoch: 31, Steps: 2 | Train Loss: 0.881 Vali Loss: 1.010 Vali Acc: 0.867 Test Loss: 1.010 Test Acc: 0.867
Validation loss decreased (-0.855545 --> -0.866657).  Saving model ...
Epoch: 32 cost time: 0.5894429683685303
Epoch: 32, Steps: 2 | Train Loss: 1.039 Vali Loss: 0.978 Vali Acc: 0.870 Test Loss: 0.978 Test Acc: 0.870
Validation loss decreased (-0.866657 --> -0.870361).  Saving model ...
Epoch: 33 cost time: 0.5731508731842041
Epoch: 33, Steps: 2 | Train Loss: 0.952 Vali Loss: 0.947 Vali Acc: 0.881 Test Loss: 0.947 Test Acc: 0.881
Validation loss decreased (-0.870361 --> -0.881472).  Saving model ...
Epoch: 34 cost time: 0.4890713691711426
Epoch: 34, Steps: 2 | Train Loss: 0.928 Vali Loss: 0.916 Vali Acc: 0.885 Test Loss: 0.916 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 35 cost time: 0.5004594326019287
Epoch: 35, Steps: 2 | Train Loss: 0.852 Vali Loss: 0.886 Vali Acc: 0.889 Test Loss: 0.886 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888880).  Saving model ...
Epoch: 36 cost time: 0.466113805770874
Epoch: 36, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.858 Vali Acc: 0.904 Test Loss: 0.858 Test Acc: 0.904
Validation loss decreased (-0.888880 --> -0.903695).  Saving model ...
Epoch: 37 cost time: 0.49502086639404297
Epoch: 37, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.829 Vali Acc: 0.907 Test Loss: 0.829 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907399).  Saving model ...
Epoch: 38 cost time: 0.5172469615936279
Epoch: 38, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.801 Vali Acc: 0.911 Test Loss: 0.801 Test Acc: 0.911
Validation loss decreased (-0.907399 --> -0.911103).  Saving model ...
Epoch: 39 cost time: 0.537273645401001
Epoch: 39, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.775 Vali Acc: 0.911 Test Loss: 0.775 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911103).  Saving model ...
Epoch: 40 cost time: 0.48480653762817383
Epoch: 40, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.749 Vali Acc: 0.911 Test Loss: 0.749 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911104).  Saving model ...
Epoch: 41 cost time: 0.5347175598144531
Epoch: 41, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.725 Vali Acc: 0.922 Test Loss: 0.725 Test Acc: 0.922
Validation loss decreased (-0.911104 --> -0.922215).  Saving model ...
Epoch: 42 cost time: 0.5763678550720215
Epoch: 42, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.703 Vali Acc: 0.930 Test Loss: 0.703 Test Acc: 0.930
Validation loss decreased (-0.922215 --> -0.929623).  Saving model ...
Epoch: 43 cost time: 0.5940971374511719
Epoch: 43, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.682 Vali Acc: 0.930 Test Loss: 0.682 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 44 cost time: 0.6891443729400635
Epoch: 44, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.661 Vali Acc: 0.933 Test Loss: 0.661 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 45 cost time: 0.5177297592163086
Epoch: 45, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.641 Vali Acc: 0.937 Test Loss: 0.641 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 46 cost time: 0.5131351947784424
Epoch: 46, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.624 Vali Acc: 0.941 Test Loss: 0.624 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 47 cost time: 0.6026315689086914
Epoch: 47, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.606 Vali Acc: 0.941 Test Loss: 0.606 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940735).  Saving model ...
Epoch: 48 cost time: 0.4792141914367676
Epoch: 48, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.590 Vali Acc: 0.941 Test Loss: 0.590 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940735).  Saving model ...
Epoch: 49 cost time: 0.5343549251556396
Epoch: 49, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.575 Vali Acc: 0.944 Test Loss: 0.575 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 50 cost time: 0.5142242908477783
Epoch: 50, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.560 Vali Acc: 0.944 Test Loss: 0.560 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 51 cost time: 0.6256392002105713
Epoch: 51, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.546 Vali Acc: 0.944 Test Loss: 0.546 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 52 cost time: 0.5521895885467529
Epoch: 52, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.533 Vali Acc: 0.944 Test Loss: 0.533 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 53 cost time: 0.6826229095458984
Epoch: 53, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.521 Vali Acc: 0.944 Test Loss: 0.521 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 54 cost time: 0.4960806369781494
Epoch: 54, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.510 Vali Acc: 0.944 Test Loss: 0.510 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 55 cost time: 0.6596744060516357
Epoch: 55, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.500 Vali Acc: 0.944 Test Loss: 0.500 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 56 cost time: 0.5076594352722168
Epoch: 56, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.490 Vali Acc: 0.944 Test Loss: 0.490 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 57 cost time: 0.5202138423919678
Epoch: 57, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.480 Vali Acc: 0.948 Test Loss: 0.480 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948143).  Saving model ...
Epoch: 58 cost time: 0.5222384929656982
Epoch: 58, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.472 Vali Acc: 0.948 Test Loss: 0.472 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 59 cost time: 0.5308363437652588
Epoch: 59, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.462 Vali Acc: 0.948 Test Loss: 0.462 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 60 cost time: 0.5426108837127686
Epoch: 60, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.454 Vali Acc: 0.948 Test Loss: 0.454 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 61 cost time: 0.5142514705657959
Epoch: 61, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.445 Vali Acc: 0.948 Test Loss: 0.445 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 62 cost time: 0.587017297744751
Epoch: 62, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.437 Vali Acc: 0.948 Test Loss: 0.437 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 63 cost time: 0.4982171058654785
Epoch: 63, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.428 Vali Acc: 0.948 Test Loss: 0.428 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 64 cost time: 0.4726731777191162
Epoch: 64, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.420 Vali Acc: 0.948 Test Loss: 0.420 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 65 cost time: 0.5163083076477051
Epoch: 65, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.413 Vali Acc: 0.948 Test Loss: 0.413 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 66 cost time: 0.5752778053283691
Epoch: 66, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.405 Vali Acc: 0.948 Test Loss: 0.405 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 67 cost time: 0.5582685470581055
Epoch: 67, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.398 Vali Acc: 0.944 Test Loss: 0.398 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.5127582550048828
Epoch: 68, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.391 Vali Acc: 0.944 Test Loss: 0.391 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7064313888549805
Epoch: 69, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.385 Vali Acc: 0.948 Test Loss: 0.385 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 70 cost time: 0.6418287754058838
Epoch: 70, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.379 Vali Acc: 0.948 Test Loss: 0.379 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 71 cost time: 0.5332293510437012
Epoch: 71, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.373 Vali Acc: 0.948 Test Loss: 0.373 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 72 cost time: 0.5157361030578613
Epoch: 72, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.368 Vali Acc: 0.952 Test Loss: 0.368 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 73 cost time: 0.538217306137085
Epoch: 73, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.363 Vali Acc: 0.952 Test Loss: 0.363 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 74 cost time: 0.6331338882446289
Epoch: 74, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.359 Vali Acc: 0.952 Test Loss: 0.359 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 75 cost time: 0.512030839920044
Epoch: 75, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.354 Vali Acc: 0.952 Test Loss: 0.354 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 76 cost time: 0.4599430561065674
Epoch: 76, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.350 Vali Acc: 0.952 Test Loss: 0.350 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 77 cost time: 0.5421164035797119
Epoch: 77, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.345 Vali Acc: 0.952 Test Loss: 0.345 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 78 cost time: 0.48607945442199707
Epoch: 78, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.341 Vali Acc: 0.956 Test Loss: 0.341 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 79 cost time: 0.5549428462982178
Epoch: 79, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.337 Vali Acc: 0.956 Test Loss: 0.337 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 80 cost time: 0.6114907264709473
Epoch: 80, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.333 Vali Acc: 0.956 Test Loss: 0.333 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 81 cost time: 0.6002790927886963
Epoch: 81, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.330 Vali Acc: 0.956 Test Loss: 0.330 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 82 cost time: 0.556614875793457
Epoch: 82, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.326 Vali Acc: 0.956 Test Loss: 0.326 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 83 cost time: 0.5893123149871826
Epoch: 83, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.322 Vali Acc: 0.956 Test Loss: 0.322 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 84 cost time: 0.47068190574645996
Epoch: 84, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.319 Vali Acc: 0.956 Test Loss: 0.319 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 85 cost time: 0.4436209201812744
Epoch: 85, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.315 Vali Acc: 0.956 Test Loss: 0.315 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 86 cost time: 0.5222434997558594
Epoch: 86, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.312 Vali Acc: 0.956 Test Loss: 0.312 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 87 cost time: 0.520749568939209
Epoch: 87, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.309 Vali Acc: 0.952 Test Loss: 0.309 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.6699540615081787
Epoch: 88, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.307 Vali Acc: 0.952 Test Loss: 0.307 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.5689578056335449
Epoch: 89, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.304 Vali Acc: 0.952 Test Loss: 0.304 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.4859325885772705
Epoch: 90, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.301 Vali Acc: 0.952 Test Loss: 0.301 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.6878418922424316
Epoch: 91, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.299 Vali Acc: 0.952 Test Loss: 0.299 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 0.6468031406402588
Epoch: 92, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.296 Vali Acc: 0.952 Test Loss: 0.296 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 0.5097267627716064
Epoch: 93, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.293 Vali Acc: 0.956 Test Loss: 0.293 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 94 cost time: 0.503328800201416
Epoch: 94, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.290 Vali Acc: 0.956 Test Loss: 0.290 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 95 cost time: 0.5233566761016846
Epoch: 95, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.287 Vali Acc: 0.956 Test Loss: 0.287 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 96 cost time: 0.5343465805053711
Epoch: 96, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.284 Vali Acc: 0.952 Test Loss: 0.284 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.54121994972229
Epoch: 97, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.281 Vali Acc: 0.952 Test Loss: 0.281 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.5266201496124268
Epoch: 98, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.279 Vali Acc: 0.952 Test Loss: 0.279 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.4417765140533447
Epoch: 99, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.277 Vali Acc: 0.952 Test Loss: 0.277 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.4947209358215332
Epoch: 100, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.274 Vali Acc: 0.952 Test Loss: 0.274 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 13782
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.298959493637085
Epoch: 1, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.767 Vali Acc: 0.174 Test Loss: 1.767 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.6302492618560791
Epoch: 2, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.703 Vali Acc: 0.204 Test Loss: 1.703 Test Acc: 0.204
Validation loss decreased (-0.174056 --> -0.203687).  Saving model ...
Epoch: 3 cost time: 0.5865938663482666
Epoch: 3, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.646 Vali Acc: 0.259 Test Loss: 1.646 Test Acc: 0.259
Validation loss decreased (-0.203687 --> -0.259243).  Saving model ...
Epoch: 4 cost time: 0.6025750637054443
Epoch: 4, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.579 Vali Acc: 0.400 Test Loss: 1.579 Test Acc: 0.400
Validation loss decreased (-0.259243 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 0.5216474533081055
Epoch: 5, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.497 Vali Acc: 0.533 Test Loss: 1.497 Test Acc: 0.533
Validation loss decreased (-0.399984 --> -0.533318).  Saving model ...
Epoch: 6 cost time: 0.5004851818084717
Epoch: 6, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.406 Vali Acc: 0.656 Test Loss: 1.406 Test Acc: 0.656
Validation loss decreased (-0.533318 --> -0.655541).  Saving model ...
Epoch: 7 cost time: 0.5258970260620117
Epoch: 7, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.308 Vali Acc: 0.719 Test Loss: 1.308 Test Acc: 0.719
Validation loss decreased (-0.655541 --> -0.718505).  Saving model ...
Epoch: 8 cost time: 0.5676660537719727
Epoch: 8, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.209 Vali Acc: 0.759 Test Loss: 1.209 Test Acc: 0.759
Validation loss decreased (-0.718505 --> -0.759247).  Saving model ...
Epoch: 9 cost time: 0.4705545902252197
Epoch: 9, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.112 Vali Acc: 0.800 Test Loss: 1.112 Test Acc: 0.800
Validation loss decreased (-0.759247 --> -0.799989).  Saving model ...
Epoch: 10 cost time: 0.5213761329650879
Epoch: 10, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.018 Vali Acc: 0.811 Test Loss: 1.018 Test Acc: 0.811
Validation loss decreased (-0.799989 --> -0.811101).  Saving model ...
Epoch: 11 cost time: 0.5173165798187256
Epoch: 11, Steps: 2 | Train Loss: 0.947 Vali Loss: 0.931 Vali Acc: 0.826 Test Loss: 0.931 Test Acc: 0.826
Validation loss decreased (-0.811101 --> -0.825917).  Saving model ...
Epoch: 12 cost time: 0.5549936294555664
Epoch: 12, Steps: 2 | Train Loss: 0.845 Vali Loss: 0.850 Vali Acc: 0.844 Test Loss: 0.850 Test Acc: 0.844
Validation loss decreased (-0.825917 --> -0.844436).  Saving model ...
Epoch: 13 cost time: 0.5214343070983887
Epoch: 13, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.774 Vali Acc: 0.856 Test Loss: 0.774 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855548).  Saving model ...
Epoch: 14 cost time: 0.48378896713256836
Epoch: 14, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.706 Vali Acc: 0.870 Test Loss: 0.706 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870363).  Saving model ...
Epoch: 15 cost time: 0.4800412654876709
Epoch: 15, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.640 Vali Acc: 0.885 Test Loss: 0.640 Test Acc: 0.885
Validation loss decreased (-0.870363 --> -0.885179).  Saving model ...
Epoch: 16 cost time: 0.5653479099273682
Epoch: 16, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.583 Vali Acc: 0.900 Test Loss: 0.583 Test Acc: 0.900
Validation loss decreased (-0.885179 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.5793821811676025
Epoch: 17, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.529 Vali Acc: 0.919 Test Loss: 0.529 Test Acc: 0.919
Validation loss decreased (-0.899994 --> -0.918513).  Saving model ...
Epoch: 18 cost time: 0.5435988903045654
Epoch: 18, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.485 Vali Acc: 0.926 Test Loss: 0.485 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 19 cost time: 0.44573450088500977
Epoch: 19, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.446 Vali Acc: 0.933 Test Loss: 0.446 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 20 cost time: 0.4768233299255371
Epoch: 20, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.412 Vali Acc: 0.930 Test Loss: 0.412 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5462760925292969
Epoch: 21, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.382 Vali Acc: 0.930 Test Loss: 0.382 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4961740970611572
Epoch: 22, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 23 cost time: 0.566171407699585
Epoch: 23, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.330 Vali Acc: 0.944 Test Loss: 0.330 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944441).  Saving model ...
Epoch: 24 cost time: 0.44296884536743164
Epoch: 24, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.308 Vali Acc: 0.941 Test Loss: 0.308 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6228969097137451
Epoch: 25, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5559582710266113
Epoch: 26, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5506618022918701
Epoch: 27, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.569166898727417
Epoch: 28, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5671238899230957
Epoch: 29, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5154948234558105
Epoch: 30, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5984814167022705
Epoch: 31, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5615906715393066
Epoch: 32, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5197441577911377
Epoch: 33, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.48777270317077637
Epoch: 34, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4920787811279297
Epoch: 35, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 31590
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.125533103942871
Epoch: 1, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.729 Vali Acc: 0.333 Test Loss: 1.729 Test Acc: 0.333
Validation loss decreased (inf --> -0.333316).  Saving model ...
Epoch: 2 cost time: 0.5616872310638428
Epoch: 2, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.680 Vali Acc: 0.337 Test Loss: 1.680 Test Acc: 0.337
Validation loss decreased (-0.333316 --> -0.337020).  Saving model ...
Epoch: 3 cost time: 0.572028636932373
Epoch: 3, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.639 Vali Acc: 0.352 Test Loss: 1.639 Test Acc: 0.352
Validation loss decreased (-0.337020 --> -0.351835).  Saving model ...
Epoch: 4 cost time: 0.5429368019104004
Epoch: 4, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.602 Vali Acc: 0.367 Test Loss: 1.602 Test Acc: 0.367
Validation loss decreased (-0.351835 --> -0.366651).  Saving model ...
Epoch: 5 cost time: 0.587846040725708
Epoch: 5, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.560 Vali Acc: 0.378 Test Loss: 1.560 Test Acc: 0.378
Validation loss decreased (-0.366651 --> -0.377762).  Saving model ...
Epoch: 6 cost time: 0.6569714546203613
Epoch: 6, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.513 Vali Acc: 0.396 Test Loss: 1.513 Test Acc: 0.396
Validation loss decreased (-0.377762 --> -0.396281).  Saving model ...
Epoch: 7 cost time: 0.5932807922363281
Epoch: 7, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.462 Vali Acc: 0.415 Test Loss: 1.462 Test Acc: 0.415
Validation loss decreased (-0.396281 --> -0.414800).  Saving model ...
Epoch: 8 cost time: 0.5606381893157959
Epoch: 8, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.408 Vali Acc: 0.444 Test Loss: 1.408 Test Acc: 0.444
Validation loss decreased (-0.414800 --> -0.444430).  Saving model ...
Epoch: 9 cost time: 0.5784626007080078
Epoch: 9, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.352 Vali Acc: 0.489 Test Loss: 1.352 Test Acc: 0.489
Validation loss decreased (-0.444430 --> -0.488875).  Saving model ...
Epoch: 10 cost time: 0.5951123237609863
Epoch: 10, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.295 Vali Acc: 0.519 Test Loss: 1.295 Test Acc: 0.519
Validation loss decreased (-0.488875 --> -0.518506).  Saving model ...
Epoch: 11 cost time: 0.567730188369751
Epoch: 11, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.238 Vali Acc: 0.556 Test Loss: 1.238 Test Acc: 0.556
Validation loss decreased (-0.518506 --> -0.555543).  Saving model ...
Epoch: 12 cost time: 0.5356216430664062
Epoch: 12, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.181 Vali Acc: 0.622 Test Loss: 1.181 Test Acc: 0.622
Validation loss decreased (-0.555543 --> -0.622210).  Saving model ...
Epoch: 13 cost time: 0.5507757663726807
Epoch: 13, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.123 Vali Acc: 0.696 Test Loss: 1.123 Test Acc: 0.696
Validation loss decreased (-0.622210 --> -0.696285).  Saving model ...
Epoch: 14 cost time: 0.61114501953125
Epoch: 14, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.065 Vali Acc: 0.748 Test Loss: 1.065 Test Acc: 0.748
Validation loss decreased (-0.696285 --> -0.748137).  Saving model ...
Epoch: 15 cost time: 0.5019466876983643
Epoch: 15, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.009 Vali Acc: 0.774 Test Loss: 1.009 Test Acc: 0.774
Validation loss decreased (-0.748137 --> -0.774064).  Saving model ...
Epoch: 16 cost time: 0.5355410575866699
Epoch: 16, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.954 Vali Acc: 0.800 Test Loss: 0.954 Test Acc: 0.800
Validation loss decreased (-0.774064 --> -0.799990).  Saving model ...
Epoch: 17 cost time: 0.5580167770385742
Epoch: 17, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.903 Vali Acc: 0.826 Test Loss: 0.903 Test Acc: 0.826
Validation loss decreased (-0.799990 --> -0.825917).  Saving model ...
Epoch: 18 cost time: 0.55934739112854
Epoch: 18, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.852 Vali Acc: 0.841 Test Loss: 0.852 Test Acc: 0.841
Validation loss decreased (-0.825917 --> -0.840732).  Saving model ...
Epoch: 19 cost time: 0.5840590000152588
Epoch: 19, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.804 Vali Acc: 0.852 Test Loss: 0.804 Test Acc: 0.852
Validation loss decreased (-0.840732 --> -0.851844).  Saving model ...
Epoch: 20 cost time: 0.6551079750061035
Epoch: 20, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.759 Vali Acc: 0.870 Test Loss: 0.759 Test Acc: 0.870
Validation loss decreased (-0.851844 --> -0.870363).  Saving model ...
Epoch: 21 cost time: 0.5486307144165039
Epoch: 21, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.717 Vali Acc: 0.878 Test Loss: 0.717 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 22 cost time: 0.5491399765014648
Epoch: 22, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.678 Vali Acc: 0.881 Test Loss: 0.678 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 23 cost time: 0.5851569175720215
Epoch: 23, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.640 Vali Acc: 0.889 Test Loss: 0.640 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888882).  Saving model ...
Epoch: 24 cost time: 0.48424339294433594
Epoch: 24, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.605 Vali Acc: 0.896 Test Loss: 0.605 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 25 cost time: 0.6166067123413086
Epoch: 25, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.573 Vali Acc: 0.907 Test Loss: 0.573 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907402).  Saving model ...
Epoch: 26 cost time: 0.585627555847168
Epoch: 26, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.541 Vali Acc: 0.915 Test Loss: 0.541 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914809).  Saving model ...
Epoch: 27 cost time: 0.6444027423858643
Epoch: 27, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.511 Vali Acc: 0.919 Test Loss: 0.511 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 28 cost time: 0.575289249420166
Epoch: 28, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.484 Vali Acc: 0.922 Test Loss: 0.484 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 29 cost time: 0.6030664443969727
Epoch: 29, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.458 Vali Acc: 0.926 Test Loss: 0.458 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 30 cost time: 0.5357682704925537
Epoch: 30, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.432 Vali Acc: 0.926 Test Loss: 0.432 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 31 cost time: 0.5046052932739258
Epoch: 31, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.409 Vali Acc: 0.930 Test Loss: 0.409 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 32 cost time: 0.5620095729827881
Epoch: 32, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.388 Vali Acc: 0.933 Test Loss: 0.388 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933329).  Saving model ...
Epoch: 33 cost time: 0.6088793277740479
Epoch: 33, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.369 Vali Acc: 0.933 Test Loss: 0.369 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 34 cost time: 0.657015323638916
Epoch: 34, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.351 Vali Acc: 0.933 Test Loss: 0.351 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 35 cost time: 0.599233865737915
Epoch: 35, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.336 Vali Acc: 0.937 Test Loss: 0.336 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 36 cost time: 0.6162288188934326
Epoch: 36, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.323 Vali Acc: 0.937 Test Loss: 0.323 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 37 cost time: 0.6237998008728027
Epoch: 37, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.313 Vali Acc: 0.933 Test Loss: 0.313 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5872244834899902
Epoch: 38, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.303 Vali Acc: 0.926 Test Loss: 0.303 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.55124831199646
Epoch: 39, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6063084602355957
Epoch: 40, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5954902172088623
Epoch: 41, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.592771053314209
Epoch: 42, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5627374649047852
Epoch: 43, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5441582202911377
Epoch: 44, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.6145026683807373
Epoch: 45, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5699126720428467
Epoch: 46, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 18950
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1798200607299805
Epoch: 1, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.936 Vali Acc: 0.185 Test Loss: 1.936 Test Acc: 0.185
Validation loss decreased (inf --> -0.185166).  Saving model ...
Epoch: 2 cost time: 0.5603668689727783
Epoch: 2, Steps: 2 | Train Loss: 1.894 Vali Loss: 1.897 Vali Acc: 0.193 Test Loss: 1.897 Test Acc: 0.193
Validation loss decreased (-0.185166 --> -0.192574).  Saving model ...
Epoch: 3 cost time: 0.5940585136413574
Epoch: 3, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.866 Vali Acc: 0.207 Test Loss: 1.866 Test Acc: 0.207
Validation loss decreased (-0.192574 --> -0.207389).  Saving model ...
Epoch: 4 cost time: 0.6257245540618896
Epoch: 4, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.839 Vali Acc: 0.207 Test Loss: 1.839 Test Acc: 0.207
Validation loss decreased (-0.207389 --> -0.207389).  Saving model ...
Epoch: 5 cost time: 0.5263268947601318
Epoch: 5, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.803 Vali Acc: 0.215 Test Loss: 1.803 Test Acc: 0.215
Validation loss decreased (-0.207389 --> -0.214797).  Saving model ...
Epoch: 6 cost time: 0.5777037143707275
Epoch: 6, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.760 Vali Acc: 0.233 Test Loss: 1.760 Test Acc: 0.233
Validation loss decreased (-0.214797 --> -0.233316).  Saving model ...
Epoch: 7 cost time: 0.5160460472106934
Epoch: 7, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.711 Vali Acc: 0.263 Test Loss: 1.711 Test Acc: 0.263
Validation loss decreased (-0.233316 --> -0.262946).  Saving model ...
Epoch: 8 cost time: 0.5899372100830078
Epoch: 8, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.658 Vali Acc: 0.278 Test Loss: 1.658 Test Acc: 0.278
Validation loss decreased (-0.262946 --> -0.277761).  Saving model ...
Epoch: 9 cost time: 0.4655940532684326
Epoch: 9, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.602 Vali Acc: 0.315 Test Loss: 1.602 Test Acc: 0.315
Validation loss decreased (-0.277761 --> -0.314799).  Saving model ...
Epoch: 10 cost time: 0.5338306427001953
Epoch: 10, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.543 Vali Acc: 0.337 Test Loss: 1.543 Test Acc: 0.337
Validation loss decreased (-0.314799 --> -0.337022).  Saving model ...
Epoch: 11 cost time: 0.5725524425506592
Epoch: 11, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.482 Vali Acc: 0.370 Test Loss: 1.482 Test Acc: 0.370
Validation loss decreased (-0.337022 --> -0.370356).  Saving model ...
Epoch: 12 cost time: 0.6177530288696289
Epoch: 12, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.420 Vali Acc: 0.407 Test Loss: 1.420 Test Acc: 0.407
Validation loss decreased (-0.370356 --> -0.407393).  Saving model ...
Epoch: 13 cost time: 0.5573000907897949
Epoch: 13, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.357 Vali Acc: 0.467 Test Loss: 1.357 Test Acc: 0.467
Validation loss decreased (-0.407393 --> -0.466653).  Saving model ...
Epoch: 14 cost time: 0.5678074359893799
Epoch: 14, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.295 Vali Acc: 0.507 Test Loss: 1.295 Test Acc: 0.507
Validation loss decreased (-0.466653 --> -0.507394).  Saving model ...
Epoch: 15 cost time: 0.589331865310669
Epoch: 15, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.235 Vali Acc: 0.548 Test Loss: 1.235 Test Acc: 0.548
Validation loss decreased (-0.507394 --> -0.548136).  Saving model ...
Epoch: 16 cost time: 0.5766434669494629
Epoch: 16, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.176 Vali Acc: 0.589 Test Loss: 1.176 Test Acc: 0.589
Validation loss decreased (-0.548136 --> -0.588877).  Saving model ...
Epoch: 17 cost time: 0.5400068759918213
Epoch: 17, Steps: 2 | Train Loss: 0.924 Vali Loss: 1.119 Vali Acc: 0.615 Test Loss: 1.119 Test Acc: 0.615
Validation loss decreased (-0.588877 --> -0.614804).  Saving model ...
Epoch: 18 cost time: 0.6615774631500244
Epoch: 18, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.065 Vali Acc: 0.641 Test Loss: 1.065 Test Acc: 0.641
Validation loss decreased (-0.614804 --> -0.640730).  Saving model ...
Epoch: 19 cost time: 0.6587052345275879
Epoch: 19, Steps: 2 | Train Loss: 0.873 Vali Loss: 1.012 Vali Acc: 0.670 Test Loss: 1.012 Test Acc: 0.670
Validation loss decreased (-0.640730 --> -0.670360).  Saving model ...
Epoch: 20 cost time: 0.590057373046875
Epoch: 20, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.960 Vali Acc: 0.707 Test Loss: 0.960 Test Acc: 0.707
Validation loss decreased (-0.670360 --> -0.707398).  Saving model ...
Epoch: 21 cost time: 0.5119190216064453
Epoch: 21, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.912 Vali Acc: 0.726 Test Loss: 0.912 Test Acc: 0.726
Validation loss decreased (-0.707398 --> -0.725917).  Saving model ...
Epoch: 22 cost time: 0.5497269630432129
Epoch: 22, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.866 Vali Acc: 0.748 Test Loss: 0.866 Test Acc: 0.748
Validation loss decreased (-0.725917 --> -0.748139).  Saving model ...
Epoch: 23 cost time: 0.6096405982971191
Epoch: 23, Steps: 2 | Train Loss: 0.742 Vali Loss: 0.821 Vali Acc: 0.778 Test Loss: 0.821 Test Acc: 0.778
Validation loss decreased (-0.748139 --> -0.777770).  Saving model ...
Epoch: 24 cost time: 0.5686399936676025
Epoch: 24, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 0.546471118927002
Epoch: 25, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.740 Vali Acc: 0.826 Test Loss: 0.740 Test Acc: 0.826
Validation loss decreased (-0.799992 --> -0.825919).  Saving model ...
Epoch: 26 cost time: 0.5496826171875
Epoch: 26, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.703 Vali Acc: 0.841 Test Loss: 0.703 Test Acc: 0.841
Validation loss decreased (-0.825919 --> -0.840734).  Saving model ...
Epoch: 27 cost time: 0.6773903369903564
Epoch: 27, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
Validation loss decreased (-0.840734 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 0.5417177677154541
Epoch: 28, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.637 Vali Acc: 0.852 Test Loss: 0.637 Test Acc: 0.852
Validation loss decreased (-0.844438 --> -0.851845).  Saving model ...
Epoch: 29 cost time: 0.5368556976318359
Epoch: 29, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
Validation loss decreased (-0.851845 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 0.5917186737060547
Epoch: 30, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.579 Vali Acc: 0.870 Test Loss: 0.579 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.870365).  Saving model ...
Epoch: 31 cost time: 0.5316298007965088
Epoch: 31, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.552 Vali Acc: 0.881 Test Loss: 0.552 Test Acc: 0.881
Validation loss decreased (-0.870365 --> -0.881476).  Saving model ...
Epoch: 32 cost time: 0.6165635585784912
Epoch: 32, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.526 Vali Acc: 0.889 Test Loss: 0.526 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 33 cost time: 0.5840768814086914
Epoch: 33, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.502 Vali Acc: 0.904 Test Loss: 0.502 Test Acc: 0.904
Validation loss decreased (-0.888884 --> -0.903699).  Saving model ...
Epoch: 34 cost time: 0.5995039939880371
Epoch: 34, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.479 Vali Acc: 0.907 Test Loss: 0.479 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 35 cost time: 0.5343422889709473
Epoch: 35, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.458 Vali Acc: 0.907 Test Loss: 0.458 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 36 cost time: 0.5746941566467285
Epoch: 36, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.439 Vali Acc: 0.911 Test Loss: 0.439 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 37 cost time: 0.560373067855835
Epoch: 37, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.423 Vali Acc: 0.911 Test Loss: 0.423 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 38 cost time: 0.5514492988586426
Epoch: 38, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.407 Vali Acc: 0.911 Test Loss: 0.407 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 39 cost time: 0.5063080787658691
Epoch: 39, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.391 Vali Acc: 0.911 Test Loss: 0.391 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 40 cost time: 0.6731221675872803
Epoch: 40, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.378 Vali Acc: 0.915 Test Loss: 0.378 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 41 cost time: 0.6367604732513428
Epoch: 41, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.366 Vali Acc: 0.915 Test Loss: 0.366 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 42 cost time: 0.6103992462158203
Epoch: 42, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.354 Vali Acc: 0.915 Test Loss: 0.354 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 43 cost time: 0.5356886386871338
Epoch: 43, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.345 Vali Acc: 0.919 Test Loss: 0.345 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 44 cost time: 0.6603248119354248
Epoch: 44, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.336 Vali Acc: 0.919 Test Loss: 0.336 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 45 cost time: 0.4926912784576416
Epoch: 45, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.328 Vali Acc: 0.919 Test Loss: 0.328 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 46 cost time: 0.5256330966949463
Epoch: 46, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.321 Vali Acc: 0.919 Test Loss: 0.321 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 47 cost time: 0.6616125106811523
Epoch: 47, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 48 cost time: 0.5831518173217773
Epoch: 48, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 49 cost time: 0.5584681034088135
Epoch: 49, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.304 Vali Acc: 0.919 Test Loss: 0.304 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 50 cost time: 0.606250524520874
Epoch: 50, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.299 Vali Acc: 0.919 Test Loss: 0.299 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 51 cost time: 0.5524675846099854
Epoch: 51, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.295 Vali Acc: 0.919 Test Loss: 0.295 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 52 cost time: 0.5509986877441406
Epoch: 52, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 53 cost time: 0.5817873477935791
Epoch: 53, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922219).  Saving model ...
Epoch: 54 cost time: 0.8100903034210205
Epoch: 54, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 55 cost time: 0.5780260562896729
Epoch: 55, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 56 cost time: 0.5720946788787842
Epoch: 56, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 57 cost time: 0.6065464019775391
Epoch: 57, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 58 cost time: 0.7617497444152832
Epoch: 58, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 59 cost time: 0.5074691772460938
Epoch: 59, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 60 cost time: 0.5569744110107422
Epoch: 60, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.263 Vali Acc: 0.926 Test Loss: 0.263 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 61 cost time: 0.5514624118804932
Epoch: 61, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 62 cost time: 0.5298380851745605
Epoch: 62, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.258 Vali Acc: 0.926 Test Loss: 0.258 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 63 cost time: 0.7287924289703369
Epoch: 63, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 64 cost time: 0.6469850540161133
Epoch: 64, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 65 cost time: 0.6319277286529541
Epoch: 65, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 66 cost time: 0.5714797973632812
Epoch: 66, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 67 cost time: 0.5282442569732666
Epoch: 67, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 68 cost time: 0.5934219360351562
Epoch: 68, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 69 cost time: 0.5423309803009033
Epoch: 69, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6367630958557129
Epoch: 70, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6185314655303955
Epoch: 71, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.5603320598602295
Epoch: 72, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.485790491104126
Epoch: 73, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.5479028224945068
Epoch: 74, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.5546658039093018
Epoch: 75, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.5255742073059082
Epoch: 76, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.5595941543579102
Epoch: 77, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.6332135200500488
Epoch: 78, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 15126
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4785449504852295
Epoch: 1, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.869 Vali Acc: 0.181 Test Loss: 1.869 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.5442562103271484
Epoch: 2, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.834 Vali Acc: 0.181 Test Loss: 1.834 Test Acc: 0.181
Validation loss decreased (-0.181463 --> -0.181463).  Saving model ...
Epoch: 3 cost time: 0.5611832141876221
Epoch: 3, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.809 Vali Acc: 0.185 Test Loss: 1.809 Test Acc: 0.185
Validation loss decreased (-0.181463 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 0.4887816905975342
Epoch: 4, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.789 Vali Acc: 0.193 Test Loss: 1.789 Test Acc: 0.193
Validation loss decreased (-0.185167 --> -0.192575).  Saving model ...
Epoch: 5 cost time: 0.5439281463623047
Epoch: 5, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.764 Vali Acc: 0.196 Test Loss: 1.764 Test Acc: 0.196
Validation loss decreased (-0.192575 --> -0.196279).  Saving model ...
Epoch: 6 cost time: 0.5339512825012207
Epoch: 6, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.734 Vali Acc: 0.200 Test Loss: 1.734 Test Acc: 0.200
Validation loss decreased (-0.196279 --> -0.199983).  Saving model ...
Epoch: 7 cost time: 0.5189788341522217
Epoch: 7, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.701 Vali Acc: 0.226 Test Loss: 1.701 Test Acc: 0.226
Validation loss decreased (-0.199983 --> -0.225909).  Saving model ...
Epoch: 8 cost time: 0.5089921951293945
Epoch: 8, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.664 Vali Acc: 0.244 Test Loss: 1.664 Test Acc: 0.244
Validation loss decreased (-0.225909 --> -0.244428).  Saving model ...
Epoch: 9 cost time: 0.6784358024597168
Epoch: 9, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.623 Vali Acc: 0.289 Test Loss: 1.623 Test Acc: 0.289
Validation loss decreased (-0.244428 --> -0.288873).  Saving model ...
Epoch: 10 cost time: 0.6248557567596436
Epoch: 10, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.580 Vali Acc: 0.315 Test Loss: 1.580 Test Acc: 0.315
Validation loss decreased (-0.288873 --> -0.314799).  Saving model ...
Epoch: 11 cost time: 0.6141493320465088
Epoch: 11, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.535 Vali Acc: 0.370 Test Loss: 1.535 Test Acc: 0.370
Validation loss decreased (-0.314799 --> -0.370355).  Saving model ...
Epoch: 12 cost time: 0.7196686267852783
Epoch: 12, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.488 Vali Acc: 0.419 Test Loss: 1.488 Test Acc: 0.419
Validation loss decreased (-0.370355 --> -0.418504).  Saving model ...
Epoch: 13 cost time: 0.6235792636871338
Epoch: 13, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.439 Vali Acc: 0.467 Test Loss: 1.439 Test Acc: 0.467
Validation loss decreased (-0.418504 --> -0.466652).  Saving model ...
Epoch: 14 cost time: 0.4335596561431885
Epoch: 14, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.390 Vali Acc: 0.552 Test Loss: 1.390 Test Acc: 0.552
Validation loss decreased (-0.466652 --> -0.551838).  Saving model ...
Epoch: 15 cost time: 0.5457265377044678
Epoch: 15, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.340 Vali Acc: 0.615 Test Loss: 1.340 Test Acc: 0.615
Validation loss decreased (-0.551838 --> -0.614801).  Saving model ...
Epoch: 16 cost time: 0.527644157409668
Epoch: 16, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.290 Vali Acc: 0.644 Test Loss: 1.290 Test Acc: 0.644
Validation loss decreased (-0.614801 --> -0.644432).  Saving model ...
Epoch: 17 cost time: 0.5368931293487549
Epoch: 17, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.240 Vali Acc: 0.681 Test Loss: 1.240 Test Acc: 0.681
Validation loss decreased (-0.644432 --> -0.681469).  Saving model ...
Epoch: 18 cost time: 0.4774496555328369
Epoch: 18, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.191 Vali Acc: 0.704 Test Loss: 1.191 Test Acc: 0.704
Validation loss decreased (-0.681469 --> -0.703692).  Saving model ...
Epoch: 19 cost time: 0.5266718864440918
Epoch: 19, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.142 Vali Acc: 0.730 Test Loss: 1.142 Test Acc: 0.730
Validation loss decreased (-0.703692 --> -0.729618).  Saving model ...
Epoch: 20 cost time: 0.5970361232757568
Epoch: 20, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.092 Vali Acc: 0.763 Test Loss: 1.092 Test Acc: 0.763
Validation loss decreased (-0.729618 --> -0.762952).  Saving model ...
Epoch: 21 cost time: 0.643042802810669
Epoch: 21, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.045 Vali Acc: 0.781 Test Loss: 1.045 Test Acc: 0.781
Validation loss decreased (-0.762952 --> -0.781471).  Saving model ...
Epoch: 22 cost time: 0.5586001873016357
Epoch: 22, Steps: 2 | Train Loss: 1.006 Vali Loss: 0.998 Vali Acc: 0.800 Test Loss: 0.998 Test Acc: 0.800
Validation loss decreased (-0.781471 --> -0.799990).  Saving model ...
Epoch: 23 cost time: 0.5529022216796875
Epoch: 23, Steps: 2 | Train Loss: 1.005 Vali Loss: 0.952 Vali Acc: 0.811 Test Loss: 0.952 Test Acc: 0.811
Validation loss decreased (-0.799990 --> -0.811102).  Saving model ...
Epoch: 24 cost time: 0.5965006351470947
Epoch: 24, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.910 Vali Acc: 0.841 Test Loss: 0.910 Test Acc: 0.841
Validation loss decreased (-0.811102 --> -0.840732).  Saving model ...
Epoch: 25 cost time: 0.5706350803375244
Epoch: 25, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.868 Vali Acc: 0.848 Test Loss: 0.868 Test Acc: 0.848
Validation loss decreased (-0.840732 --> -0.848139).  Saving model ...
Epoch: 26 cost time: 0.6714959144592285
Epoch: 26, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.828 Vali Acc: 0.859 Test Loss: 0.828 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 27 cost time: 0.6151230335235596
Epoch: 27, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.789 Vali Acc: 0.870 Test Loss: 0.789 Test Acc: 0.870
Validation loss decreased (-0.859251 --> -0.870362).  Saving model ...
Epoch: 28 cost time: 0.6998279094696045
Epoch: 28, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.753 Vali Acc: 0.881 Test Loss: 0.753 Test Acc: 0.881
Validation loss decreased (-0.870362 --> -0.881474).  Saving model ...
Epoch: 29 cost time: 0.6403744220733643
Epoch: 29, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.716 Vali Acc: 0.885 Test Loss: 0.716 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 30 cost time: 0.5930204391479492
Epoch: 30, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.682 Vali Acc: 0.896 Test Loss: 0.682 Test Acc: 0.896
Validation loss decreased (-0.885178 --> -0.896289).  Saving model ...
Epoch: 31 cost time: 0.5545225143432617
Epoch: 31, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.649 Vali Acc: 0.904 Test Loss: 0.649 Test Acc: 0.904
Validation loss decreased (-0.896289 --> -0.903697).  Saving model ...
Epoch: 32 cost time: 0.5482895374298096
Epoch: 32, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.620 Vali Acc: 0.907 Test Loss: 0.620 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 33 cost time: 0.5410854816436768
Epoch: 33, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.591 Vali Acc: 0.907 Test Loss: 0.591 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 34 cost time: 0.5439608097076416
Epoch: 34, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.566 Vali Acc: 0.904 Test Loss: 0.566 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5571835041046143
Epoch: 35, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.541 Vali Acc: 0.904 Test Loss: 0.541 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5956542491912842
Epoch: 36, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.520 Vali Acc: 0.904 Test Loss: 0.520 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.45825719833374023
Epoch: 37, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.499 Vali Acc: 0.904 Test Loss: 0.499 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5671646595001221
Epoch: 38, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.479 Vali Acc: 0.904 Test Loss: 0.479 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5231404304504395
Epoch: 39, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.460 Vali Acc: 0.904 Test Loss: 0.460 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5011770725250244
Epoch: 40, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.443 Vali Acc: 0.904 Test Loss: 0.443 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4807708263397217
Epoch: 41, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.427 Vali Acc: 0.911 Test Loss: 0.427 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911107).  Saving model ...
Epoch: 42 cost time: 0.5512797832489014
Epoch: 42, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.413 Vali Acc: 0.919 Test Loss: 0.413 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918514).  Saving model ...
Epoch: 43 cost time: 0.60101318359375
Epoch: 43, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.400 Vali Acc: 0.926 Test Loss: 0.400 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 44 cost time: 0.6057121753692627
Epoch: 44, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.387 Vali Acc: 0.926 Test Loss: 0.387 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 45 cost time: 0.5363585948944092
Epoch: 45, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.376 Vali Acc: 0.926 Test Loss: 0.376 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 46 cost time: 0.5547807216644287
Epoch: 46, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.366 Vali Acc: 0.926 Test Loss: 0.366 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 47 cost time: 0.5778775215148926
Epoch: 47, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.357 Vali Acc: 0.926 Test Loss: 0.357 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 48 cost time: 0.6304569244384766
Epoch: 48, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.348 Vali Acc: 0.926 Test Loss: 0.348 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 49 cost time: 0.6209039688110352
Epoch: 49, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.340 Vali Acc: 0.937 Test Loss: 0.340 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937034).  Saving model ...
Epoch: 50 cost time: 0.5057070255279541
Epoch: 50, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.333 Vali Acc: 0.937 Test Loss: 0.333 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 51 cost time: 0.5145924091339111
Epoch: 51, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.326 Vali Acc: 0.933 Test Loss: 0.326 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6356723308563232
Epoch: 52, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5989606380462646
Epoch: 53, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6070928573608398
Epoch: 54, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.310 Vali Acc: 0.933 Test Loss: 0.310 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5842065811157227
Epoch: 55, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.306 Vali Acc: 0.930 Test Loss: 0.306 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.6233885288238525
Epoch: 56, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.302 Vali Acc: 0.926 Test Loss: 0.302 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.6925718784332275
Epoch: 57, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.5517284870147705
Epoch: 58, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.5782918930053711
Epoch: 59, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.6477692127227783
Epoch: 60, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 12854
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0125315189361572
Epoch: 1, Steps: 2 | Train Loss: 2.038 Vali Loss: 1.805 Vali Acc: 0.300 Test Loss: 1.805 Test Acc: 0.300
Validation loss decreased (inf --> -0.299982).  Saving model ...
Epoch: 2 cost time: 0.4716188907623291
Epoch: 2, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.776 Vali Acc: 0.315 Test Loss: 1.776 Test Acc: 0.315
Validation loss decreased (-0.299982 --> -0.314797).  Saving model ...
Epoch: 3 cost time: 0.7059240341186523
Epoch: 3, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.756 Vali Acc: 0.315 Test Loss: 1.756 Test Acc: 0.315
Validation loss decreased (-0.314797 --> -0.314797).  Saving model ...
Epoch: 4 cost time: 0.6018738746643066
Epoch: 4, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.740 Vali Acc: 0.311 Test Loss: 1.740 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6311800479888916
Epoch: 5, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.719 Vali Acc: 0.319 Test Loss: 1.719 Test Acc: 0.319
Validation loss decreased (-0.314797 --> -0.318501).  Saving model ...
Epoch: 6 cost time: 0.5806446075439453
Epoch: 6, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.692 Vali Acc: 0.337 Test Loss: 1.692 Test Acc: 0.337
Validation loss decreased (-0.318501 --> -0.337020).  Saving model ...
Epoch: 7 cost time: 0.5509078502655029
Epoch: 7, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.662 Vali Acc: 0.359 Test Loss: 1.662 Test Acc: 0.359
Validation loss decreased (-0.337020 --> -0.359243).  Saving model ...
Epoch: 8 cost time: 0.5260546207427979
Epoch: 8, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.629 Vali Acc: 0.389 Test Loss: 1.629 Test Acc: 0.389
Validation loss decreased (-0.359243 --> -0.388873).  Saving model ...
Epoch: 9 cost time: 0.47070932388305664
Epoch: 9, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.594 Vali Acc: 0.415 Test Loss: 1.594 Test Acc: 0.415
Validation loss decreased (-0.388873 --> -0.414799).  Saving model ...
Epoch: 10 cost time: 0.49274206161499023
Epoch: 10, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.555 Vali Acc: 0.444 Test Loss: 1.555 Test Acc: 0.444
Validation loss decreased (-0.414799 --> -0.444429).  Saving model ...
Epoch: 11 cost time: 0.48009276390075684
Epoch: 11, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.515 Vali Acc: 0.470 Test Loss: 1.515 Test Acc: 0.470
Validation loss decreased (-0.444429 --> -0.470355).  Saving model ...
Epoch: 12 cost time: 0.5557410717010498
Epoch: 12, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.474 Vali Acc: 0.500 Test Loss: 1.474 Test Acc: 0.500
Validation loss decreased (-0.470355 --> -0.499985).  Saving model ...
Epoch: 13 cost time: 0.49786925315856934
Epoch: 13, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.431 Vali Acc: 0.515 Test Loss: 1.431 Test Acc: 0.515
Validation loss decreased (-0.499985 --> -0.514801).  Saving model ...
Epoch: 14 cost time: 0.5495462417602539
Epoch: 14, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.389 Vali Acc: 0.537 Test Loss: 1.389 Test Acc: 0.537
Validation loss decreased (-0.514801 --> -0.537023).  Saving model ...
Epoch: 15 cost time: 0.5421357154846191
Epoch: 15, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.345 Vali Acc: 0.559 Test Loss: 1.345 Test Acc: 0.559
Validation loss decreased (-0.537023 --> -0.559246).  Saving model ...
Epoch: 16 cost time: 0.5377674102783203
Epoch: 16, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.302 Vali Acc: 0.578 Test Loss: 1.302 Test Acc: 0.578
Validation loss decreased (-0.559246 --> -0.577765).  Saving model ...
Epoch: 17 cost time: 0.5289778709411621
Epoch: 17, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.258 Vali Acc: 0.619 Test Loss: 1.258 Test Acc: 0.619
Validation loss decreased (-0.577765 --> -0.618506).  Saving model ...
Epoch: 18 cost time: 0.5980734825134277
Epoch: 18, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.214 Vali Acc: 0.641 Test Loss: 1.214 Test Acc: 0.641
Validation loss decreased (-0.618506 --> -0.640729).  Saving model ...
Epoch: 19 cost time: 0.5187883377075195
Epoch: 19, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.170 Vali Acc: 0.678 Test Loss: 1.170 Test Acc: 0.678
Validation loss decreased (-0.640729 --> -0.677766).  Saving model ...
Epoch: 20 cost time: 0.5569348335266113
Epoch: 20, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.125 Vali Acc: 0.693 Test Loss: 1.125 Test Acc: 0.693
Validation loss decreased (-0.677766 --> -0.692581).  Saving model ...
Epoch: 21 cost time: 0.5284740924835205
Epoch: 21, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.082 Vali Acc: 0.726 Test Loss: 1.082 Test Acc: 0.726
Validation loss decreased (-0.692581 --> -0.725915).  Saving model ...
Epoch: 22 cost time: 0.5156338214874268
Epoch: 22, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.039 Vali Acc: 0.744 Test Loss: 1.039 Test Acc: 0.744
Validation loss decreased (-0.725915 --> -0.744434).  Saving model ...
Epoch: 23 cost time: 0.5536408424377441
Epoch: 23, Steps: 2 | Train Loss: 1.006 Vali Loss: 0.997 Vali Acc: 0.774 Test Loss: 0.997 Test Acc: 0.774
Validation loss decreased (-0.744434 --> -0.774064).  Saving model ...
Epoch: 24 cost time: 0.4481489658355713
Epoch: 24, Steps: 2 | Train Loss: 1.000 Vali Loss: 0.956 Vali Acc: 0.793 Test Loss: 0.956 Test Acc: 0.793
Validation loss decreased (-0.774064 --> -0.792583).  Saving model ...
Epoch: 25 cost time: 0.5349504947662354
Epoch: 25, Steps: 2 | Train Loss: 0.962 Vali Loss: 0.917 Vali Acc: 0.815 Test Loss: 0.917 Test Acc: 0.815
Validation loss decreased (-0.792583 --> -0.814806).  Saving model ...
Epoch: 26 cost time: 0.5101969242095947
Epoch: 26, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.878 Vali Acc: 0.837 Test Loss: 0.878 Test Acc: 0.837
Validation loss decreased (-0.814806 --> -0.837028).  Saving model ...
Epoch: 27 cost time: 0.47156643867492676
Epoch: 27, Steps: 2 | Train Loss: 0.894 Vali Loss: 0.840 Vali Acc: 0.852 Test Loss: 0.840 Test Acc: 0.852
Validation loss decreased (-0.837028 --> -0.851843).  Saving model ...
Epoch: 28 cost time: 0.5131182670593262
Epoch: 28, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.804 Vali Acc: 0.867 Test Loss: 0.804 Test Acc: 0.867
Validation loss decreased (-0.851843 --> -0.866659).  Saving model ...
Epoch: 29 cost time: 0.5344841480255127
Epoch: 29, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.769 Vali Acc: 0.870 Test Loss: 0.769 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 30 cost time: 0.5706467628479004
Epoch: 30, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.734 Vali Acc: 0.885 Test Loss: 0.734 Test Acc: 0.885
Validation loss decreased (-0.870363 --> -0.885178).  Saving model ...
Epoch: 31 cost time: 0.5413620471954346
Epoch: 31, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.702 Vali Acc: 0.893 Test Loss: 0.702 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 32 cost time: 0.5668637752532959
Epoch: 32, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.671 Vali Acc: 0.900 Test Loss: 0.671 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899993).  Saving model ...
Epoch: 33 cost time: 0.5307836532592773
Epoch: 33, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.641 Vali Acc: 0.915 Test Loss: 0.641 Test Acc: 0.915
Validation loss decreased (-0.899993 --> -0.914808).  Saving model ...
Epoch: 34 cost time: 0.4397566318511963
Epoch: 34, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.612 Vali Acc: 0.919 Test Loss: 0.612 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 35 cost time: 0.5414035320281982
Epoch: 35, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.585 Vali Acc: 0.922 Test Loss: 0.585 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 36 cost time: 0.5830974578857422
Epoch: 36, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.560 Vali Acc: 0.930 Test Loss: 0.560 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 37 cost time: 0.4192068576812744
Epoch: 37, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.537 Vali Acc: 0.930 Test Loss: 0.537 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 38 cost time: 0.4562973976135254
Epoch: 38, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.516 Vali Acc: 0.930 Test Loss: 0.516 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 39 cost time: 0.5290791988372803
Epoch: 39, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.495 Vali Acc: 0.933 Test Loss: 0.495 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 40 cost time: 0.45368480682373047
Epoch: 40, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.476 Vali Acc: 0.933 Test Loss: 0.476 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 41 cost time: 0.5905776023864746
Epoch: 41, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.458 Vali Acc: 0.937 Test Loss: 0.458 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937032).  Saving model ...
Epoch: 42 cost time: 0.5118257999420166
Epoch: 42, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.442 Vali Acc: 0.937 Test Loss: 0.442 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 43 cost time: 0.5168983936309814
Epoch: 43, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.428 Vali Acc: 0.937 Test Loss: 0.428 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 44 cost time: 0.5359210968017578
Epoch: 44, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.414 Vali Acc: 0.944 Test Loss: 0.414 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944440).  Saving model ...
Epoch: 45 cost time: 0.5809910297393799
Epoch: 45, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.401 Vali Acc: 0.944 Test Loss: 0.401 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 46 cost time: 0.529045581817627
Epoch: 46, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.389 Vali Acc: 0.948 Test Loss: 0.389 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 47 cost time: 0.49535346031188965
Epoch: 47, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.378 Vali Acc: 0.948 Test Loss: 0.378 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 48 cost time: 0.4937105178833008
Epoch: 48, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.368 Vali Acc: 0.948 Test Loss: 0.368 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 49 cost time: 0.5214247703552246
Epoch: 49, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.359 Vali Acc: 0.952 Test Loss: 0.359 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 50 cost time: 0.45664095878601074
Epoch: 50, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.350 Vali Acc: 0.952 Test Loss: 0.350 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 51 cost time: 0.5044517517089844
Epoch: 51, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.342 Vali Acc: 0.952 Test Loss: 0.342 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 52 cost time: 0.560100793838501
Epoch: 52, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.334 Vali Acc: 0.948 Test Loss: 0.334 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5334727764129639
Epoch: 53, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.327 Vali Acc: 0.948 Test Loss: 0.327 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.638141393661499
Epoch: 54, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.321 Vali Acc: 0.948 Test Loss: 0.321 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.4551842212677002
Epoch: 55, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.314 Vali Acc: 0.952 Test Loss: 0.314 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 56 cost time: 0.5892503261566162
Epoch: 56, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.308 Vali Acc: 0.952 Test Loss: 0.308 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 57 cost time: 0.5695664882659912
Epoch: 57, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.302 Vali Acc: 0.952 Test Loss: 0.302 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 58 cost time: 0.5542755126953125
Epoch: 58, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.298 Vali Acc: 0.952 Test Loss: 0.298 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 59 cost time: 0.5101215839385986
Epoch: 59, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.293 Vali Acc: 0.948 Test Loss: 0.293 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.47338366508483887
Epoch: 60, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.289 Vali Acc: 0.948 Test Loss: 0.289 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.48751282691955566
Epoch: 61, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.285 Vali Acc: 0.948 Test Loss: 0.285 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.48346757888793945
Epoch: 62, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.281 Vali Acc: 0.948 Test Loss: 0.281 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.5082108974456787
Epoch: 63, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.277 Vali Acc: 0.952 Test Loss: 0.277 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 64 cost time: 0.5645248889923096
Epoch: 64, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.273 Vali Acc: 0.952 Test Loss: 0.273 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 65 cost time: 0.45740222930908203
Epoch: 65, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.270 Vali Acc: 0.952 Test Loss: 0.270 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 66 cost time: 0.4832313060760498
Epoch: 66, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.266 Vali Acc: 0.952 Test Loss: 0.266 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 67 cost time: 0.5070970058441162
Epoch: 67, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.263 Vali Acc: 0.952 Test Loss: 0.263 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 68 cost time: 0.5223243236541748
Epoch: 68, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.259 Vali Acc: 0.952 Test Loss: 0.259 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 69 cost time: 0.5533270835876465
Epoch: 69, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.4690673351287842
Epoch: 70, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.254 Vali Acc: 0.948 Test Loss: 0.254 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.49964475631713867
Epoch: 71, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.5197732448577881
Epoch: 72, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.249 Vali Acc: 0.948 Test Loss: 0.249 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.409609317779541
Epoch: 73, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.5202815532684326
Epoch: 74, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.245 Vali Acc: 0.948 Test Loss: 0.245 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.6171820163726807
Epoch: 75, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.5303089618682861
Epoch: 76, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.515580415725708
Epoch: 77, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.240 Vali Acc: 0.948 Test Loss: 0.240 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.6386969089508057
Epoch: 78, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 11750
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9329562187194824
Epoch: 1, Steps: 2 | Train Loss: 1.965 Vali Loss: 1.807 Vali Acc: 0.311 Test Loss: 1.807 Test Acc: 0.311
Validation loss decreased (inf --> -0.311093).  Saving model ...
Epoch: 2 cost time: 0.6548054218292236
Epoch: 2, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.770 Vali Acc: 0.319 Test Loss: 1.770 Test Acc: 0.319
Validation loss decreased (-0.311093 --> -0.318501).  Saving model ...
Epoch: 3 cost time: 0.4368166923522949
Epoch: 3, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.747 Vali Acc: 0.322 Test Loss: 1.747 Test Acc: 0.322
Validation loss decreased (-0.318501 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 0.6262052059173584
Epoch: 4, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.730 Vali Acc: 0.322 Test Loss: 1.730 Test Acc: 0.322
Validation loss decreased (-0.322205 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 0.559812068939209
Epoch: 5, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.712 Vali Acc: 0.319 Test Loss: 1.712 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.49244260787963867
Epoch: 6, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.692 Vali Acc: 0.322 Test Loss: 1.692 Test Acc: 0.322
Validation loss decreased (-0.322205 --> -0.322205).  Saving model ...
Epoch: 7 cost time: 0.5446910858154297
Epoch: 7, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.671 Vali Acc: 0.344 Test Loss: 1.671 Test Acc: 0.344
Validation loss decreased (-0.322205 --> -0.344428).  Saving model ...
Epoch: 8 cost time: 0.4670710563659668
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.647 Vali Acc: 0.356 Test Loss: 1.647 Test Acc: 0.356
Validation loss decreased (-0.344428 --> -0.355539).  Saving model ...
Epoch: 9 cost time: 0.5474178791046143
Epoch: 9, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.621 Vali Acc: 0.385 Test Loss: 1.621 Test Acc: 0.385
Validation loss decreased (-0.355539 --> -0.385169).  Saving model ...
Epoch: 10 cost time: 0.5154039859771729
Epoch: 10, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.592 Vali Acc: 0.407 Test Loss: 1.592 Test Acc: 0.407
Validation loss decreased (-0.385169 --> -0.407391).  Saving model ...
Epoch: 11 cost time: 0.5216183662414551
Epoch: 11, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.563 Vali Acc: 0.419 Test Loss: 1.563 Test Acc: 0.419
Validation loss decreased (-0.407391 --> -0.418503).  Saving model ...
Epoch: 12 cost time: 0.4945809841156006
Epoch: 12, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.531 Vali Acc: 0.444 Test Loss: 1.531 Test Acc: 0.444
Validation loss decreased (-0.418503 --> -0.444429).  Saving model ...
Epoch: 13 cost time: 0.5842149257659912
Epoch: 13, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.498 Vali Acc: 0.478 Test Loss: 1.498 Test Acc: 0.478
Validation loss decreased (-0.444429 --> -0.477763).  Saving model ...
Epoch: 14 cost time: 0.4981117248535156
Epoch: 14, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.463 Vali Acc: 0.493 Test Loss: 1.463 Test Acc: 0.493
Validation loss decreased (-0.477763 --> -0.492578).  Saving model ...
Epoch: 15 cost time: 0.48102760314941406
Epoch: 15, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.428 Vali Acc: 0.515 Test Loss: 1.428 Test Acc: 0.515
Validation loss decreased (-0.492578 --> -0.514801).  Saving model ...
Epoch: 16 cost time: 0.47111010551452637
Epoch: 16, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.393 Vali Acc: 0.537 Test Loss: 1.393 Test Acc: 0.537
Validation loss decreased (-0.514801 --> -0.537023).  Saving model ...
Epoch: 17 cost time: 0.5123386383056641
Epoch: 17, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.356 Vali Acc: 0.563 Test Loss: 1.356 Test Acc: 0.563
Validation loss decreased (-0.537023 --> -0.562949).  Saving model ...
Epoch: 18 cost time: 0.4339284896850586
Epoch: 18, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.320 Vali Acc: 0.589 Test Loss: 1.320 Test Acc: 0.589
Validation loss decreased (-0.562949 --> -0.588876).  Saving model ...
Epoch: 19 cost time: 0.5263152122497559
Epoch: 19, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.285 Vali Acc: 0.611 Test Loss: 1.285 Test Acc: 0.611
Validation loss decreased (-0.588876 --> -0.611098).  Saving model ...
Epoch: 20 cost time: 0.5512042045593262
Epoch: 20, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.249 Vali Acc: 0.626 Test Loss: 1.249 Test Acc: 0.626
Validation loss decreased (-0.611098 --> -0.625913).  Saving model ...
Epoch: 21 cost time: 0.490863561630249
Epoch: 21, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.213 Vali Acc: 0.644 Test Loss: 1.213 Test Acc: 0.644
Validation loss decreased (-0.625913 --> -0.644432).  Saving model ...
Epoch: 22 cost time: 0.49036312103271484
Epoch: 22, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.178 Vali Acc: 0.667 Test Loss: 1.178 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666655).  Saving model ...
Epoch: 23 cost time: 0.46566104888916016
Epoch: 23, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.144 Vali Acc: 0.685 Test Loss: 1.144 Test Acc: 0.685
Validation loss decreased (-0.666655 --> -0.685174).  Saving model ...
Epoch: 24 cost time: 0.4890458583831787
Epoch: 24, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.109 Vali Acc: 0.722 Test Loss: 1.109 Test Acc: 0.722
Validation loss decreased (-0.685174 --> -0.722211).  Saving model ...
Epoch: 25 cost time: 0.5016524791717529
Epoch: 25, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.076 Vali Acc: 0.737 Test Loss: 1.076 Test Acc: 0.737
Validation loss decreased (-0.722211 --> -0.737026).  Saving model ...
Epoch: 26 cost time: 0.48796796798706055
Epoch: 26, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.042 Vali Acc: 0.763 Test Loss: 1.042 Test Acc: 0.763
Validation loss decreased (-0.737026 --> -0.762953).  Saving model ...
Epoch: 27 cost time: 0.5755541324615479
Epoch: 27, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.010 Vali Acc: 0.793 Test Loss: 1.010 Test Acc: 0.793
Validation loss decreased (-0.762953 --> -0.792582).  Saving model ...
Epoch: 28 cost time: 0.5591332912445068
Epoch: 28, Steps: 2 | Train Loss: 0.975 Vali Loss: 0.978 Vali Acc: 0.796 Test Loss: 0.978 Test Acc: 0.796
Validation loss decreased (-0.792582 --> -0.796287).  Saving model ...
Epoch: 29 cost time: 0.4832782745361328
Epoch: 29, Steps: 2 | Train Loss: 0.987 Vali Loss: 0.945 Vali Acc: 0.811 Test Loss: 0.945 Test Acc: 0.811
Validation loss decreased (-0.796287 --> -0.811102).  Saving model ...
Epoch: 30 cost time: 0.4854757785797119
Epoch: 30, Steps: 2 | Train Loss: 0.921 Vali Loss: 0.914 Vali Acc: 0.830 Test Loss: 0.914 Test Acc: 0.830
Validation loss decreased (-0.811102 --> -0.829620).  Saving model ...
Epoch: 31 cost time: 0.5754661560058594
Epoch: 31, Steps: 2 | Train Loss: 0.894 Vali Loss: 0.882 Vali Acc: 0.837 Test Loss: 0.882 Test Acc: 0.837
Validation loss decreased (-0.829620 --> -0.837028).  Saving model ...
Epoch: 32 cost time: 0.5268580913543701
Epoch: 32, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.852 Vali Acc: 0.841 Test Loss: 0.852 Test Acc: 0.841
Validation loss decreased (-0.837028 --> -0.840732).  Saving model ...
Epoch: 33 cost time: 0.5351111888885498
Epoch: 33, Steps: 2 | Train Loss: 0.742 Vali Loss: 0.823 Vali Acc: 0.859 Test Loss: 0.823 Test Acc: 0.859
Validation loss decreased (-0.840732 --> -0.859251).  Saving model ...
Epoch: 34 cost time: 0.479478120803833
Epoch: 34, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.795 Vali Acc: 0.870 Test Loss: 0.795 Test Acc: 0.870
Validation loss decreased (-0.859251 --> -0.870362).  Saving model ...
Epoch: 35 cost time: 0.48114538192749023
Epoch: 35, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.768 Vali Acc: 0.874 Test Loss: 0.768 Test Acc: 0.874
Validation loss decreased (-0.870362 --> -0.874066).  Saving model ...
Epoch: 36 cost time: 0.49407076835632324
Epoch: 36, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.743 Vali Acc: 0.881 Test Loss: 0.743 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 37 cost time: 0.6253917217254639
Epoch: 37, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.719 Vali Acc: 0.881 Test Loss: 0.719 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881474).  Saving model ...
Epoch: 38 cost time: 0.5264918804168701
Epoch: 38, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.696 Vali Acc: 0.889 Test Loss: 0.696 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888882).  Saving model ...
Epoch: 39 cost time: 0.49136829376220703
Epoch: 39, Steps: 2 | Train Loss: 0.575 Vali Loss: 0.674 Vali Acc: 0.893 Test Loss: 0.674 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 40 cost time: 0.5425715446472168
Epoch: 40, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.652 Vali Acc: 0.893 Test Loss: 0.652 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 41 cost time: 0.5592894554138184
Epoch: 41, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.632 Vali Acc: 0.896 Test Loss: 0.632 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 42 cost time: 0.432659387588501
Epoch: 42, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.613 Vali Acc: 0.900 Test Loss: 0.613 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 43 cost time: 0.6053543090820312
Epoch: 43, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.596 Vali Acc: 0.900 Test Loss: 0.596 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 44 cost time: 0.6119489669799805
Epoch: 44, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.579 Vali Acc: 0.904 Test Loss: 0.579 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 45 cost time: 0.5101640224456787
Epoch: 45, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6181464195251465
Epoch: 46, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.548 Vali Acc: 0.900 Test Loss: 0.548 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5573718547821045
Epoch: 47, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.534 Vali Acc: 0.904 Test Loss: 0.534 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 48 cost time: 0.5892114639282227
Epoch: 48, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.521 Vali Acc: 0.900 Test Loss: 0.521 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.570354700088501
Epoch: 49, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.507 Vali Acc: 0.896 Test Loss: 0.507 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4318990707397461
Epoch: 50, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.495 Vali Acc: 0.896 Test Loss: 0.495 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.49463486671447754
Epoch: 51, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.483 Vali Acc: 0.896 Test Loss: 0.483 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.5584309101104736
Epoch: 52, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.472 Vali Acc: 0.900 Test Loss: 0.472 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.5022151470184326
Epoch: 53, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.5055716037750244
Epoch: 54, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.5373456478118896
Epoch: 55, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.444 Vali Acc: 0.896 Test Loss: 0.444 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.6360538005828857
Epoch: 56, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.437 Vali Acc: 0.896 Test Loss: 0.437 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.6011099815368652
Epoch: 57, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.429 Vali Acc: 0.893 Test Loss: 0.429 Test Acc: 0.893
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 10262
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.208761692047119
Epoch: 1, Steps: 2 | Train Loss: 2.046 Vali Loss: 1.907 Vali Acc: 0.193 Test Loss: 1.907 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.6095194816589355
Epoch: 2, Steps: 2 | Train Loss: 2.032 Vali Loss: 1.886 Vali Acc: 0.178 Test Loss: 1.886 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5043594837188721
Epoch: 3, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.872 Vali Acc: 0.185 Test Loss: 1.872 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4890618324279785
Epoch: 4, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.864 Vali Acc: 0.185 Test Loss: 1.864 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5933082103729248
Epoch: 5, Steps: 2 | Train Loss: 2.009 Vali Loss: 1.854 Vali Acc: 0.185 Test Loss: 1.854 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5107007026672363
Epoch: 6, Steps: 2 | Train Loss: 1.966 Vali Loss: 1.840 Vali Acc: 0.189 Test Loss: 1.840 Test Acc: 0.189
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6655807495117188
Epoch: 7, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.825 Vali Acc: 0.193 Test Loss: 1.825 Test Acc: 0.193
Validation loss decreased (-0.192574 --> -0.192574).  Saving model ...
Epoch: 8 cost time: 0.6541862487792969
Epoch: 8, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.808 Vali Acc: 0.207 Test Loss: 1.808 Test Acc: 0.207
Validation loss decreased (-0.192574 --> -0.207389).  Saving model ...
Epoch: 9 cost time: 0.6357767581939697
Epoch: 9, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.790 Vali Acc: 0.211 Test Loss: 1.790 Test Acc: 0.211
Validation loss decreased (-0.207389 --> -0.211093).  Saving model ...
Epoch: 10 cost time: 0.6094315052032471
Epoch: 10, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.769 Vali Acc: 0.222 Test Loss: 1.769 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222205).  Saving model ...
Epoch: 11 cost time: 0.4969635009765625
Epoch: 11, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.746 Vali Acc: 0.233 Test Loss: 1.746 Test Acc: 0.233
Validation loss decreased (-0.222205 --> -0.233316).  Saving model ...
Epoch: 12 cost time: 0.5285398960113525
Epoch: 12, Steps: 2 | Train Loss: 1.944 Vali Loss: 1.721 Vali Acc: 0.252 Test Loss: 1.721 Test Acc: 0.252
Validation loss decreased (-0.233316 --> -0.251835).  Saving model ...
Epoch: 13 cost time: 0.5196609497070312
Epoch: 13, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.696 Vali Acc: 0.267 Test Loss: 1.696 Test Acc: 0.267
Validation loss decreased (-0.251835 --> -0.266650).  Saving model ...
Epoch: 14 cost time: 0.6265757083892822
Epoch: 14, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.670 Vali Acc: 0.281 Test Loss: 1.670 Test Acc: 0.281
Validation loss decreased (-0.266650 --> -0.281465).  Saving model ...
Epoch: 15 cost time: 0.5886538028717041
Epoch: 15, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.641 Vali Acc: 0.311 Test Loss: 1.641 Test Acc: 0.311
Validation loss decreased (-0.281465 --> -0.311095).  Saving model ...
Epoch: 16 cost time: 0.5012750625610352
Epoch: 16, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.611 Vali Acc: 0.326 Test Loss: 1.611 Test Acc: 0.326
Validation loss decreased (-0.311095 --> -0.325910).  Saving model ...
Epoch: 17 cost time: 0.6008996963500977
Epoch: 17, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.582 Vali Acc: 0.352 Test Loss: 1.582 Test Acc: 0.352
Validation loss decreased (-0.325910 --> -0.351836).  Saving model ...
Epoch: 18 cost time: 0.5608780384063721
Epoch: 18, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.550 Vali Acc: 0.396 Test Loss: 1.550 Test Acc: 0.396
Validation loss decreased (-0.351836 --> -0.396281).  Saving model ...
Epoch: 19 cost time: 0.6414282321929932
Epoch: 19, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.520 Vali Acc: 0.448 Test Loss: 1.520 Test Acc: 0.448
Validation loss decreased (-0.396281 --> -0.448133).  Saving model ...
Epoch: 20 cost time: 0.5651595592498779
Epoch: 20, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.489 Vali Acc: 0.470 Test Loss: 1.489 Test Acc: 0.470
Validation loss decreased (-0.448133 --> -0.470355).  Saving model ...
Epoch: 21 cost time: 0.6172831058502197
Epoch: 21, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.459 Vali Acc: 0.511 Test Loss: 1.459 Test Acc: 0.511
Validation loss decreased (-0.470355 --> -0.511097).  Saving model ...
Epoch: 22 cost time: 0.6475234031677246
Epoch: 22, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.427 Vali Acc: 0.533 Test Loss: 1.427 Test Acc: 0.533
Validation loss decreased (-0.511097 --> -0.533319).  Saving model ...
Epoch: 23 cost time: 0.5110089778900146
Epoch: 23, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.395 Vali Acc: 0.559 Test Loss: 1.395 Test Acc: 0.559
Validation loss decreased (-0.533319 --> -0.559245).  Saving model ...
Epoch: 24 cost time: 0.5747158527374268
Epoch: 24, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.363 Vali Acc: 0.593 Test Loss: 1.363 Test Acc: 0.593
Validation loss decreased (-0.559245 --> -0.592579).  Saving model ...
Epoch: 25 cost time: 0.598884105682373
Epoch: 25, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.331 Vali Acc: 0.611 Test Loss: 1.331 Test Acc: 0.611
Validation loss decreased (-0.592579 --> -0.611098).  Saving model ...
Epoch: 26 cost time: 0.5341427326202393
Epoch: 26, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.297 Vali Acc: 0.641 Test Loss: 1.297 Test Acc: 0.641
Validation loss decreased (-0.611098 --> -0.640728).  Saving model ...
Epoch: 27 cost time: 0.634505033493042
Epoch: 27, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.264 Vali Acc: 0.648 Test Loss: 1.264 Test Acc: 0.648
Validation loss decreased (-0.640728 --> -0.648136).  Saving model ...
Epoch: 28 cost time: 0.5355596542358398
Epoch: 28, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.230 Vali Acc: 0.674 Test Loss: 1.230 Test Acc: 0.674
Validation loss decreased (-0.648136 --> -0.674062).  Saving model ...
Epoch: 29 cost time: 0.5761594772338867
Epoch: 29, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.197 Vali Acc: 0.704 Test Loss: 1.197 Test Acc: 0.704
Validation loss decreased (-0.674062 --> -0.703692).  Saving model ...
Epoch: 30 cost time: 0.5713372230529785
Epoch: 30, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.164 Vali Acc: 0.719 Test Loss: 1.164 Test Acc: 0.719
Validation loss decreased (-0.703692 --> -0.718507).  Saving model ...
Epoch: 31 cost time: 0.5480549335479736
Epoch: 31, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.132 Vali Acc: 0.763 Test Loss: 1.132 Test Acc: 0.763
Validation loss decreased (-0.718507 --> -0.762952).  Saving model ...
Epoch: 32 cost time: 0.5065169334411621
Epoch: 32, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.100 Vali Acc: 0.793 Test Loss: 1.100 Test Acc: 0.793
Validation loss decreased (-0.762952 --> -0.792582).  Saving model ...
Epoch: 33 cost time: 0.6234209537506104
Epoch: 33, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.068 Vali Acc: 0.800 Test Loss: 1.068 Test Acc: 0.800
Validation loss decreased (-0.792582 --> -0.799989).  Saving model ...
Epoch: 34 cost time: 0.7355785369873047
Epoch: 34, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.036 Vali Acc: 0.804 Test Loss: 1.036 Test Acc: 0.804
Validation loss decreased (-0.799989 --> -0.803693).  Saving model ...
Epoch: 35 cost time: 0.5844271183013916
Epoch: 35, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.006 Vali Acc: 0.811 Test Loss: 1.006 Test Acc: 0.811
Validation loss decreased (-0.803693 --> -0.811101).  Saving model ...
Epoch: 36 cost time: 0.4761364459991455
Epoch: 36, Steps: 2 | Train Loss: 1.048 Vali Loss: 0.976 Vali Acc: 0.837 Test Loss: 0.976 Test Acc: 0.837
Validation loss decreased (-0.811101 --> -0.837027).  Saving model ...
Epoch: 37 cost time: 0.7261974811553955
Epoch: 37, Steps: 2 | Train Loss: 0.980 Vali Loss: 0.946 Vali Acc: 0.852 Test Loss: 0.946 Test Acc: 0.852
Validation loss decreased (-0.837027 --> -0.851842).  Saving model ...
Epoch: 38 cost time: 0.6831076145172119
Epoch: 38, Steps: 2 | Train Loss: 0.921 Vali Loss: 0.916 Vali Acc: 0.852 Test Loss: 0.916 Test Acc: 0.852
Validation loss decreased (-0.851842 --> -0.851843).  Saving model ...
Epoch: 39 cost time: 0.5929620265960693
Epoch: 39, Steps: 2 | Train Loss: 0.980 Vali Loss: 0.886 Vali Acc: 0.867 Test Loss: 0.886 Test Acc: 0.867
Validation loss decreased (-0.851843 --> -0.866658).  Saving model ...
Epoch: 40 cost time: 0.6492664813995361
Epoch: 40, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.856 Vali Acc: 0.870 Test Loss: 0.856 Test Acc: 0.870
Validation loss decreased (-0.866658 --> -0.870362).  Saving model ...
Epoch: 41 cost time: 0.6571159362792969
Epoch: 41, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.829 Vali Acc: 0.878 Test Loss: 0.829 Test Acc: 0.878
Validation loss decreased (-0.870362 --> -0.877769).  Saving model ...
Epoch: 42 cost time: 0.6310515403747559
Epoch: 42, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.802 Vali Acc: 0.881 Test Loss: 0.802 Test Acc: 0.881
Validation loss decreased (-0.877769 --> -0.881473).  Saving model ...
Epoch: 43 cost time: 0.6932194232940674
Epoch: 43, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.775 Vali Acc: 0.881 Test Loss: 0.775 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881474).  Saving model ...
Epoch: 44 cost time: 0.6680667400360107
Epoch: 44, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.750 Vali Acc: 0.885 Test Loss: 0.750 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 45 cost time: 0.6640400886535645
Epoch: 45, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.727 Vali Acc: 0.881 Test Loss: 0.727 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6808276176452637
Epoch: 46, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.704 Vali Acc: 0.885 Test Loss: 0.704 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885178).  Saving model ...
Epoch: 47 cost time: 0.7172386646270752
Epoch: 47, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.683 Vali Acc: 0.885 Test Loss: 0.683 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885178).  Saving model ...
Epoch: 48 cost time: 0.7070157527923584
Epoch: 48, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.663 Vali Acc: 0.893 Test Loss: 0.663 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 49 cost time: 0.5958518981933594
Epoch: 49, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.643 Vali Acc: 0.896 Test Loss: 0.643 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 50 cost time: 0.6097500324249268
Epoch: 50, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.625 Vali Acc: 0.896 Test Loss: 0.625 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 51 cost time: 0.7113595008850098
Epoch: 51, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 52 cost time: 0.6544780731201172
Epoch: 52, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.592 Vali Acc: 0.907 Test Loss: 0.592 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907401).  Saving model ...
Epoch: 53 cost time: 0.6410393714904785
Epoch: 53, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.575 Vali Acc: 0.907 Test Loss: 0.575 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 54 cost time: 0.6794562339782715
Epoch: 54, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.560 Vali Acc: 0.911 Test Loss: 0.560 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 55 cost time: 0.6257004737854004
Epoch: 55, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.545 Vali Acc: 0.911 Test Loss: 0.545 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 56 cost time: 0.7225956916809082
Epoch: 56, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.532 Vali Acc: 0.915 Test Loss: 0.532 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914809).  Saving model ...
Epoch: 57 cost time: 0.7200338840484619
Epoch: 57, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.519 Vali Acc: 0.922 Test Loss: 0.519 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 58 cost time: 0.7175297737121582
Epoch: 58, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.508 Vali Acc: 0.926 Test Loss: 0.508 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 59 cost time: 0.6980702877044678
Epoch: 59, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.496 Vali Acc: 0.926 Test Loss: 0.496 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 60 cost time: 0.6525547504425049
Epoch: 60, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.485 Vali Acc: 0.930 Test Loss: 0.485 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 61 cost time: 0.6114866733551025
Epoch: 61, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.474 Vali Acc: 0.933 Test Loss: 0.474 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 62 cost time: 0.7178947925567627
Epoch: 62, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.465 Vali Acc: 0.937 Test Loss: 0.465 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937032).  Saving model ...
Epoch: 63 cost time: 0.5976269245147705
Epoch: 63, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.455 Vali Acc: 0.937 Test Loss: 0.455 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 64 cost time: 0.5448269844055176
Epoch: 64, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.447 Vali Acc: 0.933 Test Loss: 0.447 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6090917587280273
Epoch: 65, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.437 Vali Acc: 0.944 Test Loss: 0.437 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944440).  Saving model ...
Epoch: 66 cost time: 0.7072219848632812
Epoch: 66, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.430 Vali Acc: 0.941 Test Loss: 0.430 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7586820125579834
Epoch: 67, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.423 Vali Acc: 0.941 Test Loss: 0.423 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6185305118560791
Epoch: 68, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.416 Vali Acc: 0.944 Test Loss: 0.416 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 69 cost time: 0.666858434677124
Epoch: 69, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.410 Vali Acc: 0.941 Test Loss: 0.410 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.602081298828125
Epoch: 70, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.403 Vali Acc: 0.941 Test Loss: 0.403 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6639811992645264
Epoch: 71, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.397 Vali Acc: 0.941 Test Loss: 0.397 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.746762752532959
Epoch: 72, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.391 Vali Acc: 0.941 Test Loss: 0.391 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.6387100219726562
Epoch: 73, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.385 Vali Acc: 0.941 Test Loss: 0.385 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.591893196105957
Epoch: 74, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.379 Vali Acc: 0.941 Test Loss: 0.379 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.6638751029968262
Epoch: 75, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.374 Vali Acc: 0.941 Test Loss: 0.374 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.6925497055053711
Epoch: 76, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.370 Vali Acc: 0.941 Test Loss: 0.370 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.5356960296630859
Epoch: 77, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.364 Vali Acc: 0.941 Test Loss: 0.364 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.6275308132171631
Epoch: 78, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.359 Vali Acc: 0.941 Test Loss: 0.359 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el2_dm16_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 9558
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.088442325592041
Epoch: 1, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.688 Vali Acc: 0.274 Test Loss: 1.688 Test Acc: 0.274
Validation loss decreased (inf --> -0.274057).  Saving model ...
Epoch: 2 cost time: 0.5941612720489502
Epoch: 2, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.510 Vali Acc: 0.326 Test Loss: 1.510 Test Acc: 0.326
Validation loss decreased (-0.274057 --> -0.325911).  Saving model ...
Epoch: 3 cost time: 0.4885826110839844
Epoch: 3, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.249 Vali Acc: 0.648 Test Loss: 1.249 Test Acc: 0.648
Validation loss decreased (-0.325911 --> -0.648136).  Saving model ...
Epoch: 4 cost time: 0.516695499420166
Epoch: 4, Steps: 2 | Train Loss: 1.136 Vali Loss: 0.887 Vali Acc: 0.859 Test Loss: 0.887 Test Acc: 0.859
Validation loss decreased (-0.648136 --> -0.859250).  Saving model ...
Epoch: 5 cost time: 0.5269567966461182
Epoch: 5, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.619 Vali Acc: 0.911 Test Loss: 0.619 Test Acc: 0.911
Validation loss decreased (-0.859250 --> -0.911105).  Saving model ...
Epoch: 6 cost time: 0.5708231925964355
Epoch: 6, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.447 Vali Acc: 0.922 Test Loss: 0.447 Test Acc: 0.922
Validation loss decreased (-0.911105 --> -0.922218).  Saving model ...
Epoch: 7 cost time: 0.5553014278411865
Epoch: 7, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.371 Vali Acc: 0.885 Test Loss: 0.371 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4953751564025879
Epoch: 8, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 9 cost time: 0.47443318367004395
Epoch: 9, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 10 cost time: 0.5519568920135498
Epoch: 10, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4829082489013672
Epoch: 11, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.915 Test Loss: 0.223 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5392966270446777
Epoch: 12, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.219 Vali Acc: 0.915 Test Loss: 0.219 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5261356830596924
Epoch: 13, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.926 Test Loss: 0.184 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6126835346221924
Epoch: 14, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.930 Test Loss: 0.171 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 15 cost time: 0.571052074432373
Epoch: 15, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.933 Test Loss: 0.168 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933332).  Saving model ...
Epoch: 16 cost time: 0.5421078205108643
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
Validation loss decreased (-0.933332 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.4909052848815918
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5341329574584961
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6401576995849609
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4822537899017334
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5584449768066406
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4777252674102783
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5169572830200195
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5702455043792725
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5671966075897217
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.523932695388794
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 332678
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3126277923583984
Epoch: 1, Steps: 2 | Train Loss: 1.881 Vali Loss: 1.786 Vali Acc: 0.311 Test Loss: 1.786 Test Acc: 0.311
Validation loss decreased (inf --> -0.311093).  Saving model ...
Epoch: 2 cost time: 0.574653148651123
Epoch: 2, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.666 Vali Acc: 0.352 Test Loss: 1.666 Test Acc: 0.352
Validation loss decreased (-0.311093 --> -0.351835).  Saving model ...
Epoch: 3 cost time: 0.5565767288208008
Epoch: 3, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.515 Vali Acc: 0.448 Test Loss: 1.515 Test Acc: 0.448
Validation loss decreased (-0.351835 --> -0.448133).  Saving model ...
Epoch: 4 cost time: 0.45853471755981445
Epoch: 4, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.286 Vali Acc: 0.652 Test Loss: 1.286 Test Acc: 0.652
Validation loss decreased (-0.448133 --> -0.651839).  Saving model ...
Epoch: 5 cost time: 0.5031692981719971
Epoch: 5, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.041 Vali Acc: 0.748 Test Loss: 1.041 Test Acc: 0.748
Validation loss decreased (-0.651839 --> -0.748138).  Saving model ...
Epoch: 6 cost time: 0.4883413314819336
Epoch: 6, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.822 Vali Acc: 0.781 Test Loss: 0.822 Test Acc: 0.781
Validation loss decreased (-0.748138 --> -0.781473).  Saving model ...
Epoch: 7 cost time: 0.49236249923706055
Epoch: 7, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.652 Vali Acc: 0.867 Test Loss: 0.652 Test Acc: 0.867
Validation loss decreased (-0.781473 --> -0.866660).  Saving model ...
Epoch: 8 cost time: 0.44469332695007324
Epoch: 8, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.528 Vali Acc: 0.896 Test Loss: 0.528 Test Acc: 0.896
Validation loss decreased (-0.866660 --> -0.896291).  Saving model ...
Epoch: 9 cost time: 0.560269832611084
Epoch: 9, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.433 Vali Acc: 0.904 Test Loss: 0.433 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 10 cost time: 0.45227575302124023
Epoch: 10, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.358 Vali Acc: 0.919 Test Loss: 0.358 Test Acc: 0.919
Validation loss decreased (-0.903699 --> -0.918515).  Saving model ...
Epoch: 11 cost time: 0.5374190807342529
Epoch: 11, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.304 Vali Acc: 0.933 Test Loss: 0.304 Test Acc: 0.933
Validation loss decreased (-0.918515 --> -0.933330).  Saving model ...
Epoch: 12 cost time: 0.5422728061676025
Epoch: 12, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5809617042541504
Epoch: 13, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5711226463317871
Epoch: 14, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937035).  Saving model ...
Epoch: 15 cost time: 0.5695135593414307
Epoch: 15, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.45997142791748047
Epoch: 16, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.926 Test Loss: 0.194 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6375644207000732
Epoch: 17, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.46080446243286133
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.926 Test Loss: 0.184 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5428042411804199
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.926 Test Loss: 0.182 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5415084362030029
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.926 Test Loss: 0.182 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4538609981536865
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5488297939300537
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5203573703765869
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.5213685035705566
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5150642395019531
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4861738681793213
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5638303756713867
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4964597225189209
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5573477745056152
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5708811283111572
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4557476043701172
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7647466659545898
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.548621416091919
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 231558
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.22453236579895
Epoch: 1, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.805 Vali Acc: 0.185 Test Loss: 1.805 Test Acc: 0.185
Validation loss decreased (inf --> -0.185167).  Saving model ...
Epoch: 2 cost time: 0.6031703948974609
Epoch: 2, Steps: 2 | Train Loss: 1.978 Vali Loss: 1.704 Vali Acc: 0.274 Test Loss: 1.704 Test Acc: 0.274
Validation loss decreased (-0.185167 --> -0.274057).  Saving model ...
Epoch: 3 cost time: 0.550640344619751
Epoch: 3, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.590 Vali Acc: 0.352 Test Loss: 1.590 Test Acc: 0.352
Validation loss decreased (-0.274057 --> -0.351836).  Saving model ...
Epoch: 4 cost time: 0.517629861831665
Epoch: 4, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.422 Vali Acc: 0.522 Test Loss: 1.422 Test Acc: 0.522
Validation loss decreased (-0.351836 --> -0.522208).  Saving model ...
Epoch: 5 cost time: 0.6544613838195801
Epoch: 5, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.231 Vali Acc: 0.667 Test Loss: 1.231 Test Acc: 0.667
Validation loss decreased (-0.522208 --> -0.666654).  Saving model ...
Epoch: 6 cost time: 0.5704097747802734
Epoch: 6, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.045 Vali Acc: 0.741 Test Loss: 1.045 Test Acc: 0.741
Validation loss decreased (-0.666654 --> -0.740730).  Saving model ...
Epoch: 7 cost time: 0.5326869487762451
Epoch: 7, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.872 Vali Acc: 0.785 Test Loss: 0.872 Test Acc: 0.785
Validation loss decreased (-0.740730 --> -0.785176).  Saving model ...
Epoch: 8 cost time: 0.4605526924133301
Epoch: 8, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.721 Vali Acc: 0.859 Test Loss: 0.721 Test Acc: 0.859
Validation loss decreased (-0.785176 --> -0.859252).  Saving model ...
Epoch: 9 cost time: 0.5615785121917725
Epoch: 9, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.598 Vali Acc: 0.878 Test Loss: 0.598 Test Acc: 0.878
Validation loss decreased (-0.859252 --> -0.877772).  Saving model ...
Epoch: 10 cost time: 0.6290693283081055
Epoch: 10, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.501 Vali Acc: 0.919 Test Loss: 0.501 Test Acc: 0.919
Validation loss decreased (-0.877772 --> -0.918514).  Saving model ...
Epoch: 11 cost time: 0.48433351516723633
Epoch: 11, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.424 Vali Acc: 0.922 Test Loss: 0.424 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 12 cost time: 0.431499719619751
Epoch: 12, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.360 Vali Acc: 0.922 Test Loss: 0.360 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 13 cost time: 0.5319745540618896
Epoch: 13, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.307 Vali Acc: 0.937 Test Loss: 0.307 Test Acc: 0.937
Validation loss decreased (-0.922219 --> -0.937034).  Saving model ...
Epoch: 14 cost time: 0.49559688568115234
Epoch: 14, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.269 Vali Acc: 0.937 Test Loss: 0.269 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 15 cost time: 0.46198058128356934
Epoch: 15, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 16 cost time: 0.48815488815307617
Epoch: 16, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.5730507373809814
Epoch: 17, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.54469895362854
Epoch: 18, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.5416009426116943
Epoch: 19, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.5300099849700928
Epoch: 20, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.4917123317718506
Epoch: 21, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.5033347606658936
Epoch: 22, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5774078369140625
Epoch: 23, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.47127199172973633
Epoch: 24, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.541649341583252
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4769134521484375
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5021305084228516
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.926 Test Loss: 0.179 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5964710712432861
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.926 Test Loss: 0.179 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5504469871520996
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.926 Test Loss: 0.179 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5080204010009766
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.926 Test Loss: 0.179 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5321173667907715
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 200966
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.118135690689087
Epoch: 1, Steps: 2 | Train Loss: 2.174 Vali Loss: 1.940 Vali Acc: 0.152 Test Loss: 1.940 Test Acc: 0.152
Validation loss decreased (inf --> -0.151832).  Saving model ...
Epoch: 2 cost time: 0.5699634552001953
Epoch: 2, Steps: 2 | Train Loss: 1.988 Vali Loss: 1.841 Vali Acc: 0.196 Test Loss: 1.841 Test Acc: 0.196
Validation loss decreased (-0.151832 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.503040075302124
Epoch: 3, Steps: 2 | Train Loss: 1.967 Vali Loss: 1.737 Vali Acc: 0.256 Test Loss: 1.737 Test Acc: 0.256
Validation loss decreased (-0.196278 --> -0.255538).  Saving model ...
Epoch: 4 cost time: 0.5704009532928467
Epoch: 4, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.590 Vali Acc: 0.370 Test Loss: 1.590 Test Acc: 0.370
Validation loss decreased (-0.255538 --> -0.370354).  Saving model ...
Epoch: 5 cost time: 0.5461344718933105
Epoch: 5, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.415 Vali Acc: 0.574 Test Loss: 1.415 Test Acc: 0.574
Validation loss decreased (-0.370354 --> -0.574060).  Saving model ...
Epoch: 6 cost time: 0.5637919902801514
Epoch: 6, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.233 Vali Acc: 0.737 Test Loss: 1.233 Test Acc: 0.737
Validation loss decreased (-0.574060 --> -0.737025).  Saving model ...
Epoch: 7 cost time: 0.5616457462310791
Epoch: 7, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.055 Vali Acc: 0.785 Test Loss: 1.055 Test Acc: 0.785
Validation loss decreased (-0.737025 --> -0.785175).  Saving model ...
Epoch: 8 cost time: 0.5809409618377686
Epoch: 8, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.896 Vali Acc: 0.796 Test Loss: 0.896 Test Acc: 0.796
Validation loss decreased (-0.785175 --> -0.796287).  Saving model ...
Epoch: 9 cost time: 0.5060703754425049
Epoch: 9, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.759 Vali Acc: 0.822 Test Loss: 0.759 Test Acc: 0.822
Validation loss decreased (-0.796287 --> -0.822215).  Saving model ...
Epoch: 10 cost time: 0.6183855533599854
Epoch: 10, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.640 Vali Acc: 0.841 Test Loss: 0.640 Test Acc: 0.841
Validation loss decreased (-0.822215 --> -0.840734).  Saving model ...
Epoch: 11 cost time: 0.5550787448883057
Epoch: 11, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.542 Vali Acc: 0.885 Test Loss: 0.542 Test Acc: 0.885
Validation loss decreased (-0.840734 --> -0.885180).  Saving model ...
Epoch: 12 cost time: 0.5670311450958252
Epoch: 12, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.466 Vali Acc: 0.911 Test Loss: 0.466 Test Acc: 0.911
Validation loss decreased (-0.885180 --> -0.911106).  Saving model ...
Epoch: 13 cost time: 0.4927940368652344
Epoch: 13, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.405 Vali Acc: 0.930 Test Loss: 0.405 Test Acc: 0.930
Validation loss decreased (-0.911106 --> -0.929626).  Saving model ...
Epoch: 14 cost time: 0.5152337551116943
Epoch: 14, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.351 Vali Acc: 0.933 Test Loss: 0.351 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 15 cost time: 0.6359858512878418
Epoch: 15, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.311 Vali Acc: 0.933 Test Loss: 0.311 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 0.6029200553894043
Epoch: 16, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6141824722290039
Epoch: 17, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6151630878448486
Epoch: 18, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.501129150390625
Epoch: 19, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5881748199462891
Epoch: 20, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5743017196655273
Epoch: 21, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.5766458511352539
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.6176011562347412
Epoch: 23, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.5656530857086182
Epoch: 24, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.5504121780395508
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.5483663082122803
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5296452045440674
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.598649263381958
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6750919818878174
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6332962512969971
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.47460317611694336
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5097212791442871
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6985170841217041
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6915266513824463
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5994846820831299
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 182790
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9663550853729248
Epoch: 1, Steps: 2 | Train Loss: 2.095 Vali Loss: 1.916 Vali Acc: 0.167 Test Loss: 1.916 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.41889142990112305
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.818 Vali Acc: 0.178 Test Loss: 1.818 Test Acc: 0.178
Validation loss decreased (-0.166648 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.5184743404388428
Epoch: 3, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.725 Vali Acc: 0.196 Test Loss: 1.725 Test Acc: 0.196
Validation loss decreased (-0.177760 --> -0.196279).  Saving model ...
Epoch: 4 cost time: 0.4929695129394531
Epoch: 4, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.601 Vali Acc: 0.311 Test Loss: 1.601 Test Acc: 0.311
Validation loss decreased (-0.196279 --> -0.311095).  Saving model ...
Epoch: 5 cost time: 0.43492746353149414
Epoch: 5, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.450 Vali Acc: 0.452 Test Loss: 1.450 Test Acc: 0.452
Validation loss decreased (-0.311095 --> -0.451837).  Saving model ...
Epoch: 6 cost time: 0.4029684066772461
Epoch: 6, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.285 Vali Acc: 0.574 Test Loss: 1.285 Test Acc: 0.574
Validation loss decreased (-0.451837 --> -0.574061).  Saving model ...
Epoch: 7 cost time: 0.48969340324401855
Epoch: 7, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.119 Vali Acc: 0.748 Test Loss: 1.119 Test Acc: 0.748
Validation loss decreased (-0.574061 --> -0.748137).  Saving model ...
Epoch: 8 cost time: 0.4787003993988037
Epoch: 8, Steps: 2 | Train Loss: 0.980 Vali Loss: 0.965 Vali Acc: 0.793 Test Loss: 0.965 Test Acc: 0.793
Validation loss decreased (-0.748137 --> -0.792583).  Saving model ...
Epoch: 9 cost time: 0.45806312561035156
Epoch: 9, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.827 Vali Acc: 0.848 Test Loss: 0.827 Test Acc: 0.848
Validation loss decreased (-0.792583 --> -0.848140).  Saving model ...
Epoch: 10 cost time: 0.49519968032836914
Epoch: 10, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.709 Vali Acc: 0.870 Test Loss: 0.709 Test Acc: 0.870
Validation loss decreased (-0.848140 --> -0.870363).  Saving model ...
Epoch: 11 cost time: 0.46895503997802734
Epoch: 11, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.608 Vali Acc: 0.893 Test Loss: 0.608 Test Acc: 0.893
Validation loss decreased (-0.870363 --> -0.892587).  Saving model ...
Epoch: 12 cost time: 0.4927175045013428
Epoch: 12, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.525 Vali Acc: 0.919 Test Loss: 0.525 Test Acc: 0.919
Validation loss decreased (-0.892587 --> -0.918513).  Saving model ...
Epoch: 13 cost time: 0.482924222946167
Epoch: 13, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.462 Vali Acc: 0.915 Test Loss: 0.462 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4173116683959961
Epoch: 14, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.407 Vali Acc: 0.919 Test Loss: 0.407 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 15 cost time: 0.4548039436340332
Epoch: 15, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.362 Vali Acc: 0.919 Test Loss: 0.362 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 16 cost time: 0.540184497833252
Epoch: 16, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.323 Vali Acc: 0.919 Test Loss: 0.323 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 17 cost time: 0.46221303939819336
Epoch: 17, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 18 cost time: 0.4127194881439209
Epoch: 18, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 19 cost time: 0.4776277542114258
Epoch: 19, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4804956912994385
Epoch: 20, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.225 Vali Acc: 0.919 Test Loss: 0.225 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7027480602264404
Epoch: 21, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.5820071697235107
Epoch: 22, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.6065011024475098
Epoch: 23, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.6099035739898682
Epoch: 24, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.5939381122589111
Epoch: 25, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.6229453086853027
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.6206421852111816
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.43813252449035645
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6274447441101074
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.601449728012085
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6343119144439697
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5669589042663574
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5358388423919678
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.5958735942840576
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.63224196434021
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.4910612106323242
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.8086957931518555
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.6118552684783936
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.5150132179260254
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6492314338684082
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.602165699005127
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6271278858184814
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5714097023010254
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.937 Test Loss: 0.167 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6320576667785645
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.937 Test Loss: 0.167 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6125414371490479
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6344149112701416
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.632380485534668
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6769022941589355
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 173958
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.130979061126709
Epoch: 1, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.708 Vali Acc: 0.270 Test Loss: 1.708 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 0.4920616149902344
Epoch: 2, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.634 Vali Acc: 0.333 Test Loss: 1.634 Test Acc: 0.333
Validation loss decreased (-0.270353 --> -0.333317).  Saving model ...
Epoch: 3 cost time: 0.47818946838378906
Epoch: 3, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.567 Vali Acc: 0.411 Test Loss: 1.567 Test Acc: 0.411
Validation loss decreased (-0.333317 --> -0.411095).  Saving model ...
Epoch: 4 cost time: 0.4765956401824951
Epoch: 4, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.482 Vali Acc: 0.530 Test Loss: 1.482 Test Acc: 0.530
Validation loss decreased (-0.411095 --> -0.529615).  Saving model ...
Epoch: 5 cost time: 0.45159244537353516
Epoch: 5, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.378 Vali Acc: 0.630 Test Loss: 1.378 Test Acc: 0.630
Validation loss decreased (-0.529615 --> -0.629616).  Saving model ...
Epoch: 6 cost time: 0.4621140956878662
Epoch: 6, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.262 Vali Acc: 0.674 Test Loss: 1.262 Test Acc: 0.674
Validation loss decreased (-0.629616 --> -0.674061).  Saving model ...
Epoch: 7 cost time: 0.5098776817321777
Epoch: 7, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.142 Vali Acc: 0.719 Test Loss: 1.142 Test Acc: 0.719
Validation loss decreased (-0.674061 --> -0.718507).  Saving model ...
Epoch: 8 cost time: 0.47856569290161133
Epoch: 8, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.024 Vali Acc: 0.763 Test Loss: 1.024 Test Acc: 0.763
Validation loss decreased (-0.718507 --> -0.762953).  Saving model ...
Epoch: 9 cost time: 0.5590338706970215
Epoch: 9, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.912 Vali Acc: 0.789 Test Loss: 0.912 Test Acc: 0.789
Validation loss decreased (-0.762953 --> -0.788880).  Saving model ...
Epoch: 10 cost time: 0.4635615348815918
Epoch: 10, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.812 Vali Acc: 0.811 Test Loss: 0.812 Test Acc: 0.811
Validation loss decreased (-0.788880 --> -0.811103).  Saving model ...
Epoch: 11 cost time: 0.5663306713104248
Epoch: 11, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.727 Vali Acc: 0.819 Test Loss: 0.727 Test Acc: 0.819
Validation loss decreased (-0.811103 --> -0.818511).  Saving model ...
Epoch: 12 cost time: 0.4877126216888428
Epoch: 12, Steps: 2 | Train Loss: 0.575 Vali Loss: 0.647 Vali Acc: 0.841 Test Loss: 0.647 Test Acc: 0.841
Validation loss decreased (-0.818511 --> -0.840734).  Saving model ...
Epoch: 13 cost time: 0.5247817039489746
Epoch: 13, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.576 Vali Acc: 0.870 Test Loss: 0.576 Test Acc: 0.870
Validation loss decreased (-0.840734 --> -0.870365).  Saving model ...
Epoch: 14 cost time: 0.5823273658752441
Epoch: 14, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.513 Vali Acc: 0.885 Test Loss: 0.513 Test Acc: 0.885
Validation loss decreased (-0.870365 --> -0.885180).  Saving model ...
Epoch: 15 cost time: 0.4480016231536865
Epoch: 15, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.461 Vali Acc: 0.893 Test Loss: 0.461 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892588).  Saving model ...
Epoch: 16 cost time: 0.4511566162109375
Epoch: 16, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.416 Vali Acc: 0.904 Test Loss: 0.416 Test Acc: 0.904
Validation loss decreased (-0.892588 --> -0.903700).  Saving model ...
Epoch: 17 cost time: 0.4841880798339844
Epoch: 17, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.376 Vali Acc: 0.911 Test Loss: 0.376 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911107).  Saving model ...
Epoch: 18 cost time: 0.5047996044158936
Epoch: 18, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 19 cost time: 0.45266008377075195
Epoch: 19, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.319 Vali Acc: 0.922 Test Loss: 0.319 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 20 cost time: 0.478299617767334
Epoch: 20, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 0.49912452697753906
Epoch: 21, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.5602712631225586
Epoch: 22, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.270 Vali Acc: 0.915 Test Loss: 0.270 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5133414268493652
Epoch: 23, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.258 Vali Acc: 0.919 Test Loss: 0.258 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5226578712463379
Epoch: 24, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 0.5105934143066406
Epoch: 25, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 0.4129159450531006
Epoch: 26, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.5049865245819092
Epoch: 27, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 0.4767296314239502
Epoch: 28, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.5026612281799316
Epoch: 29, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.5132942199707031
Epoch: 30, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.4621865749359131
Epoch: 31, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.47876477241516113
Epoch: 32, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.47208738327026367
Epoch: 33, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.5690350532531738
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.48885464668273926
Epoch: 35, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.38565897941589355
Epoch: 36, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5542523860931396
Epoch: 37, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5678060054779053
Epoch: 38, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.478104829788208
Epoch: 39, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5785720348358154
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.43314456939697266
Epoch: 41, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5279414653778076
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6861469745635986
Epoch: 43, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 162054
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1360855102539062
Epoch: 1, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.920 Vali Acc: 0.244 Test Loss: 1.920 Test Acc: 0.244
Validation loss decreased (inf --> -0.244425).  Saving model ...
Epoch: 2 cost time: 0.5755734443664551
Epoch: 2, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.831 Vali Acc: 0.274 Test Loss: 1.831 Test Acc: 0.274
Validation loss decreased (-0.244425 --> -0.274056).  Saving model ...
Epoch: 3 cost time: 0.4868800640106201
Epoch: 3, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.757 Vali Acc: 0.285 Test Loss: 1.757 Test Acc: 0.285
Validation loss decreased (-0.274056 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.5060255527496338
Epoch: 4, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.670 Vali Acc: 0.370 Test Loss: 1.670 Test Acc: 0.370
Validation loss decreased (-0.285168 --> -0.370354).  Saving model ...
Epoch: 5 cost time: 0.44159555435180664
Epoch: 5, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.568 Vali Acc: 0.433 Test Loss: 1.568 Test Acc: 0.433
Validation loss decreased (-0.370354 --> -0.433318).  Saving model ...
Epoch: 6 cost time: 0.494002103805542
Epoch: 6, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.456 Vali Acc: 0.537 Test Loss: 1.456 Test Acc: 0.537
Validation loss decreased (-0.433318 --> -0.537022).  Saving model ...
Epoch: 7 cost time: 0.5091700553894043
Epoch: 7, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.336 Vali Acc: 0.585 Test Loss: 1.336 Test Acc: 0.585
Validation loss decreased (-0.537022 --> -0.585172).  Saving model ...
Epoch: 8 cost time: 0.4412097930908203
Epoch: 8, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.215 Vali Acc: 0.648 Test Loss: 1.215 Test Acc: 0.648
Validation loss decreased (-0.585172 --> -0.648136).  Saving model ...
Epoch: 9 cost time: 0.5502934455871582
Epoch: 9, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.096 Vali Acc: 0.719 Test Loss: 1.096 Test Acc: 0.719
Validation loss decreased (-0.648136 --> -0.718508).  Saving model ...
Epoch: 10 cost time: 0.4970376491546631
Epoch: 10, Steps: 2 | Train Loss: 1.003 Vali Loss: 0.983 Vali Acc: 0.789 Test Loss: 0.983 Test Acc: 0.789
Validation loss decreased (-0.718508 --> -0.788879).  Saving model ...
Epoch: 11 cost time: 0.5600953102111816
Epoch: 11, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.878 Vali Acc: 0.833 Test Loss: 0.878 Test Acc: 0.833
Validation loss decreased (-0.788879 --> -0.833325).  Saving model ...
Epoch: 12 cost time: 0.47070884704589844
Epoch: 12, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.783 Vali Acc: 0.870 Test Loss: 0.783 Test Acc: 0.870
Validation loss decreased (-0.833325 --> -0.870363).  Saving model ...
Epoch: 13 cost time: 0.5343458652496338
Epoch: 13, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.701 Vali Acc: 0.907 Test Loss: 0.701 Test Acc: 0.907
Validation loss decreased (-0.870363 --> -0.907400).  Saving model ...
Epoch: 14 cost time: 0.535639762878418
Epoch: 14, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.627 Vali Acc: 0.907 Test Loss: 0.627 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 15 cost time: 0.46607398986816406
Epoch: 15, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.563 Vali Acc: 0.919 Test Loss: 0.563 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 16 cost time: 0.6081054210662842
Epoch: 16, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.508 Vali Acc: 0.926 Test Loss: 0.508 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 17 cost time: 0.5499842166900635
Epoch: 17, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.460 Vali Acc: 0.933 Test Loss: 0.460 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 18 cost time: 0.5759224891662598
Epoch: 18, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.419 Vali Acc: 0.937 Test Loss: 0.419 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 19 cost time: 0.48816466331481934
Epoch: 19, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.384 Vali Acc: 0.941 Test Loss: 0.384 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 20 cost time: 0.5704877376556396
Epoch: 20, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.352 Vali Acc: 0.948 Test Loss: 0.352 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 21 cost time: 0.5242245197296143
Epoch: 21, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.326 Vali Acc: 0.952 Test Loss: 0.326 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 22 cost time: 0.5112547874450684
Epoch: 22, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.305 Vali Acc: 0.948 Test Loss: 0.305 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5783824920654297
Epoch: 23, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.287 Vali Acc: 0.948 Test Loss: 0.287 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5274226665496826
Epoch: 24, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.271 Vali Acc: 0.948 Test Loss: 0.271 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4728713035583496
Epoch: 25, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5305325984954834
Epoch: 26, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5123662948608398
Epoch: 27, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.468538761138916
Epoch: 28, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6002285480499268
Epoch: 29, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5491440296173096
Epoch: 30, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.49954915046691895
Epoch: 31, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 156422
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.198840856552124
Epoch: 1, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.692 Vali Acc: 0.259 Test Loss: 1.692 Test Acc: 0.259
Validation loss decreased (inf --> -0.259242).  Saving model ...
Epoch: 2 cost time: 0.6621017456054688
Epoch: 2, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.500 Vali Acc: 0.400 Test Loss: 1.500 Test Acc: 0.400
Validation loss decreased (-0.259242 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 0.5396597385406494
Epoch: 3, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.249 Vali Acc: 0.644 Test Loss: 1.249 Test Acc: 0.644
Validation loss decreased (-0.399985 --> -0.644432).  Saving model ...
Epoch: 4 cost time: 0.5046103000640869
Epoch: 4, Steps: 2 | Train Loss: 1.130 Vali Loss: 0.918 Vali Acc: 0.811 Test Loss: 0.918 Test Acc: 0.811
Validation loss decreased (-0.644432 --> -0.811102).  Saving model ...
Epoch: 5 cost time: 0.5205986499786377
Epoch: 5, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.664 Vali Acc: 0.863 Test Loss: 0.664 Test Acc: 0.863
Validation loss decreased (-0.811102 --> -0.862956).  Saving model ...
Epoch: 6 cost time: 0.5156424045562744
Epoch: 6, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.500 Vali Acc: 0.848 Test Loss: 0.500 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5825140476226807
Epoch: 7, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.369 Vali Acc: 0.911 Test Loss: 0.369 Test Acc: 0.911
Validation loss decreased (-0.862956 --> -0.911107).  Saving model ...
Epoch: 8 cost time: 0.5885496139526367
Epoch: 8, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918516).  Saving model ...
Epoch: 9 cost time: 0.4891688823699951
Epoch: 9, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.918516 --> -0.933331).  Saving model ...
Epoch: 10 cost time: 0.5825333595275879
Epoch: 10, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 11 cost time: 0.5156495571136475
Epoch: 11, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.194 Vali Acc: 0.926 Test Loss: 0.194 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5366966724395752
Epoch: 12, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6905825138092041
Epoch: 13, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5262699127197266
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6002998352050781
Epoch: 15, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5360021591186523
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.926 Test Loss: 0.186 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5571260452270508
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5378682613372803
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5021281242370605
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5510735511779785
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 299782
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1466517448425293
Epoch: 1, Steps: 2 | Train Loss: 2.101 Vali Loss: 1.924 Vali Acc: 0.126 Test Loss: 1.924 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 0.5981037616729736
Epoch: 2, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.797 Vali Acc: 0.196 Test Loss: 1.797 Test Acc: 0.196
Validation loss decreased (-0.125907 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.5083498954772949
Epoch: 3, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.638 Vali Acc: 0.285 Test Loss: 1.638 Test Acc: 0.285
Validation loss decreased (-0.196278 --> -0.285169).  Saving model ...
Epoch: 4 cost time: 0.5508477687835693
Epoch: 4, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.386 Vali Acc: 0.593 Test Loss: 1.386 Test Acc: 0.593
Validation loss decreased (-0.285169 --> -0.592579).  Saving model ...
Epoch: 5 cost time: 0.5392653942108154
Epoch: 5, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.121 Vali Acc: 0.681 Test Loss: 1.121 Test Acc: 0.681
Validation loss decreased (-0.592579 --> -0.681470).  Saving model ...
Epoch: 6 cost time: 0.6240723133087158
Epoch: 6, Steps: 2 | Train Loss: 1.013 Vali Loss: 0.890 Vali Acc: 0.774 Test Loss: 0.890 Test Acc: 0.774
Validation loss decreased (-0.681470 --> -0.774065).  Saving model ...
Epoch: 7 cost time: 0.44402456283569336
Epoch: 7, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.707 Vali Acc: 0.830 Test Loss: 0.707 Test Acc: 0.830
Validation loss decreased (-0.774065 --> -0.829623).  Saving model ...
Epoch: 8 cost time: 0.5129663944244385
Epoch: 8, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.561 Vali Acc: 0.870 Test Loss: 0.561 Test Acc: 0.870
Validation loss decreased (-0.829623 --> -0.870365).  Saving model ...
Epoch: 9 cost time: 0.49627113342285156
Epoch: 9, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.451 Vali Acc: 0.907 Test Loss: 0.451 Test Acc: 0.907
Validation loss decreased (-0.870365 --> -0.907403).  Saving model ...
Epoch: 10 cost time: 0.5320260524749756
Epoch: 10, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.375 Vali Acc: 0.907 Test Loss: 0.375 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 11 cost time: 0.5581440925598145
Epoch: 11, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.314 Vali Acc: 0.930 Test Loss: 0.314 Test Acc: 0.930
Validation loss decreased (-0.907404 --> -0.929626).  Saving model ...
Epoch: 12 cost time: 0.6188509464263916
Epoch: 12, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.269 Vali Acc: 0.933 Test Loss: 0.269 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933331).  Saving model ...
Epoch: 13 cost time: 0.5785095691680908
Epoch: 13, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 14 cost time: 0.5038614273071289
Epoch: 14, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5236830711364746
Epoch: 15, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 16 cost time: 0.5850684642791748
Epoch: 16, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5871853828430176
Epoch: 17, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6375741958618164
Epoch: 18, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5559966564178467
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6654443740844727
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.5335159301757812
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6045465469360352
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.6061899662017822
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.552778959274292
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.4817240238189697
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.547187328338623
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.44977807998657227
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.596827507019043
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5776395797729492
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.51481032371521
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5320756435394287
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5776443481445312
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.46368956565856934
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5966947078704834
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6071949005126953
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 198662
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2256662845611572
Epoch: 1, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.751 Vali Acc: 0.170 Test Loss: 1.751 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.6248528957366943
Epoch: 2, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.653 Vali Acc: 0.278 Test Loss: 1.653 Test Acc: 0.278
Validation loss decreased (-0.170353 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.5263476371765137
Epoch: 3, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.540 Vali Acc: 0.404 Test Loss: 1.540 Test Acc: 0.404
Validation loss decreased (-0.277761 --> -0.403688).  Saving model ...
Epoch: 4 cost time: 0.46502041816711426
Epoch: 4, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.374 Vali Acc: 0.581 Test Loss: 1.374 Test Acc: 0.581
Validation loss decreased (-0.403688 --> -0.581468).  Saving model ...
Epoch: 5 cost time: 0.6691854000091553
Epoch: 5, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.185 Vali Acc: 0.707 Test Loss: 1.185 Test Acc: 0.707
Validation loss decreased (-0.581468 --> -0.707396).  Saving model ...
Epoch: 6 cost time: 0.566939115524292
Epoch: 6, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.002 Vali Acc: 0.748 Test Loss: 1.002 Test Acc: 0.748
Validation loss decreased (-0.707396 --> -0.748138).  Saving model ...
Epoch: 7 cost time: 0.5456581115722656
Epoch: 7, Steps: 2 | Train Loss: 0.802 Vali Loss: 0.840 Vali Acc: 0.763 Test Loss: 0.840 Test Acc: 0.763
Validation loss decreased (-0.748138 --> -0.762955).  Saving model ...
Epoch: 8 cost time: 0.4893455505371094
Epoch: 8, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.711 Vali Acc: 0.800 Test Loss: 0.711 Test Acc: 0.800
Validation loss decreased (-0.762955 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 0.4939861297607422
Epoch: 9, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
Validation loss decreased (-0.799993 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 0.5190274715423584
Epoch: 10, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855551).  Saving model ...
Epoch: 11 cost time: 0.5683283805847168
Epoch: 11, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.424 Vali Acc: 0.878 Test Loss: 0.424 Test Acc: 0.878
Validation loss decreased (-0.855551 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 0.6100187301635742
Epoch: 12, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.877774 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 0.5443918704986572
Epoch: 13, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
Validation loss decreased (-0.899996 --> -0.929627).  Saving model ...
Epoch: 14 cost time: 0.4960908889770508
Epoch: 14, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 15 cost time: 0.4996299743652344
Epoch: 15, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.510591983795166
Epoch: 16, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.5395901203155518
Epoch: 17, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.5671920776367188
Epoch: 18, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 19 cost time: 0.6355793476104736
Epoch: 19, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.5548074245452881
Epoch: 20, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.5192673206329346
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5934531688690186
Epoch: 22, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.167 Vali Acc: 0.937 Test Loss: 0.167 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5808992385864258
Epoch: 23, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.164 Vali Acc: 0.937 Test Loss: 0.164 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5562953948974609
Epoch: 24, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.937 Test Loss: 0.163 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6073126792907715
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.933 Test Loss: 0.162 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5778758525848389
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.933 Test Loss: 0.162 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5789957046508789
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.933 Test Loss: 0.162 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5909533500671387
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.937 Test Loss: 0.164 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5013422966003418
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.937 Test Loss: 0.165 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5911929607391357
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.937 Test Loss: 0.166 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 168070
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.236966848373413
Epoch: 1, Steps: 2 | Train Loss: 2.071 Vali Loss: 1.978 Vali Acc: 0.204 Test Loss: 1.978 Test Acc: 0.204
Validation loss decreased (inf --> -0.203684).  Saving model ...
Epoch: 2 cost time: 0.5934991836547852
Epoch: 2, Steps: 2 | Train Loss: 2.070 Vali Loss: 1.874 Vali Acc: 0.233 Test Loss: 1.874 Test Acc: 0.233
Validation loss decreased (-0.203684 --> -0.233315).  Saving model ...
Epoch: 3 cost time: 0.5695061683654785
Epoch: 3, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.769 Vali Acc: 0.278 Test Loss: 1.769 Test Acc: 0.278
Validation loss decreased (-0.233315 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 0.6395289897918701
Epoch: 4, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.626 Vali Acc: 0.348 Test Loss: 1.626 Test Acc: 0.348
Validation loss decreased (-0.277760 --> -0.348132).  Saving model ...
Epoch: 5 cost time: 0.6348052024841309
Epoch: 5, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.453 Vali Acc: 0.504 Test Loss: 1.453 Test Acc: 0.504
Validation loss decreased (-0.348132 --> -0.503689).  Saving model ...
Epoch: 6 cost time: 0.5205533504486084
Epoch: 6, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.270 Vali Acc: 0.644 Test Loss: 1.270 Test Acc: 0.644
Validation loss decreased (-0.503689 --> -0.644432).  Saving model ...
Epoch: 7 cost time: 0.5810799598693848
Epoch: 7, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.094 Vali Acc: 0.711 Test Loss: 1.094 Test Acc: 0.711
Validation loss decreased (-0.644432 --> -0.711100).  Saving model ...
Epoch: 8 cost time: 0.6506364345550537
Epoch: 8, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.935 Vali Acc: 0.756 Test Loss: 0.935 Test Acc: 0.756
Validation loss decreased (-0.711100 --> -0.755546).  Saving model ...
Epoch: 9 cost time: 0.520167350769043
Epoch: 9, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.794 Vali Acc: 0.804 Test Loss: 0.794 Test Acc: 0.804
Validation loss decreased (-0.755546 --> -0.803696).  Saving model ...
Epoch: 10 cost time: 0.5581119060516357
Epoch: 10, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.670 Vali Acc: 0.859 Test Loss: 0.670 Test Acc: 0.859
Validation loss decreased (-0.803696 --> -0.859253).  Saving model ...
Epoch: 11 cost time: 0.5888652801513672
Epoch: 11, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
Validation loss decreased (-0.859253 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.589935302734375
Epoch: 12, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.487 Vali Acc: 0.919 Test Loss: 0.487 Test Acc: 0.919
Validation loss decreased (-0.899994 --> -0.918514).  Saving model ...
Epoch: 13 cost time: 0.5680751800537109
Epoch: 13, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.422 Vali Acc: 0.922 Test Loss: 0.422 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 14 cost time: 0.517716646194458
Epoch: 14, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.367 Vali Acc: 0.930 Test Loss: 0.367 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 15 cost time: 0.47809720039367676
Epoch: 15, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 0.49960994720458984
Epoch: 16, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.6645584106445312
Epoch: 17, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 18 cost time: 0.5682311058044434
Epoch: 18, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 19 cost time: 0.5221750736236572
Epoch: 19, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5097298622131348
Epoch: 20, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5689337253570557
Epoch: 21, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6273257732391357
Epoch: 22, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5977063179016113
Epoch: 23, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5517063140869141
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5905826091766357
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5710444450378418
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5465569496154785
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5814440250396729
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 149894
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1347897052764893
Epoch: 1, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.780 Vali Acc: 0.222 Test Loss: 1.780 Test Acc: 0.222
Validation loss decreased (inf --> -0.222204).  Saving model ...
Epoch: 2 cost time: 0.498490571975708
Epoch: 2, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.692 Vali Acc: 0.270 Test Loss: 1.692 Test Acc: 0.270
Validation loss decreased (-0.222204 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.5100841522216797
Epoch: 3, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.607 Vali Acc: 0.359 Test Loss: 1.607 Test Acc: 0.359
Validation loss decreased (-0.270353 --> -0.359243).  Saving model ...
Epoch: 4 cost time: 0.5240671634674072
Epoch: 4, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.495 Vali Acc: 0.485 Test Loss: 1.495 Test Acc: 0.485
Validation loss decreased (-0.359243 --> -0.485170).  Saving model ...
Epoch: 5 cost time: 0.5420293807983398
Epoch: 5, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.360 Vali Acc: 0.578 Test Loss: 1.360 Test Acc: 0.578
Validation loss decreased (-0.485170 --> -0.577764).  Saving model ...
Epoch: 6 cost time: 0.5134551525115967
Epoch: 6, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.213 Vali Acc: 0.696 Test Loss: 1.213 Test Acc: 0.696
Validation loss decreased (-0.577764 --> -0.696284).  Saving model ...
Epoch: 7 cost time: 0.5441908836364746
Epoch: 7, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.066 Vali Acc: 0.770 Test Loss: 1.066 Test Acc: 0.770
Validation loss decreased (-0.696284 --> -0.770360).  Saving model ...
Epoch: 8 cost time: 0.5650424957275391
Epoch: 8, Steps: 2 | Train Loss: 0.957 Vali Loss: 0.928 Vali Acc: 0.800 Test Loss: 0.928 Test Acc: 0.800
Validation loss decreased (-0.770360 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.5008337497711182
Epoch: 9, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.803 Vali Acc: 0.848 Test Loss: 0.803 Test Acc: 0.848
Validation loss decreased (-0.799991 --> -0.848140).  Saving model ...
Epoch: 10 cost time: 0.47182393074035645
Epoch: 10, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.695 Vali Acc: 0.867 Test Loss: 0.695 Test Acc: 0.867
Validation loss decreased (-0.848140 --> -0.866660).  Saving model ...
Epoch: 11 cost time: 0.5541844367980957
Epoch: 11, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 12 cost time: 0.5056898593902588
Epoch: 12, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.525 Vali Acc: 0.893 Test Loss: 0.525 Test Acc: 0.893
Validation loss decreased (-0.877772 --> -0.892587).  Saving model ...
Epoch: 13 cost time: 0.5056569576263428
Epoch: 13, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 0.49707722663879395
Epoch: 14, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.410 Vali Acc: 0.911 Test Loss: 0.410 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911107).  Saving model ...
Epoch: 15 cost time: 0.46758365631103516
Epoch: 15, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.369 Vali Acc: 0.915 Test Loss: 0.369 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 16 cost time: 0.5185682773590088
Epoch: 16, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 17 cost time: 0.5324850082397461
Epoch: 17, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 18 cost time: 0.4599180221557617
Epoch: 18, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.296 Vali Acc: 0.915 Test Loss: 0.296 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.555072546005249
Epoch: 19, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.279 Vali Acc: 0.915 Test Loss: 0.279 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6121780872344971
Epoch: 20, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.266 Vali Acc: 0.919 Test Loss: 0.266 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 21 cost time: 0.5327486991882324
Epoch: 21, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 0.534858226776123
Epoch: 22, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.5803754329681396
Epoch: 23, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.5808722972869873
Epoch: 24, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.5342953205108643
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.5030503273010254
Epoch: 26, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.5503287315368652
Epoch: 27, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.5204484462738037
Epoch: 28, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.5411250591278076
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.5353364944458008
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5386772155761719
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5830307006835938
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5562515258789062
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5078094005584717
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5003373622894287
Epoch: 35, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.49365687370300293
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5592942237854004
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.484691858291626
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5487332344055176
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 141062
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1666557788848877
Epoch: 1, Steps: 2 | Train Loss: 2.146 Vali Loss: 1.826 Vali Acc: 0.215 Test Loss: 1.826 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.4812004566192627
Epoch: 2, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.744 Vali Acc: 0.237 Test Loss: 1.744 Test Acc: 0.237
Validation loss decreased (-0.214797 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 0.4703407287597656
Epoch: 3, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.669 Vali Acc: 0.267 Test Loss: 1.669 Test Acc: 0.267
Validation loss decreased (-0.237020 --> -0.266650).  Saving model ...
Epoch: 4 cost time: 0.46811842918395996
Epoch: 4, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.577 Vali Acc: 0.322 Test Loss: 1.577 Test Acc: 0.322
Validation loss decreased (-0.266650 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 0.5274202823638916
Epoch: 5, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.467 Vali Acc: 0.526 Test Loss: 1.467 Test Acc: 0.526
Validation loss decreased (-0.322206 --> -0.525911).  Saving model ...
Epoch: 6 cost time: 0.4813985824584961
Epoch: 6, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.343 Vali Acc: 0.659 Test Loss: 1.343 Test Acc: 0.659
Validation loss decreased (-0.525911 --> -0.659246).  Saving model ...
Epoch: 7 cost time: 0.46233129501342773
Epoch: 7, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.212 Vali Acc: 0.767 Test Loss: 1.212 Test Acc: 0.767
Validation loss decreased (-0.659246 --> -0.766655).  Saving model ...
Epoch: 8 cost time: 0.4764997959136963
Epoch: 8, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.081 Vali Acc: 0.822 Test Loss: 1.081 Test Acc: 0.822
Validation loss decreased (-0.766655 --> -0.822211).  Saving model ...
Epoch: 9 cost time: 0.5193603038787842
Epoch: 9, Steps: 2 | Train Loss: 0.958 Vali Loss: 0.957 Vali Acc: 0.844 Test Loss: 0.957 Test Acc: 0.844
Validation loss decreased (-0.822211 --> -0.844435).  Saving model ...
Epoch: 10 cost time: 0.4711623191833496
Epoch: 10, Steps: 2 | Train Loss: 0.848 Vali Loss: 0.844 Vali Acc: 0.852 Test Loss: 0.844 Test Acc: 0.852
Validation loss decreased (-0.844435 --> -0.851843).  Saving model ...
Epoch: 11 cost time: 0.5317838191986084
Epoch: 11, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.744 Vali Acc: 0.863 Test Loss: 0.744 Test Acc: 0.863
Validation loss decreased (-0.851843 --> -0.862956).  Saving model ...
Epoch: 12 cost time: 0.4863598346710205
Epoch: 12, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.655 Vali Acc: 0.863 Test Loss: 0.655 Test Acc: 0.863
Validation loss decreased (-0.862956 --> -0.862956).  Saving model ...
Epoch: 13 cost time: 0.46047544479370117
Epoch: 13, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.580 Vali Acc: 0.874 Test Loss: 0.580 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874068).  Saving model ...
Epoch: 14 cost time: 0.467573881149292
Epoch: 14, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
Validation loss decreased (-0.874068 --> -0.888884).  Saving model ...
Epoch: 15 cost time: 0.4178903102874756
Epoch: 15, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.460 Vali Acc: 0.904 Test Loss: 0.460 Test Acc: 0.904
Validation loss decreased (-0.888884 --> -0.903699).  Saving model ...
Epoch: 16 cost time: 0.5383431911468506
Epoch: 16, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.414 Vali Acc: 0.907 Test Loss: 0.414 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 17 cost time: 0.481586217880249
Epoch: 17, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.375 Vali Acc: 0.907 Test Loss: 0.375 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 18 cost time: 0.4670398235321045
Epoch: 18, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.342 Vali Acc: 0.915 Test Loss: 0.342 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 0.46139955520629883
Epoch: 19, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.312 Vali Acc: 0.919 Test Loss: 0.312 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.4008948802947998
Epoch: 20, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.289 Vali Acc: 0.919 Test Loss: 0.289 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 21 cost time: 0.5257935523986816
Epoch: 21, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.270 Vali Acc: 0.922 Test Loss: 0.270 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 0.4383351802825928
Epoch: 22, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.5342082977294922
Epoch: 23, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 0.45810437202453613
Epoch: 24, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 0.5198829174041748
Epoch: 25, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 26 cost time: 0.49138784408569336
Epoch: 26, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 27 cost time: 0.4297521114349365
Epoch: 27, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 28 cost time: 0.4967796802520752
Epoch: 28, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 29 cost time: 0.5001387596130371
Epoch: 29, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 30 cost time: 0.4936058521270752
Epoch: 30, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 31 cost time: 0.4753901958465576
Epoch: 31, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.4651303291320801
Epoch: 32, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.5397124290466309
Epoch: 33, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.5020325183868408
Epoch: 34, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.48357343673706055
Epoch: 35, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.4939911365509033
Epoch: 36, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 37 cost time: 0.47096943855285645
Epoch: 37, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 38 cost time: 0.5019385814666748
Epoch: 38, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 39 cost time: 0.47103047370910645
Epoch: 39, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 40 cost time: 0.5084717273712158
Epoch: 40, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 41 cost time: 0.6114575862884521
Epoch: 41, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 42 cost time: 0.5110247135162354
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 43 cost time: 0.5190219879150391
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.49622416496276855
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.5094254016876221
Epoch: 45, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.44855690002441406
Epoch: 46, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5154657363891602
Epoch: 47, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.47162461280822754
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5557265281677246
Epoch: 49, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.49880552291870117
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.507922887802124
Epoch: 51, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.44181013107299805
Epoch: 52, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.5106303691864014
Epoch: 53, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5811374187469482
Epoch: 54, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 129158
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2963969707489014
Epoch: 1, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.732 Vali Acc: 0.248 Test Loss: 1.732 Test Acc: 0.248
Validation loss decreased (inf --> -0.248131).  Saving model ...
Epoch: 2 cost time: 0.48685693740844727
Epoch: 2, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.676 Vali Acc: 0.281 Test Loss: 1.676 Test Acc: 0.281
Validation loss decreased (-0.248131 --> -0.281465).  Saving model ...
Epoch: 3 cost time: 0.5313785076141357
Epoch: 3, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.625 Vali Acc: 0.319 Test Loss: 1.625 Test Acc: 0.319
Validation loss decreased (-0.281465 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.4867887496948242
Epoch: 4, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.561 Vali Acc: 0.363 Test Loss: 1.561 Test Acc: 0.363
Validation loss decreased (-0.318502 --> -0.362947).  Saving model ...
Epoch: 5 cost time: 0.5078747272491455
Epoch: 5, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.479 Vali Acc: 0.411 Test Loss: 1.479 Test Acc: 0.411
Validation loss decreased (-0.362947 --> -0.411096).  Saving model ...
Epoch: 6 cost time: 0.49527645111083984
Epoch: 6, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.384 Vali Acc: 0.496 Test Loss: 1.384 Test Acc: 0.496
Validation loss decreased (-0.411096 --> -0.496282).  Saving model ...
Epoch: 7 cost time: 0.4825255870819092
Epoch: 7, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.282 Vali Acc: 0.574 Test Loss: 1.282 Test Acc: 0.574
Validation loss decreased (-0.496282 --> -0.574061).  Saving model ...
Epoch: 8 cost time: 0.49910497665405273
Epoch: 8, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.176 Vali Acc: 0.670 Test Loss: 1.176 Test Acc: 0.670
Validation loss decreased (-0.574061 --> -0.670359).  Saving model ...
Epoch: 9 cost time: 0.4994688034057617
Epoch: 9, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.068 Vali Acc: 0.744 Test Loss: 1.068 Test Acc: 0.744
Validation loss decreased (-0.670359 --> -0.744434).  Saving model ...
Epoch: 10 cost time: 0.4614593982696533
Epoch: 10, Steps: 2 | Train Loss: 0.972 Vali Loss: 0.963 Vali Acc: 0.785 Test Loss: 0.963 Test Acc: 0.785
Validation loss decreased (-0.744434 --> -0.785176).  Saving model ...
Epoch: 11 cost time: 0.49684786796569824
Epoch: 11, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.865 Vali Acc: 0.826 Test Loss: 0.865 Test Acc: 0.826
Validation loss decreased (-0.785176 --> -0.825917).  Saving model ...
Epoch: 12 cost time: 0.4376096725463867
Epoch: 12, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.774 Vali Acc: 0.852 Test Loss: 0.774 Test Acc: 0.852
Validation loss decreased (-0.825917 --> -0.851844).  Saving model ...
Epoch: 13 cost time: 0.4324202537536621
Epoch: 13, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.692 Vali Acc: 0.863 Test Loss: 0.692 Test Acc: 0.863
Validation loss decreased (-0.851844 --> -0.862956).  Saving model ...
Epoch: 14 cost time: 0.5268251895904541
Epoch: 14, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.620 Vali Acc: 0.878 Test Loss: 0.620 Test Acc: 0.878
Validation loss decreased (-0.862956 --> -0.877772).  Saving model ...
Epoch: 15 cost time: 0.4815962314605713
Epoch: 15, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 16 cost time: 0.4725503921508789
Epoch: 16, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.5331110954284668
Epoch: 17, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.454 Vali Acc: 0.919 Test Loss: 0.454 Test Acc: 0.919
Validation loss decreased (-0.899995 --> -0.918514).  Saving model ...
Epoch: 18 cost time: 0.545551061630249
Epoch: 18, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.412 Vali Acc: 0.930 Test Loss: 0.412 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929626).  Saving model ...
Epoch: 19 cost time: 0.5022456645965576
Epoch: 19, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.376 Vali Acc: 0.933 Test Loss: 0.376 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 20 cost time: 0.4766964912414551
Epoch: 20, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.346 Vali Acc: 0.933 Test Loss: 0.346 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 21 cost time: 0.48417043685913086
Epoch: 21, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.318 Vali Acc: 0.941 Test Loss: 0.318 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 22 cost time: 0.4932289123535156
Epoch: 22, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 23 cost time: 0.5034129619598389
Epoch: 23, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.278 Vali Acc: 0.948 Test Loss: 0.278 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 24 cost time: 0.5442280769348145
Epoch: 24, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.263 Vali Acc: 0.948 Test Loss: 0.263 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.534935712814331
Epoch: 25, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.249 Vali Acc: 0.948 Test Loss: 0.249 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.5225825309753418
Epoch: 26, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.236 Vali Acc: 0.948 Test Loss: 0.236 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.5078516006469727
Epoch: 27, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.4385800361633301
Epoch: 28, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.530541181564331
Epoch: 29, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.5387325286865234
Epoch: 30, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.48120594024658203
Epoch: 31, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.4956037998199463
Epoch: 32, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.47847723960876465
Epoch: 33, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.4871866703033447
Epoch: 34, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 0.47009873390197754
Epoch: 35, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.49629807472229004
Epoch: 36, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5262444019317627
Epoch: 37, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4574437141418457
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5391335487365723
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5443739891052246
Epoch: 40, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.4648404121398926
Epoch: 41, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.555030345916748
Epoch: 42, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.49312877655029297
Epoch: 43, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5493054389953613
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 123526
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.050602674484253
Epoch: 1, Steps: 2 | Train Loss: 2.030 Vali Loss: 1.860 Vali Acc: 0.204 Test Loss: 1.860 Test Acc: 0.204
Validation loss decreased (inf --> -0.203685).  Saving model ...
Epoch: 2 cost time: 0.5676665306091309
Epoch: 2, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.655 Vali Acc: 0.441 Test Loss: 1.655 Test Acc: 0.441
Validation loss decreased (-0.203685 --> -0.440724).  Saving model ...
Epoch: 3 cost time: 0.610884428024292
Epoch: 3, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.369 Vali Acc: 0.641 Test Loss: 1.369 Test Acc: 0.641
Validation loss decreased (-0.440724 --> -0.640727).  Saving model ...
Epoch: 4 cost time: 0.6242077350616455
Epoch: 4, Steps: 2 | Train Loss: 1.260 Vali Loss: 0.980 Vali Acc: 0.826 Test Loss: 0.980 Test Acc: 0.826
Validation loss decreased (-0.640727 --> -0.825916).  Saving model ...
Epoch: 5 cost time: 0.5688040256500244
Epoch: 5, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.694 Vali Acc: 0.863 Test Loss: 0.694 Test Acc: 0.863
Validation loss decreased (-0.825916 --> -0.862956).  Saving model ...
Epoch: 6 cost time: 0.555391788482666
Epoch: 6, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.496 Vali Acc: 0.889 Test Loss: 0.496 Test Acc: 0.889
Validation loss decreased (-0.862956 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 0.5410721302032471
Epoch: 7, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.367 Vali Acc: 0.926 Test Loss: 0.367 Test Acc: 0.926
Validation loss decreased (-0.888884 --> -0.925922).  Saving model ...
Epoch: 8 cost time: 0.5829775333404541
Epoch: 8, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 9 cost time: 0.6223983764648438
Epoch: 9, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.240 Vali Acc: 0.919 Test Loss: 0.240 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.55887770652771
Epoch: 10, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.198 Vali Acc: 0.926 Test Loss: 0.198 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.555915355682373
Epoch: 11, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 0.5737011432647705
Epoch: 12, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5290186405181885
Epoch: 13, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6072866916656494
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6664893627166748
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5098984241485596
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5116968154907227
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.926 Test Loss: 0.197 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5083074569702148
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5091619491577148
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6083931922912598
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7263906002044678
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 283334
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1617348194122314
Epoch: 1, Steps: 2 | Train Loss: 2.013 Vali Loss: 2.016 Vali Acc: 0.089 Test Loss: 2.016 Test Acc: 0.089
Validation loss decreased (inf --> -0.088869).  Saving model ...
Epoch: 2 cost time: 0.5188820362091064
Epoch: 2, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.871 Vali Acc: 0.137 Test Loss: 1.871 Test Acc: 0.137
Validation loss decreased (-0.088869 --> -0.137018).  Saving model ...
Epoch: 3 cost time: 0.45486927032470703
Epoch: 3, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.701 Vali Acc: 0.230 Test Loss: 1.701 Test Acc: 0.230
Validation loss decreased (-0.137018 --> -0.229613).  Saving model ...
Epoch: 4 cost time: 0.512955904006958
Epoch: 4, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.436 Vali Acc: 0.485 Test Loss: 1.436 Test Acc: 0.485
Validation loss decreased (-0.229613 --> -0.485171).  Saving model ...
Epoch: 5 cost time: 0.48423051834106445
Epoch: 5, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.153 Vali Acc: 0.719 Test Loss: 1.153 Test Acc: 0.719
Validation loss decreased (-0.485171 --> -0.718507).  Saving model ...
Epoch: 6 cost time: 0.5297763347625732
Epoch: 6, Steps: 2 | Train Loss: 1.045 Vali Loss: 0.907 Vali Acc: 0.819 Test Loss: 0.907 Test Acc: 0.819
Validation loss decreased (-0.718507 --> -0.818509).  Saving model ...
Epoch: 7 cost time: 0.5364978313446045
Epoch: 7, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.715 Vali Acc: 0.863 Test Loss: 0.715 Test Acc: 0.863
Validation loss decreased (-0.818509 --> -0.862956).  Saving model ...
Epoch: 8 cost time: 0.5277366638183594
Epoch: 8, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.578 Vali Acc: 0.881 Test Loss: 0.578 Test Acc: 0.881
Validation loss decreased (-0.862956 --> -0.881476).  Saving model ...
Epoch: 9 cost time: 0.5151469707489014
Epoch: 9, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.472 Vali Acc: 0.896 Test Loss: 0.472 Test Acc: 0.896
Validation loss decreased (-0.881476 --> -0.896292).  Saving model ...
Epoch: 10 cost time: 0.5104231834411621
Epoch: 10, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.385 Vali Acc: 0.933 Test Loss: 0.385 Test Acc: 0.933
Validation loss decreased (-0.896292 --> -0.933329).  Saving model ...
Epoch: 11 cost time: 0.6005313396453857
Epoch: 11, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.324 Vali Acc: 0.926 Test Loss: 0.324 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4635922908782959
Epoch: 12, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5514070987701416
Epoch: 13, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933331).  Saving model ...
Epoch: 14 cost time: 0.5122859477996826
Epoch: 14, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5558598041534424
Epoch: 15, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.573786735534668
Epoch: 16, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.5237011909484863
Epoch: 17, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.5372693538665771
Epoch: 18, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4924941062927246
Epoch: 19, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4939894676208496
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5115118026733398
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.534914493560791
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5117089748382568
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.49816036224365234
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5343418121337891
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5281186103820801
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5046401023864746
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6128413677215576
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.49225854873657227
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5957891941070557
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5215656757354736
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5403509140014648
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.4613969326019287
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 182214
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0330381393432617
Epoch: 1, Steps: 2 | Train Loss: 2.114 Vali Loss: 1.904 Vali Acc: 0.107 Test Loss: 1.904 Test Acc: 0.107
Validation loss decreased (inf --> -0.107388).  Saving model ...
Epoch: 2 cost time: 0.5217430591583252
Epoch: 2, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.798 Vali Acc: 0.196 Test Loss: 1.798 Test Acc: 0.196
Validation loss decreased (-0.107388 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.4691004753112793
Epoch: 3, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.678 Vali Acc: 0.278 Test Loss: 1.678 Test Acc: 0.278
Validation loss decreased (-0.196278 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 0.5188131332397461
Epoch: 4, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.503 Vali Acc: 0.426 Test Loss: 1.503 Test Acc: 0.426
Validation loss decreased (-0.277761 --> -0.425911).  Saving model ...
Epoch: 5 cost time: 0.4831728935241699
Epoch: 5, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.298 Vali Acc: 0.615 Test Loss: 1.298 Test Acc: 0.615
Validation loss decreased (-0.425911 --> -0.614802).  Saving model ...
Epoch: 6 cost time: 0.5091133117675781
Epoch: 6, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.091 Vali Acc: 0.752 Test Loss: 1.091 Test Acc: 0.752
Validation loss decreased (-0.614802 --> -0.751841).  Saving model ...
Epoch: 7 cost time: 0.5315573215484619
Epoch: 7, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.904 Vali Acc: 0.837 Test Loss: 0.904 Test Acc: 0.837
Validation loss decreased (-0.751841 --> -0.837028).  Saving model ...
Epoch: 8 cost time: 0.5669224262237549
Epoch: 8, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.742 Vali Acc: 0.878 Test Loss: 0.742 Test Acc: 0.878
Validation loss decreased (-0.837028 --> -0.877770).  Saving model ...
Epoch: 9 cost time: 0.6184489727020264
Epoch: 9, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.611 Vali Acc: 0.900 Test Loss: 0.611 Test Acc: 0.900
Validation loss decreased (-0.877770 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.5302896499633789
Epoch: 10, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.510 Vali Acc: 0.915 Test Loss: 0.510 Test Acc: 0.915
Validation loss decreased (-0.899994 --> -0.914810).  Saving model ...
Epoch: 11 cost time: 0.5659863948822021
Epoch: 11, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.428 Vali Acc: 0.922 Test Loss: 0.428 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 12 cost time: 0.5059976577758789
Epoch: 12, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.361 Vali Acc: 0.933 Test Loss: 0.361 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933330).  Saving model ...
Epoch: 13 cost time: 0.5891256332397461
Epoch: 13, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5562882423400879
Epoch: 14, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6343517303466797
Epoch: 15, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 16 cost time: 0.5817830562591553
Epoch: 16, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.5786688327789307
Epoch: 17, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.937035 --> -0.951850).  Saving model ...
Epoch: 18 cost time: 0.5798511505126953
Epoch: 18, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 19 cost time: 0.6170384883880615
Epoch: 19, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5663309097290039
Epoch: 20, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.49416518211364746
Epoch: 21, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4710702896118164
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5037517547607422
Epoch: 23, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.515500545501709
Epoch: 24, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5653388500213623
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5149009227752686
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5174980163574219
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.547119140625
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 151622
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0171666145324707
Epoch: 1, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.706 Vali Acc: 0.367 Test Loss: 1.706 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 0.524484395980835
Epoch: 2, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.618 Vali Acc: 0.407 Test Loss: 1.618 Test Acc: 0.407
Validation loss decreased (-0.366650 --> -0.407391).  Saving model ...
Epoch: 3 cost time: 0.5233092308044434
Epoch: 3, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.526 Vali Acc: 0.519 Test Loss: 1.526 Test Acc: 0.519
Validation loss decreased (-0.407391 --> -0.518503).  Saving model ...
Epoch: 4 cost time: 0.47556614875793457
Epoch: 4, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.400 Vali Acc: 0.589 Test Loss: 1.400 Test Acc: 0.589
Validation loss decreased (-0.518503 --> -0.588875).  Saving model ...
Epoch: 5 cost time: 0.5179111957550049
Epoch: 5, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.254 Vali Acc: 0.674 Test Loss: 1.254 Test Acc: 0.674
Validation loss decreased (-0.588875 --> -0.674062).  Saving model ...
Epoch: 6 cost time: 0.4403963088989258
Epoch: 6, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.103 Vali Acc: 0.719 Test Loss: 1.103 Test Acc: 0.719
Validation loss decreased (-0.674062 --> -0.718507).  Saving model ...
Epoch: 7 cost time: 0.5138864517211914
Epoch: 7, Steps: 2 | Train Loss: 1.044 Vali Loss: 0.958 Vali Acc: 0.748 Test Loss: 0.958 Test Acc: 0.748
Validation loss decreased (-0.718507 --> -0.748139).  Saving model ...
Epoch: 8 cost time: 0.5601861476898193
Epoch: 8, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.825 Vali Acc: 0.774 Test Loss: 0.825 Test Acc: 0.774
Validation loss decreased (-0.748139 --> -0.774066).  Saving model ...
Epoch: 9 cost time: 0.5190083980560303
Epoch: 9, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.707 Vali Acc: 0.833 Test Loss: 0.707 Test Acc: 0.833
Validation loss decreased (-0.774066 --> -0.833326).  Saving model ...
Epoch: 10 cost time: 0.5312802791595459
Epoch: 10, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
Validation loss decreased (-0.833326 --> -0.866661).  Saving model ...
Epoch: 11 cost time: 0.5235762596130371
Epoch: 11, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 12 cost time: 0.5230920314788818
Epoch: 12, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.466 Vali Acc: 0.896 Test Loss: 0.466 Test Acc: 0.896
Validation loss decreased (-0.877772 --> -0.896292).  Saving model ...
Epoch: 13 cost time: 0.4940769672393799
Epoch: 13, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.45796918869018555
Epoch: 14, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.371 Vali Acc: 0.907 Test Loss: 0.371 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907404).  Saving model ...
Epoch: 15 cost time: 0.4703681468963623
Epoch: 15, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.334 Vali Acc: 0.907 Test Loss: 0.334 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 16 cost time: 0.48366832733154297
Epoch: 16, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.298 Vali Acc: 0.919 Test Loss: 0.298 Test Acc: 0.919
Validation loss decreased (-0.907404 --> -0.918516).  Saving model ...
Epoch: 17 cost time: 0.4787557125091553
Epoch: 17, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
Validation loss decreased (-0.918516 --> -0.929627).  Saving model ...
Epoch: 18 cost time: 0.4974336624145508
Epoch: 18, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.929627 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5802419185638428
Epoch: 19, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.463986873626709
Epoch: 20, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.46912336349487305
Epoch: 21, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.4667365550994873
Epoch: 22, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5370545387268066
Epoch: 23, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5052855014801025
Epoch: 24, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5457549095153809
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.49074316024780273
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5181484222412109
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5258498191833496
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.4873030185699463
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5298879146575928
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6016156673431396
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 133446
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.316534996032715
Epoch: 1, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.735 Vali Acc: 0.244 Test Loss: 1.735 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.48952388763427734
Epoch: 2, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.651 Vali Acc: 0.285 Test Loss: 1.651 Test Acc: 0.285
Validation loss decreased (-0.244427 --> -0.285169).  Saving model ...
Epoch: 3 cost time: 0.49244189262390137
Epoch: 3, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.568 Vali Acc: 0.381 Test Loss: 1.568 Test Acc: 0.381
Validation loss decreased (-0.285169 --> -0.381466).  Saving model ...
Epoch: 4 cost time: 0.4752640724182129
Epoch: 4, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.460 Vali Acc: 0.496 Test Loss: 1.460 Test Acc: 0.496
Validation loss decreased (-0.381466 --> -0.496282).  Saving model ...
Epoch: 5 cost time: 0.4170539379119873
Epoch: 5, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.329 Vali Acc: 0.581 Test Loss: 1.329 Test Acc: 0.581
Validation loss decreased (-0.496282 --> -0.581468).  Saving model ...
Epoch: 6 cost time: 0.5272603034973145
Epoch: 6, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.188 Vali Acc: 0.681 Test Loss: 1.188 Test Acc: 0.681
Validation loss decreased (-0.581468 --> -0.681470).  Saving model ...
Epoch: 7 cost time: 0.4768197536468506
Epoch: 7, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.047 Vali Acc: 0.793 Test Loss: 1.047 Test Acc: 0.793
Validation loss decreased (-0.681470 --> -0.792582).  Saving model ...
Epoch: 8 cost time: 0.4927966594696045
Epoch: 8, Steps: 2 | Train Loss: 0.996 Vali Loss: 0.915 Vali Acc: 0.856 Test Loss: 0.915 Test Acc: 0.856
Validation loss decreased (-0.792582 --> -0.855546).  Saving model ...
Epoch: 9 cost time: 0.40339159965515137
Epoch: 9, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.796 Vali Acc: 0.885 Test Loss: 0.796 Test Acc: 0.885
Validation loss decreased (-0.855546 --> -0.885177).  Saving model ...
Epoch: 10 cost time: 0.4295318126678467
Epoch: 10, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.692 Vali Acc: 0.896 Test Loss: 0.692 Test Acc: 0.896
Validation loss decreased (-0.885177 --> -0.896289).  Saving model ...
Epoch: 11 cost time: 0.41780591011047363
Epoch: 11, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.606 Vali Acc: 0.919 Test Loss: 0.606 Test Acc: 0.919
Validation loss decreased (-0.896289 --> -0.918512).  Saving model ...
Epoch: 12 cost time: 0.4864387512207031
Epoch: 12, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.531 Vali Acc: 0.930 Test Loss: 0.531 Test Acc: 0.930
Validation loss decreased (-0.918512 --> -0.929624).  Saving model ...
Epoch: 13 cost time: 0.4660618305206299
Epoch: 13, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.467 Vali Acc: 0.937 Test Loss: 0.467 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 14 cost time: 0.5543889999389648
Epoch: 14, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.414 Vali Acc: 0.941 Test Loss: 0.414 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940737).  Saving model ...
Epoch: 15 cost time: 0.4590177536010742
Epoch: 15, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.369 Vali Acc: 0.944 Test Loss: 0.369 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.44134950637817383
Epoch: 16, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.332 Vali Acc: 0.956 Test Loss: 0.332 Test Acc: 0.956
Validation loss decreased (-0.944441 --> -0.955552).  Saving model ...
Epoch: 17 cost time: 0.4815502166748047
Epoch: 17, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.300 Vali Acc: 0.952 Test Loss: 0.300 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5350277423858643
Epoch: 18, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.276 Vali Acc: 0.952 Test Loss: 0.276 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5501165390014648
Epoch: 19, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4625668525695801
Epoch: 20, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4637875556945801
Epoch: 21, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4513823986053467
Epoch: 22, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4555940628051758
Epoch: 23, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5112440586090088
Epoch: 24, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4541914463043213
Epoch: 25, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4513864517211914
Epoch: 26, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 124614
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1203811168670654
Epoch: 1, Steps: 2 | Train Loss: 1.967 Vali Loss: 1.890 Vali Acc: 0.181 Test Loss: 1.890 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.43882012367248535
Epoch: 2, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.793 Vali Acc: 0.215 Test Loss: 1.793 Test Acc: 0.215
Validation loss decreased (-0.181463 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.44603514671325684
Epoch: 3, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.705 Vali Acc: 0.293 Test Loss: 1.705 Test Acc: 0.293
Validation loss decreased (-0.214797 --> -0.292576).  Saving model ...
Epoch: 4 cost time: 0.4881117343902588
Epoch: 4, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.600 Vali Acc: 0.430 Test Loss: 1.600 Test Acc: 0.430
Validation loss decreased (-0.292576 --> -0.429614).  Saving model ...
Epoch: 5 cost time: 0.4913332462310791
Epoch: 5, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.475 Vali Acc: 0.533 Test Loss: 1.475 Test Acc: 0.533
Validation loss decreased (-0.429614 --> -0.533319).  Saving model ...
Epoch: 6 cost time: 0.48743581771850586
Epoch: 6, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.340 Vali Acc: 0.596 Test Loss: 1.340 Test Acc: 0.596
Validation loss decreased (-0.533319 --> -0.596283).  Saving model ...
Epoch: 7 cost time: 0.45224618911743164
Epoch: 7, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.203 Vali Acc: 0.644 Test Loss: 1.203 Test Acc: 0.644
Validation loss decreased (-0.596283 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 0.39530181884765625
Epoch: 8, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.071 Vali Acc: 0.707 Test Loss: 1.071 Test Acc: 0.707
Validation loss decreased (-0.644432 --> -0.707397).  Saving model ...
Epoch: 9 cost time: 0.5651876926422119
Epoch: 9, Steps: 2 | Train Loss: 0.966 Vali Loss: 0.948 Vali Acc: 0.804 Test Loss: 0.948 Test Acc: 0.804
Validation loss decreased (-0.707397 --> -0.803694).  Saving model ...
Epoch: 10 cost time: 0.4737703800201416
Epoch: 10, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.837 Vali Acc: 0.870 Test Loss: 0.837 Test Acc: 0.870
Validation loss decreased (-0.803694 --> -0.870362).  Saving model ...
Epoch: 11 cost time: 0.4867119789123535
Epoch: 11, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.738 Vali Acc: 0.881 Test Loss: 0.738 Test Acc: 0.881
Validation loss decreased (-0.870362 --> -0.881474).  Saving model ...
Epoch: 12 cost time: 0.41426730155944824
Epoch: 12, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.654 Vali Acc: 0.889 Test Loss: 0.654 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888882).  Saving model ...
Epoch: 13 cost time: 0.5349724292755127
Epoch: 13, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.4832429885864258
Epoch: 14, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.522 Vali Acc: 0.907 Test Loss: 0.522 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 15 cost time: 0.42809271812438965
Epoch: 15, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.470 Vali Acc: 0.904 Test Loss: 0.470 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.48577213287353516
Epoch: 16, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.427 Vali Acc: 0.907 Test Loss: 0.427 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 17 cost time: 0.45978307723999023
Epoch: 17, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.390 Vali Acc: 0.915 Test Loss: 0.390 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 18 cost time: 0.4533557891845703
Epoch: 18, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.358 Vali Acc: 0.915 Test Loss: 0.358 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 0.41418910026550293
Epoch: 19, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.332 Vali Acc: 0.919 Test Loss: 0.332 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.4664797782897949
Epoch: 20, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.311 Vali Acc: 0.907 Test Loss: 0.311 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.43199777603149414
Epoch: 21, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 22 cost time: 0.4348776340484619
Epoch: 22, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.282 Vali Acc: 0.919 Test Loss: 0.282 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 23 cost time: 0.5104546546936035
Epoch: 23, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925923).  Saving model ...
Epoch: 24 cost time: 0.4392542839050293
Epoch: 24, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.42923784255981445
Epoch: 25, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.39108943939208984
Epoch: 26, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4303257465362549
Epoch: 27, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.44844603538513184
Epoch: 28, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.4309999942779541
Epoch: 29, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.4522843360900879
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.45887160301208496
Epoch: 31, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.4820547103881836
Epoch: 32, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.4062051773071289
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.43067288398742676
Epoch: 34, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.43579959869384766
Epoch: 35, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.49018025398254395
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.4305298328399658
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.5522112846374512
Epoch: 38, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.4588792324066162
Epoch: 39, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.4454977512359619
Epoch: 40, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.4587390422821045
Epoch: 41, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.4637603759765625
Epoch: 42, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.46317505836486816
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.5542986392974854
Epoch: 44, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.5242612361907959
Epoch: 45, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.4704432487487793
Epoch: 46, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.523043155670166
Epoch: 47, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.5673844814300537
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 49 cost time: 0.48961806297302246
Epoch: 49, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4737722873687744
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5109508037567139
Epoch: 51, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.4535369873046875
Epoch: 52, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.48052000999450684
Epoch: 53, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.421875
Epoch: 54, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.44699573516845703
Epoch: 55, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.45640063285827637
Epoch: 56, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.46805548667907715
Epoch: 57, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.4308280944824219
Epoch: 58, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 112710
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9099962711334229
Epoch: 1, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.672 Vali Acc: 0.241 Test Loss: 1.672 Test Acc: 0.241
Validation loss decreased (inf --> -0.240724).  Saving model ...
Epoch: 2 cost time: 0.41713881492614746
Epoch: 2, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.608 Vali Acc: 0.319 Test Loss: 1.608 Test Acc: 0.319
Validation loss decreased (-0.240724 --> -0.318502).  Saving model ...
Epoch: 3 cost time: 0.5528237819671631
Epoch: 3, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.551 Vali Acc: 0.407 Test Loss: 1.551 Test Acc: 0.407
Validation loss decreased (-0.318502 --> -0.407392).  Saving model ...
Epoch: 4 cost time: 0.40898895263671875
Epoch: 4, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.486 Vali Acc: 0.530 Test Loss: 1.486 Test Acc: 0.530
Validation loss decreased (-0.407392 --> -0.529615).  Saving model ...
Epoch: 5 cost time: 0.4890427589416504
Epoch: 5, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.403 Vali Acc: 0.630 Test Loss: 1.403 Test Acc: 0.630
Validation loss decreased (-0.529615 --> -0.629616).  Saving model ...
Epoch: 6 cost time: 0.47881031036376953
Epoch: 6, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.309 Vali Acc: 0.700 Test Loss: 1.309 Test Acc: 0.700
Validation loss decreased (-0.629616 --> -0.699987).  Saving model ...
Epoch: 7 cost time: 0.5797290802001953
Epoch: 7, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.209 Vali Acc: 0.752 Test Loss: 1.209 Test Acc: 0.752
Validation loss decreased (-0.699987 --> -0.751840).  Saving model ...
Epoch: 8 cost time: 0.47759485244750977
Epoch: 8, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.105 Vali Acc: 0.804 Test Loss: 1.105 Test Acc: 0.804
Validation loss decreased (-0.751840 --> -0.803693).  Saving model ...
Epoch: 9 cost time: 0.47748661041259766
Epoch: 9, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.005 Vali Acc: 0.833 Test Loss: 1.005 Test Acc: 0.833
Validation loss decreased (-0.803693 --> -0.833323).  Saving model ...
Epoch: 10 cost time: 0.4386923313140869
Epoch: 10, Steps: 2 | Train Loss: 1.022 Vali Loss: 0.909 Vali Acc: 0.863 Test Loss: 0.909 Test Acc: 0.863
Validation loss decreased (-0.833323 --> -0.862954).  Saving model ...
Epoch: 11 cost time: 0.4854862689971924
Epoch: 11, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.819 Vali Acc: 0.885 Test Loss: 0.819 Test Acc: 0.885
Validation loss decreased (-0.862954 --> -0.885177).  Saving model ...
Epoch: 12 cost time: 0.5171763896942139
Epoch: 12, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.735 Vali Acc: 0.919 Test Loss: 0.735 Test Acc: 0.919
Validation loss decreased (-0.885177 --> -0.918511).  Saving model ...
Epoch: 13 cost time: 0.4675304889678955
Epoch: 13, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.662 Vali Acc: 0.930 Test Loss: 0.662 Test Acc: 0.930
Validation loss decreased (-0.918511 --> -0.929623).  Saving model ...
Epoch: 14 cost time: 0.5005934238433838
Epoch: 14, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.596 Vali Acc: 0.930 Test Loss: 0.596 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 15 cost time: 0.45389437675476074
Epoch: 15, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.538 Vali Acc: 0.933 Test Loss: 0.538 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 16 cost time: 0.5983953475952148
Epoch: 16, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.487 Vali Acc: 0.933 Test Loss: 0.487 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 17 cost time: 0.41876673698425293
Epoch: 17, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.444 Vali Acc: 0.937 Test Loss: 0.444 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937033).  Saving model ...
Epoch: 18 cost time: 0.4611074924468994
Epoch: 18, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.406 Vali Acc: 0.941 Test Loss: 0.406 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 19 cost time: 0.5604162216186523
Epoch: 19, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.375 Vali Acc: 0.941 Test Loss: 0.375 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 20 cost time: 0.4961261749267578
Epoch: 20, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.346 Vali Acc: 0.933 Test Loss: 0.346 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4917628765106201
Epoch: 21, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.321 Vali Acc: 0.930 Test Loss: 0.321 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.532740592956543
Epoch: 22, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.46189379692077637
Epoch: 23, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6541337966918945
Epoch: 24, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.271 Vali Acc: 0.926 Test Loss: 0.271 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5044012069702148
Epoch: 25, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.258 Vali Acc: 0.926 Test Loss: 0.258 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6292402744293213
Epoch: 26, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5603387355804443
Epoch: 27, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.738227367401123
Epoch: 28, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.47562384605407715
Epoch: 29, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm128_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 107078
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2904775142669678
Epoch: 1, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.673 Vali Acc: 0.241 Test Loss: 1.673 Test Acc: 0.241
Validation loss decreased (inf --> -0.240724).  Saving model ...
Epoch: 2 cost time: 0.4998207092285156
Epoch: 2, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.556 Vali Acc: 0.463 Test Loss: 1.556 Test Acc: 0.463
Validation loss decreased (-0.240724 --> -0.462947).  Saving model ...
Epoch: 3 cost time: 0.4937419891357422
Epoch: 3, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.414 Vali Acc: 0.556 Test Loss: 1.414 Test Acc: 0.556
Validation loss decreased (-0.462947 --> -0.555541).  Saving model ...
Epoch: 4 cost time: 0.5239930152893066
Epoch: 4, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.204 Vali Acc: 0.700 Test Loss: 1.204 Test Acc: 0.700
Validation loss decreased (-0.555541 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 0.5453891754150391
Epoch: 5, Steps: 2 | Train Loss: 1.070 Vali Loss: 0.981 Vali Acc: 0.796 Test Loss: 0.981 Test Acc: 0.796
Validation loss decreased (-0.699988 --> -0.796286).  Saving model ...
Epoch: 6 cost time: 0.5034723281860352
Epoch: 6, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.789 Vali Acc: 0.874 Test Loss: 0.789 Test Acc: 0.874
Validation loss decreased (-0.796286 --> -0.874066).  Saving model ...
Epoch: 7 cost time: 0.5614898204803467
Epoch: 7, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.637 Vali Acc: 0.893 Test Loss: 0.637 Test Acc: 0.893
Validation loss decreased (-0.874066 --> -0.892586).  Saving model ...
Epoch: 8 cost time: 0.5845479965209961
Epoch: 8, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.516 Vali Acc: 0.907 Test Loss: 0.516 Test Acc: 0.907
Validation loss decreased (-0.892586 --> -0.907402).  Saving model ...
Epoch: 9 cost time: 0.5294046401977539
Epoch: 9, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.425 Vali Acc: 0.922 Test Loss: 0.425 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922218).  Saving model ...
Epoch: 10 cost time: 0.5679001808166504
Epoch: 10, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.355 Vali Acc: 0.926 Test Loss: 0.355 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 11 cost time: 0.5673041343688965
Epoch: 11, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.564241886138916
Epoch: 12, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
Validation loss decreased (-0.925922 --> -0.940738).  Saving model ...
Epoch: 13 cost time: 0.5364501476287842
Epoch: 13, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 14 cost time: 0.5134856700897217
Epoch: 14, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 15 cost time: 0.5104210376739502
Epoch: 15, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5747261047363281
Epoch: 16, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5391659736633301
Epoch: 17, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6026599407196045
Epoch: 18, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5061559677124023
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.49352216720581055
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.926 Test Loss: 0.180 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5851056575775146
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.930 Test Loss: 0.172 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5482242107391357
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.933 Test Loss: 0.167 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5394842624664307
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.933 Test Loss: 0.165 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5462338924407959
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.933 Test Loss: 0.164 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 150086
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1132726669311523
Epoch: 1, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.779 Vali Acc: 0.204 Test Loss: 1.779 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.572472095489502
Epoch: 2, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.700 Vali Acc: 0.248 Test Loss: 1.700 Test Acc: 0.248
Validation loss decreased (-0.203686 --> -0.248131).  Saving model ...
Epoch: 3 cost time: 0.5862243175506592
Epoch: 3, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.613 Vali Acc: 0.333 Test Loss: 1.613 Test Acc: 0.333
Validation loss decreased (-0.248131 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 0.4869675636291504
Epoch: 4, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.490 Vali Acc: 0.422 Test Loss: 1.490 Test Acc: 0.422
Validation loss decreased (-0.333317 --> -0.422207).  Saving model ...
Epoch: 5 cost time: 0.5516936779022217
Epoch: 5, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.346 Vali Acc: 0.537 Test Loss: 1.346 Test Acc: 0.537
Validation loss decreased (-0.422207 --> -0.537024).  Saving model ...
Epoch: 6 cost time: 0.5341241359710693
Epoch: 6, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.191 Vali Acc: 0.626 Test Loss: 1.191 Test Acc: 0.626
Validation loss decreased (-0.537024 --> -0.625914).  Saving model ...
Epoch: 7 cost time: 0.6272966861724854
Epoch: 7, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.036 Vali Acc: 0.707 Test Loss: 1.036 Test Acc: 0.707
Validation loss decreased (-0.625914 --> -0.707397).  Saving model ...
Epoch: 8 cost time: 0.6208913326263428
Epoch: 8, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.889 Vali Acc: 0.789 Test Loss: 0.889 Test Acc: 0.789
Validation loss decreased (-0.707397 --> -0.788880).  Saving model ...
Epoch: 9 cost time: 0.6127419471740723
Epoch: 9, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.754 Vali Acc: 0.863 Test Loss: 0.754 Test Acc: 0.863
Validation loss decreased (-0.788880 --> -0.862955).  Saving model ...
Epoch: 10 cost time: 0.5488264560699463
Epoch: 10, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.639 Vali Acc: 0.889 Test Loss: 0.639 Test Acc: 0.889
Validation loss decreased (-0.862955 --> -0.888882).  Saving model ...
Epoch: 11 cost time: 0.6287121772766113
Epoch: 11, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.542 Vali Acc: 0.937 Test Loss: 0.542 Test Acc: 0.937
Validation loss decreased (-0.888882 --> -0.937032).  Saving model ...
Epoch: 12 cost time: 0.5988297462463379
Epoch: 12, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.468 Vali Acc: 0.937 Test Loss: 0.468 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 13 cost time: 0.5260570049285889
Epoch: 13, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.406 Vali Acc: 0.937 Test Loss: 0.406 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 14 cost time: 0.4902024269104004
Epoch: 14, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 15 cost time: 0.6129703521728516
Epoch: 15, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.314 Vali Acc: 0.948 Test Loss: 0.314 Test Acc: 0.948
Validation loss decreased (-0.937033 --> -0.948145).  Saving model ...
Epoch: 16 cost time: 0.5902659893035889
Epoch: 16, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6405670642852783
Epoch: 17, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5920336246490479
Epoch: 18, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5838589668273926
Epoch: 19, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.644087553024292
Epoch: 20, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5559790134429932
Epoch: 21, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5580580234527588
Epoch: 22, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5516684055328369
Epoch: 23, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5328693389892578
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.186 Vali Acc: 0.926 Test Loss: 0.186 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.565875768661499
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.184 Vali Acc: 0.926 Test Loss: 0.184 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 99526
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1240673065185547
Epoch: 1, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.865 Vali Acc: 0.196 Test Loss: 1.865 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.558678150177002
Epoch: 2, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.780 Vali Acc: 0.230 Test Loss: 1.780 Test Acc: 0.230
Validation loss decreased (-0.196278 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 0.5222535133361816
Epoch: 3, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.696 Vali Acc: 0.300 Test Loss: 1.696 Test Acc: 0.300
Validation loss decreased (-0.229612 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.46994543075561523
Epoch: 4, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.586 Vali Acc: 0.363 Test Loss: 1.586 Test Acc: 0.363
Validation loss decreased (-0.299983 --> -0.362947).  Saving model ...
Epoch: 5 cost time: 0.5221157073974609
Epoch: 5, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.455 Vali Acc: 0.456 Test Loss: 1.455 Test Acc: 0.456
Validation loss decreased (-0.362947 --> -0.455541).  Saving model ...
Epoch: 6 cost time: 0.5218226909637451
Epoch: 6, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.311 Vali Acc: 0.685 Test Loss: 1.311 Test Acc: 0.685
Validation loss decreased (-0.455541 --> -0.685172).  Saving model ...
Epoch: 7 cost time: 0.4906442165374756
Epoch: 7, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.165 Vali Acc: 0.785 Test Loss: 1.165 Test Acc: 0.785
Validation loss decreased (-0.685172 --> -0.785174).  Saving model ...
Epoch: 8 cost time: 0.48631906509399414
Epoch: 8, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.025 Vali Acc: 0.856 Test Loss: 1.025 Test Acc: 0.856
Validation loss decreased (-0.785174 --> -0.855545).  Saving model ...
Epoch: 9 cost time: 0.535149335861206
Epoch: 9, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.896 Vali Acc: 0.870 Test Loss: 0.896 Test Acc: 0.870
Validation loss decreased (-0.855545 --> -0.870361).  Saving model ...
Epoch: 10 cost time: 0.5417613983154297
Epoch: 10, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.780 Vali Acc: 0.889 Test Loss: 0.780 Test Acc: 0.889
Validation loss decreased (-0.870361 --> -0.888881).  Saving model ...
Epoch: 11 cost time: 0.5721635818481445
Epoch: 11, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.681 Vali Acc: 0.889 Test Loss: 0.681 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 12 cost time: 0.5585405826568604
Epoch: 12, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.596 Vali Acc: 0.900 Test Loss: 0.596 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.574124813079834
Epoch: 13, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.524 Vali Acc: 0.904 Test Loss: 0.524 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 14 cost time: 0.5308613777160645
Epoch: 14, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.463 Vali Acc: 0.919 Test Loss: 0.463 Test Acc: 0.919
Validation loss decreased (-0.903698 --> -0.918514).  Saving model ...
Epoch: 15 cost time: 0.43153953552246094
Epoch: 15, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.416 Vali Acc: 0.919 Test Loss: 0.416 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 16 cost time: 0.5686638355255127
Epoch: 16, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.374 Vali Acc: 0.922 Test Loss: 0.374 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 17 cost time: 0.46106457710266113
Epoch: 17, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.339 Vali Acc: 0.926 Test Loss: 0.339 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 0.6102390289306641
Epoch: 18, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.306 Vali Acc: 0.933 Test Loss: 0.306 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933330).  Saving model ...
Epoch: 19 cost time: 0.5148236751556396
Epoch: 19, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 20 cost time: 0.5464217662811279
Epoch: 20, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 21 cost time: 0.5180020332336426
Epoch: 21, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 22 cost time: 0.4741992950439453
Epoch: 22, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5496172904968262
Epoch: 23, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.643479585647583
Epoch: 24, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6349020004272461
Epoch: 25, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5485639572143555
Epoch: 26, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5779950618743896
Epoch: 27, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.45874977111816406
Epoch: 28, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.4863712787628174
Epoch: 29, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.4232051372528076
Epoch: 30, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5386037826538086
Epoch: 31, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 84230
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.04840087890625
Epoch: 1, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.846 Vali Acc: 0.104 Test Loss: 1.846 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 0.5724132061004639
Epoch: 2, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.774 Vali Acc: 0.144 Test Loss: 1.774 Test Acc: 0.144
Validation loss decreased (-0.103685 --> -0.144427).  Saving model ...
Epoch: 3 cost time: 0.6087462902069092
Epoch: 3, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.709 Vali Acc: 0.252 Test Loss: 1.709 Test Acc: 0.252
Validation loss decreased (-0.144427 --> -0.251835).  Saving model ...
Epoch: 4 cost time: 0.6155543327331543
Epoch: 4, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.631 Vali Acc: 0.381 Test Loss: 1.631 Test Acc: 0.381
Validation loss decreased (-0.251835 --> -0.381465).  Saving model ...
Epoch: 5 cost time: 0.5400290489196777
Epoch: 5, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.533 Vali Acc: 0.481 Test Loss: 1.533 Test Acc: 0.481
Validation loss decreased (-0.381465 --> -0.481466).  Saving model ...
Epoch: 6 cost time: 0.5361185073852539
Epoch: 6, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.425 Vali Acc: 0.593 Test Loss: 1.425 Test Acc: 0.593
Validation loss decreased (-0.481466 --> -0.592578).  Saving model ...
Epoch: 7 cost time: 0.49460315704345703
Epoch: 7, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.309 Vali Acc: 0.652 Test Loss: 1.309 Test Acc: 0.652
Validation loss decreased (-0.592578 --> -0.651839).  Saving model ...
Epoch: 8 cost time: 0.5692894458770752
Epoch: 8, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.191 Vali Acc: 0.707 Test Loss: 1.191 Test Acc: 0.707
Validation loss decreased (-0.651839 --> -0.707395).  Saving model ...
Epoch: 9 cost time: 0.5110270977020264
Epoch: 9, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.079 Vali Acc: 0.741 Test Loss: 1.079 Test Acc: 0.741
Validation loss decreased (-0.707395 --> -0.740730).  Saving model ...
Epoch: 10 cost time: 0.46243810653686523
Epoch: 10, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.973 Vali Acc: 0.781 Test Loss: 0.973 Test Acc: 0.781
Validation loss decreased (-0.740730 --> -0.781472).  Saving model ...
Epoch: 11 cost time: 0.5420584678649902
Epoch: 11, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.877 Vali Acc: 0.826 Test Loss: 0.877 Test Acc: 0.826
Validation loss decreased (-0.781472 --> -0.825917).  Saving model ...
Epoch: 12 cost time: 0.4772806167602539
Epoch: 12, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.789 Vali Acc: 0.848 Test Loss: 0.789 Test Acc: 0.848
Validation loss decreased (-0.825917 --> -0.848140).  Saving model ...
Epoch: 13 cost time: 0.49988889694213867
Epoch: 13, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.711 Vali Acc: 0.859 Test Loss: 0.711 Test Acc: 0.859
Validation loss decreased (-0.848140 --> -0.859252).  Saving model ...
Epoch: 14 cost time: 0.5224332809448242
Epoch: 14, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.642 Vali Acc: 0.881 Test Loss: 0.642 Test Acc: 0.881
Validation loss decreased (-0.859252 --> -0.881475).  Saving model ...
Epoch: 15 cost time: 0.49127674102783203
Epoch: 15, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.582 Vali Acc: 0.881 Test Loss: 0.582 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 16 cost time: 0.43904614448547363
Epoch: 16, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.530 Vali Acc: 0.893 Test Loss: 0.530 Test Acc: 0.893
Validation loss decreased (-0.881476 --> -0.892587).  Saving model ...
Epoch: 17 cost time: 0.5602006912231445
Epoch: 17, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5289111137390137
Epoch: 18, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.447 Vali Acc: 0.881 Test Loss: 0.447 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5228390693664551
Epoch: 19, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.415 Vali Acc: 0.878 Test Loss: 0.415 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5633480548858643
Epoch: 20, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5534188747406006
Epoch: 21, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.356 Vali Acc: 0.893 Test Loss: 0.356 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892589).  Saving model ...
Epoch: 22 cost time: 0.5525975227355957
Epoch: 22, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.329 Vali Acc: 0.919 Test Loss: 0.329 Test Acc: 0.919
Validation loss decreased (-0.892589 --> -0.918515).  Saving model ...
Epoch: 23 cost time: 0.4776647090911865
Epoch: 23, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.310 Vali Acc: 0.915 Test Loss: 0.310 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5311696529388428
Epoch: 24, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 25 cost time: 0.5696883201599121
Epoch: 25, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
Validation loss decreased (-0.918516 --> -0.929627).  Saving model ...
Epoch: 26 cost time: 0.6369550228118896
Epoch: 26, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5449776649475098
Epoch: 27, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 0.5836052894592285
Epoch: 28, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.5323035717010498
Epoch: 29, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.48390841484069824
Epoch: 30, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.5726182460784912
Epoch: 31, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.6052408218383789
Epoch: 32, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.5637333393096924
Epoch: 33, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.5024588108062744
Epoch: 34, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.5703060626983643
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.590883731842041
Epoch: 36, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5669560432434082
Epoch: 37, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5724196434020996
Epoch: 38, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5153813362121582
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5956895351409912
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5272324085235596
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5299375057220459
Epoch: 42, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.4820401668548584
Epoch: 43, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.4581260681152344
Epoch: 44, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 75142
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.376950979232788
Epoch: 1, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.917 Vali Acc: 0.174 Test Loss: 1.917 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 0.5055980682373047
Epoch: 2, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.838 Vali Acc: 0.211 Test Loss: 1.838 Test Acc: 0.211
Validation loss decreased (-0.174055 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 0.4807729721069336
Epoch: 3, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.771 Vali Acc: 0.244 Test Loss: 1.771 Test Acc: 0.244
Validation loss decreased (-0.211093 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 0.5049538612365723
Epoch: 4, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.698 Vali Acc: 0.270 Test Loss: 1.698 Test Acc: 0.270
Validation loss decreased (-0.244427 --> -0.270353).  Saving model ...
Epoch: 5 cost time: 0.4779398441314697
Epoch: 5, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.609 Vali Acc: 0.319 Test Loss: 1.609 Test Acc: 0.319
Validation loss decreased (-0.270353 --> -0.318502).  Saving model ...
Epoch: 6 cost time: 0.5173583030700684
Epoch: 6, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.510 Vali Acc: 0.448 Test Loss: 1.510 Test Acc: 0.448
Validation loss decreased (-0.318502 --> -0.448133).  Saving model ...
Epoch: 7 cost time: 0.5115151405334473
Epoch: 7, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.404 Vali Acc: 0.533 Test Loss: 1.404 Test Acc: 0.533
Validation loss decreased (-0.448133 --> -0.533319).  Saving model ...
Epoch: 8 cost time: 0.5256688594818115
Epoch: 8, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.294 Vali Acc: 0.630 Test Loss: 1.294 Test Acc: 0.630
Validation loss decreased (-0.533319 --> -0.629617).  Saving model ...
Epoch: 9 cost time: 0.5080268383026123
Epoch: 9, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.186 Vali Acc: 0.722 Test Loss: 1.186 Test Acc: 0.722
Validation loss decreased (-0.629617 --> -0.722210).  Saving model ...
Epoch: 10 cost time: 0.4876844882965088
Epoch: 10, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.082 Vali Acc: 0.781 Test Loss: 1.082 Test Acc: 0.781
Validation loss decreased (-0.722210 --> -0.781471).  Saving model ...
Epoch: 11 cost time: 0.46871423721313477
Epoch: 11, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.981 Vali Acc: 0.833 Test Loss: 0.981 Test Acc: 0.833
Validation loss decreased (-0.781471 --> -0.833324).  Saving model ...
Epoch: 12 cost time: 0.5546848773956299
Epoch: 12, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.887 Vali Acc: 0.874 Test Loss: 0.887 Test Acc: 0.874
Validation loss decreased (-0.833324 --> -0.874065).  Saving model ...
Epoch: 13 cost time: 0.49939656257629395
Epoch: 13, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.802 Vali Acc: 0.889 Test Loss: 0.802 Test Acc: 0.889
Validation loss decreased (-0.874065 --> -0.888881).  Saving model ...
Epoch: 14 cost time: 0.48274707794189453
Epoch: 14, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.725 Vali Acc: 0.900 Test Loss: 0.725 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.5357437133789062
Epoch: 15, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.655 Vali Acc: 0.915 Test Loss: 0.655 Test Acc: 0.915
Validation loss decreased (-0.899993 --> -0.914808).  Saving model ...
Epoch: 16 cost time: 0.5358984470367432
Epoch: 16, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.593 Vali Acc: 0.922 Test Loss: 0.593 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 17 cost time: 0.6115086078643799
Epoch: 17, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.538 Vali Acc: 0.926 Test Loss: 0.538 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925921).  Saving model ...
Epoch: 18 cost time: 0.5078475475311279
Epoch: 18, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.491 Vali Acc: 0.933 Test Loss: 0.491 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933328).  Saving model ...
Epoch: 19 cost time: 0.44197654724121094
Epoch: 19, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.448 Vali Acc: 0.933 Test Loss: 0.448 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 20 cost time: 0.4696965217590332
Epoch: 20, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.411 Vali Acc: 0.933 Test Loss: 0.411 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 21 cost time: 0.47620487213134766
Epoch: 21, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.379 Vali Acc: 0.941 Test Loss: 0.379 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 22 cost time: 0.4108915328979492
Epoch: 22, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.353 Vali Acc: 0.937 Test Loss: 0.353 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5083556175231934
Epoch: 23, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.330 Vali Acc: 0.933 Test Loss: 0.330 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.524057149887085
Epoch: 24, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 25 cost time: 0.5611708164215088
Epoch: 25, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5102155208587646
Epoch: 26, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5577030181884766
Epoch: 27, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5387277603149414
Epoch: 28, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.246 Vali Acc: 0.948 Test Loss: 0.246 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.49889588356018066
Epoch: 29, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.235 Vali Acc: 0.952 Test Loss: 0.235 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.4907515048980713
Epoch: 30, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.225 Vali Acc: 0.952 Test Loss: 0.225 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.5982532501220703
Epoch: 31, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.4708857536315918
Epoch: 32, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 33 cost time: 0.5076055526733398
Epoch: 33, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.5396976470947266
Epoch: 34, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.5524618625640869
Epoch: 35, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5848653316497803
Epoch: 36, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5052239894866943
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4748575687408447
Epoch: 38, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5409858226776123
Epoch: 39, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5384998321533203
Epoch: 40, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5363872051239014
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5655455589294434
Epoch: 42, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5143980979919434
Epoch: 43, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6212992668151855
Epoch: 44, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 70726
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2055137157440186
Epoch: 1, Steps: 2 | Train Loss: 2.176 Vali Loss: 1.925 Vali Acc: 0.089 Test Loss: 1.925 Test Acc: 0.089
Validation loss decreased (inf --> -0.088870).  Saving model ...
Epoch: 2 cost time: 0.5088787078857422
Epoch: 2, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.869 Vali Acc: 0.119 Test Loss: 1.869 Test Acc: 0.119
Validation loss decreased (-0.088870 --> -0.118500).  Saving model ...
Epoch: 3 cost time: 0.5304269790649414
Epoch: 3, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.823 Vali Acc: 0.159 Test Loss: 1.823 Test Acc: 0.159
Validation loss decreased (-0.118500 --> -0.159241).  Saving model ...
Epoch: 4 cost time: 0.6188571453094482
Epoch: 4, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.773 Vali Acc: 0.200 Test Loss: 1.773 Test Acc: 0.200
Validation loss decreased (-0.159241 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 0.5440046787261963
Epoch: 5, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.711 Vali Acc: 0.315 Test Loss: 1.711 Test Acc: 0.315
Validation loss decreased (-0.199982 --> -0.314798).  Saving model ...
Epoch: 6 cost time: 0.5666539669036865
Epoch: 6, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.640 Vali Acc: 0.374 Test Loss: 1.640 Test Acc: 0.374
Validation loss decreased (-0.314798 --> -0.374058).  Saving model ...
Epoch: 7 cost time: 0.5198087692260742
Epoch: 7, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.559 Vali Acc: 0.419 Test Loss: 1.559 Test Acc: 0.419
Validation loss decreased (-0.374058 --> -0.418503).  Saving model ...
Epoch: 8 cost time: 0.5188865661621094
Epoch: 8, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.475 Vali Acc: 0.489 Test Loss: 1.475 Test Acc: 0.489
Validation loss decreased (-0.418503 --> -0.488874).  Saving model ...
Epoch: 9 cost time: 0.4707815647125244
Epoch: 9, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.386 Vali Acc: 0.559 Test Loss: 1.386 Test Acc: 0.559
Validation loss decreased (-0.488874 --> -0.559245).  Saving model ...
Epoch: 10 cost time: 0.5008714199066162
Epoch: 10, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.297 Vali Acc: 0.633 Test Loss: 1.297 Test Acc: 0.633
Validation loss decreased (-0.559245 --> -0.633320).  Saving model ...
Epoch: 11 cost time: 0.6015737056732178
Epoch: 11, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.205 Vali Acc: 0.711 Test Loss: 1.205 Test Acc: 0.711
Validation loss decreased (-0.633320 --> -0.711099).  Saving model ...
Epoch: 12 cost time: 0.5305826663970947
Epoch: 12, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.116 Vali Acc: 0.752 Test Loss: 1.116 Test Acc: 0.752
Validation loss decreased (-0.711099 --> -0.751841).  Saving model ...
Epoch: 13 cost time: 0.5354113578796387
Epoch: 13, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.030 Vali Acc: 0.804 Test Loss: 1.030 Test Acc: 0.804
Validation loss decreased (-0.751841 --> -0.803693).  Saving model ...
Epoch: 14 cost time: 0.5634365081787109
Epoch: 14, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.948 Vali Acc: 0.830 Test Loss: 0.948 Test Acc: 0.830
Validation loss decreased (-0.803693 --> -0.829620).  Saving model ...
Epoch: 15 cost time: 0.5523409843444824
Epoch: 15, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.870 Vali Acc: 0.848 Test Loss: 0.870 Test Acc: 0.848
Validation loss decreased (-0.829620 --> -0.848139).  Saving model ...
Epoch: 16 cost time: 0.5344796180725098
Epoch: 16, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.798 Vali Acc: 0.870 Test Loss: 0.798 Test Acc: 0.870
Validation loss decreased (-0.848139 --> -0.870362).  Saving model ...
Epoch: 17 cost time: 0.5914499759674072
Epoch: 17, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.732 Vali Acc: 0.885 Test Loss: 0.732 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885178).  Saving model ...
Epoch: 18 cost time: 0.5982260704040527
Epoch: 18, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.671 Vali Acc: 0.904 Test Loss: 0.671 Test Acc: 0.904
Validation loss decreased (-0.885178 --> -0.903697).  Saving model ...
Epoch: 19 cost time: 0.4958183765411377
Epoch: 19, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.616 Vali Acc: 0.911 Test Loss: 0.616 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 20 cost time: 0.5317356586456299
Epoch: 20, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.566 Vali Acc: 0.907 Test Loss: 0.566 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5010745525360107
Epoch: 21, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.521 Vali Acc: 0.915 Test Loss: 0.521 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914810).  Saving model ...
Epoch: 22 cost time: 0.5026698112487793
Epoch: 22, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.482 Vali Acc: 0.919 Test Loss: 0.482 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 23 cost time: 0.5260186195373535
Epoch: 23, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.447 Vali Acc: 0.926 Test Loss: 0.447 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925921).  Saving model ...
Epoch: 24 cost time: 0.5644960403442383
Epoch: 24, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.416 Vali Acc: 0.933 Test Loss: 0.416 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 25 cost time: 0.5011522769927979
Epoch: 25, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.388 Vali Acc: 0.930 Test Loss: 0.388 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5799727439880371
Epoch: 26, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.363 Vali Acc: 0.930 Test Loss: 0.363 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5368978977203369
Epoch: 27, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937034).  Saving model ...
Epoch: 28 cost time: 0.5853993892669678
Epoch: 28, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.322 Vali Acc: 0.941 Test Loss: 0.322 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.5638375282287598
Epoch: 29, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5361135005950928
Epoch: 30, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5614039897918701
Epoch: 31, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5475296974182129
Epoch: 32, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 33 cost time: 0.6237292289733887
Epoch: 33, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.525968074798584
Epoch: 34, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5101885795593262
Epoch: 35, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.4989316463470459
Epoch: 36, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.4184291362762451
Epoch: 37, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.239 Vali Acc: 0.948 Test Loss: 0.239 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.4964611530303955
Epoch: 38, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.6082839965820312
Epoch: 39, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.5741093158721924
Epoch: 40, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.227 Vali Acc: 0.948 Test Loss: 0.227 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.5154895782470703
Epoch: 41, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.5203056335449219
Epoch: 42, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.220 Vali Acc: 0.948 Test Loss: 0.220 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.617363691329956
Epoch: 43, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.5917186737060547
Epoch: 44, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.5576522350311279
Epoch: 45, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.5496094226837158
Epoch: 46, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.47629499435424805
Epoch: 47, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.4453706741333008
Epoch: 48, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.5011930465698242
Epoch: 49, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.5102849006652832
Epoch: 50, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 51 cost time: 0.5108997821807861
Epoch: 51, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 52 cost time: 0.5708701610565186
Epoch: 52, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 53 cost time: 0.5197935104370117
Epoch: 53, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 54 cost time: 0.4947545528411865
Epoch: 54, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 55 cost time: 0.5731034278869629
Epoch: 55, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 56 cost time: 0.49596595764160156
Epoch: 56, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 57 cost time: 0.593207836151123
Epoch: 57, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 58 cost time: 0.49735593795776367
Epoch: 58, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 59 cost time: 0.5294561386108398
Epoch: 59, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 60 cost time: 0.504021167755127
Epoch: 60, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 61 cost time: 0.5542168617248535
Epoch: 61, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 62 cost time: 0.5340132713317871
Epoch: 62, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 63 cost time: 0.5012416839599609
Epoch: 63, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 64 cost time: 0.5203535556793213
Epoch: 64, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 65 cost time: 0.4789307117462158
Epoch: 65, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 66 cost time: 0.4566495418548584
Epoch: 66, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 67 cost time: 0.47260618209838867
Epoch: 67, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 68 cost time: 0.5354347229003906
Epoch: 68, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 69 cost time: 0.4709651470184326
Epoch: 69, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 70 cost time: 0.5392301082611084
Epoch: 70, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 71 cost time: 0.5425810813903809
Epoch: 71, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 72 cost time: 0.4919612407684326
Epoch: 72, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 73 cost time: 0.5186972618103027
Epoch: 73, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 74 cost time: 0.5900833606719971
Epoch: 74, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 75 cost time: 0.5099339485168457
Epoch: 75, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 76 cost time: 0.5840935707092285
Epoch: 76, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 77 cost time: 0.5307745933532715
Epoch: 77, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 78 cost time: 0.5920171737670898
Epoch: 78, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 79 cost time: 0.5027072429656982
Epoch: 79, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 80 cost time: 0.5898690223693848
Epoch: 80, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 81 cost time: 0.5868356227874756
Epoch: 81, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 82 cost time: 0.5442769527435303
Epoch: 82, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 83 cost time: 0.5637023448944092
Epoch: 83, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 84 cost time: 0.5725843906402588
Epoch: 84, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 85 cost time: 0.4660186767578125
Epoch: 85, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 86 cost time: 0.5007379055023193
Epoch: 86, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 87 cost time: 0.4973275661468506
Epoch: 87, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 88 cost time: 0.5279378890991211
Epoch: 88, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 89 cost time: 0.4871532917022705
Epoch: 89, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 90 cost time: 0.46642231941223145
Epoch: 90, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 91 cost time: 0.5815565586090088
Epoch: 91, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 92 cost time: 0.5084693431854248
Epoch: 92, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 93 cost time: 0.5409252643585205
Epoch: 93, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 94 cost time: 0.5232627391815186
Epoch: 94, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.5493817329406738
Epoch: 95, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 96 cost time: 0.5443577766418457
Epoch: 96, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 97 cost time: 0.5673370361328125
Epoch: 97, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 98 cost time: 0.6057171821594238
Epoch: 98, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.48345422744750977
Epoch: 99, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.5411908626556396
Epoch: 100, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 64774
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.089829444885254
Epoch: 1, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.706 Vali Acc: 0.326 Test Loss: 1.706 Test Acc: 0.326
Validation loss decreased (inf --> -0.325909).  Saving model ...
Epoch: 2 cost time: 0.4839210510253906
Epoch: 2, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.666 Vali Acc: 0.400 Test Loss: 1.666 Test Acc: 0.400
Validation loss decreased (-0.325909 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 0.45661258697509766
Epoch: 3, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.634 Vali Acc: 0.444 Test Loss: 1.634 Test Acc: 0.444
Validation loss decreased (-0.399983 --> -0.444428).  Saving model ...
Epoch: 4 cost time: 0.4972236156463623
Epoch: 4, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.600 Vali Acc: 0.489 Test Loss: 1.600 Test Acc: 0.489
Validation loss decreased (-0.444428 --> -0.488873).  Saving model ...
Epoch: 5 cost time: 0.46556615829467773
Epoch: 5, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.556 Vali Acc: 0.511 Test Loss: 1.556 Test Acc: 0.511
Validation loss decreased (-0.488873 --> -0.511096).  Saving model ...
Epoch: 6 cost time: 0.49396443367004395
Epoch: 6, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.505 Vali Acc: 0.537 Test Loss: 1.505 Test Acc: 0.537
Validation loss decreased (-0.511096 --> -0.537022).  Saving model ...
Epoch: 7 cost time: 0.5098648071289062
Epoch: 7, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.447 Vali Acc: 0.563 Test Loss: 1.447 Test Acc: 0.563
Validation loss decreased (-0.537022 --> -0.562948).  Saving model ...
Epoch: 8 cost time: 0.49695444107055664
Epoch: 8, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.384 Vali Acc: 0.604 Test Loss: 1.384 Test Acc: 0.604
Validation loss decreased (-0.562948 --> -0.603690).  Saving model ...
Epoch: 9 cost time: 0.4547545909881592
Epoch: 9, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.318 Vali Acc: 0.626 Test Loss: 1.318 Test Acc: 0.626
Validation loss decreased (-0.603690 --> -0.625913).  Saving model ...
Epoch: 10 cost time: 0.49587297439575195
Epoch: 10, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.249 Vali Acc: 0.648 Test Loss: 1.249 Test Acc: 0.648
Validation loss decreased (-0.625913 --> -0.648136).  Saving model ...
Epoch: 11 cost time: 0.5212411880493164
Epoch: 11, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.180 Vali Acc: 0.674 Test Loss: 1.180 Test Acc: 0.674
Validation loss decreased (-0.648136 --> -0.674062).  Saving model ...
Epoch: 12 cost time: 0.47020769119262695
Epoch: 12, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.111 Vali Acc: 0.726 Test Loss: 1.111 Test Acc: 0.726
Validation loss decreased (-0.674062 --> -0.725915).  Saving model ...
Epoch: 13 cost time: 0.5033848285675049
Epoch: 13, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.043 Vali Acc: 0.752 Test Loss: 1.043 Test Acc: 0.752
Validation loss decreased (-0.725915 --> -0.751841).  Saving model ...
Epoch: 14 cost time: 0.4943962097167969
Epoch: 14, Steps: 2 | Train Loss: 0.921 Vali Loss: 0.978 Vali Acc: 0.756 Test Loss: 0.978 Test Acc: 0.756
Validation loss decreased (-0.751841 --> -0.755546).  Saving model ...
Epoch: 15 cost time: 0.5312166213989258
Epoch: 15, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.916 Vali Acc: 0.785 Test Loss: 0.916 Test Acc: 0.785
Validation loss decreased (-0.755546 --> -0.785176).  Saving model ...
Epoch: 16 cost time: 0.5672409534454346
Epoch: 16, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.858 Vali Acc: 0.804 Test Loss: 0.858 Test Acc: 0.804
Validation loss decreased (-0.785176 --> -0.803695).  Saving model ...
Epoch: 17 cost time: 0.45454931259155273
Epoch: 17, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.802 Vali Acc: 0.830 Test Loss: 0.802 Test Acc: 0.830
Validation loss decreased (-0.803695 --> -0.829622).  Saving model ...
Epoch: 18 cost time: 0.45834946632385254
Epoch: 18, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.749 Vali Acc: 0.833 Test Loss: 0.749 Test Acc: 0.833
Validation loss decreased (-0.829622 --> -0.833326).  Saving model ...
Epoch: 19 cost time: 0.45372581481933594
Epoch: 19, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.700 Vali Acc: 0.856 Test Loss: 0.700 Test Acc: 0.856
Validation loss decreased (-0.833326 --> -0.855549).  Saving model ...
Epoch: 20 cost time: 0.5320777893066406
Epoch: 20, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.655 Vali Acc: 0.863 Test Loss: 0.655 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862956).  Saving model ...
Epoch: 21 cost time: 0.4890251159667969
Epoch: 21, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.614 Vali Acc: 0.874 Test Loss: 0.614 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874068).  Saving model ...
Epoch: 22 cost time: 0.5304262638092041
Epoch: 22, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.574 Vali Acc: 0.893 Test Loss: 0.574 Test Acc: 0.893
Validation loss decreased (-0.874068 --> -0.892587).  Saving model ...
Epoch: 23 cost time: 0.4718639850616455
Epoch: 23, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.538 Vali Acc: 0.893 Test Loss: 0.538 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 24 cost time: 0.49743127822875977
Epoch: 24, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.505 Vali Acc: 0.896 Test Loss: 0.505 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 25 cost time: 0.6085894107818604
Epoch: 25, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.473 Vali Acc: 0.911 Test Loss: 0.473 Test Acc: 0.911
Validation loss decreased (-0.896291 --> -0.911106).  Saving model ...
Epoch: 26 cost time: 0.42540955543518066
Epoch: 26, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.446 Vali Acc: 0.915 Test Loss: 0.446 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 27 cost time: 0.5518910884857178
Epoch: 27, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.422 Vali Acc: 0.919 Test Loss: 0.422 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 28 cost time: 0.5149645805358887
Epoch: 28, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.400 Vali Acc: 0.922 Test Loss: 0.400 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 29 cost time: 0.5376970767974854
Epoch: 29, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.380 Vali Acc: 0.926 Test Loss: 0.380 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 0.5066127777099609
Epoch: 30, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.363 Vali Acc: 0.926 Test Loss: 0.363 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 31 cost time: 0.49203991889953613
Epoch: 31, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.348 Vali Acc: 0.922 Test Loss: 0.348 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5053403377532959
Epoch: 32, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5473575592041016
Epoch: 33, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 34 cost time: 0.5123257637023926
Epoch: 34, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 35 cost time: 0.5727300643920898
Epoch: 35, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.43845152854919434
Epoch: 36, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 37 cost time: 0.584942102432251
Epoch: 37, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 38 cost time: 0.49170804023742676
Epoch: 38, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.274 Vali Acc: 0.937 Test Loss: 0.274 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 39 cost time: 0.4813370704650879
Epoch: 39, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 40 cost time: 0.4745323657989502
Epoch: 40, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 41 cost time: 0.5787761211395264
Epoch: 41, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 42 cost time: 0.6070446968078613
Epoch: 42, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 43 cost time: 0.5339550971984863
Epoch: 43, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.4770805835723877
Epoch: 44, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5244300365447998
Epoch: 45, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.511979341506958
Epoch: 46, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5328693389892578
Epoch: 47, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5515246391296387
Epoch: 48, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.631263256072998
Epoch: 49, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.519568681716919
Epoch: 50, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5283799171447754
Epoch: 51, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.507235050201416
Epoch: 52, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.4989759922027588
Epoch: 53, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 61958
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0833911895751953
Epoch: 1, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.778 Vali Acc: 0.156 Test Loss: 1.778 Test Acc: 0.156
Validation loss decreased (inf --> -0.155538).  Saving model ...
Epoch: 2 cost time: 0.5642890930175781
Epoch: 2, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.648 Vali Acc: 0.278 Test Loss: 1.648 Test Acc: 0.278
Validation loss decreased (-0.155538 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.5442421436309814
Epoch: 3, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.493 Vali Acc: 0.481 Test Loss: 1.493 Test Acc: 0.481
Validation loss decreased (-0.277761 --> -0.481467).  Saving model ...
Epoch: 4 cost time: 0.5858638286590576
Epoch: 4, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.259 Vali Acc: 0.678 Test Loss: 1.259 Test Acc: 0.678
Validation loss decreased (-0.481467 --> -0.677765).  Saving model ...
Epoch: 5 cost time: 0.5811970233917236
Epoch: 5, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.017 Vali Acc: 0.819 Test Loss: 1.017 Test Acc: 0.819
Validation loss decreased (-0.677765 --> -0.818508).  Saving model ...
Epoch: 6 cost time: 0.5260603427886963
Epoch: 6, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.802 Vali Acc: 0.893 Test Loss: 0.802 Test Acc: 0.893
Validation loss decreased (-0.818508 --> -0.892585).  Saving model ...
Epoch: 7 cost time: 0.5723168849945068
Epoch: 7, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.636 Vali Acc: 0.896 Test Loss: 0.636 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896290).  Saving model ...
Epoch: 8 cost time: 0.5863168239593506
Epoch: 8, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.507 Vali Acc: 0.911 Test Loss: 0.507 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911106).  Saving model ...
Epoch: 9 cost time: 0.5121827125549316
Epoch: 9, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.414 Vali Acc: 0.911 Test Loss: 0.414 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 10 cost time: 0.6777687072753906
Epoch: 10, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.362 Vali Acc: 0.896 Test Loss: 0.362 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6346316337585449
Epoch: 11, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.312 Vali Acc: 0.911 Test Loss: 0.312 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 12 cost time: 0.5188331604003906
Epoch: 12, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
Validation loss decreased (-0.911108 --> -0.933331).  Saving model ...
Epoch: 13 cost time: 0.5470547676086426
Epoch: 13, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
Validation loss decreased (-0.933331 --> -0.951850).  Saving model ...
Epoch: 14 cost time: 0.49861955642700195
Epoch: 14, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5358412265777588
Epoch: 15, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4667823314666748
Epoch: 16, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5581574440002441
Epoch: 17, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.554999828338623
Epoch: 18, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6087687015533447
Epoch: 19, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5465700626373291
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5278162956237793
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.937 Test Loss: 0.167 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6310739517211914
Epoch: 22, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.937 Test Loss: 0.167 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.566643476486206
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.937 Test Loss: 0.167 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 133574
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.118537187576294
Epoch: 1, Steps: 2 | Train Loss: 2.085 Vali Loss: 1.942 Vali Acc: 0.096 Test Loss: 1.942 Test Acc: 0.096
Validation loss decreased (inf --> -0.096277).  Saving model ...
Epoch: 2 cost time: 0.5288903713226318
Epoch: 2, Steps: 2 | Train Loss: 1.958 Vali Loss: 1.849 Vali Acc: 0.107 Test Loss: 1.849 Test Acc: 0.107
Validation loss decreased (-0.096277 --> -0.107389).  Saving model ...
Epoch: 3 cost time: 0.44197940826416016
Epoch: 3, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.750 Vali Acc: 0.148 Test Loss: 1.750 Test Acc: 0.148
Validation loss decreased (-0.107389 --> -0.148131).  Saving model ...
Epoch: 4 cost time: 0.5116405487060547
Epoch: 4, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.613 Vali Acc: 0.207 Test Loss: 1.613 Test Acc: 0.207
Validation loss decreased (-0.148131 --> -0.207391).  Saving model ...
Epoch: 5 cost time: 0.5144236087799072
Epoch: 5, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.449 Vali Acc: 0.452 Test Loss: 1.449 Test Acc: 0.452
Validation loss decreased (-0.207391 --> -0.451837).  Saving model ...
Epoch: 6 cost time: 0.45519137382507324
Epoch: 6, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.276 Vali Acc: 0.600 Test Loss: 1.276 Test Acc: 0.600
Validation loss decreased (-0.451837 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 0.5164804458618164
Epoch: 7, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.108 Vali Acc: 0.689 Test Loss: 1.108 Test Acc: 0.689
Validation loss decreased (-0.599987 --> -0.688878).  Saving model ...
Epoch: 8 cost time: 0.5498747825622559
Epoch: 8, Steps: 2 | Train Loss: 1.009 Vali Loss: 0.956 Vali Acc: 0.711 Test Loss: 0.956 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711102).  Saving model ...
Epoch: 9 cost time: 0.47293639183044434
Epoch: 9, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.826 Vali Acc: 0.756 Test Loss: 0.826 Test Acc: 0.756
Validation loss decreased (-0.711102 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 0.4576730728149414
Epoch: 10, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.716 Vali Acc: 0.800 Test Loss: 0.716 Test Acc: 0.800
Validation loss decreased (-0.755547 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 0.4728705883026123
Epoch: 11, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.620 Vali Acc: 0.859 Test Loss: 0.620 Test Acc: 0.859
Validation loss decreased (-0.799993 --> -0.859253).  Saving model ...
Epoch: 12 cost time: 0.5799925327301025
Epoch: 12, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.538 Vali Acc: 0.874 Test Loss: 0.538 Test Acc: 0.874
Validation loss decreased (-0.859253 --> -0.874069).  Saving model ...
Epoch: 13 cost time: 0.48510026931762695
Epoch: 13, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
Validation loss decreased (-0.874069 --> -0.888884).  Saving model ...
Epoch: 14 cost time: 0.5128405094146729
Epoch: 14, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.410 Vali Acc: 0.904 Test Loss: 0.410 Test Acc: 0.904
Validation loss decreased (-0.888884 --> -0.903700).  Saving model ...
Epoch: 15 cost time: 0.5208480358123779
Epoch: 15, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.365 Vali Acc: 0.911 Test Loss: 0.365 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911107).  Saving model ...
Epoch: 16 cost time: 0.5611233711242676
Epoch: 16, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.325 Vali Acc: 0.922 Test Loss: 0.325 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.5191173553466797
Epoch: 17, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 18 cost time: 0.5355958938598633
Epoch: 18, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.267 Vali Acc: 0.915 Test Loss: 0.267 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.539487361907959
Epoch: 19, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5169494152069092
Epoch: 20, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.246 Vali Acc: 0.907 Test Loss: 0.246 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.590329647064209
Epoch: 21, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5489420890808105
Epoch: 22, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5409133434295654
Epoch: 23, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.222 Vali Acc: 0.915 Test Loss: 0.222 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5150589942932129
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 0.465803861618042
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 0.4866318702697754
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.4921145439147949
Epoch: 27, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4725039005279541
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.5547463893890381
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.478010892868042
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5117790699005127
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5434393882751465
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5584244728088379
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.926 Test Loss: 0.191 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6098780632019043
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5166442394256592
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.926 Test Loss: 0.195 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5546314716339111
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.926 Test Loss: 0.195 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.47807765007019043
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.4487142562866211
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.49352598190307617
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 83014
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1722278594970703
Epoch: 1, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.705 Vali Acc: 0.359 Test Loss: 1.705 Test Acc: 0.359
Validation loss decreased (inf --> -0.359242).  Saving model ...
Epoch: 2 cost time: 0.44095540046691895
Epoch: 2, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.631 Vali Acc: 0.378 Test Loss: 1.631 Test Acc: 0.378
Validation loss decreased (-0.359242 --> -0.377761).  Saving model ...
Epoch: 3 cost time: 0.4855504035949707
Epoch: 3, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.561 Vali Acc: 0.389 Test Loss: 1.561 Test Acc: 0.389
Validation loss decreased (-0.377761 --> -0.388873).  Saving model ...
Epoch: 4 cost time: 0.4607994556427002
Epoch: 4, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.471 Vali Acc: 0.426 Test Loss: 1.471 Test Acc: 0.426
Validation loss decreased (-0.388873 --> -0.425911).  Saving model ...
Epoch: 5 cost time: 0.468245267868042
Epoch: 5, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.362 Vali Acc: 0.478 Test Loss: 1.362 Test Acc: 0.478
Validation loss decreased (-0.425911 --> -0.477764).  Saving model ...
Epoch: 6 cost time: 0.48334240913391113
Epoch: 6, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.244 Vali Acc: 0.567 Test Loss: 1.244 Test Acc: 0.567
Validation loss decreased (-0.477764 --> -0.566654).  Saving model ...
Epoch: 7 cost time: 0.4683547019958496
Epoch: 7, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.126 Vali Acc: 0.678 Test Loss: 1.126 Test Acc: 0.678
Validation loss decreased (-0.566654 --> -0.677767).  Saving model ...
Epoch: 8 cost time: 0.5170385837554932
Epoch: 8, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.012 Vali Acc: 0.752 Test Loss: 1.012 Test Acc: 0.752
Validation loss decreased (-0.677767 --> -0.751842).  Saving model ...
Epoch: 9 cost time: 0.4391169548034668
Epoch: 9, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.907 Vali Acc: 0.800 Test Loss: 0.907 Test Acc: 0.800
Validation loss decreased (-0.751842 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.47867536544799805
Epoch: 10, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.814 Vali Acc: 0.807 Test Loss: 0.814 Test Acc: 0.807
Validation loss decreased (-0.799991 --> -0.807399).  Saving model ...
Epoch: 11 cost time: 0.4613170623779297
Epoch: 11, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.730 Vali Acc: 0.819 Test Loss: 0.730 Test Acc: 0.819
Validation loss decreased (-0.807399 --> -0.818511).  Saving model ...
Epoch: 12 cost time: 0.43804192543029785
Epoch: 12, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.651 Vali Acc: 0.863 Test Loss: 0.651 Test Acc: 0.863
Validation loss decreased (-0.818511 --> -0.862956).  Saving model ...
Epoch: 13 cost time: 0.48155689239501953
Epoch: 13, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.581 Vali Acc: 0.870 Test Loss: 0.581 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870365).  Saving model ...
Epoch: 14 cost time: 0.48308587074279785
Epoch: 14, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.517 Vali Acc: 0.904 Test Loss: 0.517 Test Acc: 0.904
Validation loss decreased (-0.870365 --> -0.903699).  Saving model ...
Epoch: 15 cost time: 0.5253891944885254
Epoch: 15, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.461 Vali Acc: 0.907 Test Loss: 0.461 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 16 cost time: 0.44063520431518555
Epoch: 16, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.415 Vali Acc: 0.915 Test Loss: 0.415 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 17 cost time: 0.5469274520874023
Epoch: 17, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.376 Vali Acc: 0.919 Test Loss: 0.376 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 18 cost time: 0.5549261569976807
Epoch: 18, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 19 cost time: 0.49956631660461426
Epoch: 19, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.523324728012085
Epoch: 20, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.301 Vali Acc: 0.915 Test Loss: 0.301 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.42041540145874023
Epoch: 21, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.281 Vali Acc: 0.919 Test Loss: 0.281 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.455136775970459
Epoch: 22, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.539804220199585
Epoch: 23, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.253 Vali Acc: 0.919 Test Loss: 0.253 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.49721574783325195
Epoch: 24, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.45398521423339844
Epoch: 25, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 0.5121495723724365
Epoch: 26, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 27 cost time: 0.45841360092163086
Epoch: 27, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 0.5081462860107422
Epoch: 28, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.4979884624481201
Epoch: 29, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.47033190727233887
Epoch: 30, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 31 cost time: 0.4626281261444092
Epoch: 31, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 32 cost time: 0.4787735939025879
Epoch: 32, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 33 cost time: 0.44469571113586426
Epoch: 33, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 34 cost time: 0.5031204223632812
Epoch: 34, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.6039614677429199
Epoch: 35, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.5313272476196289
Epoch: 36, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.5362794399261475
Epoch: 37, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.4911322593688965
Epoch: 38, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.5212969779968262
Epoch: 39, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.47504520416259766
Epoch: 40, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.48150157928466797
Epoch: 41, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.49973583221435547
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.4915471076965332
Epoch: 43, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.4931199550628662
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.47799205780029297
Epoch: 45, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5266842842102051
Epoch: 46, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6138420104980469
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5315349102020264
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 49 cost time: 0.5182077884674072
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 50 cost time: 0.49596261978149414
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5426185131072998
Epoch: 51, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 52 cost time: 0.47562623023986816
Epoch: 52, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 53 cost time: 0.6340610980987549
Epoch: 53, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 54 cost time: 0.4873669147491455
Epoch: 54, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 55 cost time: 0.4623756408691406
Epoch: 55, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 56 cost time: 0.5745158195495605
Epoch: 56, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.46839237213134766
Epoch: 57, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.4550142288208008
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5930492877960205
Epoch: 59, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5021026134490967
Epoch: 60, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.5472762584686279
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.5373797416687012
Epoch: 62, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.48779726028442383
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.5180790424346924
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.5221583843231201
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 67718
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8857109546661377
Epoch: 1, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.985 Vali Acc: 0.307 Test Loss: 1.985 Test Acc: 0.307
Validation loss decreased (inf --> -0.307388).  Saving model ...
Epoch: 2 cost time: 0.5361554622650146
Epoch: 2, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.895 Vali Acc: 0.344 Test Loss: 1.895 Test Acc: 0.344
Validation loss decreased (-0.307388 --> -0.344425).  Saving model ...
Epoch: 3 cost time: 0.5046463012695312
Epoch: 3, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.812 Vali Acc: 0.385 Test Loss: 1.812 Test Acc: 0.385
Validation loss decreased (-0.344425 --> -0.385167).  Saving model ...
Epoch: 4 cost time: 0.515242338180542
Epoch: 4, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.717 Vali Acc: 0.415 Test Loss: 1.717 Test Acc: 0.415
Validation loss decreased (-0.385167 --> -0.414798).  Saving model ...
Epoch: 5 cost time: 0.5252223014831543
Epoch: 5, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.606 Vali Acc: 0.426 Test Loss: 1.606 Test Acc: 0.426
Validation loss decreased (-0.414798 --> -0.425910).  Saving model ...
Epoch: 6 cost time: 0.541111946105957
Epoch: 6, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.483 Vali Acc: 0.474 Test Loss: 1.483 Test Acc: 0.474
Validation loss decreased (-0.425910 --> -0.474059).  Saving model ...
Epoch: 7 cost time: 0.4481770992279053
Epoch: 7, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.355 Vali Acc: 0.526 Test Loss: 1.355 Test Acc: 0.526
Validation loss decreased (-0.474059 --> -0.525912).  Saving model ...
Epoch: 8 cost time: 0.4483790397644043
Epoch: 8, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.227 Vali Acc: 0.611 Test Loss: 1.227 Test Acc: 0.611
Validation loss decreased (-0.525912 --> -0.611099).  Saving model ...
Epoch: 9 cost time: 0.548306941986084
Epoch: 9, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.103 Vali Acc: 0.707 Test Loss: 1.103 Test Acc: 0.707
Validation loss decreased (-0.611099 --> -0.707396).  Saving model ...
Epoch: 10 cost time: 0.5029482841491699
Epoch: 10, Steps: 2 | Train Loss: 1.007 Vali Loss: 0.987 Vali Acc: 0.756 Test Loss: 0.987 Test Acc: 0.756
Validation loss decreased (-0.707396 --> -0.755546).  Saving model ...
Epoch: 11 cost time: 0.4848320484161377
Epoch: 11, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.881 Vali Acc: 0.807 Test Loss: 0.881 Test Acc: 0.807
Validation loss decreased (-0.755546 --> -0.807399).  Saving model ...
Epoch: 12 cost time: 0.5041918754577637
Epoch: 12, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.784 Vali Acc: 0.837 Test Loss: 0.784 Test Acc: 0.837
Validation loss decreased (-0.807399 --> -0.837029).  Saving model ...
Epoch: 13 cost time: 0.4833333492279053
Epoch: 13, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.700 Vali Acc: 0.859 Test Loss: 0.700 Test Acc: 0.859
Validation loss decreased (-0.837029 --> -0.859252).  Saving model ...
Epoch: 14 cost time: 0.4675612449645996
Epoch: 14, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.628 Vali Acc: 0.863 Test Loss: 0.628 Test Acc: 0.863
Validation loss decreased (-0.859252 --> -0.862957).  Saving model ...
Epoch: 15 cost time: 0.529179573059082
Epoch: 15, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.566 Vali Acc: 0.889 Test Loss: 0.566 Test Acc: 0.889
Validation loss decreased (-0.862957 --> -0.888883).  Saving model ...
Epoch: 16 cost time: 0.4926619529724121
Epoch: 16, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.510 Vali Acc: 0.907 Test Loss: 0.510 Test Acc: 0.907
Validation loss decreased (-0.888883 --> -0.907402).  Saving model ...
Epoch: 17 cost time: 0.4697911739349365
Epoch: 17, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.464 Vali Acc: 0.915 Test Loss: 0.464 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 18 cost time: 0.5393891334533691
Epoch: 18, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.425 Vali Acc: 0.922 Test Loss: 0.425 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 19 cost time: 0.5268654823303223
Epoch: 19, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.390 Vali Acc: 0.922 Test Loss: 0.390 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 20 cost time: 0.5052902698516846
Epoch: 20, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.360 Vali Acc: 0.933 Test Loss: 0.360 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933330).  Saving model ...
Epoch: 21 cost time: 0.5349068641662598
Epoch: 21, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.335 Vali Acc: 0.933 Test Loss: 0.335 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 22 cost time: 0.5145914554595947
Epoch: 22, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 23 cost time: 0.46514177322387695
Epoch: 23, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5928168296813965
Epoch: 24, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6674606800079346
Epoch: 25, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5118141174316406
Epoch: 26, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6211228370666504
Epoch: 27, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5822622776031494
Epoch: 28, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5173864364624023
Epoch: 29, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5208384990692139
Epoch: 30, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.5130214691162109
Epoch: 31, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.46656346321105957
Epoch: 32, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.5012526512145996
Epoch: 33, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.5390820503234863
Epoch: 34, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.48157429695129395
Epoch: 35, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5494461059570312
Epoch: 36, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5896248817443848
Epoch: 37, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4698152542114258
Epoch: 38, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5482041835784912
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5887942314147949
Epoch: 40, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 41 cost time: 0.47878003120422363
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 42 cost time: 0.5042471885681152
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.5098850727081299
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.4751286506652832
Epoch: 44, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.5734724998474121
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.5834405422210693
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.48921871185302734
Epoch: 47, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.5374188423156738
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4882638454437256
Epoch: 49, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4397435188293457
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 51 cost time: 0.5328936576843262
Epoch: 51, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 52 cost time: 0.5327708721160889
Epoch: 52, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 53 cost time: 0.5599596500396729
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 54 cost time: 0.4632229804992676
Epoch: 54, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 55 cost time: 0.48725390434265137
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.555300235748291
Epoch: 56, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 57 cost time: 0.46824026107788086
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 58 cost time: 0.6061906814575195
Epoch: 58, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 59 cost time: 0.5084953308105469
Epoch: 59, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 60 cost time: 0.5202295780181885
Epoch: 60, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 61 cost time: 0.5439682006835938
Epoch: 61, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.566370964050293
Epoch: 62, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.5490047931671143
Epoch: 63, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 64 cost time: 0.5119695663452148
Epoch: 64, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 65 cost time: 0.5232391357421875
Epoch: 65, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 66 cost time: 0.5775260925292969
Epoch: 66, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 67 cost time: 0.5455143451690674
Epoch: 67, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 68 cost time: 0.539970874786377
Epoch: 68, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 69 cost time: 0.49226832389831543
Epoch: 69, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 70 cost time: 0.5187380313873291
Epoch: 70, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 71 cost time: 0.5016300678253174
Epoch: 71, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 72 cost time: 0.46721410751342773
Epoch: 72, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 73 cost time: 0.6311588287353516
Epoch: 73, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.5520055294036865
Epoch: 74, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.5007655620574951
Epoch: 75, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.5302474498748779
Epoch: 76, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.5255577564239502
Epoch: 77, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.5521671772003174
Epoch: 78, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.49677395820617676
Epoch: 79, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.6047062873840332
Epoch: 80, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.5895988941192627
Epoch: 81, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.5803899765014648
Epoch: 82, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 58630
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.949099063873291
Epoch: 1, Steps: 2 | Train Loss: 1.965 Vali Loss: 1.861 Vali Acc: 0.019 Test Loss: 1.861 Test Acc: 0.019
Validation loss decreased (inf --> -0.018500).  Saving model ...
Epoch: 2 cost time: 0.4642813205718994
Epoch: 2, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.793 Vali Acc: 0.056 Test Loss: 1.793 Test Acc: 0.056
Validation loss decreased (-0.018500 --> -0.055538).  Saving model ...
Epoch: 3 cost time: 0.539522647857666
Epoch: 3, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.736 Vali Acc: 0.093 Test Loss: 1.736 Test Acc: 0.093
Validation loss decreased (-0.055538 --> -0.092575).  Saving model ...
Epoch: 4 cost time: 0.5878922939300537
Epoch: 4, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.673 Vali Acc: 0.156 Test Loss: 1.673 Test Acc: 0.156
Validation loss decreased (-0.092575 --> -0.155539).  Saving model ...
Epoch: 5 cost time: 0.5118765830993652
Epoch: 5, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.594 Vali Acc: 0.226 Test Loss: 1.594 Test Acc: 0.226
Validation loss decreased (-0.155539 --> -0.225910).  Saving model ...
Epoch: 6 cost time: 0.467944860458374
Epoch: 6, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.503 Vali Acc: 0.359 Test Loss: 1.503 Test Acc: 0.359
Validation loss decreased (-0.225910 --> -0.359244).  Saving model ...
Epoch: 7 cost time: 0.5388057231903076
Epoch: 7, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.405 Vali Acc: 0.515 Test Loss: 1.405 Test Acc: 0.515
Validation loss decreased (-0.359244 --> -0.514801).  Saving model ...
Epoch: 8 cost time: 0.5707714557647705
Epoch: 8, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.302 Vali Acc: 0.604 Test Loss: 1.302 Test Acc: 0.604
Validation loss decreased (-0.514801 --> -0.603691).  Saving model ...
Epoch: 9 cost time: 0.5700116157531738
Epoch: 9, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.198 Vali Acc: 0.689 Test Loss: 1.198 Test Acc: 0.689
Validation loss decreased (-0.603691 --> -0.688877).  Saving model ...
Epoch: 10 cost time: 0.4996302127838135
Epoch: 10, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.095 Vali Acc: 0.733 Test Loss: 1.095 Test Acc: 0.733
Validation loss decreased (-0.688877 --> -0.733322).  Saving model ...
Epoch: 11 cost time: 0.4956998825073242
Epoch: 11, Steps: 2 | Train Loss: 1.081 Vali Loss: 0.997 Vali Acc: 0.748 Test Loss: 0.997 Test Acc: 0.748
Validation loss decreased (-0.733322 --> -0.748138).  Saving model ...
Epoch: 12 cost time: 0.48560070991516113
Epoch: 12, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.906 Vali Acc: 0.785 Test Loss: 0.906 Test Acc: 0.785
Validation loss decreased (-0.748138 --> -0.785176).  Saving model ...
Epoch: 13 cost time: 0.49982643127441406
Epoch: 13, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.823 Vali Acc: 0.789 Test Loss: 0.823 Test Acc: 0.789
Validation loss decreased (-0.785176 --> -0.788881).  Saving model ...
Epoch: 14 cost time: 0.5057966709136963
Epoch: 14, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
Validation loss decreased (-0.788881 --> -0.796289).  Saving model ...
Epoch: 15 cost time: 0.472670316696167
Epoch: 15, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
Validation loss decreased (-0.796289 --> -0.822215).  Saving model ...
Epoch: 16 cost time: 0.4353921413421631
Epoch: 16, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.622 Vali Acc: 0.859 Test Loss: 0.622 Test Acc: 0.859
Validation loss decreased (-0.822215 --> -0.859253).  Saving model ...
Epoch: 17 cost time: 0.4040539264678955
Epoch: 17, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.570 Vali Acc: 0.878 Test Loss: 0.570 Test Acc: 0.878
Validation loss decreased (-0.859253 --> -0.877772).  Saving model ...
Epoch: 18 cost time: 0.48670506477355957
Epoch: 18, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.525 Vali Acc: 0.881 Test Loss: 0.525 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 19 cost time: 0.6081206798553467
Epoch: 19, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.482 Vali Acc: 0.885 Test Loss: 0.482 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 20 cost time: 0.5427417755126953
Epoch: 20, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.444 Vali Acc: 0.896 Test Loss: 0.444 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896292).  Saving model ...
Epoch: 21 cost time: 0.4855687618255615
Epoch: 21, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.412 Vali Acc: 0.893 Test Loss: 0.412 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4536783695220947
Epoch: 22, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4769010543823242
Epoch: 23, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.362 Vali Acc: 0.896 Test Loss: 0.362 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896293).  Saving model ...
Epoch: 24 cost time: 0.5348107814788818
Epoch: 24, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.343 Vali Acc: 0.896 Test Loss: 0.343 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 25 cost time: 0.5094485282897949
Epoch: 25, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 0.4609050750732422
Epoch: 26, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.309 Vali Acc: 0.907 Test Loss: 0.309 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907404).  Saving model ...
Epoch: 27 cost time: 0.4429619312286377
Epoch: 27, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.296 Vali Acc: 0.915 Test Loss: 0.296 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 28 cost time: 0.5374479293823242
Epoch: 28, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
Validation loss decreased (-0.914812 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.6013901233673096
Epoch: 29, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.514622688293457
Epoch: 30, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.4776039123535156
Epoch: 31, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 32 cost time: 0.506427526473999
Epoch: 32, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 33 cost time: 0.44419121742248535
Epoch: 33, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.4692976474761963
Epoch: 34, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 35 cost time: 0.5046775341033936
Epoch: 35, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.518808126449585
Epoch: 36, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 37 cost time: 0.5176875591278076
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 38 cost time: 0.5167281627655029
Epoch: 38, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 0.469545841217041
Epoch: 39, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5336380004882812
Epoch: 40, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.502450704574585
Epoch: 41, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.48745274543762207
Epoch: 42, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5015230178833008
Epoch: 43, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5080368518829346
Epoch: 44, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5471668243408203
Epoch: 45, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5391659736633301
Epoch: 46, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.4955744743347168
Epoch: 47, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.4685385227203369
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.919 Test Loss: 0.201 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 54214
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0727219581604004
Epoch: 1, Steps: 2 | Train Loss: 2.068 Vali Loss: 1.807 Vali Acc: 0.204 Test Loss: 1.807 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.4395923614501953
Epoch: 2, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.747 Vali Acc: 0.200 Test Loss: 1.747 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5088565349578857
Epoch: 3, Steps: 2 | Train Loss: 2.061 Vali Loss: 1.700 Vali Acc: 0.204 Test Loss: 1.700 Test Acc: 0.204
Validation loss decreased (-0.203686 --> -0.203687).  Saving model ...
Epoch: 4 cost time: 0.4581277370452881
Epoch: 4, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.652 Vali Acc: 0.230 Test Loss: 1.652 Test Acc: 0.230
Validation loss decreased (-0.203687 --> -0.229613).  Saving model ...
Epoch: 5 cost time: 0.5234150886535645
Epoch: 5, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.591 Vali Acc: 0.274 Test Loss: 1.591 Test Acc: 0.274
Validation loss decreased (-0.229613 --> -0.274058).  Saving model ...
Epoch: 6 cost time: 0.49954819679260254
Epoch: 6, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.521 Vali Acc: 0.374 Test Loss: 1.521 Test Acc: 0.374
Validation loss decreased (-0.274058 --> -0.374059).  Saving model ...
Epoch: 7 cost time: 0.5953030586242676
Epoch: 7, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.444 Vali Acc: 0.444 Test Loss: 1.444 Test Acc: 0.444
Validation loss decreased (-0.374059 --> -0.444430).  Saving model ...
Epoch: 8 cost time: 0.5186553001403809
Epoch: 8, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.363 Vali Acc: 0.556 Test Loss: 1.363 Test Acc: 0.556
Validation loss decreased (-0.444430 --> -0.555542).  Saving model ...
Epoch: 9 cost time: 0.49944114685058594
Epoch: 9, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.279 Vali Acc: 0.644 Test Loss: 1.279 Test Acc: 0.644
Validation loss decreased (-0.555542 --> -0.644432).  Saving model ...
Epoch: 10 cost time: 0.5154461860656738
Epoch: 10, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.194 Vali Acc: 0.719 Test Loss: 1.194 Test Acc: 0.719
Validation loss decreased (-0.644432 --> -0.718507).  Saving model ...
Epoch: 11 cost time: 0.5831458568572998
Epoch: 11, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.111 Vali Acc: 0.767 Test Loss: 1.111 Test Acc: 0.767
Validation loss decreased (-0.718507 --> -0.766656).  Saving model ...
Epoch: 12 cost time: 0.7134296894073486
Epoch: 12, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.030 Vali Acc: 0.793 Test Loss: 1.030 Test Acc: 0.793
Validation loss decreased (-0.766656 --> -0.792582).  Saving model ...
Epoch: 13 cost time: 0.5120425224304199
Epoch: 13, Steps: 2 | Train Loss: 1.016 Vali Loss: 0.953 Vali Acc: 0.819 Test Loss: 0.953 Test Acc: 0.819
Validation loss decreased (-0.792582 --> -0.818509).  Saving model ...
Epoch: 14 cost time: 0.5153627395629883
Epoch: 14, Steps: 2 | Train Loss: 0.976 Vali Loss: 0.879 Vali Acc: 0.859 Test Loss: 0.879 Test Acc: 0.859
Validation loss decreased (-0.818509 --> -0.859250).  Saving model ...
Epoch: 15 cost time: 0.4708571434020996
Epoch: 15, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.811 Vali Acc: 0.878 Test Loss: 0.811 Test Acc: 0.878
Validation loss decreased (-0.859250 --> -0.877770).  Saving model ...
Epoch: 16 cost time: 0.4698514938354492
Epoch: 16, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.747 Vali Acc: 0.885 Test Loss: 0.747 Test Acc: 0.885
Validation loss decreased (-0.877770 --> -0.885178).  Saving model ...
Epoch: 17 cost time: 0.554757833480835
Epoch: 17, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.691 Vali Acc: 0.889 Test Loss: 0.691 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 18 cost time: 0.5649962425231934
Epoch: 18, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.639 Vali Acc: 0.896 Test Loss: 0.639 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 19 cost time: 0.5044159889221191
Epoch: 19, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.592 Vali Acc: 0.900 Test Loss: 0.592 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 0.606224536895752
Epoch: 20, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 0.5166020393371582
Epoch: 21, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.513 Vali Acc: 0.907 Test Loss: 0.513 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 22 cost time: 0.5543365478515625
Epoch: 22, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.478 Vali Acc: 0.922 Test Loss: 0.478 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922217).  Saving model ...
Epoch: 23 cost time: 0.5677893161773682
Epoch: 23, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.448 Vali Acc: 0.926 Test Loss: 0.448 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 24 cost time: 0.5183849334716797
Epoch: 24, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.422 Vali Acc: 0.922 Test Loss: 0.422 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6183791160583496
Epoch: 25, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.398 Vali Acc: 0.926 Test Loss: 0.398 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 26 cost time: 0.5209834575653076
Epoch: 26, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.378 Vali Acc: 0.926 Test Loss: 0.378 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 27 cost time: 0.5377945899963379
Epoch: 27, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5105884075164795
Epoch: 28, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.345 Vali Acc: 0.919 Test Loss: 0.345 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4489023685455322
Epoch: 29, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.332 Vali Acc: 0.919 Test Loss: 0.332 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6194603443145752
Epoch: 30, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.321 Vali Acc: 0.930 Test Loss: 0.321 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 31 cost time: 0.6229255199432373
Epoch: 31, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5564689636230469
Epoch: 32, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.297 Vali Acc: 0.933 Test Loss: 0.297 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 33 cost time: 0.6229114532470703
Epoch: 33, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.287 Vali Acc: 0.937 Test Loss: 0.287 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 34 cost time: 0.4794278144836426
Epoch: 34, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 35 cost time: 0.47469258308410645
Epoch: 35, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 36 cost time: 0.5390400886535645
Epoch: 36, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.261 Vali Acc: 0.941 Test Loss: 0.261 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.4467954635620117
Epoch: 37, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.4450862407684326
Epoch: 38, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.515817403793335
Epoch: 39, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.248 Vali Acc: 0.948 Test Loss: 0.248 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.47254300117492676
Epoch: 40, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.245 Vali Acc: 0.948 Test Loss: 0.245 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.4957096576690674
Epoch: 41, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6999640464782715
Epoch: 42, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.4970831871032715
Epoch: 43, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5421631336212158
Epoch: 44, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6025397777557373
Epoch: 45, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5439014434814453
Epoch: 46, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5191895961761475
Epoch: 47, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6367714405059814
Epoch: 48, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.44246912002563477
Epoch: 49, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.5204253196716309
Epoch: 50, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 48262
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0190253257751465
Epoch: 1, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.821 Vali Acc: 0.178 Test Loss: 1.821 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.47264838218688965
Epoch: 2, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.770 Vali Acc: 0.196 Test Loss: 1.770 Test Acc: 0.196
Validation loss decreased (-0.177760 --> -0.196279).  Saving model ...
Epoch: 3 cost time: 0.4761621952056885
Epoch: 3, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.730 Vali Acc: 0.215 Test Loss: 1.730 Test Acc: 0.215
Validation loss decreased (-0.196279 --> -0.214798).  Saving model ...
Epoch: 4 cost time: 0.430830717086792
Epoch: 4, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.691 Vali Acc: 0.241 Test Loss: 1.691 Test Acc: 0.241
Validation loss decreased (-0.214798 --> -0.240724).  Saving model ...
Epoch: 5 cost time: 0.41877317428588867
Epoch: 5, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.642 Vali Acc: 0.289 Test Loss: 1.642 Test Acc: 0.289
Validation loss decreased (-0.240724 --> -0.288872).  Saving model ...
Epoch: 6 cost time: 0.5116400718688965
Epoch: 6, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.586 Vali Acc: 0.381 Test Loss: 1.586 Test Acc: 0.381
Validation loss decreased (-0.288872 --> -0.381466).  Saving model ...
Epoch: 7 cost time: 0.5187034606933594
Epoch: 7, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.524 Vali Acc: 0.467 Test Loss: 1.524 Test Acc: 0.467
Validation loss decreased (-0.381466 --> -0.466651).  Saving model ...
Epoch: 8 cost time: 0.4944143295288086
Epoch: 8, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.458 Vali Acc: 0.493 Test Loss: 1.458 Test Acc: 0.493
Validation loss decreased (-0.466651 --> -0.492578).  Saving model ...
Epoch: 9 cost time: 0.5589170455932617
Epoch: 9, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.388 Vali Acc: 0.537 Test Loss: 1.388 Test Acc: 0.537
Validation loss decreased (-0.492578 --> -0.537023).  Saving model ...
Epoch: 10 cost time: 0.5151669979095459
Epoch: 10, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.317 Vali Acc: 0.593 Test Loss: 1.317 Test Acc: 0.593
Validation loss decreased (-0.537023 --> -0.592579).  Saving model ...
Epoch: 11 cost time: 0.46387147903442383
Epoch: 11, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.246 Vali Acc: 0.637 Test Loss: 1.246 Test Acc: 0.637
Validation loss decreased (-0.592579 --> -0.637025).  Saving model ...
Epoch: 12 cost time: 0.4334602355957031
Epoch: 12, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.176 Vali Acc: 0.667 Test Loss: 1.176 Test Acc: 0.667
Validation loss decreased (-0.637025 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 0.4021167755126953
Epoch: 13, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.108 Vali Acc: 0.707 Test Loss: 1.108 Test Acc: 0.707
Validation loss decreased (-0.666655 --> -0.707396).  Saving model ...
Epoch: 14 cost time: 0.4407637119293213
Epoch: 14, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.041 Vali Acc: 0.741 Test Loss: 1.041 Test Acc: 0.741
Validation loss decreased (-0.707396 --> -0.740730).  Saving model ...
Epoch: 15 cost time: 0.4150540828704834
Epoch: 15, Steps: 2 | Train Loss: 0.958 Vali Loss: 0.978 Vali Acc: 0.759 Test Loss: 0.978 Test Acc: 0.759
Validation loss decreased (-0.740730 --> -0.759249).  Saving model ...
Epoch: 16 cost time: 0.4452791213989258
Epoch: 16, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.918 Vali Acc: 0.778 Test Loss: 0.918 Test Acc: 0.778
Validation loss decreased (-0.759249 --> -0.777769).  Saving model ...
Epoch: 17 cost time: 0.5706572532653809
Epoch: 17, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.863 Vali Acc: 0.793 Test Loss: 0.863 Test Acc: 0.793
Validation loss decreased (-0.777769 --> -0.792584).  Saving model ...
Epoch: 18 cost time: 0.47713756561279297
Epoch: 18, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.810 Vali Acc: 0.807 Test Loss: 0.810 Test Acc: 0.807
Validation loss decreased (-0.792584 --> -0.807399).  Saving model ...
Epoch: 19 cost time: 0.5266287326812744
Epoch: 19, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.761 Vali Acc: 0.815 Test Loss: 0.761 Test Acc: 0.815
Validation loss decreased (-0.807399 --> -0.814807).  Saving model ...
Epoch: 20 cost time: 0.5113394260406494
Epoch: 20, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.714 Vali Acc: 0.826 Test Loss: 0.714 Test Acc: 0.826
Validation loss decreased (-0.814807 --> -0.825919).  Saving model ...
Epoch: 21 cost time: 0.5551478862762451
Epoch: 21, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.672 Vali Acc: 0.837 Test Loss: 0.672 Test Acc: 0.837
Validation loss decreased (-0.825919 --> -0.837030).  Saving model ...
Epoch: 22 cost time: 0.46541476249694824
Epoch: 22, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.633 Vali Acc: 0.859 Test Loss: 0.633 Test Acc: 0.859
Validation loss decreased (-0.837030 --> -0.859253).  Saving model ...
Epoch: 23 cost time: 0.5137953758239746
Epoch: 23, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.595 Vali Acc: 0.874 Test Loss: 0.595 Test Acc: 0.874
Validation loss decreased (-0.859253 --> -0.874068).  Saving model ...
Epoch: 24 cost time: 0.5292725563049316
Epoch: 24, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.561 Vali Acc: 0.896 Test Loss: 0.561 Test Acc: 0.896
Validation loss decreased (-0.874068 --> -0.896291).  Saving model ...
Epoch: 25 cost time: 0.5333237648010254
Epoch: 25, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.528 Vali Acc: 0.907 Test Loss: 0.528 Test Acc: 0.907
Validation loss decreased (-0.896291 --> -0.907402).  Saving model ...
Epoch: 26 cost time: 0.5270147323608398
Epoch: 26, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.498 Vali Acc: 0.915 Test Loss: 0.498 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 27 cost time: 0.5036239624023438
Epoch: 27, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.471 Vali Acc: 0.907 Test Loss: 0.471 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5623354911804199
Epoch: 28, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.446 Vali Acc: 0.907 Test Loss: 0.446 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.49822115898132324
Epoch: 29, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.423 Vali Acc: 0.911 Test Loss: 0.423 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5006694793701172
Epoch: 30, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.403 Vali Acc: 0.915 Test Loss: 0.403 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 31 cost time: 0.47655320167541504
Epoch: 31, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.385 Vali Acc: 0.911 Test Loss: 0.385 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5441482067108154
Epoch: 32, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.369 Vali Acc: 0.915 Test Loss: 0.369 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 33 cost time: 0.49800992012023926
Epoch: 33, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.355 Vali Acc: 0.919 Test Loss: 0.355 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 34 cost time: 0.50274658203125
Epoch: 34, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 35 cost time: 0.5025255680084229
Epoch: 35, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.330 Vali Acc: 0.926 Test Loss: 0.330 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 36 cost time: 0.5466763973236084
Epoch: 36, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.319 Vali Acc: 0.937 Test Loss: 0.319 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937034).  Saving model ...
Epoch: 37 cost time: 0.49213719367980957
Epoch: 37, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.311 Vali Acc: 0.926 Test Loss: 0.311 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5307028293609619
Epoch: 38, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4379730224609375
Epoch: 39, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.295 Vali Acc: 0.926 Test Loss: 0.295 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.43590807914733887
Epoch: 40, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.42439985275268555
Epoch: 41, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.4274425506591797
Epoch: 42, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.4861266613006592
Epoch: 43, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5102097988128662
Epoch: 44, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.269 Vali Acc: 0.930 Test Loss: 0.269 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.4938693046569824
Epoch: 45, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.46576642990112305
Epoch: 46, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 45446
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.055586576461792
Epoch: 1, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.728 Vali Acc: 0.193 Test Loss: 1.728 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.5322282314300537
Epoch: 2, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.585 Vali Acc: 0.237 Test Loss: 1.585 Test Acc: 0.237
Validation loss decreased (-0.192575 --> -0.237021).  Saving model ...
Epoch: 3 cost time: 0.7315263748168945
Epoch: 3, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.424 Vali Acc: 0.348 Test Loss: 1.424 Test Acc: 0.348
Validation loss decreased (-0.237021 --> -0.348134).  Saving model ...
Epoch: 4 cost time: 0.6274588108062744
Epoch: 4, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.194 Vali Acc: 0.663 Test Loss: 1.194 Test Acc: 0.663
Validation loss decreased (-0.348134 --> -0.662951).  Saving model ...
Epoch: 5 cost time: 0.504957914352417
Epoch: 5, Steps: 2 | Train Loss: 0.999 Vali Loss: 0.968 Vali Acc: 0.789 Test Loss: 0.968 Test Acc: 0.789
Validation loss decreased (-0.662951 --> -0.788879).  Saving model ...
Epoch: 6 cost time: 0.458392858505249
Epoch: 6, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.780 Vali Acc: 0.826 Test Loss: 0.780 Test Acc: 0.826
Validation loss decreased (-0.788879 --> -0.825918).  Saving model ...
Epoch: 7 cost time: 0.5495884418487549
Epoch: 7, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.627 Vali Acc: 0.870 Test Loss: 0.627 Test Acc: 0.870
Validation loss decreased (-0.825918 --> -0.870364).  Saving model ...
Epoch: 8 cost time: 0.6510396003723145
Epoch: 8, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.517 Vali Acc: 0.893 Test Loss: 0.517 Test Acc: 0.893
Validation loss decreased (-0.870364 --> -0.892587).  Saving model ...
Epoch: 9 cost time: 0.49916696548461914
Epoch: 9, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.431 Vali Acc: 0.907 Test Loss: 0.431 Test Acc: 0.907
Validation loss decreased (-0.892587 --> -0.907403).  Saving model ...
Epoch: 10 cost time: 0.5562334060668945
Epoch: 10, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.365 Vali Acc: 0.915 Test Loss: 0.365 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 11 cost time: 0.542905330657959
Epoch: 11, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6499919891357422
Epoch: 12, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.275 Vali Acc: 0.915 Test Loss: 0.275 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 13 cost time: 0.5647783279418945
Epoch: 13, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 14 cost time: 0.5257751941680908
Epoch: 14, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.914812 --> -0.929627).  Saving model ...
Epoch: 15 cost time: 0.5180165767669678
Epoch: 15, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 16 cost time: 0.47101569175720215
Epoch: 16, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.5150706768035889
Epoch: 17, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5262186527252197
Epoch: 18, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5314266681671143
Epoch: 19, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.589820146560669
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6098947525024414
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.549321174621582
Epoch: 22, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.926 Test Loss: 0.198 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5958318710327148
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5779809951782227
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5609526634216309
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5320706367492676
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 125318
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2272236347198486
Epoch: 1, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.666 Vali Acc: 0.344 Test Loss: 1.666 Test Acc: 0.344
Validation loss decreased (inf --> -0.344428).  Saving model ...
Epoch: 2 cost time: 0.5540966987609863
Epoch: 2, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.589 Vali Acc: 0.407 Test Loss: 1.589 Test Acc: 0.407
Validation loss decreased (-0.344428 --> -0.407392).  Saving model ...
Epoch: 3 cost time: 0.5126779079437256
Epoch: 3, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.508 Vali Acc: 0.452 Test Loss: 1.508 Test Acc: 0.452
Validation loss decreased (-0.407392 --> -0.451837).  Saving model ...
Epoch: 4 cost time: 0.445162296295166
Epoch: 4, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.389 Vali Acc: 0.507 Test Loss: 1.389 Test Acc: 0.507
Validation loss decreased (-0.451837 --> -0.507394).  Saving model ...
Epoch: 5 cost time: 0.5899960994720459
Epoch: 5, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.251 Vali Acc: 0.619 Test Loss: 1.251 Test Acc: 0.619
Validation loss decreased (-0.507394 --> -0.618506).  Saving model ...
Epoch: 6 cost time: 0.5980715751647949
Epoch: 6, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
Validation loss decreased (-0.618506 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 0.623802900314331
Epoch: 7, Steps: 2 | Train Loss: 0.958 Vali Loss: 0.967 Vali Acc: 0.752 Test Loss: 0.967 Test Acc: 0.752
Validation loss decreased (-0.699989 --> -0.751842).  Saving model ...
Epoch: 8 cost time: 0.568476676940918
Epoch: 8, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.840 Vali Acc: 0.804 Test Loss: 0.840 Test Acc: 0.804
Validation loss decreased (-0.751842 --> -0.803695).  Saving model ...
Epoch: 9 cost time: 0.6038897037506104
Epoch: 9, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.727 Vali Acc: 0.852 Test Loss: 0.727 Test Acc: 0.852
Validation loss decreased (-0.803695 --> -0.851845).  Saving model ...
Epoch: 10 cost time: 0.5818812847137451
Epoch: 10, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.626 Vali Acc: 0.881 Test Loss: 0.626 Test Acc: 0.881
Validation loss decreased (-0.851845 --> -0.881475).  Saving model ...
Epoch: 11 cost time: 0.5809671878814697
Epoch: 11, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
Validation loss decreased (-0.881475 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 0.6130263805389404
Epoch: 12, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.477 Vali Acc: 0.893 Test Loss: 0.477 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5417487621307373
Epoch: 13, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.5083119869232178
Epoch: 14, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.374 Vali Acc: 0.911 Test Loss: 0.374 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911107).  Saving model ...
Epoch: 15 cost time: 0.5273785591125488
Epoch: 15, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.333 Vali Acc: 0.922 Test Loss: 0.333 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 16 cost time: 0.5356655120849609
Epoch: 16, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.5588529109954834
Epoch: 17, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 18 cost time: 0.5842106342315674
Epoch: 18, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 0.540961742401123
Epoch: 19, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.258 Vali Acc: 0.919 Test Loss: 0.258 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5055887699127197
Epoch: 20, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.247 Vali Acc: 0.915 Test Loss: 0.247 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5751907825469971
Epoch: 21, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.47764062881469727
Epoch: 22, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.5707106590270996
Epoch: 23, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929628).  Saving model ...
Epoch: 24 cost time: 0.5380873680114746
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 25 cost time: 0.5116040706634521
Epoch: 25, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 26 cost time: 0.5131301879882812
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 27 cost time: 0.5815634727478027
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.556117057800293
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.586618185043335
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.525435209274292
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5278434753417969
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5049569606781006
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5144944190979004
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.603050708770752
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5581851005554199
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5281672477722168
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5347409248352051
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 74758
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0257182121276855
Epoch: 1, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.856 Vali Acc: 0.233 Test Loss: 1.856 Test Acc: 0.233
Validation loss decreased (inf --> -0.233315).  Saving model ...
Epoch: 2 cost time: 0.5097858905792236
Epoch: 2, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.764 Vali Acc: 0.367 Test Loss: 1.764 Test Acc: 0.367
Validation loss decreased (-0.233315 --> -0.366649).  Saving model ...
Epoch: 3 cost time: 0.5187757015228271
Epoch: 3, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.680 Vali Acc: 0.441 Test Loss: 1.680 Test Acc: 0.441
Validation loss decreased (-0.366649 --> -0.440724).  Saving model ...
Epoch: 4 cost time: 0.5396547317504883
Epoch: 4, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.577 Vali Acc: 0.496 Test Loss: 1.577 Test Acc: 0.496
Validation loss decreased (-0.440724 --> -0.496281).  Saving model ...
Epoch: 5 cost time: 0.5086843967437744
Epoch: 5, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.452 Vali Acc: 0.548 Test Loss: 1.452 Test Acc: 0.548
Validation loss decreased (-0.496281 --> -0.548134).  Saving model ...
Epoch: 6 cost time: 0.5211019515991211
Epoch: 6, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.317 Vali Acc: 0.644 Test Loss: 1.317 Test Acc: 0.644
Validation loss decreased (-0.548134 --> -0.644431).  Saving model ...
Epoch: 7 cost time: 0.5354704856872559
Epoch: 7, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.181 Vali Acc: 0.685 Test Loss: 1.181 Test Acc: 0.685
Validation loss decreased (-0.644431 --> -0.685173).  Saving model ...
Epoch: 8 cost time: 0.5270199775695801
Epoch: 8, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.051 Vali Acc: 0.744 Test Loss: 1.051 Test Acc: 0.744
Validation loss decreased (-0.685173 --> -0.744434).  Saving model ...
Epoch: 9 cost time: 0.5249185562133789
Epoch: 9, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.928 Vali Acc: 0.774 Test Loss: 0.928 Test Acc: 0.774
Validation loss decreased (-0.744434 --> -0.774065).  Saving model ...
Epoch: 10 cost time: 0.48850297927856445
Epoch: 10, Steps: 2 | Train Loss: 0.783 Vali Loss: 0.815 Vali Acc: 0.822 Test Loss: 0.815 Test Acc: 0.822
Validation loss decreased (-0.774065 --> -0.822214).  Saving model ...
Epoch: 11 cost time: 0.4755892753601074
Epoch: 11, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.718 Vali Acc: 0.852 Test Loss: 0.718 Test Acc: 0.852
Validation loss decreased (-0.822214 --> -0.851845).  Saving model ...
Epoch: 12 cost time: 0.5123708248138428
Epoch: 12, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
Validation loss decreased (-0.851845 --> -0.866660).  Saving model ...
Epoch: 13 cost time: 0.5632877349853516
Epoch: 13, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.558 Vali Acc: 0.900 Test Loss: 0.558 Test Acc: 0.900
Validation loss decreased (-0.866660 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.4672679901123047
Epoch: 14, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.48032188415527344
Epoch: 15, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.439 Vali Acc: 0.896 Test Loss: 0.439 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5280795097351074
Epoch: 16, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.395 Vali Acc: 0.896 Test Loss: 0.395 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5417649745941162
Epoch: 17, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.360 Vali Acc: 0.907 Test Loss: 0.360 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907404).  Saving model ...
Epoch: 18 cost time: 0.5772085189819336
Epoch: 18, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 19 cost time: 0.48514413833618164
Epoch: 19, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.302 Vali Acc: 0.915 Test Loss: 0.302 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 20 cost time: 0.5625622272491455
Epoch: 20, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 21 cost time: 0.5045995712280273
Epoch: 21, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.260 Vali Acc: 0.915 Test Loss: 0.260 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5559465885162354
Epoch: 22, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.5794241428375244
Epoch: 23, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 0.5856373310089111
Epoch: 24, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 25 cost time: 0.5631222724914551
Epoch: 25, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 26 cost time: 0.5099124908447266
Epoch: 26, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 27 cost time: 0.5199887752532959
Epoch: 27, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 28 cost time: 0.5712130069732666
Epoch: 28, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5092883110046387
Epoch: 29, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5836739540100098
Epoch: 30, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 31 cost time: 0.45981764793395996
Epoch: 31, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 32 cost time: 0.48290586471557617
Epoch: 32, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 33 cost time: 0.5086455345153809
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 34 cost time: 0.5124082565307617
Epoch: 34, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 35 cost time: 0.5092895030975342
Epoch: 35, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 36 cost time: 0.5305261611938477
Epoch: 36, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 37 cost time: 0.4553661346435547
Epoch: 37, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 38 cost time: 0.4834880828857422
Epoch: 38, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 39 cost time: 0.6181397438049316
Epoch: 39, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 40 cost time: 0.48734617233276367
Epoch: 40, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 41 cost time: 0.45548367500305176
Epoch: 41, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 42 cost time: 0.47548937797546387
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.930 Test Loss: 0.178 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 43 cost time: 0.4761478900909424
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.930 Test Loss: 0.177 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 44 cost time: 0.5450115203857422
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.930 Test Loss: 0.175 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 45 cost time: 0.5864155292510986
Epoch: 45, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.930 Test Loss: 0.175 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 46 cost time: 0.5427284240722656
Epoch: 46, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933332).  Saving model ...
Epoch: 47 cost time: 0.5217118263244629
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.494718074798584
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5417876243591309
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5399949550628662
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 51 cost time: 0.44641709327697754
Epoch: 51, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 52 cost time: 0.480924129486084
Epoch: 52, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 53 cost time: 0.4826521873474121
Epoch: 53, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 54 cost time: 0.49372100830078125
Epoch: 54, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 55 cost time: 0.4586362838745117
Epoch: 55, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 0.5270740985870361
Epoch: 56, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 57 cost time: 0.521613597869873
Epoch: 57, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 58 cost time: 0.47672152519226074
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 59 cost time: 0.46840381622314453
Epoch: 59, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 60 cost time: 0.5360920429229736
Epoch: 60, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.49982452392578125
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.57411789894104
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.486483097076416
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.539456844329834
Epoch: 64, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.470167875289917
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.4730675220489502
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.4776475429534912
Epoch: 67, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.930 Test Loss: 0.173 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.46878576278686523
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.930 Test Loss: 0.173 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.47003698348999023
Epoch: 69, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.930 Test Loss: 0.173 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 59462
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.016674280166626
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.929 Vali Acc: 0.237 Test Loss: 1.929 Test Acc: 0.237
Validation loss decreased (inf --> -0.237018).  Saving model ...
Epoch: 2 cost time: 0.4666752815246582
Epoch: 2, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.849 Vali Acc: 0.289 Test Loss: 1.849 Test Acc: 0.289
Validation loss decreased (-0.237018 --> -0.288870).  Saving model ...
Epoch: 3 cost time: 0.5425674915313721
Epoch: 3, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.783 Vali Acc: 0.330 Test Loss: 1.783 Test Acc: 0.330
Validation loss decreased (-0.288870 --> -0.329612).  Saving model ...
Epoch: 4 cost time: 0.5533146858215332
Epoch: 4, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.708 Vali Acc: 0.359 Test Loss: 1.708 Test Acc: 0.359
Validation loss decreased (-0.329612 --> -0.359242).  Saving model ...
Epoch: 5 cost time: 0.563636302947998
Epoch: 5, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.617 Vali Acc: 0.385 Test Loss: 1.617 Test Acc: 0.385
Validation loss decreased (-0.359242 --> -0.385169).  Saving model ...
Epoch: 6 cost time: 0.5432226657867432
Epoch: 6, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.513 Vali Acc: 0.419 Test Loss: 1.513 Test Acc: 0.419
Validation loss decreased (-0.385169 --> -0.418503).  Saving model ...
Epoch: 7 cost time: 0.569861650466919
Epoch: 7, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.402 Vali Acc: 0.452 Test Loss: 1.402 Test Acc: 0.452
Validation loss decreased (-0.418503 --> -0.451838).  Saving model ...
Epoch: 8 cost time: 0.5676167011260986
Epoch: 8, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.289 Vali Acc: 0.556 Test Loss: 1.289 Test Acc: 0.556
Validation loss decreased (-0.451838 --> -0.555543).  Saving model ...
Epoch: 9 cost time: 0.6744303703308105
Epoch: 9, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.177 Vali Acc: 0.652 Test Loss: 1.177 Test Acc: 0.652
Validation loss decreased (-0.555543 --> -0.651840).  Saving model ...
Epoch: 10 cost time: 0.6638717651367188
Epoch: 10, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.069 Vali Acc: 0.715 Test Loss: 1.069 Test Acc: 0.715
Validation loss decreased (-0.651840 --> -0.714804).  Saving model ...
Epoch: 11 cost time: 0.5410962104797363
Epoch: 11, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.966 Vali Acc: 0.752 Test Loss: 0.966 Test Acc: 0.752
Validation loss decreased (-0.714804 --> -0.751842).  Saving model ...
Epoch: 12 cost time: 0.6161763668060303
Epoch: 12, Steps: 2 | Train Loss: 0.840 Vali Loss: 0.871 Vali Acc: 0.789 Test Loss: 0.871 Test Acc: 0.789
Validation loss decreased (-0.751842 --> -0.788880).  Saving model ...
Epoch: 13 cost time: 0.5369703769683838
Epoch: 13, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.786 Vali Acc: 0.807 Test Loss: 0.786 Test Acc: 0.807
Validation loss decreased (-0.788880 --> -0.807400).  Saving model ...
Epoch: 14 cost time: 0.6129260063171387
Epoch: 14, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.711 Vali Acc: 0.819 Test Loss: 0.711 Test Acc: 0.819
Validation loss decreased (-0.807400 --> -0.818511).  Saving model ...
Epoch: 15 cost time: 0.5405457019805908
Epoch: 15, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.644 Vali Acc: 0.856 Test Loss: 0.644 Test Acc: 0.856
Validation loss decreased (-0.818511 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 0.5477356910705566
Epoch: 16, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.585 Vali Acc: 0.878 Test Loss: 0.585 Test Acc: 0.878
Validation loss decreased (-0.855549 --> -0.877772).  Saving model ...
Epoch: 17 cost time: 0.4603583812713623
Epoch: 17, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.532 Vali Acc: 0.874 Test Loss: 0.532 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5141122341156006
Epoch: 18, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.488 Vali Acc: 0.885 Test Loss: 0.488 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885180).  Saving model ...
Epoch: 19 cost time: 0.5145041942596436
Epoch: 19, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 20 cost time: 0.5387346744537354
Epoch: 20, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.4939446449279785
Epoch: 21, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.383 Vali Acc: 0.907 Test Loss: 0.383 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907404).  Saving model ...
Epoch: 22 cost time: 0.5697834491729736
Epoch: 22, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
Validation loss decreased (-0.907404 --> -0.922219).  Saving model ...
Epoch: 23 cost time: 0.5422077178955078
Epoch: 23, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.330 Vali Acc: 0.930 Test Loss: 0.330 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929626).  Saving model ...
Epoch: 24 cost time: 0.5258126258850098
Epoch: 24, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 25 cost time: 0.5221648216247559
Epoch: 25, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.507239580154419
Epoch: 26, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5546410083770752
Epoch: 27, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5471689701080322
Epoch: 28, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6421024799346924
Epoch: 29, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6053667068481445
Epoch: 30, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5984234809875488
Epoch: 31, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.5685927867889404
Epoch: 32, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4854588508605957
Epoch: 33, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5688319206237793
Epoch: 34, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.49843335151672363
Epoch: 35, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.49871373176574707
Epoch: 36, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 37 cost time: 0.6199734210968018
Epoch: 37, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 38 cost time: 0.5262937545776367
Epoch: 38, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 39 cost time: 0.5473020076751709
Epoch: 39, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 40 cost time: 0.5113122463226318
Epoch: 40, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 41 cost time: 0.5222961902618408
Epoch: 41, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5691380500793457
Epoch: 42, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.513909101486206
Epoch: 43, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6373050212860107
Epoch: 44, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7241981029510498
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.926 Test Loss: 0.191 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5903582572937012
Epoch: 46, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.621708869934082
Epoch: 47, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.547893762588501
Epoch: 48, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5382888317108154
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.6646981239318848
Epoch: 50, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 50374
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.046335220336914
Epoch: 1, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.835 Vali Acc: 0.300 Test Loss: 1.835 Test Acc: 0.300
Validation loss decreased (inf --> -0.299982).  Saving model ...
Epoch: 2 cost time: 0.577369213104248
Epoch: 2, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.759 Vali Acc: 0.300 Test Loss: 1.759 Test Acc: 0.300
Validation loss decreased (-0.299982 --> -0.299982).  Saving model ...
Epoch: 3 cost time: 0.5386340618133545
Epoch: 3, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.694 Vali Acc: 0.293 Test Loss: 1.694 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.570068359375
Epoch: 4, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.627 Vali Acc: 0.285 Test Loss: 1.627 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5389571189880371
Epoch: 5, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.550 Vali Acc: 0.311 Test Loss: 1.550 Test Acc: 0.311
Validation loss decreased (-0.299982 --> -0.311096).  Saving model ...
Epoch: 6 cost time: 0.5297112464904785
Epoch: 6, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.464 Vali Acc: 0.322 Test Loss: 1.464 Test Acc: 0.322
Validation loss decreased (-0.311096 --> -0.322208).  Saving model ...
Epoch: 7 cost time: 0.659442663192749
Epoch: 7, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.372 Vali Acc: 0.370 Test Loss: 1.372 Test Acc: 0.370
Validation loss decreased (-0.322208 --> -0.370357).  Saving model ...
Epoch: 8 cost time: 0.5550863742828369
Epoch: 8, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.277 Vali Acc: 0.437 Test Loss: 1.277 Test Acc: 0.437
Validation loss decreased (-0.370357 --> -0.437024).  Saving model ...
Epoch: 9 cost time: 0.5078427791595459
Epoch: 9, Steps: 2 | Train Loss: 1.119 Vali Loss: 1.182 Vali Acc: 0.530 Test Loss: 1.182 Test Acc: 0.530
Validation loss decreased (-0.437024 --> -0.529618).  Saving model ...
Epoch: 10 cost time: 0.5869548320770264
Epoch: 10, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.090 Vali Acc: 0.630 Test Loss: 1.090 Test Acc: 0.630
Validation loss decreased (-0.529618 --> -0.629619).  Saving model ...
Epoch: 11 cost time: 0.5521166324615479
Epoch: 11, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.002 Vali Acc: 0.674 Test Loss: 1.002 Test Acc: 0.674
Validation loss decreased (-0.629619 --> -0.674064).  Saving model ...
Epoch: 12 cost time: 0.5021791458129883
Epoch: 12, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.919 Vali Acc: 0.704 Test Loss: 0.919 Test Acc: 0.704
Validation loss decreased (-0.674064 --> -0.703695).  Saving model ...
Epoch: 13 cost time: 0.5395095348358154
Epoch: 13, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.842 Vali Acc: 0.770 Test Loss: 0.842 Test Acc: 0.770
Validation loss decreased (-0.703695 --> -0.770362).  Saving model ...
Epoch: 14 cost time: 0.5293960571289062
Epoch: 14, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.771 Vali Acc: 0.793 Test Loss: 0.771 Test Acc: 0.793
Validation loss decreased (-0.770362 --> -0.792585).  Saving model ...
Epoch: 15 cost time: 0.521334171295166
Epoch: 15, Steps: 2 | Train Loss: 0.575 Vali Loss: 0.708 Vali Acc: 0.826 Test Loss: 0.708 Test Acc: 0.826
Validation loss decreased (-0.792585 --> -0.825919).  Saving model ...
Epoch: 16 cost time: 0.6294872760772705
Epoch: 16, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.650 Vali Acc: 0.837 Test Loss: 0.650 Test Acc: 0.837
Validation loss decreased (-0.825919 --> -0.837031).  Saving model ...
Epoch: 17 cost time: 0.7161016464233398
Epoch: 17, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
Validation loss decreased (-0.837031 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 0.6224126815795898
Epoch: 18, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.552 Vali Acc: 0.870 Test Loss: 0.552 Test Acc: 0.870
Validation loss decreased (-0.855550 --> -0.870365).  Saving model ...
Epoch: 19 cost time: 0.6355717182159424
Epoch: 19, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.509 Vali Acc: 0.885 Test Loss: 0.509 Test Acc: 0.885
Validation loss decreased (-0.870365 --> -0.885180).  Saving model ...
Epoch: 20 cost time: 0.5827598571777344
Epoch: 20, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.885180 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.5518753528594971
Epoch: 21, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.436 Vali Acc: 0.911 Test Loss: 0.436 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911107).  Saving model ...
Epoch: 22 cost time: 0.5453000068664551
Epoch: 22, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.405 Vali Acc: 0.907 Test Loss: 0.405 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6114399433135986
Epoch: 23, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.377 Vali Acc: 0.930 Test Loss: 0.377 Test Acc: 0.930
Validation loss decreased (-0.911107 --> -0.929626).  Saving model ...
Epoch: 24 cost time: 0.5015280246734619
Epoch: 24, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.352 Vali Acc: 0.930 Test Loss: 0.352 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 25 cost time: 0.49485349655151367
Epoch: 25, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.48840832710266113
Epoch: 26, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.313 Vali Acc: 0.919 Test Loss: 0.313 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5715970993041992
Epoch: 27, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.299 Vali Acc: 0.919 Test Loss: 0.299 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6540865898132324
Epoch: 28, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6176719665527344
Epoch: 29, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.278 Vali Acc: 0.919 Test Loss: 0.278 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7431511878967285
Epoch: 30, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5887377262115479
Epoch: 31, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5194294452667236
Epoch: 32, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.254 Vali Acc: 0.919 Test Loss: 0.254 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5798478126525879
Epoch: 33, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.5582432746887207
Epoch: 34, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 35 cost time: 0.5386207103729248
Epoch: 35, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.5949645042419434
Epoch: 36, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 37 cost time: 0.5357050895690918
Epoch: 37, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.506730318069458
Epoch: 38, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.5077106952667236
Epoch: 39, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.5321393013000488
Epoch: 40, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.6753652095794678
Epoch: 41, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.6345369815826416
Epoch: 42, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.48345327377319336
Epoch: 43, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.4490396976470947
Epoch: 44, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.5201654434204102
Epoch: 45, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.49636030197143555
Epoch: 46, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6441788673400879
Epoch: 47, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.5509257316589355
Epoch: 48, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.46488499641418457
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5799293518066406
Epoch: 50, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5495059490203857
Epoch: 51, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.52644944190979
Epoch: 52, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.5706758499145508
Epoch: 53, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.540297269821167
Epoch: 54, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.5233926773071289
Epoch: 55, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.5549314022064209
Epoch: 56, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.552119255065918
Epoch: 57, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 45958
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9776289463043213
Epoch: 1, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.838 Vali Acc: 0.315 Test Loss: 1.838 Test Acc: 0.315
Validation loss decreased (inf --> -0.314796).  Saving model ...
Epoch: 2 cost time: 0.5383877754211426
Epoch: 2, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.774 Vali Acc: 0.315 Test Loss: 1.774 Test Acc: 0.315
Validation loss decreased (-0.314796 --> -0.314797).  Saving model ...
Epoch: 3 cost time: 0.4679112434387207
Epoch: 3, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.722 Vali Acc: 0.326 Test Loss: 1.722 Test Acc: 0.326
Validation loss decreased (-0.314797 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 0.5552551746368408
Epoch: 4, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.670 Vali Acc: 0.378 Test Loss: 1.670 Test Acc: 0.378
Validation loss decreased (-0.325909 --> -0.377761).  Saving model ...
Epoch: 5 cost time: 0.5217406749725342
Epoch: 5, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.607 Vali Acc: 0.411 Test Loss: 1.607 Test Acc: 0.411
Validation loss decreased (-0.377761 --> -0.411095).  Saving model ...
Epoch: 6 cost time: 0.5381114482879639
Epoch: 6, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.537 Vali Acc: 0.493 Test Loss: 1.537 Test Acc: 0.493
Validation loss decreased (-0.411095 --> -0.492577).  Saving model ...
Epoch: 7 cost time: 0.5379695892333984
Epoch: 7, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.459 Vali Acc: 0.552 Test Loss: 1.459 Test Acc: 0.552
Validation loss decreased (-0.492577 --> -0.551837).  Saving model ...
Epoch: 8 cost time: 0.559755802154541
Epoch: 8, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.378 Vali Acc: 0.581 Test Loss: 1.378 Test Acc: 0.581
Validation loss decreased (-0.551837 --> -0.581468).  Saving model ...
Epoch: 9 cost time: 0.4963381290435791
Epoch: 9, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.294 Vali Acc: 0.615 Test Loss: 1.294 Test Acc: 0.615
Validation loss decreased (-0.581468 --> -0.614802).  Saving model ...
Epoch: 10 cost time: 0.47936511039733887
Epoch: 10, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.209 Vali Acc: 0.663 Test Loss: 1.209 Test Acc: 0.663
Validation loss decreased (-0.614802 --> -0.662951).  Saving model ...
Epoch: 11 cost time: 0.48816537857055664
Epoch: 11, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.125 Vali Acc: 0.711 Test Loss: 1.125 Test Acc: 0.711
Validation loss decreased (-0.662951 --> -0.711100).  Saving model ...
Epoch: 12 cost time: 0.46056532859802246
Epoch: 12, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.043 Vali Acc: 0.752 Test Loss: 1.043 Test Acc: 0.752
Validation loss decreased (-0.711100 --> -0.751841).  Saving model ...
Epoch: 13 cost time: 0.5086262226104736
Epoch: 13, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.964 Vali Acc: 0.800 Test Loss: 0.964 Test Acc: 0.800
Validation loss decreased (-0.751841 --> -0.799990).  Saving model ...
Epoch: 14 cost time: 0.5413308143615723
Epoch: 14, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.890 Vali Acc: 0.826 Test Loss: 0.890 Test Acc: 0.826
Validation loss decreased (-0.799990 --> -0.825917).  Saving model ...
Epoch: 15 cost time: 0.5263593196868896
Epoch: 15, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.821 Vali Acc: 0.856 Test Loss: 0.821 Test Acc: 0.856
Validation loss decreased (-0.825917 --> -0.855547).  Saving model ...
Epoch: 16 cost time: 0.5203433036804199
Epoch: 16, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.758 Vali Acc: 0.859 Test Loss: 0.758 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859252).  Saving model ...
Epoch: 17 cost time: 0.49807286262512207
Epoch: 17, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.701 Vali Acc: 0.870 Test Loss: 0.701 Test Acc: 0.870
Validation loss decreased (-0.859252 --> -0.870363).  Saving model ...
Epoch: 18 cost time: 0.4939892292022705
Epoch: 18, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.649 Vali Acc: 0.881 Test Loss: 0.649 Test Acc: 0.881
Validation loss decreased (-0.870363 --> -0.881475).  Saving model ...
Epoch: 19 cost time: 0.5077962875366211
Epoch: 19, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.601 Vali Acc: 0.896 Test Loss: 0.601 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896290).  Saving model ...
Epoch: 20 cost time: 0.5075528621673584
Epoch: 20, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.558 Vali Acc: 0.911 Test Loss: 0.558 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911106).  Saving model ...
Epoch: 21 cost time: 0.5007607936859131
Epoch: 21, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.520 Vali Acc: 0.911 Test Loss: 0.520 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 22 cost time: 0.5382282733917236
Epoch: 22, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.485 Vali Acc: 0.907 Test Loss: 0.485 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5269110202789307
Epoch: 23, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.452 Vali Acc: 0.915 Test Loss: 0.452 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 24 cost time: 0.4935944080352783
Epoch: 24, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.423 Vali Acc: 0.926 Test Loss: 0.423 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925922).  Saving model ...
Epoch: 25 cost time: 0.5665106773376465
Epoch: 25, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.400 Vali Acc: 0.919 Test Loss: 0.400 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6155729293823242
Epoch: 26, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.376 Vali Acc: 0.919 Test Loss: 0.376 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5423002243041992
Epoch: 27, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.355 Vali Acc: 0.922 Test Loss: 0.355 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.48551368713378906
Epoch: 28, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.337 Vali Acc: 0.926 Test Loss: 0.337 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 29 cost time: 0.5710577964782715
Epoch: 29, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 30 cost time: 0.5504367351531982
Epoch: 30, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 31 cost time: 0.548187255859375
Epoch: 31, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 32 cost time: 0.5020239353179932
Epoch: 32, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 33 cost time: 0.529155969619751
Epoch: 33, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.540539026260376
Epoch: 34, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.4851515293121338
Epoch: 35, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 36 cost time: 0.47362780570983887
Epoch: 36, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 37 cost time: 0.48754358291625977
Epoch: 37, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4742097854614258
Epoch: 38, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5040004253387451
Epoch: 39, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5562789440155029
Epoch: 40, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.52229905128479
Epoch: 41, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.60160231590271
Epoch: 42, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5200459957122803
Epoch: 43, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5154092311859131
Epoch: 44, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5511865615844727
Epoch: 45, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.4993717670440674
Epoch: 46, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 40006
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8583991527557373
Epoch: 1, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.867 Vali Acc: 0.133 Test Loss: 1.867 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 0.5689866542816162
Epoch: 2, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.785 Vali Acc: 0.141 Test Loss: 1.785 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140723).  Saving model ...
Epoch: 3 cost time: 0.6554961204528809
Epoch: 3, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.722 Vali Acc: 0.156 Test Loss: 1.722 Test Acc: 0.156
Validation loss decreased (-0.140723 --> -0.155538).  Saving model ...
Epoch: 4 cost time: 0.6199562549591064
Epoch: 4, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.664 Vali Acc: 0.196 Test Loss: 1.664 Test Acc: 0.196
Validation loss decreased (-0.155538 --> -0.196280).  Saving model ...
Epoch: 5 cost time: 0.5244815349578857
Epoch: 5, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.602 Vali Acc: 0.244 Test Loss: 1.602 Test Acc: 0.244
Validation loss decreased (-0.196280 --> -0.244428).  Saving model ...
Epoch: 6 cost time: 0.6481966972351074
Epoch: 6, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.537 Vali Acc: 0.289 Test Loss: 1.537 Test Acc: 0.289
Validation loss decreased (-0.244428 --> -0.288874).  Saving model ...
Epoch: 7 cost time: 0.5835671424865723
Epoch: 7, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.470 Vali Acc: 0.341 Test Loss: 1.470 Test Acc: 0.341
Validation loss decreased (-0.288874 --> -0.340726).  Saving model ...
Epoch: 8 cost time: 0.5783078670501709
Epoch: 8, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.400 Vali Acc: 0.430 Test Loss: 1.400 Test Acc: 0.430
Validation loss decreased (-0.340726 --> -0.429616).  Saving model ...
Epoch: 9 cost time: 0.6807925701141357
Epoch: 9, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.328 Vali Acc: 0.496 Test Loss: 1.328 Test Acc: 0.496
Validation loss decreased (-0.429616 --> -0.496283).  Saving model ...
Epoch: 10 cost time: 0.5426020622253418
Epoch: 10, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.255 Vali Acc: 0.563 Test Loss: 1.255 Test Acc: 0.563
Validation loss decreased (-0.496283 --> -0.562950).  Saving model ...
Epoch: 11 cost time: 0.5417728424072266
Epoch: 11, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.184 Vali Acc: 0.656 Test Loss: 1.184 Test Acc: 0.656
Validation loss decreased (-0.562950 --> -0.655544).  Saving model ...
Epoch: 12 cost time: 0.5702660083770752
Epoch: 12, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.113 Vali Acc: 0.715 Test Loss: 1.113 Test Acc: 0.715
Validation loss decreased (-0.655544 --> -0.714804).  Saving model ...
Epoch: 13 cost time: 0.491133451461792
Epoch: 13, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.044 Vali Acc: 0.774 Test Loss: 1.044 Test Acc: 0.774
Validation loss decreased (-0.714804 --> -0.774064).  Saving model ...
Epoch: 14 cost time: 0.7355656623840332
Epoch: 14, Steps: 2 | Train Loss: 1.089 Vali Loss: 0.977 Vali Acc: 0.815 Test Loss: 0.977 Test Acc: 0.815
Validation loss decreased (-0.774064 --> -0.814805).  Saving model ...
Epoch: 15 cost time: 0.5861499309539795
Epoch: 15, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.913 Vali Acc: 0.844 Test Loss: 0.913 Test Acc: 0.844
Validation loss decreased (-0.814805 --> -0.844435).  Saving model ...
Epoch: 16 cost time: 0.5917809009552002
Epoch: 16, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.854 Vali Acc: 0.867 Test Loss: 0.854 Test Acc: 0.867
Validation loss decreased (-0.844435 --> -0.866658).  Saving model ...
Epoch: 17 cost time: 0.5956590175628662
Epoch: 17, Steps: 2 | Train Loss: 0.726 Vali Loss: 0.797 Vali Acc: 0.874 Test Loss: 0.797 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 18 cost time: 0.5827300548553467
Epoch: 18, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.744 Vali Acc: 0.881 Test Loss: 0.744 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 19 cost time: 0.626929759979248
Epoch: 19, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.694 Vali Acc: 0.889 Test Loss: 0.694 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888882).  Saving model ...
Epoch: 20 cost time: 0.527137041091919
Epoch: 20, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.650 Vali Acc: 0.900 Test Loss: 0.650 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.5709588527679443
Epoch: 21, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.610 Vali Acc: 0.904 Test Loss: 0.610 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903698).  Saving model ...
Epoch: 22 cost time: 0.5016880035400391
Epoch: 22, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5598647594451904
Epoch: 23, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.538 Vali Acc: 0.907 Test Loss: 0.538 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 24 cost time: 0.5484991073608398
Epoch: 24, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.505 Vali Acc: 0.907 Test Loss: 0.505 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 25 cost time: 0.5270333290100098
Epoch: 25, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.474 Vali Acc: 0.911 Test Loss: 0.474 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 26 cost time: 0.5926070213317871
Epoch: 26, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.448 Vali Acc: 0.907 Test Loss: 0.448 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5896997451782227
Epoch: 27, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.424 Vali Acc: 0.922 Test Loss: 0.424 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922218).  Saving model ...
Epoch: 28 cost time: 0.5005660057067871
Epoch: 28, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.402 Vali Acc: 0.926 Test Loss: 0.402 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 29 cost time: 0.650566816329956
Epoch: 29, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.382 Vali Acc: 0.937 Test Loss: 0.382 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937033).  Saving model ...
Epoch: 30 cost time: 0.6573574542999268
Epoch: 30, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.363 Vali Acc: 0.937 Test Loss: 0.363 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 31 cost time: 0.5539541244506836
Epoch: 31, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.345 Vali Acc: 0.937 Test Loss: 0.345 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.559995174407959
Epoch: 32, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.331 Vali Acc: 0.933 Test Loss: 0.331 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5760791301727295
Epoch: 33, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.319 Vali Acc: 0.937 Test Loss: 0.319 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 34 cost time: 0.5593531131744385
Epoch: 34, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.309 Vali Acc: 0.937 Test Loss: 0.309 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 35 cost time: 0.6274750232696533
Epoch: 35, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 36 cost time: 0.6612098217010498
Epoch: 36, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 37 cost time: 0.5588831901550293
Epoch: 37, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.6058743000030518
Epoch: 38, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 39 cost time: 0.5389688014984131
Epoch: 39, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.266 Vali Acc: 0.948 Test Loss: 0.266 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 40 cost time: 0.5325038433074951
Epoch: 40, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.621412992477417
Epoch: 41, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.5297412872314453
Epoch: 42, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.248 Vali Acc: 0.948 Test Loss: 0.248 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.521594762802124
Epoch: 43, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.5134274959564209
Epoch: 44, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.240 Vali Acc: 0.948 Test Loss: 0.240 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.5789382457733154
Epoch: 45, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.512324333190918
Epoch: 46, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.6136898994445801
Epoch: 47, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.5681405067443848
Epoch: 48, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.6144866943359375
Epoch: 49, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.535498857498169
Epoch: 50, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 51 cost time: 0.579181432723999
Epoch: 51, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.219 Vali Acc: 0.948 Test Loss: 0.219 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 52 cost time: 0.5406413078308105
Epoch: 52, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 53 cost time: 0.5534477233886719
Epoch: 53, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 54 cost time: 0.5459883213043213
Epoch: 54, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 55 cost time: 0.5292279720306396
Epoch: 55, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 56 cost time: 0.5428030490875244
Epoch: 56, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 57 cost time: 0.5909738540649414
Epoch: 57, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 58 cost time: 0.6139097213745117
Epoch: 58, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 59 cost time: 0.5165135860443115
Epoch: 59, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 60 cost time: 0.5665361881256104
Epoch: 60, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 61 cost time: 0.532616376876831
Epoch: 61, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 62 cost time: 0.5471515655517578
Epoch: 62, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 63 cost time: 0.6751739978790283
Epoch: 63, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 64 cost time: 0.6127581596374512
Epoch: 64, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 65 cost time: 0.49945926666259766
Epoch: 65, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 66 cost time: 0.5621094703674316
Epoch: 66, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5770347118377686
Epoch: 67, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6372323036193848
Epoch: 68, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.5423612594604492
Epoch: 69, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.5138685703277588
Epoch: 70, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.5307357311248779
Epoch: 71, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.5322232246398926
Epoch: 72, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.5657405853271484
Epoch: 73, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.6175060272216797
Epoch: 74, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.53883957862854
Epoch: 75, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm64_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 37190
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.149765729904175
Epoch: 1, Steps: 2 | Train Loss: 2.347 Vali Loss: 2.064 Vali Acc: 0.074 Test Loss: 2.064 Test Acc: 0.074
Validation loss decreased (inf --> -0.074053).  Saving model ...
Epoch: 2 cost time: 0.5786364078521729
Epoch: 2, Steps: 2 | Train Loss: 2.164 Vali Loss: 1.971 Vali Acc: 0.111 Test Loss: 1.971 Test Acc: 0.111
Validation loss decreased (-0.074053 --> -0.111091).  Saving model ...
Epoch: 3 cost time: 0.6331593990325928
Epoch: 3, Steps: 2 | Train Loss: 1.920 Vali Loss: 1.868 Vali Acc: 0.148 Test Loss: 1.868 Test Acc: 0.148
Validation loss decreased (-0.111091 --> -0.148129).  Saving model ...
Epoch: 4 cost time: 0.5363821983337402
Epoch: 4, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.722 Vali Acc: 0.263 Test Loss: 1.722 Test Acc: 0.263
Validation loss decreased (-0.148129 --> -0.262946).  Saving model ...
Epoch: 5 cost time: 0.6575949192047119
Epoch: 5, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.550 Vali Acc: 0.452 Test Loss: 1.550 Test Acc: 0.452
Validation loss decreased (-0.262946 --> -0.451836).  Saving model ...
Epoch: 6 cost time: 0.6942794322967529
Epoch: 6, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.363 Vali Acc: 0.567 Test Loss: 1.363 Test Acc: 0.567
Validation loss decreased (-0.451836 --> -0.566653).  Saving model ...
Epoch: 7 cost time: 0.5130572319030762
Epoch: 7, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.177 Vali Acc: 0.693 Test Loss: 1.177 Test Acc: 0.693
Validation loss decreased (-0.566653 --> -0.692581).  Saving model ...
Epoch: 8 cost time: 0.5462956428527832
Epoch: 8, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.004 Vali Acc: 0.756 Test Loss: 1.004 Test Acc: 0.756
Validation loss decreased (-0.692581 --> -0.755546).  Saving model ...
Epoch: 9 cost time: 0.5297579765319824
Epoch: 9, Steps: 2 | Train Loss: 0.944 Vali Loss: 0.857 Vali Acc: 0.800 Test Loss: 0.857 Test Acc: 0.800
Validation loss decreased (-0.755546 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.5640137195587158
Epoch: 10, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.732 Vali Acc: 0.844 Test Loss: 0.732 Test Acc: 0.844
Validation loss decreased (-0.799991 --> -0.844437).  Saving model ...
Epoch: 11 cost time: 0.5397756099700928
Epoch: 11, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.632 Vali Acc: 0.870 Test Loss: 0.632 Test Acc: 0.870
Validation loss decreased (-0.844437 --> -0.870364).  Saving model ...
Epoch: 12 cost time: 0.6192135810852051
Epoch: 12, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.553 Vali Acc: 0.885 Test Loss: 0.553 Test Acc: 0.885
Validation loss decreased (-0.870364 --> -0.885180).  Saving model ...
Epoch: 13 cost time: 0.5283467769622803
Epoch: 13, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.486 Vali Acc: 0.889 Test Loss: 0.486 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 14 cost time: 0.59134840965271
Epoch: 14, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.426 Vali Acc: 0.911 Test Loss: 0.426 Test Acc: 0.911
Validation loss decreased (-0.888884 --> -0.911107).  Saving model ...
Epoch: 15 cost time: 0.6064510345458984
Epoch: 15, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.378 Vali Acc: 0.915 Test Loss: 0.378 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 16 cost time: 0.6605961322784424
Epoch: 16, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.337 Vali Acc: 0.915 Test Loss: 0.337 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 17 cost time: 0.6315345764160156
Epoch: 17, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.304 Vali Acc: 0.911 Test Loss: 0.304 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5486013889312744
Epoch: 18, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925923).  Saving model ...
Epoch: 19 cost time: 0.6910781860351562
Epoch: 19, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 20 cost time: 0.6250243186950684
Epoch: 20, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 21 cost time: 0.5718450546264648
Epoch: 21, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.5839531421661377
Epoch: 22, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5545933246612549
Epoch: 23, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5256319046020508
Epoch: 24, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.207 Vali Acc: 0.926 Test Loss: 0.207 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.49006223678588867
Epoch: 25, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.915 Test Loss: 0.204 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5622367858886719
Epoch: 26, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.919 Test Loss: 0.201 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6214830875396729
Epoch: 27, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.919 Test Loss: 0.199 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5295803546905518
Epoch: 28, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.919 Test Loss: 0.198 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5800070762634277
Epoch: 29, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.631798505783081
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6533629894256592
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 71078
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0703420639038086
Epoch: 1, Steps: 2 | Train Loss: 2.259 Vali Loss: 1.942 Vali Acc: 0.070 Test Loss: 1.942 Test Acc: 0.070
Validation loss decreased (inf --> -0.070351).  Saving model ...
Epoch: 2 cost time: 0.6265146732330322
Epoch: 2, Steps: 2 | Train Loss: 1.979 Vali Loss: 1.864 Vali Acc: 0.159 Test Loss: 1.864 Test Acc: 0.159
Validation loss decreased (-0.070351 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 0.5474891662597656
Epoch: 3, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.796 Vali Acc: 0.215 Test Loss: 1.796 Test Acc: 0.215
Validation loss decreased (-0.159241 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 0.5355379581451416
Epoch: 4, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.713 Vali Acc: 0.296 Test Loss: 1.713 Test Acc: 0.296
Validation loss decreased (-0.214797 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 0.49382877349853516
Epoch: 5, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.611 Vali Acc: 0.370 Test Loss: 1.611 Test Acc: 0.370
Validation loss decreased (-0.296279 --> -0.370354).  Saving model ...
Epoch: 6 cost time: 0.5234489440917969
Epoch: 6, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.497 Vali Acc: 0.433 Test Loss: 1.497 Test Acc: 0.433
Validation loss decreased (-0.370354 --> -0.433318).  Saving model ...
Epoch: 7 cost time: 0.4560692310333252
Epoch: 7, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.377 Vali Acc: 0.481 Test Loss: 1.377 Test Acc: 0.481
Validation loss decreased (-0.433318 --> -0.481468).  Saving model ...
Epoch: 8 cost time: 0.5130808353424072
Epoch: 8, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.259 Vali Acc: 0.552 Test Loss: 1.259 Test Acc: 0.552
Validation loss decreased (-0.481468 --> -0.551839).  Saving model ...
Epoch: 9 cost time: 0.5320901870727539
Epoch: 9, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.142 Vali Acc: 0.641 Test Loss: 1.142 Test Acc: 0.641
Validation loss decreased (-0.551839 --> -0.640729).  Saving model ...
Epoch: 10 cost time: 0.5629093647003174
Epoch: 10, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.031 Vali Acc: 0.707 Test Loss: 1.031 Test Acc: 0.707
Validation loss decreased (-0.640729 --> -0.707397).  Saving model ...
Epoch: 11 cost time: 0.6227178573608398
Epoch: 11, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.930 Vali Acc: 0.800 Test Loss: 0.930 Test Acc: 0.800
Validation loss decreased (-0.707397 --> -0.799991).  Saving model ...
Epoch: 12 cost time: 0.6101679801940918
Epoch: 12, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.838 Vali Acc: 0.804 Test Loss: 0.838 Test Acc: 0.804
Validation loss decreased (-0.799991 --> -0.803695).  Saving model ...
Epoch: 13 cost time: 0.55185866355896
Epoch: 13, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.757 Vali Acc: 0.822 Test Loss: 0.757 Test Acc: 0.822
Validation loss decreased (-0.803695 --> -0.822215).  Saving model ...
Epoch: 14 cost time: 0.5389442443847656
Epoch: 14, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.684 Vali Acc: 0.844 Test Loss: 0.684 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 0.5773794651031494
Epoch: 15, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.620 Vali Acc: 0.863 Test Loss: 0.620 Test Acc: 0.863
Validation loss decreased (-0.844438 --> -0.862957).  Saving model ...
Epoch: 16 cost time: 0.5561766624450684
Epoch: 16, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.565 Vali Acc: 0.867 Test Loss: 0.565 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 0.44626951217651367
Epoch: 17, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.517 Vali Acc: 0.874 Test Loss: 0.517 Test Acc: 0.874
Validation loss decreased (-0.866661 --> -0.874069).  Saving model ...
Epoch: 18 cost time: 0.5332803726196289
Epoch: 18, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.475 Vali Acc: 0.878 Test Loss: 0.475 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877773).  Saving model ...
Epoch: 19 cost time: 0.5108108520507812
Epoch: 19, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.436 Vali Acc: 0.904 Test Loss: 0.436 Test Acc: 0.904
Validation loss decreased (-0.877773 --> -0.903699).  Saving model ...
Epoch: 20 cost time: 0.6751303672790527
Epoch: 20, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.401 Vali Acc: 0.915 Test Loss: 0.401 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914811).  Saving model ...
Epoch: 21 cost time: 0.5164270401000977
Epoch: 21, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.371 Vali Acc: 0.915 Test Loss: 0.371 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 22 cost time: 0.6123268604278564
Epoch: 22, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.344 Vali Acc: 0.926 Test Loss: 0.344 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925922).  Saving model ...
Epoch: 23 cost time: 0.5514147281646729
Epoch: 23, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 24 cost time: 0.537299394607544
Epoch: 24, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.4788374900817871
Epoch: 25, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4938223361968994
Epoch: 26, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.274 Vali Acc: 0.919 Test Loss: 0.274 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.568568229675293
Epoch: 27, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.264 Vali Acc: 0.919 Test Loss: 0.264 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5334382057189941
Epoch: 28, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4662497043609619
Epoch: 29, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5659463405609131
Epoch: 30, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5866634845733643
Epoch: 31, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5829777717590332
Epoch: 32, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5204200744628906
Epoch: 33, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5420510768890381
Epoch: 34, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.215 Vali Acc: 0.919 Test Loss: 0.215 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 45798
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9554660320281982
Epoch: 1, Steps: 2 | Train Loss: 2.098 Vali Loss: 1.909 Vali Acc: 0.163 Test Loss: 1.909 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.5956964492797852
Epoch: 2, Steps: 2 | Train Loss: 2.012 Vali Loss: 1.844 Vali Acc: 0.196 Test Loss: 1.844 Test Acc: 0.196
Validation loss decreased (-0.162944 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.6728150844573975
Epoch: 3, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.791 Vali Acc: 0.244 Test Loss: 1.791 Test Acc: 0.244
Validation loss decreased (-0.196278 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 0.5813543796539307
Epoch: 4, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.733 Vali Acc: 0.293 Test Loss: 1.733 Test Acc: 0.293
Validation loss decreased (-0.244427 --> -0.292575).  Saving model ...
Epoch: 5 cost time: 0.6046056747436523
Epoch: 5, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.659 Vali Acc: 0.322 Test Loss: 1.659 Test Acc: 0.322
Validation loss decreased (-0.292575 --> -0.322206).  Saving model ...
Epoch: 6 cost time: 0.6089777946472168
Epoch: 6, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.574 Vali Acc: 0.356 Test Loss: 1.574 Test Acc: 0.356
Validation loss decreased (-0.322206 --> -0.355540).  Saving model ...
Epoch: 7 cost time: 0.48687267303466797
Epoch: 7, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.484 Vali Acc: 0.404 Test Loss: 1.484 Test Acc: 0.404
Validation loss decreased (-0.355540 --> -0.403689).  Saving model ...
Epoch: 8 cost time: 0.5844419002532959
Epoch: 8, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.389 Vali Acc: 0.489 Test Loss: 1.389 Test Acc: 0.489
Validation loss decreased (-0.403689 --> -0.488875).  Saving model ...
Epoch: 9 cost time: 0.5746939182281494
Epoch: 9, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.293 Vali Acc: 0.563 Test Loss: 1.293 Test Acc: 0.563
Validation loss decreased (-0.488875 --> -0.562950).  Saving model ...
Epoch: 10 cost time: 0.5836727619171143
Epoch: 10, Steps: 2 | Train Loss: 1.210 Vali Loss: 1.198 Vali Acc: 0.633 Test Loss: 1.198 Test Acc: 0.633
Validation loss decreased (-0.562950 --> -0.633321).  Saving model ...
Epoch: 11 cost time: 0.5734958648681641
Epoch: 11, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.104 Vali Acc: 0.722 Test Loss: 1.104 Test Acc: 0.722
Validation loss decreased (-0.633321 --> -0.722211).  Saving model ...
Epoch: 12 cost time: 0.5289175510406494
Epoch: 12, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.013 Vali Acc: 0.748 Test Loss: 1.013 Test Acc: 0.748
Validation loss decreased (-0.722211 --> -0.748138).  Saving model ...
Epoch: 13 cost time: 0.5759799480438232
Epoch: 13, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.929 Vali Acc: 0.767 Test Loss: 0.929 Test Acc: 0.767
Validation loss decreased (-0.748138 --> -0.766657).  Saving model ...
Epoch: 14 cost time: 0.5118482112884521
Epoch: 14, Steps: 2 | Train Loss: 0.864 Vali Loss: 0.851 Vali Acc: 0.819 Test Loss: 0.851 Test Acc: 0.819
Validation loss decreased (-0.766657 --> -0.818510).  Saving model ...
Epoch: 15 cost time: 0.4687681198120117
Epoch: 15, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.780 Vali Acc: 0.844 Test Loss: 0.780 Test Acc: 0.844
Validation loss decreased (-0.818510 --> -0.844437).  Saving model ...
Epoch: 16 cost time: 0.5192837715148926
Epoch: 16, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.717 Vali Acc: 0.859 Test Loss: 0.717 Test Acc: 0.859
Validation loss decreased (-0.844437 --> -0.859252).  Saving model ...
Epoch: 17 cost time: 0.5237033367156982
Epoch: 17, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.659 Vali Acc: 0.874 Test Loss: 0.659 Test Acc: 0.874
Validation loss decreased (-0.859252 --> -0.874067).  Saving model ...
Epoch: 18 cost time: 0.5167233943939209
Epoch: 18, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877772).  Saving model ...
Epoch: 19 cost time: 0.5677404403686523
Epoch: 19, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.558 Vali Acc: 0.881 Test Loss: 0.558 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 20 cost time: 0.5662713050842285
Epoch: 20, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.513 Vali Acc: 0.893 Test Loss: 0.513 Test Acc: 0.893
Validation loss decreased (-0.881476 --> -0.892587).  Saving model ...
Epoch: 21 cost time: 0.5256354808807373
Epoch: 21, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.5476937294006348
Epoch: 22, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.438 Vali Acc: 0.904 Test Loss: 0.438 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 23 cost time: 0.4458439350128174
Epoch: 23, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.406 Vali Acc: 0.907 Test Loss: 0.406 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 24 cost time: 0.5717236995697021
Epoch: 24, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.380 Vali Acc: 0.907 Test Loss: 0.380 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 25 cost time: 0.6056346893310547
Epoch: 25, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.359 Vali Acc: 0.915 Test Loss: 0.359 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914811).  Saving model ...
Epoch: 26 cost time: 0.6789412498474121
Epoch: 26, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 27 cost time: 0.6476519107818604
Epoch: 27, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.320 Vali Acc: 0.926 Test Loss: 0.320 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 28 cost time: 0.5654535293579102
Epoch: 28, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.5914311408996582
Epoch: 29, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.291 Vali Acc: 0.926 Test Loss: 0.291 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6545882225036621
Epoch: 30, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6120171546936035
Epoch: 31, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5929222106933594
Epoch: 32, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5934157371520996
Epoch: 33, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.258 Vali Acc: 0.926 Test Loss: 0.258 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5469362735748291
Epoch: 34, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6659448146820068
Epoch: 35, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.752685546875
Epoch: 36, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5745112895965576
Epoch: 37, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5049266815185547
Epoch: 38, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 38150
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0893850326538086
Epoch: 1, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.848 Vali Acc: 0.196 Test Loss: 1.848 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.549842357635498
Epoch: 2, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.789 Vali Acc: 0.200 Test Loss: 1.789 Test Acc: 0.200
Validation loss decreased (-0.196278 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.572058916091919
Epoch: 3, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.739 Vali Acc: 0.215 Test Loss: 1.739 Test Acc: 0.215
Validation loss decreased (-0.199982 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 0.6442751884460449
Epoch: 4, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.692 Vali Acc: 0.248 Test Loss: 1.692 Test Acc: 0.248
Validation loss decreased (-0.214797 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 0.5871171951293945
Epoch: 5, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.638 Vali Acc: 0.278 Test Loss: 1.638 Test Acc: 0.278
Validation loss decreased (-0.248131 --> -0.277761).  Saving model ...
Epoch: 6 cost time: 0.47846174240112305
Epoch: 6, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.578 Vali Acc: 0.307 Test Loss: 1.578 Test Acc: 0.307
Validation loss decreased (-0.277761 --> -0.307392).  Saving model ...
Epoch: 7 cost time: 0.6805553436279297
Epoch: 7, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.511 Vali Acc: 0.333 Test Loss: 1.511 Test Acc: 0.333
Validation loss decreased (-0.307392 --> -0.333318).  Saving model ...
Epoch: 8 cost time: 0.5151700973510742
Epoch: 8, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.441 Vali Acc: 0.385 Test Loss: 1.441 Test Acc: 0.385
Validation loss decreased (-0.333318 --> -0.385171).  Saving model ...
Epoch: 9 cost time: 0.5930979251861572
Epoch: 9, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.368 Vali Acc: 0.489 Test Loss: 1.368 Test Acc: 0.489
Validation loss decreased (-0.385171 --> -0.488875).  Saving model ...
Epoch: 10 cost time: 0.53757643699646
Epoch: 10, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.292 Vali Acc: 0.622 Test Loss: 1.292 Test Acc: 0.622
Validation loss decreased (-0.488875 --> -0.622209).  Saving model ...
Epoch: 11 cost time: 0.5313882827758789
Epoch: 11, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.217 Vali Acc: 0.667 Test Loss: 1.217 Test Acc: 0.667
Validation loss decreased (-0.622209 --> -0.666655).  Saving model ...
Epoch: 12 cost time: 0.5382516384124756
Epoch: 12, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.143 Vali Acc: 0.685 Test Loss: 1.143 Test Acc: 0.685
Validation loss decreased (-0.666655 --> -0.685174).  Saving model ...
Epoch: 13 cost time: 0.6007671356201172
Epoch: 13, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.071 Vali Acc: 0.715 Test Loss: 1.071 Test Acc: 0.715
Validation loss decreased (-0.685174 --> -0.714804).  Saving model ...
Epoch: 14 cost time: 0.5561501979827881
Epoch: 14, Steps: 2 | Train Loss: 0.903 Vali Loss: 1.003 Vali Acc: 0.733 Test Loss: 1.003 Test Acc: 0.733
Validation loss decreased (-0.714804 --> -0.733323).  Saving model ...
Epoch: 15 cost time: 0.5849831104278564
Epoch: 15, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.938 Vali Acc: 0.748 Test Loss: 0.938 Test Acc: 0.748
Validation loss decreased (-0.733323 --> -0.748139).  Saving model ...
Epoch: 16 cost time: 0.5387282371520996
Epoch: 16, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.876 Vali Acc: 0.789 Test Loss: 0.876 Test Acc: 0.789
Validation loss decreased (-0.748139 --> -0.788880).  Saving model ...
Epoch: 17 cost time: 0.4666404724121094
Epoch: 17, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.818 Vali Acc: 0.819 Test Loss: 0.818 Test Acc: 0.819
Validation loss decreased (-0.788880 --> -0.818510).  Saving model ...
Epoch: 18 cost time: 0.5622026920318604
Epoch: 18, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.762 Vali Acc: 0.830 Test Loss: 0.762 Test Acc: 0.830
Validation loss decreased (-0.818510 --> -0.829622).  Saving model ...
Epoch: 19 cost time: 0.5841779708862305
Epoch: 19, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.712 Vali Acc: 0.844 Test Loss: 0.712 Test Acc: 0.844
Validation loss decreased (-0.829622 --> -0.844437).  Saving model ...
Epoch: 20 cost time: 0.554844856262207
Epoch: 20, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.664 Vali Acc: 0.863 Test Loss: 0.664 Test Acc: 0.863
Validation loss decreased (-0.844437 --> -0.862956).  Saving model ...
Epoch: 21 cost time: 0.5148987770080566
Epoch: 21, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.623 Vali Acc: 0.885 Test Loss: 0.623 Test Acc: 0.885
Validation loss decreased (-0.862956 --> -0.885179).  Saving model ...
Epoch: 22 cost time: 0.5143322944641113
Epoch: 22, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.585 Vali Acc: 0.893 Test Loss: 0.585 Test Acc: 0.893
Validation loss decreased (-0.885179 --> -0.892587).  Saving model ...
Epoch: 23 cost time: 0.6055276393890381
Epoch: 23, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.552 Vali Acc: 0.896 Test Loss: 0.552 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 24 cost time: 0.5995285511016846
Epoch: 24, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.523 Vali Acc: 0.896 Test Loss: 0.523 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 25 cost time: 0.599555492401123
Epoch: 25, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.495 Vali Acc: 0.904 Test Loss: 0.495 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 26 cost time: 0.5948619842529297
Epoch: 26, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.468 Vali Acc: 0.915 Test Loss: 0.468 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914810).  Saving model ...
Epoch: 27 cost time: 0.5645897388458252
Epoch: 27, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.444 Vali Acc: 0.919 Test Loss: 0.444 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 28 cost time: 0.5392723083496094
Epoch: 28, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.422 Vali Acc: 0.911 Test Loss: 0.422 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6277799606323242
Epoch: 29, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.404 Vali Acc: 0.915 Test Loss: 0.404 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5626609325408936
Epoch: 30, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.386 Vali Acc: 0.915 Test Loss: 0.386 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5283465385437012
Epoch: 31, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.369 Vali Acc: 0.915 Test Loss: 0.369 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4535486698150635
Epoch: 32, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.353 Vali Acc: 0.915 Test Loss: 0.353 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5642874240875244
Epoch: 33, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 34 cost time: 0.5123491287231445
Epoch: 34, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.326 Vali Acc: 0.919 Test Loss: 0.326 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 35 cost time: 0.5413451194763184
Epoch: 35, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.313 Vali Acc: 0.919 Test Loss: 0.313 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 36 cost time: 0.527888298034668
Epoch: 36, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.304 Vali Acc: 0.919 Test Loss: 0.304 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 37 cost time: 0.5733163356781006
Epoch: 37, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 38 cost time: 0.5603220462799072
Epoch: 38, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 39 cost time: 0.5397930145263672
Epoch: 39, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 40 cost time: 0.5125744342803955
Epoch: 40, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 41 cost time: 0.5265557765960693
Epoch: 41, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6614713668823242
Epoch: 42, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6197125911712646
Epoch: 43, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5891015529632568
Epoch: 44, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5545895099639893
Epoch: 45, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.581373929977417
Epoch: 46, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5888278484344482
Epoch: 47, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5700252056121826
Epoch: 48, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5041306018829346
Epoch: 49, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.49124646186828613
Epoch: 50, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 33606
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0661163330078125
Epoch: 1, Steps: 2 | Train Loss: 2.178 Vali Loss: 2.035 Vali Acc: 0.015 Test Loss: 2.035 Test Acc: 0.015
Validation loss decreased (inf --> -0.014794).  Saving model ...
Epoch: 2 cost time: 0.5740869045257568
Epoch: 2, Steps: 2 | Train Loss: 2.037 Vali Loss: 1.974 Vali Acc: 0.041 Test Loss: 1.974 Test Acc: 0.041
Validation loss decreased (-0.014794 --> -0.040721).  Saving model ...
Epoch: 3 cost time: 0.48816418647766113
Epoch: 3, Steps: 2 | Train Loss: 1.958 Vali Loss: 1.928 Vali Acc: 0.059 Test Loss: 1.928 Test Acc: 0.059
Validation loss decreased (-0.040721 --> -0.059240).  Saving model ...
Epoch: 4 cost time: 0.6235778331756592
Epoch: 4, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.885 Vali Acc: 0.096 Test Loss: 1.885 Test Acc: 0.096
Validation loss decreased (-0.059240 --> -0.096277).  Saving model ...
Epoch: 5 cost time: 0.5005340576171875
Epoch: 5, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.834 Vali Acc: 0.133 Test Loss: 1.834 Test Acc: 0.133
Validation loss decreased (-0.096277 --> -0.133315).  Saving model ...
Epoch: 6 cost time: 0.5588207244873047
Epoch: 6, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.776 Vali Acc: 0.185 Test Loss: 1.776 Test Acc: 0.185
Validation loss decreased (-0.133315 --> -0.185167).  Saving model ...
Epoch: 7 cost time: 0.5327901840209961
Epoch: 7, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.711 Vali Acc: 0.241 Test Loss: 1.711 Test Acc: 0.241
Validation loss decreased (-0.185167 --> -0.240724).  Saving model ...
Epoch: 8 cost time: 0.5502009391784668
Epoch: 8, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.641 Vali Acc: 0.311 Test Loss: 1.641 Test Acc: 0.311
Validation loss decreased (-0.240724 --> -0.311095).  Saving model ...
Epoch: 9 cost time: 0.5581111907958984
Epoch: 9, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.567 Vali Acc: 0.378 Test Loss: 1.567 Test Acc: 0.378
Validation loss decreased (-0.311095 --> -0.377762).  Saving model ...
Epoch: 10 cost time: 0.6143195629119873
Epoch: 10, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.490 Vali Acc: 0.470 Test Loss: 1.490 Test Acc: 0.470
Validation loss decreased (-0.377762 --> -0.470355).  Saving model ...
Epoch: 11 cost time: 0.43467211723327637
Epoch: 11, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.411 Vali Acc: 0.544 Test Loss: 1.411 Test Acc: 0.544
Validation loss decreased (-0.470355 --> -0.544430).  Saving model ...
Epoch: 12 cost time: 0.5473175048828125
Epoch: 12, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.331 Vali Acc: 0.641 Test Loss: 1.331 Test Acc: 0.641
Validation loss decreased (-0.544430 --> -0.640727).  Saving model ...
Epoch: 13 cost time: 0.5976324081420898
Epoch: 13, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.252 Vali Acc: 0.715 Test Loss: 1.252 Test Acc: 0.715
Validation loss decreased (-0.640727 --> -0.714802).  Saving model ...
Epoch: 14 cost time: 0.6142008304595947
Epoch: 14, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.173 Vali Acc: 0.781 Test Loss: 1.173 Test Acc: 0.781
Validation loss decreased (-0.714802 --> -0.781470).  Saving model ...
Epoch: 15 cost time: 0.5336546897888184
Epoch: 15, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.098 Vali Acc: 0.811 Test Loss: 1.098 Test Acc: 0.811
Validation loss decreased (-0.781470 --> -0.811100).  Saving model ...
Epoch: 16 cost time: 0.5142228603363037
Epoch: 16, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.027 Vali Acc: 0.819 Test Loss: 1.027 Test Acc: 0.819
Validation loss decreased (-0.811100 --> -0.818508).  Saving model ...
Epoch: 17 cost time: 0.5145561695098877
Epoch: 17, Steps: 2 | Train Loss: 0.917 Vali Loss: 0.958 Vali Acc: 0.841 Test Loss: 0.958 Test Acc: 0.841
Validation loss decreased (-0.818508 --> -0.840731).  Saving model ...
Epoch: 18 cost time: 0.5097603797912598
Epoch: 18, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.894 Vali Acc: 0.859 Test Loss: 0.894 Test Acc: 0.859
Validation loss decreased (-0.840731 --> -0.859250).  Saving model ...
Epoch: 19 cost time: 0.5768711566925049
Epoch: 19, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.835 Vali Acc: 0.874 Test Loss: 0.835 Test Acc: 0.874
Validation loss decreased (-0.859250 --> -0.874066).  Saving model ...
Epoch: 20 cost time: 0.5496742725372314
Epoch: 20, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.779 Vali Acc: 0.881 Test Loss: 0.779 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 21 cost time: 0.4798257350921631
Epoch: 21, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.728 Vali Acc: 0.889 Test Loss: 0.728 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888882).  Saving model ...
Epoch: 22 cost time: 0.48570799827575684
Epoch: 22, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.680 Vali Acc: 0.900 Test Loss: 0.680 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899993).  Saving model ...
Epoch: 23 cost time: 0.6192212104797363
Epoch: 23, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.637 Vali Acc: 0.900 Test Loss: 0.637 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.5355634689331055
Epoch: 24, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.596 Vali Acc: 0.904 Test Loss: 0.596 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 25 cost time: 0.49615931510925293
Epoch: 25, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.559 Vali Acc: 0.904 Test Loss: 0.559 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 26 cost time: 0.4917745590209961
Epoch: 26, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.525 Vali Acc: 0.911 Test Loss: 0.525 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 27 cost time: 0.5569250583648682
Epoch: 27, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.494 Vali Acc: 0.907 Test Loss: 0.494 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5468053817749023
Epoch: 28, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.465 Vali Acc: 0.911 Test Loss: 0.465 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 29 cost time: 0.5466756820678711
Epoch: 29, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.439 Vali Acc: 0.915 Test Loss: 0.439 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 30 cost time: 0.5624582767486572
Epoch: 30, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.418 Vali Acc: 0.915 Test Loss: 0.418 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 31 cost time: 0.5588557720184326
Epoch: 31, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.397 Vali Acc: 0.915 Test Loss: 0.397 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.5380024909973145
Epoch: 32, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.379 Vali Acc: 0.915 Test Loss: 0.379 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 33 cost time: 0.5665500164031982
Epoch: 33, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.363 Vali Acc: 0.915 Test Loss: 0.363 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 34 cost time: 0.5776093006134033
Epoch: 34, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.348 Vali Acc: 0.919 Test Loss: 0.348 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 35 cost time: 0.5433225631713867
Epoch: 35, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.335 Vali Acc: 0.922 Test Loss: 0.335 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 36 cost time: 0.5353348255157471
Epoch: 36, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 37 cost time: 0.6156973838806152
Epoch: 37, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 38 cost time: 0.6290059089660645
Epoch: 38, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.304 Vali Acc: 0.926 Test Loss: 0.304 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 39 cost time: 0.5478742122650146
Epoch: 39, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.5302798748016357
Epoch: 40, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.58683180809021
Epoch: 41, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.6031317710876465
Epoch: 42, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.273 Vali Acc: 0.933 Test Loss: 0.273 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.5503489971160889
Epoch: 43, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 44 cost time: 0.5215067863464355
Epoch: 44, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 45 cost time: 0.5488059520721436
Epoch: 45, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 46 cost time: 0.5406174659729004
Epoch: 46, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 47 cost time: 0.5344784259796143
Epoch: 47, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.5212085247039795
Epoch: 48, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.47651124000549316
Epoch: 49, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 50 cost time: 0.5147819519042969
Epoch: 50, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 51 cost time: 0.5914149284362793
Epoch: 51, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 52 cost time: 0.6248588562011719
Epoch: 52, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 53 cost time: 0.5301871299743652
Epoch: 53, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 54 cost time: 0.47939133644104004
Epoch: 54, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 55 cost time: 0.4899106025695801
Epoch: 55, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.5583219528198242
Epoch: 56, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.5135190486907959
Epoch: 57, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.5667679309844971
Epoch: 58, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.48366665840148926
Epoch: 59, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 0.4896864891052246
Epoch: 60, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 0.5960872173309326
Epoch: 61, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 62 cost time: 0.555138349533081
Epoch: 62, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.944442 --> -0.951850).  Saving model ...
Epoch: 63 cost time: 0.5684814453125
Epoch: 63, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.213 Vali Acc: 0.952 Test Loss: 0.213 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 64 cost time: 0.5447409152984619
Epoch: 64, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5465235710144043
Epoch: 65, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.6177515983581543
Epoch: 66, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.5029788017272949
Epoch: 67, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.5584492683410645
Epoch: 68, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.4717690944671631
Epoch: 69, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.5085794925689697
Epoch: 70, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.5083224773406982
Epoch: 71, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.6090455055236816
Epoch: 72, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.5687861442565918
Epoch: 73, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 31398
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9990832805633545
Epoch: 1, Steps: 2 | Train Loss: 1.917 Vali Loss: 1.869 Vali Acc: 0.256 Test Loss: 1.869 Test Acc: 0.256
Validation loss decreased (inf --> -0.255537).  Saving model ...
Epoch: 2 cost time: 0.5529379844665527
Epoch: 2, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.819 Vali Acc: 0.274 Test Loss: 1.819 Test Acc: 0.274
Validation loss decreased (-0.255537 --> -0.274056).  Saving model ...
Epoch: 3 cost time: 0.5492615699768066
Epoch: 3, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.781 Vali Acc: 0.304 Test Loss: 1.781 Test Acc: 0.304
Validation loss decreased (-0.274056 --> -0.303686).  Saving model ...
Epoch: 4 cost time: 0.5235230922698975
Epoch: 4, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.748 Vali Acc: 0.337 Test Loss: 1.748 Test Acc: 0.337
Validation loss decreased (-0.303686 --> -0.337020).  Saving model ...
Epoch: 5 cost time: 0.46768617630004883
Epoch: 5, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.708 Vali Acc: 0.352 Test Loss: 1.708 Test Acc: 0.352
Validation loss decreased (-0.337020 --> -0.351835).  Saving model ...
Epoch: 6 cost time: 0.48354506492614746
Epoch: 6, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.665 Vali Acc: 0.381 Test Loss: 1.665 Test Acc: 0.381
Validation loss decreased (-0.351835 --> -0.381465).  Saving model ...
Epoch: 7 cost time: 0.5841162204742432
Epoch: 7, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.619 Vali Acc: 0.396 Test Loss: 1.619 Test Acc: 0.396
Validation loss decreased (-0.381465 --> -0.396280).  Saving model ...
Epoch: 8 cost time: 0.4917871952056885
Epoch: 8, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.569 Vali Acc: 0.426 Test Loss: 1.569 Test Acc: 0.426
Validation loss decreased (-0.396280 --> -0.425910).  Saving model ...
Epoch: 9 cost time: 0.4916210174560547
Epoch: 9, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.516 Vali Acc: 0.448 Test Loss: 1.516 Test Acc: 0.448
Validation loss decreased (-0.425910 --> -0.448133).  Saving model ...
Epoch: 10 cost time: 0.4924600124359131
Epoch: 10, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.462 Vali Acc: 0.500 Test Loss: 1.462 Test Acc: 0.500
Validation loss decreased (-0.448133 --> -0.499985).  Saving model ...
Epoch: 11 cost time: 0.5670008659362793
Epoch: 11, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.407 Vali Acc: 0.541 Test Loss: 1.407 Test Acc: 0.541
Validation loss decreased (-0.499985 --> -0.540727).  Saving model ...
Epoch: 12 cost time: 0.528134822845459
Epoch: 12, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.350 Vali Acc: 0.607 Test Loss: 1.350 Test Acc: 0.607
Validation loss decreased (-0.540727 --> -0.607394).  Saving model ...
Epoch: 13 cost time: 0.5641460418701172
Epoch: 13, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.292 Vali Acc: 0.656 Test Loss: 1.292 Test Acc: 0.656
Validation loss decreased (-0.607394 --> -0.655543).  Saving model ...
Epoch: 14 cost time: 0.5543041229248047
Epoch: 14, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.236 Vali Acc: 0.674 Test Loss: 1.236 Test Acc: 0.674
Validation loss decreased (-0.655543 --> -0.674062).  Saving model ...
Epoch: 15 cost time: 0.5247268676757812
Epoch: 15, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.180 Vali Acc: 0.696 Test Loss: 1.180 Test Acc: 0.696
Validation loss decreased (-0.674062 --> -0.696284).  Saving model ...
Epoch: 16 cost time: 0.5379390716552734
Epoch: 16, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.126 Vali Acc: 0.711 Test Loss: 1.126 Test Acc: 0.711
Validation loss decreased (-0.696284 --> -0.711100).  Saving model ...
Epoch: 17 cost time: 0.5003321170806885
Epoch: 17, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.073 Vali Acc: 0.737 Test Loss: 1.073 Test Acc: 0.737
Validation loss decreased (-0.711100 --> -0.737026).  Saving model ...
Epoch: 18 cost time: 0.5211763381958008
Epoch: 18, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.021 Vali Acc: 0.752 Test Loss: 1.021 Test Acc: 0.752
Validation loss decreased (-0.737026 --> -0.751842).  Saving model ...
Epoch: 19 cost time: 0.4998342990875244
Epoch: 19, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.970 Vali Acc: 0.774 Test Loss: 0.970 Test Acc: 0.774
Validation loss decreased (-0.751842 --> -0.774064).  Saving model ...
Epoch: 20 cost time: 0.5900123119354248
Epoch: 20, Steps: 2 | Train Loss: 0.954 Vali Loss: 0.922 Vali Acc: 0.807 Test Loss: 0.922 Test Acc: 0.807
Validation loss decreased (-0.774064 --> -0.807398).  Saving model ...
Epoch: 21 cost time: 0.4967308044433594
Epoch: 21, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.876 Vali Acc: 0.830 Test Loss: 0.876 Test Acc: 0.830
Validation loss decreased (-0.807398 --> -0.829621).  Saving model ...
Epoch: 22 cost time: 0.556349515914917
Epoch: 22, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.832 Vali Acc: 0.841 Test Loss: 0.832 Test Acc: 0.841
Validation loss decreased (-0.829621 --> -0.840732).  Saving model ...
Epoch: 23 cost time: 0.5743722915649414
Epoch: 23, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.790 Vali Acc: 0.848 Test Loss: 0.790 Test Acc: 0.848
Validation loss decreased (-0.840732 --> -0.848140).  Saving model ...
Epoch: 24 cost time: 0.5074818134307861
Epoch: 24, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.751 Vali Acc: 0.856 Test Loss: 0.751 Test Acc: 0.856
Validation loss decreased (-0.848140 --> -0.855548).  Saving model ...
Epoch: 25 cost time: 0.4757997989654541
Epoch: 25, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.712 Vali Acc: 0.863 Test Loss: 0.712 Test Acc: 0.863
Validation loss decreased (-0.855548 --> -0.862956).  Saving model ...
Epoch: 26 cost time: 0.5748474597930908
Epoch: 26, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.678 Vali Acc: 0.870 Test Loss: 0.678 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870364).  Saving model ...
Epoch: 27 cost time: 0.43563342094421387
Epoch: 27, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.646 Vali Acc: 0.874 Test Loss: 0.646 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 28 cost time: 0.4578683376312256
Epoch: 28, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.616 Vali Acc: 0.885 Test Loss: 0.616 Test Acc: 0.885
Validation loss decreased (-0.874068 --> -0.885179).  Saving model ...
Epoch: 29 cost time: 0.4752488136291504
Epoch: 29, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.587 Vali Acc: 0.907 Test Loss: 0.587 Test Acc: 0.907
Validation loss decreased (-0.885179 --> -0.907402).  Saving model ...
Epoch: 30 cost time: 0.5402836799621582
Epoch: 30, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.561 Vali Acc: 0.911 Test Loss: 0.561 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 31 cost time: 0.5114865303039551
Epoch: 31, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.536 Vali Acc: 0.911 Test Loss: 0.536 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 32 cost time: 0.4982731342315674
Epoch: 32, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.513 Vali Acc: 0.915 Test Loss: 0.513 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 33 cost time: 0.489119291305542
Epoch: 33, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.493 Vali Acc: 0.915 Test Loss: 0.493 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 34 cost time: 0.5601489543914795
Epoch: 34, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.473 Vali Acc: 0.919 Test Loss: 0.473 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 35 cost time: 0.5197873115539551
Epoch: 35, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.456 Vali Acc: 0.919 Test Loss: 0.456 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 36 cost time: 0.4857480525970459
Epoch: 36, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.440 Vali Acc: 0.922 Test Loss: 0.440 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 37 cost time: 0.44480085372924805
Epoch: 37, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.424 Vali Acc: 0.922 Test Loss: 0.424 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 38 cost time: 0.5121841430664062
Epoch: 38, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.409 Vali Acc: 0.926 Test Loss: 0.409 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 39 cost time: 0.47066473960876465
Epoch: 39, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.396 Vali Acc: 0.926 Test Loss: 0.396 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 40 cost time: 0.5057778358459473
Epoch: 40, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.384 Vali Acc: 0.926 Test Loss: 0.384 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 41 cost time: 0.559941291809082
Epoch: 41, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.373 Vali Acc: 0.930 Test Loss: 0.373 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 42 cost time: 0.4656100273132324
Epoch: 42, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.363 Vali Acc: 0.930 Test Loss: 0.363 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 43 cost time: 0.44601988792419434
Epoch: 43, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 44 cost time: 0.5381968021392822
Epoch: 44, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.346 Vali Acc: 0.930 Test Loss: 0.346 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 45 cost time: 0.5040595531463623
Epoch: 45, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.338 Vali Acc: 0.933 Test Loss: 0.338 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 46 cost time: 0.5300612449645996
Epoch: 46, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.331 Vali Acc: 0.933 Test Loss: 0.331 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 47 cost time: 0.5594468116760254
Epoch: 47, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.325 Vali Acc: 0.930 Test Loss: 0.325 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5980057716369629
Epoch: 48, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5559394359588623
Epoch: 49, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.314 Vali Acc: 0.930 Test Loss: 0.314 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5672030448913574
Epoch: 50, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5654754638671875
Epoch: 51, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5539062023162842
Epoch: 52, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.298 Vali Acc: 0.930 Test Loss: 0.298 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5383985042572021
Epoch: 53, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.293 Vali Acc: 0.933 Test Loss: 0.293 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 54 cost time: 0.5249285697937012
Epoch: 54, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.288 Vali Acc: 0.933 Test Loss: 0.288 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 55 cost time: 0.5171170234680176
Epoch: 55, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 56 cost time: 0.5143637657165527
Epoch: 56, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 57 cost time: 0.5042402744293213
Epoch: 57, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 58 cost time: 0.5341074466705322
Epoch: 58, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 0.4866466522216797
Epoch: 59, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 60 cost time: 0.5040614604949951
Epoch: 60, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 61 cost time: 0.47090744972229004
Epoch: 61, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 62 cost time: 0.6883108615875244
Epoch: 62, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 63 cost time: 0.457836389541626
Epoch: 63, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 64 cost time: 0.46868443489074707
Epoch: 64, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 65 cost time: 0.5023300647735596
Epoch: 65, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 66 cost time: 0.6275119781494141
Epoch: 66, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5114610195159912
Epoch: 67, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5963637828826904
Epoch: 68, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.5565097332000732
Epoch: 69, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.49947166442871094
Epoch: 70, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 71 cost time: 0.6020841598510742
Epoch: 71, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 72 cost time: 0.5042769908905029
Epoch: 72, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 73 cost time: 0.4956321716308594
Epoch: 73, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 74 cost time: 0.7607817649841309
Epoch: 74, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 75 cost time: 0.6724975109100342
Epoch: 75, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 76 cost time: 0.49089789390563965
Epoch: 76, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 77 cost time: 0.5243606567382812
Epoch: 77, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 78 cost time: 0.47743892669677734
Epoch: 78, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 79 cost time: 0.5623893737792969
Epoch: 79, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 80 cost time: 0.4897279739379883
Epoch: 80, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 81 cost time: 0.567284107208252
Epoch: 81, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 82 cost time: 0.5693845748901367
Epoch: 82, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 83 cost time: 0.524590015411377
Epoch: 83, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 84 cost time: 0.4947235584259033
Epoch: 84, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 85 cost time: 0.5333530902862549
Epoch: 85, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 86 cost time: 0.5683064460754395
Epoch: 86, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 87 cost time: 0.4741330146789551
Epoch: 87, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 88 cost time: 0.49193859100341797
Epoch: 88, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 89 cost time: 0.4973106384277344
Epoch: 89, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 90 cost time: 0.5534157752990723
Epoch: 90, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 91 cost time: 0.5249297618865967
Epoch: 91, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 92 cost time: 0.5800235271453857
Epoch: 92, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 93 cost time: 0.525855541229248
Epoch: 93, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 94 cost time: 0.5202288627624512
Epoch: 94, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 95 cost time: 0.47224926948547363
Epoch: 95, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 96 cost time: 0.5182914733886719
Epoch: 96, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 97 cost time: 0.48302459716796875
Epoch: 97, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 98 cost time: 0.5884172916412354
Epoch: 98, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 99 cost time: 0.532524824142456
Epoch: 99, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 100 cost time: 0.49826478958129883
Epoch: 100, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 28422
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8711731433868408
Epoch: 1, Steps: 2 | Train Loss: 2.080 Vali Loss: 2.086 Vali Acc: 0.137 Test Loss: 2.086 Test Acc: 0.137
Validation loss decreased (inf --> -0.137016).  Saving model ...
Epoch: 2 cost time: 0.5099067687988281
Epoch: 2, Steps: 2 | Train Loss: 2.084 Vali Loss: 2.040 Vali Acc: 0.167 Test Loss: 2.040 Test Acc: 0.167
Validation loss decreased (-0.137016 --> -0.166646).  Saving model ...
Epoch: 3 cost time: 0.4856081008911133
Epoch: 3, Steps: 2 | Train Loss: 2.238 Vali Loss: 2.008 Vali Acc: 0.144 Test Loss: 2.008 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4967665672302246
Epoch: 4, Steps: 2 | Train Loss: 2.089 Vali Loss: 1.983 Vali Acc: 0.137 Test Loss: 1.983 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.46696019172668457
Epoch: 5, Steps: 2 | Train Loss: 2.090 Vali Loss: 1.954 Vali Acc: 0.130 Test Loss: 1.954 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.578700065612793
Epoch: 6, Steps: 2 | Train Loss: 1.973 Vali Loss: 1.921 Vali Acc: 0.126 Test Loss: 1.921 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.494720458984375
Epoch: 7, Steps: 2 | Train Loss: 1.981 Vali Loss: 1.884 Vali Acc: 0.137 Test Loss: 1.884 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5809957981109619
Epoch: 8, Steps: 2 | Train Loss: 1.910 Vali Loss: 1.844 Vali Acc: 0.156 Test Loss: 1.844 Test Acc: 0.156
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5505857467651367
Epoch: 9, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.799 Vali Acc: 0.163 Test Loss: 1.799 Test Acc: 0.163
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5849900245666504
Epoch: 10, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.752 Vali Acc: 0.181 Test Loss: 1.752 Test Acc: 0.181
Validation loss decreased (-0.166646 --> -0.181464).  Saving model ...
Epoch: 11 cost time: 0.5115172863006592
Epoch: 11, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.702 Vali Acc: 0.222 Test Loss: 1.702 Test Acc: 0.222
Validation loss decreased (-0.181464 --> -0.222205).  Saving model ...
Epoch: 12 cost time: 0.5718915462493896
Epoch: 12, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.650 Vali Acc: 0.237 Test Loss: 1.650 Test Acc: 0.237
Validation loss decreased (-0.222205 --> -0.237021).  Saving model ...
Epoch: 13 cost time: 0.6260912418365479
Epoch: 13, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.596 Vali Acc: 0.267 Test Loss: 1.596 Test Acc: 0.267
Validation loss decreased (-0.237021 --> -0.266651).  Saving model ...
Epoch: 14 cost time: 0.492551326751709
Epoch: 14, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.540 Vali Acc: 0.296 Test Loss: 1.540 Test Acc: 0.296
Validation loss decreased (-0.266651 --> -0.296281).  Saving model ...
Epoch: 15 cost time: 0.542945384979248
Epoch: 15, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.483 Vali Acc: 0.389 Test Loss: 1.483 Test Acc: 0.389
Validation loss decreased (-0.296281 --> -0.388874).  Saving model ...
Epoch: 16 cost time: 0.43499159812927246
Epoch: 16, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.426 Vali Acc: 0.496 Test Loss: 1.426 Test Acc: 0.496
Validation loss decreased (-0.388874 --> -0.496282).  Saving model ...
Epoch: 17 cost time: 0.4952280521392822
Epoch: 17, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.369 Vali Acc: 0.596 Test Loss: 1.369 Test Acc: 0.596
Validation loss decreased (-0.496282 --> -0.596283).  Saving model ...
Epoch: 18 cost time: 0.4824228286743164
Epoch: 18, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.311 Vali Acc: 0.681 Test Loss: 1.311 Test Acc: 0.681
Validation loss decreased (-0.596283 --> -0.681468).  Saving model ...
Epoch: 19 cost time: 0.5217008590698242
Epoch: 19, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.254 Vali Acc: 0.730 Test Loss: 1.254 Test Acc: 0.730
Validation loss decreased (-0.681468 --> -0.729617).  Saving model ...
Epoch: 20 cost time: 0.5159986019134521
Epoch: 20, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.197 Vali Acc: 0.763 Test Loss: 1.197 Test Acc: 0.763
Validation loss decreased (-0.729617 --> -0.762951).  Saving model ...
Epoch: 21 cost time: 0.5437569618225098
Epoch: 21, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.140 Vali Acc: 0.793 Test Loss: 1.140 Test Acc: 0.793
Validation loss decreased (-0.762951 --> -0.792581).  Saving model ...
Epoch: 22 cost time: 0.4995136260986328
Epoch: 22, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.085 Vali Acc: 0.819 Test Loss: 1.085 Test Acc: 0.819
Validation loss decreased (-0.792581 --> -0.818508).  Saving model ...
Epoch: 23 cost time: 0.48500704765319824
Epoch: 23, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.031 Vali Acc: 0.837 Test Loss: 1.031 Test Acc: 0.837
Validation loss decreased (-0.818508 --> -0.837027).  Saving model ...
Epoch: 24 cost time: 0.5101063251495361
Epoch: 24, Steps: 2 | Train Loss: 0.923 Vali Loss: 0.979 Vali Acc: 0.852 Test Loss: 0.979 Test Acc: 0.852
Validation loss decreased (-0.837027 --> -0.851842).  Saving model ...
Epoch: 25 cost time: 0.48799705505371094
Epoch: 25, Steps: 2 | Train Loss: 0.975 Vali Loss: 0.928 Vali Acc: 0.852 Test Loss: 0.928 Test Acc: 0.852
Validation loss decreased (-0.851842 --> -0.851843).  Saving model ...
Epoch: 26 cost time: 0.6194555759429932
Epoch: 26, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.881 Vali Acc: 0.863 Test Loss: 0.881 Test Acc: 0.863
Validation loss decreased (-0.851843 --> -0.862954).  Saving model ...
Epoch: 27 cost time: 0.5951516628265381
Epoch: 27, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.834 Vali Acc: 0.870 Test Loss: 0.834 Test Acc: 0.870
Validation loss decreased (-0.862954 --> -0.870362).  Saving model ...
Epoch: 28 cost time: 0.7070653438568115
Epoch: 28, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.790 Vali Acc: 0.878 Test Loss: 0.790 Test Acc: 0.878
Validation loss decreased (-0.870362 --> -0.877770).  Saving model ...
Epoch: 29 cost time: 0.5994846820831299
Epoch: 29, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.749 Vali Acc: 0.889 Test Loss: 0.749 Test Acc: 0.889
Validation loss decreased (-0.877770 --> -0.888881).  Saving model ...
Epoch: 30 cost time: 0.509347677230835
Epoch: 30, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.709 Vali Acc: 0.904 Test Loss: 0.709 Test Acc: 0.904
Validation loss decreased (-0.888881 --> -0.903697).  Saving model ...
Epoch: 31 cost time: 0.4893009662628174
Epoch: 31, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.673 Vali Acc: 0.904 Test Loss: 0.673 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 32 cost time: 0.46565818786621094
Epoch: 32, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.639 Vali Acc: 0.911 Test Loss: 0.639 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 33 cost time: 0.48709797859191895
Epoch: 33, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.608 Vali Acc: 0.915 Test Loss: 0.608 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 34 cost time: 0.4859952926635742
Epoch: 34, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.579 Vali Acc: 0.930 Test Loss: 0.579 Test Acc: 0.930
Validation loss decreased (-0.914809 --> -0.929624).  Saving model ...
Epoch: 35 cost time: 0.509528636932373
Epoch: 35, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.552 Vali Acc: 0.930 Test Loss: 0.552 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 36 cost time: 0.6482055187225342
Epoch: 36, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.527 Vali Acc: 0.930 Test Loss: 0.527 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 37 cost time: 0.6340835094451904
Epoch: 37, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.505 Vali Acc: 0.926 Test Loss: 0.505 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.48535585403442383
Epoch: 38, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.484 Vali Acc: 0.926 Test Loss: 0.484 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.48969125747680664
Epoch: 39, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.465 Vali Acc: 0.933 Test Loss: 0.465 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933329).  Saving model ...
Epoch: 40 cost time: 0.43544626235961914
Epoch: 40, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.449 Vali Acc: 0.933 Test Loss: 0.449 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 41 cost time: 0.5739245414733887
Epoch: 41, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.433 Vali Acc: 0.933 Test Loss: 0.433 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 42 cost time: 0.5442724227905273
Epoch: 42, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.418 Vali Acc: 0.937 Test Loss: 0.418 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 43 cost time: 0.4763610363006592
Epoch: 43, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.405 Vali Acc: 0.937 Test Loss: 0.405 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 44 cost time: 0.5191981792449951
Epoch: 44, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.393 Vali Acc: 0.941 Test Loss: 0.393 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 45 cost time: 0.5211210250854492
Epoch: 45, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.382 Vali Acc: 0.944 Test Loss: 0.382 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 46 cost time: 0.5063931941986084
Epoch: 46, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.372 Vali Acc: 0.944 Test Loss: 0.372 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 47 cost time: 0.5421037673950195
Epoch: 47, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.363 Vali Acc: 0.948 Test Loss: 0.363 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 48 cost time: 0.5064237117767334
Epoch: 48, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.355 Vali Acc: 0.944 Test Loss: 0.355 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.47777318954467773
Epoch: 49, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.347 Vali Acc: 0.944 Test Loss: 0.347 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4890298843383789
Epoch: 50, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.340 Vali Acc: 0.944 Test Loss: 0.340 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5202038288116455
Epoch: 51, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.332 Vali Acc: 0.944 Test Loss: 0.332 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.4959847927093506
Epoch: 52, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.4865858554840088
Epoch: 53, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.318 Vali Acc: 0.944 Test Loss: 0.318 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.4886631965637207
Epoch: 54, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.311 Vali Acc: 0.944 Test Loss: 0.311 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.43183422088623047
Epoch: 55, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.521613597869873
Epoch: 56, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.300 Vali Acc: 0.944 Test Loss: 0.300 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.516150712966919
Epoch: 57, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 27014
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.949012041091919
Epoch: 1, Steps: 2 | Train Loss: 2.122 Vali Loss: 1.963 Vali Acc: 0.159 Test Loss: 1.963 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.5524656772613525
Epoch: 2, Steps: 2 | Train Loss: 2.054 Vali Loss: 1.853 Vali Acc: 0.226 Test Loss: 1.853 Test Acc: 0.226
Validation loss decreased (-0.159240 --> -0.225907).  Saving model ...
Epoch: 3 cost time: 0.4336390495300293
Epoch: 3, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.740 Vali Acc: 0.356 Test Loss: 1.740 Test Acc: 0.356
Validation loss decreased (-0.225907 --> -0.355538).  Saving model ...
Epoch: 4 cost time: 0.5148794651031494
Epoch: 4, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.592 Vali Acc: 0.448 Test Loss: 1.592 Test Acc: 0.448
Validation loss decreased (-0.355538 --> -0.448132).  Saving model ...
Epoch: 5 cost time: 0.5179958343505859
Epoch: 5, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.419 Vali Acc: 0.519 Test Loss: 1.419 Test Acc: 0.519
Validation loss decreased (-0.448132 --> -0.518504).  Saving model ...
Epoch: 6 cost time: 0.5218560695648193
Epoch: 6, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.235 Vali Acc: 0.670 Test Loss: 1.235 Test Acc: 0.670
Validation loss decreased (-0.518504 --> -0.670358).  Saving model ...
Epoch: 7 cost time: 0.5111427307128906
Epoch: 7, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.057 Vali Acc: 0.752 Test Loss: 1.057 Test Acc: 0.752
Validation loss decreased (-0.670358 --> -0.751841).  Saving model ...
Epoch: 8 cost time: 0.5305395126342773
Epoch: 8, Steps: 2 | Train Loss: 0.977 Vali Loss: 0.903 Vali Acc: 0.807 Test Loss: 0.903 Test Acc: 0.807
Validation loss decreased (-0.751841 --> -0.807398).  Saving model ...
Epoch: 9 cost time: 0.5152020454406738
Epoch: 9, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.769 Vali Acc: 0.870 Test Loss: 0.769 Test Acc: 0.870
Validation loss decreased (-0.807398 --> -0.870363).  Saving model ...
Epoch: 10 cost time: 0.5892374515533447
Epoch: 10, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.659 Vali Acc: 0.896 Test Loss: 0.659 Test Acc: 0.896
Validation loss decreased (-0.870363 --> -0.896290).  Saving model ...
Epoch: 11 cost time: 0.5497581958770752
Epoch: 11, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.567 Vali Acc: 0.907 Test Loss: 0.567 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907402).  Saving model ...
Epoch: 12 cost time: 0.6091046333312988
Epoch: 12, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.489 Vali Acc: 0.926 Test Loss: 0.489 Test Acc: 0.926
Validation loss decreased (-0.907402 --> -0.925921).  Saving model ...
Epoch: 13 cost time: 0.589104413986206
Epoch: 13, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.426 Vali Acc: 0.922 Test Loss: 0.426 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.566368818283081
Epoch: 14, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.373 Vali Acc: 0.933 Test Loss: 0.373 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933330).  Saving model ...
Epoch: 15 cost time: 0.6703245639801025
Epoch: 15, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.332 Vali Acc: 0.930 Test Loss: 0.332 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5553774833679199
Epoch: 16, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.7181739807128906
Epoch: 17, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.281 Vali Acc: 0.941 Test Loss: 0.281 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.48179101943969727
Epoch: 18, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.271 Vali Acc: 0.926 Test Loss: 0.271 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5014133453369141
Epoch: 19, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5101296901702881
Epoch: 20, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5410981178283691
Epoch: 21, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5402109622955322
Epoch: 22, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5484061241149902
Epoch: 23, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5312397480010986
Epoch: 24, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5279538631439209
Epoch: 25, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5957460403442383
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 62758
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0348517894744873
Epoch: 1, Steps: 2 | Train Loss: 1.980 Vali Loss: 1.953 Vali Acc: 0.089 Test Loss: 1.953 Test Acc: 0.089
Validation loss decreased (inf --> -0.088869).  Saving model ...
Epoch: 2 cost time: 0.5202755928039551
Epoch: 2, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.869 Vali Acc: 0.144 Test Loss: 1.869 Test Acc: 0.144
Validation loss decreased (-0.088869 --> -0.144426).  Saving model ...
Epoch: 3 cost time: 0.47232985496520996
Epoch: 3, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.799 Vali Acc: 0.219 Test Loss: 1.799 Test Acc: 0.219
Validation loss decreased (-0.144426 --> -0.218501).  Saving model ...
Epoch: 4 cost time: 0.44655847549438477
Epoch: 4, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.717 Vali Acc: 0.322 Test Loss: 1.717 Test Acc: 0.322
Validation loss decreased (-0.218501 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 0.45356082916259766
Epoch: 5, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.617 Vali Acc: 0.430 Test Loss: 1.617 Test Acc: 0.430
Validation loss decreased (-0.322205 --> -0.429613).  Saving model ...
Epoch: 6 cost time: 0.4978961944580078
Epoch: 6, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.508 Vali Acc: 0.463 Test Loss: 1.508 Test Acc: 0.463
Validation loss decreased (-0.429613 --> -0.462948).  Saving model ...
Epoch: 7 cost time: 0.47306203842163086
Epoch: 7, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.392 Vali Acc: 0.567 Test Loss: 1.392 Test Acc: 0.567
Validation loss decreased (-0.462948 --> -0.566653).  Saving model ...
Epoch: 8 cost time: 0.44068431854248047
Epoch: 8, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.276 Vali Acc: 0.626 Test Loss: 1.276 Test Acc: 0.626
Validation loss decreased (-0.566653 --> -0.625913).  Saving model ...
Epoch: 9 cost time: 0.5288002490997314
Epoch: 9, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.163 Vali Acc: 0.681 Test Loss: 1.163 Test Acc: 0.681
Validation loss decreased (-0.625913 --> -0.681470).  Saving model ...
Epoch: 10 cost time: 0.5021369457244873
Epoch: 10, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.054 Vali Acc: 0.693 Test Loss: 1.054 Test Acc: 0.693
Validation loss decreased (-0.681470 --> -0.692582).  Saving model ...
Epoch: 11 cost time: 0.4436066150665283
Epoch: 11, Steps: 2 | Train Loss: 0.921 Vali Loss: 0.952 Vali Acc: 0.744 Test Loss: 0.952 Test Acc: 0.744
Validation loss decreased (-0.692582 --> -0.744435).  Saving model ...
Epoch: 12 cost time: 0.5061900615692139
Epoch: 12, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.861 Vali Acc: 0.770 Test Loss: 0.861 Test Acc: 0.770
Validation loss decreased (-0.744435 --> -0.770362).  Saving model ...
Epoch: 13 cost time: 0.5040457248687744
Epoch: 13, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.781 Vali Acc: 0.793 Test Loss: 0.781 Test Acc: 0.793
Validation loss decreased (-0.770362 --> -0.792585).  Saving model ...
Epoch: 14 cost time: 0.4625570774078369
Epoch: 14, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.709 Vali Acc: 0.826 Test Loss: 0.709 Test Acc: 0.826
Validation loss decreased (-0.792585 --> -0.825919).  Saving model ...
Epoch: 15 cost time: 0.48087120056152344
Epoch: 15, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.647 Vali Acc: 0.826 Test Loss: 0.647 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 16 cost time: 0.4828002452850342
Epoch: 16, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.596 Vali Acc: 0.830 Test Loss: 0.596 Test Acc: 0.830
Validation loss decreased (-0.825919 --> -0.829624).  Saving model ...
Epoch: 17 cost time: 0.48990750312805176
Epoch: 17, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 0.46520161628723145
Epoch: 18, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.510 Vali Acc: 0.848 Test Loss: 0.510 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.848143).  Saving model ...
Epoch: 19 cost time: 0.47840023040771484
Epoch: 19, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
Validation loss decreased (-0.848143 --> -0.866662).  Saving model ...
Epoch: 20 cost time: 0.5044076442718506
Epoch: 20, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.439 Vali Acc: 0.885 Test Loss: 0.439 Test Acc: 0.885
Validation loss decreased (-0.866662 --> -0.885181).  Saving model ...
Epoch: 21 cost time: 0.4915602207183838
Epoch: 21, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.405 Vali Acc: 0.893 Test Loss: 0.405 Test Acc: 0.893
Validation loss decreased (-0.885181 --> -0.892589).  Saving model ...
Epoch: 22 cost time: 0.45465683937072754
Epoch: 22, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
Validation loss decreased (-0.892589 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.5298583507537842
Epoch: 23, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.5780668258666992
Epoch: 24, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907404).  Saving model ...
Epoch: 25 cost time: 0.5124361515045166
Epoch: 25, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.317 Vali Acc: 0.907 Test Loss: 0.317 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 26 cost time: 0.4738781452178955
Epoch: 26, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.302 Vali Acc: 0.911 Test Loss: 0.302 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 27 cost time: 0.5307390689849854
Epoch: 27, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.292 Vali Acc: 0.915 Test Loss: 0.292 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 28 cost time: 0.53377366065979
Epoch: 28, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.281 Vali Acc: 0.915 Test Loss: 0.281 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 29 cost time: 0.4976811408996582
Epoch: 29, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
Validation loss decreased (-0.914812 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.5451540946960449
Epoch: 30, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5470716953277588
Epoch: 31, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 32 cost time: 0.46329522132873535
Epoch: 32, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.476351261138916
Epoch: 33, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.5474474430084229
Epoch: 34, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.440413236618042
Epoch: 35, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.5085141658782959
Epoch: 36, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.581122636795044
Epoch: 37, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5515844821929932
Epoch: 38, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5124475955963135
Epoch: 39, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5443382263183594
Epoch: 40, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.4604918956756592
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5521979331970215
Epoch: 42, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.4378361701965332
Epoch: 43, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5171680450439453
Epoch: 44, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.46495747566223145
Epoch: 45, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 37478
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.137018918991089
Epoch: 1, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.865 Vali Acc: 0.144 Test Loss: 1.865 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.5198347568511963
Epoch: 2, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.803 Vali Acc: 0.200 Test Loss: 1.803 Test Acc: 0.200
Validation loss decreased (-0.144426 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.5145895481109619
Epoch: 3, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.750 Vali Acc: 0.237 Test Loss: 1.750 Test Acc: 0.237
Validation loss decreased (-0.199982 --> -0.237020).  Saving model ...
Epoch: 4 cost time: 0.5599498748779297
Epoch: 4, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.691 Vali Acc: 0.326 Test Loss: 1.691 Test Acc: 0.326
Validation loss decreased (-0.237020 --> -0.325909).  Saving model ...
Epoch: 5 cost time: 0.468278169631958
Epoch: 5, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.617 Vali Acc: 0.444 Test Loss: 1.617 Test Acc: 0.444
Validation loss decreased (-0.325909 --> -0.444428).  Saving model ...
Epoch: 6 cost time: 0.4255712032318115
Epoch: 6, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.533 Vali Acc: 0.530 Test Loss: 1.533 Test Acc: 0.530
Validation loss decreased (-0.444428 --> -0.529614).  Saving model ...
Epoch: 7 cost time: 0.508232831954956
Epoch: 7, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.441 Vali Acc: 0.581 Test Loss: 1.441 Test Acc: 0.581
Validation loss decreased (-0.529614 --> -0.581467).  Saving model ...
Epoch: 8 cost time: 0.5372207164764404
Epoch: 8, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.345 Vali Acc: 0.674 Test Loss: 1.345 Test Acc: 0.674
Validation loss decreased (-0.581467 --> -0.674061).  Saving model ...
Epoch: 9 cost time: 0.43596506118774414
Epoch: 9, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.248 Vali Acc: 0.711 Test Loss: 1.248 Test Acc: 0.711
Validation loss decreased (-0.674061 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 0.4624965190887451
Epoch: 10, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.153 Vali Acc: 0.748 Test Loss: 1.153 Test Acc: 0.748
Validation loss decreased (-0.711099 --> -0.748137).  Saving model ...
Epoch: 11 cost time: 0.5235040187835693
Epoch: 11, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.062 Vali Acc: 0.793 Test Loss: 1.062 Test Acc: 0.793
Validation loss decreased (-0.748137 --> -0.792582).  Saving model ...
Epoch: 12 cost time: 0.4612390995025635
Epoch: 12, Steps: 2 | Train Loss: 0.956 Vali Loss: 0.976 Vali Acc: 0.826 Test Loss: 0.976 Test Acc: 0.826
Validation loss decreased (-0.792582 --> -0.825916).  Saving model ...
Epoch: 13 cost time: 0.5292298793792725
Epoch: 13, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.897 Vali Acc: 0.833 Test Loss: 0.897 Test Acc: 0.833
Validation loss decreased (-0.825916 --> -0.833324).  Saving model ...
Epoch: 14 cost time: 0.49459171295166016
Epoch: 14, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.824 Vali Acc: 0.852 Test Loss: 0.824 Test Acc: 0.852
Validation loss decreased (-0.833324 --> -0.851844).  Saving model ...
Epoch: 15 cost time: 0.4878373146057129
Epoch: 15, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.757 Vali Acc: 0.867 Test Loss: 0.757 Test Acc: 0.867
Validation loss decreased (-0.851844 --> -0.866659).  Saving model ...
Epoch: 16 cost time: 0.6190402507781982
Epoch: 16, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.696 Vali Acc: 0.874 Test Loss: 0.696 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874067).  Saving model ...
Epoch: 17 cost time: 0.5027220249176025
Epoch: 17, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.641 Vali Acc: 0.885 Test Loss: 0.641 Test Acc: 0.885
Validation loss decreased (-0.874067 --> -0.885179).  Saving model ...
Epoch: 18 cost time: 0.578838586807251
Epoch: 18, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.590 Vali Acc: 0.896 Test Loss: 0.590 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896290).  Saving model ...
Epoch: 19 cost time: 0.5521442890167236
Epoch: 19, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.545 Vali Acc: 0.907 Test Loss: 0.545 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907402).  Saving model ...
Epoch: 20 cost time: 0.46221923828125
Epoch: 20, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.503 Vali Acc: 0.915 Test Loss: 0.503 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 21 cost time: 0.4659459590911865
Epoch: 21, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.466 Vali Acc: 0.919 Test Loss: 0.466 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 22 cost time: 0.5121009349822998
Epoch: 22, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.433 Vali Acc: 0.922 Test Loss: 0.433 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 23 cost time: 0.5924291610717773
Epoch: 23, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.404 Vali Acc: 0.922 Test Loss: 0.404 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 24 cost time: 0.4890131950378418
Epoch: 24, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.379 Vali Acc: 0.930 Test Loss: 0.379 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 25 cost time: 0.40699338912963867
Epoch: 25, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.356 Vali Acc: 0.930 Test Loss: 0.356 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 26 cost time: 0.4450204372406006
Epoch: 26, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.337 Vali Acc: 0.922 Test Loss: 0.337 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4069821834564209
Epoch: 27, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 28 cost time: 0.42572927474975586
Epoch: 28, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.306 Vali Acc: 0.930 Test Loss: 0.306 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.49573373794555664
Epoch: 29, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 30 cost time: 0.49581146240234375
Epoch: 30, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.44208455085754395
Epoch: 31, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.5062074661254883
Epoch: 32, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 33 cost time: 0.4823188781738281
Epoch: 33, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.46521711349487305
Epoch: 34, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.525871992111206
Epoch: 35, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.40563130378723145
Epoch: 36, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4672966003417969
Epoch: 37, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 38 cost time: 0.612013578414917
Epoch: 38, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 39 cost time: 0.44730377197265625
Epoch: 39, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4965803623199463
Epoch: 40, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4706120491027832
Epoch: 41, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6001920700073242
Epoch: 42, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.59714674949646
Epoch: 43, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5711719989776611
Epoch: 44, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5370826721191406
Epoch: 45, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.45655298233032227
Epoch: 46, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5132906436920166
Epoch: 47, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5068511962890625
Epoch: 48, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 29830
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9584002494812012
Epoch: 1, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.875 Vali Acc: 0.189 Test Loss: 1.875 Test Acc: 0.189
Validation loss decreased (inf --> -0.188870).  Saving model ...
Epoch: 2 cost time: 0.5196781158447266
Epoch: 2, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.824 Vali Acc: 0.222 Test Loss: 1.824 Test Acc: 0.222
Validation loss decreased (-0.188870 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 0.4438600540161133
Epoch: 3, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.781 Vali Acc: 0.226 Test Loss: 1.781 Test Acc: 0.226
Validation loss decreased (-0.222204 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.49924397468566895
Epoch: 4, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.738 Vali Acc: 0.252 Test Loss: 1.738 Test Acc: 0.252
Validation loss decreased (-0.225908 --> -0.251834).  Saving model ...
Epoch: 5 cost time: 0.43448424339294434
Epoch: 5, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.684 Vali Acc: 0.267 Test Loss: 1.684 Test Acc: 0.267
Validation loss decreased (-0.251834 --> -0.266650).  Saving model ...
Epoch: 6 cost time: 0.43876218795776367
Epoch: 6, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.623 Vali Acc: 0.344 Test Loss: 1.623 Test Acc: 0.344
Validation loss decreased (-0.266650 --> -0.344428).  Saving model ...
Epoch: 7 cost time: 0.42513442039489746
Epoch: 7, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.555 Vali Acc: 0.448 Test Loss: 1.555 Test Acc: 0.448
Validation loss decreased (-0.344428 --> -0.448133).  Saving model ...
Epoch: 8 cost time: 0.510443925857544
Epoch: 8, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.483 Vali Acc: 0.519 Test Loss: 1.483 Test Acc: 0.519
Validation loss decreased (-0.448133 --> -0.518504).  Saving model ...
Epoch: 9 cost time: 0.45746493339538574
Epoch: 9, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.409 Vali Acc: 0.563 Test Loss: 1.409 Test Acc: 0.563
Validation loss decreased (-0.518504 --> -0.562949).  Saving model ...
Epoch: 10 cost time: 0.4958994388580322
Epoch: 10, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.333 Vali Acc: 0.600 Test Loss: 1.333 Test Acc: 0.600
Validation loss decreased (-0.562949 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 0.45993924140930176
Epoch: 11, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.257 Vali Acc: 0.626 Test Loss: 1.257 Test Acc: 0.626
Validation loss decreased (-0.599987 --> -0.625913).  Saving model ...
Epoch: 12 cost time: 0.4413106441497803
Epoch: 12, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.181 Vali Acc: 0.674 Test Loss: 1.181 Test Acc: 0.674
Validation loss decreased (-0.625913 --> -0.674062).  Saving model ...
Epoch: 13 cost time: 0.46593165397644043
Epoch: 13, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.108 Vali Acc: 0.733 Test Loss: 1.108 Test Acc: 0.733
Validation loss decreased (-0.674062 --> -0.733322).  Saving model ...
Epoch: 14 cost time: 0.42523622512817383
Epoch: 14, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.038 Vali Acc: 0.763 Test Loss: 1.038 Test Acc: 0.763
Validation loss decreased (-0.733322 --> -0.762953).  Saving model ...
Epoch: 15 cost time: 0.44190192222595215
Epoch: 15, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.970 Vali Acc: 0.796 Test Loss: 0.970 Test Acc: 0.796
Validation loss decreased (-0.762953 --> -0.796287).  Saving model ...
Epoch: 16 cost time: 0.43909668922424316
Epoch: 16, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.905 Vali Acc: 0.811 Test Loss: 0.905 Test Acc: 0.811
Validation loss decreased (-0.796287 --> -0.811102).  Saving model ...
Epoch: 17 cost time: 0.4794888496398926
Epoch: 17, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.845 Vali Acc: 0.826 Test Loss: 0.845 Test Acc: 0.826
Validation loss decreased (-0.811102 --> -0.825917).  Saving model ...
Epoch: 18 cost time: 0.547823429107666
Epoch: 18, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.789 Vali Acc: 0.837 Test Loss: 0.789 Test Acc: 0.837
Validation loss decreased (-0.825917 --> -0.837029).  Saving model ...
Epoch: 19 cost time: 0.49100637435913086
Epoch: 19, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.735 Vali Acc: 0.848 Test Loss: 0.735 Test Acc: 0.848
Validation loss decreased (-0.837029 --> -0.848141).  Saving model ...
Epoch: 20 cost time: 0.4870603084564209
Epoch: 20, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.686 Vali Acc: 0.859 Test Loss: 0.686 Test Acc: 0.859
Validation loss decreased (-0.848141 --> -0.859252).  Saving model ...
Epoch: 21 cost time: 0.4476182460784912
Epoch: 21, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
Validation loss decreased (-0.859252 --> -0.866660).  Saving model ...
Epoch: 22 cost time: 0.491121768951416
Epoch: 22, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 0.449737548828125
Epoch: 23, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.562 Vali Acc: 0.870 Test Loss: 0.562 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.870365).  Saving model ...
Epoch: 24 cost time: 0.5914971828460693
Epoch: 24, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.527 Vali Acc: 0.870 Test Loss: 0.527 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 25 cost time: 0.45927000045776367
Epoch: 25, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.498 Vali Acc: 0.881 Test Loss: 0.498 Test Acc: 0.881
Validation loss decreased (-0.870365 --> -0.881477).  Saving model ...
Epoch: 26 cost time: 0.3860492706298828
Epoch: 26, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.470 Vali Acc: 0.889 Test Loss: 0.470 Test Acc: 0.889
Validation loss decreased (-0.881477 --> -0.888884).  Saving model ...
Epoch: 27 cost time: 0.5191645622253418
Epoch: 27, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.5147204399108887
Epoch: 28, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.423 Vali Acc: 0.907 Test Loss: 0.423 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907403).  Saving model ...
Epoch: 29 cost time: 0.6768877506256104
Epoch: 29, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.404 Vali Acc: 0.911 Test Loss: 0.404 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 30 cost time: 0.5298514366149902
Epoch: 30, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.388 Vali Acc: 0.911 Test Loss: 0.388 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 31 cost time: 0.4557955265045166
Epoch: 31, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.372 Vali Acc: 0.911 Test Loss: 0.372 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 32 cost time: 0.514672040939331
Epoch: 32, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 33 cost time: 0.4658069610595703
Epoch: 33, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.349 Vali Acc: 0.911 Test Loss: 0.349 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 34 cost time: 0.4723086357116699
Epoch: 34, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.340 Vali Acc: 0.915 Test Loss: 0.340 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914811).  Saving model ...
Epoch: 35 cost time: 0.43506479263305664
Epoch: 35, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.332 Vali Acc: 0.915 Test Loss: 0.332 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 36 cost time: 0.5675568580627441
Epoch: 36, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.324 Vali Acc: 0.915 Test Loss: 0.324 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 37 cost time: 0.5893754959106445
Epoch: 37, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
Validation loss decreased (-0.914812 --> -0.925923).  Saving model ...
Epoch: 38 cost time: 0.5242643356323242
Epoch: 38, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.306 Vali Acc: 0.930 Test Loss: 0.306 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 0.5216951370239258
Epoch: 39, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.5471408367156982
Epoch: 40, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.5662345886230469
Epoch: 41, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 42 cost time: 0.534696102142334
Epoch: 42, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.6067888736724854
Epoch: 43, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5363466739654541
Epoch: 44, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5563457012176514
Epoch: 45, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.281 Vali Acc: 0.922 Test Loss: 0.281 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5465493202209473
Epoch: 46, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.473095178604126
Epoch: 47, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.47060537338256836
Epoch: 48, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5026624202728271
Epoch: 49, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.4496955871582031
Epoch: 50, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.5762317180633545
Epoch: 51, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.5936017036437988
Epoch: 52, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 25286
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.923811912536621
Epoch: 1, Steps: 2 | Train Loss: 1.957 Vali Loss: 1.999 Vali Acc: 0.141 Test Loss: 1.999 Test Acc: 0.141
Validation loss decreased (inf --> -0.140721).  Saving model ...
Epoch: 2 cost time: 0.4881901741027832
Epoch: 2, Steps: 2 | Train Loss: 2.108 Vali Loss: 1.929 Vali Acc: 0.141 Test Loss: 1.929 Test Acc: 0.141
Validation loss decreased (-0.140721 --> -0.140721).  Saving model ...
Epoch: 3 cost time: 0.5769219398498535
Epoch: 3, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.875 Vali Acc: 0.159 Test Loss: 1.875 Test Acc: 0.159
Validation loss decreased (-0.140721 --> -0.159241).  Saving model ...
Epoch: 4 cost time: 0.45145130157470703
Epoch: 4, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.828 Vali Acc: 0.178 Test Loss: 1.828 Test Acc: 0.178
Validation loss decreased (-0.159241 --> -0.177759).  Saving model ...
Epoch: 5 cost time: 0.5203583240509033
Epoch: 5, Steps: 2 | Train Loss: 1.940 Vali Loss: 1.775 Vali Acc: 0.226 Test Loss: 1.775 Test Acc: 0.226
Validation loss decreased (-0.177759 --> -0.225908).  Saving model ...
Epoch: 6 cost time: 0.5299339294433594
Epoch: 6, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.717 Vali Acc: 0.259 Test Loss: 1.717 Test Acc: 0.259
Validation loss decreased (-0.225908 --> -0.259242).  Saving model ...
Epoch: 7 cost time: 0.5212464332580566
Epoch: 7, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.655 Vali Acc: 0.296 Test Loss: 1.655 Test Acc: 0.296
Validation loss decreased (-0.259242 --> -0.296280).  Saving model ...
Epoch: 8 cost time: 0.5242512226104736
Epoch: 8, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.589 Vali Acc: 0.356 Test Loss: 1.589 Test Acc: 0.356
Validation loss decreased (-0.296280 --> -0.355540).  Saving model ...
Epoch: 9 cost time: 0.49722814559936523
Epoch: 9, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.518 Vali Acc: 0.396 Test Loss: 1.518 Test Acc: 0.396
Validation loss decreased (-0.355540 --> -0.396281).  Saving model ...
Epoch: 10 cost time: 0.47741007804870605
Epoch: 10, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.446 Vali Acc: 0.422 Test Loss: 1.446 Test Acc: 0.422
Validation loss decreased (-0.396281 --> -0.422208).  Saving model ...
Epoch: 11 cost time: 0.43247079849243164
Epoch: 11, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.372 Vali Acc: 0.474 Test Loss: 1.372 Test Acc: 0.474
Validation loss decreased (-0.422208 --> -0.474060).  Saving model ...
Epoch: 12 cost time: 0.42064428329467773
Epoch: 12, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.298 Vali Acc: 0.544 Test Loss: 1.298 Test Acc: 0.544
Validation loss decreased (-0.474060 --> -0.544431).  Saving model ...
Epoch: 13 cost time: 0.5072536468505859
Epoch: 13, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.226 Vali Acc: 0.596 Test Loss: 1.226 Test Acc: 0.596
Validation loss decreased (-0.544431 --> -0.596284).  Saving model ...
Epoch: 14 cost time: 0.46889400482177734
Epoch: 14, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.157 Vali Acc: 0.644 Test Loss: 1.157 Test Acc: 0.644
Validation loss decreased (-0.596284 --> -0.644433).  Saving model ...
Epoch: 15 cost time: 0.4368932247161865
Epoch: 15, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.090 Vali Acc: 0.693 Test Loss: 1.090 Test Acc: 0.693
Validation loss decreased (-0.644433 --> -0.692582).  Saving model ...
Epoch: 16 cost time: 0.44689369201660156
Epoch: 16, Steps: 2 | Train Loss: 0.977 Vali Loss: 1.027 Vali Acc: 0.711 Test Loss: 1.027 Test Acc: 0.711
Validation loss decreased (-0.692582 --> -0.711101).  Saving model ...
Epoch: 17 cost time: 0.4171748161315918
Epoch: 17, Steps: 2 | Train Loss: 1.007 Vali Loss: 0.967 Vali Acc: 0.752 Test Loss: 0.967 Test Acc: 0.752
Validation loss decreased (-0.711101 --> -0.751842).  Saving model ...
Epoch: 18 cost time: 0.6002545356750488
Epoch: 18, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.910 Vali Acc: 0.770 Test Loss: 0.910 Test Acc: 0.770
Validation loss decreased (-0.751842 --> -0.770361).  Saving model ...
Epoch: 19 cost time: 0.4685797691345215
Epoch: 19, Steps: 2 | Train Loss: 0.833 Vali Loss: 0.856 Vali Acc: 0.785 Test Loss: 0.856 Test Acc: 0.785
Validation loss decreased (-0.770361 --> -0.785177).  Saving model ...
Epoch: 20 cost time: 0.450634241104126
Epoch: 20, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.805 Vali Acc: 0.804 Test Loss: 0.805 Test Acc: 0.804
Validation loss decreased (-0.785177 --> -0.803696).  Saving model ...
Epoch: 21 cost time: 0.49097609519958496
Epoch: 21, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.757 Vali Acc: 0.830 Test Loss: 0.757 Test Acc: 0.830
Validation loss decreased (-0.803696 --> -0.829622).  Saving model ...
Epoch: 22 cost time: 0.45311832427978516
Epoch: 22, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.711 Vali Acc: 0.856 Test Loss: 0.711 Test Acc: 0.856
Validation loss decreased (-0.829622 --> -0.855548).  Saving model ...
Epoch: 23 cost time: 0.4722461700439453
Epoch: 23, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.668 Vali Acc: 0.859 Test Loss: 0.668 Test Acc: 0.859
Validation loss decreased (-0.855548 --> -0.859253).  Saving model ...
Epoch: 24 cost time: 0.4380643367767334
Epoch: 24, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.628 Vali Acc: 0.863 Test Loss: 0.628 Test Acc: 0.863
Validation loss decreased (-0.859253 --> -0.862957).  Saving model ...
Epoch: 25 cost time: 0.47481346130371094
Epoch: 25, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.589 Vali Acc: 0.870 Test Loss: 0.589 Test Acc: 0.870
Validation loss decreased (-0.862957 --> -0.870364).  Saving model ...
Epoch: 26 cost time: 0.45053887367248535
Epoch: 26, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.554 Vali Acc: 0.874 Test Loss: 0.554 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874069).  Saving model ...
Epoch: 27 cost time: 0.42581629753112793
Epoch: 27, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.521 Vali Acc: 0.881 Test Loss: 0.521 Test Acc: 0.881
Validation loss decreased (-0.874069 --> -0.881476).  Saving model ...
Epoch: 28 cost time: 0.5418727397918701
Epoch: 28, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.491 Vali Acc: 0.885 Test Loss: 0.491 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 29 cost time: 0.4525582790374756
Epoch: 29, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
Validation loss decreased (-0.885180 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.4153556823730469
Epoch: 30, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.438 Vali Acc: 0.911 Test Loss: 0.438 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911107).  Saving model ...
Epoch: 31 cost time: 0.4759664535522461
Epoch: 31, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.415 Vali Acc: 0.919 Test Loss: 0.415 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918514).  Saving model ...
Epoch: 32 cost time: 0.3653988838195801
Epoch: 32, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.394 Vali Acc: 0.919 Test Loss: 0.394 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 33 cost time: 0.4533355236053467
Epoch: 33, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922218).  Saving model ...
Epoch: 34 cost time: 0.48815011978149414
Epoch: 34, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 35 cost time: 0.4981989860534668
Epoch: 35, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.346 Vali Acc: 0.930 Test Loss: 0.346 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929626).  Saving model ...
Epoch: 36 cost time: 0.5123336315155029
Epoch: 36, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.333 Vali Acc: 0.933 Test Loss: 0.333 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 0.5383470058441162
Epoch: 37, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.321 Vali Acc: 0.933 Test Loss: 0.321 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 38 cost time: 0.47397637367248535
Epoch: 38, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.310 Vali Acc: 0.933 Test Loss: 0.310 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 39 cost time: 0.49787163734436035
Epoch: 39, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 0.4204123020172119
Epoch: 40, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.4874706268310547
Epoch: 41, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.284 Vali Acc: 0.937 Test Loss: 0.284 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 0.4766380786895752
Epoch: 42, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 43 cost time: 0.39014506340026855
Epoch: 43, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.270 Vali Acc: 0.941 Test Loss: 0.270 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.4278426170349121
Epoch: 44, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.4216752052307129
Epoch: 45, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.46010780334472656
Epoch: 46, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.5314137935638428
Epoch: 47, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.5479397773742676
Epoch: 48, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5376901626586914
Epoch: 49, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.566375732421875
Epoch: 50, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5003235340118408
Epoch: 51, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.4574596881866455
Epoch: 52, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.42781543731689453
Epoch: 53, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.45101189613342285
Epoch: 54, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.47978639602661133
Epoch: 55, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.5189428329467773
Epoch: 56, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.4784245491027832
Epoch: 57, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 23078
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9714179039001465
Epoch: 1, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.751 Vali Acc: 0.219 Test Loss: 1.751 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.44846415519714355
Epoch: 2, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.707 Vali Acc: 0.233 Test Loss: 1.707 Test Acc: 0.233
Validation loss decreased (-0.218501 --> -0.233316).  Saving model ...
Epoch: 3 cost time: 0.4288508892059326
Epoch: 3, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.674 Vali Acc: 0.233 Test Loss: 1.674 Test Acc: 0.233
Validation loss decreased (-0.233316 --> -0.233317).  Saving model ...
Epoch: 4 cost time: 0.514725923538208
Epoch: 4, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.647 Vali Acc: 0.252 Test Loss: 1.647 Test Acc: 0.252
Validation loss decreased (-0.233317 --> -0.251835).  Saving model ...
Epoch: 5 cost time: 0.506295919418335
Epoch: 5, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.614 Vali Acc: 0.285 Test Loss: 1.614 Test Acc: 0.285
Validation loss decreased (-0.251835 --> -0.285169).  Saving model ...
Epoch: 6 cost time: 0.5143647193908691
Epoch: 6, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.580 Vali Acc: 0.311 Test Loss: 1.580 Test Acc: 0.311
Validation loss decreased (-0.285169 --> -0.311095).  Saving model ...
Epoch: 7 cost time: 0.4720160961151123
Epoch: 7, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.541 Vali Acc: 0.344 Test Loss: 1.541 Test Acc: 0.344
Validation loss decreased (-0.311095 --> -0.344429).  Saving model ...
Epoch: 8 cost time: 0.4499967098236084
Epoch: 8, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.500 Vali Acc: 0.407 Test Loss: 1.500 Test Acc: 0.407
Validation loss decreased (-0.344429 --> -0.407392).  Saving model ...
Epoch: 9 cost time: 0.5931146144866943
Epoch: 9, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.457 Vali Acc: 0.463 Test Loss: 1.457 Test Acc: 0.463
Validation loss decreased (-0.407392 --> -0.462948).  Saving model ...
Epoch: 10 cost time: 0.4432089328765869
Epoch: 10, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.412 Vali Acc: 0.507 Test Loss: 1.412 Test Acc: 0.507
Validation loss decreased (-0.462948 --> -0.507393).  Saving model ...
Epoch: 11 cost time: 0.4694998264312744
Epoch: 11, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.366 Vali Acc: 0.533 Test Loss: 1.366 Test Acc: 0.533
Validation loss decreased (-0.507393 --> -0.533320).  Saving model ...
Epoch: 12 cost time: 0.5087194442749023
Epoch: 12, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.318 Vali Acc: 0.556 Test Loss: 1.318 Test Acc: 0.556
Validation loss decreased (-0.533320 --> -0.555542).  Saving model ...
Epoch: 13 cost time: 0.4569375514984131
Epoch: 13, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.271 Vali Acc: 0.604 Test Loss: 1.271 Test Acc: 0.604
Validation loss decreased (-0.555542 --> -0.603691).  Saving model ...
Epoch: 14 cost time: 0.49176931381225586
Epoch: 14, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.222 Vali Acc: 0.644 Test Loss: 1.222 Test Acc: 0.644
Validation loss decreased (-0.603691 --> -0.644432).  Saving model ...
Epoch: 15 cost time: 0.4832010269165039
Epoch: 15, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.174 Vali Acc: 0.659 Test Loss: 1.174 Test Acc: 0.659
Validation loss decreased (-0.644432 --> -0.659248).  Saving model ...
Epoch: 16 cost time: 0.4943056106567383
Epoch: 16, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.126 Vali Acc: 0.681 Test Loss: 1.126 Test Acc: 0.681
Validation loss decreased (-0.659248 --> -0.681470).  Saving model ...
Epoch: 17 cost time: 0.5136067867279053
Epoch: 17, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.079 Vali Acc: 0.711 Test Loss: 1.079 Test Acc: 0.711
Validation loss decreased (-0.681470 --> -0.711100).  Saving model ...
Epoch: 18 cost time: 0.5612294673919678
Epoch: 18, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.032 Vali Acc: 0.733 Test Loss: 1.032 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733323).  Saving model ...
Epoch: 19 cost time: 0.49451494216918945
Epoch: 19, Steps: 2 | Train Loss: 0.970 Vali Loss: 0.987 Vali Acc: 0.748 Test Loss: 0.987 Test Acc: 0.748
Validation loss decreased (-0.733323 --> -0.748138).  Saving model ...
Epoch: 20 cost time: 0.4728541374206543
Epoch: 20, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.944 Vali Acc: 0.785 Test Loss: 0.944 Test Acc: 0.785
Validation loss decreased (-0.748138 --> -0.785176).  Saving model ...
Epoch: 21 cost time: 0.5064115524291992
Epoch: 21, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.901 Vali Acc: 0.815 Test Loss: 0.901 Test Acc: 0.815
Validation loss decreased (-0.785176 --> -0.814806).  Saving model ...
Epoch: 22 cost time: 0.46896886825561523
Epoch: 22, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.862 Vali Acc: 0.830 Test Loss: 0.862 Test Acc: 0.830
Validation loss decreased (-0.814806 --> -0.829621).  Saving model ...
Epoch: 23 cost time: 0.6218461990356445
Epoch: 23, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.824 Vali Acc: 0.848 Test Loss: 0.824 Test Acc: 0.848
Validation loss decreased (-0.829621 --> -0.848140).  Saving model ...
Epoch: 24 cost time: 0.5840322971343994
Epoch: 24, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.787 Vali Acc: 0.856 Test Loss: 0.787 Test Acc: 0.856
Validation loss decreased (-0.848140 --> -0.855548).  Saving model ...
Epoch: 25 cost time: 0.46874094009399414
Epoch: 25, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.751 Vali Acc: 0.870 Test Loss: 0.751 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870363).  Saving model ...
Epoch: 26 cost time: 0.42304205894470215
Epoch: 26, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.717 Vali Acc: 0.881 Test Loss: 0.717 Test Acc: 0.881
Validation loss decreased (-0.870363 --> -0.881474).  Saving model ...
Epoch: 27 cost time: 0.4906184673309326
Epoch: 27, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.685 Vali Acc: 0.893 Test Loss: 0.685 Test Acc: 0.893
Validation loss decreased (-0.881474 --> -0.892586).  Saving model ...
Epoch: 28 cost time: 0.51019287109375
Epoch: 28, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.655 Vali Acc: 0.896 Test Loss: 0.655 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 29 cost time: 0.5741157531738281
Epoch: 29, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.628 Vali Acc: 0.896 Test Loss: 0.628 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 30 cost time: 0.3946692943572998
Epoch: 30, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.601 Vali Acc: 0.911 Test Loss: 0.601 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911105).  Saving model ...
Epoch: 31 cost time: 0.45154547691345215
Epoch: 31, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.575 Vali Acc: 0.915 Test Loss: 0.575 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 32 cost time: 0.6329784393310547
Epoch: 32, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.552 Vali Acc: 0.915 Test Loss: 0.552 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 33 cost time: 0.5342967510223389
Epoch: 33, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.530 Vali Acc: 0.919 Test Loss: 0.530 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 34 cost time: 0.46532344818115234
Epoch: 34, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.510 Vali Acc: 0.922 Test Loss: 0.510 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 35 cost time: 0.5043845176696777
Epoch: 35, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.492 Vali Acc: 0.911 Test Loss: 0.492 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4728713035583496
Epoch: 36, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.473 Vali Acc: 0.911 Test Loss: 0.473 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4773433208465576
Epoch: 37, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.456 Vali Acc: 0.911 Test Loss: 0.456 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6093640327453613
Epoch: 38, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.438 Vali Acc: 0.915 Test Loss: 0.438 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5792288780212402
Epoch: 39, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.423 Vali Acc: 0.926 Test Loss: 0.423 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925922).  Saving model ...
Epoch: 40 cost time: 0.6244487762451172
Epoch: 40, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.409 Vali Acc: 0.926 Test Loss: 0.409 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 41 cost time: 0.5070812702178955
Epoch: 41, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.395 Vali Acc: 0.930 Test Loss: 0.395 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 42 cost time: 0.5404043197631836
Epoch: 42, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.382 Vali Acc: 0.930 Test Loss: 0.382 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 43 cost time: 0.5074703693389893
Epoch: 43, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.370 Vali Acc: 0.930 Test Loss: 0.370 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 44 cost time: 0.5045149326324463
Epoch: 44, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.359 Vali Acc: 0.930 Test Loss: 0.359 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 45 cost time: 0.4376842975616455
Epoch: 45, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.351 Vali Acc: 0.930 Test Loss: 0.351 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 46 cost time: 0.5029580593109131
Epoch: 46, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 47 cost time: 0.4699101448059082
Epoch: 47, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.335 Vali Acc: 0.930 Test Loss: 0.335 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 48 cost time: 0.5267298221588135
Epoch: 48, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.329 Vali Acc: 0.933 Test Loss: 0.329 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 49 cost time: 0.5018997192382812
Epoch: 49, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.322 Vali Acc: 0.933 Test Loss: 0.322 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 50 cost time: 0.594506025314331
Epoch: 50, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.316 Vali Acc: 0.933 Test Loss: 0.316 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 51 cost time: 0.48207712173461914
Epoch: 51, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.311 Vali Acc: 0.933 Test Loss: 0.311 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 52 cost time: 0.4824850559234619
Epoch: 52, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 53 cost time: 0.4852297306060791
Epoch: 53, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 54 cost time: 0.5284574031829834
Epoch: 54, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.297 Vali Acc: 0.933 Test Loss: 0.297 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 55 cost time: 0.4549124240875244
Epoch: 55, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.293 Vali Acc: 0.937 Test Loss: 0.293 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 56 cost time: 0.4008495807647705
Epoch: 56, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 57 cost time: 0.5188217163085938
Epoch: 57, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.285 Vali Acc: 0.937 Test Loss: 0.285 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 58 cost time: 0.5298745632171631
Epoch: 58, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 59 cost time: 0.45514965057373047
Epoch: 59, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.278 Vali Acc: 0.937 Test Loss: 0.278 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 60 cost time: 0.4071164131164551
Epoch: 60, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 61 cost time: 0.4456655979156494
Epoch: 61, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 62 cost time: 0.50003981590271
Epoch: 62, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 63 cost time: 0.4286162853240967
Epoch: 63, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 64 cost time: 0.4726719856262207
Epoch: 64, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.261 Vali Acc: 0.941 Test Loss: 0.261 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 65 cost time: 0.5058062076568604
Epoch: 65, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 66 cost time: 0.4411742687225342
Epoch: 66, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.4536247253417969
Epoch: 67, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.4868345260620117
Epoch: 68, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.4521369934082031
Epoch: 69, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.45394039154052734
Epoch: 70, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 71 cost time: 0.5166034698486328
Epoch: 71, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.46753478050231934
Epoch: 72, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 73 cost time: 0.497417688369751
Epoch: 73, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 74 cost time: 0.43808913230895996
Epoch: 74, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 75 cost time: 0.44231152534484863
Epoch: 75, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.5249471664428711
Epoch: 76, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.45578956604003906
Epoch: 77, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 78 cost time: 0.4368784427642822
Epoch: 78, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 79 cost time: 0.44455957412719727
Epoch: 79, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 80 cost time: 0.452315092086792
Epoch: 80, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 81 cost time: 0.4491150379180908
Epoch: 81, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 82 cost time: 0.4144480228424072
Epoch: 82, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.5074427127838135
Epoch: 83, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.44625043869018555
Epoch: 84, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.44800233840942383
Epoch: 85, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.5372247695922852
Epoch: 86, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.4812281131744385
Epoch: 87, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.48107457160949707
Epoch: 88, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.5030865669250488
Epoch: 89, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.47847890853881836
Epoch: 90, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.537198543548584
Epoch: 91, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 92 cost time: 0.44661879539489746
Epoch: 92, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 93 cost time: 0.48282384872436523
Epoch: 93, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 94 cost time: 0.49007701873779297
Epoch: 94, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.48622798919677734
Epoch: 95, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.46521925926208496
Epoch: 96, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.42807793617248535
Epoch: 97, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 0.5316240787506104
Epoch: 98, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 0.4071230888366699
Epoch: 99, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 0.5291264057159424
Epoch: 100, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 20102
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.882164478302002
Epoch: 1, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.971 Vali Acc: 0.137 Test Loss: 1.971 Test Acc: 0.137
Validation loss decreased (inf --> -0.137017).  Saving model ...
Epoch: 2 cost time: 0.4896266460418701
Epoch: 2, Steps: 2 | Train Loss: 1.945 Vali Loss: 1.923 Vali Acc: 0.170 Test Loss: 1.923 Test Acc: 0.170
Validation loss decreased (-0.137017 --> -0.170351).  Saving model ...
Epoch: 3 cost time: 0.5030183792114258
Epoch: 3, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.888 Vali Acc: 0.181 Test Loss: 1.888 Test Acc: 0.181
Validation loss decreased (-0.170351 --> -0.181463).  Saving model ...
Epoch: 4 cost time: 0.5144896507263184
Epoch: 4, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.860 Vali Acc: 0.170 Test Loss: 1.860 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4612910747528076
Epoch: 5, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.829 Vali Acc: 0.170 Test Loss: 1.829 Test Acc: 0.170
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4530506134033203
Epoch: 6, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.796 Vali Acc: 0.178 Test Loss: 1.796 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.44423556327819824
Epoch: 7, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.760 Vali Acc: 0.181 Test Loss: 1.760 Test Acc: 0.181
Validation loss decreased (-0.181463 --> -0.181464).  Saving model ...
Epoch: 8 cost time: 0.4156970977783203
Epoch: 8, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.722 Vali Acc: 0.200 Test Loss: 1.722 Test Acc: 0.200
Validation loss decreased (-0.181464 --> -0.199983).  Saving model ...
Epoch: 9 cost time: 0.4195125102996826
Epoch: 9, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.682 Vali Acc: 0.230 Test Loss: 1.682 Test Acc: 0.230
Validation loss decreased (-0.199983 --> -0.229613).  Saving model ...
Epoch: 10 cost time: 0.5074462890625
Epoch: 10, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.639 Vali Acc: 0.270 Test Loss: 1.639 Test Acc: 0.270
Validation loss decreased (-0.229613 --> -0.270354).  Saving model ...
Epoch: 11 cost time: 0.5542571544647217
Epoch: 11, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.595 Vali Acc: 0.319 Test Loss: 1.595 Test Acc: 0.319
Validation loss decreased (-0.270354 --> -0.318503).  Saving model ...
Epoch: 12 cost time: 0.4873080253601074
Epoch: 12, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.549 Vali Acc: 0.363 Test Loss: 1.549 Test Acc: 0.363
Validation loss decreased (-0.318503 --> -0.362947).  Saving model ...
Epoch: 13 cost time: 0.46851205825805664
Epoch: 13, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.502 Vali Acc: 0.411 Test Loss: 1.502 Test Acc: 0.411
Validation loss decreased (-0.362947 --> -0.411096).  Saving model ...
Epoch: 14 cost time: 0.5392155647277832
Epoch: 14, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.453 Vali Acc: 0.507 Test Loss: 1.453 Test Acc: 0.507
Validation loss decreased (-0.411096 --> -0.507393).  Saving model ...
Epoch: 15 cost time: 0.47390151023864746
Epoch: 15, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.404 Vali Acc: 0.548 Test Loss: 1.404 Test Acc: 0.548
Validation loss decreased (-0.507393 --> -0.548134).  Saving model ...
Epoch: 16 cost time: 0.47824811935424805
Epoch: 16, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.354 Vali Acc: 0.619 Test Loss: 1.354 Test Acc: 0.619
Validation loss decreased (-0.548134 --> -0.618505).  Saving model ...
Epoch: 17 cost time: 0.5321478843688965
Epoch: 17, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.305 Vali Acc: 0.674 Test Loss: 1.305 Test Acc: 0.674
Validation loss decreased (-0.618505 --> -0.674061).  Saving model ...
Epoch: 18 cost time: 0.5250506401062012
Epoch: 18, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.256 Vali Acc: 0.704 Test Loss: 1.256 Test Acc: 0.704
Validation loss decreased (-0.674061 --> -0.703691).  Saving model ...
Epoch: 19 cost time: 0.510056734085083
Epoch: 19, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.206 Vali Acc: 0.726 Test Loss: 1.206 Test Acc: 0.726
Validation loss decreased (-0.703691 --> -0.725914).  Saving model ...
Epoch: 20 cost time: 0.5328047275543213
Epoch: 20, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.158 Vali Acc: 0.756 Test Loss: 1.158 Test Acc: 0.756
Validation loss decreased (-0.725914 --> -0.755544).  Saving model ...
Epoch: 21 cost time: 0.4875788688659668
Epoch: 21, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.111 Vali Acc: 0.796 Test Loss: 1.111 Test Acc: 0.796
Validation loss decreased (-0.755544 --> -0.796285).  Saving model ...
Epoch: 22 cost time: 0.46645617485046387
Epoch: 22, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.065 Vali Acc: 0.830 Test Loss: 1.065 Test Acc: 0.830
Validation loss decreased (-0.796285 --> -0.829619).  Saving model ...
Epoch: 23 cost time: 0.4687361717224121
Epoch: 23, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.020 Vali Acc: 0.837 Test Loss: 1.020 Test Acc: 0.837
Validation loss decreased (-0.829619 --> -0.837027).  Saving model ...
Epoch: 24 cost time: 0.4827733039855957
Epoch: 24, Steps: 2 | Train Loss: 1.045 Vali Loss: 0.977 Vali Acc: 0.863 Test Loss: 0.977 Test Acc: 0.863
Validation loss decreased (-0.837027 --> -0.862953).  Saving model ...
Epoch: 25 cost time: 0.5033020973205566
Epoch: 25, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.934 Vali Acc: 0.878 Test Loss: 0.934 Test Acc: 0.878
Validation loss decreased (-0.862953 --> -0.877768).  Saving model ...
Epoch: 26 cost time: 0.5648760795593262
Epoch: 26, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.894 Vali Acc: 0.885 Test Loss: 0.894 Test Acc: 0.885
Validation loss decreased (-0.877768 --> -0.885176).  Saving model ...
Epoch: 27 cost time: 0.6078541278839111
Epoch: 27, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.854 Vali Acc: 0.889 Test Loss: 0.854 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888880).  Saving model ...
Epoch: 28 cost time: 0.49414706230163574
Epoch: 28, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.817 Vali Acc: 0.904 Test Loss: 0.817 Test Acc: 0.904
Validation loss decreased (-0.888880 --> -0.903696).  Saving model ...
Epoch: 29 cost time: 0.5036756992340088
Epoch: 29, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.780 Vali Acc: 0.911 Test Loss: 0.780 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911103).  Saving model ...
Epoch: 30 cost time: 0.5147137641906738
Epoch: 30, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.746 Vali Acc: 0.911 Test Loss: 0.746 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911104).  Saving model ...
Epoch: 31 cost time: 0.5253415107727051
Epoch: 31, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.712 Vali Acc: 0.922 Test Loss: 0.712 Test Acc: 0.922
Validation loss decreased (-0.911104 --> -0.922215).  Saving model ...
Epoch: 32 cost time: 0.49312710762023926
Epoch: 32, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.680 Vali Acc: 0.926 Test Loss: 0.680 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 33 cost time: 0.4955177307128906
Epoch: 33, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.651 Vali Acc: 0.926 Test Loss: 0.651 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925919).  Saving model ...
Epoch: 34 cost time: 0.47218894958496094
Epoch: 34, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.622 Vali Acc: 0.926 Test Loss: 0.622 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925920).  Saving model ...
Epoch: 35 cost time: 0.527850866317749
Epoch: 35, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.595 Vali Acc: 0.926 Test Loss: 0.595 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 36 cost time: 0.5106356143951416
Epoch: 36, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.569 Vali Acc: 0.930 Test Loss: 0.569 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 37 cost time: 0.4939875602722168
Epoch: 37, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.545 Vali Acc: 0.941 Test Loss: 0.545 Test Acc: 0.941
Validation loss decreased (-0.929624 --> -0.940735).  Saving model ...
Epoch: 38 cost time: 0.5175654888153076
Epoch: 38, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.523 Vali Acc: 0.944 Test Loss: 0.523 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 39 cost time: 0.4797377586364746
Epoch: 39, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.504 Vali Acc: 0.944 Test Loss: 0.504 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 40 cost time: 0.49463319778442383
Epoch: 40, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.485 Vali Acc: 0.948 Test Loss: 0.485 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 41 cost time: 0.5006740093231201
Epoch: 41, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.467 Vali Acc: 0.948 Test Loss: 0.467 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 42 cost time: 0.6592695713043213
Epoch: 42, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.450 Vali Acc: 0.956 Test Loss: 0.450 Test Acc: 0.956
Validation loss decreased (-0.948143 --> -0.955551).  Saving model ...
Epoch: 43 cost time: 0.47757411003112793
Epoch: 43, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.435 Vali Acc: 0.952 Test Loss: 0.435 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.533698558807373
Epoch: 44, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.420 Vali Acc: 0.952 Test Loss: 0.420 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5923473834991455
Epoch: 45, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.407 Vali Acc: 0.956 Test Loss: 0.407 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 46 cost time: 0.5080819129943848
Epoch: 46, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.394 Vali Acc: 0.956 Test Loss: 0.394 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955552).  Saving model ...
Epoch: 47 cost time: 0.42731165885925293
Epoch: 47, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.382 Vali Acc: 0.959 Test Loss: 0.382 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959255).  Saving model ...
Epoch: 48 cost time: 0.5315155982971191
Epoch: 48, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.372 Vali Acc: 0.959 Test Loss: 0.372 Test Acc: 0.959
Validation loss decreased (-0.959255 --> -0.959256).  Saving model ...
Epoch: 49 cost time: 0.5011260509490967
Epoch: 49, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.362 Vali Acc: 0.959 Test Loss: 0.362 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 50 cost time: 0.5676965713500977
Epoch: 50, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.353 Vali Acc: 0.959 Test Loss: 0.353 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 51 cost time: 0.540473461151123
Epoch: 51, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.345 Vali Acc: 0.959 Test Loss: 0.345 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 52 cost time: 0.6058518886566162
Epoch: 52, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.337 Vali Acc: 0.959 Test Loss: 0.337 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 53 cost time: 0.6271665096282959
Epoch: 53, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.329 Vali Acc: 0.959 Test Loss: 0.329 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 54 cost time: 0.533855676651001
Epoch: 54, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.322 Vali Acc: 0.959 Test Loss: 0.322 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 55 cost time: 0.5308771133422852
Epoch: 55, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.315 Vali Acc: 0.959 Test Loss: 0.315 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 56 cost time: 0.5395536422729492
Epoch: 56, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.308 Vali Acc: 0.963 Test Loss: 0.308 Test Acc: 0.963
Validation loss decreased (-0.959256 --> -0.962960).  Saving model ...
Epoch: 57 cost time: 0.6041483879089355
Epoch: 57, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.303 Vali Acc: 0.959 Test Loss: 0.303 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.656787633895874
Epoch: 58, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.296 Vali Acc: 0.963 Test Loss: 0.296 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 59 cost time: 0.6590325832366943
Epoch: 59, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.291 Vali Acc: 0.963 Test Loss: 0.291 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 60 cost time: 0.6113042831420898
Epoch: 60, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.286 Vali Acc: 0.963 Test Loss: 0.286 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 61 cost time: 0.6005983352661133
Epoch: 61, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.281 Vali Acc: 0.963 Test Loss: 0.281 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 62 cost time: 0.6172935962677002
Epoch: 62, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.277 Vali Acc: 0.963 Test Loss: 0.277 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 63 cost time: 0.6003670692443848
Epoch: 63, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.273 Vali Acc: 0.963 Test Loss: 0.273 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 64 cost time: 0.6283113956451416
Epoch: 64, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.270 Vali Acc: 0.963 Test Loss: 0.270 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 65 cost time: 0.6439938545227051
Epoch: 65, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.266 Vali Acc: 0.963 Test Loss: 0.266 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 66 cost time: 0.5907776355743408
Epoch: 66, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.263 Vali Acc: 0.963 Test Loss: 0.263 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 67 cost time: 0.5800211429595947
Epoch: 67, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.260 Vali Acc: 0.963 Test Loss: 0.260 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 68 cost time: 0.5885558128356934
Epoch: 68, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.257 Vali Acc: 0.963 Test Loss: 0.257 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 69 cost time: 0.6947336196899414
Epoch: 69, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.254 Vali Acc: 0.963 Test Loss: 0.254 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 70 cost time: 0.6107344627380371
Epoch: 70, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.250 Vali Acc: 0.963 Test Loss: 0.250 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 71 cost time: 0.5963468551635742
Epoch: 71, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.248 Vali Acc: 0.967 Test Loss: 0.248 Test Acc: 0.967
Validation loss decreased (-0.962960 --> -0.966664).  Saving model ...
Epoch: 72 cost time: 0.6164216995239258
Epoch: 72, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.246 Vali Acc: 0.967 Test Loss: 0.246 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 73 cost time: 0.5894925594329834
Epoch: 73, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.243 Vali Acc: 0.967 Test Loss: 0.243 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 74 cost time: 0.6450121402740479
Epoch: 74, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.241 Vali Acc: 0.967 Test Loss: 0.241 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 75 cost time: 0.5858218669891357
Epoch: 75, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.238 Vali Acc: 0.963 Test Loss: 0.238 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.558208703994751
Epoch: 76, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.236 Vali Acc: 0.963 Test Loss: 0.236 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.6051356792449951
Epoch: 77, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.233 Vali Acc: 0.963 Test Loss: 0.233 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.5423810482025146
Epoch: 78, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.231 Vali Acc: 0.963 Test Loss: 0.231 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.5396628379821777
Epoch: 79, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.228 Vali Acc: 0.963 Test Loss: 0.228 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.6122097969055176
Epoch: 80, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.226 Vali Acc: 0.963 Test Loss: 0.226 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.5725357532501221
Epoch: 81, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.225 Vali Acc: 0.963 Test Loss: 0.225 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.6183133125305176
Epoch: 82, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.223 Vali Acc: 0.963 Test Loss: 0.223 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.6716561317443848
Epoch: 83, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.221 Vali Acc: 0.963 Test Loss: 0.221 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.5582444667816162
Epoch: 84, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 18694
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8939290046691895
Epoch: 1, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.685 Vali Acc: 0.315 Test Loss: 1.685 Test Acc: 0.315
Validation loss decreased (inf --> -0.314798).  Saving model ...
Epoch: 2 cost time: 0.542015790939331
Epoch: 2, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.588 Vali Acc: 0.422 Test Loss: 1.588 Test Acc: 0.422
Validation loss decreased (-0.314798 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 0.44324731826782227
Epoch: 3, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.494 Vali Acc: 0.511 Test Loss: 1.494 Test Acc: 0.511
Validation loss decreased (-0.422206 --> -0.511096).  Saving model ...
Epoch: 4 cost time: 0.5871460437774658
Epoch: 4, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.371 Vali Acc: 0.644 Test Loss: 1.371 Test Acc: 0.644
Validation loss decreased (-0.511096 --> -0.644431).  Saving model ...
Epoch: 5 cost time: 0.46634745597839355
Epoch: 5, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.229 Vali Acc: 0.685 Test Loss: 1.229 Test Acc: 0.685
Validation loss decreased (-0.644431 --> -0.685173).  Saving model ...
Epoch: 6 cost time: 0.5664949417114258
Epoch: 6, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.080 Vali Acc: 0.752 Test Loss: 1.080 Test Acc: 0.752
Validation loss decreased (-0.685173 --> -0.751841).  Saving model ...
Epoch: 7 cost time: 0.591191291809082
Epoch: 7, Steps: 2 | Train Loss: 0.970 Vali Loss: 0.943 Vali Acc: 0.770 Test Loss: 0.943 Test Acc: 0.770
Validation loss decreased (-0.751841 --> -0.770361).  Saving model ...
Epoch: 8 cost time: 0.6213650703430176
Epoch: 8, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.813 Vali Acc: 0.819 Test Loss: 0.813 Test Acc: 0.819
Validation loss decreased (-0.770361 --> -0.818510).  Saving model ...
Epoch: 9 cost time: 0.5812544822692871
Epoch: 9, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.701 Vali Acc: 0.856 Test Loss: 0.701 Test Acc: 0.856
Validation loss decreased (-0.818510 --> -0.855549).  Saving model ...
Epoch: 10 cost time: 0.4848783016204834
Epoch: 10, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.605 Vali Acc: 0.893 Test Loss: 0.605 Test Acc: 0.893
Validation loss decreased (-0.855549 --> -0.892587).  Saving model ...
Epoch: 11 cost time: 0.5318613052368164
Epoch: 11, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.525 Vali Acc: 0.911 Test Loss: 0.525 Test Acc: 0.911
Validation loss decreased (-0.892587 --> -0.911106).  Saving model ...
Epoch: 12 cost time: 0.5589413642883301
Epoch: 12, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.457 Vali Acc: 0.926 Test Loss: 0.457 Test Acc: 0.926
Validation loss decreased (-0.911106 --> -0.925921).  Saving model ...
Epoch: 13 cost time: 0.5083973407745361
Epoch: 13, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.400 Vali Acc: 0.959 Test Loss: 0.400 Test Acc: 0.959
Validation loss decreased (-0.925921 --> -0.959255).  Saving model ...
Epoch: 14 cost time: 0.5079658031463623
Epoch: 14, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.355 Vali Acc: 0.952 Test Loss: 0.355 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.56404709815979
Epoch: 15, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.320 Vali Acc: 0.956 Test Loss: 0.320 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4941370487213135
Epoch: 16, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.294 Vali Acc: 0.948 Test Loss: 0.294 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5419285297393799
Epoch: 17, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.271 Vali Acc: 0.948 Test Loss: 0.271 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4564671516418457
Epoch: 18, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.245 Vali Acc: 0.956 Test Loss: 0.245 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.49782252311706543
Epoch: 19, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.229 Vali Acc: 0.952 Test Loss: 0.229 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6514053344726562
Epoch: 20, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5507984161376953
Epoch: 21, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.536858081817627
Epoch: 22, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6257426738739014
Epoch: 23, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 58598
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0007576942443848
Epoch: 1, Steps: 2 | Train Loss: 2.018 Vali Loss: 1.845 Vali Acc: 0.226 Test Loss: 1.845 Test Acc: 0.226
Validation loss decreased (inf --> -0.225907).  Saving model ...
Epoch: 2 cost time: 0.4957749843597412
Epoch: 2, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.786 Vali Acc: 0.256 Test Loss: 1.786 Test Acc: 0.256
Validation loss decreased (-0.225907 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 0.5122878551483154
Epoch: 3, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.731 Vali Acc: 0.289 Test Loss: 1.731 Test Acc: 0.289
Validation loss decreased (-0.255538 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.6404058933258057
Epoch: 4, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.662 Vali Acc: 0.393 Test Loss: 1.662 Test Acc: 0.393
Validation loss decreased (-0.288872 --> -0.392576).  Saving model ...
Epoch: 5 cost time: 0.5641529560089111
Epoch: 5, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.575 Vali Acc: 0.485 Test Loss: 1.575 Test Acc: 0.485
Validation loss decreased (-0.392576 --> -0.485169).  Saving model ...
Epoch: 6 cost time: 0.45656657218933105
Epoch: 6, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.475 Vali Acc: 0.563 Test Loss: 1.475 Test Acc: 0.563
Validation loss decreased (-0.485169 --> -0.562948).  Saving model ...
Epoch: 7 cost time: 0.45881056785583496
Epoch: 7, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.365 Vali Acc: 0.596 Test Loss: 1.365 Test Acc: 0.596
Validation loss decreased (-0.562948 --> -0.596283).  Saving model ...
Epoch: 8 cost time: 0.5734822750091553
Epoch: 8, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.253 Vali Acc: 0.644 Test Loss: 1.253 Test Acc: 0.644
Validation loss decreased (-0.596283 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 0.5683081150054932
Epoch: 9, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.141 Vali Acc: 0.678 Test Loss: 1.141 Test Acc: 0.678
Validation loss decreased (-0.644432 --> -0.677766).  Saving model ...
Epoch: 10 cost time: 0.5703849792480469
Epoch: 10, Steps: 2 | Train Loss: 1.019 Vali Loss: 1.034 Vali Acc: 0.704 Test Loss: 1.034 Test Acc: 0.704
Validation loss decreased (-0.677766 --> -0.703693).  Saving model ...
Epoch: 11 cost time: 0.4804682731628418
Epoch: 11, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.932 Vali Acc: 0.730 Test Loss: 0.932 Test Acc: 0.730
Validation loss decreased (-0.703693 --> -0.729620).  Saving model ...
Epoch: 12 cost time: 0.4618685245513916
Epoch: 12, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.838 Vali Acc: 0.767 Test Loss: 0.838 Test Acc: 0.767
Validation loss decreased (-0.729620 --> -0.766658).  Saving model ...
Epoch: 13 cost time: 0.41521143913269043
Epoch: 13, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.753 Vali Acc: 0.822 Test Loss: 0.753 Test Acc: 0.822
Validation loss decreased (-0.766658 --> -0.822215).  Saving model ...
Epoch: 14 cost time: 0.4293534755706787
Epoch: 14, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.676 Vali Acc: 0.856 Test Loss: 0.676 Test Acc: 0.856
Validation loss decreased (-0.822215 --> -0.855549).  Saving model ...
Epoch: 15 cost time: 0.5541079044342041
Epoch: 15, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.609 Vali Acc: 0.885 Test Loss: 0.609 Test Acc: 0.885
Validation loss decreased (-0.855549 --> -0.885179).  Saving model ...
Epoch: 16 cost time: 0.4305434226989746
Epoch: 16, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.551 Vali Acc: 0.904 Test Loss: 0.551 Test Acc: 0.904
Validation loss decreased (-0.885179 --> -0.903698).  Saving model ...
Epoch: 17 cost time: 0.5896918773651123
Epoch: 17, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.501 Vali Acc: 0.919 Test Loss: 0.501 Test Acc: 0.919
Validation loss decreased (-0.903698 --> -0.918514).  Saving model ...
Epoch: 18 cost time: 0.5916802883148193
Epoch: 18, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.460 Vali Acc: 0.933 Test Loss: 0.460 Test Acc: 0.933
Validation loss decreased (-0.918514 --> -0.933329).  Saving model ...
Epoch: 19 cost time: 0.5355920791625977
Epoch: 19, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.425 Vali Acc: 0.922 Test Loss: 0.425 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.44280529022216797
Epoch: 20, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.395 Vali Acc: 0.930 Test Loss: 0.395 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.45905637741088867
Epoch: 21, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.370 Vali Acc: 0.933 Test Loss: 0.370 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 22 cost time: 0.5464789867401123
Epoch: 22, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5021481513977051
Epoch: 23, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4934048652648926
Epoch: 24, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5094614028930664
Epoch: 25, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.298 Vali Acc: 0.915 Test Loss: 0.298 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.46707606315612793
Epoch: 26, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.287 Vali Acc: 0.919 Test Loss: 0.287 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.45612287521362305
Epoch: 27, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.4897897243499756
Epoch: 28, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.258 Vali Acc: 0.926 Test Loss: 0.258 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5487701892852783
Epoch: 29, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.45586466789245605
Epoch: 30, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5145952701568604
Epoch: 31, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 33318
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1498935222625732
Epoch: 1, Steps: 2 | Train Loss: 1.985 Vali Loss: 1.937 Vali Acc: 0.241 Test Loss: 1.937 Test Acc: 0.241
Validation loss decreased (inf --> -0.240721).  Saving model ...
Epoch: 2 cost time: 0.5407218933105469
Epoch: 2, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.865 Vali Acc: 0.322 Test Loss: 1.865 Test Acc: 0.322
Validation loss decreased (-0.240721 --> -0.322204).  Saving model ...
Epoch: 3 cost time: 0.5377311706542969
Epoch: 3, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.806 Vali Acc: 0.381 Test Loss: 1.806 Test Acc: 0.381
Validation loss decreased (-0.322204 --> -0.381463).  Saving model ...
Epoch: 4 cost time: 0.515815258026123
Epoch: 4, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.745 Vali Acc: 0.441 Test Loss: 1.745 Test Acc: 0.441
Validation loss decreased (-0.381463 --> -0.440723).  Saving model ...
Epoch: 5 cost time: 0.5331401824951172
Epoch: 5, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.671 Vali Acc: 0.481 Test Loss: 1.671 Test Acc: 0.481
Validation loss decreased (-0.440723 --> -0.481465).  Saving model ...
Epoch: 6 cost time: 0.5597317218780518
Epoch: 6, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.587 Vali Acc: 0.496 Test Loss: 1.587 Test Acc: 0.496
Validation loss decreased (-0.481465 --> -0.496280).  Saving model ...
Epoch: 7 cost time: 0.5307958126068115
Epoch: 7, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.495 Vali Acc: 0.530 Test Loss: 1.495 Test Acc: 0.530
Validation loss decreased (-0.496280 --> -0.529615).  Saving model ...
Epoch: 8 cost time: 0.547208309173584
Epoch: 8, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.399 Vali Acc: 0.559 Test Loss: 1.399 Test Acc: 0.559
Validation loss decreased (-0.529615 --> -0.559245).  Saving model ...
Epoch: 9 cost time: 0.5561461448669434
Epoch: 9, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.303 Vali Acc: 0.596 Test Loss: 1.303 Test Acc: 0.596
Validation loss decreased (-0.559245 --> -0.596283).  Saving model ...
Epoch: 10 cost time: 0.5421710014343262
Epoch: 10, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.206 Vali Acc: 0.615 Test Loss: 1.206 Test Acc: 0.615
Validation loss decreased (-0.596283 --> -0.614803).  Saving model ...
Epoch: 11 cost time: 0.4596719741821289
Epoch: 11, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.113 Vali Acc: 0.663 Test Loss: 1.113 Test Acc: 0.663
Validation loss decreased (-0.614803 --> -0.662952).  Saving model ...
Epoch: 12 cost time: 0.4646565914154053
Epoch: 12, Steps: 2 | Train Loss: 0.937 Vali Loss: 1.026 Vali Acc: 0.711 Test Loss: 1.026 Test Acc: 0.711
Validation loss decreased (-0.662952 --> -0.711101).  Saving model ...
Epoch: 13 cost time: 0.5115067958831787
Epoch: 13, Steps: 2 | Train Loss: 0.908 Vali Loss: 0.942 Vali Acc: 0.752 Test Loss: 0.942 Test Acc: 0.752
Validation loss decreased (-0.711101 --> -0.751842).  Saving model ...
Epoch: 14 cost time: 0.4191100597381592
Epoch: 14, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.863 Vali Acc: 0.774 Test Loss: 0.863 Test Acc: 0.774
Validation loss decreased (-0.751842 --> -0.774065).  Saving model ...
Epoch: 15 cost time: 0.540290355682373
Epoch: 15, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.774065 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 0.49007368087768555
Epoch: 16, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.724 Vali Acc: 0.844 Test Loss: 0.724 Test Acc: 0.844
Validation loss decreased (-0.799992 --> -0.844437).  Saving model ...
Epoch: 17 cost time: 0.45630836486816406
Epoch: 17, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.665 Vali Acc: 0.859 Test Loss: 0.665 Test Acc: 0.859
Validation loss decreased (-0.844437 --> -0.859253).  Saving model ...
Epoch: 18 cost time: 0.5487825870513916
Epoch: 18, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.613 Vali Acc: 0.874 Test Loss: 0.613 Test Acc: 0.874
Validation loss decreased (-0.859253 --> -0.874068).  Saving model ...
Epoch: 19 cost time: 0.4443821907043457
Epoch: 19, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.566 Vali Acc: 0.874 Test Loss: 0.566 Test Acc: 0.874
Validation loss decreased (-0.874068 --> -0.874068).  Saving model ...
Epoch: 20 cost time: 0.6170520782470703
Epoch: 20, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.525 Vali Acc: 0.881 Test Loss: 0.525 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 21 cost time: 0.6479246616363525
Epoch: 21, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.488 Vali Acc: 0.893 Test Loss: 0.488 Test Acc: 0.893
Validation loss decreased (-0.881476 --> -0.892588).  Saving model ...
Epoch: 22 cost time: 0.6413922309875488
Epoch: 22, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
Validation loss decreased (-0.892588 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 0.5161056518554688
Epoch: 23, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.422 Vali Acc: 0.907 Test Loss: 0.422 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 24 cost time: 0.48729896545410156
Epoch: 24, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5562458038330078
Epoch: 25, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.373 Vali Acc: 0.893 Test Loss: 0.373 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.49646711349487305
Epoch: 26, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.351 Vali Acc: 0.893 Test Loss: 0.351 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.477078914642334
Epoch: 27, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.48300909996032715
Epoch: 28, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.312 Vali Acc: 0.907 Test Loss: 0.312 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 29 cost time: 0.41338515281677246
Epoch: 29, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.298 Vali Acc: 0.907 Test Loss: 0.298 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 30 cost time: 0.49215054512023926
Epoch: 30, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 31 cost time: 0.543025016784668
Epoch: 31, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 32 cost time: 0.5739150047302246
Epoch: 32, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 33 cost time: 0.4940955638885498
Epoch: 33, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.265 Vali Acc: 0.915 Test Loss: 0.265 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 34 cost time: 0.5241072177886963
Epoch: 34, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.524592399597168
Epoch: 35, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.254 Vali Acc: 0.904 Test Loss: 0.254 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5371506214141846
Epoch: 36, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.248 Vali Acc: 0.907 Test Loss: 0.248 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5012719631195068
Epoch: 37, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 0.5565729141235352
Epoch: 38, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 39 cost time: 0.6005189418792725
Epoch: 39, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.5558595657348633
Epoch: 40, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.5238857269287109
Epoch: 41, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 42 cost time: 0.5482141971588135
Epoch: 42, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.5133411884307861
Epoch: 43, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 44 cost time: 0.45530223846435547
Epoch: 44, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5549464225769043
Epoch: 45, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.49505114555358887
Epoch: 46, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5213055610656738
Epoch: 47, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5360405445098877
Epoch: 48, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.219 Vali Acc: 0.919 Test Loss: 0.219 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4622032642364502
Epoch: 49, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.919 Test Loss: 0.219 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5599064826965332
Epoch: 50, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.915 Test Loss: 0.216 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5201289653778076
Epoch: 51, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.919 Test Loss: 0.214 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.46403932571411133
Epoch: 52, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.212 Vali Acc: 0.919 Test Loss: 0.212 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5057790279388428
Epoch: 53, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.919 Test Loss: 0.209 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 25670
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1087214946746826
Epoch: 1, Steps: 2 | Train Loss: 2.027 Vali Loss: 1.904 Vali Acc: 0.100 Test Loss: 1.904 Test Acc: 0.100
Validation loss decreased (inf --> -0.099981).  Saving model ...
Epoch: 2 cost time: 0.4416041374206543
Epoch: 2, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.853 Vali Acc: 0.115 Test Loss: 1.853 Test Acc: 0.115
Validation loss decreased (-0.099981 --> -0.114796).  Saving model ...
Epoch: 3 cost time: 0.516610860824585
Epoch: 3, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.812 Vali Acc: 0.159 Test Loss: 1.812 Test Acc: 0.159
Validation loss decreased (-0.114796 --> -0.159241).  Saving model ...
Epoch: 4 cost time: 0.5277001857757568
Epoch: 4, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.769 Vali Acc: 0.189 Test Loss: 1.769 Test Acc: 0.189
Validation loss decreased (-0.159241 --> -0.188871).  Saving model ...
Epoch: 5 cost time: 0.45116519927978516
Epoch: 5, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.716 Vali Acc: 0.259 Test Loss: 1.716 Test Acc: 0.259
Validation loss decreased (-0.188871 --> -0.259242).  Saving model ...
Epoch: 6 cost time: 0.373248815536499
Epoch: 6, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.654 Vali Acc: 0.322 Test Loss: 1.654 Test Acc: 0.322
Validation loss decreased (-0.259242 --> -0.322206).  Saving model ...
Epoch: 7 cost time: 0.3971371650695801
Epoch: 7, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.584 Vali Acc: 0.393 Test Loss: 1.584 Test Acc: 0.393
Validation loss decreased (-0.322206 --> -0.392577).  Saving model ...
Epoch: 8 cost time: 0.42456984519958496
Epoch: 8, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.510 Vali Acc: 0.456 Test Loss: 1.510 Test Acc: 0.456
Validation loss decreased (-0.392577 --> -0.455540).  Saving model ...
Epoch: 9 cost time: 0.42891764640808105
Epoch: 9, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.433 Vali Acc: 0.526 Test Loss: 1.433 Test Acc: 0.526
Validation loss decreased (-0.455540 --> -0.525912).  Saving model ...
Epoch: 10 cost time: 0.42327237129211426
Epoch: 10, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.354 Vali Acc: 0.589 Test Loss: 1.354 Test Acc: 0.589
Validation loss decreased (-0.525912 --> -0.588875).  Saving model ...
Epoch: 11 cost time: 0.4393923282623291
Epoch: 11, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.276 Vali Acc: 0.637 Test Loss: 1.276 Test Acc: 0.637
Validation loss decreased (-0.588875 --> -0.637024).  Saving model ...
Epoch: 12 cost time: 0.37927794456481934
Epoch: 12, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.198 Vali Acc: 0.674 Test Loss: 1.198 Test Acc: 0.674
Validation loss decreased (-0.637024 --> -0.674062).  Saving model ...
Epoch: 13 cost time: 0.3800816535949707
Epoch: 13, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.121 Vali Acc: 0.719 Test Loss: 1.121 Test Acc: 0.719
Validation loss decreased (-0.674062 --> -0.718507).  Saving model ...
Epoch: 14 cost time: 0.5248935222625732
Epoch: 14, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.047 Vali Acc: 0.748 Test Loss: 1.047 Test Acc: 0.748
Validation loss decreased (-0.718507 --> -0.748138).  Saving model ...
Epoch: 15 cost time: 0.4656245708465576
Epoch: 15, Steps: 2 | Train Loss: 0.986 Vali Loss: 0.977 Vali Acc: 0.785 Test Loss: 0.977 Test Acc: 0.785
Validation loss decreased (-0.748138 --> -0.785175).  Saving model ...
Epoch: 16 cost time: 0.40556764602661133
Epoch: 16, Steps: 2 | Train Loss: 0.910 Vali Loss: 0.910 Vali Acc: 0.800 Test Loss: 0.910 Test Acc: 0.800
Validation loss decreased (-0.785175 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 0.3929727077484131
Epoch: 17, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.848 Vali Acc: 0.819 Test Loss: 0.848 Test Acc: 0.819
Validation loss decreased (-0.799991 --> -0.818510).  Saving model ...
Epoch: 18 cost time: 0.43039846420288086
Epoch: 18, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.790 Vali Acc: 0.844 Test Loss: 0.790 Test Acc: 0.844
Validation loss decreased (-0.818510 --> -0.844437).  Saving model ...
Epoch: 19 cost time: 0.5587654113769531
Epoch: 19, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.735 Vali Acc: 0.856 Test Loss: 0.735 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855548).  Saving model ...
Epoch: 20 cost time: 0.40792250633239746
Epoch: 20, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.685 Vali Acc: 0.859 Test Loss: 0.685 Test Acc: 0.859
Validation loss decreased (-0.855548 --> -0.859252).  Saving model ...
Epoch: 21 cost time: 0.406461238861084
Epoch: 21, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.638 Vali Acc: 0.874 Test Loss: 0.638 Test Acc: 0.874
Validation loss decreased (-0.859252 --> -0.874068).  Saving model ...
Epoch: 22 cost time: 0.3832736015319824
Epoch: 22, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.595 Vali Acc: 0.896 Test Loss: 0.595 Test Acc: 0.896
Validation loss decreased (-0.874068 --> -0.896290).  Saving model ...
Epoch: 23 cost time: 0.3857419490814209
Epoch: 23, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.556 Vali Acc: 0.896 Test Loss: 0.556 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896291).  Saving model ...
Epoch: 24 cost time: 0.396636962890625
Epoch: 24, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.520 Vali Acc: 0.911 Test Loss: 0.520 Test Acc: 0.911
Validation loss decreased (-0.896291 --> -0.911106).  Saving model ...
Epoch: 25 cost time: 0.47481369972229004
Epoch: 25, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.487 Vali Acc: 0.911 Test Loss: 0.487 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 26 cost time: 0.4100167751312256
Epoch: 26, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.458 Vali Acc: 0.911 Test Loss: 0.458 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 27 cost time: 0.40221261978149414
Epoch: 27, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.431 Vali Acc: 0.911 Test Loss: 0.431 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 28 cost time: 0.4207324981689453
Epoch: 28, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.407 Vali Acc: 0.919 Test Loss: 0.407 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918514).  Saving model ...
Epoch: 29 cost time: 0.3793773651123047
Epoch: 29, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.386 Vali Acc: 0.919 Test Loss: 0.386 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 30 cost time: 0.5498044490814209
Epoch: 30, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.367 Vali Acc: 0.922 Test Loss: 0.367 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 31 cost time: 0.44916439056396484
Epoch: 31, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.348 Vali Acc: 0.919 Test Loss: 0.348 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4287912845611572
Epoch: 32, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.330 Vali Acc: 0.937 Test Loss: 0.330 Test Acc: 0.937
Validation loss decreased (-0.922219 --> -0.937034).  Saving model ...
Epoch: 33 cost time: 0.40338850021362305
Epoch: 33, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.316 Vali Acc: 0.941 Test Loss: 0.316 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 34 cost time: 0.4237244129180908
Epoch: 34, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.4311869144439697
Epoch: 35, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.292 Vali Acc: 0.941 Test Loss: 0.292 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.4630892276763916
Epoch: 36, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.282 Vali Acc: 0.941 Test Loss: 0.282 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.43264293670654297
Epoch: 37, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.4187507629394531
Epoch: 38, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.4270906448364258
Epoch: 39, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.4545097351074219
Epoch: 40, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.3684515953063965
Epoch: 41, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.38773036003112793
Epoch: 42, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.46712183952331543
Epoch: 43, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4299037456512451
Epoch: 44, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.4623990058898926
Epoch: 45, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.44769859313964844
Epoch: 46, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.4469914436340332
Epoch: 47, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.42081379890441895
Epoch: 48, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.4759533405303955
Epoch: 49, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 21126
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1656181812286377
Epoch: 1, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.813 Vali Acc: 0.219 Test Loss: 1.813 Test Acc: 0.219
Validation loss decreased (inf --> -0.218500).  Saving model ...
Epoch: 2 cost time: 0.5475277900695801
Epoch: 2, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.749 Vali Acc: 0.285 Test Loss: 1.749 Test Acc: 0.285
Validation loss decreased (-0.218500 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.4781959056854248
Epoch: 3, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.700 Vali Acc: 0.319 Test Loss: 1.700 Test Acc: 0.319
Validation loss decreased (-0.285168 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.49966931343078613
Epoch: 4, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.657 Vali Acc: 0.363 Test Loss: 1.657 Test Acc: 0.363
Validation loss decreased (-0.318502 --> -0.362946).  Saving model ...
Epoch: 5 cost time: 0.49443936347961426
Epoch: 5, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.610 Vali Acc: 0.400 Test Loss: 1.610 Test Acc: 0.400
Validation loss decreased (-0.362946 --> -0.399984).  Saving model ...
Epoch: 6 cost time: 0.5536494255065918
Epoch: 6, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.559 Vali Acc: 0.456 Test Loss: 1.559 Test Acc: 0.456
Validation loss decreased (-0.399984 --> -0.455540).  Saving model ...
Epoch: 7 cost time: 0.513007402420044
Epoch: 7, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.505 Vali Acc: 0.493 Test Loss: 1.505 Test Acc: 0.493
Validation loss decreased (-0.455540 --> -0.492578).  Saving model ...
Epoch: 8 cost time: 0.5557894706726074
Epoch: 8, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.447 Vali Acc: 0.544 Test Loss: 1.447 Test Acc: 0.544
Validation loss decreased (-0.492578 --> -0.544430).  Saving model ...
Epoch: 9 cost time: 0.4844355583190918
Epoch: 9, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.387 Vali Acc: 0.574 Test Loss: 1.387 Test Acc: 0.574
Validation loss decreased (-0.544430 --> -0.574060).  Saving model ...
Epoch: 10 cost time: 0.6434834003448486
Epoch: 10, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.324 Vali Acc: 0.604 Test Loss: 1.324 Test Acc: 0.604
Validation loss decreased (-0.574060 --> -0.603690).  Saving model ...
Epoch: 11 cost time: 0.46324920654296875
Epoch: 11, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.260 Vali Acc: 0.659 Test Loss: 1.260 Test Acc: 0.659
Validation loss decreased (-0.603690 --> -0.659247).  Saving model ...
Epoch: 12 cost time: 0.4763524532318115
Epoch: 12, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.195 Vali Acc: 0.711 Test Loss: 1.195 Test Acc: 0.711
Validation loss decreased (-0.659247 --> -0.711099).  Saving model ...
Epoch: 13 cost time: 0.4621763229370117
Epoch: 13, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.131 Vali Acc: 0.730 Test Loss: 1.131 Test Acc: 0.730
Validation loss decreased (-0.711099 --> -0.729618).  Saving model ...
Epoch: 14 cost time: 0.5024559497833252
Epoch: 14, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.069 Vali Acc: 0.770 Test Loss: 1.069 Test Acc: 0.770
Validation loss decreased (-0.729618 --> -0.770360).  Saving model ...
Epoch: 15 cost time: 0.4850592613220215
Epoch: 15, Steps: 2 | Train Loss: 0.957 Vali Loss: 1.007 Vali Acc: 0.796 Test Loss: 1.007 Test Acc: 0.796
Validation loss decreased (-0.770360 --> -0.796286).  Saving model ...
Epoch: 16 cost time: 0.5085859298706055
Epoch: 16, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.948 Vali Acc: 0.811 Test Loss: 0.948 Test Acc: 0.811
Validation loss decreased (-0.796286 --> -0.811102).  Saving model ...
Epoch: 17 cost time: 0.5109539031982422
Epoch: 17, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.890 Vali Acc: 0.830 Test Loss: 0.890 Test Acc: 0.830
Validation loss decreased (-0.811102 --> -0.829621).  Saving model ...
Epoch: 18 cost time: 0.4358649253845215
Epoch: 18, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.837 Vali Acc: 0.841 Test Loss: 0.837 Test Acc: 0.841
Validation loss decreased (-0.829621 --> -0.840732).  Saving model ...
Epoch: 19 cost time: 0.5484633445739746
Epoch: 19, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.787 Vali Acc: 0.856 Test Loss: 0.787 Test Acc: 0.856
Validation loss decreased (-0.840732 --> -0.855548).  Saving model ...
Epoch: 20 cost time: 0.49971866607666016
Epoch: 20, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.739 Vali Acc: 0.867 Test Loss: 0.739 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866659).  Saving model ...
Epoch: 21 cost time: 0.5297446250915527
Epoch: 21, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.694 Vali Acc: 0.881 Test Loss: 0.694 Test Acc: 0.881
Validation loss decreased (-0.866659 --> -0.881475).  Saving model ...
Epoch: 22 cost time: 0.6174502372741699
Epoch: 22, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.652 Vali Acc: 0.896 Test Loss: 0.652 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896290).  Saving model ...
Epoch: 23 cost time: 0.46619319915771484
Epoch: 23, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.614 Vali Acc: 0.896 Test Loss: 0.614 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 24 cost time: 0.5677139759063721
Epoch: 24, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.577 Vali Acc: 0.904 Test Loss: 0.577 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 25 cost time: 0.526254415512085
Epoch: 25, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.544 Vali Acc: 0.904 Test Loss: 0.544 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 26 cost time: 0.5375354290008545
Epoch: 26, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.514 Vali Acc: 0.911 Test Loss: 0.514 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 27 cost time: 0.5767076015472412
Epoch: 27, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.486 Vali Acc: 0.915 Test Loss: 0.486 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 28 cost time: 0.6158215999603271
Epoch: 28, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.460 Vali Acc: 0.922 Test Loss: 0.460 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 29 cost time: 0.575411319732666
Epoch: 29, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.437 Vali Acc: 0.930 Test Loss: 0.437 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929625).  Saving model ...
Epoch: 30 cost time: 0.4859488010406494
Epoch: 30, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.415 Vali Acc: 0.933 Test Loss: 0.415 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 31 cost time: 0.5425548553466797
Epoch: 31, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.395 Vali Acc: 0.933 Test Loss: 0.395 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 32 cost time: 0.529754638671875
Epoch: 32, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.378 Vali Acc: 0.933 Test Loss: 0.378 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 33 cost time: 0.5173130035400391
Epoch: 33, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.363 Vali Acc: 0.933 Test Loss: 0.363 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 34 cost time: 0.5122542381286621
Epoch: 34, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.349 Vali Acc: 0.926 Test Loss: 0.349 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.49314165115356445
Epoch: 35, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.337 Vali Acc: 0.926 Test Loss: 0.337 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.496535062789917
Epoch: 36, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5538256168365479
Epoch: 37, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.316 Vali Acc: 0.926 Test Loss: 0.316 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5507347583770752
Epoch: 38, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.307 Vali Acc: 0.926 Test Loss: 0.307 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.46752119064331055
Epoch: 39, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.299 Vali Acc: 0.926 Test Loss: 0.299 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5528337955474854
Epoch: 40, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.292 Vali Acc: 0.926 Test Loss: 0.292 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5596740245819092
Epoch: 41, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.4962728023529053
Epoch: 42, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.549522876739502
Epoch: 43, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.275 Vali Acc: 0.926 Test Loss: 0.275 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 18918
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9079325199127197
Epoch: 1, Steps: 2 | Train Loss: 2.101 Vali Loss: 1.910 Vali Acc: 0.093 Test Loss: 1.910 Test Acc: 0.093
Validation loss decreased (inf --> -0.092573).  Saving model ...
Epoch: 2 cost time: 0.48661231994628906
Epoch: 2, Steps: 2 | Train Loss: 2.130 Vali Loss: 1.879 Vali Acc: 0.104 Test Loss: 1.879 Test Acc: 0.104
Validation loss decreased (-0.092573 --> -0.103685).  Saving model ...
Epoch: 3 cost time: 0.44046473503112793
Epoch: 3, Steps: 2 | Train Loss: 1.930 Vali Loss: 1.858 Vali Acc: 0.115 Test Loss: 1.858 Test Acc: 0.115
Validation loss decreased (-0.103685 --> -0.114796).  Saving model ...
Epoch: 4 cost time: 0.44553375244140625
Epoch: 4, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.840 Vali Acc: 0.126 Test Loss: 1.840 Test Acc: 0.126
Validation loss decreased (-0.114796 --> -0.125908).  Saving model ...
Epoch: 5 cost time: 0.4570631980895996
Epoch: 5, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.815 Vali Acc: 0.144 Test Loss: 1.815 Test Acc: 0.144
Validation loss decreased (-0.125908 --> -0.144426).  Saving model ...
Epoch: 6 cost time: 0.5261614322662354
Epoch: 6, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.786 Vali Acc: 0.163 Test Loss: 1.786 Test Acc: 0.163
Validation loss decreased (-0.144426 --> -0.162945).  Saving model ...
Epoch: 7 cost time: 0.5813407897949219
Epoch: 7, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.750 Vali Acc: 0.196 Test Loss: 1.750 Test Acc: 0.196
Validation loss decreased (-0.162945 --> -0.196279).  Saving model ...
Epoch: 8 cost time: 0.48618650436401367
Epoch: 8, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.711 Vali Acc: 0.233 Test Loss: 1.711 Test Acc: 0.233
Validation loss decreased (-0.196279 --> -0.233316).  Saving model ...
Epoch: 9 cost time: 0.4399900436401367
Epoch: 9, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.668 Vali Acc: 0.267 Test Loss: 1.668 Test Acc: 0.267
Validation loss decreased (-0.233316 --> -0.266650).  Saving model ...
Epoch: 10 cost time: 0.5252766609191895
Epoch: 10, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.623 Vali Acc: 0.322 Test Loss: 1.623 Test Acc: 0.322
Validation loss decreased (-0.266650 --> -0.322206).  Saving model ...
Epoch: 11 cost time: 0.5503520965576172
Epoch: 11, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.574 Vali Acc: 0.374 Test Loss: 1.574 Test Acc: 0.374
Validation loss decreased (-0.322206 --> -0.374058).  Saving model ...
Epoch: 12 cost time: 0.5020859241485596
Epoch: 12, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.523 Vali Acc: 0.437 Test Loss: 1.523 Test Acc: 0.437
Validation loss decreased (-0.374058 --> -0.437022).  Saving model ...
Epoch: 13 cost time: 0.5788817405700684
Epoch: 13, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.471 Vali Acc: 0.489 Test Loss: 1.471 Test Acc: 0.489
Validation loss decreased (-0.437022 --> -0.488874).  Saving model ...
Epoch: 14 cost time: 0.47010135650634766
Epoch: 14, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.418 Vali Acc: 0.559 Test Loss: 1.418 Test Acc: 0.559
Validation loss decreased (-0.488874 --> -0.559245).  Saving model ...
Epoch: 15 cost time: 0.4780409336090088
Epoch: 15, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.364 Vali Acc: 0.619 Test Loss: 1.364 Test Acc: 0.619
Validation loss decreased (-0.559245 --> -0.618505).  Saving model ...
Epoch: 16 cost time: 0.5029819011688232
Epoch: 16, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.312 Vali Acc: 0.659 Test Loss: 1.312 Test Acc: 0.659
Validation loss decreased (-0.618505 --> -0.659246).  Saving model ...
Epoch: 17 cost time: 0.42438673973083496
Epoch: 17, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.259 Vali Acc: 0.674 Test Loss: 1.259 Test Acc: 0.674
Validation loss decreased (-0.659246 --> -0.674061).  Saving model ...
Epoch: 18 cost time: 0.3752865791320801
Epoch: 18, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.207 Vali Acc: 0.704 Test Loss: 1.207 Test Acc: 0.704
Validation loss decreased (-0.674061 --> -0.703692).  Saving model ...
Epoch: 19 cost time: 0.46265387535095215
Epoch: 19, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.155 Vali Acc: 0.711 Test Loss: 1.155 Test Acc: 0.711
Validation loss decreased (-0.703692 --> -0.711100).  Saving model ...
Epoch: 20 cost time: 0.44633007049560547
Epoch: 20, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.105 Vali Acc: 0.722 Test Loss: 1.105 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722211).  Saving model ...
Epoch: 21 cost time: 0.5502846240997314
Epoch: 21, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.056 Vali Acc: 0.737 Test Loss: 1.056 Test Acc: 0.737
Validation loss decreased (-0.722211 --> -0.737026).  Saving model ...
Epoch: 22 cost time: 0.5362365245819092
Epoch: 22, Steps: 2 | Train Loss: 0.945 Vali Loss: 1.008 Vali Acc: 0.744 Test Loss: 1.008 Test Acc: 0.744
Validation loss decreased (-0.737026 --> -0.744434).  Saving model ...
Epoch: 23 cost time: 0.6241135597229004
Epoch: 23, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.962 Vali Acc: 0.759 Test Loss: 0.962 Test Acc: 0.759
Validation loss decreased (-0.744434 --> -0.759250).  Saving model ...
Epoch: 24 cost time: 0.5035858154296875
Epoch: 24, Steps: 2 | Train Loss: 0.899 Vali Loss: 0.918 Vali Acc: 0.774 Test Loss: 0.918 Test Acc: 0.774
Validation loss decreased (-0.759250 --> -0.774065).  Saving model ...
Epoch: 25 cost time: 0.5670108795166016
Epoch: 25, Steps: 2 | Train Loss: 0.806 Vali Loss: 0.876 Vali Acc: 0.789 Test Loss: 0.876 Test Acc: 0.789
Validation loss decreased (-0.774065 --> -0.788880).  Saving model ...
Epoch: 26 cost time: 0.5209741592407227
Epoch: 26, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.836 Vali Acc: 0.807 Test Loss: 0.836 Test Acc: 0.807
Validation loss decreased (-0.788880 --> -0.807399).  Saving model ...
Epoch: 27 cost time: 0.43517398834228516
Epoch: 27, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.799 Vali Acc: 0.819 Test Loss: 0.799 Test Acc: 0.819
Validation loss decreased (-0.807399 --> -0.818511).  Saving model ...
Epoch: 28 cost time: 0.47110891342163086
Epoch: 28, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.765 Vali Acc: 0.826 Test Loss: 0.765 Test Acc: 0.826
Validation loss decreased (-0.818511 --> -0.825918).  Saving model ...
Epoch: 29 cost time: 0.49030041694641113
Epoch: 29, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.731 Vali Acc: 0.841 Test Loss: 0.731 Test Acc: 0.841
Validation loss decreased (-0.825918 --> -0.840733).  Saving model ...
Epoch: 30 cost time: 0.49112486839294434
Epoch: 30, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.699 Vali Acc: 0.844 Test Loss: 0.699 Test Acc: 0.844
Validation loss decreased (-0.840733 --> -0.844437).  Saving model ...
Epoch: 31 cost time: 0.5200974941253662
Epoch: 31, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.667 Vali Acc: 0.848 Test Loss: 0.667 Test Acc: 0.848
Validation loss decreased (-0.844437 --> -0.848141).  Saving model ...
Epoch: 32 cost time: 0.46980977058410645
Epoch: 32, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.637 Vali Acc: 0.863 Test Loss: 0.637 Test Acc: 0.863
Validation loss decreased (-0.848141 --> -0.862957).  Saving model ...
Epoch: 33 cost time: 0.5084269046783447
Epoch: 33, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.610 Vali Acc: 0.881 Test Loss: 0.610 Test Acc: 0.881
Validation loss decreased (-0.862957 --> -0.881475).  Saving model ...
Epoch: 34 cost time: 0.6166067123413086
Epoch: 34, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.583 Vali Acc: 0.885 Test Loss: 0.583 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 35 cost time: 0.506690263748169
Epoch: 35, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.559 Vali Acc: 0.904 Test Loss: 0.559 Test Acc: 0.904
Validation loss decreased (-0.885179 --> -0.903698).  Saving model ...
Epoch: 36 cost time: 0.5416250228881836
Epoch: 36, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.536 Vali Acc: 0.907 Test Loss: 0.536 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 37 cost time: 0.48888230323791504
Epoch: 37, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.515 Vali Acc: 0.907 Test Loss: 0.515 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 38 cost time: 0.5076308250427246
Epoch: 38, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.494 Vali Acc: 0.907 Test Loss: 0.494 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 39 cost time: 0.5155479907989502
Epoch: 39, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.475 Vali Acc: 0.911 Test Loss: 0.475 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 40 cost time: 0.5247600078582764
Epoch: 40, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.457 Vali Acc: 0.919 Test Loss: 0.457 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 41 cost time: 0.4897780418395996
Epoch: 41, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.441 Vali Acc: 0.919 Test Loss: 0.441 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 42 cost time: 0.49055957794189453
Epoch: 42, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.425 Vali Acc: 0.919 Test Loss: 0.425 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 43 cost time: 0.5133004188537598
Epoch: 43, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.411 Vali Acc: 0.922 Test Loss: 0.411 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 44 cost time: 0.42714619636535645
Epoch: 44, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.398 Vali Acc: 0.926 Test Loss: 0.398 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 45 cost time: 0.46600794792175293
Epoch: 45, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.386 Vali Acc: 0.930 Test Loss: 0.386 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 46 cost time: 0.4755074977874756
Epoch: 46, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.375 Vali Acc: 0.930 Test Loss: 0.375 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 47 cost time: 0.5326187610626221
Epoch: 47, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.365 Vali Acc: 0.930 Test Loss: 0.365 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 48 cost time: 0.4145069122314453
Epoch: 48, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.356 Vali Acc: 0.930 Test Loss: 0.356 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 49 cost time: 0.448986291885376
Epoch: 49, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.348 Vali Acc: 0.930 Test Loss: 0.348 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 50 cost time: 0.44703149795532227
Epoch: 50, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.341 Vali Acc: 0.930 Test Loss: 0.341 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 51 cost time: 0.5038175582885742
Epoch: 51, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.334 Vali Acc: 0.930 Test Loss: 0.334 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 52 cost time: 0.5006558895111084
Epoch: 52, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.328 Vali Acc: 0.930 Test Loss: 0.328 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 53 cost time: 0.3914811611175537
Epoch: 53, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 54 cost time: 0.3872990608215332
Epoch: 54, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 55 cost time: 0.44701433181762695
Epoch: 55, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.315 Vali Acc: 0.930 Test Loss: 0.315 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 56 cost time: 0.4666898250579834
Epoch: 56, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.312 Vali Acc: 0.922 Test Loss: 0.312 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.48471570014953613
Epoch: 57, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.308 Vali Acc: 0.926 Test Loss: 0.308 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5557239055633545
Epoch: 58, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.47231507301330566
Epoch: 59, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.301 Vali Acc: 0.926 Test Loss: 0.301 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.49433231353759766
Epoch: 60, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.5123546123504639
Epoch: 61, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.5021538734436035
Epoch: 62, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.290 Vali Acc: 0.926 Test Loss: 0.290 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.47202372550964355
Epoch: 63, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.5129668712615967
Epoch: 64, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 65 cost time: 0.4406166076660156
Epoch: 65, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.280 Vali Acc: 0.933 Test Loss: 0.280 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 66 cost time: 0.5425620079040527
Epoch: 66, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 67 cost time: 0.48482823371887207
Epoch: 67, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 68 cost time: 0.4877591133117676
Epoch: 68, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 69 cost time: 0.44280552864074707
Epoch: 69, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 70 cost time: 0.4772369861602783
Epoch: 70, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 71 cost time: 0.4865896701812744
Epoch: 71, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 72 cost time: 0.5750613212585449
Epoch: 72, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 0.5487155914306641
Epoch: 73, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 74 cost time: 0.49965691566467285
Epoch: 74, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.256 Vali Acc: 0.948 Test Loss: 0.256 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 75 cost time: 0.3920016288757324
Epoch: 75, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.254 Vali Acc: 0.948 Test Loss: 0.254 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 76 cost time: 0.43152737617492676
Epoch: 76, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 77 cost time: 0.512850284576416
Epoch: 77, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 78 cost time: 0.47847414016723633
Epoch: 78, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.250 Vali Acc: 0.941 Test Loss: 0.250 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.5292015075683594
Epoch: 79, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.45631861686706543
Epoch: 80, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.4556553363800049
Epoch: 81, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.5687541961669922
Epoch: 82, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.554236650466919
Epoch: 83, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.5135481357574463
Epoch: 84, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.4600822925567627
Epoch: 85, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.48462867736816406
Epoch: 86, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.4325253963470459
Epoch: 87, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 15942
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.925640344619751
Epoch: 1, Steps: 2 | Train Loss: 2.022 Vali Loss: 1.834 Vali Acc: 0.170 Test Loss: 1.834 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.39600086212158203
Epoch: 2, Steps: 2 | Train Loss: 1.917 Vali Loss: 1.809 Vali Acc: 0.189 Test Loss: 1.809 Test Acc: 0.189
Validation loss decreased (-0.170352 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.46253061294555664
Epoch: 3, Steps: 2 | Train Loss: 2.044 Vali Loss: 1.791 Vali Acc: 0.193 Test Loss: 1.791 Test Acc: 0.193
Validation loss decreased (-0.188871 --> -0.192575).  Saving model ...
Epoch: 4 cost time: 0.44104433059692383
Epoch: 4, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.777 Vali Acc: 0.200 Test Loss: 1.777 Test Acc: 0.200
Validation loss decreased (-0.192575 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 0.38672494888305664
Epoch: 5, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.758 Vali Acc: 0.200 Test Loss: 1.758 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 6 cost time: 0.4916565418243408
Epoch: 6, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.735 Vali Acc: 0.215 Test Loss: 1.735 Test Acc: 0.215
Validation loss decreased (-0.199982 --> -0.214797).  Saving model ...
Epoch: 7 cost time: 0.5569369792938232
Epoch: 7, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.707 Vali Acc: 0.222 Test Loss: 1.707 Test Acc: 0.222
Validation loss decreased (-0.214797 --> -0.222205).  Saving model ...
Epoch: 8 cost time: 0.4514429569244385
Epoch: 8, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.676 Vali Acc: 0.256 Test Loss: 1.676 Test Acc: 0.256
Validation loss decreased (-0.222205 --> -0.255539).  Saving model ...
Epoch: 9 cost time: 0.5312330722808838
Epoch: 9, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.642 Vali Acc: 0.289 Test Loss: 1.642 Test Acc: 0.289
Validation loss decreased (-0.255539 --> -0.288872).  Saving model ...
Epoch: 10 cost time: 0.4324784278869629
Epoch: 10, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.604 Vali Acc: 0.326 Test Loss: 1.604 Test Acc: 0.326
Validation loss decreased (-0.288872 --> -0.325910).  Saving model ...
Epoch: 11 cost time: 0.41710805892944336
Epoch: 11, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.564 Vali Acc: 0.356 Test Loss: 1.564 Test Acc: 0.356
Validation loss decreased (-0.325910 --> -0.355540).  Saving model ...
Epoch: 12 cost time: 0.49070048332214355
Epoch: 12, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.522 Vali Acc: 0.389 Test Loss: 1.522 Test Acc: 0.389
Validation loss decreased (-0.355540 --> -0.388874).  Saving model ...
Epoch: 13 cost time: 0.43569111824035645
Epoch: 13, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.479 Vali Acc: 0.441 Test Loss: 1.479 Test Acc: 0.441
Validation loss decreased (-0.388874 --> -0.440726).  Saving model ...
Epoch: 14 cost time: 0.4433765411376953
Epoch: 14, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.435 Vali Acc: 0.478 Test Loss: 1.435 Test Acc: 0.478
Validation loss decreased (-0.440726 --> -0.477763).  Saving model ...
Epoch: 15 cost time: 0.41727638244628906
Epoch: 15, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.389 Vali Acc: 0.519 Test Loss: 1.389 Test Acc: 0.519
Validation loss decreased (-0.477763 --> -0.518505).  Saving model ...
Epoch: 16 cost time: 0.4687011241912842
Epoch: 16, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.342 Vali Acc: 0.581 Test Loss: 1.342 Test Acc: 0.581
Validation loss decreased (-0.518505 --> -0.581468).  Saving model ...
Epoch: 17 cost time: 0.4384796619415283
Epoch: 17, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.296 Vali Acc: 0.641 Test Loss: 1.296 Test Acc: 0.641
Validation loss decreased (-0.581468 --> -0.640728).  Saving model ...
Epoch: 18 cost time: 0.5517258644104004
Epoch: 18, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.249 Vali Acc: 0.696 Test Loss: 1.249 Test Acc: 0.696
Validation loss decreased (-0.640728 --> -0.696284).  Saving model ...
Epoch: 19 cost time: 0.4602937698364258
Epoch: 19, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.203 Vali Acc: 0.722 Test Loss: 1.203 Test Acc: 0.722
Validation loss decreased (-0.696284 --> -0.722210).  Saving model ...
Epoch: 20 cost time: 0.47112226486206055
Epoch: 20, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.157 Vali Acc: 0.744 Test Loss: 1.157 Test Acc: 0.744
Validation loss decreased (-0.722210 --> -0.744433).  Saving model ...
Epoch: 21 cost time: 0.44059276580810547
Epoch: 21, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.113 Vali Acc: 0.767 Test Loss: 1.113 Test Acc: 0.767
Validation loss decreased (-0.744433 --> -0.766656).  Saving model ...
Epoch: 22 cost time: 0.4492201805114746
Epoch: 22, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.069 Vali Acc: 0.796 Test Loss: 1.069 Test Acc: 0.796
Validation loss decreased (-0.766656 --> -0.796286).  Saving model ...
Epoch: 23 cost time: 0.4115426540374756
Epoch: 23, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.027 Vali Acc: 0.800 Test Loss: 1.027 Test Acc: 0.800
Validation loss decreased (-0.796286 --> -0.799990).  Saving model ...
Epoch: 24 cost time: 0.4919097423553467
Epoch: 24, Steps: 2 | Train Loss: 0.993 Vali Loss: 0.986 Vali Acc: 0.811 Test Loss: 0.986 Test Acc: 0.811
Validation loss decreased (-0.799990 --> -0.811101).  Saving model ...
Epoch: 25 cost time: 0.46524715423583984
Epoch: 25, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.946 Vali Acc: 0.826 Test Loss: 0.946 Test Acc: 0.826
Validation loss decreased (-0.811101 --> -0.825916).  Saving model ...
Epoch: 26 cost time: 0.45370984077453613
Epoch: 26, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.908 Vali Acc: 0.848 Test Loss: 0.908 Test Acc: 0.848
Validation loss decreased (-0.825916 --> -0.848139).  Saving model ...
Epoch: 27 cost time: 0.4207031726837158
Epoch: 27, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.871 Vali Acc: 0.852 Test Loss: 0.871 Test Acc: 0.852
Validation loss decreased (-0.848139 --> -0.851843).  Saving model ...
Epoch: 28 cost time: 0.5565083026885986
Epoch: 28, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.836 Vali Acc: 0.852 Test Loss: 0.836 Test Acc: 0.852
Validation loss decreased (-0.851843 --> -0.851843).  Saving model ...
Epoch: 29 cost time: 0.5446662902832031
Epoch: 29, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.803 Vali Acc: 0.852 Test Loss: 0.803 Test Acc: 0.852
Validation loss decreased (-0.851843 --> -0.851844).  Saving model ...
Epoch: 30 cost time: 0.4701576232910156
Epoch: 30, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.771 Vali Acc: 0.863 Test Loss: 0.771 Test Acc: 0.863
Validation loss decreased (-0.851844 --> -0.862955).  Saving model ...
Epoch: 31 cost time: 0.5007667541503906
Epoch: 31, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.739 Vali Acc: 0.867 Test Loss: 0.739 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866659).  Saving model ...
Epoch: 32 cost time: 0.4392428398132324
Epoch: 32, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.709 Vali Acc: 0.870 Test Loss: 0.709 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 33 cost time: 0.44396090507507324
Epoch: 33, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.680 Vali Acc: 0.889 Test Loss: 0.680 Test Acc: 0.889
Validation loss decreased (-0.870363 --> -0.888882).  Saving model ...
Epoch: 34 cost time: 0.48404455184936523
Epoch: 34, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.653 Vali Acc: 0.889 Test Loss: 0.653 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 35 cost time: 0.4591689109802246
Epoch: 35, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.627 Vali Acc: 0.889 Test Loss: 0.627 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 36 cost time: 0.46517467498779297
Epoch: 36, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899994).  Saving model ...
Epoch: 37 cost time: 0.5061659812927246
Epoch: 37, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.579 Vali Acc: 0.900 Test Loss: 0.579 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 38 cost time: 0.41004133224487305
Epoch: 38, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 39 cost time: 0.43688273429870605
Epoch: 39, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.536 Vali Acc: 0.911 Test Loss: 0.536 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911106).  Saving model ...
Epoch: 40 cost time: 0.4673130512237549
Epoch: 40, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.518 Vali Acc: 0.907 Test Loss: 0.518 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4530363082885742
Epoch: 41, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.500 Vali Acc: 0.907 Test Loss: 0.500 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4307289123535156
Epoch: 42, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.484 Vali Acc: 0.907 Test Loss: 0.484 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5663464069366455
Epoch: 43, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.469 Vali Acc: 0.907 Test Loss: 0.469 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4119596481323242
Epoch: 44, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.455 Vali Acc: 0.911 Test Loss: 0.455 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 45 cost time: 0.42302727699279785
Epoch: 45, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.442 Vali Acc: 0.915 Test Loss: 0.442 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914810).  Saving model ...
Epoch: 46 cost time: 0.48906540870666504
Epoch: 46, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.431 Vali Acc: 0.911 Test Loss: 0.431 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.49631333351135254
Epoch: 47, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.419 Vali Acc: 0.911 Test Loss: 0.419 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4843113422393799
Epoch: 48, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.410 Vali Acc: 0.911 Test Loss: 0.410 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5227668285369873
Epoch: 49, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.400 Vali Acc: 0.911 Test Loss: 0.400 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.46587109565734863
Epoch: 50, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.391 Vali Acc: 0.911 Test Loss: 0.391 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.4905271530151367
Epoch: 51, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.383 Vali Acc: 0.915 Test Loss: 0.383 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 52 cost time: 0.4841644763946533
Epoch: 52, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.375 Vali Acc: 0.915 Test Loss: 0.375 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 53 cost time: 0.4519526958465576
Epoch: 53, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.368 Vali Acc: 0.919 Test Loss: 0.368 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 54 cost time: 0.42551612854003906
Epoch: 54, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.360 Vali Acc: 0.919 Test Loss: 0.360 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 55 cost time: 0.44742918014526367
Epoch: 55, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.353 Vali Acc: 0.919 Test Loss: 0.353 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 56 cost time: 0.39161229133605957
Epoch: 56, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 57 cost time: 0.5325887203216553
Epoch: 57, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.340 Vali Acc: 0.922 Test Loss: 0.340 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 58 cost time: 0.5169148445129395
Epoch: 58, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.334 Vali Acc: 0.922 Test Loss: 0.334 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 59 cost time: 0.4719407558441162
Epoch: 59, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 60 cost time: 0.43113160133361816
Epoch: 60, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.324 Vali Acc: 0.926 Test Loss: 0.324 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 61 cost time: 0.5217366218566895
Epoch: 61, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.320 Vali Acc: 0.926 Test Loss: 0.320 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 62 cost time: 0.39305543899536133
Epoch: 62, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.315 Vali Acc: 0.926 Test Loss: 0.315 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 63 cost time: 0.45485806465148926
Epoch: 63, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 64 cost time: 0.4836540222167969
Epoch: 64, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 65 cost time: 0.45893287658691406
Epoch: 65, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.302 Vali Acc: 0.926 Test Loss: 0.302 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 66 cost time: 0.4166529178619385
Epoch: 66, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.297 Vali Acc: 0.926 Test Loss: 0.297 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 67 cost time: 0.5142219066619873
Epoch: 67, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 68 cost time: 0.5582470893859863
Epoch: 68, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.290 Vali Acc: 0.926 Test Loss: 0.290 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 69 cost time: 0.4549555778503418
Epoch: 69, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 70 cost time: 0.5362777709960938
Epoch: 70, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 71 cost time: 0.46186351776123047
Epoch: 71, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.281 Vali Acc: 0.930 Test Loss: 0.281 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 72 cost time: 0.4356257915496826
Epoch: 72, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 73 cost time: 0.48238253593444824
Epoch: 73, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 74 cost time: 0.4996182918548584
Epoch: 74, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 75 cost time: 0.488400936126709
Epoch: 75, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 76 cost time: 0.5572164058685303
Epoch: 76, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 77 cost time: 0.46479058265686035
Epoch: 77, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 78 cost time: 0.45816779136657715
Epoch: 78, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 79 cost time: 0.5117003917694092
Epoch: 79, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 80 cost time: 0.48271703720092773
Epoch: 80, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 81 cost time: 0.5633666515350342
Epoch: 81, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 82 cost time: 0.49463367462158203
Epoch: 82, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 83 cost time: 0.47951173782348633
Epoch: 83, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 84 cost time: 0.5322051048278809
Epoch: 84, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 85 cost time: 0.4660308361053467
Epoch: 85, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 86 cost time: 0.4546933174133301
Epoch: 86, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 87 cost time: 0.5071589946746826
Epoch: 87, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 88 cost time: 0.5064187049865723
Epoch: 88, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 89 cost time: 0.4265916347503662
Epoch: 89, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 90 cost time: 0.45018482208251953
Epoch: 90, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 91 cost time: 0.5648279190063477
Epoch: 91, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 92 cost time: 0.45453310012817383
Epoch: 92, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 93 cost time: 0.4567909240722656
Epoch: 93, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 94 cost time: 0.4679243564605713
Epoch: 94, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 95 cost time: 0.4257979393005371
Epoch: 95, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 96 cost time: 0.507786750793457
Epoch: 96, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 97 cost time: 0.4918360710144043
Epoch: 97, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 98 cost time: 0.4590888023376465
Epoch: 98, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 99 cost time: 0.5005061626434326
Epoch: 99, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 100 cost time: 0.4966399669647217
Epoch: 100, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm32_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 14534
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.765077829360962
Epoch: 1, Steps: 2 | Train Loss: 2.044 Vali Loss: 1.919 Vali Acc: 0.237 Test Loss: 1.919 Test Acc: 0.237
Validation loss decreased (inf --> -0.237018).  Saving model ...
Epoch: 2 cost time: 0.5230045318603516
Epoch: 2, Steps: 2 | Train Loss: 2.022 Vali Loss: 1.853 Vali Acc: 0.252 Test Loss: 1.853 Test Acc: 0.252
Validation loss decreased (-0.237018 --> -0.251833).  Saving model ...
Epoch: 3 cost time: 0.5533676147460938
Epoch: 3, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.795 Vali Acc: 0.259 Test Loss: 1.795 Test Acc: 0.259
Validation loss decreased (-0.251833 --> -0.259241).  Saving model ...
Epoch: 4 cost time: 0.5156183242797852
Epoch: 4, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.724 Vali Acc: 0.300 Test Loss: 1.724 Test Acc: 0.300
Validation loss decreased (-0.259241 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 0.5309038162231445
Epoch: 5, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.634 Vali Acc: 0.344 Test Loss: 1.634 Test Acc: 0.344
Validation loss decreased (-0.299983 --> -0.344428).  Saving model ...
Epoch: 6 cost time: 0.4503340721130371
Epoch: 6, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.529 Vali Acc: 0.400 Test Loss: 1.529 Test Acc: 0.400
Validation loss decreased (-0.344428 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 0.4800121784210205
Epoch: 7, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.417 Vali Acc: 0.537 Test Loss: 1.417 Test Acc: 0.537
Validation loss decreased (-0.399985 --> -0.537023).  Saving model ...
Epoch: 8 cost time: 0.4782857894897461
Epoch: 8, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.303 Vali Acc: 0.667 Test Loss: 1.303 Test Acc: 0.667
Validation loss decreased (-0.537023 --> -0.666654).  Saving model ...
Epoch: 9 cost time: 0.5207622051239014
Epoch: 9, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.191 Vali Acc: 0.759 Test Loss: 1.191 Test Acc: 0.759
Validation loss decreased (-0.666654 --> -0.759247).  Saving model ...
Epoch: 10 cost time: 0.4951462745666504
Epoch: 10, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.085 Vali Acc: 0.759 Test Loss: 1.085 Test Acc: 0.759
Validation loss decreased (-0.759247 --> -0.759248).  Saving model ...
Epoch: 11 cost time: 0.4572267532348633
Epoch: 11, Steps: 2 | Train Loss: 0.957 Vali Loss: 0.983 Vali Acc: 0.781 Test Loss: 0.983 Test Acc: 0.781
Validation loss decreased (-0.759248 --> -0.781472).  Saving model ...
Epoch: 12 cost time: 0.42571163177490234
Epoch: 12, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.889 Vali Acc: 0.793 Test Loss: 0.889 Test Acc: 0.793
Validation loss decreased (-0.781472 --> -0.792584).  Saving model ...
Epoch: 13 cost time: 0.42179393768310547
Epoch: 13, Steps: 2 | Train Loss: 0.796 Vali Loss: 0.800 Vali Acc: 0.811 Test Loss: 0.800 Test Acc: 0.811
Validation loss decreased (-0.792584 --> -0.811103).  Saving model ...
Epoch: 14 cost time: 0.5191650390625
Epoch: 14, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.719 Vali Acc: 0.870 Test Loss: 0.719 Test Acc: 0.870
Validation loss decreased (-0.811103 --> -0.870363).  Saving model ...
Epoch: 15 cost time: 0.5381643772125244
Epoch: 15, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.648 Vali Acc: 0.904 Test Loss: 0.648 Test Acc: 0.904
Validation loss decreased (-0.870363 --> -0.903697).  Saving model ...
Epoch: 16 cost time: 0.5333242416381836
Epoch: 16, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.586 Vali Acc: 0.922 Test Loss: 0.586 Test Acc: 0.922
Validation loss decreased (-0.903697 --> -0.922216).  Saving model ...
Epoch: 17 cost time: 0.5107338428497314
Epoch: 17, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.533 Vali Acc: 0.922 Test Loss: 0.533 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 18 cost time: 0.4598233699798584
Epoch: 18, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.486 Vali Acc: 0.922 Test Loss: 0.486 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 19 cost time: 0.4989185333251953
Epoch: 19, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.443 Vali Acc: 0.926 Test Loss: 0.443 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 20 cost time: 0.4735126495361328
Epoch: 20, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.408 Vali Acc: 0.919 Test Loss: 0.408 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5315301418304443
Epoch: 21, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.379 Vali Acc: 0.911 Test Loss: 0.379 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5526556968688965
Epoch: 22, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.357 Vali Acc: 0.911 Test Loss: 0.357 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.45067644119262695
Epoch: 23, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.336 Vali Acc: 0.915 Test Loss: 0.336 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4842343330383301
Epoch: 24, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.313 Vali Acc: 0.907 Test Loss: 0.313 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.42267942428588867
Epoch: 25, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.45006752014160156
Epoch: 26, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 0.5852477550506592
Epoch: 27, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.4661684036254883
Epoch: 28, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.47295236587524414
Epoch: 29, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.4887106418609619
Epoch: 30, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.4600498676300049
Epoch: 31, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5341062545776367
Epoch: 32, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4851973056793213
Epoch: 33, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5157206058502197
Epoch: 34, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5179767608642578
Epoch: 35, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.44142913818359375
Epoch: 36, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.48314738273620605
Epoch: 37, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5938050746917725
Epoch: 38, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5225934982299805
Epoch: 39, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.4504537582397461
Epoch: 40, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 34646
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9683656692504883
Epoch: 1, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.750 Vali Acc: 0.237 Test Loss: 1.750 Test Acc: 0.237
Validation loss decreased (inf --> -0.237020).  Saving model ...
Epoch: 2 cost time: 0.44616246223449707
Epoch: 2, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.711 Vali Acc: 0.278 Test Loss: 1.711 Test Acc: 0.278
Validation loss decreased (-0.237020 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.4608168601989746
Epoch: 3, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.680 Vali Acc: 0.322 Test Loss: 1.680 Test Acc: 0.322
Validation loss decreased (-0.277761 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 0.47850489616394043
Epoch: 4, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.650 Vali Acc: 0.359 Test Loss: 1.650 Test Acc: 0.359
Validation loss decreased (-0.322205 --> -0.359243).  Saving model ...
Epoch: 5 cost time: 0.45400404930114746
Epoch: 5, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.610 Vali Acc: 0.411 Test Loss: 1.610 Test Acc: 0.411
Validation loss decreased (-0.359243 --> -0.411095).  Saving model ...
Epoch: 6 cost time: 0.4869265556335449
Epoch: 6, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.562 Vali Acc: 0.456 Test Loss: 1.562 Test Acc: 0.456
Validation loss decreased (-0.411095 --> -0.455540).  Saving model ...
Epoch: 7 cost time: 0.4729158878326416
Epoch: 7, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.507 Vali Acc: 0.485 Test Loss: 1.507 Test Acc: 0.485
Validation loss decreased (-0.455540 --> -0.485170).  Saving model ...
Epoch: 8 cost time: 0.522150993347168
Epoch: 8, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.448 Vali Acc: 0.522 Test Loss: 1.448 Test Acc: 0.522
Validation loss decreased (-0.485170 --> -0.522208).  Saving model ...
Epoch: 9 cost time: 0.5216619968414307
Epoch: 9, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.385 Vali Acc: 0.581 Test Loss: 1.385 Test Acc: 0.581
Validation loss decreased (-0.522208 --> -0.581468).  Saving model ...
Epoch: 10 cost time: 0.5528066158294678
Epoch: 10, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.321 Vali Acc: 0.637 Test Loss: 1.321 Test Acc: 0.637
Validation loss decreased (-0.581468 --> -0.637024).  Saving model ...
Epoch: 11 cost time: 0.47904396057128906
Epoch: 11, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.254 Vali Acc: 0.693 Test Loss: 1.254 Test Acc: 0.693
Validation loss decreased (-0.637024 --> -0.692580).  Saving model ...
Epoch: 12 cost time: 0.4570796489715576
Epoch: 12, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.188 Vali Acc: 0.767 Test Loss: 1.188 Test Acc: 0.767
Validation loss decreased (-0.692580 --> -0.766655).  Saving model ...
Epoch: 13 cost time: 0.4444868564605713
Epoch: 13, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.122 Vali Acc: 0.800 Test Loss: 1.122 Test Acc: 0.800
Validation loss decreased (-0.766655 --> -0.799989).  Saving model ...
Epoch: 14 cost time: 0.40473461151123047
Epoch: 14, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.057 Vali Acc: 0.830 Test Loss: 1.057 Test Acc: 0.830
Validation loss decreased (-0.799989 --> -0.829619).  Saving model ...
Epoch: 15 cost time: 0.5545125007629395
Epoch: 15, Steps: 2 | Train Loss: 1.006 Vali Loss: 0.993 Vali Acc: 0.844 Test Loss: 0.993 Test Acc: 0.844
Validation loss decreased (-0.829619 --> -0.844435).  Saving model ...
Epoch: 16 cost time: 0.4327099323272705
Epoch: 16, Steps: 2 | Train Loss: 0.907 Vali Loss: 0.932 Vali Acc: 0.870 Test Loss: 0.932 Test Acc: 0.870
Validation loss decreased (-0.844435 --> -0.870361).  Saving model ...
Epoch: 17 cost time: 0.5430784225463867
Epoch: 17, Steps: 2 | Train Loss: 0.921 Vali Loss: 0.872 Vali Acc: 0.874 Test Loss: 0.872 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 18 cost time: 0.6117711067199707
Epoch: 18, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.817 Vali Acc: 0.874 Test Loss: 0.817 Test Acc: 0.874
Validation loss decreased (-0.874065 --> -0.874066).  Saving model ...
Epoch: 19 cost time: 0.4223759174346924
Epoch: 19, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.765 Vali Acc: 0.885 Test Loss: 0.765 Test Acc: 0.885
Validation loss decreased (-0.874066 --> -0.885178).  Saving model ...
Epoch: 20 cost time: 0.6055810451507568
Epoch: 20, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.717 Vali Acc: 0.893 Test Loss: 0.717 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892585).  Saving model ...
Epoch: 21 cost time: 0.5929193496704102
Epoch: 21, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.671 Vali Acc: 0.900 Test Loss: 0.671 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.5278170108795166
Epoch: 22, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.628 Vali Acc: 0.900 Test Loss: 0.628 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.500943660736084
Epoch: 23, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.589 Vali Acc: 0.904 Test Loss: 0.589 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 24 cost time: 0.49796581268310547
Epoch: 24, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.552 Vali Acc: 0.911 Test Loss: 0.552 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 25 cost time: 0.47715067863464355
Epoch: 25, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.519 Vali Acc: 0.911 Test Loss: 0.519 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 26 cost time: 0.46053409576416016
Epoch: 26, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.488 Vali Acc: 0.919 Test Loss: 0.488 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 27 cost time: 0.46988964080810547
Epoch: 27, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.460 Vali Acc: 0.915 Test Loss: 0.460 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.44785618782043457
Epoch: 28, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.434 Vali Acc: 0.919 Test Loss: 0.434 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 29 cost time: 0.5566601753234863
Epoch: 29, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.410 Vali Acc: 0.922 Test Loss: 0.410 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 30 cost time: 0.5171604156494141
Epoch: 30, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.390 Vali Acc: 0.926 Test Loss: 0.390 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 31 cost time: 0.4422132968902588
Epoch: 31, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.372 Vali Acc: 0.922 Test Loss: 0.372 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.47622084617614746
Epoch: 32, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.357 Vali Acc: 0.919 Test Loss: 0.357 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4705934524536133
Epoch: 33, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.342 Vali Acc: 0.919 Test Loss: 0.342 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4630448818206787
Epoch: 34, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4174823760986328
Epoch: 35, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.313 Vali Acc: 0.926 Test Loss: 0.313 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 36 cost time: 0.4961082935333252
Epoch: 36, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.301 Vali Acc: 0.933 Test Loss: 0.301 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 0.5049777030944824
Epoch: 37, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.290 Vali Acc: 0.937 Test Loss: 0.290 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 38 cost time: 0.44560956954956055
Epoch: 38, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 39 cost time: 0.5237092971801758
Epoch: 39, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 0.4765634536743164
Epoch: 40, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 41 cost time: 0.507044792175293
Epoch: 41, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 42 cost time: 0.45656466484069824
Epoch: 42, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 43 cost time: 0.5081987380981445
Epoch: 43, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.5331227779388428
Epoch: 44, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4430270195007324
Epoch: 45, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.3850715160369873
Epoch: 46, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.42608070373535156
Epoch: 47, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6165561676025391
Epoch: 48, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5338163375854492
Epoch: 49, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.571998119354248
Epoch: 50, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 51 cost time: 0.5203244686126709
Epoch: 51, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 52 cost time: 0.4162740707397461
Epoch: 52, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 53 cost time: 0.5052125453948975
Epoch: 53, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 54 cost time: 0.4284796714782715
Epoch: 54, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 55 cost time: 0.5021336078643799
Epoch: 55, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 56 cost time: 0.4124579429626465
Epoch: 56, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 57 cost time: 0.564868688583374
Epoch: 57, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 58 cost time: 0.4712388515472412
Epoch: 58, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 59 cost time: 0.5083620548248291
Epoch: 59, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 60 cost time: 0.4978818893432617
Epoch: 60, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 61 cost time: 0.45891547203063965
Epoch: 61, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 62 cost time: 0.45935606956481934
Epoch: 62, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 63 cost time: 0.5369279384613037
Epoch: 63, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 64 cost time: 0.510235071182251
Epoch: 64, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 65 cost time: 0.5246140956878662
Epoch: 65, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 66 cost time: 0.49176669120788574
Epoch: 66, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 67 cost time: 0.48956942558288574
Epoch: 67, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 68 cost time: 0.5311408042907715
Epoch: 68, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 69 cost time: 0.5292589664459229
Epoch: 69, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 70 cost time: 0.5366153717041016
Epoch: 70, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 71 cost time: 0.592529296875
Epoch: 71, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 72 cost time: 0.4854919910430908
Epoch: 72, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 73 cost time: 0.539081335067749
Epoch: 73, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 74 cost time: 0.5106797218322754
Epoch: 74, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 75 cost time: 0.5714726448059082
Epoch: 75, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 76 cost time: 0.4739260673522949
Epoch: 76, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 77 cost time: 0.4960033893585205
Epoch: 77, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 78 cost time: 0.4451289176940918
Epoch: 78, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.46964287757873535
Epoch: 79, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.4934678077697754
Epoch: 80, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.5894110202789307
Epoch: 81, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.5402126312255859
Epoch: 82, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.5675897598266602
Epoch: 83, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.5027203559875488
Epoch: 84, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.5187375545501709
Epoch: 85, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.5274291038513184
Epoch: 86, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.5005760192871094
Epoch: 87, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 22006
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9065806865692139
Epoch: 1, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.948 Vali Acc: 0.174 Test Loss: 1.948 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 0.44840312004089355
Epoch: 2, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.889 Vali Acc: 0.178 Test Loss: 1.889 Test Acc: 0.178
Validation loss decreased (-0.174055 --> -0.177759).  Saving model ...
Epoch: 3 cost time: 0.4579324722290039
Epoch: 3, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.846 Vali Acc: 0.185 Test Loss: 1.846 Test Acc: 0.185
Validation loss decreased (-0.177759 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 0.4660604000091553
Epoch: 4, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.809 Vali Acc: 0.189 Test Loss: 1.809 Test Acc: 0.189
Validation loss decreased (-0.185167 --> -0.188871).  Saving model ...
Epoch: 5 cost time: 0.4941387176513672
Epoch: 5, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.764 Vali Acc: 0.193 Test Loss: 1.764 Test Acc: 0.193
Validation loss decreased (-0.188871 --> -0.192575).  Saving model ...
Epoch: 6 cost time: 0.49343132972717285
Epoch: 6, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.713 Vali Acc: 0.211 Test Loss: 1.713 Test Acc: 0.211
Validation loss decreased (-0.192575 --> -0.211094).  Saving model ...
Epoch: 7 cost time: 0.47443675994873047
Epoch: 7, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.658 Vali Acc: 0.233 Test Loss: 1.658 Test Acc: 0.233
Validation loss decreased (-0.211094 --> -0.233317).  Saving model ...
Epoch: 8 cost time: 0.43534326553344727
Epoch: 8, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.598 Vali Acc: 0.263 Test Loss: 1.598 Test Acc: 0.263
Validation loss decreased (-0.233317 --> -0.262947).  Saving model ...
Epoch: 9 cost time: 0.6239655017852783
Epoch: 9, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.535 Vali Acc: 0.293 Test Loss: 1.535 Test Acc: 0.293
Validation loss decreased (-0.262947 --> -0.292577).  Saving model ...
Epoch: 10 cost time: 0.5575077533721924
Epoch: 10, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.471 Vali Acc: 0.330 Test Loss: 1.471 Test Acc: 0.330
Validation loss decreased (-0.292577 --> -0.329615).  Saving model ...
Epoch: 11 cost time: 0.48476338386535645
Epoch: 11, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.406 Vali Acc: 0.411 Test Loss: 1.406 Test Acc: 0.411
Validation loss decreased (-0.329615 --> -0.411097).  Saving model ...
Epoch: 12 cost time: 0.48523449897766113
Epoch: 12, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.340 Vali Acc: 0.489 Test Loss: 1.340 Test Acc: 0.489
Validation loss decreased (-0.411097 --> -0.488875).  Saving model ...
Epoch: 13 cost time: 0.5453879833221436
Epoch: 13, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.273 Vali Acc: 0.567 Test Loss: 1.273 Test Acc: 0.567
Validation loss decreased (-0.488875 --> -0.566654).  Saving model ...
Epoch: 14 cost time: 0.4484992027282715
Epoch: 14, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.206 Vali Acc: 0.633 Test Loss: 1.206 Test Acc: 0.633
Validation loss decreased (-0.566654 --> -0.633321).  Saving model ...
Epoch: 15 cost time: 0.499835729598999
Epoch: 15, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.141 Vali Acc: 0.674 Test Loss: 1.141 Test Acc: 0.674
Validation loss decreased (-0.633321 --> -0.674063).  Saving model ...
Epoch: 16 cost time: 0.5122807025909424
Epoch: 16, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.076 Vali Acc: 0.722 Test Loss: 1.076 Test Acc: 0.722
Validation loss decreased (-0.674063 --> -0.722211).  Saving model ...
Epoch: 17 cost time: 0.484666109085083
Epoch: 17, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.015 Vali Acc: 0.763 Test Loss: 1.015 Test Acc: 0.763
Validation loss decreased (-0.722211 --> -0.762953).  Saving model ...
Epoch: 18 cost time: 0.4838380813598633
Epoch: 18, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.955 Vali Acc: 0.781 Test Loss: 0.955 Test Acc: 0.781
Validation loss decreased (-0.762953 --> -0.781472).  Saving model ...
Epoch: 19 cost time: 0.5783050060272217
Epoch: 19, Steps: 2 | Train Loss: 0.802 Vali Loss: 0.899 Vali Acc: 0.811 Test Loss: 0.899 Test Acc: 0.811
Validation loss decreased (-0.781472 --> -0.811102).  Saving model ...
Epoch: 20 cost time: 0.5594325065612793
Epoch: 20, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.846 Vali Acc: 0.833 Test Loss: 0.846 Test Acc: 0.833
Validation loss decreased (-0.811102 --> -0.833325).  Saving model ...
Epoch: 21 cost time: 0.48291492462158203
Epoch: 21, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.797 Vali Acc: 0.859 Test Loss: 0.797 Test Acc: 0.859
Validation loss decreased (-0.833325 --> -0.859251).  Saving model ...
Epoch: 22 cost time: 0.4718341827392578
Epoch: 22, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.751 Vali Acc: 0.863 Test Loss: 0.751 Test Acc: 0.863
Validation loss decreased (-0.859251 --> -0.862955).  Saving model ...
Epoch: 23 cost time: 0.47150611877441406
Epoch: 23, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.708 Vali Acc: 0.867 Test Loss: 0.708 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 0.46170639991760254
Epoch: 24, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.668 Vali Acc: 0.870 Test Loss: 0.668 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 25 cost time: 0.4699878692626953
Epoch: 25, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.631 Vali Acc: 0.881 Test Loss: 0.631 Test Acc: 0.881
Validation loss decreased (-0.870364 --> -0.881475).  Saving model ...
Epoch: 26 cost time: 0.45226216316223145
Epoch: 26, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.597 Vali Acc: 0.893 Test Loss: 0.597 Test Acc: 0.893
Validation loss decreased (-0.881475 --> -0.892587).  Saving model ...
Epoch: 27 cost time: 0.44199419021606445
Epoch: 27, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.567 Vali Acc: 0.889 Test Loss: 0.567 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5217454433441162
Epoch: 28, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.538 Vali Acc: 0.896 Test Loss: 0.538 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 29 cost time: 0.548490047454834
Epoch: 29, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.513 Vali Acc: 0.900 Test Loss: 0.513 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.5074286460876465
Epoch: 30, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.489 Vali Acc: 0.904 Test Loss: 0.489 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 31 cost time: 0.5499343872070312
Epoch: 31, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.466 Vali Acc: 0.904 Test Loss: 0.466 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 32 cost time: 0.46135997772216797
Epoch: 32, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.445 Vali Acc: 0.907 Test Loss: 0.445 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 33 cost time: 0.43192315101623535
Epoch: 33, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.425 Vali Acc: 0.911 Test Loss: 0.425 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 34 cost time: 0.5443134307861328
Epoch: 34, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.407 Vali Acc: 0.919 Test Loss: 0.407 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918514).  Saving model ...
Epoch: 35 cost time: 0.6669862270355225
Epoch: 35, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.391 Vali Acc: 0.919 Test Loss: 0.391 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 36 cost time: 0.5381133556365967
Epoch: 36, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.378 Vali Acc: 0.919 Test Loss: 0.378 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 37 cost time: 0.4817988872528076
Epoch: 37, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 38 cost time: 0.5680432319641113
Epoch: 38, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.358 Vali Acc: 0.922 Test Loss: 0.358 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 39 cost time: 0.6526308059692383
Epoch: 39, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.350 Vali Acc: 0.922 Test Loss: 0.350 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 40 cost time: 0.5428321361541748
Epoch: 40, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.342 Vali Acc: 0.919 Test Loss: 0.342 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.539010763168335
Epoch: 41, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.334 Vali Acc: 0.919 Test Loss: 0.334 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5943968296051025
Epoch: 42, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.326 Vali Acc: 0.919 Test Loss: 0.326 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.501220703125
Epoch: 43, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.317 Vali Acc: 0.919 Test Loss: 0.317 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5478780269622803
Epoch: 44, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.309 Vali Acc: 0.922 Test Loss: 0.309 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 45 cost time: 0.4895055294036865
Epoch: 45, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 46 cost time: 0.525418758392334
Epoch: 46, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 47 cost time: 0.5184998512268066
Epoch: 47, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 48 cost time: 0.4730243682861328
Epoch: 48, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 49 cost time: 0.4984893798828125
Epoch: 49, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 50 cost time: 0.4960625171661377
Epoch: 50, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.275 Vali Acc: 0.930 Test Loss: 0.275 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 51 cost time: 0.5263659954071045
Epoch: 51, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 52 cost time: 0.4976515769958496
Epoch: 52, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 53 cost time: 0.48000311851501465
Epoch: 53, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.264 Vali Acc: 0.926 Test Loss: 0.264 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.44806504249572754
Epoch: 54, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.260 Vali Acc: 0.926 Test Loss: 0.260 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.4814178943634033
Epoch: 55, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.4792349338531494
Epoch: 56, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.4846506118774414
Epoch: 57, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5678682327270508
Epoch: 58, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.4809591770172119
Epoch: 59, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.48740386962890625
Epoch: 60, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.4986848831176758
Epoch: 61, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.41393303871154785
Epoch: 62, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 18182
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9762744903564453
Epoch: 1, Steps: 2 | Train Loss: 2.069 Vali Loss: 1.985 Vali Acc: 0.133 Test Loss: 1.985 Test Acc: 0.133
Validation loss decreased (inf --> -0.133313).  Saving model ...
Epoch: 2 cost time: 0.44260597229003906
Epoch: 2, Steps: 2 | Train Loss: 1.979 Vali Loss: 1.936 Vali Acc: 0.133 Test Loss: 1.936 Test Acc: 0.133
Validation loss decreased (-0.133313 --> -0.133314).  Saving model ...
Epoch: 3 cost time: 0.43360018730163574
Epoch: 3, Steps: 2 | Train Loss: 2.008 Vali Loss: 1.900 Vali Acc: 0.133 Test Loss: 1.900 Test Acc: 0.133
Validation loss decreased (-0.133314 --> -0.133314).  Saving model ...
Epoch: 4 cost time: 0.4157271385192871
Epoch: 4, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.870 Vali Acc: 0.137 Test Loss: 1.870 Test Acc: 0.137
Validation loss decreased (-0.133314 --> -0.137018).  Saving model ...
Epoch: 5 cost time: 0.4259791374206543
Epoch: 5, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.836 Vali Acc: 0.137 Test Loss: 1.836 Test Acc: 0.137
Validation loss decreased (-0.137018 --> -0.137019).  Saving model ...
Epoch: 6 cost time: 0.46147823333740234
Epoch: 6, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.800 Vali Acc: 0.144 Test Loss: 1.800 Test Acc: 0.144
Validation loss decreased (-0.137019 --> -0.144426).  Saving model ...
Epoch: 7 cost time: 0.49657487869262695
Epoch: 7, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.760 Vali Acc: 0.159 Test Loss: 1.760 Test Acc: 0.159
Validation loss decreased (-0.144426 --> -0.159242).  Saving model ...
Epoch: 8 cost time: 0.44709038734436035
Epoch: 8, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.718 Vali Acc: 0.189 Test Loss: 1.718 Test Acc: 0.189
Validation loss decreased (-0.159242 --> -0.188872).  Saving model ...
Epoch: 9 cost time: 0.4477367401123047
Epoch: 9, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.674 Vali Acc: 0.244 Test Loss: 1.674 Test Acc: 0.244
Validation loss decreased (-0.188872 --> -0.244428).  Saving model ...
Epoch: 10 cost time: 0.4692530632019043
Epoch: 10, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.627 Vali Acc: 0.319 Test Loss: 1.627 Test Acc: 0.319
Validation loss decreased (-0.244428 --> -0.318502).  Saving model ...
Epoch: 11 cost time: 0.4794785976409912
Epoch: 11, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.579 Vali Acc: 0.396 Test Loss: 1.579 Test Acc: 0.396
Validation loss decreased (-0.318502 --> -0.396281).  Saving model ...
Epoch: 12 cost time: 0.48984503746032715
Epoch: 12, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.530 Vali Acc: 0.456 Test Loss: 1.530 Test Acc: 0.456
Validation loss decreased (-0.396281 --> -0.455540).  Saving model ...
Epoch: 13 cost time: 0.44708824157714844
Epoch: 13, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.479 Vali Acc: 0.504 Test Loss: 1.479 Test Acc: 0.504
Validation loss decreased (-0.455540 --> -0.503689).  Saving model ...
Epoch: 14 cost time: 0.5070409774780273
Epoch: 14, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.427 Vali Acc: 0.548 Test Loss: 1.427 Test Acc: 0.548
Validation loss decreased (-0.503689 --> -0.548134).  Saving model ...
Epoch: 15 cost time: 0.4268176555633545
Epoch: 15, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.375 Vali Acc: 0.570 Test Loss: 1.375 Test Acc: 0.570
Validation loss decreased (-0.548134 --> -0.570357).  Saving model ...
Epoch: 16 cost time: 0.41722750663757324
Epoch: 16, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.325 Vali Acc: 0.607 Test Loss: 1.325 Test Acc: 0.607
Validation loss decreased (-0.570357 --> -0.607394).  Saving model ...
Epoch: 17 cost time: 0.42520570755004883
Epoch: 17, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.274 Vali Acc: 0.641 Test Loss: 1.274 Test Acc: 0.641
Validation loss decreased (-0.607394 --> -0.640728).  Saving model ...
Epoch: 18 cost time: 0.5000669956207275
Epoch: 18, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.225 Vali Acc: 0.667 Test Loss: 1.225 Test Acc: 0.667
Validation loss decreased (-0.640728 --> -0.666654).  Saving model ...
Epoch: 19 cost time: 0.47702789306640625
Epoch: 19, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.177 Vali Acc: 0.696 Test Loss: 1.177 Test Acc: 0.696
Validation loss decreased (-0.666654 --> -0.696285).  Saving model ...
Epoch: 20 cost time: 0.4357457160949707
Epoch: 20, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.130 Vali Acc: 0.711 Test Loss: 1.130 Test Acc: 0.711
Validation loss decreased (-0.696285 --> -0.711100).  Saving model ...
Epoch: 21 cost time: 0.3918120861053467
Epoch: 21, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.083 Vali Acc: 0.726 Test Loss: 1.083 Test Acc: 0.726
Validation loss decreased (-0.711100 --> -0.725915).  Saving model ...
Epoch: 22 cost time: 0.48495006561279297
Epoch: 22, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.037 Vali Acc: 0.748 Test Loss: 1.037 Test Acc: 0.748
Validation loss decreased (-0.725915 --> -0.748138).  Saving model ...
Epoch: 23 cost time: 0.49101758003234863
Epoch: 23, Steps: 2 | Train Loss: 0.993 Vali Loss: 0.991 Vali Acc: 0.759 Test Loss: 0.991 Test Acc: 0.759
Validation loss decreased (-0.748138 --> -0.759249).  Saving model ...
Epoch: 24 cost time: 0.5053884983062744
Epoch: 24, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.948 Vali Acc: 0.774 Test Loss: 0.948 Test Acc: 0.774
Validation loss decreased (-0.759249 --> -0.774065).  Saving model ...
Epoch: 25 cost time: 0.5693223476409912
Epoch: 25, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.905 Vali Acc: 0.793 Test Loss: 0.905 Test Acc: 0.793
Validation loss decreased (-0.774065 --> -0.792584).  Saving model ...
Epoch: 26 cost time: 0.41367483139038086
Epoch: 26, Steps: 2 | Train Loss: 0.863 Vali Loss: 0.866 Vali Acc: 0.811 Test Loss: 0.866 Test Acc: 0.811
Validation loss decreased (-0.792584 --> -0.811102).  Saving model ...
Epoch: 27 cost time: 0.38131117820739746
Epoch: 27, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.827 Vali Acc: 0.822 Test Loss: 0.827 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822214).  Saving model ...
Epoch: 28 cost time: 0.4164140224456787
Epoch: 28, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.789 Vali Acc: 0.837 Test Loss: 0.789 Test Acc: 0.837
Validation loss decreased (-0.822214 --> -0.837029).  Saving model ...
Epoch: 29 cost time: 0.45364880561828613
Epoch: 29, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.754 Vali Acc: 0.837 Test Loss: 0.754 Test Acc: 0.837
Validation loss decreased (-0.837029 --> -0.837029).  Saving model ...
Epoch: 30 cost time: 0.5802597999572754
Epoch: 30, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.720 Vali Acc: 0.856 Test Loss: 0.720 Test Acc: 0.856
Validation loss decreased (-0.837029 --> -0.855548).  Saving model ...
Epoch: 31 cost time: 0.4856700897216797
Epoch: 31, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.688 Vali Acc: 0.859 Test Loss: 0.688 Test Acc: 0.859
Validation loss decreased (-0.855548 --> -0.859252).  Saving model ...
Epoch: 32 cost time: 0.4903140068054199
Epoch: 32, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.658 Vali Acc: 0.874 Test Loss: 0.658 Test Acc: 0.874
Validation loss decreased (-0.859252 --> -0.874067).  Saving model ...
Epoch: 33 cost time: 0.4833848476409912
Epoch: 33, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.628 Vali Acc: 0.885 Test Loss: 0.628 Test Acc: 0.885
Validation loss decreased (-0.874067 --> -0.885179).  Saving model ...
Epoch: 34 cost time: 0.45522022247314453
Epoch: 34, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.601 Vali Acc: 0.896 Test Loss: 0.601 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896290).  Saving model ...
Epoch: 35 cost time: 0.45900821685791016
Epoch: 35, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.575 Vali Acc: 0.896 Test Loss: 0.575 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896291).  Saving model ...
Epoch: 36 cost time: 0.5164515972137451
Epoch: 36, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.551 Vali Acc: 0.904 Test Loss: 0.551 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903698).  Saving model ...
Epoch: 37 cost time: 0.4309372901916504
Epoch: 37, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.529 Vali Acc: 0.907 Test Loss: 0.529 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 38 cost time: 0.4349856376647949
Epoch: 38, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.508 Vali Acc: 0.907 Test Loss: 0.508 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 39 cost time: 0.4798400402069092
Epoch: 39, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.490 Vali Acc: 0.907 Test Loss: 0.490 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 40 cost time: 0.5077769756317139
Epoch: 40, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.473 Vali Acc: 0.907 Test Loss: 0.473 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 41 cost time: 0.48073506355285645
Epoch: 41, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.459 Vali Acc: 0.907 Test Loss: 0.459 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 42 cost time: 0.46694159507751465
Epoch: 42, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4689927101135254
Epoch: 43, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.432 Vali Acc: 0.904 Test Loss: 0.432 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.49499964714050293
Epoch: 44, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.420 Vali Acc: 0.904 Test Loss: 0.420 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.45885515213012695
Epoch: 45, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.409 Vali Acc: 0.904 Test Loss: 0.409 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.46921658515930176
Epoch: 46, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.398 Vali Acc: 0.911 Test Loss: 0.398 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 47 cost time: 0.6360530853271484
Epoch: 47, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.386 Vali Acc: 0.919 Test Loss: 0.386 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 48 cost time: 0.4289994239807129
Epoch: 48, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.376 Vali Acc: 0.922 Test Loss: 0.376 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922218).  Saving model ...
Epoch: 49 cost time: 0.43831372261047363
Epoch: 49, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.367 Vali Acc: 0.922 Test Loss: 0.367 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 50 cost time: 0.6416451930999756
Epoch: 50, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.359 Vali Acc: 0.930 Test Loss: 0.359 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929626).  Saving model ...
Epoch: 51 cost time: 0.4754676818847656
Epoch: 51, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.351 Vali Acc: 0.930 Test Loss: 0.351 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 52 cost time: 0.6052341461181641
Epoch: 52, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.471726655960083
Epoch: 53, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.339 Vali Acc: 0.922 Test Loss: 0.339 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.4972691535949707
Epoch: 54, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.334 Vali Acc: 0.922 Test Loss: 0.334 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.511615514755249
Epoch: 55, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.4283108711242676
Epoch: 56, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.5305566787719727
Epoch: 57, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.41591477394104004
Epoch: 58, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.5498716831207275
Epoch: 59, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.311 Vali Acc: 0.919 Test Loss: 0.311 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.5285251140594482
Epoch: 60, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.5062015056610107
Epoch: 61, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.305 Vali Acc: 0.919 Test Loss: 0.305 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 15910
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0715644359588623
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.863 Vali Acc: 0.159 Test Loss: 1.863 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 0.4856607913970947
Epoch: 2, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.818 Vali Acc: 0.163 Test Loss: 1.818 Test Acc: 0.163
Validation loss decreased (-0.159241 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 0.43367671966552734
Epoch: 3, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.784 Vali Acc: 0.170 Test Loss: 1.784 Test Acc: 0.170
Validation loss decreased (-0.162945 --> -0.170353).  Saving model ...
Epoch: 4 cost time: 0.5707650184631348
Epoch: 4, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.757 Vali Acc: 0.185 Test Loss: 1.757 Test Acc: 0.185
Validation loss decreased (-0.170353 --> -0.185168).  Saving model ...
Epoch: 5 cost time: 0.48381829261779785
Epoch: 5, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.726 Vali Acc: 0.215 Test Loss: 1.726 Test Acc: 0.215
Validation loss decreased (-0.185168 --> -0.214798).  Saving model ...
Epoch: 6 cost time: 0.4352381229400635
Epoch: 6, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.692 Vali Acc: 0.256 Test Loss: 1.692 Test Acc: 0.256
Validation loss decreased (-0.214798 --> -0.255539).  Saving model ...
Epoch: 7 cost time: 0.4734468460083008
Epoch: 7, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.654 Vali Acc: 0.293 Test Loss: 1.654 Test Acc: 0.293
Validation loss decreased (-0.255539 --> -0.292576).  Saving model ...
Epoch: 8 cost time: 0.5065066814422607
Epoch: 8, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.616 Vali Acc: 0.341 Test Loss: 1.616 Test Acc: 0.341
Validation loss decreased (-0.292576 --> -0.340725).  Saving model ...
Epoch: 9 cost time: 0.4664804935455322
Epoch: 9, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.574 Vali Acc: 0.396 Test Loss: 1.574 Test Acc: 0.396
Validation loss decreased (-0.340725 --> -0.396281).  Saving model ...
Epoch: 10 cost time: 0.62496018409729
Epoch: 10, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.532 Vali Acc: 0.419 Test Loss: 1.532 Test Acc: 0.419
Validation loss decreased (-0.396281 --> -0.418503).  Saving model ...
Epoch: 11 cost time: 0.5057196617126465
Epoch: 11, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.487 Vali Acc: 0.441 Test Loss: 1.487 Test Acc: 0.441
Validation loss decreased (-0.418503 --> -0.440726).  Saving model ...
Epoch: 12 cost time: 0.497342586517334
Epoch: 12, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.442 Vali Acc: 0.481 Test Loss: 1.442 Test Acc: 0.481
Validation loss decreased (-0.440726 --> -0.481467).  Saving model ...
Epoch: 13 cost time: 0.49326229095458984
Epoch: 13, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.397 Vali Acc: 0.515 Test Loss: 1.397 Test Acc: 0.515
Validation loss decreased (-0.481467 --> -0.514801).  Saving model ...
Epoch: 14 cost time: 0.5176684856414795
Epoch: 14, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.352 Vali Acc: 0.537 Test Loss: 1.352 Test Acc: 0.537
Validation loss decreased (-0.514801 --> -0.537024).  Saving model ...
Epoch: 15 cost time: 0.5688381195068359
Epoch: 15, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.307 Vali Acc: 0.559 Test Loss: 1.307 Test Acc: 0.559
Validation loss decreased (-0.537024 --> -0.559246).  Saving model ...
Epoch: 16 cost time: 0.4986104965209961
Epoch: 16, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.262 Vali Acc: 0.596 Test Loss: 1.262 Test Acc: 0.596
Validation loss decreased (-0.559246 --> -0.596284).  Saving model ...
Epoch: 17 cost time: 0.5708105564117432
Epoch: 17, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.217 Vali Acc: 0.611 Test Loss: 1.217 Test Acc: 0.611
Validation loss decreased (-0.596284 --> -0.611099).  Saving model ...
Epoch: 18 cost time: 0.4775252342224121
Epoch: 18, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.173 Vali Acc: 0.644 Test Loss: 1.173 Test Acc: 0.644
Validation loss decreased (-0.611099 --> -0.644433).  Saving model ...
Epoch: 19 cost time: 0.5359616279602051
Epoch: 19, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.130 Vali Acc: 0.678 Test Loss: 1.130 Test Acc: 0.678
Validation loss decreased (-0.644433 --> -0.677766).  Saving model ...
Epoch: 20 cost time: 0.5151429176330566
Epoch: 20, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.087 Vali Acc: 0.715 Test Loss: 1.087 Test Acc: 0.715
Validation loss decreased (-0.677766 --> -0.714804).  Saving model ...
Epoch: 21 cost time: 0.47035694122314453
Epoch: 21, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.046 Vali Acc: 0.737 Test Loss: 1.046 Test Acc: 0.737
Validation loss decreased (-0.714804 --> -0.737027).  Saving model ...
Epoch: 22 cost time: 0.44800877571105957
Epoch: 22, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.005 Vali Acc: 0.770 Test Loss: 1.005 Test Acc: 0.770
Validation loss decreased (-0.737027 --> -0.770360).  Saving model ...
Epoch: 23 cost time: 0.5516564846038818
Epoch: 23, Steps: 2 | Train Loss: 0.922 Vali Loss: 0.966 Vali Acc: 0.785 Test Loss: 0.966 Test Acc: 0.785
Validation loss decreased (-0.770360 --> -0.785176).  Saving model ...
Epoch: 24 cost time: 0.5047917366027832
Epoch: 24, Steps: 2 | Train Loss: 0.969 Vali Loss: 0.928 Vali Acc: 0.793 Test Loss: 0.928 Test Acc: 0.793
Validation loss decreased (-0.785176 --> -0.792583).  Saving model ...
Epoch: 25 cost time: 0.5537757873535156
Epoch: 25, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.891 Vali Acc: 0.796 Test Loss: 0.891 Test Acc: 0.796
Validation loss decreased (-0.792583 --> -0.796287).  Saving model ...
Epoch: 26 cost time: 0.5090506076812744
Epoch: 26, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.856 Vali Acc: 0.822 Test Loss: 0.856 Test Acc: 0.822
Validation loss decreased (-0.796287 --> -0.822214).  Saving model ...
Epoch: 27 cost time: 0.4684262275695801
Epoch: 27, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.822 Vali Acc: 0.841 Test Loss: 0.822 Test Acc: 0.841
Validation loss decreased (-0.822214 --> -0.840733).  Saving model ...
Epoch: 28 cost time: 0.4249436855316162
Epoch: 28, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.790 Vali Acc: 0.841 Test Loss: 0.790 Test Acc: 0.841
Validation loss decreased (-0.840733 --> -0.840733).  Saving model ...
Epoch: 29 cost time: 0.47096824645996094
Epoch: 29, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.758 Vali Acc: 0.856 Test Loss: 0.758 Test Acc: 0.856
Validation loss decreased (-0.840733 --> -0.855548).  Saving model ...
Epoch: 30 cost time: 0.4656548500061035
Epoch: 30, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.728 Vali Acc: 0.870 Test Loss: 0.728 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870363).  Saving model ...
Epoch: 31 cost time: 0.4616658687591553
Epoch: 31, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.699 Vali Acc: 0.878 Test Loss: 0.699 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 32 cost time: 0.45860910415649414
Epoch: 32, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.671 Vali Acc: 0.881 Test Loss: 0.671 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 33 cost time: 0.5140547752380371
Epoch: 33, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.643 Vali Acc: 0.896 Test Loss: 0.643 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896290).  Saving model ...
Epoch: 34 cost time: 0.4733431339263916
Epoch: 34, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.618 Vali Acc: 0.900 Test Loss: 0.618 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 35 cost time: 0.4733397960662842
Epoch: 35, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.594 Vali Acc: 0.904 Test Loss: 0.594 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 36 cost time: 0.48749756813049316
Epoch: 36, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.571 Vali Acc: 0.907 Test Loss: 0.571 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 37 cost time: 0.41408467292785645
Epoch: 37, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.549 Vali Acc: 0.907 Test Loss: 0.549 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 38 cost time: 0.6069881916046143
Epoch: 38, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.528 Vali Acc: 0.904 Test Loss: 0.528 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4842350482940674
Epoch: 39, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.509 Vali Acc: 0.904 Test Loss: 0.509 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5065386295318604
Epoch: 40, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.492 Vali Acc: 0.911 Test Loss: 0.492 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 41 cost time: 0.4356393814086914
Epoch: 41, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.475 Vali Acc: 0.911 Test Loss: 0.475 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 42 cost time: 0.5876476764678955
Epoch: 42, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.460 Vali Acc: 0.911 Test Loss: 0.460 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 43 cost time: 0.5466592311859131
Epoch: 43, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.446 Vali Acc: 0.911 Test Loss: 0.446 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 44 cost time: 0.4742767810821533
Epoch: 44, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.433 Vali Acc: 0.907 Test Loss: 0.433 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5430378913879395
Epoch: 45, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.421 Vali Acc: 0.911 Test Loss: 0.421 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 46 cost time: 0.5231122970581055
Epoch: 46, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.410 Vali Acc: 0.911 Test Loss: 0.410 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 47 cost time: 0.48223161697387695
Epoch: 47, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.400 Vali Acc: 0.911 Test Loss: 0.400 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 48 cost time: 0.4671182632446289
Epoch: 48, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.389 Vali Acc: 0.915 Test Loss: 0.389 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 49 cost time: 0.4559304714202881
Epoch: 49, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.380 Vali Acc: 0.911 Test Loss: 0.380 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5085906982421875
Epoch: 50, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.371 Vali Acc: 0.911 Test Loss: 0.371 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5244653224945068
Epoch: 51, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.362 Vali Acc: 0.915 Test Loss: 0.362 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 52 cost time: 0.44234156608581543
Epoch: 52, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.355 Vali Acc: 0.919 Test Loss: 0.355 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 53 cost time: 0.4989888668060303
Epoch: 53, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 54 cost time: 0.4843478202819824
Epoch: 54, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 55 cost time: 0.47250914573669434
Epoch: 55, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.335 Vali Acc: 0.922 Test Loss: 0.335 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 56 cost time: 0.5864973068237305
Epoch: 56, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 57 cost time: 0.4597432613372803
Epoch: 57, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.323 Vali Acc: 0.926 Test Loss: 0.323 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 58 cost time: 0.37900805473327637
Epoch: 58, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.318 Vali Acc: 0.926 Test Loss: 0.318 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 59 cost time: 0.4789414405822754
Epoch: 59, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.313 Vali Acc: 0.926 Test Loss: 0.313 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 60 cost time: 0.38115406036376953
Epoch: 60, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.308 Vali Acc: 0.926 Test Loss: 0.308 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 61 cost time: 0.5042304992675781
Epoch: 61, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.52730393409729
Epoch: 62, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.46482157707214355
Epoch: 63, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.4904017448425293
Epoch: 64, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.295 Vali Acc: 0.922 Test Loss: 0.295 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.46948814392089844
Epoch: 65, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.293 Vali Acc: 0.926 Test Loss: 0.293 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 66 cost time: 0.5561795234680176
Epoch: 66, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.290 Vali Acc: 0.926 Test Loss: 0.290 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 67 cost time: 0.4648435115814209
Epoch: 67, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 68 cost time: 0.43631410598754883
Epoch: 68, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 69 cost time: 0.40570855140686035
Epoch: 69, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.281 Vali Acc: 0.926 Test Loss: 0.281 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 70 cost time: 0.482708215713501
Epoch: 70, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 71 cost time: 0.5201115608215332
Epoch: 71, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 72 cost time: 0.46990323066711426
Epoch: 72, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.272 Vali Acc: 0.926 Test Loss: 0.272 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 73 cost time: 0.4912292957305908
Epoch: 73, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.269 Vali Acc: 0.926 Test Loss: 0.269 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 74 cost time: 0.45490479469299316
Epoch: 74, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 75 cost time: 0.599989652633667
Epoch: 75, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.264 Vali Acc: 0.926 Test Loss: 0.264 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 76 cost time: 0.5043110847473145
Epoch: 76, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 77 cost time: 0.3796665668487549
Epoch: 77, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 78 cost time: 0.41510701179504395
Epoch: 78, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 79 cost time: 0.49132204055786133
Epoch: 79, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 80 cost time: 0.49027037620544434
Epoch: 80, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 81 cost time: 0.4612090587615967
Epoch: 81, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 82 cost time: 0.47525620460510254
Epoch: 82, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 83 cost time: 0.4816107749938965
Epoch: 83, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 84 cost time: 0.5356941223144531
Epoch: 84, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 85 cost time: 0.42106199264526367
Epoch: 85, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 86 cost time: 0.43808865547180176
Epoch: 86, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 87 cost time: 0.4057271480560303
Epoch: 87, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 88 cost time: 0.40387725830078125
Epoch: 88, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 89 cost time: 0.47887301445007324
Epoch: 89, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 90 cost time: 0.5120444297790527
Epoch: 90, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.4745936393737793
Epoch: 91, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.4458296298980713
Epoch: 92, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.4644508361816406
Epoch: 93, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.46549391746520996
Epoch: 94, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.44211268424987793
Epoch: 95, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 0.49125194549560547
Epoch: 96, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 0.5188615322113037
Epoch: 97, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 0.4354233741760254
Epoch: 98, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 0.44278812408447266
Epoch: 99, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 14806
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7835586071014404
Epoch: 1, Steps: 2 | Train Loss: 2.107 Vali Loss: 2.018 Vali Acc: 0.174 Test Loss: 2.018 Test Acc: 0.174
Validation loss decreased (inf --> -0.174054).  Saving model ...
Epoch: 2 cost time: 0.4229438304901123
Epoch: 2, Steps: 2 | Train Loss: 2.068 Vali Loss: 1.985 Vali Acc: 0.174 Test Loss: 1.985 Test Acc: 0.174
Validation loss decreased (-0.174054 --> -0.174054).  Saving model ...
Epoch: 3 cost time: 0.44412732124328613
Epoch: 3, Steps: 2 | Train Loss: 2.002 Vali Loss: 1.965 Vali Acc: 0.170 Test Loss: 1.965 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3803064823150635
Epoch: 4, Steps: 2 | Train Loss: 2.109 Vali Loss: 1.951 Vali Acc: 0.174 Test Loss: 1.951 Test Acc: 0.174
Validation loss decreased (-0.174054 --> -0.174055).  Saving model ...
Epoch: 5 cost time: 0.3975517749786377
Epoch: 5, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.935 Vali Acc: 0.178 Test Loss: 1.935 Test Acc: 0.178
Validation loss decreased (-0.174055 --> -0.177758).  Saving model ...
Epoch: 6 cost time: 0.49115872383117676
Epoch: 6, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.917 Vali Acc: 0.178 Test Loss: 1.917 Test Acc: 0.178
Validation loss decreased (-0.177758 --> -0.177759).  Saving model ...
Epoch: 7 cost time: 0.4595372676849365
Epoch: 7, Steps: 2 | Train Loss: 2.123 Vali Loss: 1.896 Vali Acc: 0.185 Test Loss: 1.896 Test Acc: 0.185
Validation loss decreased (-0.177759 --> -0.185166).  Saving model ...
Epoch: 8 cost time: 0.49866652488708496
Epoch: 8, Steps: 2 | Train Loss: 2.002 Vali Loss: 1.872 Vali Acc: 0.196 Test Loss: 1.872 Test Acc: 0.196
Validation loss decreased (-0.185166 --> -0.196278).  Saving model ...
Epoch: 9 cost time: 0.4899444580078125
Epoch: 9, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.846 Vali Acc: 0.207 Test Loss: 1.846 Test Acc: 0.207
Validation loss decreased (-0.196278 --> -0.207389).  Saving model ...
Epoch: 10 cost time: 0.4087972640991211
Epoch: 10, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.819 Vali Acc: 0.219 Test Loss: 1.819 Test Acc: 0.219
Validation loss decreased (-0.207389 --> -0.218500).  Saving model ...
Epoch: 11 cost time: 0.41994404792785645
Epoch: 11, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.790 Vali Acc: 0.244 Test Loss: 1.790 Test Acc: 0.244
Validation loss decreased (-0.218500 --> -0.244427).  Saving model ...
Epoch: 12 cost time: 0.5372953414916992
Epoch: 12, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.760 Vali Acc: 0.278 Test Loss: 1.760 Test Acc: 0.278
Validation loss decreased (-0.244427 --> -0.277760).  Saving model ...
Epoch: 13 cost time: 0.45751214027404785
Epoch: 13, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.728 Vali Acc: 0.341 Test Loss: 1.728 Test Acc: 0.341
Validation loss decreased (-0.277760 --> -0.340723).  Saving model ...
Epoch: 14 cost time: 0.48958349227905273
Epoch: 14, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.694 Vali Acc: 0.367 Test Loss: 1.694 Test Acc: 0.367
Validation loss decreased (-0.340723 --> -0.366650).  Saving model ...
Epoch: 15 cost time: 0.3899533748626709
Epoch: 15, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.661 Vali Acc: 0.389 Test Loss: 1.661 Test Acc: 0.389
Validation loss decreased (-0.366650 --> -0.388872).  Saving model ...
Epoch: 16 cost time: 0.42035627365112305
Epoch: 16, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.626 Vali Acc: 0.411 Test Loss: 1.626 Test Acc: 0.411
Validation loss decreased (-0.388872 --> -0.411095).  Saving model ...
Epoch: 17 cost time: 0.38576817512512207
Epoch: 17, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.591 Vali Acc: 0.422 Test Loss: 1.591 Test Acc: 0.422
Validation loss decreased (-0.411095 --> -0.422206).  Saving model ...
Epoch: 18 cost time: 0.42949485778808594
Epoch: 18, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.554 Vali Acc: 0.430 Test Loss: 1.554 Test Acc: 0.430
Validation loss decreased (-0.422206 --> -0.429614).  Saving model ...
Epoch: 19 cost time: 0.49147725105285645
Epoch: 19, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.516 Vali Acc: 0.444 Test Loss: 1.516 Test Acc: 0.444
Validation loss decreased (-0.429614 --> -0.444429).  Saving model ...
Epoch: 20 cost time: 0.3732025623321533
Epoch: 20, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.478 Vali Acc: 0.467 Test Loss: 1.478 Test Acc: 0.467
Validation loss decreased (-0.444429 --> -0.466652).  Saving model ...
Epoch: 21 cost time: 0.4001758098602295
Epoch: 21, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.440 Vali Acc: 0.481 Test Loss: 1.440 Test Acc: 0.481
Validation loss decreased (-0.466652 --> -0.481467).  Saving model ...
Epoch: 22 cost time: 0.4716908931732178
Epoch: 22, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.402 Vali Acc: 0.500 Test Loss: 1.402 Test Acc: 0.500
Validation loss decreased (-0.481467 --> -0.499986).  Saving model ...
Epoch: 23 cost time: 0.41021084785461426
Epoch: 23, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.365 Vali Acc: 0.530 Test Loss: 1.365 Test Acc: 0.530
Validation loss decreased (-0.499986 --> -0.529616).  Saving model ...
Epoch: 24 cost time: 0.47455358505249023
Epoch: 24, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.327 Vali Acc: 0.548 Test Loss: 1.327 Test Acc: 0.548
Validation loss decreased (-0.529616 --> -0.548135).  Saving model ...
Epoch: 25 cost time: 0.4835245609283447
Epoch: 25, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.287 Vali Acc: 0.578 Test Loss: 1.287 Test Acc: 0.578
Validation loss decreased (-0.548135 --> -0.577765).  Saving model ...
Epoch: 26 cost time: 0.4291524887084961
Epoch: 26, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.249 Vali Acc: 0.607 Test Loss: 1.249 Test Acc: 0.607
Validation loss decreased (-0.577765 --> -0.607395).  Saving model ...
Epoch: 27 cost time: 0.44082117080688477
Epoch: 27, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.211 Vali Acc: 0.622 Test Loss: 1.211 Test Acc: 0.622
Validation loss decreased (-0.607395 --> -0.622210).  Saving model ...
Epoch: 28 cost time: 0.45727038383483887
Epoch: 28, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.173 Vali Acc: 0.637 Test Loss: 1.173 Test Acc: 0.637
Validation loss decreased (-0.622210 --> -0.637025).  Saving model ...
Epoch: 29 cost time: 0.4658224582672119
Epoch: 29, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.135 Vali Acc: 0.670 Test Loss: 1.135 Test Acc: 0.670
Validation loss decreased (-0.637025 --> -0.670359).  Saving model ...
Epoch: 30 cost time: 0.4753406047821045
Epoch: 30, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.098 Vali Acc: 0.700 Test Loss: 1.098 Test Acc: 0.700
Validation loss decreased (-0.670359 --> -0.699989).  Saving model ...
Epoch: 31 cost time: 0.453869104385376
Epoch: 31, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.061 Vali Acc: 0.733 Test Loss: 1.061 Test Acc: 0.733
Validation loss decreased (-0.699989 --> -0.733323).  Saving model ...
Epoch: 32 cost time: 0.44548726081848145
Epoch: 32, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.026 Vali Acc: 0.756 Test Loss: 1.026 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755545).  Saving model ...
Epoch: 33 cost time: 0.5201623439788818
Epoch: 33, Steps: 2 | Train Loss: 1.000 Vali Loss: 0.992 Vali Acc: 0.774 Test Loss: 0.992 Test Acc: 0.774
Validation loss decreased (-0.755545 --> -0.774064).  Saving model ...
Epoch: 34 cost time: 0.43396496772766113
Epoch: 34, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.957 Vali Acc: 0.789 Test Loss: 0.957 Test Acc: 0.789
Validation loss decreased (-0.774064 --> -0.788879).  Saving model ...
Epoch: 35 cost time: 0.42047858238220215
Epoch: 35, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.923 Vali Acc: 0.804 Test Loss: 0.923 Test Acc: 0.804
Validation loss decreased (-0.788879 --> -0.803694).  Saving model ...
Epoch: 36 cost time: 0.44071173667907715
Epoch: 36, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.890 Vali Acc: 0.822 Test Loss: 0.890 Test Acc: 0.822
Validation loss decreased (-0.803694 --> -0.822213).  Saving model ...
Epoch: 37 cost time: 0.48605871200561523
Epoch: 37, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.857 Vali Acc: 0.852 Test Loss: 0.857 Test Acc: 0.852
Validation loss decreased (-0.822213 --> -0.851843).  Saving model ...
Epoch: 38 cost time: 0.4122171401977539
Epoch: 38, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.826 Vali Acc: 0.867 Test Loss: 0.826 Test Acc: 0.867
Validation loss decreased (-0.851843 --> -0.866658).  Saving model ...
Epoch: 39 cost time: 0.4291048049926758
Epoch: 39, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.795 Vali Acc: 0.874 Test Loss: 0.795 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 40 cost time: 0.4358353614807129
Epoch: 40, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.766 Vali Acc: 0.889 Test Loss: 0.766 Test Acc: 0.889
Validation loss decreased (-0.874066 --> -0.888881).  Saving model ...
Epoch: 41 cost time: 0.4556150436401367
Epoch: 41, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.738 Vali Acc: 0.889 Test Loss: 0.738 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 42 cost time: 0.4105541706085205
Epoch: 42, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.711 Vali Acc: 0.896 Test Loss: 0.711 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896289).  Saving model ...
Epoch: 43 cost time: 0.42795276641845703
Epoch: 43, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.686 Vali Acc: 0.900 Test Loss: 0.686 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 44 cost time: 0.48249268531799316
Epoch: 44, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.662 Vali Acc: 0.907 Test Loss: 0.662 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907401).  Saving model ...
Epoch: 45 cost time: 0.4122765064239502
Epoch: 45, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.641 Vali Acc: 0.915 Test Loss: 0.641 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914808).  Saving model ...
Epoch: 46 cost time: 0.4183621406555176
Epoch: 46, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.619 Vali Acc: 0.926 Test Loss: 0.619 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925920).  Saving model ...
Epoch: 47 cost time: 0.44084763526916504
Epoch: 47, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.599 Vali Acc: 0.922 Test Loss: 0.599 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.41797590255737305
Epoch: 48, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.580 Vali Acc: 0.919 Test Loss: 0.580 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4081606864929199
Epoch: 49, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.563 Vali Acc: 0.922 Test Loss: 0.563 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.4543631076812744
Epoch: 50, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.546 Vali Acc: 0.926 Test Loss: 0.546 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 51 cost time: 0.42789769172668457
Epoch: 51, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.531 Vali Acc: 0.930 Test Loss: 0.531 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 52 cost time: 0.4900987148284912
Epoch: 52, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.517 Vali Acc: 0.930 Test Loss: 0.517 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 53 cost time: 0.5177872180938721
Epoch: 53, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.503 Vali Acc: 0.930 Test Loss: 0.503 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 54 cost time: 0.4326512813568115
Epoch: 54, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.491 Vali Acc: 0.930 Test Loss: 0.491 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 55 cost time: 0.46312761306762695
Epoch: 55, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.479 Vali Acc: 0.937 Test Loss: 0.479 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937032).  Saving model ...
Epoch: 56 cost time: 0.4609792232513428
Epoch: 56, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.468 Vali Acc: 0.941 Test Loss: 0.468 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 57 cost time: 0.38820958137512207
Epoch: 57, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.457 Vali Acc: 0.941 Test Loss: 0.457 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 58 cost time: 0.3883349895477295
Epoch: 58, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.448 Vali Acc: 0.941 Test Loss: 0.448 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 59 cost time: 0.4785740375518799
Epoch: 59, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.439 Vali Acc: 0.941 Test Loss: 0.439 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 60 cost time: 0.46207690238952637
Epoch: 60, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.430 Vali Acc: 0.941 Test Loss: 0.430 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 61 cost time: 0.3998262882232666
Epoch: 61, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.422 Vali Acc: 0.941 Test Loss: 0.422 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 62 cost time: 0.440601110458374
Epoch: 62, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.414 Vali Acc: 0.941 Test Loss: 0.414 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 63 cost time: 0.4857137203216553
Epoch: 63, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.407 Vali Acc: 0.933 Test Loss: 0.407 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.4181785583496094
Epoch: 64, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.400 Vali Acc: 0.933 Test Loss: 0.400 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.405987024307251
Epoch: 65, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.393 Vali Acc: 0.933 Test Loss: 0.393 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.42505383491516113
Epoch: 66, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.387 Vali Acc: 0.933 Test Loss: 0.387 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.40792250633239746
Epoch: 67, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.381 Vali Acc: 0.933 Test Loss: 0.381 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.3950669765472412
Epoch: 68, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.376 Vali Acc: 0.933 Test Loss: 0.376 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.4803280830383301
Epoch: 69, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.371 Vali Acc: 0.933 Test Loss: 0.371 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.3717329502105713
Epoch: 70, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.367 Vali Acc: 0.930 Test Loss: 0.367 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.4434812068939209
Epoch: 71, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.361 Vali Acc: 0.930 Test Loss: 0.361 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.5080585479736328
Epoch: 72, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.357 Vali Acc: 0.930 Test Loss: 0.357 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 13318
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9514997005462646
Epoch: 1, Steps: 2 | Train Loss: 2.055 Vali Loss: 2.113 Vali Acc: 0.030 Test Loss: 2.113 Test Acc: 0.030
Validation loss decreased (inf --> -0.029609).  Saving model ...
Epoch: 2 cost time: 0.40982532501220703
Epoch: 2, Steps: 2 | Train Loss: 1.941 Vali Loss: 2.059 Vali Acc: 0.033 Test Loss: 2.059 Test Acc: 0.033
Validation loss decreased (-0.029609 --> -0.033313).  Saving model ...
Epoch: 3 cost time: 0.5112593173980713
Epoch: 3, Steps: 2 | Train Loss: 1.939 Vali Loss: 2.020 Vali Acc: 0.033 Test Loss: 2.020 Test Acc: 0.033
Validation loss decreased (-0.033313 --> -0.033313).  Saving model ...
Epoch: 4 cost time: 0.38718533515930176
Epoch: 4, Steps: 2 | Train Loss: 2.015 Vali Loss: 1.991 Vali Acc: 0.044 Test Loss: 1.991 Test Acc: 0.044
Validation loss decreased (-0.033313 --> -0.044425).  Saving model ...
Epoch: 5 cost time: 0.42287588119506836
Epoch: 5, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.964 Vali Acc: 0.048 Test Loss: 1.964 Test Acc: 0.048
Validation loss decreased (-0.044425 --> -0.048129).  Saving model ...
Epoch: 6 cost time: 0.5128512382507324
Epoch: 6, Steps: 2 | Train Loss: 1.967 Vali Loss: 1.937 Vali Acc: 0.052 Test Loss: 1.937 Test Acc: 0.052
Validation loss decreased (-0.048129 --> -0.051832).  Saving model ...
Epoch: 7 cost time: 0.41455936431884766
Epoch: 7, Steps: 2 | Train Loss: 2.025 Vali Loss: 1.911 Vali Acc: 0.063 Test Loss: 1.911 Test Acc: 0.063
Validation loss decreased (-0.051832 --> -0.062944).  Saving model ...
Epoch: 8 cost time: 0.4597957134246826
Epoch: 8, Steps: 2 | Train Loss: 1.930 Vali Loss: 1.884 Vali Acc: 0.070 Test Loss: 1.884 Test Acc: 0.070
Validation loss decreased (-0.062944 --> -0.070352).  Saving model ...
Epoch: 9 cost time: 0.4466686248779297
Epoch: 9, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.856 Vali Acc: 0.085 Test Loss: 1.856 Test Acc: 0.085
Validation loss decreased (-0.070352 --> -0.085167).  Saving model ...
Epoch: 10 cost time: 0.43775248527526855
Epoch: 10, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.827 Vali Acc: 0.104 Test Loss: 1.827 Test Acc: 0.104
Validation loss decreased (-0.085167 --> -0.103685).  Saving model ...
Epoch: 11 cost time: 0.5001897811889648
Epoch: 11, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.797 Vali Acc: 0.152 Test Loss: 1.797 Test Acc: 0.152
Validation loss decreased (-0.103685 --> -0.151834).  Saving model ...
Epoch: 12 cost time: 0.4306509494781494
Epoch: 12, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.766 Vali Acc: 0.204 Test Loss: 1.766 Test Acc: 0.204
Validation loss decreased (-0.151834 --> -0.203686).  Saving model ...
Epoch: 13 cost time: 0.4732959270477295
Epoch: 13, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.734 Vali Acc: 0.244 Test Loss: 1.734 Test Acc: 0.244
Validation loss decreased (-0.203686 --> -0.244427).  Saving model ...
Epoch: 14 cost time: 0.43000364303588867
Epoch: 14, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.701 Vali Acc: 0.285 Test Loss: 1.701 Test Acc: 0.285
Validation loss decreased (-0.244427 --> -0.285168).  Saving model ...
Epoch: 15 cost time: 0.4355008602142334
Epoch: 15, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.668 Vali Acc: 0.326 Test Loss: 1.668 Test Acc: 0.326
Validation loss decreased (-0.285168 --> -0.325909).  Saving model ...
Epoch: 16 cost time: 0.5280261039733887
Epoch: 16, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.635 Vali Acc: 0.341 Test Loss: 1.635 Test Acc: 0.341
Validation loss decreased (-0.325909 --> -0.340724).  Saving model ...
Epoch: 17 cost time: 0.503781795501709
Epoch: 17, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.601 Vali Acc: 0.367 Test Loss: 1.601 Test Acc: 0.367
Validation loss decreased (-0.340724 --> -0.366651).  Saving model ...
Epoch: 18 cost time: 0.46959352493286133
Epoch: 18, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.567 Vali Acc: 0.404 Test Loss: 1.567 Test Acc: 0.404
Validation loss decreased (-0.366651 --> -0.403688).  Saving model ...
Epoch: 19 cost time: 0.48183608055114746
Epoch: 19, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.533 Vali Acc: 0.441 Test Loss: 1.533 Test Acc: 0.441
Validation loss decreased (-0.403688 --> -0.440725).  Saving model ...
Epoch: 20 cost time: 0.4188368320465088
Epoch: 20, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.500 Vali Acc: 0.481 Test Loss: 1.500 Test Acc: 0.481
Validation loss decreased (-0.440725 --> -0.481466).  Saving model ...
Epoch: 21 cost time: 0.4519987106323242
Epoch: 21, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.466 Vali Acc: 0.519 Test Loss: 1.466 Test Acc: 0.519
Validation loss decreased (-0.481466 --> -0.518504).  Saving model ...
Epoch: 22 cost time: 0.4787275791168213
Epoch: 22, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.432 Vali Acc: 0.563 Test Loss: 1.432 Test Acc: 0.563
Validation loss decreased (-0.518504 --> -0.562949).  Saving model ...
Epoch: 23 cost time: 0.45780229568481445
Epoch: 23, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.398 Vali Acc: 0.581 Test Loss: 1.398 Test Acc: 0.581
Validation loss decreased (-0.562949 --> -0.581468).  Saving model ...
Epoch: 24 cost time: 0.426041841506958
Epoch: 24, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.363 Vali Acc: 0.589 Test Loss: 1.363 Test Acc: 0.589
Validation loss decreased (-0.581468 --> -0.588875).  Saving model ...
Epoch: 25 cost time: 0.45019054412841797
Epoch: 25, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.330 Vali Acc: 0.611 Test Loss: 1.330 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611098).  Saving model ...
Epoch: 26 cost time: 0.4227883815765381
Epoch: 26, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.296 Vali Acc: 0.633 Test Loss: 1.296 Test Acc: 0.633
Validation loss decreased (-0.611098 --> -0.633320).  Saving model ...
Epoch: 27 cost time: 0.4423668384552002
Epoch: 27, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.263 Vali Acc: 0.656 Test Loss: 1.263 Test Acc: 0.656
Validation loss decreased (-0.633320 --> -0.655543).  Saving model ...
Epoch: 28 cost time: 0.43543314933776855
Epoch: 28, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.230 Vali Acc: 0.685 Test Loss: 1.230 Test Acc: 0.685
Validation loss decreased (-0.655543 --> -0.685173).  Saving model ...
Epoch: 29 cost time: 0.5363800525665283
Epoch: 29, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.197 Vali Acc: 0.696 Test Loss: 1.197 Test Acc: 0.696
Validation loss decreased (-0.685173 --> -0.696284).  Saving model ...
Epoch: 30 cost time: 0.4755525588989258
Epoch: 30, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.164 Vali Acc: 0.711 Test Loss: 1.164 Test Acc: 0.711
Validation loss decreased (-0.696284 --> -0.711099).  Saving model ...
Epoch: 31 cost time: 0.4599888324737549
Epoch: 31, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.132 Vali Acc: 0.730 Test Loss: 1.132 Test Acc: 0.730
Validation loss decreased (-0.711099 --> -0.729618).  Saving model ...
Epoch: 32 cost time: 0.46979546546936035
Epoch: 32, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.100 Vali Acc: 0.730 Test Loss: 1.100 Test Acc: 0.730
Validation loss decreased (-0.729618 --> -0.729619).  Saving model ...
Epoch: 33 cost time: 0.5385499000549316
Epoch: 33, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.070 Vali Acc: 0.737 Test Loss: 1.070 Test Acc: 0.737
Validation loss decreased (-0.729619 --> -0.737026).  Saving model ...
Epoch: 34 cost time: 0.4439358711242676
Epoch: 34, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.039 Vali Acc: 0.748 Test Loss: 1.039 Test Acc: 0.748
Validation loss decreased (-0.737026 --> -0.748138).  Saving model ...
Epoch: 35 cost time: 0.4513702392578125
Epoch: 35, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.009 Vali Acc: 0.767 Test Loss: 1.009 Test Acc: 0.767
Validation loss decreased (-0.748138 --> -0.766657).  Saving model ...
Epoch: 36 cost time: 0.5043022632598877
Epoch: 36, Steps: 2 | Train Loss: 1.066 Vali Loss: 0.980 Vali Acc: 0.774 Test Loss: 0.980 Test Acc: 0.774
Validation loss decreased (-0.766657 --> -0.774064).  Saving model ...
Epoch: 37 cost time: 0.4875175952911377
Epoch: 37, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.951 Vali Acc: 0.796 Test Loss: 0.951 Test Acc: 0.796
Validation loss decreased (-0.774064 --> -0.796287).  Saving model ...
Epoch: 38 cost time: 0.4783473014831543
Epoch: 38, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.922 Vali Acc: 0.807 Test Loss: 0.922 Test Acc: 0.807
Validation loss decreased (-0.796287 --> -0.807398).  Saving model ...
Epoch: 39 cost time: 0.46764183044433594
Epoch: 39, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.895 Vali Acc: 0.811 Test Loss: 0.895 Test Acc: 0.811
Validation loss decreased (-0.807398 --> -0.811102).  Saving model ...
Epoch: 40 cost time: 0.4812183380126953
Epoch: 40, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.869 Vali Acc: 0.826 Test Loss: 0.869 Test Acc: 0.826
Validation loss decreased (-0.811102 --> -0.825917).  Saving model ...
Epoch: 41 cost time: 0.46799397468566895
Epoch: 41, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.845 Vali Acc: 0.833 Test Loss: 0.845 Test Acc: 0.833
Validation loss decreased (-0.825917 --> -0.833325).  Saving model ...
Epoch: 42 cost time: 0.4504268169403076
Epoch: 42, Steps: 2 | Train Loss: 0.791 Vali Loss: 0.819 Vali Acc: 0.837 Test Loss: 0.819 Test Acc: 0.837
Validation loss decreased (-0.833325 --> -0.837029).  Saving model ...
Epoch: 43 cost time: 0.4231429100036621
Epoch: 43, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.795 Vali Acc: 0.841 Test Loss: 0.795 Test Acc: 0.841
Validation loss decreased (-0.837029 --> -0.840733).  Saving model ...
Epoch: 44 cost time: 0.46747350692749023
Epoch: 44, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.771 Vali Acc: 0.859 Test Loss: 0.771 Test Acc: 0.859
Validation loss decreased (-0.840733 --> -0.859252).  Saving model ...
Epoch: 45 cost time: 0.456188440322876
Epoch: 45, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.747 Vali Acc: 0.867 Test Loss: 0.747 Test Acc: 0.867
Validation loss decreased (-0.859252 --> -0.866659).  Saving model ...
Epoch: 46 cost time: 0.48299694061279297
Epoch: 46, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.724 Vali Acc: 0.870 Test Loss: 0.724 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 47 cost time: 0.4087550640106201
Epoch: 47, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.703 Vali Acc: 0.874 Test Loss: 0.703 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 48 cost time: 0.5523848533630371
Epoch: 48, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.683 Vali Acc: 0.878 Test Loss: 0.683 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877771).  Saving model ...
Epoch: 49 cost time: 0.5068516731262207
Epoch: 49, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.664 Vali Acc: 0.878 Test Loss: 0.664 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 50 cost time: 0.4621453285217285
Epoch: 50, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.646 Vali Acc: 0.881 Test Loss: 0.646 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 51 cost time: 0.48641085624694824
Epoch: 51, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.629 Vali Acc: 0.893 Test Loss: 0.629 Test Acc: 0.893
Validation loss decreased (-0.881475 --> -0.892586).  Saving model ...
Epoch: 52 cost time: 0.42710137367248535
Epoch: 52, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.611 Vali Acc: 0.889 Test Loss: 0.611 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5090579986572266
Epoch: 53, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.595 Vali Acc: 0.893 Test Loss: 0.595 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 54 cost time: 0.5233566761016846
Epoch: 54, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.581 Vali Acc: 0.896 Test Loss: 0.581 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896290).  Saving model ...
Epoch: 55 cost time: 0.4855844974517822
Epoch: 55, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.567 Vali Acc: 0.896 Test Loss: 0.567 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896291).  Saving model ...
Epoch: 56 cost time: 0.49432969093322754
Epoch: 56, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.552 Vali Acc: 0.896 Test Loss: 0.552 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 57 cost time: 0.48248767852783203
Epoch: 57, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.539 Vali Acc: 0.893 Test Loss: 0.539 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5505027770996094
Epoch: 58, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.527 Vali Acc: 0.907 Test Loss: 0.527 Test Acc: 0.907
Validation loss decreased (-0.896291 --> -0.907402).  Saving model ...
Epoch: 59 cost time: 0.45688772201538086
Epoch: 59, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.514 Vali Acc: 0.911 Test Loss: 0.514 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 60 cost time: 0.41240692138671875
Epoch: 60, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.503 Vali Acc: 0.919 Test Loss: 0.503 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918513).  Saving model ...
Epoch: 61 cost time: 0.46946287155151367
Epoch: 61, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.492 Vali Acc: 0.919 Test Loss: 0.492 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 62 cost time: 0.48301124572753906
Epoch: 62, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.481 Vali Acc: 0.919 Test Loss: 0.481 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 63 cost time: 0.47867608070373535
Epoch: 63, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.471 Vali Acc: 0.919 Test Loss: 0.471 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 64 cost time: 0.4760136604309082
Epoch: 64, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.461 Vali Acc: 0.919 Test Loss: 0.461 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 65 cost time: 0.4972360134124756
Epoch: 65, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.452 Vali Acc: 0.922 Test Loss: 0.452 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 66 cost time: 0.4213416576385498
Epoch: 66, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.443 Vali Acc: 0.926 Test Loss: 0.443 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925921).  Saving model ...
Epoch: 67 cost time: 0.4580259323120117
Epoch: 67, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.435 Vali Acc: 0.930 Test Loss: 0.435 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 68 cost time: 0.46077895164489746
Epoch: 68, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.428 Vali Acc: 0.930 Test Loss: 0.428 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 69 cost time: 0.4975903034210205
Epoch: 69, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.421 Vali Acc: 0.933 Test Loss: 0.421 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 70 cost time: 0.47411394119262695
Epoch: 70, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.414 Vali Acc: 0.933 Test Loss: 0.414 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 71 cost time: 0.46126222610473633
Epoch: 71, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.407 Vali Acc: 0.933 Test Loss: 0.407 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 72 cost time: 0.47536778450012207
Epoch: 72, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.401 Vali Acc: 0.933 Test Loss: 0.401 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 73 cost time: 0.4951605796813965
Epoch: 73, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.395 Vali Acc: 0.933 Test Loss: 0.395 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 74 cost time: 0.4441511631011963
Epoch: 74, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.389 Vali Acc: 0.933 Test Loss: 0.389 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 75 cost time: 0.40657496452331543
Epoch: 75, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.383 Vali Acc: 0.933 Test Loss: 0.383 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 76 cost time: 0.42366981506347656
Epoch: 76, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.378 Vali Acc: 0.933 Test Loss: 0.378 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 77 cost time: 0.400437593460083
Epoch: 77, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.372 Vali Acc: 0.933 Test Loss: 0.372 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 78 cost time: 0.4391303062438965
Epoch: 78, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.366 Vali Acc: 0.933 Test Loss: 0.366 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 79 cost time: 0.45323610305786133
Epoch: 79, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.361 Vali Acc: 0.933 Test Loss: 0.361 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 80 cost time: 0.39184045791625977
Epoch: 80, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.356 Vali Acc: 0.933 Test Loss: 0.356 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 81 cost time: 0.4319329261779785
Epoch: 81, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.352 Vali Acc: 0.937 Test Loss: 0.352 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 82 cost time: 0.4370131492614746
Epoch: 82, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.348 Vali Acc: 0.937 Test Loss: 0.348 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 83 cost time: 0.4246978759765625
Epoch: 83, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.343 Vali Acc: 0.937 Test Loss: 0.343 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 84 cost time: 0.4407675266265869
Epoch: 84, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.339 Vali Acc: 0.937 Test Loss: 0.339 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 85 cost time: 0.48830604553222656
Epoch: 85, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.335 Vali Acc: 0.937 Test Loss: 0.335 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 86 cost time: 0.4145355224609375
Epoch: 86, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.331 Vali Acc: 0.937 Test Loss: 0.331 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 87 cost time: 0.4619472026824951
Epoch: 87, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.328 Vali Acc: 0.941 Test Loss: 0.328 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940737).  Saving model ...
Epoch: 88 cost time: 0.4592299461364746
Epoch: 88, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 89 cost time: 0.4384267330169678
Epoch: 89, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.320 Vali Acc: 0.941 Test Loss: 0.320 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 90 cost time: 0.42746925354003906
Epoch: 90, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.317 Vali Acc: 0.941 Test Loss: 0.317 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 91 cost time: 0.5067436695098877
Epoch: 91, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.314 Vali Acc: 0.941 Test Loss: 0.314 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 92 cost time: 0.4299747943878174
Epoch: 92, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.311 Vali Acc: 0.941 Test Loss: 0.311 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 93 cost time: 0.41852331161499023
Epoch: 93, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.307 Vali Acc: 0.941 Test Loss: 0.307 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 94 cost time: 0.41204309463500977
Epoch: 94, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 95 cost time: 0.5408957004547119
Epoch: 95, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 96 cost time: 0.4238855838775635
Epoch: 96, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 97 cost time: 0.4723677635192871
Epoch: 97, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.297 Vali Acc: 0.941 Test Loss: 0.297 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.5091440677642822
Epoch: 98, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.4435863494873047
Epoch: 99, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.5752706527709961
Epoch: 100, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.289 Vali Acc: 0.941 Test Loss: 0.289 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 12614
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8257627487182617
Epoch: 1, Steps: 2 | Train Loss: 2.094 Vali Loss: 2.015 Vali Acc: 0.067 Test Loss: 2.015 Test Acc: 0.067
Validation loss decreased (inf --> -0.066647).  Saving model ...
Epoch: 2 cost time: 0.3990139961242676
Epoch: 2, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.960 Vali Acc: 0.070 Test Loss: 1.960 Test Acc: 0.070
Validation loss decreased (-0.066647 --> -0.070351).  Saving model ...
Epoch: 3 cost time: 0.40323972702026367
Epoch: 3, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.908 Vali Acc: 0.078 Test Loss: 1.908 Test Acc: 0.078
Validation loss decreased (-0.070351 --> -0.077759).  Saving model ...
Epoch: 4 cost time: 0.38513755798339844
Epoch: 4, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.843 Vali Acc: 0.085 Test Loss: 1.843 Test Acc: 0.085
Validation loss decreased (-0.077759 --> -0.085167).  Saving model ...
Epoch: 5 cost time: 0.5112936496734619
Epoch: 5, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.758 Vali Acc: 0.115 Test Loss: 1.758 Test Acc: 0.115
Validation loss decreased (-0.085167 --> -0.114797).  Saving model ...
Epoch: 6 cost time: 0.44013404846191406
Epoch: 6, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.663 Vali Acc: 0.241 Test Loss: 1.663 Test Acc: 0.241
Validation loss decreased (-0.114797 --> -0.240724).  Saving model ...
Epoch: 7 cost time: 0.4808518886566162
Epoch: 7, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.558 Vali Acc: 0.381 Test Loss: 1.558 Test Acc: 0.381
Validation loss decreased (-0.240724 --> -0.381466).  Saving model ...
Epoch: 8 cost time: 0.415132999420166
Epoch: 8, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.447 Vali Acc: 0.541 Test Loss: 1.447 Test Acc: 0.541
Validation loss decreased (-0.381466 --> -0.540726).  Saving model ...
Epoch: 9 cost time: 0.5272421836853027
Epoch: 9, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.334 Vali Acc: 0.648 Test Loss: 1.334 Test Acc: 0.648
Validation loss decreased (-0.540726 --> -0.648135).  Saving model ...
Epoch: 10 cost time: 0.47088170051574707
Epoch: 10, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.221 Vali Acc: 0.696 Test Loss: 1.221 Test Acc: 0.696
Validation loss decreased (-0.648135 --> -0.696284).  Saving model ...
Epoch: 11 cost time: 0.4287252426147461
Epoch: 11, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.114 Vali Acc: 0.715 Test Loss: 1.114 Test Acc: 0.715
Validation loss decreased (-0.696284 --> -0.714804).  Saving model ...
Epoch: 12 cost time: 0.4083237648010254
Epoch: 12, Steps: 2 | Train Loss: 0.878 Vali Loss: 1.012 Vali Acc: 0.748 Test Loss: 1.012 Test Acc: 0.748
Validation loss decreased (-0.714804 --> -0.748138).  Saving model ...
Epoch: 13 cost time: 0.47536468505859375
Epoch: 13, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.920 Vali Acc: 0.767 Test Loss: 0.920 Test Acc: 0.767
Validation loss decreased (-0.748138 --> -0.766657).  Saving model ...
Epoch: 14 cost time: 0.4591667652130127
Epoch: 14, Steps: 2 | Train Loss: 0.848 Vali Loss: 0.837 Vali Acc: 0.785 Test Loss: 0.837 Test Acc: 0.785
Validation loss decreased (-0.766657 --> -0.785177).  Saving model ...
Epoch: 15 cost time: 0.4215729236602783
Epoch: 15, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.765 Vali Acc: 0.807 Test Loss: 0.765 Test Acc: 0.807
Validation loss decreased (-0.785177 --> -0.807400).  Saving model ...
Epoch: 16 cost time: 0.5685245990753174
Epoch: 16, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.700 Vali Acc: 0.833 Test Loss: 0.700 Test Acc: 0.833
Validation loss decreased (-0.807400 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 0.4417228698730469
Epoch: 17, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.641 Vali Acc: 0.841 Test Loss: 0.641 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840734).  Saving model ...
Epoch: 18 cost time: 0.43375492095947266
Epoch: 18, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
Validation loss decreased (-0.840734 --> -0.855550).  Saving model ...
Epoch: 19 cost time: 0.4511275291442871
Epoch: 19, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 0.49104976654052734
Epoch: 20, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 21 cost time: 0.3965263366699219
Epoch: 21, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.469 Vali Acc: 0.885 Test Loss: 0.469 Test Acc: 0.885
Validation loss decreased (-0.877773 --> -0.885180).  Saving model ...
Epoch: 22 cost time: 0.5102002620697021
Epoch: 22, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.437 Vali Acc: 0.885 Test Loss: 0.437 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885181).  Saving model ...
Epoch: 23 cost time: 0.38637256622314453
Epoch: 23, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
Validation loss decreased (-0.885181 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.4259345531463623
Epoch: 24, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.380 Vali Acc: 0.904 Test Loss: 0.380 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 25 cost time: 0.4668004512786865
Epoch: 25, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.356 Vali Acc: 0.907 Test Loss: 0.356 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 26 cost time: 0.4743356704711914
Epoch: 26, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.335 Vali Acc: 0.919 Test Loss: 0.335 Test Acc: 0.919
Validation loss decreased (-0.907404 --> -0.918515).  Saving model ...
Epoch: 27 cost time: 0.4922969341278076
Epoch: 27, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.317 Vali Acc: 0.919 Test Loss: 0.317 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 28 cost time: 0.472581148147583
Epoch: 28, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.301 Vali Acc: 0.915 Test Loss: 0.301 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.3865485191345215
Epoch: 29, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4447174072265625
Epoch: 30, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4494788646697998
Epoch: 31, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.266 Vali Acc: 0.919 Test Loss: 0.266 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 32 cost time: 0.453732967376709
Epoch: 32, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.253 Vali Acc: 0.915 Test Loss: 0.253 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.46570467948913574
Epoch: 33, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 34 cost time: 0.4416623115539551
Epoch: 34, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 35 cost time: 0.4872119426727295
Epoch: 35, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 36 cost time: 0.47984790802001953
Epoch: 36, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 37 cost time: 0.49287962913513184
Epoch: 37, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.223 Vali Acc: 0.919 Test Loss: 0.223 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4024374485015869
Epoch: 38, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 39 cost time: 0.46708035469055176
Epoch: 39, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 40 cost time: 0.4994781017303467
Epoch: 40, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 41 cost time: 0.450148344039917
Epoch: 41, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 42 cost time: 0.539609432220459
Epoch: 42, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 43 cost time: 0.4155764579772949
Epoch: 43, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.41195201873779297
Epoch: 44, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.41796064376831055
Epoch: 45, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.4570744037628174
Epoch: 46, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.42145681381225586
Epoch: 47, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.43750476837158203
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.4645044803619385
Epoch: 49, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.551659107208252
Epoch: 50, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.5262768268585205
Epoch: 51, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.5383045673370361
Epoch: 52, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 30422
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.672541618347168
Epoch: 1, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.912 Vali Acc: 0.226 Test Loss: 1.912 Test Acc: 0.226
Validation loss decreased (inf --> -0.225907).  Saving model ...
Epoch: 2 cost time: 0.43772459030151367
Epoch: 2, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.845 Vali Acc: 0.333 Test Loss: 1.845 Test Acc: 0.333
Validation loss decreased (-0.225907 --> -0.333315).  Saving model ...
Epoch: 3 cost time: 0.4169609546661377
Epoch: 3, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.794 Vali Acc: 0.378 Test Loss: 1.794 Test Acc: 0.378
Validation loss decreased (-0.333315 --> -0.377760).  Saving model ...
Epoch: 4 cost time: 0.3924238681793213
Epoch: 4, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.750 Vali Acc: 0.381 Test Loss: 1.750 Test Acc: 0.381
Validation loss decreased (-0.377760 --> -0.381464).  Saving model ...
Epoch: 5 cost time: 0.4941885471343994
Epoch: 5, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.699 Vali Acc: 0.400 Test Loss: 1.699 Test Acc: 0.400
Validation loss decreased (-0.381464 --> -0.399983).  Saving model ...
Epoch: 6 cost time: 0.5129492282867432
Epoch: 6, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.644 Vali Acc: 0.411 Test Loss: 1.644 Test Acc: 0.411
Validation loss decreased (-0.399983 --> -0.411095).  Saving model ...
Epoch: 7 cost time: 0.4319601058959961
Epoch: 7, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.585 Vali Acc: 0.415 Test Loss: 1.585 Test Acc: 0.415
Validation loss decreased (-0.411095 --> -0.414799).  Saving model ...
Epoch: 8 cost time: 0.3963782787322998
Epoch: 8, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.523 Vali Acc: 0.444 Test Loss: 1.523 Test Acc: 0.444
Validation loss decreased (-0.414799 --> -0.444429).  Saving model ...
Epoch: 9 cost time: 0.49771595001220703
Epoch: 9, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.459 Vali Acc: 0.474 Test Loss: 1.459 Test Acc: 0.474
Validation loss decreased (-0.444429 --> -0.474059).  Saving model ...
Epoch: 10 cost time: 0.4071624279022217
Epoch: 10, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.394 Vali Acc: 0.511 Test Loss: 1.394 Test Acc: 0.511
Validation loss decreased (-0.474059 --> -0.511097).  Saving model ...
Epoch: 11 cost time: 0.48618364334106445
Epoch: 11, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.329 Vali Acc: 0.544 Test Loss: 1.329 Test Acc: 0.544
Validation loss decreased (-0.511097 --> -0.544431).  Saving model ...
Epoch: 12 cost time: 0.5144083499908447
Epoch: 12, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.264 Vali Acc: 0.593 Test Loss: 1.264 Test Acc: 0.593
Validation loss decreased (-0.544431 --> -0.592580).  Saving model ...
Epoch: 13 cost time: 0.5138905048370361
Epoch: 13, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.199 Vali Acc: 0.641 Test Loss: 1.199 Test Acc: 0.641
Validation loss decreased (-0.592580 --> -0.640729).  Saving model ...
Epoch: 14 cost time: 0.45215535163879395
Epoch: 14, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.136 Vali Acc: 0.689 Test Loss: 1.136 Test Acc: 0.689
Validation loss decreased (-0.640729 --> -0.688878).  Saving model ...
Epoch: 15 cost time: 0.39269542694091797
Epoch: 15, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.075 Vali Acc: 0.730 Test Loss: 1.075 Test Acc: 0.730
Validation loss decreased (-0.688878 --> -0.729619).  Saving model ...
Epoch: 16 cost time: 0.41728973388671875
Epoch: 16, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.016 Vali Acc: 0.770 Test Loss: 1.016 Test Acc: 0.770
Validation loss decreased (-0.729619 --> -0.770360).  Saving model ...
Epoch: 17 cost time: 0.4129674434661865
Epoch: 17, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.960 Vali Acc: 0.796 Test Loss: 0.960 Test Acc: 0.796
Validation loss decreased (-0.770360 --> -0.796287).  Saving model ...
Epoch: 18 cost time: 0.5237581729888916
Epoch: 18, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.906 Vali Acc: 0.822 Test Loss: 0.906 Test Acc: 0.822
Validation loss decreased (-0.796287 --> -0.822213).  Saving model ...
Epoch: 19 cost time: 0.42989444732666016
Epoch: 19, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.853 Vali Acc: 0.830 Test Loss: 0.853 Test Acc: 0.830
Validation loss decreased (-0.822213 --> -0.829621).  Saving model ...
Epoch: 20 cost time: 0.46934938430786133
Epoch: 20, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.802 Vali Acc: 0.856 Test Loss: 0.802 Test Acc: 0.856
Validation loss decreased (-0.829621 --> -0.855548).  Saving model ...
Epoch: 21 cost time: 0.4811413288116455
Epoch: 21, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.754 Vali Acc: 0.859 Test Loss: 0.754 Test Acc: 0.859
Validation loss decreased (-0.855548 --> -0.859252).  Saving model ...
Epoch: 22 cost time: 0.3902256488800049
Epoch: 22, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.709 Vali Acc: 0.863 Test Loss: 0.709 Test Acc: 0.863
Validation loss decreased (-0.859252 --> -0.862956).  Saving model ...
Epoch: 23 cost time: 0.4000701904296875
Epoch: 23, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.667 Vali Acc: 0.870 Test Loss: 0.667 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870364).  Saving model ...
Epoch: 24 cost time: 0.42191123962402344
Epoch: 24, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.628 Vali Acc: 0.874 Test Loss: 0.628 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 25 cost time: 0.4628634452819824
Epoch: 25, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.591 Vali Acc: 0.881 Test Loss: 0.591 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 26 cost time: 0.4911844730377197
Epoch: 26, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.556 Vali Acc: 0.885 Test Loss: 0.556 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 27 cost time: 0.4466547966003418
Epoch: 27, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.524 Vali Acc: 0.900 Test Loss: 0.524 Test Acc: 0.900
Validation loss decreased (-0.885180 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.4590914249420166
Epoch: 28, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.495 Vali Acc: 0.904 Test Loss: 0.495 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 29 cost time: 0.4720726013183594
Epoch: 29, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.466 Vali Acc: 0.915 Test Loss: 0.466 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914810).  Saving model ...
Epoch: 30 cost time: 0.4460132122039795
Epoch: 30, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.441 Vali Acc: 0.915 Test Loss: 0.441 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 31 cost time: 0.4415462017059326
Epoch: 31, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.418 Vali Acc: 0.915 Test Loss: 0.418 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.4198031425476074
Epoch: 32, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.399 Vali Acc: 0.919 Test Loss: 0.399 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 33 cost time: 0.4727764129638672
Epoch: 33, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 34 cost time: 0.4819159507751465
Epoch: 34, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.365 Vali Acc: 0.919 Test Loss: 0.365 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 35 cost time: 0.4783661365509033
Epoch: 35, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.350 Vali Acc: 0.919 Test Loss: 0.350 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 36 cost time: 0.4196150302886963
Epoch: 36, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.333 Vali Acc: 0.915 Test Loss: 0.333 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5185947418212891
Epoch: 37, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.320 Vali Acc: 0.915 Test Loss: 0.320 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4300498962402344
Epoch: 38, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 39 cost time: 0.48903870582580566
Epoch: 39, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 40 cost time: 0.46326613426208496
Epoch: 40, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922219).  Saving model ...
Epoch: 41 cost time: 0.4664311408996582
Epoch: 41, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.276 Vali Acc: 0.926 Test Loss: 0.276 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 42 cost time: 0.4632604122161865
Epoch: 42, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.4788236618041992
Epoch: 43, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4376051425933838
Epoch: 44, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.4870584011077881
Epoch: 45, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.45618748664855957
Epoch: 46, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.4883744716644287
Epoch: 47, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.41760849952697754
Epoch: 48, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 49 cost time: 0.42842745780944824
Epoch: 49, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 50 cost time: 0.4771425724029541
Epoch: 50, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 51 cost time: 0.44316697120666504
Epoch: 51, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 52 cost time: 0.44237279891967773
Epoch: 52, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 53 cost time: 0.42331862449645996
Epoch: 53, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 54 cost time: 0.51247239112854
Epoch: 54, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 55 cost time: 0.4698190689086914
Epoch: 55, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 56 cost time: 0.559211015701294
Epoch: 56, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.46962690353393555
Epoch: 57, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.4786226749420166
Epoch: 58, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 59 cost time: 0.4963252544403076
Epoch: 59, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 60 cost time: 0.45337629318237305
Epoch: 60, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 61 cost time: 0.46320271492004395
Epoch: 61, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.4251425266265869
Epoch: 62, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 63 cost time: 0.42406272888183594
Epoch: 63, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 64 cost time: 0.44223546981811523
Epoch: 64, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 65 cost time: 0.43755030632019043
Epoch: 65, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 66 cost time: 0.48185276985168457
Epoch: 66, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 67 cost time: 0.46545910835266113
Epoch: 67, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 68 cost time: 0.42740845680236816
Epoch: 68, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 69 cost time: 0.6820745468139648
Epoch: 69, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.4805572032928467
Epoch: 70, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.5142161846160889
Epoch: 71, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.4472053050994873
Epoch: 72, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.5146124362945557
Epoch: 73, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.4384493827819824
Epoch: 74, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.4697248935699463
Epoch: 75, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.40320587158203125
Epoch: 76, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.5102875232696533
Epoch: 77, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.5332257747650146
Epoch: 78, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 17782
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1188838481903076
Epoch: 1, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.897 Vali Acc: 0.167 Test Loss: 1.897 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.46462035179138184
Epoch: 2, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.843 Vali Acc: 0.211 Test Loss: 1.843 Test Acc: 0.211
Validation loss decreased (-0.166648 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 0.43775057792663574
Epoch: 3, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.805 Vali Acc: 0.230 Test Loss: 1.805 Test Acc: 0.230
Validation loss decreased (-0.211093 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.38297390937805176
Epoch: 4, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.771 Vali Acc: 0.248 Test Loss: 1.771 Test Acc: 0.248
Validation loss decreased (-0.229612 --> -0.248130).  Saving model ...
Epoch: 5 cost time: 0.37650489807128906
Epoch: 5, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.729 Vali Acc: 0.296 Test Loss: 1.729 Test Acc: 0.296
Validation loss decreased (-0.248130 --> -0.296279).  Saving model ...
Epoch: 6 cost time: 0.41642117500305176
Epoch: 6, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.679 Vali Acc: 0.356 Test Loss: 1.679 Test Acc: 0.356
Validation loss decreased (-0.296279 --> -0.355539).  Saving model ...
Epoch: 7 cost time: 0.3939664363861084
Epoch: 7, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.622 Vali Acc: 0.396 Test Loss: 1.622 Test Acc: 0.396
Validation loss decreased (-0.355539 --> -0.396280).  Saving model ...
Epoch: 8 cost time: 0.4385087490081787
Epoch: 8, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.561 Vali Acc: 0.444 Test Loss: 1.561 Test Acc: 0.444
Validation loss decreased (-0.396280 --> -0.444429).  Saving model ...
Epoch: 9 cost time: 0.4281795024871826
Epoch: 9, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.498 Vali Acc: 0.489 Test Loss: 1.498 Test Acc: 0.489
Validation loss decreased (-0.444429 --> -0.488874).  Saving model ...
Epoch: 10 cost time: 0.44801783561706543
Epoch: 10, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.431 Vali Acc: 0.552 Test Loss: 1.431 Test Acc: 0.552
Validation loss decreased (-0.488874 --> -0.551838).  Saving model ...
Epoch: 11 cost time: 0.4493849277496338
Epoch: 11, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.363 Vali Acc: 0.633 Test Loss: 1.363 Test Acc: 0.633
Validation loss decreased (-0.551838 --> -0.633320).  Saving model ...
Epoch: 12 cost time: 0.45456647872924805
Epoch: 12, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.295 Vali Acc: 0.700 Test Loss: 1.295 Test Acc: 0.700
Validation loss decreased (-0.633320 --> -0.699987).  Saving model ...
Epoch: 13 cost time: 0.3969118595123291
Epoch: 13, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.226 Vali Acc: 0.730 Test Loss: 1.226 Test Acc: 0.730
Validation loss decreased (-0.699987 --> -0.729617).  Saving model ...
Epoch: 14 cost time: 0.4632890224456787
Epoch: 14, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.158 Vali Acc: 0.767 Test Loss: 1.158 Test Acc: 0.767
Validation loss decreased (-0.729617 --> -0.766655).  Saving model ...
Epoch: 15 cost time: 0.4103984832763672
Epoch: 15, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.091 Vali Acc: 0.815 Test Loss: 1.091 Test Acc: 0.815
Validation loss decreased (-0.766655 --> -0.814804).  Saving model ...
Epoch: 16 cost time: 0.4389219284057617
Epoch: 16, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.027 Vali Acc: 0.844 Test Loss: 1.027 Test Acc: 0.844
Validation loss decreased (-0.814804 --> -0.844434).  Saving model ...
Epoch: 17 cost time: 0.4503805637359619
Epoch: 17, Steps: 2 | Train Loss: 0.987 Vali Loss: 0.965 Vali Acc: 0.867 Test Loss: 0.965 Test Acc: 0.867
Validation loss decreased (-0.844434 --> -0.866657).  Saving model ...
Epoch: 18 cost time: 0.4425771236419678
Epoch: 18, Steps: 2 | Train Loss: 0.972 Vali Loss: 0.905 Vali Acc: 0.900 Test Loss: 0.905 Test Acc: 0.900
Validation loss decreased (-0.866657 --> -0.899991).  Saving model ...
Epoch: 19 cost time: 0.45473480224609375
Epoch: 19, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.849 Vali Acc: 0.900 Test Loss: 0.849 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 20 cost time: 0.45711350440979004
Epoch: 20, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.796 Vali Acc: 0.907 Test Loss: 0.796 Test Acc: 0.907
Validation loss decreased (-0.899992 --> -0.907399).  Saving model ...
Epoch: 21 cost time: 0.5639519691467285
Epoch: 21, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.749 Vali Acc: 0.907 Test Loss: 0.749 Test Acc: 0.907
Validation loss decreased (-0.907399 --> -0.907400).  Saving model ...
Epoch: 22 cost time: 0.4721975326538086
Epoch: 22, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.703 Vali Acc: 0.919 Test Loss: 0.703 Test Acc: 0.919
Validation loss decreased (-0.907400 --> -0.918511).  Saving model ...
Epoch: 23 cost time: 0.5532252788543701
Epoch: 23, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.663 Vali Acc: 0.933 Test Loss: 0.663 Test Acc: 0.933
Validation loss decreased (-0.918511 --> -0.933327).  Saving model ...
Epoch: 24 cost time: 0.5557270050048828
Epoch: 24, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.626 Vali Acc: 0.930 Test Loss: 0.626 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.44713830947875977
Epoch: 25, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.590 Vali Acc: 0.933 Test Loss: 0.590 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 26 cost time: 0.4329872131347656
Epoch: 26, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.559 Vali Acc: 0.930 Test Loss: 0.559 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4823932647705078
Epoch: 27, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.530 Vali Acc: 0.930 Test Loss: 0.530 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4926726818084717
Epoch: 28, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.503 Vali Acc: 0.930 Test Loss: 0.503 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4310798645019531
Epoch: 29, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.479 Vali Acc: 0.922 Test Loss: 0.479 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.38219356536865234
Epoch: 30, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.457 Vali Acc: 0.922 Test Loss: 0.457 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4584946632385254
Epoch: 31, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.435 Vali Acc: 0.922 Test Loss: 0.435 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5039923191070557
Epoch: 32, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.416 Vali Acc: 0.915 Test Loss: 0.416 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.4364778995513916
Epoch: 33, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.399 Vali Acc: 0.915 Test Loss: 0.399 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.4787473678588867
Epoch: 34, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.383 Vali Acc: 0.907 Test Loss: 0.383 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4713478088378906
Epoch: 35, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.368 Vali Acc: 0.911 Test Loss: 0.368 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 13958
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8219921588897705
Epoch: 1, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.952 Vali Acc: 0.133 Test Loss: 1.952 Test Acc: 0.133
Validation loss decreased (inf --> -0.133314).  Saving model ...
Epoch: 2 cost time: 0.4242823123931885
Epoch: 2, Steps: 2 | Train Loss: 1.945 Vali Loss: 1.915 Vali Acc: 0.126 Test Loss: 1.915 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5863442420959473
Epoch: 3, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.889 Vali Acc: 0.122 Test Loss: 1.889 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.401991605758667
Epoch: 4, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.866 Vali Acc: 0.122 Test Loss: 1.866 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.47955822944641113
Epoch: 5, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.838 Vali Acc: 0.159 Test Loss: 1.838 Test Acc: 0.159
Validation loss decreased (-0.133314 --> -0.159241).  Saving model ...
Epoch: 6 cost time: 0.48360180854797363
Epoch: 6, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.804 Vali Acc: 0.230 Test Loss: 1.804 Test Acc: 0.230
Validation loss decreased (-0.159241 --> -0.229612).  Saving model ...
Epoch: 7 cost time: 0.4619300365447998
Epoch: 7, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.767 Vali Acc: 0.307 Test Loss: 1.767 Test Acc: 0.307
Validation loss decreased (-0.229612 --> -0.307390).  Saving model ...
Epoch: 8 cost time: 0.4823594093322754
Epoch: 8, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.725 Vali Acc: 0.344 Test Loss: 1.725 Test Acc: 0.344
Validation loss decreased (-0.307390 --> -0.344427).  Saving model ...
Epoch: 9 cost time: 0.4488213062286377
Epoch: 9, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.680 Vali Acc: 0.381 Test Loss: 1.680 Test Acc: 0.381
Validation loss decreased (-0.344427 --> -0.381465).  Saving model ...
Epoch: 10 cost time: 0.42682862281799316
Epoch: 10, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.632 Vali Acc: 0.400 Test Loss: 1.632 Test Acc: 0.400
Validation loss decreased (-0.381465 --> -0.399984).  Saving model ...
Epoch: 11 cost time: 0.4778017997741699
Epoch: 11, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.583 Vali Acc: 0.419 Test Loss: 1.583 Test Acc: 0.419
Validation loss decreased (-0.399984 --> -0.418503).  Saving model ...
Epoch: 12 cost time: 0.3941199779510498
Epoch: 12, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.533 Vali Acc: 0.437 Test Loss: 1.533 Test Acc: 0.437
Validation loss decreased (-0.418503 --> -0.437022).  Saving model ...
Epoch: 13 cost time: 0.4323427677154541
Epoch: 13, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.481 Vali Acc: 0.456 Test Loss: 1.481 Test Acc: 0.456
Validation loss decreased (-0.437022 --> -0.455541).  Saving model ...
Epoch: 14 cost time: 0.4521644115447998
Epoch: 14, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.428 Vali Acc: 0.496 Test Loss: 1.428 Test Acc: 0.496
Validation loss decreased (-0.455541 --> -0.496282).  Saving model ...
Epoch: 15 cost time: 0.500370979309082
Epoch: 15, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.375 Vali Acc: 0.515 Test Loss: 1.375 Test Acc: 0.515
Validation loss decreased (-0.496282 --> -0.514801).  Saving model ...
Epoch: 16 cost time: 0.49889492988586426
Epoch: 16, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.322 Vali Acc: 0.541 Test Loss: 1.322 Test Acc: 0.541
Validation loss decreased (-0.514801 --> -0.540728).  Saving model ...
Epoch: 17 cost time: 0.4557623863220215
Epoch: 17, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.270 Vali Acc: 0.585 Test Loss: 1.270 Test Acc: 0.585
Validation loss decreased (-0.540728 --> -0.585172).  Saving model ...
Epoch: 18 cost time: 0.39707469940185547
Epoch: 18, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.219 Vali Acc: 0.619 Test Loss: 1.219 Test Acc: 0.619
Validation loss decreased (-0.585172 --> -0.618506).  Saving model ...
Epoch: 19 cost time: 0.4591190814971924
Epoch: 19, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.168 Vali Acc: 0.644 Test Loss: 1.168 Test Acc: 0.644
Validation loss decreased (-0.618506 --> -0.644433).  Saving model ...
Epoch: 20 cost time: 0.5361924171447754
Epoch: 20, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.118 Vali Acc: 0.678 Test Loss: 1.118 Test Acc: 0.678
Validation loss decreased (-0.644433 --> -0.677767).  Saving model ...
Epoch: 21 cost time: 0.39961886405944824
Epoch: 21, Steps: 2 | Train Loss: 1.027 Vali Loss: 1.070 Vali Acc: 0.689 Test Loss: 1.070 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688878).  Saving model ...
Epoch: 22 cost time: 0.4800412654876709
Epoch: 22, Steps: 2 | Train Loss: 0.896 Vali Loss: 1.024 Vali Acc: 0.700 Test Loss: 1.024 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 0.418424129486084
Epoch: 23, Steps: 2 | Train Loss: 0.940 Vali Loss: 0.980 Vali Acc: 0.711 Test Loss: 0.980 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711101).  Saving model ...
Epoch: 24 cost time: 0.47824835777282715
Epoch: 24, Steps: 2 | Train Loss: 0.899 Vali Loss: 0.938 Vali Acc: 0.733 Test Loss: 0.938 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 25 cost time: 0.48613762855529785
Epoch: 25, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.897 Vali Acc: 0.748 Test Loss: 0.897 Test Acc: 0.748
Validation loss decreased (-0.733324 --> -0.748139).  Saving model ...
Epoch: 26 cost time: 0.45293736457824707
Epoch: 26, Steps: 2 | Train Loss: 0.742 Vali Loss: 0.859 Vali Acc: 0.770 Test Loss: 0.859 Test Acc: 0.770
Validation loss decreased (-0.748139 --> -0.770362).  Saving model ...
Epoch: 27 cost time: 0.4263575077056885
Epoch: 27, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.822 Vali Acc: 0.793 Test Loss: 0.822 Test Acc: 0.793
Validation loss decreased (-0.770362 --> -0.792584).  Saving model ...
Epoch: 28 cost time: 0.541682243347168
Epoch: 28, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.786 Vali Acc: 0.807 Test Loss: 0.786 Test Acc: 0.807
Validation loss decreased (-0.792584 --> -0.807400).  Saving model ...
Epoch: 29 cost time: 0.45461082458496094
Epoch: 29, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.751 Vali Acc: 0.815 Test Loss: 0.751 Test Acc: 0.815
Validation loss decreased (-0.807400 --> -0.814807).  Saving model ...
Epoch: 30 cost time: 0.47971224784851074
Epoch: 30, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.719 Vali Acc: 0.837 Test Loss: 0.719 Test Acc: 0.837
Validation loss decreased (-0.814807 --> -0.837030).  Saving model ...
Epoch: 31 cost time: 0.5236797332763672
Epoch: 31, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.689 Vali Acc: 0.841 Test Loss: 0.689 Test Acc: 0.841
Validation loss decreased (-0.837030 --> -0.840734).  Saving model ...
Epoch: 32 cost time: 0.5241837501525879
Epoch: 32, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
Validation loss decreased (-0.840734 --> -0.844438).  Saving model ...
Epoch: 33 cost time: 0.46646904945373535
Epoch: 33, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 34 cost time: 0.4679543972015381
Epoch: 34, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.609 Vali Acc: 0.852 Test Loss: 0.609 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.42058491706848145
Epoch: 35, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 36 cost time: 0.4175081253051758
Epoch: 36, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.564 Vali Acc: 0.867 Test Loss: 0.564 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 37 cost time: 0.3985939025878906
Epoch: 37, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.544 Vali Acc: 0.870 Test Loss: 0.544 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.870365).  Saving model ...
Epoch: 38 cost time: 0.4963672161102295
Epoch: 38, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.526 Vali Acc: 0.874 Test Loss: 0.526 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 39 cost time: 0.4116637706756592
Epoch: 39, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.509 Vali Acc: 0.874 Test Loss: 0.509 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 40 cost time: 0.4811677932739258
Epoch: 40, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.493 Vali Acc: 0.881 Test Loss: 0.493 Test Acc: 0.881
Validation loss decreased (-0.874069 --> -0.881477).  Saving model ...
Epoch: 41 cost time: 0.4314594268798828
Epoch: 41, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.478 Vali Acc: 0.881 Test Loss: 0.478 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 42 cost time: 0.4183375835418701
Epoch: 42, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.464 Vali Acc: 0.881 Test Loss: 0.464 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 43 cost time: 0.4324300289154053
Epoch: 43, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.451 Vali Acc: 0.885 Test Loss: 0.451 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885181).  Saving model ...
Epoch: 44 cost time: 0.4915432929992676
Epoch: 44, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.439 Vali Acc: 0.889 Test Loss: 0.439 Test Acc: 0.889
Validation loss decreased (-0.885181 --> -0.888884).  Saving model ...
Epoch: 45 cost time: 0.4333992004394531
Epoch: 45, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 46 cost time: 0.48249173164367676
Epoch: 46, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 47 cost time: 0.4712677001953125
Epoch: 47, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.406 Vali Acc: 0.893 Test Loss: 0.406 Test Acc: 0.893
Validation loss decreased (-0.888885 --> -0.892589).  Saving model ...
Epoch: 48 cost time: 0.4904501438140869
Epoch: 48, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.397 Vali Acc: 0.896 Test Loss: 0.397 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896292).  Saving model ...
Epoch: 49 cost time: 0.4619934558868408
Epoch: 49, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.387 Vali Acc: 0.896 Test Loss: 0.387 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 50 cost time: 0.5191726684570312
Epoch: 50, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.379 Vali Acc: 0.904 Test Loss: 0.379 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903700).  Saving model ...
Epoch: 51 cost time: 0.4797327518463135
Epoch: 51, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.371 Vali Acc: 0.907 Test Loss: 0.371 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 52 cost time: 0.4964444637298584
Epoch: 52, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.364 Vali Acc: 0.907 Test Loss: 0.364 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 53 cost time: 0.4807572364807129
Epoch: 53, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.357 Vali Acc: 0.907 Test Loss: 0.357 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 54 cost time: 0.4508063793182373
Epoch: 54, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.351 Vali Acc: 0.907 Test Loss: 0.351 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 55 cost time: 0.4745774269104004
Epoch: 55, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.344 Vali Acc: 0.915 Test Loss: 0.344 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914811).  Saving model ...
Epoch: 56 cost time: 0.4339892864227295
Epoch: 56, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.339 Vali Acc: 0.915 Test Loss: 0.339 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 57 cost time: 0.468705415725708
Epoch: 57, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.334 Vali Acc: 0.915 Test Loss: 0.334 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 58 cost time: 0.45192933082580566
Epoch: 58, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.329 Vali Acc: 0.915 Test Loss: 0.329 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 59 cost time: 0.4633297920227051
Epoch: 59, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.325 Vali Acc: 0.915 Test Loss: 0.325 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 60 cost time: 0.4584157466888428
Epoch: 60, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918515).  Saving model ...
Epoch: 61 cost time: 0.430753231048584
Epoch: 61, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.316 Vali Acc: 0.919 Test Loss: 0.316 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 62 cost time: 0.5182294845581055
Epoch: 62, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.313 Vali Acc: 0.922 Test Loss: 0.313 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 63 cost time: 0.47393798828125
Epoch: 63, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.309 Vali Acc: 0.922 Test Loss: 0.309 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 64 cost time: 0.4871182441711426
Epoch: 64, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.306 Vali Acc: 0.922 Test Loss: 0.306 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 65 cost time: 0.5338940620422363
Epoch: 65, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 66 cost time: 0.4521310329437256
Epoch: 66, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.299 Vali Acc: 0.922 Test Loss: 0.299 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 67 cost time: 0.48062610626220703
Epoch: 67, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.295 Vali Acc: 0.919 Test Loss: 0.295 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.4962496757507324
Epoch: 68, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.292 Vali Acc: 0.919 Test Loss: 0.292 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.4554781913757324
Epoch: 69, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 70 cost time: 0.4901571273803711
Epoch: 70, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 71 cost time: 0.500586986541748
Epoch: 71, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 72 cost time: 0.49873805046081543
Epoch: 72, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 73 cost time: 0.4608426094055176
Epoch: 73, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.281 Vali Acc: 0.926 Test Loss: 0.281 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 74 cost time: 0.45011091232299805
Epoch: 74, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 75 cost time: 0.4816114902496338
Epoch: 75, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 76 cost time: 0.5246772766113281
Epoch: 76, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.275 Vali Acc: 0.926 Test Loss: 0.275 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 77 cost time: 0.4645054340362549
Epoch: 77, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 78 cost time: 0.4723525047302246
Epoch: 78, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.271 Vali Acc: 0.926 Test Loss: 0.271 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 79 cost time: 0.4454042911529541
Epoch: 79, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.269 Vali Acc: 0.926 Test Loss: 0.269 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 80 cost time: 0.4115939140319824
Epoch: 80, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.48536252975463867
Epoch: 81, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.5082342624664307
Epoch: 82, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.41862010955810547
Epoch: 83, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.4715137481689453
Epoch: 84, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.261 Vali Acc: 0.919 Test Loss: 0.261 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.4682927131652832
Epoch: 85, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.4269249439239502
Epoch: 86, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.47766995429992676
Epoch: 87, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.48723530769348145
Epoch: 88, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.255 Vali Acc: 0.919 Test Loss: 0.255 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.4771854877471924
Epoch: 89, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.254 Vali Acc: 0.919 Test Loss: 0.254 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 11686
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0357067584991455
Epoch: 1, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.958 Vali Acc: 0.181 Test Loss: 1.958 Test Acc: 0.181
Validation loss decreased (inf --> -0.181462).  Saving model ...
Epoch: 2 cost time: 0.4538538455963135
Epoch: 2, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.903 Vali Acc: 0.211 Test Loss: 1.903 Test Acc: 0.211
Validation loss decreased (-0.181462 --> -0.211092).  Saving model ...
Epoch: 3 cost time: 0.42458128929138184
Epoch: 3, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.864 Vali Acc: 0.230 Test Loss: 1.864 Test Acc: 0.230
Validation loss decreased (-0.211092 --> -0.229611).  Saving model ...
Epoch: 4 cost time: 0.3999805450439453
Epoch: 4, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.835 Vali Acc: 0.252 Test Loss: 1.835 Test Acc: 0.252
Validation loss decreased (-0.229611 --> -0.251834).  Saving model ...
Epoch: 5 cost time: 0.4582958221435547
Epoch: 5, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.803 Vali Acc: 0.256 Test Loss: 1.803 Test Acc: 0.256
Validation loss decreased (-0.251834 --> -0.255538).  Saving model ...
Epoch: 6 cost time: 0.430861234664917
Epoch: 6, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.770 Vali Acc: 0.267 Test Loss: 1.770 Test Acc: 0.267
Validation loss decreased (-0.255538 --> -0.266649).  Saving model ...
Epoch: 7 cost time: 0.41386890411376953
Epoch: 7, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.735 Vali Acc: 0.281 Test Loss: 1.735 Test Acc: 0.281
Validation loss decreased (-0.266649 --> -0.281464).  Saving model ...
Epoch: 8 cost time: 0.39063501358032227
Epoch: 8, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.698 Vali Acc: 0.311 Test Loss: 1.698 Test Acc: 0.311
Validation loss decreased (-0.281464 --> -0.311094).  Saving model ...
Epoch: 9 cost time: 0.3932826519012451
Epoch: 9, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.660 Vali Acc: 0.330 Test Loss: 1.660 Test Acc: 0.330
Validation loss decreased (-0.311094 --> -0.329613).  Saving model ...
Epoch: 10 cost time: 0.3948025703430176
Epoch: 10, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.620 Vali Acc: 0.352 Test Loss: 1.620 Test Acc: 0.352
Validation loss decreased (-0.329613 --> -0.351836).  Saving model ...
Epoch: 11 cost time: 0.44425344467163086
Epoch: 11, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.579 Vali Acc: 0.374 Test Loss: 1.579 Test Acc: 0.374
Validation loss decreased (-0.351836 --> -0.374058).  Saving model ...
Epoch: 12 cost time: 0.38065433502197266
Epoch: 12, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.537 Vali Acc: 0.385 Test Loss: 1.537 Test Acc: 0.385
Validation loss decreased (-0.374058 --> -0.385170).  Saving model ...
Epoch: 13 cost time: 0.4410090446472168
Epoch: 13, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.495 Vali Acc: 0.422 Test Loss: 1.495 Test Acc: 0.422
Validation loss decreased (-0.385170 --> -0.422207).  Saving model ...
Epoch: 14 cost time: 0.4335165023803711
Epoch: 14, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.451 Vali Acc: 0.459 Test Loss: 1.451 Test Acc: 0.459
Validation loss decreased (-0.422207 --> -0.459245).  Saving model ...
Epoch: 15 cost time: 0.46639132499694824
Epoch: 15, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.408 Vali Acc: 0.478 Test Loss: 1.408 Test Acc: 0.478
Validation loss decreased (-0.459245 --> -0.477764).  Saving model ...
Epoch: 16 cost time: 0.4009435176849365
Epoch: 16, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.364 Vali Acc: 0.515 Test Loss: 1.364 Test Acc: 0.515
Validation loss decreased (-0.477764 --> -0.514801).  Saving model ...
Epoch: 17 cost time: 0.44055747985839844
Epoch: 17, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.319 Vali Acc: 0.530 Test Loss: 1.319 Test Acc: 0.530
Validation loss decreased (-0.514801 --> -0.529616).  Saving model ...
Epoch: 18 cost time: 0.44152140617370605
Epoch: 18, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.275 Vali Acc: 0.570 Test Loss: 1.275 Test Acc: 0.570
Validation loss decreased (-0.529616 --> -0.570358).  Saving model ...
Epoch: 19 cost time: 0.39658427238464355
Epoch: 19, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.231 Vali Acc: 0.589 Test Loss: 1.231 Test Acc: 0.589
Validation loss decreased (-0.570358 --> -0.588877).  Saving model ...
Epoch: 20 cost time: 0.4516763687133789
Epoch: 20, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.187 Vali Acc: 0.626 Test Loss: 1.187 Test Acc: 0.626
Validation loss decreased (-0.588877 --> -0.625914).  Saving model ...
Epoch: 21 cost time: 0.41781044006347656
Epoch: 21, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.144 Vali Acc: 0.644 Test Loss: 1.144 Test Acc: 0.644
Validation loss decreased (-0.625914 --> -0.644433).  Saving model ...
Epoch: 22 cost time: 0.4269711971282959
Epoch: 22, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.102 Vali Acc: 0.674 Test Loss: 1.102 Test Acc: 0.674
Validation loss decreased (-0.644433 --> -0.674063).  Saving model ...
Epoch: 23 cost time: 0.45829319953918457
Epoch: 23, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.061 Vali Acc: 0.704 Test Loss: 1.061 Test Acc: 0.704
Validation loss decreased (-0.674063 --> -0.703693).  Saving model ...
Epoch: 24 cost time: 0.3714871406555176
Epoch: 24, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.020 Vali Acc: 0.744 Test Loss: 1.020 Test Acc: 0.744
Validation loss decreased (-0.703693 --> -0.744434).  Saving model ...
Epoch: 25 cost time: 0.3631415367126465
Epoch: 25, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.980 Vali Acc: 0.774 Test Loss: 0.980 Test Acc: 0.774
Validation loss decreased (-0.744434 --> -0.774064).  Saving model ...
Epoch: 26 cost time: 0.40802669525146484
Epoch: 26, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.941 Vali Acc: 0.804 Test Loss: 0.941 Test Acc: 0.804
Validation loss decreased (-0.774064 --> -0.803694).  Saving model ...
Epoch: 27 cost time: 0.35355114936828613
Epoch: 27, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.903 Vali Acc: 0.819 Test Loss: 0.903 Test Acc: 0.819
Validation loss decreased (-0.803694 --> -0.818509).  Saving model ...
Epoch: 28 cost time: 0.36114072799682617
Epoch: 28, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.867 Vali Acc: 0.830 Test Loss: 0.867 Test Acc: 0.830
Validation loss decreased (-0.818509 --> -0.829621).  Saving model ...
Epoch: 29 cost time: 0.432147741317749
Epoch: 29, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.831 Vali Acc: 0.830 Test Loss: 0.831 Test Acc: 0.830
Validation loss decreased (-0.829621 --> -0.829621).  Saving model ...
Epoch: 30 cost time: 0.3775928020477295
Epoch: 30, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.797 Vali Acc: 0.833 Test Loss: 0.797 Test Acc: 0.833
Validation loss decreased (-0.829621 --> -0.833325).  Saving model ...
Epoch: 31 cost time: 0.3870220184326172
Epoch: 31, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.765 Vali Acc: 0.841 Test Loss: 0.765 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840733).  Saving model ...
Epoch: 32 cost time: 0.4256293773651123
Epoch: 32, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.735 Vali Acc: 0.859 Test Loss: 0.735 Test Acc: 0.859
Validation loss decreased (-0.840733 --> -0.859252).  Saving model ...
Epoch: 33 cost time: 0.41181516647338867
Epoch: 33, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.706 Vali Acc: 0.867 Test Loss: 0.706 Test Acc: 0.867
Validation loss decreased (-0.859252 --> -0.866660).  Saving model ...
Epoch: 34 cost time: 0.4549870491027832
Epoch: 34, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.678 Vali Acc: 0.878 Test Loss: 0.678 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 35 cost time: 0.4080467224121094
Epoch: 35, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.651 Vali Acc: 0.878 Test Loss: 0.651 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 36 cost time: 0.4161794185638428
Epoch: 36, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.626 Vali Acc: 0.874 Test Loss: 0.626 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.41812944412231445
Epoch: 37, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.601 Vali Acc: 0.874 Test Loss: 0.601 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.40353965759277344
Epoch: 38, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.578 Vali Acc: 0.874 Test Loss: 0.578 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4573538303375244
Epoch: 39, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.556 Vali Acc: 0.881 Test Loss: 0.556 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881476).  Saving model ...
Epoch: 40 cost time: 0.39719319343566895
Epoch: 40, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.536 Vali Acc: 0.885 Test Loss: 0.536 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 41 cost time: 0.44951319694519043
Epoch: 41, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.518 Vali Acc: 0.893 Test Loss: 0.518 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892587).  Saving model ...
Epoch: 42 cost time: 0.39836764335632324
Epoch: 42, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.501 Vali Acc: 0.896 Test Loss: 0.501 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 43 cost time: 0.3856518268585205
Epoch: 43, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.485 Vali Acc: 0.904 Test Loss: 0.485 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 44 cost time: 0.5446112155914307
Epoch: 44, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.470 Vali Acc: 0.904 Test Loss: 0.470 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 45 cost time: 0.4045987129211426
Epoch: 45, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.457 Vali Acc: 0.907 Test Loss: 0.457 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 46 cost time: 0.43431973457336426
Epoch: 46, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.444 Vali Acc: 0.911 Test Loss: 0.444 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 47 cost time: 0.39731860160827637
Epoch: 47, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.432 Vali Acc: 0.911 Test Loss: 0.432 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 48 cost time: 0.3829970359802246
Epoch: 48, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.421 Vali Acc: 0.911 Test Loss: 0.421 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 49 cost time: 0.3802807331085205
Epoch: 49, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.412 Vali Acc: 0.911 Test Loss: 0.412 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 50 cost time: 0.3695950508117676
Epoch: 50, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.402 Vali Acc: 0.915 Test Loss: 0.402 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 51 cost time: 0.46138525009155273
Epoch: 51, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.393 Vali Acc: 0.915 Test Loss: 0.393 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 52 cost time: 0.4438295364379883
Epoch: 52, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.384 Vali Acc: 0.911 Test Loss: 0.384 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.407930850982666
Epoch: 53, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.376 Vali Acc: 0.911 Test Loss: 0.376 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.4052464962005615
Epoch: 54, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.369 Vali Acc: 0.915 Test Loss: 0.369 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 55 cost time: 0.5090053081512451
Epoch: 55, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.362 Vali Acc: 0.915 Test Loss: 0.362 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 56 cost time: 0.4905879497528076
Epoch: 56, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.355 Vali Acc: 0.915 Test Loss: 0.355 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 57 cost time: 0.42463254928588867
Epoch: 57, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.348 Vali Acc: 0.915 Test Loss: 0.348 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 58 cost time: 0.3786280155181885
Epoch: 58, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.342 Vali Acc: 0.915 Test Loss: 0.342 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 59 cost time: 0.4142441749572754
Epoch: 59, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.336 Vali Acc: 0.915 Test Loss: 0.336 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 60 cost time: 0.46756696701049805
Epoch: 60, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 61 cost time: 0.4377462863922119
Epoch: 61, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.325 Vali Acc: 0.922 Test Loss: 0.325 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922219).  Saving model ...
Epoch: 62 cost time: 0.5628223419189453
Epoch: 62, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 63 cost time: 0.43433213233947754
Epoch: 63, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.315 Vali Acc: 0.926 Test Loss: 0.315 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 64 cost time: 0.418503999710083
Epoch: 64, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.506699800491333
Epoch: 65, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.306 Vali Acc: 0.922 Test Loss: 0.306 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.4080014228820801
Epoch: 66, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.49964308738708496
Epoch: 67, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.299 Vali Acc: 0.922 Test Loss: 0.299 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.45940279960632324
Epoch: 68, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.43950843811035156
Epoch: 69, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.293 Vali Acc: 0.919 Test Loss: 0.293 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.4271659851074219
Epoch: 70, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.4100770950317383
Epoch: 71, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.4517793655395508
Epoch: 72, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.286 Vali Acc: 0.919 Test Loss: 0.286 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.4689629077911377
Epoch: 73, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.283 Vali Acc: 0.919 Test Loss: 0.283 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 10582
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7763073444366455
Epoch: 1, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.802 Vali Acc: 0.267 Test Loss: 1.802 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 0.45720791816711426
Epoch: 2, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.772 Vali Acc: 0.278 Test Loss: 1.772 Test Acc: 0.278
Validation loss decreased (-0.266649 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.373821496963501
Epoch: 3, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.751 Vali Acc: 0.278 Test Loss: 1.751 Test Acc: 0.278
Validation loss decreased (-0.277760 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 0.44632458686828613
Epoch: 4, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.737 Vali Acc: 0.278 Test Loss: 1.737 Test Acc: 0.278
Validation loss decreased (-0.277760 --> -0.277760).  Saving model ...
Epoch: 5 cost time: 0.5039973258972168
Epoch: 5, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.720 Vali Acc: 0.300 Test Loss: 1.720 Test Acc: 0.300
Validation loss decreased (-0.277760 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 0.46677207946777344
Epoch: 6, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.701 Vali Acc: 0.293 Test Loss: 1.701 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.41599512100219727
Epoch: 7, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.680 Vali Acc: 0.293 Test Loss: 1.680 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.41516876220703125
Epoch: 8, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.657 Vali Acc: 0.296 Test Loss: 1.657 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.43618154525756836
Epoch: 9, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.632 Vali Acc: 0.307 Test Loss: 1.632 Test Acc: 0.307
Validation loss decreased (-0.299983 --> -0.307391).  Saving model ...
Epoch: 10 cost time: 0.4276387691497803
Epoch: 10, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.605 Vali Acc: 0.315 Test Loss: 1.605 Test Acc: 0.315
Validation loss decreased (-0.307391 --> -0.314799).  Saving model ...
Epoch: 11 cost time: 0.4180440902709961
Epoch: 11, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.576 Vali Acc: 0.326 Test Loss: 1.576 Test Acc: 0.326
Validation loss decreased (-0.314799 --> -0.325910).  Saving model ...
Epoch: 12 cost time: 0.4109165668487549
Epoch: 12, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.545 Vali Acc: 0.359 Test Loss: 1.545 Test Acc: 0.359
Validation loss decreased (-0.325910 --> -0.359244).  Saving model ...
Epoch: 13 cost time: 0.42256808280944824
Epoch: 13, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.514 Vali Acc: 0.419 Test Loss: 1.514 Test Acc: 0.419
Validation loss decreased (-0.359244 --> -0.418503).  Saving model ...
Epoch: 14 cost time: 0.428605318069458
Epoch: 14, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.482 Vali Acc: 0.463 Test Loss: 1.482 Test Acc: 0.463
Validation loss decreased (-0.418503 --> -0.462948).  Saving model ...
Epoch: 15 cost time: 0.4123494625091553
Epoch: 15, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.448 Vali Acc: 0.500 Test Loss: 1.448 Test Acc: 0.500
Validation loss decreased (-0.462948 --> -0.499986).  Saving model ...
Epoch: 16 cost time: 0.42957115173339844
Epoch: 16, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.414 Vali Acc: 0.544 Test Loss: 1.414 Test Acc: 0.544
Validation loss decreased (-0.499986 --> -0.544430).  Saving model ...
Epoch: 17 cost time: 0.3922922611236572
Epoch: 17, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.380 Vali Acc: 0.596 Test Loss: 1.380 Test Acc: 0.596
Validation loss decreased (-0.544430 --> -0.596282).  Saving model ...
Epoch: 18 cost time: 0.3891782760620117
Epoch: 18, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.344 Vali Acc: 0.622 Test Loss: 1.344 Test Acc: 0.622
Validation loss decreased (-0.596282 --> -0.622209).  Saving model ...
Epoch: 19 cost time: 0.3836994171142578
Epoch: 19, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.308 Vali Acc: 0.656 Test Loss: 1.308 Test Acc: 0.656
Validation loss decreased (-0.622209 --> -0.655542).  Saving model ...
Epoch: 20 cost time: 0.49808788299560547
Epoch: 20, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.273 Vali Acc: 0.670 Test Loss: 1.273 Test Acc: 0.670
Validation loss decreased (-0.655542 --> -0.670358).  Saving model ...
Epoch: 21 cost time: 0.44329166412353516
Epoch: 21, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.238 Vali Acc: 0.678 Test Loss: 1.238 Test Acc: 0.678
Validation loss decreased (-0.670358 --> -0.677765).  Saving model ...
Epoch: 22 cost time: 0.4669475555419922
Epoch: 22, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.203 Vali Acc: 0.704 Test Loss: 1.203 Test Acc: 0.704
Validation loss decreased (-0.677765 --> -0.703692).  Saving model ...
Epoch: 23 cost time: 0.4273700714111328
Epoch: 23, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.168 Vali Acc: 0.722 Test Loss: 1.168 Test Acc: 0.722
Validation loss decreased (-0.703692 --> -0.722211).  Saving model ...
Epoch: 24 cost time: 0.4145684242248535
Epoch: 24, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.134 Vali Acc: 0.737 Test Loss: 1.134 Test Acc: 0.737
Validation loss decreased (-0.722211 --> -0.737026).  Saving model ...
Epoch: 25 cost time: 0.48426365852355957
Epoch: 25, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.099 Vali Acc: 0.748 Test Loss: 1.099 Test Acc: 0.748
Validation loss decreased (-0.737026 --> -0.748137).  Saving model ...
Epoch: 26 cost time: 0.41739940643310547
Epoch: 26, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.064 Vali Acc: 0.756 Test Loss: 1.064 Test Acc: 0.756
Validation loss decreased (-0.748137 --> -0.755545).  Saving model ...
Epoch: 27 cost time: 0.47381019592285156
Epoch: 27, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.031 Vali Acc: 0.778 Test Loss: 1.031 Test Acc: 0.778
Validation loss decreased (-0.755545 --> -0.777767).  Saving model ...
Epoch: 28 cost time: 0.42252373695373535
Epoch: 28, Steps: 2 | Train Loss: 0.936 Vali Loss: 0.997 Vali Acc: 0.781 Test Loss: 0.997 Test Acc: 0.781
Validation loss decreased (-0.777767 --> -0.781472).  Saving model ...
Epoch: 29 cost time: 0.4414641857147217
Epoch: 29, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.965 Vali Acc: 0.796 Test Loss: 0.965 Test Acc: 0.796
Validation loss decreased (-0.781472 --> -0.796287).  Saving model ...
Epoch: 30 cost time: 0.46574902534484863
Epoch: 30, Steps: 2 | Train Loss: 0.923 Vali Loss: 0.934 Vali Acc: 0.804 Test Loss: 0.934 Test Acc: 0.804
Validation loss decreased (-0.796287 --> -0.803694).  Saving model ...
Epoch: 31 cost time: 0.42031145095825195
Epoch: 31, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.903 Vali Acc: 0.819 Test Loss: 0.903 Test Acc: 0.819
Validation loss decreased (-0.803694 --> -0.818509).  Saving model ...
Epoch: 32 cost time: 0.5119879245758057
Epoch: 32, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.873 Vali Acc: 0.830 Test Loss: 0.873 Test Acc: 0.830
Validation loss decreased (-0.818509 --> -0.829621).  Saving model ...
Epoch: 33 cost time: 0.45148205757141113
Epoch: 33, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.843 Vali Acc: 0.830 Test Loss: 0.843 Test Acc: 0.830
Validation loss decreased (-0.829621 --> -0.829621).  Saving model ...
Epoch: 34 cost time: 0.42035579681396484
Epoch: 34, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.815 Vali Acc: 0.841 Test Loss: 0.815 Test Acc: 0.841
Validation loss decreased (-0.829621 --> -0.840733).  Saving model ...
Epoch: 35 cost time: 0.4838089942932129
Epoch: 35, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.788 Vali Acc: 0.852 Test Loss: 0.788 Test Acc: 0.852
Validation loss decreased (-0.840733 --> -0.851844).  Saving model ...
Epoch: 36 cost time: 0.4314556121826172
Epoch: 36, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.761 Vali Acc: 0.852 Test Loss: 0.761 Test Acc: 0.852
Validation loss decreased (-0.851844 --> -0.851844).  Saving model ...
Epoch: 37 cost time: 0.503713846206665
Epoch: 37, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.735 Vali Acc: 0.863 Test Loss: 0.735 Test Acc: 0.863
Validation loss decreased (-0.851844 --> -0.862956).  Saving model ...
Epoch: 38 cost time: 0.48050522804260254
Epoch: 38, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.710 Vali Acc: 0.863 Test Loss: 0.710 Test Acc: 0.863
Validation loss decreased (-0.862956 --> -0.862956).  Saving model ...
Epoch: 39 cost time: 0.4461629390716553
Epoch: 39, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.687 Vali Acc: 0.863 Test Loss: 0.687 Test Acc: 0.863
Validation loss decreased (-0.862956 --> -0.862956).  Saving model ...
Epoch: 40 cost time: 0.499375581741333
Epoch: 40, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.664 Vali Acc: 0.867 Test Loss: 0.664 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 41 cost time: 0.4617648124694824
Epoch: 41, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.643 Vali Acc: 0.874 Test Loss: 0.643 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874068).  Saving model ...
Epoch: 42 cost time: 0.4321117401123047
Epoch: 42, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.622 Vali Acc: 0.893 Test Loss: 0.622 Test Acc: 0.893
Validation loss decreased (-0.874068 --> -0.892586).  Saving model ...
Epoch: 43 cost time: 0.441913366317749
Epoch: 43, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.604 Vali Acc: 0.893 Test Loss: 0.604 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 44 cost time: 0.49776554107666016
Epoch: 44, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.585 Vali Acc: 0.893 Test Loss: 0.585 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 45 cost time: 0.49974489212036133
Epoch: 45, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.568 Vali Acc: 0.896 Test Loss: 0.568 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 46 cost time: 0.4677295684814453
Epoch: 46, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.551 Vali Acc: 0.900 Test Loss: 0.551 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899994).  Saving model ...
Epoch: 47 cost time: 0.44146156311035156
Epoch: 47, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 0.4053189754486084
Epoch: 48, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 0.44068241119384766
Epoch: 49, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.509 Vali Acc: 0.911 Test Loss: 0.509 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911106).  Saving model ...
Epoch: 50 cost time: 0.3986246585845947
Epoch: 50, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.497 Vali Acc: 0.911 Test Loss: 0.497 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 51 cost time: 0.4004192352294922
Epoch: 51, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.486 Vali Acc: 0.911 Test Loss: 0.486 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 52 cost time: 0.4063262939453125
Epoch: 52, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.475 Vali Acc: 0.911 Test Loss: 0.475 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 53 cost time: 0.4617750644683838
Epoch: 53, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.465 Vali Acc: 0.911 Test Loss: 0.465 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 54 cost time: 0.438861608505249
Epoch: 54, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.455 Vali Acc: 0.911 Test Loss: 0.455 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 55 cost time: 0.44304823875427246
Epoch: 55, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.446 Vali Acc: 0.911 Test Loss: 0.446 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 56 cost time: 0.47031474113464355
Epoch: 56, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.437 Vali Acc: 0.919 Test Loss: 0.437 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918514).  Saving model ...
Epoch: 57 cost time: 0.4242992401123047
Epoch: 57, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.429 Vali Acc: 0.926 Test Loss: 0.429 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 58 cost time: 0.45708179473876953
Epoch: 58, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.423 Vali Acc: 0.926 Test Loss: 0.423 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 59 cost time: 0.42165303230285645
Epoch: 59, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.416 Vali Acc: 0.926 Test Loss: 0.416 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 60 cost time: 0.43184351921081543
Epoch: 60, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.409 Vali Acc: 0.926 Test Loss: 0.409 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 61 cost time: 0.39177751541137695
Epoch: 61, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.403 Vali Acc: 0.926 Test Loss: 0.403 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 62 cost time: 0.4043741226196289
Epoch: 62, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.396 Vali Acc: 0.926 Test Loss: 0.396 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 63 cost time: 0.4815647602081299
Epoch: 63, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.390 Vali Acc: 0.926 Test Loss: 0.390 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 64 cost time: 0.44209790229797363
Epoch: 64, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.384 Vali Acc: 0.926 Test Loss: 0.384 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 65 cost time: 0.4172823429107666
Epoch: 65, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.378 Vali Acc: 0.926 Test Loss: 0.378 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 66 cost time: 0.47524023056030273
Epoch: 66, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.372 Vali Acc: 0.926 Test Loss: 0.372 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 67 cost time: 0.47215700149536133
Epoch: 67, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.367 Vali Acc: 0.926 Test Loss: 0.367 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 68 cost time: 0.47384190559387207
Epoch: 68, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.4246089458465576
Epoch: 69, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.356 Vali Acc: 0.922 Test Loss: 0.356 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.4229750633239746
Epoch: 70, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.351 Vali Acc: 0.922 Test Loss: 0.351 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.4174003601074219
Epoch: 71, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.43947768211364746
Epoch: 72, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.48128223419189453
Epoch: 73, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.471343994140625
Epoch: 74, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.42698168754577637
Epoch: 75, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.327 Vali Acc: 0.926 Test Loss: 0.327 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 76 cost time: 0.48015642166137695
Epoch: 76, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.323 Vali Acc: 0.926 Test Loss: 0.323 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 77 cost time: 0.4145665168762207
Epoch: 77, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.319 Vali Acc: 0.926 Test Loss: 0.319 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 78 cost time: 0.3794989585876465
Epoch: 78, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.316 Vali Acc: 0.926 Test Loss: 0.316 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 79 cost time: 0.4370417594909668
Epoch: 79, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 80 cost time: 0.39163708686828613
Epoch: 80, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 81 cost time: 0.4418771266937256
Epoch: 81, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 82 cost time: 0.4304537773132324
Epoch: 82, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.304 Vali Acc: 0.926 Test Loss: 0.304 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 83 cost time: 0.4306914806365967
Epoch: 83, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.301 Vali Acc: 0.926 Test Loss: 0.301 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 84 cost time: 0.45575976371765137
Epoch: 84, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 85 cost time: 0.4221780300140381
Epoch: 85, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 86 cost time: 0.37071943283081055
Epoch: 86, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 87 cost time: 0.3726820945739746
Epoch: 87, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.292 Vali Acc: 0.926 Test Loss: 0.292 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 88 cost time: 0.42679476737976074
Epoch: 88, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.290 Vali Acc: 0.926 Test Loss: 0.290 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 89 cost time: 0.4372894763946533
Epoch: 89, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 90 cost time: 0.39591455459594727
Epoch: 90, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.288 Vali Acc: 0.926 Test Loss: 0.288 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 91 cost time: 0.40738439559936523
Epoch: 91, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 92 cost time: 0.4136042594909668
Epoch: 92, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.285 Vali Acc: 0.926 Test Loss: 0.285 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 93 cost time: 0.37103700637817383
Epoch: 93, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 94 cost time: 0.45485806465148926
Epoch: 94, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.282 Vali Acc: 0.926 Test Loss: 0.282 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 95 cost time: 0.43418145179748535
Epoch: 95, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.281 Vali Acc: 0.926 Test Loss: 0.281 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 96 cost time: 0.46506547927856445
Epoch: 96, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 97 cost time: 0.43858909606933594
Epoch: 97, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 98 cost time: 0.43411874771118164
Epoch: 98, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 99 cost time: 0.4043905735015869
Epoch: 99, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.275 Vali Acc: 0.926 Test Loss: 0.275 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 100 cost time: 0.43144774436950684
Epoch: 100, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 9094
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.85514497756958
Epoch: 1, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.887 Vali Acc: 0.167 Test Loss: 1.887 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.39873695373535156
Epoch: 2, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.852 Vali Acc: 0.174 Test Loss: 1.852 Test Acc: 0.174
Validation loss decreased (-0.166648 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.40403008460998535
Epoch: 3, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.827 Vali Acc: 0.167 Test Loss: 1.827 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4183218479156494
Epoch: 4, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.809 Vali Acc: 0.174 Test Loss: 1.809 Test Acc: 0.174
Validation loss decreased (-0.174056 --> -0.174056).  Saving model ...
Epoch: 5 cost time: 0.4253826141357422
Epoch: 5, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4362967014312744
Epoch: 6, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.772 Vali Acc: 0.167 Test Loss: 1.772 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4448733329772949
Epoch: 7, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.752 Vali Acc: 0.185 Test Loss: 1.752 Test Acc: 0.185
Validation loss decreased (-0.174056 --> -0.185168).  Saving model ...
Epoch: 8 cost time: 0.4394369125366211
Epoch: 8, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.732 Vali Acc: 0.215 Test Loss: 1.732 Test Acc: 0.215
Validation loss decreased (-0.185168 --> -0.214797).  Saving model ...
Epoch: 9 cost time: 0.4426693916320801
Epoch: 9, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.710 Vali Acc: 0.230 Test Loss: 1.710 Test Acc: 0.230
Validation loss decreased (-0.214797 --> -0.229613).  Saving model ...
Epoch: 10 cost time: 0.39574217796325684
Epoch: 10, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.688 Vali Acc: 0.270 Test Loss: 1.688 Test Acc: 0.270
Validation loss decreased (-0.229613 --> -0.270353).  Saving model ...
Epoch: 11 cost time: 0.38480377197265625
Epoch: 11, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.666 Vali Acc: 0.293 Test Loss: 1.666 Test Acc: 0.293
Validation loss decreased (-0.270353 --> -0.292576).  Saving model ...
Epoch: 12 cost time: 0.4070279598236084
Epoch: 12, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.642 Vali Acc: 0.322 Test Loss: 1.642 Test Acc: 0.322
Validation loss decreased (-0.292576 --> -0.322206).  Saving model ...
Epoch: 13 cost time: 0.45975589752197266
Epoch: 13, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.618 Vali Acc: 0.337 Test Loss: 1.618 Test Acc: 0.337
Validation loss decreased (-0.322206 --> -0.337021).  Saving model ...
Epoch: 14 cost time: 0.41660451889038086
Epoch: 14, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.592 Vali Acc: 0.374 Test Loss: 1.592 Test Acc: 0.374
Validation loss decreased (-0.337021 --> -0.374058).  Saving model ...
Epoch: 15 cost time: 0.4109823703765869
Epoch: 15, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.566 Vali Acc: 0.407 Test Loss: 1.566 Test Acc: 0.407
Validation loss decreased (-0.374058 --> -0.407392).  Saving model ...
Epoch: 16 cost time: 0.41672348976135254
Epoch: 16, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.539 Vali Acc: 0.448 Test Loss: 1.539 Test Acc: 0.448
Validation loss decreased (-0.407392 --> -0.448133).  Saving model ...
Epoch: 17 cost time: 0.4508178234100342
Epoch: 17, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.511 Vali Acc: 0.478 Test Loss: 1.511 Test Acc: 0.478
Validation loss decreased (-0.448133 --> -0.477763).  Saving model ...
Epoch: 18 cost time: 0.41138529777526855
Epoch: 18, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.483 Vali Acc: 0.522 Test Loss: 1.483 Test Acc: 0.522
Validation loss decreased (-0.477763 --> -0.522207).  Saving model ...
Epoch: 19 cost time: 0.4413893222808838
Epoch: 19, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.455 Vali Acc: 0.552 Test Loss: 1.455 Test Acc: 0.552
Validation loss decreased (-0.522207 --> -0.551837).  Saving model ...
Epoch: 20 cost time: 0.45997166633605957
Epoch: 20, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.427 Vali Acc: 0.567 Test Loss: 1.427 Test Acc: 0.567
Validation loss decreased (-0.551837 --> -0.566652).  Saving model ...
Epoch: 21 cost time: 0.4966561794281006
Epoch: 21, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.399 Vali Acc: 0.589 Test Loss: 1.399 Test Acc: 0.589
Validation loss decreased (-0.566652 --> -0.588875).  Saving model ...
Epoch: 22 cost time: 0.46759462356567383
Epoch: 22, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.371 Vali Acc: 0.596 Test Loss: 1.371 Test Acc: 0.596
Validation loss decreased (-0.588875 --> -0.596283).  Saving model ...
Epoch: 23 cost time: 0.4383988380432129
Epoch: 23, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.342 Vali Acc: 0.604 Test Loss: 1.342 Test Acc: 0.604
Validation loss decreased (-0.596283 --> -0.603690).  Saving model ...
Epoch: 24 cost time: 0.4552948474884033
Epoch: 24, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.313 Vali Acc: 0.619 Test Loss: 1.313 Test Acc: 0.619
Validation loss decreased (-0.603690 --> -0.618505).  Saving model ...
Epoch: 25 cost time: 0.4192769527435303
Epoch: 25, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.284 Vali Acc: 0.637 Test Loss: 1.284 Test Acc: 0.637
Validation loss decreased (-0.618505 --> -0.637024).  Saving model ...
Epoch: 26 cost time: 0.4649074077606201
Epoch: 26, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.255 Vali Acc: 0.656 Test Loss: 1.255 Test Acc: 0.656
Validation loss decreased (-0.637024 --> -0.655543).  Saving model ...
Epoch: 27 cost time: 0.4035968780517578
Epoch: 27, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.225 Vali Acc: 0.667 Test Loss: 1.225 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666654).  Saving model ...
Epoch: 28 cost time: 0.412203311920166
Epoch: 28, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.197 Vali Acc: 0.685 Test Loss: 1.197 Test Acc: 0.685
Validation loss decreased (-0.666654 --> -0.685173).  Saving model ...
Epoch: 29 cost time: 0.37482786178588867
Epoch: 29, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.169 Vali Acc: 0.696 Test Loss: 1.169 Test Acc: 0.696
Validation loss decreased (-0.685173 --> -0.696285).  Saving model ...
Epoch: 30 cost time: 0.423753023147583
Epoch: 30, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.140 Vali Acc: 0.711 Test Loss: 1.140 Test Acc: 0.711
Validation loss decreased (-0.696285 --> -0.711100).  Saving model ...
Epoch: 31 cost time: 0.38610124588012695
Epoch: 31, Steps: 2 | Train Loss: 1.038 Vali Loss: 1.113 Vali Acc: 0.719 Test Loss: 1.113 Test Acc: 0.719
Validation loss decreased (-0.711100 --> -0.718507).  Saving model ...
Epoch: 32 cost time: 0.4398353099822998
Epoch: 32, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.085 Vali Acc: 0.733 Test Loss: 1.085 Test Acc: 0.733
Validation loss decreased (-0.718507 --> -0.733322).  Saving model ...
Epoch: 33 cost time: 0.4782109260559082
Epoch: 33, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.057 Vali Acc: 0.741 Test Loss: 1.057 Test Acc: 0.741
Validation loss decreased (-0.733322 --> -0.740730).  Saving model ...
Epoch: 34 cost time: 0.609560489654541
Epoch: 34, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.030 Vali Acc: 0.744 Test Loss: 1.030 Test Acc: 0.744
Validation loss decreased (-0.740730 --> -0.744434).  Saving model ...
Epoch: 35 cost time: 0.4420924186706543
Epoch: 35, Steps: 2 | Train Loss: 0.928 Vali Loss: 1.004 Vali Acc: 0.763 Test Loss: 1.004 Test Acc: 0.763
Validation loss decreased (-0.744434 --> -0.762953).  Saving model ...
Epoch: 36 cost time: 0.4414374828338623
Epoch: 36, Steps: 2 | Train Loss: 0.927 Vali Loss: 0.978 Vali Acc: 0.767 Test Loss: 0.978 Test Acc: 0.767
Validation loss decreased (-0.762953 --> -0.766657).  Saving model ...
Epoch: 37 cost time: 0.49501466751098633
Epoch: 37, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.951 Vali Acc: 0.793 Test Loss: 0.951 Test Acc: 0.793
Validation loss decreased (-0.766657 --> -0.792583).  Saving model ...
Epoch: 38 cost time: 0.43209004402160645
Epoch: 38, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.926 Vali Acc: 0.800 Test Loss: 0.926 Test Acc: 0.800
Validation loss decreased (-0.792583 --> -0.799991).  Saving model ...
Epoch: 39 cost time: 0.3831484317779541
Epoch: 39, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.901 Vali Acc: 0.804 Test Loss: 0.901 Test Acc: 0.804
Validation loss decreased (-0.799991 --> -0.803695).  Saving model ...
Epoch: 40 cost time: 0.47010111808776855
Epoch: 40, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.876 Vali Acc: 0.819 Test Loss: 0.876 Test Acc: 0.819
Validation loss decreased (-0.803695 --> -0.818510).  Saving model ...
Epoch: 41 cost time: 0.4326155185699463
Epoch: 41, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.852 Vali Acc: 0.822 Test Loss: 0.852 Test Acc: 0.822
Validation loss decreased (-0.818510 --> -0.822214).  Saving model ...
Epoch: 42 cost time: 0.4696004390716553
Epoch: 42, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.828 Vali Acc: 0.830 Test Loss: 0.828 Test Acc: 0.830
Validation loss decreased (-0.822214 --> -0.829621).  Saving model ...
Epoch: 43 cost time: 0.4559609889984131
Epoch: 43, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.805 Vali Acc: 0.833 Test Loss: 0.805 Test Acc: 0.833
Validation loss decreased (-0.829621 --> -0.833325).  Saving model ...
Epoch: 44 cost time: 0.4305849075317383
Epoch: 44, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.783 Vali Acc: 0.833 Test Loss: 0.783 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833326).  Saving model ...
Epoch: 45 cost time: 0.41763854026794434
Epoch: 45, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.762 Vali Acc: 0.844 Test Loss: 0.762 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 46 cost time: 0.4247438907623291
Epoch: 46, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.741 Vali Acc: 0.844 Test Loss: 0.741 Test Acc: 0.844
Validation loss decreased (-0.844437 --> -0.844437).  Saving model ...
Epoch: 47 cost time: 0.43639564514160156
Epoch: 47, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.722 Vali Acc: 0.848 Test Loss: 0.722 Test Acc: 0.848
Validation loss decreased (-0.844437 --> -0.848141).  Saving model ...
Epoch: 48 cost time: 0.4021186828613281
Epoch: 48, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.703 Vali Acc: 0.852 Test Loss: 0.703 Test Acc: 0.852
Validation loss decreased (-0.848141 --> -0.851845).  Saving model ...
Epoch: 49 cost time: 0.42251062393188477
Epoch: 49, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.686 Vali Acc: 0.867 Test Loss: 0.686 Test Acc: 0.867
Validation loss decreased (-0.851845 --> -0.866660).  Saving model ...
Epoch: 50 cost time: 0.45015525817871094
Epoch: 50, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.668 Vali Acc: 0.867 Test Loss: 0.668 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 51 cost time: 0.4263451099395752
Epoch: 51, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.651 Vali Acc: 0.874 Test Loss: 0.651 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874068).  Saving model ...
Epoch: 52 cost time: 0.46236753463745117
Epoch: 52, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.635 Vali Acc: 0.881 Test Loss: 0.635 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881475).  Saving model ...
Epoch: 53 cost time: 0.4461944103240967
Epoch: 53, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.620 Vali Acc: 0.885 Test Loss: 0.620 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 54 cost time: 0.45002222061157227
Epoch: 54, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.605 Vali Acc: 0.885 Test Loss: 0.605 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 55 cost time: 0.43225717544555664
Epoch: 55, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.591 Vali Acc: 0.893 Test Loss: 0.591 Test Acc: 0.893
Validation loss decreased (-0.885179 --> -0.892587).  Saving model ...
Epoch: 56 cost time: 0.46107912063598633
Epoch: 56, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.578 Vali Acc: 0.893 Test Loss: 0.578 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 57 cost time: 0.4774594306945801
Epoch: 57, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.564 Vali Acc: 0.900 Test Loss: 0.564 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899994).  Saving model ...
Epoch: 58 cost time: 0.4652118682861328
Epoch: 58, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.552 Vali Acc: 0.900 Test Loss: 0.552 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 59 cost time: 0.43802618980407715
Epoch: 59, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.540 Vali Acc: 0.896 Test Loss: 0.540 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.4461839199066162
Epoch: 60, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 61 cost time: 0.5341572761535645
Epoch: 61, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 62 cost time: 0.47371673583984375
Epoch: 62, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 63 cost time: 0.4908313751220703
Epoch: 63, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 64 cost time: 0.4701235294342041
Epoch: 64, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.487 Vali Acc: 0.904 Test Loss: 0.487 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 65 cost time: 0.4886000156402588
Epoch: 65, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.477 Vali Acc: 0.907 Test Loss: 0.477 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 66 cost time: 0.4049720764160156
Epoch: 66, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.468 Vali Acc: 0.904 Test Loss: 0.468 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5075960159301758
Epoch: 67, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.459 Vali Acc: 0.919 Test Loss: 0.459 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918514).  Saving model ...
Epoch: 68 cost time: 0.5534415245056152
Epoch: 68, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.451 Vali Acc: 0.922 Test Loss: 0.451 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 69 cost time: 0.44791722297668457
Epoch: 69, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.442 Vali Acc: 0.926 Test Loss: 0.442 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 70 cost time: 0.4029557704925537
Epoch: 70, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.435 Vali Acc: 0.926 Test Loss: 0.435 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 71 cost time: 0.4310801029205322
Epoch: 71, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.427 Vali Acc: 0.930 Test Loss: 0.427 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929625).  Saving model ...
Epoch: 72 cost time: 0.42841601371765137
Epoch: 72, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.419 Vali Acc: 0.930 Test Loss: 0.419 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 73 cost time: 0.37709569931030273
Epoch: 73, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.412 Vali Acc: 0.933 Test Loss: 0.412 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 74 cost time: 0.41907262802124023
Epoch: 74, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.405 Vali Acc: 0.933 Test Loss: 0.405 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 75 cost time: 0.4933803081512451
Epoch: 75, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.398 Vali Acc: 0.933 Test Loss: 0.398 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 76 cost time: 0.41156554222106934
Epoch: 76, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.393 Vali Acc: 0.937 Test Loss: 0.393 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 77 cost time: 0.4925954341888428
Epoch: 77, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.388 Vali Acc: 0.937 Test Loss: 0.388 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 78 cost time: 0.5218663215637207
Epoch: 78, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.382 Vali Acc: 0.937 Test Loss: 0.382 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 79 cost time: 0.46265125274658203
Epoch: 79, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.377 Vali Acc: 0.937 Test Loss: 0.377 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 80 cost time: 0.4435546398162842
Epoch: 80, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.373 Vali Acc: 0.944 Test Loss: 0.373 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944441).  Saving model ...
Epoch: 81 cost time: 0.46571946144104004
Epoch: 81, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.369 Vali Acc: 0.944 Test Loss: 0.369 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 82 cost time: 0.48056769371032715
Epoch: 82, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.364 Vali Acc: 0.948 Test Loss: 0.364 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 83 cost time: 0.42902159690856934
Epoch: 83, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.360 Vali Acc: 0.952 Test Loss: 0.360 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951848).  Saving model ...
Epoch: 84 cost time: 0.4492173194885254
Epoch: 84, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.356 Vali Acc: 0.956 Test Loss: 0.356 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 85 cost time: 0.428499698638916
Epoch: 85, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.351 Vali Acc: 0.956 Test Loss: 0.351 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 86 cost time: 0.4785757064819336
Epoch: 86, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.347 Vali Acc: 0.956 Test Loss: 0.347 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 87 cost time: 0.45176219940185547
Epoch: 87, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.342 Vali Acc: 0.956 Test Loss: 0.342 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 88 cost time: 0.4573984146118164
Epoch: 88, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.338 Vali Acc: 0.956 Test Loss: 0.338 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 89 cost time: 0.4800117015838623
Epoch: 89, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.334 Vali Acc: 0.956 Test Loss: 0.334 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 90 cost time: 0.4349675178527832
Epoch: 90, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.330 Vali Acc: 0.956 Test Loss: 0.330 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 91 cost time: 0.39254212379455566
Epoch: 91, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.326 Vali Acc: 0.956 Test Loss: 0.326 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 92 cost time: 0.382082462310791
Epoch: 92, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.322 Vali Acc: 0.956 Test Loss: 0.322 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 93 cost time: 0.4416213035583496
Epoch: 93, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.318 Vali Acc: 0.952 Test Loss: 0.318 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.43295812606811523
Epoch: 94, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.315 Vali Acc: 0.959 Test Loss: 0.315 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 95 cost time: 0.5573937892913818
Epoch: 95, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.311 Vali Acc: 0.959 Test Loss: 0.311 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 96 cost time: 0.47591614723205566
Epoch: 96, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.308 Vali Acc: 0.956 Test Loss: 0.308 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.4714682102203369
Epoch: 97, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.305 Vali Acc: 0.956 Test Loss: 0.305 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.4832472801208496
Epoch: 98, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.301 Vali Acc: 0.956 Test Loss: 0.301 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.4676673412322998
Epoch: 99, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.298 Vali Acc: 0.956 Test Loss: 0.298 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.5385937690734863
Epoch: 100, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.295 Vali Acc: 0.959 Test Loss: 0.295 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 8390
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8597612380981445
Epoch: 1, Steps: 2 | Train Loss: 2.043 Vali Loss: 1.970 Vali Acc: 0.156 Test Loss: 1.970 Test Acc: 0.156
Validation loss decreased (inf --> -0.155536).  Saving model ...
Epoch: 2 cost time: 0.4123265743255615
Epoch: 2, Steps: 2 | Train Loss: 1.961 Vali Loss: 1.893 Vali Acc: 0.174 Test Loss: 1.893 Test Acc: 0.174
Validation loss decreased (-0.155536 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 0.4554736614227295
Epoch: 3, Steps: 2 | Train Loss: 2.054 Vali Loss: 1.828 Vali Acc: 0.196 Test Loss: 1.828 Test Acc: 0.196
Validation loss decreased (-0.174055 --> -0.196278).  Saving model ...
Epoch: 4 cost time: 0.4306821823120117
Epoch: 4, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.753 Vali Acc: 0.226 Test Loss: 1.753 Test Acc: 0.226
Validation loss decreased (-0.196278 --> -0.225908).  Saving model ...
Epoch: 5 cost time: 0.44705724716186523
Epoch: 5, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.659 Vali Acc: 0.248 Test Loss: 1.659 Test Acc: 0.248
Validation loss decreased (-0.225908 --> -0.248132).  Saving model ...
Epoch: 6 cost time: 0.45404744148254395
Epoch: 6, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.554 Vali Acc: 0.304 Test Loss: 1.554 Test Acc: 0.304
Validation loss decreased (-0.248132 --> -0.303688).  Saving model ...
Epoch: 7 cost time: 0.47603464126586914
Epoch: 7, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.445 Vali Acc: 0.437 Test Loss: 1.445 Test Acc: 0.437
Validation loss decreased (-0.303688 --> -0.437023).  Saving model ...
Epoch: 8 cost time: 0.41485142707824707
Epoch: 8, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.336 Vali Acc: 0.563 Test Loss: 1.336 Test Acc: 0.563
Validation loss decreased (-0.437023 --> -0.562950).  Saving model ...
Epoch: 9 cost time: 0.3822665214538574
Epoch: 9, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.237 Vali Acc: 0.596 Test Loss: 1.237 Test Acc: 0.596
Validation loss decreased (-0.562950 --> -0.596284).  Saving model ...
Epoch: 10 cost time: 0.5294089317321777
Epoch: 10, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.138 Vali Acc: 0.626 Test Loss: 1.138 Test Acc: 0.626
Validation loss decreased (-0.596284 --> -0.625915).  Saving model ...
Epoch: 11 cost time: 0.4050009250640869
Epoch: 11, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.043 Vali Acc: 0.674 Test Loss: 1.043 Test Acc: 0.674
Validation loss decreased (-0.625915 --> -0.674064).  Saving model ...
Epoch: 12 cost time: 0.38901495933532715
Epoch: 12, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.952 Vali Acc: 0.715 Test Loss: 0.952 Test Acc: 0.715
Validation loss decreased (-0.674064 --> -0.714805).  Saving model ...
Epoch: 13 cost time: 0.3961474895477295
Epoch: 13, Steps: 2 | Train Loss: 0.858 Vali Loss: 0.867 Vali Acc: 0.774 Test Loss: 0.867 Test Acc: 0.774
Validation loss decreased (-0.714805 --> -0.774065).  Saving model ...
Epoch: 14 cost time: 0.4282803535461426
Epoch: 14, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.790 Vali Acc: 0.807 Test Loss: 0.790 Test Acc: 0.807
Validation loss decreased (-0.774065 --> -0.807400).  Saving model ...
Epoch: 15 cost time: 0.4830353260040283
Epoch: 15, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.720 Vali Acc: 0.856 Test Loss: 0.720 Test Acc: 0.856
Validation loss decreased (-0.807400 --> -0.855548).  Saving model ...
Epoch: 16 cost time: 0.46761441230773926
Epoch: 16, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.656 Vali Acc: 0.870 Test Loss: 0.656 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870364).  Saving model ...
Epoch: 17 cost time: 0.45453715324401855
Epoch: 17, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3925812244415283
Epoch: 18, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.549 Vali Acc: 0.881 Test Loss: 0.549 Test Acc: 0.881
Validation loss decreased (-0.870364 --> -0.881476).  Saving model ...
Epoch: 19 cost time: 0.414886474609375
Epoch: 19, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 20 cost time: 0.42415499687194824
Epoch: 20, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.4349849224090576
Epoch: 21, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.44603729248046875
Epoch: 22, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.4545009136199951
Epoch: 23, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.366 Vali Acc: 0.911 Test Loss: 0.366 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911107).  Saving model ...
Epoch: 24 cost time: 0.39656639099121094
Epoch: 24, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.341 Vali Acc: 0.911 Test Loss: 0.341 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 25 cost time: 0.3916592597961426
Epoch: 25, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 26 cost time: 0.4085819721221924
Epoch: 26, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 27 cost time: 0.3758516311645508
Epoch: 27, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933330).  Saving model ...
Epoch: 28 cost time: 0.4097263813018799
Epoch: 28, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.48949241638183594
Epoch: 29, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5464696884155273
Epoch: 30, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.42385125160217285
Epoch: 31, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.44606542587280273
Epoch: 32, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.4505643844604492
Epoch: 33, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.43491053581237793
Epoch: 34, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.39622020721435547
Epoch: 35, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.44733095169067383
Epoch: 36, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.40346813201904297
Epoch: 37, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4343695640563965
Epoch: 38, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.43353819847106934
Epoch: 39, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.46135663986206055
Epoch: 40, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.4141359329223633
Epoch: 41, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.49179863929748535
Epoch: 42, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 28310
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.018528461456299
Epoch: 1, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.895 Vali Acc: 0.067 Test Loss: 1.895 Test Acc: 0.067
Validation loss decreased (inf --> -0.066648).  Saving model ...
Epoch: 2 cost time: 0.4597012996673584
Epoch: 2, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.836 Vali Acc: 0.067 Test Loss: 1.836 Test Acc: 0.067
Validation loss decreased (-0.066648 --> -0.066648).  Saving model ...
Epoch: 3 cost time: 0.4920353889465332
Epoch: 3, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.791 Vali Acc: 0.070 Test Loss: 1.791 Test Acc: 0.070
Validation loss decreased (-0.066648 --> -0.070352).  Saving model ...
Epoch: 4 cost time: 0.4363124370574951
Epoch: 4, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.748 Vali Acc: 0.081 Test Loss: 1.748 Test Acc: 0.081
Validation loss decreased (-0.070352 --> -0.081464).  Saving model ...
Epoch: 5 cost time: 0.4459822177886963
Epoch: 5, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.698 Vali Acc: 0.141 Test Loss: 1.698 Test Acc: 0.141
Validation loss decreased (-0.081464 --> -0.140724).  Saving model ...
Epoch: 6 cost time: 0.4805583953857422
Epoch: 6, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.643 Vali Acc: 0.237 Test Loss: 1.643 Test Acc: 0.237
Validation loss decreased (-0.140724 --> -0.237021).  Saving model ...
Epoch: 7 cost time: 0.4946115016937256
Epoch: 7, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.584 Vali Acc: 0.270 Test Loss: 1.584 Test Acc: 0.270
Validation loss decreased (-0.237021 --> -0.270355).  Saving model ...
Epoch: 8 cost time: 0.4535362720489502
Epoch: 8, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.524 Vali Acc: 0.330 Test Loss: 1.524 Test Acc: 0.330
Validation loss decreased (-0.270355 --> -0.329614).  Saving model ...
Epoch: 9 cost time: 0.41966915130615234
Epoch: 9, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.461 Vali Acc: 0.370 Test Loss: 1.461 Test Acc: 0.370
Validation loss decreased (-0.329614 --> -0.370356).  Saving model ...
Epoch: 10 cost time: 0.43024539947509766
Epoch: 10, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.396 Vali Acc: 0.437 Test Loss: 1.396 Test Acc: 0.437
Validation loss decreased (-0.370356 --> -0.437023).  Saving model ...
Epoch: 11 cost time: 0.41991162300109863
Epoch: 11, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.331 Vali Acc: 0.530 Test Loss: 1.331 Test Acc: 0.530
Validation loss decreased (-0.437023 --> -0.529616).  Saving model ...
Epoch: 12 cost time: 0.40291595458984375
Epoch: 12, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.266 Vali Acc: 0.593 Test Loss: 1.266 Test Acc: 0.593
Validation loss decreased (-0.529616 --> -0.592580).  Saving model ...
Epoch: 13 cost time: 0.4788038730621338
Epoch: 13, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.201 Vali Acc: 0.667 Test Loss: 1.201 Test Acc: 0.667
Validation loss decreased (-0.592580 --> -0.666655).  Saving model ...
Epoch: 14 cost time: 0.44837117195129395
Epoch: 14, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.138 Vali Acc: 0.719 Test Loss: 1.138 Test Acc: 0.719
Validation loss decreased (-0.666655 --> -0.718507).  Saving model ...
Epoch: 15 cost time: 0.4524953365325928
Epoch: 15, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.076 Vali Acc: 0.767 Test Loss: 1.076 Test Acc: 0.767
Validation loss decreased (-0.718507 --> -0.766656).  Saving model ...
Epoch: 16 cost time: 0.45029139518737793
Epoch: 16, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.017 Vali Acc: 0.800 Test Loss: 1.017 Test Acc: 0.800
Validation loss decreased (-0.766656 --> -0.799990).  Saving model ...
Epoch: 17 cost time: 0.48178601264953613
Epoch: 17, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.961 Vali Acc: 0.815 Test Loss: 0.961 Test Acc: 0.815
Validation loss decreased (-0.799990 --> -0.814805).  Saving model ...
Epoch: 18 cost time: 0.43012237548828125
Epoch: 18, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.906 Vali Acc: 0.844 Test Loss: 0.906 Test Acc: 0.844
Validation loss decreased (-0.814805 --> -0.844435).  Saving model ...
Epoch: 19 cost time: 0.4687972068786621
Epoch: 19, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.855 Vali Acc: 0.859 Test Loss: 0.855 Test Acc: 0.859
Validation loss decreased (-0.844435 --> -0.859251).  Saving model ...
Epoch: 20 cost time: 0.5217249393463135
Epoch: 20, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.808 Vali Acc: 0.878 Test Loss: 0.808 Test Acc: 0.878
Validation loss decreased (-0.859251 --> -0.877770).  Saving model ...
Epoch: 21 cost time: 0.46485257148742676
Epoch: 21, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.762 Vali Acc: 0.900 Test Loss: 0.762 Test Acc: 0.900
Validation loss decreased (-0.877770 --> -0.899992).  Saving model ...
Epoch: 22 cost time: 0.4249393939971924
Epoch: 22, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.719 Vali Acc: 0.896 Test Loss: 0.719 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4374983310699463
Epoch: 23, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.679 Vali Acc: 0.900 Test Loss: 0.679 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 0.4057769775390625
Epoch: 24, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.643 Vali Acc: 0.900 Test Loss: 0.643 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.4958798885345459
Epoch: 25, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.607 Vali Acc: 0.915 Test Loss: 0.607 Test Acc: 0.915
Validation loss decreased (-0.899994 --> -0.914809).  Saving model ...
Epoch: 26 cost time: 0.4268815517425537
Epoch: 26, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.574 Vali Acc: 0.922 Test Loss: 0.574 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922216).  Saving model ...
Epoch: 27 cost time: 0.43003201484680176
Epoch: 27, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.542 Vali Acc: 0.930 Test Loss: 0.542 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 28 cost time: 0.43806958198547363
Epoch: 28, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.515 Vali Acc: 0.926 Test Loss: 0.515 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.47797560691833496
Epoch: 29, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.491 Vali Acc: 0.930 Test Loss: 0.491 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 30 cost time: 0.44278550148010254
Epoch: 30, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.467 Vali Acc: 0.930 Test Loss: 0.467 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 31 cost time: 0.45133137702941895
Epoch: 31, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.445 Vali Acc: 0.933 Test Loss: 0.445 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 32 cost time: 0.44106125831604004
Epoch: 32, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.423 Vali Acc: 0.933 Test Loss: 0.423 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 33 cost time: 0.5167341232299805
Epoch: 33, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.403 Vali Acc: 0.933 Test Loss: 0.403 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 34 cost time: 0.4928443431854248
Epoch: 34, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.383 Vali Acc: 0.941 Test Loss: 0.383 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.4820549488067627
Epoch: 35, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.365 Vali Acc: 0.944 Test Loss: 0.365 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 36 cost time: 0.4369840621948242
Epoch: 36, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.351 Vali Acc: 0.941 Test Loss: 0.351 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5188894271850586
Epoch: 37, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.339 Vali Acc: 0.941 Test Loss: 0.339 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.542863130569458
Epoch: 38, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.329 Vali Acc: 0.937 Test Loss: 0.329 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4662487506866455
Epoch: 39, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.319 Vali Acc: 0.937 Test Loss: 0.319 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.4047257900238037
Epoch: 40, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.310 Vali Acc: 0.937 Test Loss: 0.310 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.4194459915161133
Epoch: 41, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.46468234062194824
Epoch: 42, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.48126792907714844
Epoch: 43, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.286 Vali Acc: 0.941 Test Loss: 0.286 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.47883033752441406
Epoch: 44, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.279 Vali Acc: 0.948 Test Loss: 0.279 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 45 cost time: 0.460052490234375
Epoch: 45, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.274 Vali Acc: 0.948 Test Loss: 0.274 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 46 cost time: 0.41304445266723633
Epoch: 46, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.47286105155944824
Epoch: 47, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4746217727661133
Epoch: 48, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.444812536239624
Epoch: 49, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.256 Vali Acc: 0.948 Test Loss: 0.256 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.4371340274810791
Epoch: 50, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 51 cost time: 0.45109128952026367
Epoch: 51, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 52 cost time: 0.4883463382720947
Epoch: 52, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.249 Vali Acc: 0.948 Test Loss: 0.249 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 53 cost time: 0.41721320152282715
Epoch: 53, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.246 Vali Acc: 0.948 Test Loss: 0.246 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 54 cost time: 0.5695240497589111
Epoch: 54, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 55 cost time: 0.4663581848144531
Epoch: 55, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 56 cost time: 0.40424585342407227
Epoch: 56, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.239 Vali Acc: 0.948 Test Loss: 0.239 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 57 cost time: 0.4516003131866455
Epoch: 57, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.236 Vali Acc: 0.948 Test Loss: 0.236 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 58 cost time: 0.45029139518737793
Epoch: 58, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 59 cost time: 0.484591007232666
Epoch: 59, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 60 cost time: 0.41253042221069336
Epoch: 60, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 61 cost time: 0.40940427780151367
Epoch: 61, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.227 Vali Acc: 0.948 Test Loss: 0.227 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 62 cost time: 0.46137452125549316
Epoch: 62, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.225 Vali Acc: 0.948 Test Loss: 0.225 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 63 cost time: 0.4470658302307129
Epoch: 63, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 64 cost time: 0.44380950927734375
Epoch: 64, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 65 cost time: 0.4189727306365967
Epoch: 65, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.948 Test Loss: 0.219 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 66 cost time: 0.4365048408508301
Epoch: 66, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 67 cost time: 0.4726552963256836
Epoch: 67, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 68 cost time: 0.4041006565093994
Epoch: 68, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 69 cost time: 0.4324941635131836
Epoch: 69, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 70 cost time: 0.4815530776977539
Epoch: 70, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 71 cost time: 0.4954075813293457
Epoch: 71, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 72 cost time: 0.493560791015625
Epoch: 72, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 73 cost time: 0.4488992691040039
Epoch: 73, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 74 cost time: 0.48502373695373535
Epoch: 74, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 75 cost time: 0.4792661666870117
Epoch: 75, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 76 cost time: 0.4141056537628174
Epoch: 76, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 77 cost time: 0.41496801376342773
Epoch: 77, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 78 cost time: 0.38477110862731934
Epoch: 78, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.4258763790130615
Epoch: 79, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.45267200469970703
Epoch: 80, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.389406681060791
Epoch: 81, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.43187594413757324
Epoch: 82, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.4604463577270508
Epoch: 83, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.5121278762817383
Epoch: 84, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.4820847511291504
Epoch: 85, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 86 cost time: 0.49249887466430664
Epoch: 86, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 87 cost time: 0.5057187080383301
Epoch: 87, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 88 cost time: 0.481168270111084
Epoch: 88, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 89 cost time: 0.4936366081237793
Epoch: 89, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 90 cost time: 0.4368550777435303
Epoch: 90, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 91 cost time: 0.4754304885864258
Epoch: 91, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 92 cost time: 0.5721163749694824
Epoch: 92, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 93 cost time: 0.38225340843200684
Epoch: 93, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 94 cost time: 0.4259157180786133
Epoch: 94, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 95 cost time: 0.4275670051574707
Epoch: 95, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 96 cost time: 0.41666197776794434
Epoch: 96, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 97 cost time: 0.45697879791259766
Epoch: 97, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 98 cost time: 0.42876243591308594
Epoch: 98, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 99 cost time: 0.4091603755950928
Epoch: 99, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 100 cost time: 0.4053380489349365
Epoch: 100, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 15670
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0239150524139404
Epoch: 1, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.887 Vali Acc: 0.156 Test Loss: 1.887 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 0.46120500564575195
Epoch: 2, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.847 Vali Acc: 0.170 Test Loss: 1.847 Test Acc: 0.170
Validation loss decreased (-0.155537 --> -0.170352).  Saving model ...
Epoch: 3 cost time: 0.5405063629150391
Epoch: 3, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.817 Vali Acc: 0.189 Test Loss: 1.817 Test Acc: 0.189
Validation loss decreased (-0.170352 --> -0.188871).  Saving model ...
Epoch: 4 cost time: 0.46483731269836426
Epoch: 4, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.790 Vali Acc: 0.204 Test Loss: 1.790 Test Acc: 0.204
Validation loss decreased (-0.188871 --> -0.203686).  Saving model ...
Epoch: 5 cost time: 0.4552624225616455
Epoch: 5, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.755 Vali Acc: 0.252 Test Loss: 1.755 Test Acc: 0.252
Validation loss decreased (-0.203686 --> -0.251834).  Saving model ...
Epoch: 6 cost time: 0.45575761795043945
Epoch: 6, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.713 Vali Acc: 0.300 Test Loss: 1.713 Test Acc: 0.300
Validation loss decreased (-0.251834 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 0.45319199562072754
Epoch: 7, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.663 Vali Acc: 0.363 Test Loss: 1.663 Test Acc: 0.363
Validation loss decreased (-0.299983 --> -0.362946).  Saving model ...
Epoch: 8 cost time: 0.3656916618347168
Epoch: 8, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.608 Vali Acc: 0.415 Test Loss: 1.608 Test Acc: 0.415
Validation loss decreased (-0.362946 --> -0.414799).  Saving model ...
Epoch: 9 cost time: 0.38982319831848145
Epoch: 9, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.549 Vali Acc: 0.441 Test Loss: 1.549 Test Acc: 0.441
Validation loss decreased (-0.414799 --> -0.440725).  Saving model ...
Epoch: 10 cost time: 0.3704543113708496
Epoch: 10, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.487 Vali Acc: 0.467 Test Loss: 1.487 Test Acc: 0.467
Validation loss decreased (-0.440725 --> -0.466652).  Saving model ...
Epoch: 11 cost time: 0.41333603858947754
Epoch: 11, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.424 Vali Acc: 0.511 Test Loss: 1.424 Test Acc: 0.511
Validation loss decreased (-0.466652 --> -0.511097).  Saving model ...
Epoch: 12 cost time: 0.4706449508666992
Epoch: 12, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.360 Vali Acc: 0.563 Test Loss: 1.360 Test Acc: 0.563
Validation loss decreased (-0.511097 --> -0.562949).  Saving model ...
Epoch: 13 cost time: 0.44087672233581543
Epoch: 13, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.296 Vali Acc: 0.596 Test Loss: 1.296 Test Acc: 0.596
Validation loss decreased (-0.562949 --> -0.596283).  Saving model ...
Epoch: 14 cost time: 0.5015919208526611
Epoch: 14, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.232 Vali Acc: 0.633 Test Loss: 1.232 Test Acc: 0.633
Validation loss decreased (-0.596283 --> -0.633321).  Saving model ...
Epoch: 15 cost time: 0.4550354480743408
Epoch: 15, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.169 Vali Acc: 0.663 Test Loss: 1.169 Test Acc: 0.663
Validation loss decreased (-0.633321 --> -0.662951).  Saving model ...
Epoch: 16 cost time: 0.4477088451385498
Epoch: 16, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.108 Vali Acc: 0.689 Test Loss: 1.108 Test Acc: 0.689
Validation loss decreased (-0.662951 --> -0.688878).  Saving model ...
Epoch: 17 cost time: 0.4134371280670166
Epoch: 17, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.049 Vali Acc: 0.733 Test Loss: 1.049 Test Acc: 0.733
Validation loss decreased (-0.688878 --> -0.733323).  Saving model ...
Epoch: 18 cost time: 0.5173828601837158
Epoch: 18, Steps: 2 | Train Loss: 0.965 Vali Loss: 0.992 Vali Acc: 0.756 Test Loss: 0.992 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755546).  Saving model ...
Epoch: 19 cost time: 0.44018030166625977
Epoch: 19, Steps: 2 | Train Loss: 0.899 Vali Loss: 0.937 Vali Acc: 0.800 Test Loss: 0.937 Test Acc: 0.800
Validation loss decreased (-0.755546 --> -0.799991).  Saving model ...
Epoch: 20 cost time: 0.46941399574279785
Epoch: 20, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.886 Vali Acc: 0.819 Test Loss: 0.886 Test Acc: 0.819
Validation loss decreased (-0.799991 --> -0.818510).  Saving model ...
Epoch: 21 cost time: 0.47809576988220215
Epoch: 21, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.837 Vali Acc: 0.830 Test Loss: 0.837 Test Acc: 0.830
Validation loss decreased (-0.818510 --> -0.829621).  Saving model ...
Epoch: 22 cost time: 0.534332275390625
Epoch: 22, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.791 Vali Acc: 0.837 Test Loss: 0.791 Test Acc: 0.837
Validation loss decreased (-0.829621 --> -0.837029).  Saving model ...
Epoch: 23 cost time: 0.4412832260131836
Epoch: 23, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.748 Vali Acc: 0.859 Test Loss: 0.748 Test Acc: 0.859
Validation loss decreased (-0.837029 --> -0.859252).  Saving model ...
Epoch: 24 cost time: 0.46268630027770996
Epoch: 24, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.707 Vali Acc: 0.859 Test Loss: 0.707 Test Acc: 0.859
Validation loss decreased (-0.859252 --> -0.859252).  Saving model ...
Epoch: 25 cost time: 0.57881760597229
Epoch: 25, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.669 Vali Acc: 0.870 Test Loss: 0.669 Test Acc: 0.870
Validation loss decreased (-0.859252 --> -0.870364).  Saving model ...
Epoch: 26 cost time: 0.4448549747467041
Epoch: 26, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.633 Vali Acc: 0.885 Test Loss: 0.633 Test Acc: 0.885
Validation loss decreased (-0.870364 --> -0.885179).  Saving model ...
Epoch: 27 cost time: 0.5030579566955566
Epoch: 27, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.601 Vali Acc: 0.893 Test Loss: 0.601 Test Acc: 0.893
Validation loss decreased (-0.885179 --> -0.892587).  Saving model ...
Epoch: 28 cost time: 0.48422980308532715
Epoch: 28, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.571 Vali Acc: 0.896 Test Loss: 0.571 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 29 cost time: 0.4565925598144531
Epoch: 29, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.543 Vali Acc: 0.900 Test Loss: 0.543 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.4209463596343994
Epoch: 30, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.517 Vali Acc: 0.911 Test Loss: 0.517 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911106).  Saving model ...
Epoch: 31 cost time: 0.5095827579498291
Epoch: 31, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.492 Vali Acc: 0.919 Test Loss: 0.492 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 32 cost time: 0.4571096897125244
Epoch: 32, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.470 Vali Acc: 0.919 Test Loss: 0.470 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 33 cost time: 0.43682169914245605
Epoch: 33, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.450 Vali Acc: 0.922 Test Loss: 0.450 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 34 cost time: 0.41092967987060547
Epoch: 34, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.431 Vali Acc: 0.930 Test Loss: 0.431 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929625).  Saving model ...
Epoch: 35 cost time: 0.5214300155639648
Epoch: 35, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.415 Vali Acc: 0.933 Test Loss: 0.415 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 36 cost time: 0.45226526260375977
Epoch: 36, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.399 Vali Acc: 0.933 Test Loss: 0.399 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 37 cost time: 0.36302924156188965
Epoch: 37, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.386 Vali Acc: 0.933 Test Loss: 0.386 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 38 cost time: 0.462416410446167
Epoch: 38, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.373 Vali Acc: 0.933 Test Loss: 0.373 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 39 cost time: 0.4886603355407715
Epoch: 39, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.361 Vali Acc: 0.933 Test Loss: 0.361 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 40 cost time: 0.4645845890045166
Epoch: 40, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.351 Vali Acc: 0.933 Test Loss: 0.351 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 41 cost time: 0.4529454708099365
Epoch: 41, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 0.498035192489624
Epoch: 42, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.332 Vali Acc: 0.937 Test Loss: 0.332 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 43 cost time: 0.4578423500061035
Epoch: 43, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.325 Vali Acc: 0.930 Test Loss: 0.325 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.41555047035217285
Epoch: 44, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.318 Vali Acc: 0.926 Test Loss: 0.318 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.43805575370788574
Epoch: 45, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.311 Vali Acc: 0.930 Test Loss: 0.311 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6069962978363037
Epoch: 46, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.48810315132141113
Epoch: 47, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.47133469581604004
Epoch: 48, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.47327542304992676
Epoch: 49, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.286 Vali Acc: 0.933 Test Loss: 0.286 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.48873043060302734
Epoch: 50, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.42516660690307617
Epoch: 51, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.46657633781433105
Epoch: 52, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 11846
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7492516040802002
Epoch: 1, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.825 Vali Acc: 0.174 Test Loss: 1.825 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.43431615829467773
Epoch: 2, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.785 Vali Acc: 0.200 Test Loss: 1.785 Test Acc: 0.200
Validation loss decreased (-0.174056 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.4377572536468506
Epoch: 3, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.755 Vali Acc: 0.207 Test Loss: 1.755 Test Acc: 0.207
Validation loss decreased (-0.199982 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.43639516830444336
Epoch: 4, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.732 Vali Acc: 0.226 Test Loss: 1.732 Test Acc: 0.226
Validation loss decreased (-0.207390 --> -0.225909).  Saving model ...
Epoch: 5 cost time: 0.45490336418151855
Epoch: 5, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.705 Vali Acc: 0.263 Test Loss: 1.705 Test Acc: 0.263
Validation loss decreased (-0.225909 --> -0.262946).  Saving model ...
Epoch: 6 cost time: 0.49396371841430664
Epoch: 6, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.674 Vali Acc: 0.289 Test Loss: 1.674 Test Acc: 0.289
Validation loss decreased (-0.262946 --> -0.288872).  Saving model ...
Epoch: 7 cost time: 0.4758172035217285
Epoch: 7, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.641 Vali Acc: 0.322 Test Loss: 1.641 Test Acc: 0.322
Validation loss decreased (-0.288872 --> -0.322206).  Saving model ...
Epoch: 8 cost time: 0.5230648517608643
Epoch: 8, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.603 Vali Acc: 0.363 Test Loss: 1.603 Test Acc: 0.363
Validation loss decreased (-0.322206 --> -0.362947).  Saving model ...
Epoch: 9 cost time: 0.4485464096069336
Epoch: 9, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.564 Vali Acc: 0.389 Test Loss: 1.564 Test Acc: 0.389
Validation loss decreased (-0.362947 --> -0.388873).  Saving model ...
Epoch: 10 cost time: 0.48546385765075684
Epoch: 10, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.524 Vali Acc: 0.419 Test Loss: 1.524 Test Acc: 0.419
Validation loss decreased (-0.388873 --> -0.418503).  Saving model ...
Epoch: 11 cost time: 0.4603590965270996
Epoch: 11, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.481 Vali Acc: 0.463 Test Loss: 1.481 Test Acc: 0.463
Validation loss decreased (-0.418503 --> -0.462948).  Saving model ...
Epoch: 12 cost time: 0.5323519706726074
Epoch: 12, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.437 Vali Acc: 0.493 Test Loss: 1.437 Test Acc: 0.493
Validation loss decreased (-0.462948 --> -0.492578).  Saving model ...
Epoch: 13 cost time: 0.4037001132965088
Epoch: 13, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.392 Vali Acc: 0.530 Test Loss: 1.392 Test Acc: 0.530
Validation loss decreased (-0.492578 --> -0.529616).  Saving model ...
Epoch: 14 cost time: 0.4724733829498291
Epoch: 14, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.348 Vali Acc: 0.556 Test Loss: 1.348 Test Acc: 0.556
Validation loss decreased (-0.529616 --> -0.555542).  Saving model ...
Epoch: 15 cost time: 0.4183945655822754
Epoch: 15, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.303 Vali Acc: 0.578 Test Loss: 1.303 Test Acc: 0.578
Validation loss decreased (-0.555542 --> -0.577765).  Saving model ...
Epoch: 16 cost time: 0.5539777278900146
Epoch: 16, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.258 Vali Acc: 0.619 Test Loss: 1.258 Test Acc: 0.619
Validation loss decreased (-0.577765 --> -0.618506).  Saving model ...
Epoch: 17 cost time: 0.45362424850463867
Epoch: 17, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.214 Vali Acc: 0.622 Test Loss: 1.214 Test Acc: 0.622
Validation loss decreased (-0.618506 --> -0.622210).  Saving model ...
Epoch: 18 cost time: 0.45865726470947266
Epoch: 18, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.170 Vali Acc: 0.644 Test Loss: 1.170 Test Acc: 0.644
Validation loss decreased (-0.622210 --> -0.644433).  Saving model ...
Epoch: 19 cost time: 0.533851146697998
Epoch: 19, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.127 Vali Acc: 0.663 Test Loss: 1.127 Test Acc: 0.663
Validation loss decreased (-0.644433 --> -0.662952).  Saving model ...
Epoch: 20 cost time: 0.4323289394378662
Epoch: 20, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.085 Vali Acc: 0.674 Test Loss: 1.085 Test Acc: 0.674
Validation loss decreased (-0.662952 --> -0.674063).  Saving model ...
Epoch: 21 cost time: 0.38985753059387207
Epoch: 21, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.045 Vali Acc: 0.707 Test Loss: 1.045 Test Acc: 0.707
Validation loss decreased (-0.674063 --> -0.707397).  Saving model ...
Epoch: 22 cost time: 0.3941779136657715
Epoch: 22, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.007 Vali Acc: 0.737 Test Loss: 1.007 Test Acc: 0.737
Validation loss decreased (-0.707397 --> -0.737027).  Saving model ...
Epoch: 23 cost time: 0.5715329647064209
Epoch: 23, Steps: 2 | Train Loss: 0.977 Vali Loss: 0.969 Vali Acc: 0.748 Test Loss: 0.969 Test Acc: 0.748
Validation loss decreased (-0.737027 --> -0.748138).  Saving model ...
Epoch: 24 cost time: 0.4270780086517334
Epoch: 24, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.932 Vali Acc: 0.748 Test Loss: 0.932 Test Acc: 0.748
Validation loss decreased (-0.748138 --> -0.748139).  Saving model ...
Epoch: 25 cost time: 0.49807190895080566
Epoch: 25, Steps: 2 | Train Loss: 0.804 Vali Loss: 0.896 Vali Acc: 0.774 Test Loss: 0.896 Test Acc: 0.774
Validation loss decreased (-0.748139 --> -0.774065).  Saving model ...
Epoch: 26 cost time: 0.5661370754241943
Epoch: 26, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.774065 --> -0.799991).  Saving model ...
Epoch: 27 cost time: 0.4197523593902588
Epoch: 27, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.827 Vali Acc: 0.815 Test Loss: 0.827 Test Acc: 0.815
Validation loss decreased (-0.799991 --> -0.814807).  Saving model ...
Epoch: 28 cost time: 0.4884798526763916
Epoch: 28, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.794 Vali Acc: 0.826 Test Loss: 0.794 Test Acc: 0.826
Validation loss decreased (-0.814807 --> -0.825918).  Saving model ...
Epoch: 29 cost time: 0.47364282608032227
Epoch: 29, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.762 Vali Acc: 0.837 Test Loss: 0.762 Test Acc: 0.837
Validation loss decreased (-0.825918 --> -0.837029).  Saving model ...
Epoch: 30 cost time: 0.4320952892303467
Epoch: 30, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.731 Vali Acc: 0.844 Test Loss: 0.731 Test Acc: 0.844
Validation loss decreased (-0.837029 --> -0.844437).  Saving model ...
Epoch: 31 cost time: 0.42995691299438477
Epoch: 31, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.702 Vali Acc: 0.856 Test Loss: 0.702 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855549).  Saving model ...
Epoch: 32 cost time: 0.5034544467926025
Epoch: 32, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.674 Vali Acc: 0.863 Test Loss: 0.674 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862956).  Saving model ...
Epoch: 33 cost time: 0.41771554946899414
Epoch: 33, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.648 Vali Acc: 0.867 Test Loss: 0.648 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 34 cost time: 0.49254918098449707
Epoch: 34, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.623 Vali Acc: 0.878 Test Loss: 0.623 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 35 cost time: 0.4124789237976074
Epoch: 35, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.600 Vali Acc: 0.881 Test Loss: 0.600 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881475).  Saving model ...
Epoch: 36 cost time: 0.4319446086883545
Epoch: 36, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.578 Vali Acc: 0.881 Test Loss: 0.578 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 37 cost time: 0.4142415523529053
Epoch: 37, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.557 Vali Acc: 0.885 Test Loss: 0.557 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 38 cost time: 0.42757725715637207
Epoch: 38, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.537 Vali Acc: 0.893 Test Loss: 0.537 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892587).  Saving model ...
Epoch: 39 cost time: 0.43897128105163574
Epoch: 39, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.518 Vali Acc: 0.896 Test Loss: 0.518 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 40 cost time: 0.49538540840148926
Epoch: 40, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.501 Vali Acc: 0.904 Test Loss: 0.501 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 41 cost time: 0.49292683601379395
Epoch: 41, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.485 Vali Acc: 0.904 Test Loss: 0.485 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 42 cost time: 0.47498655319213867
Epoch: 42, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.470 Vali Acc: 0.904 Test Loss: 0.470 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 43 cost time: 0.4389500617980957
Epoch: 43, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.456 Vali Acc: 0.904 Test Loss: 0.456 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 44 cost time: 0.5002682209014893
Epoch: 44, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.442 Vali Acc: 0.911 Test Loss: 0.442 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911107).  Saving model ...
Epoch: 45 cost time: 0.509150505065918
Epoch: 45, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.429 Vali Acc: 0.915 Test Loss: 0.429 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 46 cost time: 0.4188206195831299
Epoch: 46, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.417 Vali Acc: 0.919 Test Loss: 0.417 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918514).  Saving model ...
Epoch: 47 cost time: 0.4515872001647949
Epoch: 47, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.405 Vali Acc: 0.915 Test Loss: 0.405 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.612025260925293
Epoch: 48, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.394 Vali Acc: 0.919 Test Loss: 0.394 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 49 cost time: 0.4728965759277344
Epoch: 49, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.383 Vali Acc: 0.922 Test Loss: 0.383 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922218).  Saving model ...
Epoch: 50 cost time: 0.4736502170562744
Epoch: 50, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.374 Vali Acc: 0.922 Test Loss: 0.374 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 51 cost time: 0.5128388404846191
Epoch: 51, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.365 Vali Acc: 0.922 Test Loss: 0.365 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 52 cost time: 0.44896888732910156
Epoch: 52, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 53 cost time: 0.4574711322784424
Epoch: 53, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.350 Vali Acc: 0.922 Test Loss: 0.350 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 54 cost time: 0.4212045669555664
Epoch: 54, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 55 cost time: 0.4391946792602539
Epoch: 55, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.337 Vali Acc: 0.926 Test Loss: 0.337 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 56 cost time: 0.43399858474731445
Epoch: 56, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.331 Vali Acc: 0.926 Test Loss: 0.331 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 57 cost time: 0.5147953033447266
Epoch: 57, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 58 cost time: 0.6356468200683594
Epoch: 58, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.321 Vali Acc: 0.926 Test Loss: 0.321 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 59 cost time: 0.48596954345703125
Epoch: 59, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.316 Vali Acc: 0.926 Test Loss: 0.316 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 60 cost time: 0.4700734615325928
Epoch: 60, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.312 Vali Acc: 0.930 Test Loss: 0.312 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 61 cost time: 0.46452856063842773
Epoch: 61, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.307 Vali Acc: 0.930 Test Loss: 0.307 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 62 cost time: 0.42046523094177246
Epoch: 62, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 63 cost time: 0.4909553527832031
Epoch: 63, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 64 cost time: 0.4468357563018799
Epoch: 64, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.297 Vali Acc: 0.926 Test Loss: 0.297 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.4065515995025635
Epoch: 65, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.4946722984313965
Epoch: 66, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.4182884693145752
Epoch: 67, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.49155735969543457
Epoch: 68, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.42922353744506836
Epoch: 69, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.4927196502685547
Epoch: 70, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.5004527568817139
Epoch: 71, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.44842004776000977
Epoch: 72, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.4053993225097656
Epoch: 73, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.270 Vali Acc: 0.926 Test Loss: 0.270 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 9574
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8709111213684082
Epoch: 1, Steps: 2 | Train Loss: 2.024 Vali Loss: 1.879 Vali Acc: 0.141 Test Loss: 1.879 Test Acc: 0.141
Validation loss decreased (inf --> -0.140722).  Saving model ...
Epoch: 2 cost time: 0.36822080612182617
Epoch: 2, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.851 Vali Acc: 0.167 Test Loss: 1.851 Test Acc: 0.167
Validation loss decreased (-0.140722 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.4835083484649658
Epoch: 3, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.832 Vali Acc: 0.204 Test Loss: 1.832 Test Acc: 0.204
Validation loss decreased (-0.166648 --> -0.203685).  Saving model ...
Epoch: 4 cost time: 0.5003190040588379
Epoch: 4, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.818 Vali Acc: 0.211 Test Loss: 1.818 Test Acc: 0.211
Validation loss decreased (-0.203685 --> -0.211093).  Saving model ...
Epoch: 5 cost time: 0.3822336196899414
Epoch: 5, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.798 Vali Acc: 0.233 Test Loss: 1.798 Test Acc: 0.233
Validation loss decreased (-0.211093 --> -0.233315).  Saving model ...
Epoch: 6 cost time: 0.5042824745178223
Epoch: 6, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.772 Vali Acc: 0.267 Test Loss: 1.772 Test Acc: 0.267
Validation loss decreased (-0.233315 --> -0.266649).  Saving model ...
Epoch: 7 cost time: 0.5321364402770996
Epoch: 7, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.742 Vali Acc: 0.311 Test Loss: 1.742 Test Acc: 0.311
Validation loss decreased (-0.266649 --> -0.311094).  Saving model ...
Epoch: 8 cost time: 0.4275803565979004
Epoch: 8, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.708 Vali Acc: 0.344 Test Loss: 1.708 Test Acc: 0.344
Validation loss decreased (-0.311094 --> -0.344427).  Saving model ...
Epoch: 9 cost time: 0.48092126846313477
Epoch: 9, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.671 Vali Acc: 0.363 Test Loss: 1.671 Test Acc: 0.363
Validation loss decreased (-0.344427 --> -0.362946).  Saving model ...
Epoch: 10 cost time: 0.4480559825897217
Epoch: 10, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.632 Vali Acc: 0.400 Test Loss: 1.632 Test Acc: 0.400
Validation loss decreased (-0.362946 --> -0.399984).  Saving model ...
Epoch: 11 cost time: 0.40890002250671387
Epoch: 11, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.590 Vali Acc: 0.426 Test Loss: 1.590 Test Acc: 0.426
Validation loss decreased (-0.399984 --> -0.425910).  Saving model ...
Epoch: 12 cost time: 0.45221567153930664
Epoch: 12, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.548 Vali Acc: 0.437 Test Loss: 1.548 Test Acc: 0.437
Validation loss decreased (-0.425910 --> -0.437022).  Saving model ...
Epoch: 13 cost time: 0.4572103023529053
Epoch: 13, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.504 Vali Acc: 0.452 Test Loss: 1.504 Test Acc: 0.452
Validation loss decreased (-0.437022 --> -0.451837).  Saving model ...
Epoch: 14 cost time: 0.487795352935791
Epoch: 14, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.459 Vali Acc: 0.470 Test Loss: 1.459 Test Acc: 0.470
Validation loss decreased (-0.451837 --> -0.470356).  Saving model ...
Epoch: 15 cost time: 0.4429435729980469
Epoch: 15, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.413 Vali Acc: 0.515 Test Loss: 1.413 Test Acc: 0.515
Validation loss decreased (-0.470356 --> -0.514801).  Saving model ...
Epoch: 16 cost time: 0.49782323837280273
Epoch: 16, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.367 Vali Acc: 0.541 Test Loss: 1.367 Test Acc: 0.541
Validation loss decreased (-0.514801 --> -0.540727).  Saving model ...
Epoch: 17 cost time: 0.49300718307495117
Epoch: 17, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.320 Vali Acc: 0.581 Test Loss: 1.320 Test Acc: 0.581
Validation loss decreased (-0.540727 --> -0.581468).  Saving model ...
Epoch: 18 cost time: 0.5201506614685059
Epoch: 18, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.274 Vali Acc: 0.611 Test Loss: 1.274 Test Acc: 0.611
Validation loss decreased (-0.581468 --> -0.611098).  Saving model ...
Epoch: 19 cost time: 0.5171828269958496
Epoch: 19, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.227 Vali Acc: 0.622 Test Loss: 1.227 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 20 cost time: 0.5185451507568359
Epoch: 20, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.183 Vali Acc: 0.663 Test Loss: 1.183 Test Acc: 0.663
Validation loss decreased (-0.622210 --> -0.662951).  Saving model ...
Epoch: 21 cost time: 0.5027222633361816
Epoch: 21, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.139 Vali Acc: 0.689 Test Loss: 1.139 Test Acc: 0.689
Validation loss decreased (-0.662951 --> -0.688877).  Saving model ...
Epoch: 22 cost time: 0.4500277042388916
Epoch: 22, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.097 Vali Acc: 0.711 Test Loss: 1.097 Test Acc: 0.711
Validation loss decreased (-0.688877 --> -0.711100).  Saving model ...
Epoch: 23 cost time: 0.48196983337402344
Epoch: 23, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.056 Vali Acc: 0.730 Test Loss: 1.056 Test Acc: 0.730
Validation loss decreased (-0.711100 --> -0.729619).  Saving model ...
Epoch: 24 cost time: 0.5601756572723389
Epoch: 24, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.016 Vali Acc: 0.737 Test Loss: 1.016 Test Acc: 0.737
Validation loss decreased (-0.729619 --> -0.737027).  Saving model ...
Epoch: 25 cost time: 0.5437524318695068
Epoch: 25, Steps: 2 | Train Loss: 0.930 Vali Loss: 0.977 Vali Acc: 0.737 Test Loss: 0.977 Test Acc: 0.737
Validation loss decreased (-0.737027 --> -0.737027).  Saving model ...
Epoch: 26 cost time: 0.5120713710784912
Epoch: 26, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.939 Vali Acc: 0.759 Test Loss: 0.939 Test Acc: 0.759
Validation loss decreased (-0.737027 --> -0.759250).  Saving model ...
Epoch: 27 cost time: 0.46736836433410645
Epoch: 27, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.903 Vali Acc: 0.793 Test Loss: 0.903 Test Acc: 0.793
Validation loss decreased (-0.759250 --> -0.792584).  Saving model ...
Epoch: 28 cost time: 0.4638705253601074
Epoch: 28, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.867 Vali Acc: 0.796 Test Loss: 0.867 Test Acc: 0.796
Validation loss decreased (-0.792584 --> -0.796288).  Saving model ...
Epoch: 29 cost time: 0.40081357955932617
Epoch: 29, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.832 Vali Acc: 0.811 Test Loss: 0.832 Test Acc: 0.811
Validation loss decreased (-0.796288 --> -0.811103).  Saving model ...
Epoch: 30 cost time: 0.4802744388580322
Epoch: 30, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.797 Vali Acc: 0.833 Test Loss: 0.797 Test Acc: 0.833
Validation loss decreased (-0.811103 --> -0.833325).  Saving model ...
Epoch: 31 cost time: 0.520575761795044
Epoch: 31, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.764 Vali Acc: 0.837 Test Loss: 0.764 Test Acc: 0.837
Validation loss decreased (-0.833325 --> -0.837029).  Saving model ...
Epoch: 32 cost time: 0.43366432189941406
Epoch: 32, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.733 Vali Acc: 0.848 Test Loss: 0.733 Test Acc: 0.848
Validation loss decreased (-0.837029 --> -0.848141).  Saving model ...
Epoch: 33 cost time: 0.4291043281555176
Epoch: 33, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.703 Vali Acc: 0.859 Test Loss: 0.703 Test Acc: 0.859
Validation loss decreased (-0.848141 --> -0.859252).  Saving model ...
Epoch: 34 cost time: 0.510509729385376
Epoch: 34, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.675 Vali Acc: 0.867 Test Loss: 0.675 Test Acc: 0.867
Validation loss decreased (-0.859252 --> -0.866660).  Saving model ...
Epoch: 35 cost time: 0.5367937088012695
Epoch: 35, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.648 Vali Acc: 0.870 Test Loss: 0.648 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 36 cost time: 0.4957871437072754
Epoch: 36, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.622 Vali Acc: 0.881 Test Loss: 0.622 Test Acc: 0.881
Validation loss decreased (-0.870364 --> -0.881475).  Saving model ...
Epoch: 37 cost time: 0.5264589786529541
Epoch: 37, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.598 Vali Acc: 0.893 Test Loss: 0.598 Test Acc: 0.893
Validation loss decreased (-0.881475 --> -0.892587).  Saving model ...
Epoch: 38 cost time: 0.4678182601928711
Epoch: 38, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.574 Vali Acc: 0.893 Test Loss: 0.574 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 39 cost time: 0.4731719493865967
Epoch: 39, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.553 Vali Acc: 0.904 Test Loss: 0.553 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903698).  Saving model ...
Epoch: 40 cost time: 0.48528218269348145
Epoch: 40, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.533 Vali Acc: 0.904 Test Loss: 0.533 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 41 cost time: 0.4371681213378906
Epoch: 41, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.515 Vali Acc: 0.911 Test Loss: 0.515 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 42 cost time: 0.46495795249938965
Epoch: 42, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.497 Vali Acc: 0.911 Test Loss: 0.497 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 43 cost time: 0.46732068061828613
Epoch: 43, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.481 Vali Acc: 0.919 Test Loss: 0.481 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 44 cost time: 0.47049856185913086
Epoch: 44, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.466 Vali Acc: 0.915 Test Loss: 0.466 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.45584583282470703
Epoch: 45, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.452 Vali Acc: 0.915 Test Loss: 0.452 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.461195707321167
Epoch: 46, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.440 Vali Acc: 0.919 Test Loss: 0.440 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 47 cost time: 0.4732844829559326
Epoch: 47, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.428 Vali Acc: 0.919 Test Loss: 0.428 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 48 cost time: 0.5105040073394775
Epoch: 48, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.416 Vali Acc: 0.926 Test Loss: 0.416 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 49 cost time: 0.47513651847839355
Epoch: 49, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.405 Vali Acc: 0.930 Test Loss: 0.405 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 50 cost time: 0.506129264831543
Epoch: 50, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.394 Vali Acc: 0.933 Test Loss: 0.394 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933329).  Saving model ...
Epoch: 51 cost time: 0.5047202110290527
Epoch: 51, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.385 Vali Acc: 0.937 Test Loss: 0.385 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 52 cost time: 0.4693477153778076
Epoch: 52, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.375 Vali Acc: 0.937 Test Loss: 0.375 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 53 cost time: 0.5066244602203369
Epoch: 53, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.366 Vali Acc: 0.937 Test Loss: 0.366 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 54 cost time: 0.4992818832397461
Epoch: 54, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 55 cost time: 0.46439695358276367
Epoch: 55, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.350 Vali Acc: 0.941 Test Loss: 0.350 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 56 cost time: 0.5014994144439697
Epoch: 56, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.344 Vali Acc: 0.941 Test Loss: 0.344 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 57 cost time: 0.4971044063568115
Epoch: 57, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.337 Vali Acc: 0.941 Test Loss: 0.337 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 58 cost time: 0.49964094161987305
Epoch: 58, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.332 Vali Acc: 0.937 Test Loss: 0.332 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5525670051574707
Epoch: 59, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.326 Vali Acc: 0.941 Test Loss: 0.326 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 60 cost time: 0.5197713375091553
Epoch: 60, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.320 Vali Acc: 0.941 Test Loss: 0.320 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 61 cost time: 0.4464120864868164
Epoch: 61, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.316 Vali Acc: 0.941 Test Loss: 0.316 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 62 cost time: 0.4226338863372803
Epoch: 62, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.311 Vali Acc: 0.941 Test Loss: 0.311 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 63 cost time: 0.4843311309814453
Epoch: 63, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.307 Vali Acc: 0.941 Test Loss: 0.307 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 64 cost time: 0.519625186920166
Epoch: 64, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.302 Vali Acc: 0.941 Test Loss: 0.302 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 65 cost time: 0.5259466171264648
Epoch: 65, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.298 Vali Acc: 0.941 Test Loss: 0.298 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 66 cost time: 0.41388487815856934
Epoch: 66, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 67 cost time: 0.4493882656097412
Epoch: 67, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 68 cost time: 0.583848237991333
Epoch: 68, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.287 Vali Acc: 0.941 Test Loss: 0.287 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 69 cost time: 0.44114184379577637
Epoch: 69, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 70 cost time: 0.47452402114868164
Epoch: 70, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.280 Vali Acc: 0.941 Test Loss: 0.280 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 71 cost time: 0.5106165409088135
Epoch: 71, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 72 cost time: 0.469132661819458
Epoch: 72, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.274 Vali Acc: 0.941 Test Loss: 0.274 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 73 cost time: 0.44281554222106934
Epoch: 73, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 74 cost time: 0.44266748428344727
Epoch: 74, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 75 cost time: 0.48697447776794434
Epoch: 75, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 76 cost time: 0.6035826206207275
Epoch: 76, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 77 cost time: 0.46538472175598145
Epoch: 77, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 0.5112624168395996
Epoch: 78, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 79 cost time: 0.4690272808074951
Epoch: 79, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 80 cost time: 0.4300563335418701
Epoch: 80, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 81 cost time: 0.3924593925476074
Epoch: 81, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 82 cost time: 0.502164363861084
Epoch: 82, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 0.47869229316711426
Epoch: 83, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.48674917221069336
Epoch: 84, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.43332743644714355
Epoch: 85, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.4915750026702881
Epoch: 86, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.45511555671691895
Epoch: 87, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.46808409690856934
Epoch: 88, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 89 cost time: 0.46149587631225586
Epoch: 89, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 90 cost time: 0.5406630039215088
Epoch: 90, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.48599886894226074
Epoch: 91, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.5226881504058838
Epoch: 92, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.5643253326416016
Epoch: 93, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.4557764530181885
Epoch: 94, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.5198869705200195
Epoch: 95, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 0.5075745582580566
Epoch: 96, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 0.4663710594177246
Epoch: 97, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 0.4696202278137207
Epoch: 98, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 0.4772317409515381
Epoch: 99, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 8470
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8694899082183838
Epoch: 1, Steps: 2 | Train Loss: 1.992 Vali Loss: 1.900 Vali Acc: 0.178 Test Loss: 1.900 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.4683208465576172
Epoch: 2, Steps: 2 | Train Loss: 1.957 Vali Loss: 1.868 Vali Acc: 0.200 Test Loss: 1.868 Test Acc: 0.200
Validation loss decreased (-0.177759 --> -0.199981).  Saving model ...
Epoch: 3 cost time: 0.4984011650085449
Epoch: 3, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.846 Vali Acc: 0.207 Test Loss: 1.846 Test Acc: 0.207
Validation loss decreased (-0.199981 --> -0.207389).  Saving model ...
Epoch: 4 cost time: 0.4337339401245117
Epoch: 4, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.832 Vali Acc: 0.211 Test Loss: 1.832 Test Acc: 0.211
Validation loss decreased (-0.207389 --> -0.211093).  Saving model ...
Epoch: 5 cost time: 0.46663904190063477
Epoch: 5, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.816 Vali Acc: 0.207 Test Loss: 1.816 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5064973831176758
Epoch: 6, Steps: 2 | Train Loss: 1.925 Vali Loss: 1.799 Vali Acc: 0.185 Test Loss: 1.799 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.48678064346313477
Epoch: 7, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.779 Vali Acc: 0.196 Test Loss: 1.779 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.46685123443603516
Epoch: 8, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.758 Vali Acc: 0.219 Test Loss: 1.758 Test Acc: 0.219
Validation loss decreased (-0.211093 --> -0.218501).  Saving model ...
Epoch: 9 cost time: 0.4338672161102295
Epoch: 9, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.735 Vali Acc: 0.233 Test Loss: 1.735 Test Acc: 0.233
Validation loss decreased (-0.218501 --> -0.233316).  Saving model ...
Epoch: 10 cost time: 0.4074068069458008
Epoch: 10, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.710 Vali Acc: 0.270 Test Loss: 1.710 Test Acc: 0.270
Validation loss decreased (-0.233316 --> -0.270353).  Saving model ...
Epoch: 11 cost time: 0.5424814224243164
Epoch: 11, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.684 Vali Acc: 0.319 Test Loss: 1.684 Test Acc: 0.319
Validation loss decreased (-0.270353 --> -0.318502).  Saving model ...
Epoch: 12 cost time: 0.5060937404632568
Epoch: 12, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.657 Vali Acc: 0.326 Test Loss: 1.657 Test Acc: 0.326
Validation loss decreased (-0.318502 --> -0.325909).  Saving model ...
Epoch: 13 cost time: 0.4181387424468994
Epoch: 13, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.628 Vali Acc: 0.374 Test Loss: 1.628 Test Acc: 0.374
Validation loss decreased (-0.325909 --> -0.374058).  Saving model ...
Epoch: 14 cost time: 0.4556865692138672
Epoch: 14, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.598 Vali Acc: 0.404 Test Loss: 1.598 Test Acc: 0.404
Validation loss decreased (-0.374058 --> -0.403688).  Saving model ...
Epoch: 15 cost time: 0.42659807205200195
Epoch: 15, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.568 Vali Acc: 0.437 Test Loss: 1.568 Test Acc: 0.437
Validation loss decreased (-0.403688 --> -0.437021).  Saving model ...
Epoch: 16 cost time: 0.490309476852417
Epoch: 16, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.537 Vali Acc: 0.463 Test Loss: 1.537 Test Acc: 0.463
Validation loss decreased (-0.437021 --> -0.462948).  Saving model ...
Epoch: 17 cost time: 0.4409151077270508
Epoch: 17, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.505 Vali Acc: 0.478 Test Loss: 1.505 Test Acc: 0.478
Validation loss decreased (-0.462948 --> -0.477763).  Saving model ...
Epoch: 18 cost time: 0.44928646087646484
Epoch: 18, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.472 Vali Acc: 0.507 Test Loss: 1.472 Test Acc: 0.507
Validation loss decreased (-0.477763 --> -0.507393).  Saving model ...
Epoch: 19 cost time: 0.46016621589660645
Epoch: 19, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.439 Vali Acc: 0.533 Test Loss: 1.439 Test Acc: 0.533
Validation loss decreased (-0.507393 --> -0.533319).  Saving model ...
Epoch: 20 cost time: 0.53887939453125
Epoch: 20, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.406 Vali Acc: 0.544 Test Loss: 1.406 Test Acc: 0.544
Validation loss decreased (-0.533319 --> -0.544430).  Saving model ...
Epoch: 21 cost time: 0.4698338508605957
Epoch: 21, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.374 Vali Acc: 0.567 Test Loss: 1.374 Test Acc: 0.567
Validation loss decreased (-0.544430 --> -0.566653).  Saving model ...
Epoch: 22 cost time: 0.5622596740722656
Epoch: 22, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.340 Vali Acc: 0.589 Test Loss: 1.340 Test Acc: 0.589
Validation loss decreased (-0.566653 --> -0.588875).  Saving model ...
Epoch: 23 cost time: 0.5511171817779541
Epoch: 23, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.306 Vali Acc: 0.604 Test Loss: 1.306 Test Acc: 0.604
Validation loss decreased (-0.588875 --> -0.603691).  Saving model ...
Epoch: 24 cost time: 0.4291999340057373
Epoch: 24, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.274 Vali Acc: 0.641 Test Loss: 1.274 Test Acc: 0.641
Validation loss decreased (-0.603691 --> -0.640728).  Saving model ...
Epoch: 25 cost time: 0.4264094829559326
Epoch: 25, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.241 Vali Acc: 0.648 Test Loss: 1.241 Test Acc: 0.648
Validation loss decreased (-0.640728 --> -0.648136).  Saving model ...
Epoch: 26 cost time: 0.4267597198486328
Epoch: 26, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.207 Vali Acc: 0.659 Test Loss: 1.207 Test Acc: 0.659
Validation loss decreased (-0.648136 --> -0.659247).  Saving model ...
Epoch: 27 cost time: 0.47633910179138184
Epoch: 27, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.174 Vali Acc: 0.674 Test Loss: 1.174 Test Acc: 0.674
Validation loss decreased (-0.659247 --> -0.674062).  Saving model ...
Epoch: 28 cost time: 0.40584754943847656
Epoch: 28, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.142 Vali Acc: 0.693 Test Loss: 1.142 Test Acc: 0.693
Validation loss decreased (-0.674062 --> -0.692581).  Saving model ...
Epoch: 29 cost time: 0.46094632148742676
Epoch: 29, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
Validation loss decreased (-0.692581 --> -0.699989).  Saving model ...
Epoch: 30 cost time: 0.4869675636291504
Epoch: 30, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.076 Vali Acc: 0.715 Test Loss: 1.076 Test Acc: 0.715
Validation loss decreased (-0.699989 --> -0.714804).  Saving model ...
Epoch: 31 cost time: 0.5108170509338379
Epoch: 31, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.044 Vali Acc: 0.726 Test Loss: 1.044 Test Acc: 0.726
Validation loss decreased (-0.714804 --> -0.725915).  Saving model ...
Epoch: 32 cost time: 0.4219999313354492
Epoch: 32, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.013 Vali Acc: 0.744 Test Loss: 1.013 Test Acc: 0.744
Validation loss decreased (-0.725915 --> -0.744434).  Saving model ...
Epoch: 33 cost time: 0.5093410015106201
Epoch: 33, Steps: 2 | Train Loss: 0.996 Vali Loss: 0.983 Vali Acc: 0.767 Test Loss: 0.983 Test Acc: 0.767
Validation loss decreased (-0.744434 --> -0.766657).  Saving model ...
Epoch: 34 cost time: 0.4969778060913086
Epoch: 34, Steps: 2 | Train Loss: 0.930 Vali Loss: 0.952 Vali Acc: 0.770 Test Loss: 0.952 Test Acc: 0.770
Validation loss decreased (-0.766657 --> -0.770361).  Saving model ...
Epoch: 35 cost time: 0.43898606300354004
Epoch: 35, Steps: 2 | Train Loss: 0.967 Vali Loss: 0.923 Vali Acc: 0.778 Test Loss: 0.923 Test Acc: 0.778
Validation loss decreased (-0.770361 --> -0.777769).  Saving model ...
Epoch: 36 cost time: 0.5506429672241211
Epoch: 36, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.894 Vali Acc: 0.796 Test Loss: 0.894 Test Acc: 0.796
Validation loss decreased (-0.777769 --> -0.796287).  Saving model ...
Epoch: 37 cost time: 0.513603925704956
Epoch: 37, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.866 Vali Acc: 0.807 Test Loss: 0.866 Test Acc: 0.807
Validation loss decreased (-0.796287 --> -0.807399).  Saving model ...
Epoch: 38 cost time: 0.4786522388458252
Epoch: 38, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.839 Vali Acc: 0.826 Test Loss: 0.839 Test Acc: 0.826
Validation loss decreased (-0.807399 --> -0.825918).  Saving model ...
Epoch: 39 cost time: 0.5240495204925537
Epoch: 39, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.812 Vali Acc: 0.837 Test Loss: 0.812 Test Acc: 0.837
Validation loss decreased (-0.825918 --> -0.837029).  Saving model ...
Epoch: 40 cost time: 0.5442159175872803
Epoch: 40, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.786 Vali Acc: 0.852 Test Loss: 0.786 Test Acc: 0.852
Validation loss decreased (-0.837029 --> -0.851844).  Saving model ...
Epoch: 41 cost time: 0.48761606216430664
Epoch: 41, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.761 Vali Acc: 0.863 Test Loss: 0.761 Test Acc: 0.863
Validation loss decreased (-0.851844 --> -0.862955).  Saving model ...
Epoch: 42 cost time: 0.5173819065093994
Epoch: 42, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.737 Vali Acc: 0.870 Test Loss: 0.737 Test Acc: 0.870
Validation loss decreased (-0.862955 --> -0.870363).  Saving model ...
Epoch: 43 cost time: 0.5166845321655273
Epoch: 43, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.714 Vali Acc: 0.874 Test Loss: 0.714 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 44 cost time: 0.48952412605285645
Epoch: 44, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.692 Vali Acc: 0.881 Test Loss: 0.692 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881475).  Saving model ...
Epoch: 45 cost time: 0.47404980659484863
Epoch: 45, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.671 Vali Acc: 0.889 Test Loss: 0.671 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888882).  Saving model ...
Epoch: 46 cost time: 0.4720604419708252
Epoch: 46, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.650 Vali Acc: 0.896 Test Loss: 0.650 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 47 cost time: 0.4731106758117676
Epoch: 47, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.632 Vali Acc: 0.900 Test Loss: 0.632 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 48 cost time: 0.40646839141845703
Epoch: 48, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.613 Vali Acc: 0.907 Test Loss: 0.613 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907401).  Saving model ...
Epoch: 49 cost time: 0.47907590866088867
Epoch: 49, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.596 Vali Acc: 0.907 Test Loss: 0.596 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 50 cost time: 0.5819172859191895
Epoch: 50, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.580 Vali Acc: 0.911 Test Loss: 0.580 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 51 cost time: 0.48009729385375977
Epoch: 51, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.564 Vali Acc: 0.911 Test Loss: 0.564 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 52 cost time: 0.5420451164245605
Epoch: 52, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.549 Vali Acc: 0.915 Test Loss: 0.549 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 53 cost time: 0.5066628456115723
Epoch: 53, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.536 Vali Acc: 0.911 Test Loss: 0.536 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5283222198486328
Epoch: 54, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.522 Vali Acc: 0.911 Test Loss: 0.522 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.48598480224609375
Epoch: 55, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.510 Vali Acc: 0.907 Test Loss: 0.510 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5362603664398193
Epoch: 56, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.498 Vali Acc: 0.907 Test Loss: 0.498 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.556757926940918
Epoch: 57, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.487 Vali Acc: 0.911 Test Loss: 0.487 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.43465423583984375
Epoch: 58, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.476 Vali Acc: 0.915 Test Loss: 0.476 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 59 cost time: 0.45529961585998535
Epoch: 59, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.467 Vali Acc: 0.915 Test Loss: 0.467 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 60 cost time: 0.4519367218017578
Epoch: 60, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.457 Vali Acc: 0.919 Test Loss: 0.457 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 61 cost time: 0.4573507308959961
Epoch: 61, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.448 Vali Acc: 0.919 Test Loss: 0.448 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 62 cost time: 0.5011160373687744
Epoch: 62, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.440 Vali Acc: 0.919 Test Loss: 0.440 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 63 cost time: 0.5322442054748535
Epoch: 63, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.432 Vali Acc: 0.911 Test Loss: 0.432 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.46276164054870605
Epoch: 64, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.424 Vali Acc: 0.915 Test Loss: 0.424 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.4813692569732666
Epoch: 65, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.417 Vali Acc: 0.915 Test Loss: 0.417 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.5432677268981934
Epoch: 66, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.410 Vali Acc: 0.915 Test Loss: 0.410 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.4930906295776367
Epoch: 67, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.404 Vali Acc: 0.919 Test Loss: 0.404 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 68 cost time: 0.48903894424438477
Epoch: 68, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.398 Vali Acc: 0.919 Test Loss: 0.398 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 69 cost time: 0.5875439643859863
Epoch: 69, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.392 Vali Acc: 0.919 Test Loss: 0.392 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 70 cost time: 0.48616766929626465
Epoch: 70, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.386 Vali Acc: 0.919 Test Loss: 0.386 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 71 cost time: 0.529010534286499
Epoch: 71, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 72 cost time: 0.5989267826080322
Epoch: 72, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.376 Vali Acc: 0.919 Test Loss: 0.376 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 73 cost time: 0.5137922763824463
Epoch: 73, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.370 Vali Acc: 0.919 Test Loss: 0.370 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 74 cost time: 0.6570839881896973
Epoch: 74, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.365 Vali Acc: 0.919 Test Loss: 0.365 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 75 cost time: 0.513519287109375
Epoch: 75, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.360 Vali Acc: 0.922 Test Loss: 0.360 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 76 cost time: 0.560246467590332
Epoch: 76, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.356 Vali Acc: 0.922 Test Loss: 0.356 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 77 cost time: 0.4703972339630127
Epoch: 77, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.351 Vali Acc: 0.926 Test Loss: 0.351 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925922).  Saving model ...
Epoch: 78 cost time: 0.5792820453643799
Epoch: 78, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.347 Vali Acc: 0.926 Test Loss: 0.347 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 79 cost time: 0.5469129085540771
Epoch: 79, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 80 cost time: 0.5030555725097656
Epoch: 80, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.338 Vali Acc: 0.933 Test Loss: 0.338 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 81 cost time: 0.5447585582733154
Epoch: 81, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.334 Vali Acc: 0.933 Test Loss: 0.334 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 82 cost time: 0.5392041206359863
Epoch: 82, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.330 Vali Acc: 0.933 Test Loss: 0.330 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 83 cost time: 0.5786330699920654
Epoch: 83, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.326 Vali Acc: 0.930 Test Loss: 0.326 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.557715654373169
Epoch: 84, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.45937466621398926
Epoch: 85, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.5217545032501221
Epoch: 86, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.317 Vali Acc: 0.930 Test Loss: 0.317 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.5741064548492432
Epoch: 87, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.314 Vali Acc: 0.930 Test Loss: 0.314 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.5761806964874268
Epoch: 88, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.311 Vali Acc: 0.930 Test Loss: 0.311 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.46857762336730957
Epoch: 89, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.5055723190307617
Epoch: 90, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.307 Vali Acc: 0.930 Test Loss: 0.307 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.5036427974700928
Epoch: 91, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.541651725769043
Epoch: 92, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.303 Vali Acc: 0.926 Test Loss: 0.303 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 6982
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.937619924545288
Epoch: 1, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.858 Vali Acc: 0.233 Test Loss: 1.858 Test Acc: 0.233
Validation loss decreased (inf --> -0.233315).  Saving model ...
Epoch: 2 cost time: 0.5234298706054688
Epoch: 2, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.829 Vali Acc: 0.241 Test Loss: 1.829 Test Acc: 0.241
Validation loss decreased (-0.233315 --> -0.240722).  Saving model ...
Epoch: 3 cost time: 0.4640028476715088
Epoch: 3, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.807 Vali Acc: 0.248 Test Loss: 1.807 Test Acc: 0.248
Validation loss decreased (-0.240722 --> -0.248130).  Saving model ...
Epoch: 4 cost time: 0.4724414348602295
Epoch: 4, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.792 Vali Acc: 0.252 Test Loss: 1.792 Test Acc: 0.252
Validation loss decreased (-0.248130 --> -0.251834).  Saving model ...
Epoch: 5 cost time: 0.4700014591217041
Epoch: 5, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.775 Vali Acc: 0.256 Test Loss: 1.775 Test Acc: 0.256
Validation loss decreased (-0.251834 --> -0.255538).  Saving model ...
Epoch: 6 cost time: 0.4548008441925049
Epoch: 6, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.758 Vali Acc: 0.263 Test Loss: 1.758 Test Acc: 0.263
Validation loss decreased (-0.255538 --> -0.262945).  Saving model ...
Epoch: 7 cost time: 0.3765733242034912
Epoch: 7, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.739 Vali Acc: 0.270 Test Loss: 1.739 Test Acc: 0.270
Validation loss decreased (-0.262945 --> -0.270353).  Saving model ...
Epoch: 8 cost time: 0.5088698863983154
Epoch: 8, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.719 Vali Acc: 0.281 Test Loss: 1.719 Test Acc: 0.281
Validation loss decreased (-0.270353 --> -0.281464).  Saving model ...
Epoch: 9 cost time: 0.514451265335083
Epoch: 9, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.697 Vali Acc: 0.285 Test Loss: 1.697 Test Acc: 0.285
Validation loss decreased (-0.281464 --> -0.285168).  Saving model ...
Epoch: 10 cost time: 0.5129241943359375
Epoch: 10, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.675 Vali Acc: 0.307 Test Loss: 1.675 Test Acc: 0.307
Validation loss decreased (-0.285168 --> -0.307391).  Saving model ...
Epoch: 11 cost time: 0.4557805061340332
Epoch: 11, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.653 Vali Acc: 0.341 Test Loss: 1.653 Test Acc: 0.341
Validation loss decreased (-0.307391 --> -0.340724).  Saving model ...
Epoch: 12 cost time: 0.4412562847137451
Epoch: 12, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.629 Vali Acc: 0.352 Test Loss: 1.629 Test Acc: 0.352
Validation loss decreased (-0.340724 --> -0.351836).  Saving model ...
Epoch: 13 cost time: 0.5146076679229736
Epoch: 13, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.605 Vali Acc: 0.381 Test Loss: 1.605 Test Acc: 0.381
Validation loss decreased (-0.351836 --> -0.381465).  Saving model ...
Epoch: 14 cost time: 0.500408411026001
Epoch: 14, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.580 Vali Acc: 0.404 Test Loss: 1.580 Test Acc: 0.404
Validation loss decreased (-0.381465 --> -0.403688).  Saving model ...
Epoch: 15 cost time: 0.4578673839569092
Epoch: 15, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.554 Vali Acc: 0.419 Test Loss: 1.554 Test Acc: 0.419
Validation loss decreased (-0.403688 --> -0.418503).  Saving model ...
Epoch: 16 cost time: 0.5680160522460938
Epoch: 16, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.527 Vali Acc: 0.437 Test Loss: 1.527 Test Acc: 0.437
Validation loss decreased (-0.418503 --> -0.437022).  Saving model ...
Epoch: 17 cost time: 0.44927215576171875
Epoch: 17, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.501 Vali Acc: 0.448 Test Loss: 1.501 Test Acc: 0.448
Validation loss decreased (-0.437022 --> -0.448133).  Saving model ...
Epoch: 18 cost time: 0.5016794204711914
Epoch: 18, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.475 Vali Acc: 0.478 Test Loss: 1.475 Test Acc: 0.478
Validation loss decreased (-0.448133 --> -0.477763).  Saving model ...
Epoch: 19 cost time: 0.47185373306274414
Epoch: 19, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.449 Vali Acc: 0.511 Test Loss: 1.449 Test Acc: 0.511
Validation loss decreased (-0.477763 --> -0.511097).  Saving model ...
Epoch: 20 cost time: 0.4656243324279785
Epoch: 20, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.422 Vali Acc: 0.541 Test Loss: 1.422 Test Acc: 0.541
Validation loss decreased (-0.511097 --> -0.540727).  Saving model ...
Epoch: 21 cost time: 0.4863746166229248
Epoch: 21, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.394 Vali Acc: 0.556 Test Loss: 1.394 Test Acc: 0.556
Validation loss decreased (-0.540727 --> -0.555542).  Saving model ...
Epoch: 22 cost time: 0.5705132484436035
Epoch: 22, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.368 Vali Acc: 0.589 Test Loss: 1.368 Test Acc: 0.589
Validation loss decreased (-0.555542 --> -0.588875).  Saving model ...
Epoch: 23 cost time: 0.4908740520477295
Epoch: 23, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.340 Vali Acc: 0.622 Test Loss: 1.340 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622209).  Saving model ...
Epoch: 24 cost time: 0.4221193790435791
Epoch: 24, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.313 Vali Acc: 0.644 Test Loss: 1.313 Test Acc: 0.644
Validation loss decreased (-0.622209 --> -0.644431).  Saving model ...
Epoch: 25 cost time: 0.4668891429901123
Epoch: 25, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.285 Vali Acc: 0.663 Test Loss: 1.285 Test Acc: 0.663
Validation loss decreased (-0.644431 --> -0.662950).  Saving model ...
Epoch: 26 cost time: 0.5134689807891846
Epoch: 26, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.257 Vali Acc: 0.693 Test Loss: 1.257 Test Acc: 0.693
Validation loss decreased (-0.662950 --> -0.692580).  Saving model ...
Epoch: 27 cost time: 0.49661827087402344
Epoch: 27, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.228 Vali Acc: 0.707 Test Loss: 1.228 Test Acc: 0.707
Validation loss decreased (-0.692580 --> -0.707395).  Saving model ...
Epoch: 28 cost time: 0.48759889602661133
Epoch: 28, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.200 Vali Acc: 0.719 Test Loss: 1.200 Test Acc: 0.719
Validation loss decreased (-0.707395 --> -0.718507).  Saving model ...
Epoch: 29 cost time: 0.5275471210479736
Epoch: 29, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.172 Vali Acc: 0.733 Test Loss: 1.172 Test Acc: 0.733
Validation loss decreased (-0.718507 --> -0.733322).  Saving model ...
Epoch: 30 cost time: 0.5358169078826904
Epoch: 30, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.143 Vali Acc: 0.733 Test Loss: 1.143 Test Acc: 0.733
Validation loss decreased (-0.733322 --> -0.733322).  Saving model ...
Epoch: 31 cost time: 0.5465946197509766
Epoch: 31, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.116 Vali Acc: 0.752 Test Loss: 1.116 Test Acc: 0.752
Validation loss decreased (-0.733322 --> -0.751841).  Saving model ...
Epoch: 32 cost time: 0.45000720024108887
Epoch: 32, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.088 Vali Acc: 0.763 Test Loss: 1.088 Test Acc: 0.763
Validation loss decreased (-0.751841 --> -0.762952).  Saving model ...
Epoch: 33 cost time: 0.5293240547180176
Epoch: 33, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.062 Vali Acc: 0.774 Test Loss: 1.062 Test Acc: 0.774
Validation loss decreased (-0.762952 --> -0.774063).  Saving model ...
Epoch: 34 cost time: 0.4673030376434326
Epoch: 34, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.037 Vali Acc: 0.778 Test Loss: 1.037 Test Acc: 0.778
Validation loss decreased (-0.774063 --> -0.777767).  Saving model ...
Epoch: 35 cost time: 0.48308253288269043
Epoch: 35, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.011 Vali Acc: 0.800 Test Loss: 1.011 Test Acc: 0.800
Validation loss decreased (-0.777767 --> -0.799990).  Saving model ...
Epoch: 36 cost time: 0.5364437103271484
Epoch: 36, Steps: 2 | Train Loss: 0.929 Vali Loss: 0.986 Vali Acc: 0.807 Test Loss: 0.986 Test Acc: 0.807
Validation loss decreased (-0.799990 --> -0.807398).  Saving model ...
Epoch: 37 cost time: 0.48067307472229004
Epoch: 37, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.959 Vali Acc: 0.822 Test Loss: 0.959 Test Acc: 0.822
Validation loss decreased (-0.807398 --> -0.822213).  Saving model ...
Epoch: 38 cost time: 0.388075590133667
Epoch: 38, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.934 Vali Acc: 0.826 Test Loss: 0.934 Test Acc: 0.826
Validation loss decreased (-0.822213 --> -0.825917).  Saving model ...
Epoch: 39 cost time: 0.4099562168121338
Epoch: 39, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.909 Vali Acc: 0.826 Test Loss: 0.909 Test Acc: 0.826
Validation loss decreased (-0.825917 --> -0.825917).  Saving model ...
Epoch: 40 cost time: 0.3913445472717285
Epoch: 40, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.885 Vali Acc: 0.833 Test Loss: 0.885 Test Acc: 0.833
Validation loss decreased (-0.825917 --> -0.833324).  Saving model ...
Epoch: 41 cost time: 0.41332101821899414
Epoch: 41, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.862 Vali Acc: 0.852 Test Loss: 0.862 Test Acc: 0.852
Validation loss decreased (-0.833324 --> -0.851843).  Saving model ...
Epoch: 42 cost time: 0.5270211696624756
Epoch: 42, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.838 Vali Acc: 0.859 Test Loss: 0.838 Test Acc: 0.859
Validation loss decreased (-0.851843 --> -0.859251).  Saving model ...
Epoch: 43 cost time: 0.4570131301879883
Epoch: 43, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.816 Vali Acc: 0.859 Test Loss: 0.816 Test Acc: 0.859
Validation loss decreased (-0.859251 --> -0.859251).  Saving model ...
Epoch: 44 cost time: 0.405717134475708
Epoch: 44, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.795 Vali Acc: 0.870 Test Loss: 0.795 Test Acc: 0.870
Validation loss decreased (-0.859251 --> -0.870362).  Saving model ...
Epoch: 45 cost time: 0.49571871757507324
Epoch: 45, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.774 Vali Acc: 0.870 Test Loss: 0.774 Test Acc: 0.870
Validation loss decreased (-0.870362 --> -0.870363).  Saving model ...
Epoch: 46 cost time: 0.48414015769958496
Epoch: 46, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.754 Vali Acc: 0.889 Test Loss: 0.754 Test Acc: 0.889
Validation loss decreased (-0.870363 --> -0.888881).  Saving model ...
Epoch: 47 cost time: 0.4713780879974365
Epoch: 47, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.735 Vali Acc: 0.893 Test Loss: 0.735 Test Acc: 0.893
Validation loss decreased (-0.888881 --> -0.892585).  Saving model ...
Epoch: 48 cost time: 0.4328420162200928
Epoch: 48, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.717 Vali Acc: 0.896 Test Loss: 0.717 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896289).  Saving model ...
Epoch: 49 cost time: 0.456906795501709
Epoch: 49, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.700 Vali Acc: 0.900 Test Loss: 0.700 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 50 cost time: 0.45679283142089844
Epoch: 50, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.683 Vali Acc: 0.900 Test Loss: 0.683 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 51 cost time: 0.464766263961792
Epoch: 51, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.667 Vali Acc: 0.900 Test Loss: 0.667 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 52 cost time: 0.48359203338623047
Epoch: 52, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.651 Vali Acc: 0.900 Test Loss: 0.651 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 53 cost time: 0.4944007396697998
Epoch: 53, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.636 Vali Acc: 0.900 Test Loss: 0.636 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 54 cost time: 0.44977807998657227
Epoch: 54, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.622 Vali Acc: 0.900 Test Loss: 0.622 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 55 cost time: 0.5304224491119385
Epoch: 55, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.608 Vali Acc: 0.904 Test Loss: 0.608 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 56 cost time: 0.4886457920074463
Epoch: 56, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.594 Vali Acc: 0.904 Test Loss: 0.594 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 57 cost time: 0.4297318458557129
Epoch: 57, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.581 Vali Acc: 0.904 Test Loss: 0.581 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 58 cost time: 0.43869543075561523
Epoch: 58, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.568 Vali Acc: 0.904 Test Loss: 0.568 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 59 cost time: 0.48717474937438965
Epoch: 59, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.556 Vali Acc: 0.904 Test Loss: 0.556 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 60 cost time: 0.4842369556427002
Epoch: 60, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.545 Vali Acc: 0.907 Test Loss: 0.545 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 61 cost time: 0.45595431327819824
Epoch: 61, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.535 Vali Acc: 0.911 Test Loss: 0.535 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 62 cost time: 0.41446352005004883
Epoch: 62, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.525 Vali Acc: 0.911 Test Loss: 0.525 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 63 cost time: 0.4698140621185303
Epoch: 63, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.514 Vali Acc: 0.911 Test Loss: 0.514 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 64 cost time: 0.4961063861846924
Epoch: 64, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.505 Vali Acc: 0.915 Test Loss: 0.505 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 65 cost time: 0.484816312789917
Epoch: 65, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.496 Vali Acc: 0.911 Test Loss: 0.496 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.4707925319671631
Epoch: 66, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.487 Vali Acc: 0.911 Test Loss: 0.487 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5112879276275635
Epoch: 67, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.478 Vali Acc: 0.915 Test Loss: 0.478 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 68 cost time: 0.5102777481079102
Epoch: 68, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.470 Vali Acc: 0.915 Test Loss: 0.470 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 69 cost time: 0.5106077194213867
Epoch: 69, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.463 Vali Acc: 0.915 Test Loss: 0.463 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 70 cost time: 0.5108554363250732
Epoch: 70, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.456 Vali Acc: 0.919 Test Loss: 0.456 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 71 cost time: 0.47297167778015137
Epoch: 71, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.449 Vali Acc: 0.919 Test Loss: 0.449 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 72 cost time: 0.4410531520843506
Epoch: 72, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.442 Vali Acc: 0.919 Test Loss: 0.442 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 73 cost time: 0.4546947479248047
Epoch: 73, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.434 Vali Acc: 0.919 Test Loss: 0.434 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 74 cost time: 0.3965442180633545
Epoch: 74, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.428 Vali Acc: 0.919 Test Loss: 0.428 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 75 cost time: 0.4817771911621094
Epoch: 75, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.422 Vali Acc: 0.915 Test Loss: 0.422 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.48873257637023926
Epoch: 76, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.416 Vali Acc: 0.919 Test Loss: 0.416 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 77 cost time: 0.5032932758331299
Epoch: 77, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.410 Vali Acc: 0.919 Test Loss: 0.410 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 78 cost time: 0.4541923999786377
Epoch: 78, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.404 Vali Acc: 0.919 Test Loss: 0.404 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 79 cost time: 0.45665693283081055
Epoch: 79, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.399 Vali Acc: 0.915 Test Loss: 0.399 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.43204188346862793
Epoch: 80, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.394 Vali Acc: 0.926 Test Loss: 0.394 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 81 cost time: 0.4769906997680664
Epoch: 81, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.389 Vali Acc: 0.930 Test Loss: 0.389 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 82 cost time: 0.5171575546264648
Epoch: 82, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.383 Vali Acc: 0.930 Test Loss: 0.383 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 83 cost time: 0.4658932685852051
Epoch: 83, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.378 Vali Acc: 0.926 Test Loss: 0.378 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.5189735889434814
Epoch: 84, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.374 Vali Acc: 0.926 Test Loss: 0.374 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.4866507053375244
Epoch: 85, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.369 Vali Acc: 0.930 Test Loss: 0.369 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 86 cost time: 0.48816347122192383
Epoch: 86, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.364 Vali Acc: 0.930 Test Loss: 0.364 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 87 cost time: 0.43842077255249023
Epoch: 87, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.360 Vali Acc: 0.933 Test Loss: 0.360 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 88 cost time: 0.40773630142211914
Epoch: 88, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.356 Vali Acc: 0.933 Test Loss: 0.356 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 89 cost time: 0.4929654598236084
Epoch: 89, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.352 Vali Acc: 0.933 Test Loss: 0.352 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 90 cost time: 0.4499776363372803
Epoch: 90, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.470320463180542
Epoch: 91, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.345 Vali Acc: 0.930 Test Loss: 0.345 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.4318861961364746
Epoch: 92, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.342 Vali Acc: 0.933 Test Loss: 0.342 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 93 cost time: 0.49459147453308105
Epoch: 93, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.338 Vali Acc: 0.933 Test Loss: 0.338 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 94 cost time: 0.4452083110809326
Epoch: 94, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.335 Vali Acc: 0.933 Test Loss: 0.335 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 95 cost time: 0.5226864814758301
Epoch: 95, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.332 Vali Acc: 0.930 Test Loss: 0.332 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.4264664649963379
Epoch: 96, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.329 Vali Acc: 0.933 Test Loss: 0.329 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 97 cost time: 0.457904577255249
Epoch: 97, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.327 Vali Acc: 0.933 Test Loss: 0.327 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 98 cost time: 0.47519683837890625
Epoch: 98, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 99 cost time: 0.48314690589904785
Epoch: 99, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.321 Vali Acc: 0.933 Test Loss: 0.321 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 100 cost time: 0.49489474296569824
Epoch: 100, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.318 Vali Acc: 0.933 Test Loss: 0.318 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_PatchTST_UEA_ftM_sl65_ll0_pl0_el1_dm16_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 6278
model size : 0.34MB
