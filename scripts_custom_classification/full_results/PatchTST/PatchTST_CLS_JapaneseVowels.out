Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.393496751785278
Epoch: 1, Steps: 17 | Train Loss: 1.554 Vali Loss: 0.500 Vali Acc: 0.865 Test Loss: 0.500 Test Acc: 0.865
Validation loss decreased (inf --> -0.864860).  Saving model ...
Epoch: 2 cost time: 2.414191961288452
Epoch: 2, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
Validation loss decreased (-0.864860 --> -0.921619).  Saving model ...
Epoch: 3 cost time: 2.539293050765991
Epoch: 3, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929727).  Saving model ...
Epoch: 4 cost time: 2.580956220626831
Epoch: 4, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.249 Vali Acc: 0.943 Test Loss: 0.249 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 2.4366466999053955
Epoch: 5, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.250 Vali Acc: 0.943 Test Loss: 0.250 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.550060272216797
Epoch: 6, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.378 Vali Acc: 0.919 Test Loss: 0.378 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5062944889068604
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.274 Vali Acc: 0.943 Test Loss: 0.274 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3701391220092773
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.359 Vali Acc: 0.938 Test Loss: 0.359 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.502228021621704
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.935 Test Loss: 0.315 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3381459712982178
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951349).  Saving model ...
Epoch: 11 cost time: 2.5018866062164307
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.951 Test Loss: 0.247 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 2.472729444503784
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.345 Vali Acc: 0.927 Test Loss: 0.345 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4805686473846436
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.335 Vali Acc: 0.938 Test Loss: 0.335 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5466251373291016
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.447 Vali Acc: 0.932 Test Loss: 0.447 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.486647129058838
Epoch: 15, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.405 Vali Acc: 0.927 Test Loss: 0.405 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1193056106567383
Epoch: 16, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.728 Vali Acc: 0.905 Test Loss: 0.728 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1337778568267822
Epoch: 17, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.584 Vali Acc: 0.905 Test Loss: 0.584 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2083842754364014
Epoch: 18, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.459 Vali Acc: 0.935 Test Loss: 0.459 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.390023946762085
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.666 Vali Acc: 0.903 Test Loss: 0.666 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5750133991241455
Epoch: 20, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.479 Vali Acc: 0.935 Test Loss: 0.479 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.39616060256958
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.758 Vali Acc: 0.914 Test Loss: 0.758 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 798857
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.6558685302734375
Epoch: 1, Steps: 17 | Train Loss: 1.803 Vali Loss: 0.907 Vali Acc: 0.770 Test Loss: 0.907 Test Acc: 0.770
Validation loss decreased (inf --> -0.770261).  Saving model ...
Epoch: 2 cost time: 3.2663841247558594
Epoch: 2, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.284 Vali Acc: 0.892 Test Loss: 0.284 Test Acc: 0.892
Validation loss decreased (-0.770261 --> -0.891889).  Saving model ...
Epoch: 3 cost time: 3.2140448093414307
Epoch: 3, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
Validation loss decreased (-0.891889 --> -0.943242).  Saving model ...
Epoch: 4 cost time: 2.9579334259033203
Epoch: 4, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.102165937423706
Epoch: 5, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1695427894592285
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9378340244293213
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 2.6735124588012695
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0987935066223145
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 2.8946533203125
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 11 cost time: 2.9197731018066406
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 3.114694118499756
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7255165576934814
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.951 Test Loss: 0.188 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.089181423187256
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1653144359588623
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.954 Test Loss: 0.194 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8080360889434814
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0961267948150635
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.951 Test Loss: 0.195 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.1902523040771484
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.0745763778686523
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.604081630706787
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.4503533840179443
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 605449
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.457840919494629
Epoch: 1, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.022 Vali Acc: 0.859 Test Loss: 1.022 Test Acc: 0.859
Validation loss decreased (inf --> -0.859449).  Saving model ...
Epoch: 2 cost time: 2.803525924682617
Epoch: 2, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.282 Vali Acc: 0.916 Test Loss: 0.282 Test Acc: 0.916
Validation loss decreased (-0.859449 --> -0.916213).  Saving model ...
Epoch: 3 cost time: 2.8559274673461914
Epoch: 3, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.916213 --> -0.940539).  Saving model ...
Epoch: 4 cost time: 3.177671194076538
Epoch: 4, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 5 cost time: 2.8031270503997803
Epoch: 5, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 3.0335776805877686
Epoch: 6, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3221707344055176
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 3.2047858238220215
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1295554637908936
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.307849645614624
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1793527603149414
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8410885334014893
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4246678352355957
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1733736991882324
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.617030620574951
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2690269947052
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.077441453933716
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 536585
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.1372339725494385
Epoch: 1, Steps: 17 | Train Loss: 1.940 Vali Loss: 1.096 Vali Acc: 0.803 Test Loss: 1.096 Test Acc: 0.803
Validation loss decreased (inf --> -0.802692).  Saving model ...
Epoch: 2 cost time: 2.655794858932495
Epoch: 2, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
Validation loss decreased (-0.802692 --> -0.883780).  Saving model ...
Epoch: 3 cost time: 2.973484992980957
Epoch: 3, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.212 Vali Acc: 0.938 Test Loss: 0.212 Test Acc: 0.938
Validation loss decreased (-0.883780 --> -0.937836).  Saving model ...
Epoch: 4 cost time: 2.99080753326416
Epoch: 4, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 5 cost time: 3.3677661418914795
Epoch: 5, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 2.9290122985839844
Epoch: 6, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.324782371520996
Epoch: 7, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.105630874633789
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.293604612350464
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 3.0494747161865234
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.954 Test Loss: 0.188 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 3.308323383331299
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 2.6339540481567383
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.602987289428711
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5349924564361572
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.939866542816162
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.7881510257720947
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.327610969543457
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.413041830062866
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.611123561859131
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.651951313018799
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.469982147216797
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 522889
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.750757455825806
Epoch: 1, Steps: 17 | Train Loss: 1.970 Vali Loss: 1.250 Vali Acc: 0.749 Test Loss: 1.250 Test Acc: 0.749
Validation loss decreased (inf --> -0.748636).  Saving model ...
Epoch: 2 cost time: 3.117349147796631
Epoch: 2, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
Validation loss decreased (-0.748636 --> -0.889185).  Saving model ...
Epoch: 3 cost time: 2.706894636154175
Epoch: 3, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.218 Vali Acc: 0.932 Test Loss: 0.218 Test Acc: 0.932
Validation loss decreased (-0.889185 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 2.6658873558044434
Epoch: 4, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.932430 --> -0.959458).  Saving model ...
Epoch: 5 cost time: 3.051682710647583
Epoch: 5, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.860780954360962
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6032559871673584
Epoch: 7, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6375207901000977
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.462038278579712
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.867997646331787
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.692887783050537
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7685725688934326
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.728153705596924
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7527825832366943
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 495497
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.676892280578613
Epoch: 1, Steps: 17 | Train Loss: 1.506 Vali Loss: 0.490 Vali Acc: 0.884 Test Loss: 0.490 Test Acc: 0.884
Validation loss decreased (inf --> -0.883779).  Saving model ...
Epoch: 2 cost time: 3.345405340194702
Epoch: 2, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.219 Vali Acc: 0.927 Test Loss: 0.219 Test Acc: 0.927
Validation loss decreased (-0.883779 --> -0.927025).  Saving model ...
Epoch: 3 cost time: 2.9336531162261963
Epoch: 3, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.223 Vali Acc: 0.927 Test Loss: 0.223 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.99771785736084
Epoch: 4, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6960983276367188
Epoch: 5, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.700138568878174
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.319 Vali Acc: 0.943 Test Loss: 0.319 Test Acc: 0.943
Validation loss decreased (-0.927025 --> -0.943240).  Saving model ...
Epoch: 7 cost time: 3.728346109390259
Epoch: 7, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8025963306427
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.502 Vali Acc: 0.908 Test Loss: 0.502 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.843902349472046
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.372 Vali Acc: 0.938 Test Loss: 0.372 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.564530849456787
Epoch: 10, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.587 Vali Acc: 0.897 Test Loss: 0.587 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.7142879962921143
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.561 Vali Acc: 0.916 Test Loss: 0.561 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6042943000793457
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.657 Vali Acc: 0.914 Test Loss: 0.657 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.535862922668457
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.474 Vali Acc: 0.938 Test Loss: 0.474 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.6083872318267822
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.419 Vali Acc: 0.935 Test Loss: 0.419 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.6048996448516846
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.930 Test Loss: 0.429 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.856346607208252
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.927 Test Loss: 0.437 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 700169
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.416362047195435
Epoch: 1, Steps: 17 | Train Loss: 1.796 Vali Loss: 0.802 Vali Acc: 0.851 Test Loss: 0.802 Test Acc: 0.851
Validation loss decreased (inf --> -0.851343).  Saving model ...
Epoch: 2 cost time: 3.5087153911590576
Epoch: 2, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.287 Vali Acc: 0.892 Test Loss: 0.287 Test Acc: 0.892
Validation loss decreased (-0.851343 --> -0.891889).  Saving model ...
Epoch: 3 cost time: 3.438141107559204
Epoch: 3, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.221 Vali Acc: 0.916 Test Loss: 0.221 Test Acc: 0.916
Validation loss decreased (-0.891889 --> -0.916214).  Saving model ...
Epoch: 4 cost time: 3.4272263050079346
Epoch: 4, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.188 Vali Acc: 0.927 Test Loss: 0.188 Test Acc: 0.927
Validation loss decreased (-0.916214 --> -0.927025).  Saving model ...
Epoch: 5 cost time: 3.095045804977417
Epoch: 5, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.208 Vali Acc: 0.938 Test Loss: 0.208 Test Acc: 0.938
Validation loss decreased (-0.927025 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 3.083961248397827
Epoch: 6, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.292 Vali Acc: 0.914 Test Loss: 0.292 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2587592601776123
Epoch: 7, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.201 Vali Acc: 0.943 Test Loss: 0.201 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 3.2867650985717773
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.242 Vali Acc: 0.938 Test Loss: 0.242 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.832371234893799
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.938 Test Loss: 0.210 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.153218984603882
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.343785524368286
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8859243392944336
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.574277400970459
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.367372751235962
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.614020347595215
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.4716591835021973
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.724729299545288
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 506761
model size : 4.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.285903215408325
Epoch: 1, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.016 Vali Acc: 0.805 Test Loss: 1.016 Test Acc: 0.805
Validation loss decreased (inf --> -0.805395).  Saving model ...
Epoch: 2 cost time: 2.96155047416687
Epoch: 2, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
Validation loss decreased (-0.805395 --> -0.929727).  Saving model ...
Epoch: 3 cost time: 2.656111001968384
Epoch: 3, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.226 Vali Acc: 0.938 Test Loss: 0.226 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937836).  Saving model ...
Epoch: 4 cost time: 2.658231019973755
Epoch: 4, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
Validation loss decreased (-0.937836 --> -0.948647).  Saving model ...
Epoch: 5 cost time: 3.050072431564331
Epoch: 5, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2883989810943604
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 7 cost time: 2.993769645690918
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0397567749023438
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1190717220306396
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.500178575515747
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 2.598921298980713
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5288989543914795
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3398218154907227
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 2.7139742374420166
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.807016611099243
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3509373664855957
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.919703245162964
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.497687816619873
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7794642448425293
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.2077672481536865
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.296213150024414
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.8841958045959473
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 2.833132028579712
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3064279556274414
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.282674789428711
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.738818883895874
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.60536789894104
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.6341705322265625
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.491885185241699
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.632692337036133
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.4863028526306152
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.1134634017944336
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 437897
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.005507469177246
Epoch: 1, Steps: 17 | Train Loss: 1.986 Vali Loss: 1.129 Vali Acc: 0.773 Test Loss: 1.129 Test Acc: 0.773
Validation loss decreased (inf --> -0.772962).  Saving model ...
Epoch: 2 cost time: 3.2965047359466553
Epoch: 2, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.334 Vali Acc: 0.895 Test Loss: 0.334 Test Acc: 0.895
Validation loss decreased (-0.772962 --> -0.894591).  Saving model ...
Epoch: 3 cost time: 3.6007955074310303
Epoch: 3, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.230 Vali Acc: 0.927 Test Loss: 0.230 Test Acc: 0.927
Validation loss decreased (-0.894591 --> -0.927025).  Saving model ...
Epoch: 4 cost time: 3.198817253112793
Epoch: 4, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
Validation loss decreased (-0.927025 --> -0.943242).  Saving model ...
Epoch: 5 cost time: 3.62099289894104
Epoch: 5, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
Validation loss decreased (-0.943242 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 3.056718349456787
Epoch: 6, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.686995029449463
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.156 Vali Acc: 0.941 Test Loss: 0.156 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3044803142547607
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5137455463409424
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.7113049030303955
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.8116822242736816
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.901218891143799
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.4067344665527344
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.838653087615967
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.732672691345215
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 424201
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.818893671035767
Epoch: 1, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.251 Vali Acc: 0.800 Test Loss: 1.251 Test Acc: 0.800
Validation loss decreased (inf --> -0.799987).  Saving model ...
Epoch: 2 cost time: 3.4645655155181885
Epoch: 2, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.404 Vali Acc: 0.916 Test Loss: 0.404 Test Acc: 0.916
Validation loss decreased (-0.799987 --> -0.916212).  Saving model ...
Epoch: 3 cost time: 3.327291488647461
Epoch: 3, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.916212 --> -0.940539).  Saving model ...
Epoch: 4 cost time: 3.2404625415802
Epoch: 4, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 5 cost time: 3.1554722785949707
Epoch: 5, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 3.268429756164551
Epoch: 6, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3404083251953125
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.713132619857788
Epoch: 8, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7407712936401367
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.9338414669036865
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 2.18312668800354
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.525538921356201
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4081838130950928
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7118070125579834
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.8647241592407227
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9497134685516357
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.9599053859710693
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.7744603157043457
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.0261523723602295
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.811845064163208
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 396809
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.873175621032715
Epoch: 1, Steps: 17 | Train Loss: 1.612 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
Validation loss decreased (inf --> -0.862157).  Saving model ...
Epoch: 2 cost time: 3.656262159347534
Epoch: 2, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
Validation loss decreased (-0.862157 --> -0.870266).  Saving model ...
Epoch: 3 cost time: 3.127450704574585
Epoch: 3, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.256 Vali Acc: 0.932 Test Loss: 0.256 Test Acc: 0.932
Validation loss decreased (-0.870266 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 3.278499126434326
Epoch: 4, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.252 Vali Acc: 0.924 Test Loss: 0.252 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9139647483825684
Epoch: 5, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7960522174835205
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9515342712402344
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.799652099609375
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.274 Vali Acc: 0.941 Test Loss: 0.274 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940538).  Saving model ...
Epoch: 9 cost time: 3.049248695373535
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.951 Test Loss: 0.266 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951349).  Saving model ...
Epoch: 10 cost time: 3.560452938079834
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.949 Test Loss: 0.288 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9781014919281006
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.943 Test Loss: 0.279 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4399454593658447
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.946 Test Loss: 0.273 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5756099224090576
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.943 Test Loss: 0.265 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3205389976501465
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.946 Test Loss: 0.264 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.1384077072143555
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.949 Test Loss: 0.265 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.545415163040161
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.946 Test Loss: 0.264 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.3111014366149902
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.946 Test Loss: 0.264 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.442638397216797
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.946 Test Loss: 0.263 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.2701478004455566
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.946 Test Loss: 0.264 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 650825
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.681959867477417
Epoch: 1, Steps: 17 | Train Loss: 1.790 Vali Loss: 0.795 Vali Acc: 0.843 Test Loss: 0.795 Test Acc: 0.843
Validation loss decreased (inf --> -0.843235).  Saving model ...
Epoch: 2 cost time: 2.726138114929199
Epoch: 2, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.242 Vali Acc: 0.916 Test Loss: 0.242 Test Acc: 0.916
Validation loss decreased (-0.843235 --> -0.916214).  Saving model ...
Epoch: 3 cost time: 2.632802963256836
Epoch: 3, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
Validation loss decreased (-0.916214 --> -0.943241).  Saving model ...
Epoch: 4 cost time: 2.4706966876983643
Epoch: 4, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.202 Vali Acc: 0.932 Test Loss: 0.202 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4037840366363525
Epoch: 5, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.7225687503814697
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.268 Vali Acc: 0.927 Test Loss: 0.268 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.655407190322876
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8535428047180176
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 2.718437433242798
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.255 Vali Acc: 0.919 Test Loss: 0.255 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0210235118865967
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.10489821434021
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 2.8747141361236572
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 2.577387809753418
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4853100776672363
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.554018497467041
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5905113220214844
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7152578830718994
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.7890784740448
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.748743772506714
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.9513702392578125
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.80610728263855
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.547067403793335
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 457417
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.071585416793823
Epoch: 1, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.102 Vali Acc: 0.776 Test Loss: 1.102 Test Acc: 0.776
Validation loss decreased (inf --> -0.775665).  Saving model ...
Epoch: 2 cost time: 2.785515308380127
Epoch: 2, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.340 Vali Acc: 0.895 Test Loss: 0.340 Test Acc: 0.895
Validation loss decreased (-0.775665 --> -0.894591).  Saving model ...
Epoch: 3 cost time: 2.6606028079986572
Epoch: 3, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.894591 --> -0.940538).  Saving model ...
Epoch: 4 cost time: 2.771014451980591
Epoch: 4, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.199 Vali Acc: 0.938 Test Loss: 0.199 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.541998863220215
Epoch: 5, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.940538 --> -0.959458).  Saving model ...
Epoch: 6 cost time: 2.4405856132507324
Epoch: 6, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6379127502441406
Epoch: 7, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5040600299835205
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6195547580718994
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5703158378601074
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7043955326080322
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7267520427703857
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6839985847473145
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.0440380573272705
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.515923261642456
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 388553
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.574682712554932
Epoch: 1, Steps: 17 | Train Loss: 1.970 Vali Loss: 1.146 Vali Acc: 0.751 Test Loss: 1.146 Test Acc: 0.751
Validation loss decreased (inf --> -0.751340).  Saving model ...
Epoch: 2 cost time: 2.3436689376831055
Epoch: 2, Steps: 17 | Train Loss: 0.702 Vali Loss: 0.363 Vali Acc: 0.916 Test Loss: 0.363 Test Acc: 0.916
Validation loss decreased (-0.751340 --> -0.916213).  Saving model ...
Epoch: 3 cost time: 2.5908892154693604
Epoch: 3, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3490567207336426
Epoch: 4, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
Validation loss decreased (-0.916213 --> -0.937836).  Saving model ...
Epoch: 5 cost time: 2.656911611557007
Epoch: 5, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 2.9933712482452393
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 7 cost time: 3.1509461402893066
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.189 Vali Acc: 0.946 Test Loss: 0.189 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.130507469177246
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.932 Test Loss: 0.197 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0031309127807617
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0026817321777344
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.825807809829712
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8155171871185303
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7784109115600586
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5443179607391357
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7578418254852295
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5817391872406006
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 374857
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.770065546035767
Epoch: 1, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.223 Vali Acc: 0.776 Test Loss: 1.223 Test Acc: 0.776
Validation loss decreased (inf --> -0.775663).  Saving model ...
Epoch: 2 cost time: 3.9404897689819336
Epoch: 2, Steps: 17 | Train Loss: 0.799 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
Validation loss decreased (-0.775663 --> -0.899996).  Saving model ...
Epoch: 3 cost time: 3.8507156372070312
Epoch: 3, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.225 Vali Acc: 0.927 Test Loss: 0.225 Test Acc: 0.927
Validation loss decreased (-0.899996 --> -0.927025).  Saving model ...
Epoch: 4 cost time: 3.7800631523132324
Epoch: 4, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
Validation loss decreased (-0.927025 --> -0.948647).  Saving model ...
Epoch: 5 cost time: 4.175799131393433
Epoch: 5, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 3.9470303058624268
Epoch: 6, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5992629528045654
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 8 cost time: 3.9345192909240723
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8156917095184326
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 3.059398651123047
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.742854118347168
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5514636039733887
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6366000175476074
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0931084156036377
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.7788970470428467
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4701087474823
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.2859907150268555
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.2640583515167236
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.126640319824219
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 347465
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.795520782470703
Epoch: 1, Steps: 17 | Train Loss: 1.862 Vali Loss: 0.950 Vali Acc: 0.735 Test Loss: 0.950 Test Acc: 0.735
Validation loss decreased (inf --> -0.735126).  Saving model ...
Epoch: 2 cost time: 4.3241355419158936
Epoch: 2, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.300 Vali Acc: 0.919 Test Loss: 0.300 Test Acc: 0.919
Validation loss decreased (-0.735126 --> -0.918916).  Saving model ...
Epoch: 3 cost time: 3.7147951126098633
Epoch: 3, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.266 Vali Acc: 0.927 Test Loss: 0.266 Test Acc: 0.927
Validation loss decreased (-0.918916 --> -0.927024).  Saving model ...
Epoch: 4 cost time: 3.5931389331817627
Epoch: 4, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.927024 --> -0.954052).  Saving model ...
Epoch: 5 cost time: 3.9973764419555664
Epoch: 5, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.251142263412476
Epoch: 6, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.932 Test Loss: 0.213 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.386115550994873
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.073534250259399
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.468337774276733
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.433786153793335
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.943 Test Loss: 0.212 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.469104290008545
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.938 Test Loss: 0.214 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.3557448387146
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.7065868377685547
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.938 Test Loss: 0.211 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.029508352279663
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.938 Test Loss: 0.207 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 350665
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.684330224990845
Epoch: 1, Steps: 17 | Train Loss: 2.009 Vali Loss: 1.359 Vali Acc: 0.681 Test Loss: 1.359 Test Acc: 0.681
Validation loss decreased (inf --> -0.681067).  Saving model ...
Epoch: 2 cost time: 3.707085609436035
Epoch: 2, Steps: 17 | Train Loss: 0.810 Vali Loss: 0.407 Vali Acc: 0.892 Test Loss: 0.407 Test Acc: 0.892
Validation loss decreased (-0.681067 --> -0.891888).  Saving model ...
Epoch: 3 cost time: 2.8556673526763916
Epoch: 3, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
Validation loss decreased (-0.891888 --> -0.943241).  Saving model ...
Epoch: 4 cost time: 2.92410945892334
Epoch: 4, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8624911308288574
Epoch: 5, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.196 Vali Acc: 0.919 Test Loss: 0.196 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.460444688796997
Epoch: 6, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 4.054184675216675
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.725602626800537
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 3.615325450897217
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 3.8405680656433105
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 4.027974843978882
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 12 cost time: 3.070605754852295
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.565093994140625
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.76126766204834
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.516005277633667
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 3.5841705799102783
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5751969814300537
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.112359285354614
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6414201259613037
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7576756477355957
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.8385019302368164
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.116812705993652
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.5312893390655518
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.636953353881836
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.979255437850952
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 253961
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9463701248168945
Epoch: 1, Steps: 17 | Train Loss: 2.033 Vali Loss: 1.468 Vali Acc: 0.676 Test Loss: 1.468 Test Acc: 0.676
Validation loss decreased (inf --> -0.675661).  Saving model ...
Epoch: 2 cost time: 1.716606616973877
Epoch: 2, Steps: 17 | Train Loss: 1.010 Vali Loss: 0.584 Vali Acc: 0.884 Test Loss: 0.584 Test Acc: 0.884
Validation loss decreased (-0.675661 --> -0.883778).  Saving model ...
Epoch: 3 cost time: 1.9318883419036865
Epoch: 3, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.255 Vali Acc: 0.932 Test Loss: 0.255 Test Acc: 0.932
Validation loss decreased (-0.883778 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 1.5756521224975586
Epoch: 4, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
Validation loss decreased (-0.932430 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 1.7702381610870361
Epoch: 5, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 6 cost time: 1.6281707286834717
Epoch: 6, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.7393362522125244
Epoch: 7, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.876467227935791
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8098514080047607
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.169 Vali Acc: 0.938 Test Loss: 0.169 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5821623802185059
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 1.6923344135284424
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 1.628779411315918
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7880580425262451
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8412744998931885
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7987585067749023
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7700717449188232
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7299439907073975
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5590929985046387
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7731349468231201
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.689073085784912
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.30865478515625
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 219529
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6833794116973877
Epoch: 1, Steps: 17 | Train Loss: 2.148 Vali Loss: 1.613 Vali Acc: 0.611 Test Loss: 1.613 Test Acc: 0.611
Validation loss decreased (inf --> -0.610795).  Saving model ...
Epoch: 2 cost time: 1.6434082984924316
Epoch: 2, Steps: 17 | Train Loss: 1.153 Vali Loss: 0.705 Vali Acc: 0.857 Test Loss: 0.705 Test Acc: 0.857
Validation loss decreased (-0.610795 --> -0.856750).  Saving model ...
Epoch: 3 cost time: 1.6886255741119385
Epoch: 3, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.347 Vali Acc: 0.905 Test Loss: 0.347 Test Acc: 0.905
Validation loss decreased (-0.856750 --> -0.905402).  Saving model ...
Epoch: 4 cost time: 1.839381217956543
Epoch: 4, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
Validation loss decreased (-0.905402 --> -0.921619).  Saving model ...
Epoch: 5 cost time: 1.6212105751037598
Epoch: 5, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
Validation loss decreased (-0.921619 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.658475399017334
Epoch: 6, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7931501865386963
Epoch: 7, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 8 cost time: 1.8539197444915771
Epoch: 8, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.9347999095916748
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6976649761199951
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6844680309295654
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6730680465698242
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.843165636062622
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 1.6292822360992432
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6600775718688965
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4817440509796143
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8222630023956299
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.725586175918579
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8301551342010498
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9072163105010986
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.01741623878479
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9494662284851074
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8574132919311523
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 212681
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9317867755889893
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 1.721 Vali Acc: 0.581 Test Loss: 1.721 Test Acc: 0.581
Validation loss decreased (inf --> -0.581064).  Saving model ...
Epoch: 2 cost time: 1.626112699508667
Epoch: 2, Steps: 17 | Train Loss: 1.272 Vali Loss: 0.808 Vali Acc: 0.873 Test Loss: 0.808 Test Acc: 0.873
Validation loss decreased (-0.581064 --> -0.872965).  Saving model ...
Epoch: 3 cost time: 1.6765735149383545
Epoch: 3, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.363 Vali Acc: 0.914 Test Loss: 0.363 Test Acc: 0.914
Validation loss decreased (-0.872965 --> -0.913510).  Saving model ...
Epoch: 4 cost time: 1.9511921405792236
Epoch: 4, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.236 Vali Acc: 0.932 Test Loss: 0.236 Test Acc: 0.932
Validation loss decreased (-0.913510 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 1.6755237579345703
Epoch: 5, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.5611376762390137
Epoch: 6, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.392392873764038
Epoch: 7, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5394234657287598
Epoch: 8, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.5167500972747803
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 1.8069214820861816
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6987156867980957
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7607460021972656
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.944153070449829
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 14 cost time: 1.8049490451812744
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.616480827331543
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 1.573423147201538
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7149198055267334
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7492516040802002
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5286798477172852
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5471267700195312
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3791534900665283
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3519015312194824
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3570497035980225
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.487304925918579
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6483678817749023
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 198985
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.715128660202026
Epoch: 1, Steps: 17 | Train Loss: 1.929 Vali Loss: 0.925 Vali Acc: 0.803 Test Loss: 0.925 Test Acc: 0.803
Validation loss decreased (inf --> -0.802693).  Saving model ...
Epoch: 2 cost time: 3.042180299758911
Epoch: 2, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.338 Vali Acc: 0.895 Test Loss: 0.338 Test Acc: 0.895
Validation loss decreased (-0.802693 --> -0.894591).  Saving model ...
Epoch: 3 cost time: 2.9315898418426514
Epoch: 3, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
Validation loss decreased (-0.894591 --> -0.937836).  Saving model ...
Epoch: 4 cost time: 2.8259944915771484
Epoch: 4, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.209 Vali Acc: 0.938 Test Loss: 0.209 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.289769172668457
Epoch: 5, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.937836 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 3.329639434814453
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3603200912475586
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.542282819747925
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5940232276916504
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.943 Test Loss: 0.193 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.126405715942383
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5764427185058594
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.571545362472534
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4453048706054688
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.240736961364746
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.6912355422973633
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 301129
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.115612268447876
Epoch: 1, Steps: 17 | Train Loss: 1.996 Vali Loss: 1.319 Vali Acc: 0.730 Test Loss: 1.319 Test Acc: 0.730
Validation loss decreased (inf --> -0.729717).  Saving model ...
Epoch: 2 cost time: 2.537006139755249
Epoch: 2, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
Validation loss decreased (-0.729717 --> -0.899996).  Saving model ...
Epoch: 3 cost time: 2.6000070571899414
Epoch: 3, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.278 Vali Acc: 0.916 Test Loss: 0.278 Test Acc: 0.916
Validation loss decreased (-0.899996 --> -0.916213).  Saving model ...
Epoch: 4 cost time: 2.747704029083252
Epoch: 4, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
Validation loss decreased (-0.916213 --> -0.945944).  Saving model ...
Epoch: 5 cost time: 2.8887505531311035
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 6 cost time: 2.4326961040496826
Epoch: 6, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3505351543426514
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.932 Test Loss: 0.167 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3563199043273926
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.7416677474975586
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4586331844329834
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2115423679351807
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.353438377380371
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.1756410598754883
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.7552669048309326
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.9400665760040283
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 204425
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.377089262008667
Epoch: 1, Steps: 17 | Train Loss: 1.999 Vali Loss: 1.398 Vali Acc: 0.727 Test Loss: 1.398 Test Acc: 0.727
Validation loss decreased (inf --> -0.727013).  Saving model ...
Epoch: 2 cost time: 1.7991962432861328
Epoch: 2, Steps: 17 | Train Loss: 0.974 Vali Loss: 0.536 Vali Acc: 0.897 Test Loss: 0.536 Test Acc: 0.897
Validation loss decreased (-0.727013 --> -0.897292).  Saving model ...
Epoch: 3 cost time: 1.7490863800048828
Epoch: 3, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.270 Vali Acc: 0.924 Test Loss: 0.270 Test Acc: 0.924
Validation loss decreased (-0.897292 --> -0.924322).  Saving model ...
Epoch: 4 cost time: 1.8768494129180908
Epoch: 4, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.204 Vali Acc: 0.938 Test Loss: 0.204 Test Acc: 0.938
Validation loss decreased (-0.924322 --> -0.937836).  Saving model ...
Epoch: 5 cost time: 1.9423964023590088
Epoch: 5, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.6384284496307373
Epoch: 6, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.6910083293914795
Epoch: 7, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 1.8034930229187012
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7716457843780518
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.734736680984497
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.637538194656372
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.79768967628479
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.497248649597168
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7236127853393555
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.857215404510498
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7107715606689453
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 1.6952455043792725
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6227679252624512
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7221360206604004
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8601787090301514
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.634852409362793
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9319474697113037
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.888153076171875
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 1.7966535091400146
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7023882865905762
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7687170505523682
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.222233533859253
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3716762065887451
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4805934429168701
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3100664615631104
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8879132270812988
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8173339366912842
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7928271293640137
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 169993
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.447296142578125
Epoch: 1, Steps: 17 | Train Loss: 2.132 Vali Loss: 1.608 Vali Acc: 0.565 Test Loss: 1.608 Test Acc: 0.565
Validation loss decreased (inf --> -0.564849).  Saving model ...
Epoch: 2 cost time: 1.7923734188079834
Epoch: 2, Steps: 17 | Train Loss: 1.230 Vali Loss: 0.761 Vali Acc: 0.824 Test Loss: 0.761 Test Acc: 0.824
Validation loss decreased (-0.564849 --> -0.824317).  Saving model ...
Epoch: 3 cost time: 1.5558736324310303
Epoch: 3, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.356 Vali Acc: 0.911 Test Loss: 0.356 Test Acc: 0.911
Validation loss decreased (-0.824317 --> -0.910807).  Saving model ...
Epoch: 4 cost time: 1.5791144371032715
Epoch: 4, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (-0.910807 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 1.3564226627349854
Epoch: 5, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
Validation loss decreased (-0.929727 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.6128578186035156
Epoch: 6, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.180 Vali Acc: 0.938 Test Loss: 0.180 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3234903812408447
Epoch: 7, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.4746346473693848
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.3984241485595703
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 1.656684398651123
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5670790672302246
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4787969589233398
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.453568935394287
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5932412147521973
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.696291208267212
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8020503520965576
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.52443528175354
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4981069564819336
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.533144235610962
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 163145
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.508467197418213
Epoch: 1, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.549 Vali Acc: 0.641 Test Loss: 1.549 Test Acc: 0.641
Validation loss decreased (inf --> -0.640525).  Saving model ...
Epoch: 2 cost time: 1.502058982849121
Epoch: 2, Steps: 17 | Train Loss: 1.212 Vali Loss: 0.790 Vali Acc: 0.830 Test Loss: 0.790 Test Acc: 0.830
Validation loss decreased (-0.640525 --> -0.829722).  Saving model ...
Epoch: 3 cost time: 1.4841768741607666
Epoch: 3, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.829722 --> -0.899996).  Saving model ...
Epoch: 4 cost time: 1.5191853046417236
Epoch: 4, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.242 Vali Acc: 0.932 Test Loss: 0.242 Test Acc: 0.932
Validation loss decreased (-0.899996 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 1.7016069889068604
Epoch: 5, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.193 Vali Acc: 0.943 Test Loss: 0.193 Test Acc: 0.943
Validation loss decreased (-0.932430 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.6252412796020508
Epoch: 6, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.5589752197265625
Epoch: 7, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
Validation loss decreased (-0.943241 --> -0.959458).  Saving model ...
Epoch: 8 cost time: 1.8674180507659912
Epoch: 8, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6037702560424805
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5121760368347168
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.806922435760498
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6702771186828613
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7200431823730469
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8614003658294678
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6796772480010986
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7874248027801514
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6382761001586914
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 149449
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.842169761657715
Epoch: 1, Steps: 17 | Train Loss: 1.788 Vali Loss: 0.852 Vali Acc: 0.838 Test Loss: 0.852 Test Acc: 0.838
Validation loss decreased (inf --> -0.837829).  Saving model ...
Epoch: 2 cost time: 2.697556734085083
Epoch: 2, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
Validation loss decreased (-0.837829 --> -0.910808).  Saving model ...
Epoch: 3 cost time: 2.791227102279663
Epoch: 3, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
Validation loss decreased (-0.910808 --> -0.921620).  Saving model ...
Epoch: 4 cost time: 2.836678981781006
Epoch: 4, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.279 Vali Acc: 0.916 Test Loss: 0.279 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9111433029174805
Epoch: 5, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.202 Vali Acc: 0.927 Test Loss: 0.202 Test Acc: 0.927
Validation loss decreased (-0.921620 --> -0.927025).  Saving model ...
Epoch: 6 cost time: 3.3453633785247803
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.255 Vali Acc: 0.908 Test Loss: 0.255 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.449948310852051
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.945155620574951
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.927 Test Loss: 0.201 Test Acc: 0.927
Validation loss decreased (-0.927025 --> -0.927025).  Saving model ...
Epoch: 9 cost time: 3.1761162281036377
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
Validation loss decreased (-0.927025 --> -0.929727).  Saving model ...
Epoch: 10 cost time: 3.1638705730438232
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.938 Test Loss: 0.218 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937836).  Saving model ...
Epoch: 11 cost time: 3.0032503604888916
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940538).  Saving model ...
Epoch: 12 cost time: 3.1931066513061523
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 13 cost time: 2.8455419540405273
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 14 cost time: 2.593604564666748
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 15 cost time: 2.697098970413208
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 16 cost time: 2.916961669921875
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1132822036743164
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.961357831954956
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.916837692260742
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.8444325923919678
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.8684234619140625
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.943 Test Loss: 0.220 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.0593109130859375
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.807147264480591
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.943 Test Loss: 0.220 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.873324155807495
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 25 cost time: 2.410956859588623
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948646).  Saving model ...
Epoch: 26 cost time: 2.3610525131225586
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5894367694854736
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.542745351791382
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.074805974960327
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.135836124420166
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.8620681762695312
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.6845781803131104
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.946 Test Loss: 0.224 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.934849739074707
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.1049118041992188
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.946 Test Loss: 0.226 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.333186388015747
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.946 Test Loss: 0.226 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 276361
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.165473699569702
Epoch: 1, Steps: 17 | Train Loss: 2.080 Vali Loss: 1.396 Vali Acc: 0.659 Test Loss: 1.396 Test Acc: 0.659
Validation loss decreased (inf --> -0.659446).  Saving model ...
Epoch: 2 cost time: 2.1704201698303223
Epoch: 2, Steps: 17 | Train Loss: 0.893 Vali Loss: 0.448 Vali Acc: 0.886 Test Loss: 0.448 Test Acc: 0.886
Validation loss decreased (-0.659446 --> -0.886482).  Saving model ...
Epoch: 3 cost time: 2.8691039085388184
Epoch: 3, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.275 Vali Acc: 0.908 Test Loss: 0.275 Test Acc: 0.908
Validation loss decreased (-0.886482 --> -0.908105).  Saving model ...
Epoch: 4 cost time: 2.830681324005127
Epoch: 4, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.179 Vali Acc: 0.938 Test Loss: 0.179 Test Acc: 0.938
Validation loss decreased (-0.908105 --> -0.937836).  Saving model ...
Epoch: 5 cost time: 2.5779542922973633
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.937836 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 2.873584270477295
Epoch: 6, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.204 Vali Acc: 0.919 Test Loss: 0.204 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9027233123779297
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5195462703704834
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.505291223526001
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0168776512145996
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.640249252319336
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4844300746917725
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 2.1900181770324707
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.869704246520996
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.282315492630005
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 2.762312173843384
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2735188007354736
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.009803295135498
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.1853220462799072
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1619021892547607
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.918789863586426
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.3611321449279785
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5563771724700928
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.383207321166992
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.305041790008545
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 179657
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.394970655441284
Epoch: 1, Steps: 17 | Train Loss: 2.139 Vali Loss: 1.555 Vali Acc: 0.641 Test Loss: 1.555 Test Acc: 0.641
Validation loss decreased (inf --> -0.640525).  Saving model ...
Epoch: 2 cost time: 1.8028473854064941
Epoch: 2, Steps: 17 | Train Loss: 1.100 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
Validation loss decreased (-0.640525 --> -0.899994).  Saving model ...
Epoch: 3 cost time: 1.8245854377746582
Epoch: 3, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.287 Vali Acc: 0.932 Test Loss: 0.287 Test Acc: 0.932
Validation loss decreased (-0.899994 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 1.778167724609375
Epoch: 4, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 1.5467987060546875
Epoch: 5, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 1.6641871929168701
Epoch: 6, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.8986592292785645
Epoch: 7, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.9305565357208252
Epoch: 8, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.7275526523590088
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.6951367855072021
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6530869007110596
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.6907296180725098
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8004648685455322
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.830763578414917
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7944889068603516
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7492189407348633
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7335894107818604
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.769883394241333
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7654156684875488
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8828625679016113
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.695831537246704
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 145225
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.349705457687378
Epoch: 1, Steps: 17 | Train Loss: 1.984 Vali Loss: 1.434 Vali Acc: 0.681 Test Loss: 1.434 Test Acc: 0.681
Validation loss decreased (inf --> -0.681067).  Saving model ...
Epoch: 2 cost time: 1.7001051902770996
Epoch: 2, Steps: 17 | Train Loss: 1.104 Vali Loss: 0.674 Vali Acc: 0.851 Test Loss: 0.674 Test Acc: 0.851
Validation loss decreased (-0.681067 --> -0.851345).  Saving model ...
Epoch: 3 cost time: 1.885028600692749
Epoch: 3, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.329 Vali Acc: 0.905 Test Loss: 0.329 Test Acc: 0.905
Validation loss decreased (-0.851345 --> -0.905402).  Saving model ...
Epoch: 4 cost time: 1.7035667896270752
Epoch: 4, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.256 Vali Acc: 0.924 Test Loss: 0.256 Test Acc: 0.924
Validation loss decreased (-0.905402 --> -0.924322).  Saving model ...
Epoch: 5 cost time: 1.7264258861541748
Epoch: 5, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.924322 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 1.7960131168365479
Epoch: 6, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.7688817977905273
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 8 cost time: 1.8172578811645508
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8462202548980713
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 1.7566542625427246
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5942108631134033
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6189756393432617
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.836012601852417
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.806386947631836
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 1.6491718292236328
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.190062999725342
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.826789140701294
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5787570476531982
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.372138500213623
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4562737941741943
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4300167560577393
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3307135105133057
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6907083988189697
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6622631549835205
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 138377
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.151411294937134
Epoch: 1, Steps: 17 | Train Loss: 2.108 Vali Loss: 1.660 Vali Acc: 0.578 Test Loss: 1.660 Test Acc: 0.578
Validation loss decreased (inf --> -0.578362).  Saving model ...
Epoch: 2 cost time: 1.658461332321167
Epoch: 2, Steps: 17 | Train Loss: 1.310 Vali Loss: 0.810 Vali Acc: 0.846 Test Loss: 0.810 Test Acc: 0.846
Validation loss decreased (-0.578362 --> -0.845938).  Saving model ...
Epoch: 3 cost time: 1.5785953998565674
Epoch: 3, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.392 Vali Acc: 0.897 Test Loss: 0.392 Test Acc: 0.897
Validation loss decreased (-0.845938 --> -0.897293).  Saving model ...
Epoch: 4 cost time: 1.6977977752685547
Epoch: 4, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.254 Vali Acc: 0.938 Test Loss: 0.254 Test Acc: 0.938
Validation loss decreased (-0.897293 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 1.6625261306762695
Epoch: 5, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.211 Vali Acc: 0.932 Test Loss: 0.211 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5463454723358154
Epoch: 6, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 1.4210941791534424
Epoch: 7, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.5211539268493652
Epoch: 8, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6261858940124512
Epoch: 9, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.2818410396575928
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 1.7188687324523926
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 12 cost time: 1.671116590499878
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4667248725891113
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5897324085235596
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 1.3975286483764648
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2183732986450195
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4292278289794922
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2863800525665283
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.293761968612671
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3617019653320312
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5373294353485107
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4240517616271973
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7199733257293701
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.674952745437622
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 124681
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.355230331420898
Epoch: 1, Steps: 17 | Train Loss: 2.060 Vali Loss: 1.413 Vali Acc: 0.754 Test Loss: 1.413 Test Acc: 0.754
Validation loss decreased (inf --> -0.754040).  Saving model ...
Epoch: 2 cost time: 2.1758949756622314
Epoch: 2, Steps: 17 | Train Loss: 0.907 Vali Loss: 0.491 Vali Acc: 0.878 Test Loss: 0.491 Test Acc: 0.878
Validation loss decreased (-0.754040 --> -0.878373).  Saving model ...
Epoch: 3 cost time: 2.4393210411071777
Epoch: 3, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.279 Vali Acc: 0.908 Test Loss: 0.279 Test Acc: 0.908
Validation loss decreased (-0.878373 --> -0.908105).  Saving model ...
Epoch: 4 cost time: 2.650672435760498
Epoch: 4, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
Validation loss decreased (-0.908105 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 2.8047432899475098
Epoch: 5, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 2.6694464683532715
Epoch: 6, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 2.3165807723999023
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8679101467132568
Epoch: 8, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.9037015438079834
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.9911127090454102
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.096292734146118
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5819921493530273
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1341843605041504
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.471146821975708
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7299869060516357
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.732250452041626
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.513640880584717
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.44541335105896
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2847800254821777
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 163433
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.448514223098755
Epoch: 1, Steps: 17 | Train Loss: 2.150 Vali Loss: 1.699 Vali Acc: 0.578 Test Loss: 1.699 Test Acc: 0.578
Validation loss decreased (inf --> -0.578361).  Saving model ...
Epoch: 2 cost time: 1.4146184921264648
Epoch: 2, Steps: 17 | Train Loss: 1.386 Vali Loss: 0.869 Vali Acc: 0.873 Test Loss: 0.869 Test Acc: 0.873
Validation loss decreased (-0.578361 --> -0.872964).  Saving model ...
Epoch: 3 cost time: 1.6134605407714844
Epoch: 3, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.408 Vali Acc: 0.908 Test Loss: 0.408 Test Acc: 0.908
Validation loss decreased (-0.872964 --> -0.908104).  Saving model ...
Epoch: 4 cost time: 1.4895880222320557
Epoch: 4, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.249 Vali Acc: 0.924 Test Loss: 0.249 Test Acc: 0.924
Validation loss decreased (-0.908104 --> -0.924322).  Saving model ...
Epoch: 5 cost time: 2.1106531620025635
Epoch: 5, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.203 Vali Acc: 0.932 Test Loss: 0.203 Test Acc: 0.932
Validation loss decreased (-0.924322 --> -0.932430).  Saving model ...
Epoch: 6 cost time: 1.3598270416259766
Epoch: 6, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
Validation loss decreased (-0.932430 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.4110581874847412
Epoch: 7, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.547062873840332
Epoch: 8, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6847996711730957
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.154 Vali Acc: 0.941 Test Loss: 0.154 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6949615478515625
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5027644634246826
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.150 Vali Acc: 0.946 Test Loss: 0.150 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6299219131469727
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6260185241699219
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.624582052230835
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 1.2761130332946777
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.438347339630127
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3002965450286865
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3709993362426758
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6015188694000244
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5168547630310059
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4830682277679443
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.519263744354248
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.550041913986206
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.543764591217041
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 115081
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0784356594085693
Epoch: 1, Steps: 17 | Train Loss: 2.183 Vali Loss: 1.700 Vali Acc: 0.538 Test Loss: 1.700 Test Acc: 0.538
Validation loss decreased (inf --> -0.537821).  Saving model ...
Epoch: 2 cost time: 1.3205082416534424
Epoch: 2, Steps: 17 | Train Loss: 1.479 Vali Loss: 0.993 Vali Acc: 0.781 Test Loss: 0.993 Test Acc: 0.781
Validation loss decreased (-0.537821 --> -0.781071).  Saving model ...
Epoch: 3 cost time: 1.2398173809051514
Epoch: 3, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.483 Vali Acc: 0.886 Test Loss: 0.483 Test Acc: 0.886
Validation loss decreased (-0.781071 --> -0.886482).  Saving model ...
Epoch: 4 cost time: 1.2613084316253662
Epoch: 4, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.299 Vali Acc: 0.919 Test Loss: 0.299 Test Acc: 0.919
Validation loss decreased (-0.886482 --> -0.918916).  Saving model ...
Epoch: 5 cost time: 1.3538358211517334
Epoch: 5, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
Validation loss decreased (-0.918916 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.4207391738891602
Epoch: 6, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5220553874969482
Epoch: 7, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.194246768951416
Epoch: 8, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3564410209655762
Epoch: 9, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.579561471939087
Epoch: 10, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.3304147720336914
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3521413803100586
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5175895690917969
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 1.345919132232666
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3766345977783203
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4774487018585205
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5234107971191406
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4965684413909912
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5117342472076416
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3353323936462402
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4329404830932617
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4684500694274902
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6990463733673096
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 97865
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.878922939300537
Epoch: 1, Steps: 17 | Train Loss: 2.181 Vali Loss: 1.781 Vali Acc: 0.451 Test Loss: 1.781 Test Acc: 0.451
Validation loss decreased (inf --> -0.451334).  Saving model ...
Epoch: 2 cost time: 1.6905806064605713
Epoch: 2, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.060 Vali Acc: 0.776 Test Loss: 1.060 Test Acc: 0.776
Validation loss decreased (-0.451334 --> -0.775665).  Saving model ...
Epoch: 3 cost time: 1.5854709148406982
Epoch: 3, Steps: 17 | Train Loss: 0.861 Vali Loss: 0.555 Vali Acc: 0.878 Test Loss: 0.555 Test Acc: 0.878
Validation loss decreased (-0.775665 --> -0.878373).  Saving model ...
Epoch: 4 cost time: 1.6275248527526855
Epoch: 4, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.346 Vali Acc: 0.919 Test Loss: 0.346 Test Acc: 0.919
Validation loss decreased (-0.878373 --> -0.918915).  Saving model ...
Epoch: 5 cost time: 1.737222671508789
Epoch: 5, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.243 Vali Acc: 0.927 Test Loss: 0.243 Test Acc: 0.927
Validation loss decreased (-0.918915 --> -0.927025).  Saving model ...
Epoch: 6 cost time: 1.359818696975708
Epoch: 6, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
Validation loss decreased (-0.927025 --> -0.935133).  Saving model ...
Epoch: 7 cost time: 1.669304370880127
Epoch: 7, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 8 cost time: 1.8196966648101807
Epoch: 8, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 1.5313427448272705
Epoch: 9, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 10 cost time: 1.724660873413086
Epoch: 10, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6036922931671143
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5301446914672852
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 13 cost time: 1.6290438175201416
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5562715530395508
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 15 cost time: 1.8182671070098877
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8093278408050537
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 1.8317162990570068
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.777287244796753
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 1.705782413482666
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.703979730606079
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8639862537384033
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 1.7100389003753662
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6544828414916992
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5875835418701172
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7353646755218506
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6575326919555664
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6503803730010986
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7469229698181152
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.717440128326416
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.226745367050171
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.660127878189087
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 94441
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3916633129119873
Epoch: 1, Steps: 17 | Train Loss: 2.260 Vali Loss: 1.929 Vali Acc: 0.332 Test Loss: 1.929 Test Acc: 0.332
Validation loss decreased (inf --> -0.332413).  Saving model ...
Epoch: 2 cost time: 1.6214141845703125
Epoch: 2, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.243 Vali Acc: 0.797 Test Loss: 1.243 Test Acc: 0.797
Validation loss decreased (-0.332413 --> -0.797285).  Saving model ...
Epoch: 3 cost time: 1.3689754009246826
Epoch: 3, Steps: 17 | Train Loss: 1.053 Vali Loss: 0.711 Vali Acc: 0.876 Test Loss: 0.711 Test Acc: 0.876
Validation loss decreased (-0.797285 --> -0.875669).  Saving model ...
Epoch: 4 cost time: 1.7266757488250732
Epoch: 4, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.415 Vali Acc: 0.908 Test Loss: 0.415 Test Acc: 0.908
Validation loss decreased (-0.875669 --> -0.908104).  Saving model ...
Epoch: 5 cost time: 1.8216462135314941
Epoch: 5, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.285 Vali Acc: 0.932 Test Loss: 0.285 Test Acc: 0.932
Validation loss decreased (-0.908104 --> -0.932430).  Saving model ...
Epoch: 6 cost time: 1.5188369750976562
Epoch: 6, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3503196239471436
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
Validation loss decreased (-0.932430 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.347688913345337
Epoch: 8, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.185 Vali Acc: 0.938 Test Loss: 0.185 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4110651016235352
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 1.5661115646362305
Epoch: 10, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5071144104003906
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6974608898162842
Epoch: 12, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.458071231842041
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4907493591308594
Epoch: 14, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4672412872314453
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5511469841003418
Epoch: 16, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4642398357391357
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6009016036987305
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 19 cost time: 1.462594747543335
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5120258331298828
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 1.7303266525268555
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6591169834136963
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7594659328460693
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.505561113357544
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2995169162750244
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6706669330596924
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5179522037506104
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 1.3461925983428955
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5268244743347168
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.437239170074463
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3487656116485596
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4043335914611816
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4173781871795654
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.321314811706543
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5398685932159424
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.7023046016693115
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6144075393676758
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 87593
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.812185049057007
Epoch: 1, Steps: 17 | Train Loss: 2.041 Vali Loss: 1.343 Vali Acc: 0.657 Test Loss: 1.343 Test Acc: 0.657
Validation loss decreased (inf --> -0.656743).  Saving model ...
Epoch: 2 cost time: 2.7931668758392334
Epoch: 2, Steps: 17 | Train Loss: 0.895 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
Validation loss decreased (-0.656743 --> -0.870265).  Saving model ...
Epoch: 3 cost time: 3.1192235946655273
Epoch: 3, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.272 Vali Acc: 0.914 Test Loss: 0.272 Test Acc: 0.914
Validation loss decreased (-0.870265 --> -0.913511).  Saving model ...
Epoch: 4 cost time: 2.849566698074341
Epoch: 4, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
Validation loss decreased (-0.913511 --> -0.929728).  Saving model ...
Epoch: 5 cost time: 2.740388870239258
Epoch: 5, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.181 Vali Acc: 0.935 Test Loss: 0.181 Test Acc: 0.935
Validation loss decreased (-0.929728 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 2.969487428665161
Epoch: 6, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.254 Vali Acc: 0.914 Test Loss: 0.254 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9138143062591553
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.176 Vali Acc: 0.938 Test Loss: 0.176 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 8 cost time: 3.035212755203247
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 2.7742693424224854
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 2.61600923538208
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.638427495956421
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.733764410018921
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0018630027770996
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 2.751758098602295
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 2.7380716800689697
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 2.6744327545166016
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 2.7124075889587402
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8861303329467773
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7097039222717285
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8756160736083984
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.6525650024414062
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.0800914764404297
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.294126033782959
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.467057466506958
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.143772602081299
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.2892792224884033
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 138473
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3635990619659424
Epoch: 1, Steps: 17 | Train Loss: 2.166 Vali Loss: 1.755 Vali Acc: 0.497 Test Loss: 1.755 Test Acc: 0.497
Validation loss decreased (inf --> -0.497280).  Saving model ...
Epoch: 2 cost time: 1.642533779144287
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 0.933 Vali Acc: 0.838 Test Loss: 0.933 Test Acc: 0.838
Validation loss decreased (-0.497280 --> -0.837829).  Saving model ...
Epoch: 3 cost time: 1.5107886791229248
Epoch: 3, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.442 Vali Acc: 0.903 Test Loss: 0.442 Test Acc: 0.903
Validation loss decreased (-0.837829 --> -0.902698).  Saving model ...
Epoch: 4 cost time: 1.5396976470947266
Epoch: 4, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
Validation loss decreased (-0.902698 --> -0.921619).  Saving model ...
Epoch: 5 cost time: 1.484757423400879
Epoch: 5, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.203 Vali Acc: 0.938 Test Loss: 0.203 Test Acc: 0.938
Validation loss decreased (-0.921619 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 1.603041410446167
Epoch: 6, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.6644678115844727
Epoch: 7, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.6917946338653564
Epoch: 8, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.179 Vali Acc: 0.932 Test Loss: 0.179 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6753425598144531
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 1.389282464981079
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.461242437362671
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.176 Vali Acc: 0.932 Test Loss: 0.176 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5349376201629639
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3722457885742188
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4930944442749023
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.943 Test Loss: 0.154 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4177329540252686
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.428356409072876
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.375152826309204
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5648579597473145
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4001984596252441
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 90121
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1606123447418213
Epoch: 1, Steps: 17 | Train Loss: 2.246 Vali Loss: 1.895 Vali Acc: 0.359 Test Loss: 1.895 Test Acc: 0.359
Validation loss decreased (inf --> -0.359441).  Saving model ...
Epoch: 2 cost time: 1.4432756900787354
Epoch: 2, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.065 Vali Acc: 0.805 Test Loss: 1.065 Test Acc: 0.805
Validation loss decreased (-0.359441 --> -0.805395).  Saving model ...
Epoch: 3 cost time: 1.4473083019256592
Epoch: 3, Steps: 17 | Train Loss: 0.832 Vali Loss: 0.550 Vali Acc: 0.919 Test Loss: 0.550 Test Acc: 0.919
Validation loss decreased (-0.805395 --> -0.918913).  Saving model ...
Epoch: 4 cost time: 1.4828460216522217
Epoch: 4, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.324 Vali Acc: 0.932 Test Loss: 0.324 Test Acc: 0.932
Validation loss decreased (-0.918913 --> -0.932429).  Saving model ...
Epoch: 5 cost time: 1.5676429271697998
Epoch: 5, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 1.43229079246521
Epoch: 6, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.207 Vali Acc: 0.938 Test Loss: 0.207 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 7 cost time: 1.3581116199493408
Epoch: 7, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 8 cost time: 1.5377857685089111
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.3884785175323486
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 1.3331637382507324
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3175010681152344
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4474635124206543
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.30438232421875
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3672688007354736
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3671090602874756
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2623569965362549
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3624253273010254
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4829554557800293
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4560058116912842
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 72905
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.263784170150757
Epoch: 1, Steps: 17 | Train Loss: 2.185 Vali Loss: 1.833 Vali Acc: 0.435 Test Loss: 1.833 Test Acc: 0.435
Validation loss decreased (inf --> -0.435117).  Saving model ...
Epoch: 2 cost time: 1.4662952423095703
Epoch: 2, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.146 Vali Acc: 0.773 Test Loss: 1.146 Test Acc: 0.773
Validation loss decreased (-0.435117 --> -0.772962).  Saving model ...
Epoch: 3 cost time: 1.4655673503875732
Epoch: 3, Steps: 17 | Train Loss: 0.976 Vali Loss: 0.638 Vali Acc: 0.862 Test Loss: 0.638 Test Acc: 0.862
Validation loss decreased (-0.772962 --> -0.862156).  Saving model ...
Epoch: 4 cost time: 1.3505094051361084
Epoch: 4, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.398 Vali Acc: 0.905 Test Loss: 0.398 Test Acc: 0.905
Validation loss decreased (-0.862156 --> -0.905401).  Saving model ...
Epoch: 5 cost time: 1.3880221843719482
Epoch: 5, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.266 Vali Acc: 0.927 Test Loss: 0.266 Test Acc: 0.927
Validation loss decreased (-0.905401 --> -0.927024).  Saving model ...
Epoch: 6 cost time: 1.3208305835723877
Epoch: 6, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
Validation loss decreased (-0.927024 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.4430789947509766
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5757856369018555
Epoch: 8, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5506324768066406
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 1.4823417663574219
Epoch: 10, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4983398914337158
Epoch: 11, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.4520728588104248
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.935 Test Loss: 0.163 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4242684841156006
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.394986867904663
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.350337028503418
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.366058588027954
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.524505376815796
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4288005828857422
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3980085849761963
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4669182300567627
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.941 Test Loss: 0.156 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2533481121063232
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 22 cost time: 1.115762710571289
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3674778938293457
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.396019458770752
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 25 cost time: 1.5716805458068848
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 1.417360544204712
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.55409836769104
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6230783462524414
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4420819282531738
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5359878540039062
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6235318183898926
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.562413215637207
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.6774723529815674
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4162445068359375
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3837058544158936
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 69481
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4377095699310303
Epoch: 1, Steps: 17 | Train Loss: 2.118 Vali Loss: 1.765 Vali Acc: 0.486 Test Loss: 1.765 Test Acc: 0.486
Validation loss decreased (inf --> -0.486469).  Saving model ...
Epoch: 2 cost time: 1.5251388549804688
Epoch: 2, Steps: 17 | Train Loss: 1.592 Vali Loss: 1.182 Vali Acc: 0.784 Test Loss: 1.182 Test Acc: 0.784
Validation loss decreased (-0.486469 --> -0.783772).  Saving model ...
Epoch: 3 cost time: 1.560572862625122
Epoch: 3, Steps: 17 | Train Loss: 1.050 Vali Loss: 0.712 Vali Acc: 0.870 Test Loss: 0.712 Test Acc: 0.870
Validation loss decreased (-0.783772 --> -0.870263).  Saving model ...
Epoch: 4 cost time: 1.7546563148498535
Epoch: 4, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.422 Vali Acc: 0.908 Test Loss: 0.422 Test Acc: 0.908
Validation loss decreased (-0.870263 --> -0.908104).  Saving model ...
Epoch: 5 cost time: 1.778895616531372
Epoch: 5, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
Validation loss decreased (-0.908104 --> -0.921619).  Saving model ...
Epoch: 6 cost time: 1.585247278213501
Epoch: 6, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
Validation loss decreased (-0.921619 --> -0.935133).  Saving model ...
Epoch: 7 cost time: 1.6084740161895752
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.6520719528198242
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.405824899673462
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 1.5276944637298584
Epoch: 10, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6714506149291992
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5058109760284424
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4413859844207764
Epoch: 13, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.514634370803833
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7375831604003906
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7753968238830566
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.787862777709961
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6015841960906982
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6009068489074707
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 1.6892504692077637
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6821610927581787
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9083082675933838
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7259931564331055
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6294903755187988
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6016738414764404
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3768653869628906
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3133690357208252
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6236424446105957
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3736286163330078
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 62633
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.6331257820129395
Epoch: 1, Steps: 17 | Train Loss: 1.954 Vali Loss: 1.344 Vali Acc: 0.768 Test Loss: 1.344 Test Acc: 0.768
Validation loss decreased (inf --> -0.767554).  Saving model ...
Epoch: 2 cost time: 2.9576051235198975
Epoch: 2, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.476 Vali Acc: 0.905 Test Loss: 0.476 Test Acc: 0.905
Validation loss decreased (-0.767554 --> -0.905401).  Saving model ...
Epoch: 3 cost time: 2.9879419803619385
Epoch: 3, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.269 Vali Acc: 0.924 Test Loss: 0.269 Test Acc: 0.924
Validation loss decreased (-0.905401 --> -0.924322).  Saving model ...
Epoch: 4 cost time: 2.9056248664855957
Epoch: 4, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
Validation loss decreased (-0.924322 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 2.1648688316345215
Epoch: 5, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.192 Vali Acc: 0.932 Test Loss: 0.192 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.269761562347412
Epoch: 6, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.3909728527069092
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3338778018951416
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7057840824127197
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 10 cost time: 3.0242700576782227
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0503175258636475
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.063629150390625
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1675453186035156
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8485231399536133
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2818214893341064
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.693110942840576
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.7567436695098877
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7318949699401855
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3531858921051025
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 125993
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2733633518218994
Epoch: 1, Steps: 17 | Train Loss: 2.155 Vali Loss: 1.697 Vali Acc: 0.543 Test Loss: 1.697 Test Acc: 0.543
Validation loss decreased (inf --> -0.543226).  Saving model ...
Epoch: 2 cost time: 1.5524890422821045
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 0.952 Vali Acc: 0.841 Test Loss: 0.952 Test Acc: 0.841
Validation loss decreased (-0.543226 --> -0.840531).  Saving model ...
Epoch: 3 cost time: 1.642732858657837
Epoch: 3, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.488 Vali Acc: 0.903 Test Loss: 0.488 Test Acc: 0.903
Validation loss decreased (-0.840531 --> -0.902698).  Saving model ...
Epoch: 4 cost time: 1.5713582038879395
Epoch: 4, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.293 Vali Acc: 0.927 Test Loss: 0.293 Test Acc: 0.927
Validation loss decreased (-0.902698 --> -0.927024).  Saving model ...
Epoch: 5 cost time: 1.550783395767212
Epoch: 5, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.927024 --> -0.940538).  Saving model ...
Epoch: 6 cost time: 1.7723009586334229
Epoch: 6, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.567472219467163
Epoch: 7, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
Validation loss decreased (-0.940538 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 1.6557490825653076
Epoch: 8, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5896506309509277
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 1.611985206604004
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5877735614776611
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6297037601470947
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.664184808731079
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6890535354614258
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7835578918457031
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6524946689605713
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.43681001663208
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4832773208618164
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5243895053863525
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 77641
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.212556838989258
Epoch: 1, Steps: 17 | Train Loss: 2.046 Vali Loss: 1.708 Vali Acc: 0.468 Test Loss: 1.708 Test Acc: 0.468
Validation loss decreased (inf --> -0.467550).  Saving model ...
Epoch: 2 cost time: 1.3341758251190186
Epoch: 2, Steps: 17 | Train Loss: 1.355 Vali Loss: 0.951 Vali Acc: 0.816 Test Loss: 0.951 Test Acc: 0.816
Validation loss decreased (-0.467550 --> -0.816207).  Saving model ...
Epoch: 3 cost time: 1.4799892902374268
Epoch: 3, Steps: 17 | Train Loss: 0.744 Vali Loss: 0.477 Vali Acc: 0.905 Test Loss: 0.477 Test Acc: 0.905
Validation loss decreased (-0.816207 --> -0.905401).  Saving model ...
Epoch: 4 cost time: 1.576704502105713
Epoch: 4, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
Validation loss decreased (-0.905401 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 1.6070115566253662
Epoch: 5, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 6 cost time: 1.5343961715698242
Epoch: 6, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.5397021770477295
Epoch: 7, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.332249641418457
Epoch: 8, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.3404498100280762
Epoch: 9, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 1.4756858348846436
Epoch: 10, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 1.5748631954193115
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6528387069702148
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 13 cost time: 1.720085620880127
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 1.6340718269348145
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5868065357208252
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4924187660217285
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6553781032562256
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4225704669952393
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.324021339416504
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3753623962402344
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.248511791229248
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 1.820319414138794
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9259169101715088
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7644262313842773
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.705153226852417
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8872056007385254
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8938610553741455
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6737372875213623
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7348833084106445
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.726872205734253
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.7491703033447266
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 60425
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8709664344787598
Epoch: 1, Steps: 17 | Train Loss: 2.371 Vali Loss: 1.910 Vali Acc: 0.378 Test Loss: 1.910 Test Acc: 0.378
Validation loss decreased (inf --> -0.378359).  Saving model ...
Epoch: 2 cost time: 1.8119311332702637
Epoch: 2, Steps: 17 | Train Loss: 1.673 Vali Loss: 1.181 Vali Acc: 0.805 Test Loss: 1.181 Test Acc: 0.805
Validation loss decreased (-0.378359 --> -0.805394).  Saving model ...
Epoch: 3 cost time: 1.5775961875915527
Epoch: 3, Steps: 17 | Train Loss: 0.983 Vali Loss: 0.652 Vali Acc: 0.859 Test Loss: 0.652 Test Acc: 0.859
Validation loss decreased (-0.805394 --> -0.859453).  Saving model ...
Epoch: 4 cost time: 1.5327205657958984
Epoch: 4, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.395 Vali Acc: 0.905 Test Loss: 0.395 Test Acc: 0.905
Validation loss decreased (-0.859453 --> -0.905401).  Saving model ...
Epoch: 5 cost time: 1.4511616230010986
Epoch: 5, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
Validation loss decreased (-0.905401 --> -0.929727).  Saving model ...
Epoch: 6 cost time: 1.6024720668792725
Epoch: 6, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.222 Vali Acc: 0.927 Test Loss: 0.222 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5742206573486328
Epoch: 7, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
Validation loss decreased (-0.929727 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.5185492038726807
Epoch: 8, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8685343265533447
Epoch: 9, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8659026622772217
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6345067024230957
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4992623329162598
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.169 Vali Acc: 0.935 Test Loss: 0.169 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.463270902633667
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 1.5235967636108398
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6567134857177734
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6975493431091309
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.762768268585205
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 18 cost time: 1.625126600265503
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.845879077911377
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7500414848327637
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6081116199493408
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.620544672012329
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.425955057144165
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.511565923690796
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4894754886627197
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5415120124816895
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5781359672546387
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 57001
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.755500555038452
Epoch: 1, Steps: 17 | Train Loss: 2.312 Vali Loss: 2.040 Vali Acc: 0.281 Test Loss: 2.040 Test Acc: 0.281
Validation loss decreased (inf --> -0.281061).  Saving model ...
Epoch: 2 cost time: 1.5139555931091309
Epoch: 2, Steps: 17 | Train Loss: 1.807 Vali Loss: 1.413 Vali Acc: 0.689 Test Loss: 1.413 Test Acc: 0.689
Validation loss decreased (-0.281061 --> -0.689175).  Saving model ...
Epoch: 3 cost time: 1.57747483253479
Epoch: 3, Steps: 17 | Train Loss: 1.233 Vali Loss: 0.861 Vali Acc: 0.830 Test Loss: 0.861 Test Acc: 0.830
Validation loss decreased (-0.689175 --> -0.829721).  Saving model ...
Epoch: 4 cost time: 1.6316773891448975
Epoch: 4, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.502 Vali Acc: 0.895 Test Loss: 0.502 Test Acc: 0.895
Validation loss decreased (-0.829721 --> -0.894590).  Saving model ...
Epoch: 5 cost time: 1.5766732692718506
Epoch: 5, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.326 Vali Acc: 0.919 Test Loss: 0.326 Test Acc: 0.919
Validation loss decreased (-0.894590 --> -0.918916).  Saving model ...
Epoch: 6 cost time: 1.5798652172088623
Epoch: 6, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.236 Vali Acc: 0.951 Test Loss: 0.236 Test Acc: 0.951
Validation loss decreased (-0.918916 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 1.6149671077728271
Epoch: 7, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4437377452850342
Epoch: 8, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 1.4775707721710205
Epoch: 9, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 1.6124451160430908
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 1.3107802867889404
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.6495885848999023
Epoch: 12, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.7081632614135742
Epoch: 13, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5487806797027588
Epoch: 14, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6478452682495117
Epoch: 15, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.572357416152954
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5743608474731445
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5676536560058594
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.584831714630127
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4979181289672852
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5089447498321533
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4902980327606201
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 50153
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.390819787979126
Epoch: 1, Steps: 17 | Train Loss: 2.332 Vali Loss: 1.878 Vali Acc: 0.432 Test Loss: 1.878 Test Acc: 0.432
Validation loss decreased (inf --> -0.432414).  Saving model ...
Epoch: 2 cost time: 1.5969817638397217
Epoch: 2, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.006 Vali Acc: 0.857 Test Loss: 1.006 Test Acc: 0.857
Validation loss decreased (-0.432414 --> -0.856747).  Saving model ...
Epoch: 3 cost time: 1.537820816040039
Epoch: 3, Steps: 17 | Train Loss: 0.761 Vali Loss: 0.510 Vali Acc: 0.889 Test Loss: 0.510 Test Acc: 0.889
Validation loss decreased (-0.856747 --> -0.889184).  Saving model ...
Epoch: 4 cost time: 1.3867075443267822
Epoch: 4, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.297 Vali Acc: 0.916 Test Loss: 0.297 Test Acc: 0.916
Validation loss decreased (-0.889184 --> -0.916213).  Saving model ...
Epoch: 5 cost time: 1.552044153213501
Epoch: 5, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
Validation loss decreased (-0.916213 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.6188836097717285
Epoch: 6, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5722904205322266
Epoch: 7, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.5701677799224854
Epoch: 8, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.432218313217163
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.443535566329956
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4070100784301758
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 1.397643804550171
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.543363094329834
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 1.6309003829956055
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5309815406799316
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5243492126464844
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6261670589447021
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5430405139923096
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7091140747070312
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5333023071289062
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 1.643301010131836
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5908138751983643
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3934001922607422
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3971567153930664
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4436769485473633
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.340186595916748
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.503671407699585
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5219638347625732
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5169878005981445
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5482017993927002
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 79033
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.136820077896118
Epoch: 1, Steps: 17 | Train Loss: 2.286 Vali Loss: 2.054 Vali Acc: 0.230 Test Loss: 2.054 Test Acc: 0.230
Validation loss decreased (inf --> -0.229709).  Saving model ...
Epoch: 2 cost time: 1.5389070510864258
Epoch: 2, Steps: 17 | Train Loss: 1.770 Vali Loss: 1.395 Vali Acc: 0.686 Test Loss: 1.395 Test Acc: 0.686
Validation loss decreased (-0.229709 --> -0.686473).  Saving model ...
Epoch: 3 cost time: 1.519228219985962
Epoch: 3, Steps: 17 | Train Loss: 1.115 Vali Loss: 0.774 Vali Acc: 0.859 Test Loss: 0.774 Test Acc: 0.859
Validation loss decreased (-0.686473 --> -0.859452).  Saving model ...
Epoch: 4 cost time: 1.4245142936706543
Epoch: 4, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.422 Vali Acc: 0.911 Test Loss: 0.422 Test Acc: 0.911
Validation loss decreased (-0.859452 --> -0.910807).  Saving model ...
Epoch: 5 cost time: 1.3548474311828613
Epoch: 5, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.294 Vali Acc: 0.935 Test Loss: 0.294 Test Acc: 0.935
Validation loss decreased (-0.910807 --> -0.935132).  Saving model ...
Epoch: 6 cost time: 1.3787693977355957
Epoch: 6, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.233 Vali Acc: 0.927 Test Loss: 0.233 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5955157279968262
Epoch: 7, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940539).  Saving model ...
Epoch: 8 cost time: 1.5591535568237305
Epoch: 8, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 9 cost time: 1.6747403144836426
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 1.7172000408172607
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.7078475952148438
Epoch: 11, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6940722465515137
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6755995750427246
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7683310508728027
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 15 cost time: 1.6062986850738525
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.606990098953247
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7508721351623535
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6711070537567139
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 19 cost time: 1.6525943279266357
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5772695541381836
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6689825057983398
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 22 cost time: 1.5069780349731445
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7851576805114746
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7987337112426758
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7025706768035889
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 1.8391227722167969
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.570537805557251
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8267433643341064
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.827204942703247
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4852843284606934
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.724128007888794
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6176159381866455
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5594918727874756
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 34 cost time: 1.6292035579681396
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4570622444152832
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.555607557296753
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6756255626678467
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.5770764350891113
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.5852463245391846
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.6612508296966553
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.6536166667938232
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.565889596939087
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.682840347290039
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 54857
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0169925689697266
Epoch: 1, Steps: 17 | Train Loss: 2.247 Vali Loss: 2.012 Vali Acc: 0.219 Test Loss: 2.012 Test Acc: 0.219
Validation loss decreased (inf --> -0.218899).  Saving model ...
Epoch: 2 cost time: 1.4211828708648682
Epoch: 2, Steps: 17 | Train Loss: 1.868 Vali Loss: 1.527 Vali Acc: 0.592 Test Loss: 1.527 Test Acc: 0.592
Validation loss decreased (-0.218899 --> -0.591877).  Saving model ...
Epoch: 3 cost time: 1.2692272663116455
Epoch: 3, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.027 Vali Acc: 0.800 Test Loss: 1.027 Test Acc: 0.800
Validation loss decreased (-0.591877 --> -0.799990).  Saving model ...
Epoch: 4 cost time: 1.4436678886413574
Epoch: 4, Steps: 17 | Train Loss: 0.869 Vali Loss: 0.637 Vali Acc: 0.881 Test Loss: 0.637 Test Acc: 0.881
Validation loss decreased (-0.799990 --> -0.881075).  Saving model ...
Epoch: 5 cost time: 1.4575893878936768
Epoch: 5, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.414 Vali Acc: 0.908 Test Loss: 0.414 Test Acc: 0.908
Validation loss decreased (-0.881075 --> -0.908104).  Saving model ...
Epoch: 6 cost time: 1.558166265487671
Epoch: 6, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.309 Vali Acc: 0.924 Test Loss: 0.309 Test Acc: 0.924
Validation loss decreased (-0.908104 --> -0.924321).  Saving model ...
Epoch: 7 cost time: 1.5307204723358154
Epoch: 7, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.252 Vali Acc: 0.935 Test Loss: 0.252 Test Acc: 0.935
Validation loss decreased (-0.924321 --> -0.935133).  Saving model ...
Epoch: 8 cost time: 1.440293788909912
Epoch: 8, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.229 Vali Acc: 0.938 Test Loss: 0.229 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 9 cost time: 1.4769375324249268
Epoch: 9, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.207 Vali Acc: 0.943 Test Loss: 0.207 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 1.4213752746582031
Epoch: 10, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 1.5298895835876465
Epoch: 11, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8050000667572021
Epoch: 12, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8459162712097168
Epoch: 13, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6027858257293701
Epoch: 14, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.745805263519287
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 16 cost time: 1.7176761627197266
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 17 cost time: 1.6827459335327148
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.658290147781372
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6611957550048828
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 20 cost time: 1.5895848274230957
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 21 cost time: 1.6399180889129639
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7910561561584473
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6411981582641602
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.817401647567749
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6130597591400146
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7738192081451416
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 27 cost time: 1.706688642501831
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8020167350769043
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6561810970306396
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7255363464355469
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.697782278060913
Epoch: 31, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6776533126831055
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6442577838897705
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 34 cost time: 1.7031292915344238
Epoch: 34, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.422520399093628
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4938621520996094
Epoch: 36, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5459239482879639
Epoch: 37, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4574995040893555
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.7625641822814941
Epoch: 39, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.5639586448669434
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.640815019607544
Epoch: 41, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.6548054218292236
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.6867244243621826
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 46249
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.302868127822876
Epoch: 1, Steps: 17 | Train Loss: 2.298 Vali Loss: 2.111 Vali Acc: 0.197 Test Loss: 2.111 Test Acc: 0.197
Validation loss decreased (inf --> -0.197276).  Saving model ...
Epoch: 2 cost time: 1.6865260601043701
Epoch: 2, Steps: 17 | Train Loss: 1.920 Vali Loss: 1.655 Vali Acc: 0.614 Test Loss: 1.655 Test Acc: 0.614
Validation loss decreased (-0.197276 --> -0.613497).  Saving model ...
Epoch: 3 cost time: 1.6528756618499756
Epoch: 3, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.148 Vali Acc: 0.784 Test Loss: 1.148 Test Acc: 0.784
Validation loss decreased (-0.613497 --> -0.783772).  Saving model ...
Epoch: 4 cost time: 1.5957527160644531
Epoch: 4, Steps: 17 | Train Loss: 0.993 Vali Loss: 0.744 Vali Acc: 0.843 Test Loss: 0.744 Test Acc: 0.843
Validation loss decreased (-0.783772 --> -0.843236).  Saving model ...
Epoch: 5 cost time: 1.604943037033081
Epoch: 5, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.492 Vali Acc: 0.892 Test Loss: 0.492 Test Acc: 0.892
Validation loss decreased (-0.843236 --> -0.891887).  Saving model ...
Epoch: 6 cost time: 1.5165023803710938
Epoch: 6, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.357 Vali Acc: 0.914 Test Loss: 0.357 Test Acc: 0.914
Validation loss decreased (-0.891887 --> -0.913510).  Saving model ...
Epoch: 7 cost time: 1.646346092224121
Epoch: 7, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.295 Vali Acc: 0.922 Test Loss: 0.295 Test Acc: 0.922
Validation loss decreased (-0.913510 --> -0.921619).  Saving model ...
Epoch: 8 cost time: 1.5724444389343262
Epoch: 8, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929727).  Saving model ...
Epoch: 9 cost time: 1.5851926803588867
Epoch: 9, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.221 Vali Acc: 0.938 Test Loss: 0.221 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937836).  Saving model ...
Epoch: 10 cost time: 1.7108609676361084
Epoch: 10, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.212 Vali Acc: 0.932 Test Loss: 0.212 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.601184368133545
Epoch: 11, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6696946620941162
Epoch: 12, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 13 cost time: 1.6251533031463623
Epoch: 13, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.708902359008789
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 15 cost time: 1.6046350002288818
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 16 cost time: 1.7091503143310547
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.177 Vali Acc: 0.938 Test Loss: 0.177 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6109340190887451
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 18 cost time: 1.7580907344818115
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 19 cost time: 1.6990258693695068
Epoch: 19, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.577810287475586
Epoch: 20, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 21 cost time: 1.5252125263214111
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3386096954345703
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 23 cost time: 1.5352509021759033
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 24 cost time: 1.5933797359466553
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6993873119354248
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6127090454101562
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 27 cost time: 1.7256934642791748
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8466668128967285
Epoch: 28, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8173191547393799
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6010277271270752
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7529895305633545
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8124277591705322
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6453566551208496
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6799652576446533
Epoch: 34, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4696474075317383
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5828404426574707
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 44537
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.620833158493042
Epoch: 1, Steps: 17 | Train Loss: 2.351 Vali Loss: 2.205 Vali Acc: 0.149 Test Loss: 2.205 Test Acc: 0.149
Validation loss decreased (inf --> -0.148627).  Saving model ...
Epoch: 2 cost time: 1.3947181701660156
Epoch: 2, Steps: 17 | Train Loss: 2.014 Vali Loss: 1.759 Vali Acc: 0.495 Test Loss: 1.759 Test Acc: 0.495
Validation loss decreased (-0.148627 --> -0.494577).  Saving model ...
Epoch: 3 cost time: 1.8525457382202148
Epoch: 3, Steps: 17 | Train Loss: 1.643 Vali Loss: 1.289 Vali Acc: 0.778 Test Loss: 1.289 Test Acc: 0.778
Validation loss decreased (-0.494577 --> -0.778365).  Saving model ...
Epoch: 4 cost time: 1.662921667098999
Epoch: 4, Steps: 17 | Train Loss: 1.161 Vali Loss: 0.859 Vali Acc: 0.854 Test Loss: 0.859 Test Acc: 0.854
Validation loss decreased (-0.778365 --> -0.854045).  Saving model ...
Epoch: 5 cost time: 1.5761878490447998
Epoch: 5, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.573 Vali Acc: 0.905 Test Loss: 0.573 Test Acc: 0.905
Validation loss decreased (-0.854045 --> -0.905400).  Saving model ...
Epoch: 6 cost time: 1.9020535945892334
Epoch: 6, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.407 Vali Acc: 0.927 Test Loss: 0.407 Test Acc: 0.927
Validation loss decreased (-0.905400 --> -0.927023).  Saving model ...
Epoch: 7 cost time: 1.7446179389953613
Epoch: 7, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.321 Vali Acc: 0.932 Test Loss: 0.321 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 8 cost time: 1.850393295288086
Epoch: 8, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9490180015563965
Epoch: 9, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935133).  Saving model ...
Epoch: 10 cost time: 1.709134817123413
Epoch: 10, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 11 cost time: 1.924401044845581
Epoch: 11, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940538).  Saving model ...
Epoch: 12 cost time: 1.6856861114501953
Epoch: 12, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 13 cost time: 1.8753440380096436
Epoch: 13, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 14 cost time: 1.7954542636871338
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.799588680267334
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8632092475891113
Epoch: 16, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 17 cost time: 1.8546535968780518
Epoch: 17, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 18 cost time: 1.6390843391418457
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.727048397064209
Epoch: 19, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 20 cost time: 1.9367828369140625
Epoch: 20, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6185834407806396
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 22 cost time: 1.5818874835968018
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6366913318634033
Epoch: 23, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 1.389824390411377
Epoch: 24, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7300031185150146
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.520522117614746
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5754361152648926
Epoch: 27, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5978362560272217
Epoch: 28, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8353500366210938
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9047629833221436
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7209651470184326
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7730000019073486
Epoch: 32, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.740894079208374
Epoch: 33, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 34 cost time: 1.8093032836914062
Epoch: 34, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7371625900268555
Epoch: 35, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6706066131591797
Epoch: 36, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7887394428253174
Epoch: 37, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6533186435699463
Epoch: 38, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.8564906120300293
Epoch: 39, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.8050053119659424
Epoch: 40, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 41 cost time: 1.774843692779541
Epoch: 41, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6421175003051758
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5622613430023193
Epoch: 43, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.572803258895874
Epoch: 44, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.7940890789031982
Epoch: 45, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.7978971004486084
Epoch: 46, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.9986779689788818
Epoch: 47, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.7644321918487549
Epoch: 48, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.8120570182800293
Epoch: 49, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.9406626224517822
Epoch: 50, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 41113
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2091729640960693
Epoch: 1, Steps: 17 | Train Loss: 2.183 Vali Loss: 1.796 Vali Acc: 0.551 Test Loss: 1.796 Test Acc: 0.551
Validation loss decreased (inf --> -0.551333).  Saving model ...
Epoch: 2 cost time: 1.7361962795257568
Epoch: 2, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.063 Vali Acc: 0.822 Test Loss: 1.063 Test Acc: 0.822
Validation loss decreased (-0.551333 --> -0.821611).  Saving model ...
Epoch: 3 cost time: 1.3808817863464355
Epoch: 3, Steps: 17 | Train Loss: 0.812 Vali Loss: 0.560 Vali Acc: 0.870 Test Loss: 0.560 Test Acc: 0.870
Validation loss decreased (-0.821611 --> -0.870265).  Saving model ...
Epoch: 4 cost time: 1.567833662033081
Epoch: 4, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (-0.870265 --> -0.902699).  Saving model ...
Epoch: 5 cost time: 1.5872251987457275
Epoch: 5, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.243 Vali Acc: 0.938 Test Loss: 0.243 Test Acc: 0.938
Validation loss decreased (-0.902699 --> -0.937835).  Saving model ...
Epoch: 6 cost time: 1.56899094581604
Epoch: 6, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.197 Vali Acc: 0.938 Test Loss: 0.197 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 7 cost time: 1.5802090167999268
Epoch: 7, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.6584463119506836
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6328847408294678
Epoch: 9, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.644547462463379
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.7507481575012207
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6420984268188477
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 1.711843490600586
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6802496910095215
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6446340084075928
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8649485111236572
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7752113342285156
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8726482391357422
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.847550630569458
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.555274486541748
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7611901760101318
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.710564136505127
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 66361
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5245957374572754
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 1.920 Vali Acc: 0.332 Test Loss: 1.920 Test Acc: 0.332
Validation loss decreased (inf --> -0.332413).  Saving model ...
Epoch: 2 cost time: 1.6649723052978516
Epoch: 2, Steps: 17 | Train Loss: 1.752 Vali Loss: 1.386 Vali Acc: 0.705 Test Loss: 1.386 Test Acc: 0.705
Validation loss decreased (-0.332413 --> -0.705392).  Saving model ...
Epoch: 3 cost time: 1.6687183380126953
Epoch: 3, Steps: 17 | Train Loss: 1.186 Vali Loss: 0.850 Vali Acc: 0.865 Test Loss: 0.850 Test Acc: 0.865
Validation loss decreased (-0.705392 --> -0.864856).  Saving model ...
Epoch: 4 cost time: 1.8765981197357178
Epoch: 4, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.507 Vali Acc: 0.895 Test Loss: 0.507 Test Acc: 0.895
Validation loss decreased (-0.864856 --> -0.894590).  Saving model ...
Epoch: 5 cost time: 1.8181226253509521
Epoch: 5, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.324 Vali Acc: 0.927 Test Loss: 0.324 Test Acc: 0.927
Validation loss decreased (-0.894590 --> -0.927024).  Saving model ...
Epoch: 6 cost time: 1.6289441585540771
Epoch: 6, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.254 Vali Acc: 0.927 Test Loss: 0.254 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 7 cost time: 1.6858904361724854
Epoch: 7, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.212 Vali Acc: 0.943 Test Loss: 0.212 Test Acc: 0.943
Validation loss decreased (-0.927024 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.5303356647491455
Epoch: 8, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7053158283233643
Epoch: 9, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 1.689988613128662
Epoch: 10, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5283262729644775
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5292670726776123
Epoch: 12, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7092788219451904
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 1.5285735130310059
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7365045547485352
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.6842784881591797
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8475518226623535
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7359023094177246
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7897698879241943
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6442952156066895
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6732885837554932
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6455225944519043
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.632948637008667
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 1.788771390914917
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 25 cost time: 1.5722064971923828
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5811450481414795
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6034908294677734
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.446091651916504
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.653770923614502
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4421539306640625
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.733900785446167
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 32 cost time: 1.717047929763794
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 33 cost time: 1.652374267578125
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.586641788482666
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5533723831176758
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5290226936340332
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5964808464050293
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.6112630367279053
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.627790927886963
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6781225204467773
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.6295347213745117
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.5823328495025635
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 42185
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.427884817123413
Epoch: 1, Steps: 17 | Train Loss: 2.245 Vali Loss: 2.048 Vali Acc: 0.203 Test Loss: 2.048 Test Acc: 0.203
Validation loss decreased (inf --> -0.202682).  Saving model ...
Epoch: 2 cost time: 1.6844184398651123
Epoch: 2, Steps: 17 | Train Loss: 1.835 Vali Loss: 1.545 Vali Acc: 0.614 Test Loss: 1.545 Test Acc: 0.614
Validation loss decreased (-0.202682 --> -0.613498).  Saving model ...
Epoch: 3 cost time: 1.4741144180297852
Epoch: 3, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.045 Vali Acc: 0.789 Test Loss: 1.045 Test Acc: 0.789
Validation loss decreased (-0.613498 --> -0.789179).  Saving model ...
Epoch: 4 cost time: 1.563539743423462
Epoch: 4, Steps: 17 | Train Loss: 0.890 Vali Loss: 0.667 Vali Acc: 0.878 Test Loss: 0.667 Test Acc: 0.878
Validation loss decreased (-0.789179 --> -0.878372).  Saving model ...
Epoch: 5 cost time: 1.7835571765899658
Epoch: 5, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.431 Vali Acc: 0.908 Test Loss: 0.431 Test Acc: 0.908
Validation loss decreased (-0.878372 --> -0.908104).  Saving model ...
Epoch: 6 cost time: 1.900846004486084
Epoch: 6, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.334 Vali Acc: 0.922 Test Loss: 0.334 Test Acc: 0.922
Validation loss decreased (-0.908104 --> -0.921618).  Saving model ...
Epoch: 7 cost time: 1.7160449028015137
Epoch: 7, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.266 Vali Acc: 0.932 Test Loss: 0.266 Test Acc: 0.932
Validation loss decreased (-0.921618 --> -0.932430).  Saving model ...
Epoch: 8 cost time: 1.7527196407318115
Epoch: 8, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 9 cost time: 1.7669873237609863
Epoch: 9, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 1.5161056518554688
Epoch: 10, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.200 Vali Acc: 0.932 Test Loss: 0.200 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.798706293106079
Epoch: 11, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 12 cost time: 1.9193236827850342
Epoch: 12, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 13 cost time: 1.7292251586914062
Epoch: 13, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7497360706329346
Epoch: 14, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 15 cost time: 1.8152282238006592
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 16 cost time: 1.9074862003326416
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8757805824279785
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.772822380065918
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 19 cost time: 1.956878900527954
Epoch: 19, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8446505069732666
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7134885787963867
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8007385730743408
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 23 cost time: 1.9973900318145752
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 24 cost time: 1.7763218879699707
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3962066173553467
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5854806900024414
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.682279348373413
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4770820140838623
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7699558734893799
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6859281063079834
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 31 cost time: 1.691175937652588
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7110865116119385
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7388420104980469
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.7933335304260254
Epoch: 34, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.7289605140686035
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7710344791412354
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.738311767578125
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7844672203063965
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.7949004173278809
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.8169922828674316
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 33577
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.185476541519165
Epoch: 1, Steps: 17 | Train Loss: 2.270 Vali Loss: 2.015 Vali Acc: 0.341 Test Loss: 2.015 Test Acc: 0.341
Validation loss decreased (inf --> -0.340520).  Saving model ...
Epoch: 2 cost time: 1.5920274257659912
Epoch: 2, Steps: 17 | Train Loss: 1.936 Vali Loss: 1.581 Vali Acc: 0.662 Test Loss: 1.581 Test Acc: 0.662
Validation loss decreased (-0.340520 --> -0.662146).  Saving model ...
Epoch: 3 cost time: 1.496035099029541
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.093 Vali Acc: 0.830 Test Loss: 1.093 Test Acc: 0.830
Validation loss decreased (-0.662146 --> -0.829719).  Saving model ...
Epoch: 4 cost time: 1.5678901672363281
Epoch: 4, Steps: 17 | Train Loss: 0.997 Vali Loss: 0.716 Vali Acc: 0.873 Test Loss: 0.716 Test Acc: 0.873
Validation loss decreased (-0.829719 --> -0.872966).  Saving model ...
Epoch: 5 cost time: 1.5904135704040527
Epoch: 5, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.481 Vali Acc: 0.889 Test Loss: 0.481 Test Acc: 0.889
Validation loss decreased (-0.872966 --> -0.889184).  Saving model ...
Epoch: 6 cost time: 1.664846658706665
Epoch: 6, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.359 Vali Acc: 0.905 Test Loss: 0.359 Test Acc: 0.905
Validation loss decreased (-0.889184 --> -0.905402).  Saving model ...
Epoch: 7 cost time: 1.7021634578704834
Epoch: 7, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.287 Vali Acc: 0.932 Test Loss: 0.287 Test Acc: 0.932
Validation loss decreased (-0.905402 --> -0.932430).  Saving model ...
Epoch: 8 cost time: 1.5781114101409912
Epoch: 8, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.250 Vali Acc: 0.932 Test Loss: 0.250 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 9 cost time: 1.6317079067230225
Epoch: 9, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.229 Vali Acc: 0.932 Test Loss: 0.229 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 10 cost time: 1.7367336750030518
Epoch: 10, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 11 cost time: 1.6684644222259521
Epoch: 11, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.199 Vali Acc: 0.927 Test Loss: 0.199 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6320288181304932
Epoch: 12, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 13 cost time: 1.6906063556671143
Epoch: 13, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 14 cost time: 1.654679775238037
Epoch: 14, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 15 cost time: 1.6161606311798096
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.179 Vali Acc: 0.932 Test Loss: 0.179 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6761689186096191
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.169 Vali Acc: 0.938 Test Loss: 0.169 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7973301410675049
Epoch: 17, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 18 cost time: 1.7300422191619873
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 19 cost time: 1.7404510974884033
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6021850109100342
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.167 Vali Acc: 0.938 Test Loss: 0.167 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.652296781539917
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 22 cost time: 1.7179689407348633
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 23 cost time: 1.6417922973632812
Epoch: 23, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.173 Vali Acc: 0.938 Test Loss: 0.173 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5624909400939941
Epoch: 24, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 25 cost time: 1.6699409484863281
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 26 cost time: 1.72239089012146
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6784911155700684
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7048156261444092
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 29 cost time: 1.765183687210083
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6756768226623535
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.755953311920166
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6592116355895996
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7423772811889648
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 34 cost time: 1.701749324798584
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5880522727966309
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.702789306640625
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6383323669433594
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 38 cost time: 1.782456398010254
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.675549030303955
Epoch: 39, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5315461158752441
Epoch: 40, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.6065680980682373
Epoch: 41, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 42 cost time: 1.6397626399993896
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6824543476104736
Epoch: 43, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 44 cost time: 1.5567958354949951
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7559268474578857
Epoch: 45, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6758511066436768
Epoch: 46, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6833579540252686
Epoch: 47, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.8863115310668945
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.7239916324615479
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.8661201000213623
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.6376829147338867
Epoch: 51, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.7423522472381592
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.796804428100586
Epoch: 53, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 31865
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.170928478240967
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.115 Vali Acc: 0.116 Test Loss: 2.115 Test Acc: 0.116
Validation loss decreased (inf --> -0.116195).  Saving model ...
Epoch: 2 cost time: 1.5887413024902344
Epoch: 2, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.741 Vali Acc: 0.508 Test Loss: 1.741 Test Acc: 0.508
Validation loss decreased (-0.116195 --> -0.508091).  Saving model ...
Epoch: 3 cost time: 1.674358606338501
Epoch: 3, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.306 Vali Acc: 0.738 Test Loss: 1.306 Test Acc: 0.738
Validation loss decreased (-0.508091 --> -0.737825).  Saving model ...
Epoch: 4 cost time: 1.6479370594024658
Epoch: 4, Steps: 17 | Train Loss: 1.144 Vali Loss: 0.910 Vali Acc: 0.824 Test Loss: 0.910 Test Acc: 0.824
Validation loss decreased (-0.737825 --> -0.824315).  Saving model ...
Epoch: 5 cost time: 1.593620777130127
Epoch: 5, Steps: 17 | Train Loss: 0.794 Vali Loss: 0.622 Vali Acc: 0.870 Test Loss: 0.622 Test Acc: 0.870
Validation loss decreased (-0.824315 --> -0.870264).  Saving model ...
Epoch: 6 cost time: 1.632439136505127
Epoch: 6, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.436 Vali Acc: 0.911 Test Loss: 0.436 Test Acc: 0.911
Validation loss decreased (-0.870264 --> -0.910806).  Saving model ...
Epoch: 7 cost time: 1.6332855224609375
Epoch: 7, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.334 Vali Acc: 0.914 Test Loss: 0.334 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913510).  Saving model ...
Epoch: 8 cost time: 1.650073528289795
Epoch: 8, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.278 Vali Acc: 0.919 Test Loss: 0.278 Test Acc: 0.919
Validation loss decreased (-0.913510 --> -0.918916).  Saving model ...
Epoch: 9 cost time: 1.7125113010406494
Epoch: 9, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.252 Vali Acc: 0.924 Test Loss: 0.252 Test Acc: 0.924
Validation loss decreased (-0.918916 --> -0.924322).  Saving model ...
Epoch: 10 cost time: 1.4957952499389648
Epoch: 10, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.219 Vali Acc: 0.927 Test Loss: 0.219 Test Acc: 0.927
Validation loss decreased (-0.924322 --> -0.927025).  Saving model ...
Epoch: 11 cost time: 1.5114037990570068
Epoch: 11, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
Validation loss decreased (-0.927025 --> -0.943241).  Saving model ...
Epoch: 12 cost time: 1.5033519268035889
Epoch: 12, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5638420581817627
Epoch: 13, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 14 cost time: 1.6033039093017578
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 15 cost time: 1.4108054637908936
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.5103788375854492
Epoch: 16, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.735356092453003
Epoch: 17, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 1.72037935256958
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6674678325653076
Epoch: 19, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.759885311126709
Epoch: 20, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5622084140777588
Epoch: 21, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6936979293823242
Epoch: 22, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.75529146194458
Epoch: 23, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7218661308288574
Epoch: 24, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7136340141296387
Epoch: 25, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6705188751220703
Epoch: 26, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.770892858505249
Epoch: 27, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 28441
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.550891160964966
Epoch: 1, Steps: 17 | Train Loss: 2.039 Vali Loss: 1.723 Vali Acc: 0.554 Test Loss: 1.723 Test Acc: 0.554
Validation loss decreased (inf --> -0.554037).  Saving model ...
Epoch: 2 cost time: 1.3547110557556152
Epoch: 2, Steps: 17 | Train Loss: 1.416 Vali Loss: 0.939 Vali Acc: 0.886 Test Loss: 0.939 Test Acc: 0.886
Validation loss decreased (-0.554037 --> -0.886477).  Saving model ...
Epoch: 3 cost time: 1.7678585052490234
Epoch: 3, Steps: 17 | Train Loss: 0.775 Vali Loss: 0.495 Vali Acc: 0.914 Test Loss: 0.495 Test Acc: 0.914
Validation loss decreased (-0.886477 --> -0.913509).  Saving model ...
Epoch: 4 cost time: 1.8522839546203613
Epoch: 4, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.301 Vali Acc: 0.916 Test Loss: 0.301 Test Acc: 0.916
Validation loss decreased (-0.913509 --> -0.916213).  Saving model ...
Epoch: 5 cost time: 1.8132076263427734
Epoch: 5, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.916213 --> -0.929727).  Saving model ...
Epoch: 6 cost time: 1.5653479099273682
Epoch: 6, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
Validation loss decreased (-0.929727 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.6085193157196045
Epoch: 7, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.193 Vali Acc: 0.938 Test Loss: 0.193 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6281845569610596
Epoch: 8, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 1.7859106063842773
Epoch: 9, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5739374160766602
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6628766059875488
Epoch: 11, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7464334964752197
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.170 Vali Acc: 0.935 Test Loss: 0.170 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.764984369277954
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 14 cost time: 1.745971918106079
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.154 Vali Acc: 0.943 Test Loss: 0.154 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7084650993347168
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6777901649475098
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7003698348999023
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.938 Test Loss: 0.159 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6721594333648682
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7187209129333496
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7194409370422363
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6553289890289307
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7124686241149902
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6528656482696533
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 60025
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4723026752471924
Epoch: 1, Steps: 17 | Train Loss: 2.396 Vali Loss: 2.075 Vali Acc: 0.197 Test Loss: 2.075 Test Acc: 0.197
Validation loss decreased (inf --> -0.197277).  Saving model ...
Epoch: 2 cost time: 1.5096418857574463
Epoch: 2, Steps: 17 | Train Loss: 1.828 Vali Loss: 1.387 Vali Acc: 0.749 Test Loss: 1.387 Test Acc: 0.749
Validation loss decreased (-0.197277 --> -0.748635).  Saving model ...
Epoch: 3 cost time: 1.6209468841552734
Epoch: 3, Steps: 17 | Train Loss: 1.204 Vali Loss: 0.812 Vali Acc: 0.865 Test Loss: 0.812 Test Acc: 0.865
Validation loss decreased (-0.748635 --> -0.864857).  Saving model ...
Epoch: 4 cost time: 1.6551270484924316
Epoch: 4, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
Validation loss decreased (-0.864857 --> -0.899995).  Saving model ...
Epoch: 5 cost time: 1.7210590839385986
Epoch: 5, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
Validation loss decreased (-0.899995 --> -0.921618).  Saving model ...
Epoch: 6 cost time: 1.7135052680969238
Epoch: 6, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
Validation loss decreased (-0.921618 --> -0.937835).  Saving model ...
Epoch: 7 cost time: 1.731233835220337
Epoch: 7, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.220 Vali Acc: 0.938 Test Loss: 0.220 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 8 cost time: 1.616899013519287
Epoch: 8, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.6521449089050293
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 1.7435290813446045
Epoch: 10, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7458500862121582
Epoch: 11, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 1.6802685260772705
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6227588653564453
Epoch: 13, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.495253324508667
Epoch: 14, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.570096731185913
Epoch: 15, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.168 Vali Acc: 0.938 Test Loss: 0.168 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.314368486404419
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 1.5553958415985107
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6337757110595703
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5213792324066162
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5984630584716797
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6805241107940674
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6095101833343506
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.623701572418213
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.639617919921875
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.783773422241211
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 26 cost time: 1.611020803451538
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6725845336914062
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.525761604309082
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5630416870117188
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.576127290725708
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.509490728378296
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3957107067108154
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4333369731903076
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.5486862659454346
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5940537452697754
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 35849
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.223445415496826
Epoch: 1, Steps: 17 | Train Loss: 2.312 Vali Loss: 2.085 Vali Acc: 0.235 Test Loss: 2.085 Test Acc: 0.235
Validation loss decreased (inf --> -0.235114).  Saving model ...
Epoch: 2 cost time: 1.326521873474121
Epoch: 2, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.582 Vali Acc: 0.630 Test Loss: 1.582 Test Acc: 0.630
Validation loss decreased (-0.235114 --> -0.629714).  Saving model ...
Epoch: 3 cost time: 1.139648199081421
Epoch: 3, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.073 Vali Acc: 0.827 Test Loss: 1.073 Test Acc: 0.827
Validation loss decreased (-0.629714 --> -0.827016).  Saving model ...
Epoch: 4 cost time: 1.5340709686279297
Epoch: 4, Steps: 17 | Train Loss: 0.947 Vali Loss: 0.681 Vali Acc: 0.881 Test Loss: 0.681 Test Acc: 0.881
Validation loss decreased (-0.827016 --> -0.881074).  Saving model ...
Epoch: 5 cost time: 1.4813909530639648
Epoch: 5, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.452 Vali Acc: 0.908 Test Loss: 0.452 Test Acc: 0.908
Validation loss decreased (-0.881074 --> -0.908104).  Saving model ...
Epoch: 6 cost time: 1.4133117198944092
Epoch: 6, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.344 Vali Acc: 0.911 Test Loss: 0.344 Test Acc: 0.911
Validation loss decreased (-0.908104 --> -0.910807).  Saving model ...
Epoch: 7 cost time: 1.4822607040405273
Epoch: 7, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.275 Vali Acc: 0.914 Test Loss: 0.275 Test Acc: 0.914
Validation loss decreased (-0.910807 --> -0.913511).  Saving model ...
Epoch: 8 cost time: 1.44838285446167
Epoch: 8, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.236 Vali Acc: 0.927 Test Loss: 0.236 Test Acc: 0.927
Validation loss decreased (-0.913511 --> -0.927025).  Saving model ...
Epoch: 9 cost time: 1.4415862560272217
Epoch: 9, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
Validation loss decreased (-0.927025 --> -0.935133).  Saving model ...
Epoch: 10 cost time: 1.5090594291687012
Epoch: 10, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.489715337753296
Epoch: 11, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 12 cost time: 1.4867701530456543
Epoch: 12, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5408899784088135
Epoch: 13, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 1.517655611038208
Epoch: 14, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6226496696472168
Epoch: 15, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.6085474491119385
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5358507633209229
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3832592964172363
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4295382499694824
Epoch: 19, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4509389400482178
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 1.4026575088500977
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 22 cost time: 1.5347485542297363
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.449143648147583
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.563506841659546
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5688269138336182
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.451584815979004
Epoch: 26, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5626559257507324
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 28 cost time: 1.5109612941741943
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4877283573150635
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.553339958190918
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 31 cost time: 1.5023696422576904
Epoch: 31, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2797832489013672
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5331497192382812
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.488407850265503
Epoch: 34, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5610430240631104
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.51591157913208
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4104509353637695
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 38 cost time: 1.5382673740386963
Epoch: 38, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5580830574035645
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5430428981781006
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4600515365600586
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 42 cost time: 1.5427734851837158
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.564244031906128
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5489706993103027
Epoch: 44, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.8375027179718018
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.7362699508666992
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.602182149887085
Epoch: 47, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.7893342971801758
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.8033771514892578
Epoch: 49, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.6977999210357666
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 51 cost time: 1.7916033267974854
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.7689323425292969
Epoch: 52, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.6451785564422607
Epoch: 53, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.746272325515747
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.7650766372680664
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.6223585605621338
Epoch: 56, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.874645471572876
Epoch: 57, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.8773705959320068
Epoch: 58, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.8877027034759521
Epoch: 59, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.872398853302002
Epoch: 60, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 27241
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4631478786468506
Epoch: 1, Steps: 17 | Train Loss: 2.247 Vali Loss: 1.996 Vali Acc: 0.286 Test Loss: 1.996 Test Acc: 0.286
Validation loss decreased (inf --> -0.286467).  Saving model ...
Epoch: 2 cost time: 1.5200035572052002
Epoch: 2, Steps: 17 | Train Loss: 1.956 Vali Loss: 1.623 Vali Acc: 0.611 Test Loss: 1.623 Test Acc: 0.611
Validation loss decreased (-0.286467 --> -0.610795).  Saving model ...
Epoch: 3 cost time: 1.7762212753295898
Epoch: 3, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.199 Vali Acc: 0.778 Test Loss: 1.199 Test Acc: 0.778
Validation loss decreased (-0.610795 --> -0.778366).  Saving model ...
Epoch: 4 cost time: 1.795267105102539
Epoch: 4, Steps: 17 | Train Loss: 1.118 Vali Loss: 0.841 Vali Acc: 0.846 Test Loss: 0.841 Test Acc: 0.846
Validation loss decreased (-0.778366 --> -0.845938).  Saving model ...
Epoch: 5 cost time: 1.5009167194366455
Epoch: 5, Steps: 17 | Train Loss: 0.745 Vali Loss: 0.587 Vali Acc: 0.886 Test Loss: 0.587 Test Acc: 0.886
Validation loss decreased (-0.845938 --> -0.886481).  Saving model ...
Epoch: 6 cost time: 1.803570032119751
Epoch: 6, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.416 Vali Acc: 0.905 Test Loss: 0.416 Test Acc: 0.905
Validation loss decreased (-0.886481 --> -0.905401).  Saving model ...
Epoch: 7 cost time: 1.673612356185913
Epoch: 7, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.317 Vali Acc: 0.927 Test Loss: 0.317 Test Acc: 0.927
Validation loss decreased (-0.905401 --> -0.927024).  Saving model ...
Epoch: 8 cost time: 1.8071236610412598
Epoch: 8, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.270 Vali Acc: 0.938 Test Loss: 0.270 Test Acc: 0.938
Validation loss decreased (-0.927024 --> -0.937835).  Saving model ...
Epoch: 9 cost time: 1.7231061458587646
Epoch: 9, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7671434879302979
Epoch: 10, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 1.723203182220459
Epoch: 11, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 12 cost time: 1.6275203227996826
Epoch: 12, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 13 cost time: 1.8189153671264648
Epoch: 13, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 1.806697130203247
Epoch: 14, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6416637897491455
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2983167171478271
Epoch: 16, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.39609694480896
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5103976726531982
Epoch: 18, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.318537712097168
Epoch: 19, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5324523448944092
Epoch: 20, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6964828968048096
Epoch: 21, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.752842903137207
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7447266578674316
Epoch: 23, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 25529
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5236802101135254
Epoch: 1, Steps: 17 | Train Loss: 2.356 Vali Loss: 2.221 Vali Acc: 0.176 Test Loss: 2.221 Test Acc: 0.176
Validation loss decreased (inf --> -0.175653).  Saving model ...
Epoch: 2 cost time: 1.6478614807128906
Epoch: 2, Steps: 17 | Train Loss: 2.077 Vali Loss: 1.787 Vali Acc: 0.462 Test Loss: 1.787 Test Acc: 0.462
Validation loss decreased (-0.175653 --> -0.462144).  Saving model ...
Epoch: 3 cost time: 1.7602827548980713
Epoch: 3, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.366 Vali Acc: 0.705 Test Loss: 1.366 Test Acc: 0.705
Validation loss decreased (-0.462144 --> -0.705392).  Saving model ...
Epoch: 4 cost time: 1.735870361328125
Epoch: 4, Steps: 17 | Train Loss: 1.263 Vali Loss: 0.978 Vali Acc: 0.822 Test Loss: 0.978 Test Acc: 0.822
Validation loss decreased (-0.705392 --> -0.821612).  Saving model ...
Epoch: 5 cost time: 1.6876065731048584
Epoch: 5, Steps: 17 | Train Loss: 0.890 Vali Loss: 0.661 Vali Acc: 0.889 Test Loss: 0.661 Test Acc: 0.889
Validation loss decreased (-0.821612 --> -0.889183).  Saving model ...
Epoch: 6 cost time: 1.6547796726226807
Epoch: 6, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.471 Vali Acc: 0.914 Test Loss: 0.471 Test Acc: 0.914
Validation loss decreased (-0.889183 --> -0.913509).  Saving model ...
Epoch: 7 cost time: 1.8023302555084229
Epoch: 7, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.352 Vali Acc: 0.922 Test Loss: 0.352 Test Acc: 0.922
Validation loss decreased (-0.913509 --> -0.921618).  Saving model ...
Epoch: 8 cost time: 1.821540355682373
Epoch: 8, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.287 Vali Acc: 0.932 Test Loss: 0.287 Test Acc: 0.932
Validation loss decreased (-0.921618 --> -0.932430).  Saving model ...
Epoch: 9 cost time: 1.7232451438903809
Epoch: 9, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 1.5970776081085205
Epoch: 10, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.231 Vali Acc: 0.943 Test Loss: 0.231 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 1.6707544326782227
Epoch: 11, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 1.7958815097808838
Epoch: 12, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 1.767812967300415
Epoch: 13, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 14 cost time: 1.6426124572753906
Epoch: 14, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 15 cost time: 1.6013717651367188
Epoch: 15, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.480306625366211
Epoch: 16, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 1.5383069515228271
Epoch: 17, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8202791213989258
Epoch: 18, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 19 cost time: 1.7159090042114258
Epoch: 19, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 20 cost time: 1.6995561122894287
Epoch: 20, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8062787055969238
Epoch: 21, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6144120693206787
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5308589935302734
Epoch: 23, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 24 cost time: 1.5748326778411865
Epoch: 24, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.741335153579712
Epoch: 25, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7127244472503662
Epoch: 26, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7132568359375
Epoch: 27, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7623412609100342
Epoch: 28, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 29 cost time: 1.683403730392456
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 30 cost time: 1.5367457866668701
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3574886322021484
Epoch: 31, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 32 cost time: 1.6004352569580078
Epoch: 32, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2909083366394043
Epoch: 33, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3339791297912598
Epoch: 34, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.478031873703003
Epoch: 35, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5039684772491455
Epoch: 36, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.346668004989624
Epoch: 37, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4306449890136719
Epoch: 38, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3118491172790527
Epoch: 39, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 40 cost time: 1.3874611854553223
Epoch: 40, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 41 cost time: 1.6178321838378906
Epoch: 41, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4280827045440674
Epoch: 42, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.703169584274292
Epoch: 43, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6957404613494873
Epoch: 44, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4251868724822998
Epoch: 45, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.4627010822296143
Epoch: 46, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.5927503108978271
Epoch: 47, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.5583350658416748
Epoch: 48, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.6105115413665771
Epoch: 49, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.439321517944336
Epoch: 50, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 51 cost time: 1.4761855602264404
Epoch: 51, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.407883882522583
Epoch: 52, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.3366477489471436
Epoch: 53, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.6111633777618408
Epoch: 54, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.2576508522033691
Epoch: 55, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.495945930480957
Epoch: 56, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.479036569595337
Epoch: 57, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.3189866542816162
Epoch: 58, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.313643455505371
Epoch: 59, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.38215970993042
Epoch: 60, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 22105
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8172872066497803
Epoch: 1, Steps: 17 | Train Loss: 1.606 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
Validation loss decreased (inf --> -0.899996).  Saving model ...
Epoch: 2 cost time: 1.9644489288330078
Epoch: 2, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.261 Vali Acc: 0.927 Test Loss: 0.261 Test Acc: 0.927
Validation loss decreased (-0.899996 --> -0.927024).  Saving model ...
Epoch: 3 cost time: 1.9591405391693115
Epoch: 3, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
Validation loss decreased (-0.927024 --> -0.945944).  Saving model ...
Epoch: 4 cost time: 1.9483416080474854
Epoch: 4, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.887324571609497
Epoch: 5, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.441 Vali Acc: 0.903 Test Loss: 0.441 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9056384563446045
Epoch: 6, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.596 Vali Acc: 0.900 Test Loss: 0.596 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.058858871459961
Epoch: 7, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.315 Vali Acc: 0.935 Test Loss: 0.315 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.273698329925537
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.300 Vali Acc: 0.943 Test Loss: 0.300 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6586415767669678
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.298 Vali Acc: 0.946 Test Loss: 0.298 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8325886726379395
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8401098251342773
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.715606689453125
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.938 Test Loss: 0.287 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8060169219970703
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.938 Test Loss: 0.282 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 666377
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4889891147613525
Epoch: 1, Steps: 17 | Train Loss: 1.757 Vali Loss: 0.850 Vali Acc: 0.838 Test Loss: 0.850 Test Acc: 0.838
Validation loss decreased (inf --> -0.837829).  Saving model ...
Epoch: 2 cost time: 1.8478450775146484
Epoch: 2, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.837829 --> -0.902700).  Saving model ...
Epoch: 3 cost time: 1.8658061027526855
Epoch: 3, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.228 Vali Acc: 0.924 Test Loss: 0.228 Test Acc: 0.924
Validation loss decreased (-0.902700 --> -0.924322).  Saving model ...
Epoch: 4 cost time: 1.5773839950561523
Epoch: 4, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.194 Vali Acc: 0.924 Test Loss: 0.194 Test Acc: 0.924
Validation loss decreased (-0.924322 --> -0.924322).  Saving model ...
Epoch: 5 cost time: 1.7845475673675537
Epoch: 5, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.924322 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 1.5950407981872559
Epoch: 6, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.242 Vali Acc: 0.938 Test Loss: 0.242 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6689906120300293
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6529614925384521
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.954 Test Loss: 0.209 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7661497592926025
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7931339740753174
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8960587978363037
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8052942752838135
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8555598258972168
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6505017280578613
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8034608364105225
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 472969
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0173542499542236
Epoch: 1, Steps: 17 | Train Loss: 1.927 Vali Loss: 1.011 Vali Acc: 0.789 Test Loss: 1.011 Test Acc: 0.789
Validation loss decreased (inf --> -0.789179).  Saving model ...
Epoch: 2 cost time: 1.6484580039978027
Epoch: 2, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.324 Vali Acc: 0.908 Test Loss: 0.324 Test Acc: 0.908
Validation loss decreased (-0.789179 --> -0.908105).  Saving model ...
Epoch: 3 cost time: 1.5656459331512451
Epoch: 3, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
Validation loss decreased (-0.908105 --> -0.921619).  Saving model ...
Epoch: 4 cost time: 1.4992032051086426
Epoch: 4, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.921619 --> -0.940539).  Saving model ...
Epoch: 5 cost time: 2.120694398880005
Epoch: 5, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 2.0200130939483643
Epoch: 6, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7980148792266846
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 2.031451463699341
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8985517024993896
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0719451904296875
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.140885591506958
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.047720193862915
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 13 cost time: 2.1796114444732666
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9781379699707031
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8850860595703125
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9980621337890625
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8426494598388672
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.077472448348999
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.964339017868042
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.055635690689087
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.068808078765869
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.038757562637329
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 404105
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.500067949295044
Epoch: 1, Steps: 17 | Train Loss: 1.987 Vali Loss: 1.072 Vali Acc: 0.808 Test Loss: 1.072 Test Acc: 0.808
Validation loss decreased (inf --> -0.808097).  Saving model ...
Epoch: 2 cost time: 1.7915513515472412
Epoch: 2, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
Validation loss decreased (-0.808097 --> -0.910807).  Saving model ...
Epoch: 3 cost time: 2.1607699394226074
Epoch: 3, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
Validation loss decreased (-0.910807 --> -0.921619).  Saving model ...
Epoch: 4 cost time: 2.0260257720947266
Epoch: 4, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.921619 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 1.9839789867401123
Epoch: 5, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 6 cost time: 2.133112668991089
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 2.0412678718566895
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1032540798187256
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.17561411857605
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1156294345855713
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 2.1201529502868652
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.055532693862915
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9079654216766357
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1520307064056396
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7299678325653076
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.02978515625
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9263901710510254
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.825110912322998
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.651540994644165
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6381311416625977
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 390409
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.456307888031006
Epoch: 1, Steps: 17 | Train Loss: 1.996 Vali Loss: 1.219 Vali Acc: 0.765 Test Loss: 1.219 Test Acc: 0.765
Validation loss decreased (inf --> -0.764853).  Saving model ...
Epoch: 2 cost time: 1.9064610004425049
Epoch: 2, Steps: 17 | Train Loss: 0.755 Vali Loss: 0.397 Vali Acc: 0.924 Test Loss: 0.397 Test Acc: 0.924
Validation loss decreased (-0.764853 --> -0.924320).  Saving model ...
Epoch: 3 cost time: 1.8315775394439697
Epoch: 3, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9376020431518555
Epoch: 4, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.924320 --> -0.956755).  Saving model ...
Epoch: 5 cost time: 1.963357925415039
Epoch: 5, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8312454223632812
Epoch: 6, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9630908966064453
Epoch: 7, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7381279468536377
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7978816032409668
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0196194648742676
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 1.8522264957427979
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8862578868865967
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0783793926239014
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.825246810913086
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.006120204925537
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.713541030883789
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7197654247283936
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7015163898468018
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6253643035888672
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.993208408355713
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 363017
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.875615358352661
Epoch: 1, Steps: 17 | Train Loss: 1.618 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (inf --> -0.899996).  Saving model ...
Epoch: 2 cost time: 2.5145225524902344
Epoch: 2, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
Validation loss decreased (-0.899996 --> -0.935133).  Saving model ...
Epoch: 3 cost time: 2.295656204223633
Epoch: 3, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.208 Vali Acc: 0.927 Test Loss: 0.208 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4494240283966064
Epoch: 4, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.240 Vali Acc: 0.938 Test Loss: 0.240 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 2.5061676502227783
Epoch: 5, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.343 Vali Acc: 0.884 Test Loss: 0.343 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3558876514434814
Epoch: 6, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.315 Vali Acc: 0.924 Test Loss: 0.315 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3446202278137207
Epoch: 7, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.631 Vali Acc: 0.868 Test Loss: 0.631 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2861862182617188
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.324 Vali Acc: 0.938 Test Loss: 0.324 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1548874378204346
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.497 Vali Acc: 0.905 Test Loss: 0.497 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2034711837768555
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.485 Vali Acc: 0.916 Test Loss: 0.485 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.132395029067993
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.450 Vali Acc: 0.935 Test Loss: 0.450 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.554715871810913
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.472 Vali Acc: 0.927 Test Loss: 0.472 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5725350379943848
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.446 Vali Acc: 0.927 Test Loss: 0.446 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6453921794891357
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.908 Test Loss: 0.570 Test Acc: 0.908
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 600585
model size : 4.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.741030693054199
Epoch: 1, Steps: 17 | Train Loss: 1.774 Vali Loss: 0.810 Vali Acc: 0.849 Test Loss: 0.810 Test Acc: 0.849
Validation loss decreased (inf --> -0.848641).  Saving model ...
Epoch: 2 cost time: 2.2516555786132812
Epoch: 2, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.258 Vali Acc: 0.916 Test Loss: 0.258 Test Acc: 0.916
Validation loss decreased (-0.848641 --> -0.916214).  Saving model ...
Epoch: 3 cost time: 2.404574394226074
Epoch: 3, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
Validation loss decreased (-0.916214 --> -0.935133).  Saving model ...
Epoch: 4 cost time: 2.370526075363159
Epoch: 4, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.236 Vali Acc: 0.924 Test Loss: 0.236 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.325627326965332
Epoch: 5, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.213 Vali Acc: 0.927 Test Loss: 0.213 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.518527030944824
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 2.4143967628479004
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 2.4349427223205566
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.244384765625
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1140785217285156
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0974016189575195
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1553497314453125
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1189777851104736
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1287131309509277
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.434760332107544
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3470025062561035
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4769413471221924
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.177253007888794
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 407177
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9933862686157227
Epoch: 1, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.030 Vali Acc: 0.811 Test Loss: 1.030 Test Acc: 0.811
Validation loss decreased (inf --> -0.810801).  Saving model ...
Epoch: 2 cost time: 2.4573171138763428
Epoch: 2, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
Validation loss decreased (-0.810801 --> -0.918916).  Saving model ...
Epoch: 3 cost time: 2.3097646236419678
Epoch: 3, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
Validation loss decreased (-0.918916 --> -0.943241).  Saving model ...
Epoch: 4 cost time: 2.1352388858795166
Epoch: 4, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1788370609283447
Epoch: 5, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 2.146226406097412
Epoch: 6, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 2.287716865539551
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.941 Test Loss: 0.152 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0164217948913574
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9568407535552979
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9716191291809082
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2378928661346436
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3736326694488525
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1847307682037354
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8142120838165283
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.786942481994629
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7913596630096436
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 338313
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6657607555389404
Epoch: 1, Steps: 17 | Train Loss: 1.964 Vali Loss: 1.125 Vali Acc: 0.792 Test Loss: 1.125 Test Acc: 0.792
Validation loss decreased (inf --> -0.791881).  Saving model ...
Epoch: 2 cost time: 1.8765873908996582
Epoch: 2, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.394 Vali Acc: 0.897 Test Loss: 0.394 Test Acc: 0.897
Validation loss decreased (-0.791881 --> -0.897293).  Saving model ...
Epoch: 3 cost time: 1.9589505195617676
Epoch: 3, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.209 Vali Acc: 0.932 Test Loss: 0.209 Test Acc: 0.932
Validation loss decreased (-0.897293 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 1.9552626609802246
Epoch: 4, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.932430 --> -0.951350).  Saving model ...
Epoch: 5 cost time: 1.9787712097167969
Epoch: 5, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 2.0531911849975586
Epoch: 6, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 7 cost time: 1.9869449138641357
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9908974170684814
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.023458242416382
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.032435894012451
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9682843685150146
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9701645374298096
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0850727558135986
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0191454887390137
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.953791856765747
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8932902812957764
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 324617
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.882124423980713
Epoch: 1, Steps: 17 | Train Loss: 2.048 Vali Loss: 1.351 Vali Acc: 0.730 Test Loss: 1.351 Test Acc: 0.730
Validation loss decreased (inf --> -0.729716).  Saving model ...
Epoch: 2 cost time: 2.552530527114868
Epoch: 2, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.430 Vali Acc: 0.895 Test Loss: 0.430 Test Acc: 0.895
Validation loss decreased (-0.729716 --> -0.894590).  Saving model ...
Epoch: 3 cost time: 2.144047498703003
Epoch: 3, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
Validation loss decreased (-0.894590 --> -0.945944).  Saving model ...
Epoch: 4 cost time: 2.24863338470459
Epoch: 4, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4884822368621826
Epoch: 5, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 2.248596429824829
Epoch: 6, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5737462043762207
Epoch: 7, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3744709491729736
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5003156661987305
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 2.482553005218506
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.583709955215454
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2330832481384277
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5281622409820557
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2400670051574707
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 2.519181728363037
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4396159648895264
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.188197374343872
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3486368656158447
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.288137435913086
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.4830212593078613
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3661022186279297
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.510455846786499
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1232540607452393
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.5652482509613037
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 2.247612237930298
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.492309331893921
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4422099590301514
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.177360773086548
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.4447789192199707
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.170480728149414
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.612496852874756
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.1977996826171875
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.374509572982788
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.780076503753662
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 297225
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.188525199890137
Epoch: 1, Steps: 17 | Train Loss: 1.558 Vali Loss: 0.492 Vali Acc: 0.881 Test Loss: 0.492 Test Acc: 0.881
Validation loss decreased (inf --> -0.881076).  Saving model ...
Epoch: 2 cost time: 2.437631845474243
Epoch: 2, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
Validation loss decreased (-0.881076 --> -0.929728).  Saving model ...
Epoch: 3 cost time: 2.202568531036377
Epoch: 3, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.248 Vali Acc: 0.935 Test Loss: 0.248 Test Acc: 0.935
Validation loss decreased (-0.929728 --> -0.935133).  Saving model ...
Epoch: 4 cost time: 2.321790933609009
Epoch: 4, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940538).  Saving model ...
Epoch: 5 cost time: 2.41886305809021
Epoch: 5, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5015981197357178
Epoch: 6, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0274808406829834
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.359 Vali Acc: 0.927 Test Loss: 0.359 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9618494510650635
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.336 Vali Acc: 0.919 Test Loss: 0.336 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4549105167388916
Epoch: 9, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.450 Vali Acc: 0.895 Test Loss: 0.450 Test Acc: 0.895
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.78233003616333
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.366 Vali Acc: 0.932 Test Loss: 0.366 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.108433485031128
Epoch: 11, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3293650150299072
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.422 Vali Acc: 0.930 Test Loss: 0.422 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.528261184692383
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.488 Vali Acc: 0.938 Test Loss: 0.488 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.252446174621582
Epoch: 14, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.449 Vali Acc: 0.922 Test Loss: 0.449 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9405405405405406
model parameter : 567689
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6730761528015137
Epoch: 1, Steps: 17 | Train Loss: 1.974 Vali Loss: 0.954 Vali Acc: 0.792 Test Loss: 0.954 Test Acc: 0.792
Validation loss decreased (inf --> -0.791882).  Saving model ...
Epoch: 2 cost time: 2.3151421546936035
Epoch: 2, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.258 Vali Acc: 0.916 Test Loss: 0.258 Test Acc: 0.916
Validation loss decreased (-0.791882 --> -0.916214).  Saving model ...
Epoch: 3 cost time: 2.0978310108184814
Epoch: 3, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.916214 --> -0.921619).  Saving model ...
Epoch: 4 cost time: 1.8155779838562012
Epoch: 4, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.921619 --> -0.951350).  Saving model ...
Epoch: 5 cost time: 2.0789871215820312
Epoch: 5, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.061021089553833
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.64471435546875
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6612334251403809
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7338440418243408
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6108367443084717
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1130406856536865
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0838351249694824
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.358046770095825
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2111611366271973
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 374281
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4419736862182617
Epoch: 1, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.057 Vali Acc: 0.805 Test Loss: 1.057 Test Acc: 0.805
Validation loss decreased (inf --> -0.805395).  Saving model ...
Epoch: 2 cost time: 1.613818645477295
Epoch: 2, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
Validation loss decreased (-0.805395 --> -0.929727).  Saving model ...
Epoch: 3 cost time: 1.933394432067871
Epoch: 3, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 4 cost time: 1.8708956241607666
Epoch: 4, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954053).  Saving model ...
Epoch: 5 cost time: 2.0387001037597656
Epoch: 5, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.270249366760254
Epoch: 6, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5196478366851807
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6076467037200928
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 1.717533826828003
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7031645774841309
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6997315883636475
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8436322212219238
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9265708923339844
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9760918617248535
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8524084091186523
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8310716152191162
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.10235857963562
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.235257863998413
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 305417
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3890380859375
Epoch: 1, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.121 Vali Acc: 0.784 Test Loss: 1.121 Test Acc: 0.784
Validation loss decreased (inf --> -0.783773).  Saving model ...
Epoch: 2 cost time: 1.8135979175567627
Epoch: 2, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.387 Vali Acc: 0.886 Test Loss: 0.387 Test Acc: 0.886
Validation loss decreased (-0.783773 --> -0.886483).  Saving model ...
Epoch: 3 cost time: 1.9609980583190918
Epoch: 3, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.262 Vali Acc: 0.919 Test Loss: 0.262 Test Acc: 0.919
Validation loss decreased (-0.886483 --> -0.918916).  Saving model ...
Epoch: 4 cost time: 2.020746946334839
Epoch: 4, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.918916 --> -0.940539).  Saving model ...
Epoch: 5 cost time: 2.180495500564575
Epoch: 5, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6232879161834717
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 7 cost time: 1.687265157699585
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6518235206604004
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7196993827819824
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.005439043045044
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9786789417266846
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.135266065597534
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8703324794769287
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7864117622375488
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.869908094406128
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.744128704071045
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 291721
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.18353009223938
Epoch: 1, Steps: 17 | Train Loss: 2.077 Vali Loss: 1.360 Vali Acc: 0.689 Test Loss: 1.360 Test Acc: 0.689
Validation loss decreased (inf --> -0.689176).  Saving model ...
Epoch: 2 cost time: 1.6963796615600586
Epoch: 2, Steps: 17 | Train Loss: 0.846 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.689176 --> -0.899996).  Saving model ...
Epoch: 3 cost time: 1.734938144683838
Epoch: 3, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.910808).  Saving model ...
Epoch: 4 cost time: 1.5483005046844482
Epoch: 4, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
Validation loss decreased (-0.910808 --> -0.945944).  Saving model ...
Epoch: 5 cost time: 2.1532034873962402
Epoch: 5, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 1.9712929725646973
Epoch: 6, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.645293951034546
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.951350 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 1.7606496810913086
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.957228660583496
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9805684089660645
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.909330129623413
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.790118932723999
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8478827476501465
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.016832113265991
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7217843532562256
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7115466594696045
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7886061668395996
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 264329
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.581821918487549
Epoch: 1, Steps: 17 | Train Loss: 1.786 Vali Loss: 0.861 Vali Acc: 0.830 Test Loss: 0.861 Test Acc: 0.830
Validation loss decreased (inf --> -0.829721).  Saving model ...
Epoch: 2 cost time: 1.9951221942901611
Epoch: 2, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
Validation loss decreased (-0.829721 --> -0.878375).  Saving model ...
Epoch: 3 cost time: 2.1697275638580322
Epoch: 3, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.190 Vali Acc: 0.927 Test Loss: 0.190 Test Acc: 0.927
Validation loss decreased (-0.878375 --> -0.927025).  Saving model ...
Epoch: 4 cost time: 2.076589584350586
Epoch: 4, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.178 Vali Acc: 0.938 Test Loss: 0.178 Test Acc: 0.938
Validation loss decreased (-0.927025 --> -0.937836).  Saving model ...
Epoch: 5 cost time: 1.9894540309906006
Epoch: 5, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.149808406829834
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.030272960662842
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.932 Test Loss: 0.191 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.985032320022583
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0937347412109375
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 1.9110362529754639
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.924 Test Loss: 0.264 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3238446712493896
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.614316940307617
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3908441066741943
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.927 Test Loss: 0.256 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.666807174682617
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4517416954040527
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.4904775619506836
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.932 Test Loss: 0.217 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2128210067749023
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 18 cost time: 2.500763416290283
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 19 cost time: 2.145840644836426
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.680870771408081
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4193530082702637
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.946 Test Loss: 0.214 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 2.742173671722412
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.393618583679199
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.946 Test Loss: 0.216 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.525865077972412
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4608688354492188
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.301624298095703
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.946 Test Loss: 0.214 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.441528797149658
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.2940866947174072
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.6244099140167236
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.262929916381836
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.735809326171875
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 300681
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2298669815063477
Epoch: 1, Steps: 17 | Train Loss: 2.076 Vali Loss: 1.388 Vali Acc: 0.697 Test Loss: 1.388 Test Acc: 0.697
Validation loss decreased (inf --> -0.697283).  Saving model ...
Epoch: 2 cost time: 1.791823387145996
Epoch: 2, Steps: 17 | Train Loss: 0.809 Vali Loss: 0.390 Vali Acc: 0.922 Test Loss: 0.390 Test Acc: 0.922
Validation loss decreased (-0.697283 --> -0.921618).  Saving model ...
Epoch: 3 cost time: 1.6311898231506348
Epoch: 3, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
Validation loss decreased (-0.921618 --> -0.935133).  Saving model ...
Epoch: 4 cost time: 1.7002739906311035
Epoch: 4, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.191 Vali Acc: 0.932 Test Loss: 0.191 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.44427227973938
Epoch: 5, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.935133 --> -0.954053).  Saving model ...
Epoch: 6 cost time: 2.2500905990600586
Epoch: 6, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.131838321685791
Epoch: 7, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1536495685577393
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.201749086380005
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3265013694763184
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0318665504455566
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0233042240142822
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.132174491882324
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3625900745391846
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.189779281616211
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1505250930786133
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1064610481262207
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 2.4309377670288086
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.041916847229004
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8221986293792725
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8107657432556152
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6982738971710205
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 1.7849600315093994
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0908989906311035
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2723653316497803
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.23125958442688
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.409299373626709
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.4514479637145996
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.199784994125366
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.213808298110962
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.0915935039520264
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.121525526046753
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 203977
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0534188747406006
Epoch: 1, Steps: 17 | Train Loss: 2.109 Vali Loss: 1.519 Vali Acc: 0.654 Test Loss: 1.519 Test Acc: 0.654
Validation loss decreased (inf --> -0.654039).  Saving model ...
Epoch: 2 cost time: 1.317885398864746
Epoch: 2, Steps: 17 | Train Loss: 1.049 Vali Loss: 0.547 Vali Acc: 0.895 Test Loss: 0.547 Test Acc: 0.895
Validation loss decreased (-0.654039 --> -0.894589).  Saving model ...
Epoch: 3 cost time: 1.3799006938934326
Epoch: 3, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.251 Vali Acc: 0.932 Test Loss: 0.251 Test Acc: 0.932
Validation loss decreased (-0.894589 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 1.218454360961914
Epoch: 4, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940539).  Saving model ...
Epoch: 5 cost time: 1.1251778602600098
Epoch: 5, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 1.2074012756347656
Epoch: 6, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.153576135635376
Epoch: 7, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1365060806274414
Epoch: 8, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1921346187591553
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.1657257080078125
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.3452861309051514
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2213852405548096
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.3148562908172607
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2927875518798828
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3198113441467285
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3504903316497803
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2216169834136963
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.204437017440796
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1799614429473877
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3666276931762695
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1025948524475098
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.168262004852295
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 169545
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7605559825897217
Epoch: 1, Steps: 17 | Train Loss: 2.036 Vali Loss: 1.530 Vali Acc: 0.608 Test Loss: 1.530 Test Acc: 0.608
Validation loss decreased (inf --> -0.608093).  Saving model ...
Epoch: 2 cost time: 1.3117423057556152
Epoch: 2, Steps: 17 | Train Loss: 1.110 Vali Loss: 0.640 Vali Acc: 0.870 Test Loss: 0.640 Test Acc: 0.870
Validation loss decreased (-0.608093 --> -0.870264).  Saving model ...
Epoch: 3 cost time: 1.1334326267242432
Epoch: 3, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.307 Vali Acc: 0.916 Test Loss: 0.307 Test Acc: 0.916
Validation loss decreased (-0.870264 --> -0.916213).  Saving model ...
Epoch: 4 cost time: 1.2164652347564697
Epoch: 4, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
Validation loss decreased (-0.916213 --> -0.937836).  Saving model ...
Epoch: 5 cost time: 1.1487016677856445
Epoch: 5, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940538).  Saving model ...
Epoch: 6 cost time: 1.1426873207092285
Epoch: 6, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.940538 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 1.1236662864685059
Epoch: 7, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2262191772460938
Epoch: 8, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.199908971786499
Epoch: 9, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.175736665725708
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2082066535949707
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3574693202972412
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3741788864135742
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4036469459533691
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3924050331115723
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4212639331817627
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 162697
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8153467178344727
Epoch: 1, Steps: 17 | Train Loss: 2.204 Vali Loss: 1.742 Vali Acc: 0.503 Test Loss: 1.742 Test Acc: 0.503
Validation loss decreased (inf --> -0.502685).  Saving model ...
Epoch: 2 cost time: 1.085801124572754
Epoch: 2, Steps: 17 | Train Loss: 1.317 Vali Loss: 0.862 Vali Acc: 0.808 Test Loss: 0.862 Test Acc: 0.808
Validation loss decreased (-0.502685 --> -0.808099).  Saving model ...
Epoch: 3 cost time: 1.1608154773712158
Epoch: 3, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.418 Vali Acc: 0.895 Test Loss: 0.418 Test Acc: 0.895
Validation loss decreased (-0.808099 --> -0.894590).  Saving model ...
Epoch: 4 cost time: 1.0043737888336182
Epoch: 4, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.266 Vali Acc: 0.932 Test Loss: 0.266 Test Acc: 0.932
Validation loss decreased (-0.894590 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 1.1151387691497803
Epoch: 5, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 1.1441922187805176
Epoch: 6, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.175842046737671
Epoch: 7, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1313819885253906
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.1051347255706787
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.2128746509552002
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1327762603759766
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2255287170410156
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2332210540771484
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.16111421585083
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1230881214141846
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1919207572937012
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.118556261062622
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.16621994972229
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2990496158599854
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 149001
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.832913637161255
Epoch: 1, Steps: 17 | Train Loss: 1.815 Vali Loss: 0.905 Vali Acc: 0.778 Test Loss: 0.905 Test Acc: 0.778
Validation loss decreased (inf --> -0.778369).  Saving model ...
Epoch: 2 cost time: 2.0361104011535645
Epoch: 2, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.311 Vali Acc: 0.911 Test Loss: 0.311 Test Acc: 0.911
Validation loss decreased (-0.778369 --> -0.910808).  Saving model ...
Epoch: 3 cost time: 1.889922857284546
Epoch: 3, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
Validation loss decreased (-0.910808 --> -0.948647).  Saving model ...
Epoch: 4 cost time: 1.962235927581787
Epoch: 4, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9995594024658203
Epoch: 5, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.191 Vali Acc: 0.927 Test Loss: 0.191 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9676852226257324
Epoch: 6, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.238 Vali Acc: 0.932 Test Loss: 0.238 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0410475730895996
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.793565273284912
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 1.9667785167694092
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6147255897521973
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.430233955383301
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7338032722473145
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.365267038345337
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.951 Test Loss: 0.195 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.780778408050537
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4516451358795166
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.700575351715088
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5643985271453857
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6189239025115967
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 267657
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.456785202026367
Epoch: 1, Steps: 17 | Train Loss: 1.986 Vali Loss: 1.346 Vali Acc: 0.730 Test Loss: 1.346 Test Acc: 0.730
Validation loss decreased (inf --> -0.729716).  Saving model ...
Epoch: 2 cost time: 1.7085254192352295
Epoch: 2, Steps: 17 | Train Loss: 0.827 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.729716 --> -0.889185).  Saving model ...
Epoch: 3 cost time: 2.1183509826660156
Epoch: 3, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
Validation loss decreased (-0.889185 --> -0.929727).  Saving model ...
Epoch: 4 cost time: 2.104400873184204
Epoch: 4, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 2.3295111656188965
Epoch: 5, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2669496536254883
Epoch: 6, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954052).  Saving model ...
Epoch: 7 cost time: 2.363071918487549
Epoch: 7, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9824936389923096
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.3876802921295166
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1706488132476807
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3043930530548096
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.26821231842041
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3956286907196045
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2095868587493896
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.963536262512207
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.098773956298828
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0424327850341797
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2153689861297607
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 170953
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.083669662475586
Epoch: 1, Steps: 17 | Train Loss: 2.137 Vali Loss: 1.468 Vali Acc: 0.714 Test Loss: 1.468 Test Acc: 0.714
Validation loss decreased (inf --> -0.713499).  Saving model ...
Epoch: 2 cost time: 1.3300211429595947
Epoch: 2, Steps: 17 | Train Loss: 1.029 Vali Loss: 0.599 Vali Acc: 0.881 Test Loss: 0.599 Test Acc: 0.881
Validation loss decreased (-0.713499 --> -0.881075).  Saving model ...
Epoch: 3 cost time: 1.3091697692871094
Epoch: 3, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
Validation loss decreased (-0.881075 --> -0.921619).  Saving model ...
Epoch: 4 cost time: 1.1774046421051025
Epoch: 4, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.208 Vali Acc: 0.932 Test Loss: 0.208 Test Acc: 0.932
Validation loss decreased (-0.921619 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 1.2782220840454102
Epoch: 5, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.3467631340026855
Epoch: 6, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.077120304107666
Epoch: 7, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3601579666137695
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.144953966140747
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.342320442199707
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4020068645477295
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3060452938079834
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.057227611541748
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.070723533630371
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0568547248840332
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0228114128112793
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 0.9787299633026123
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0177934169769287
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2850384712219238
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2038593292236328
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1802833080291748
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2350177764892578
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.197077751159668
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1281771659851074
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2796385288238525
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2275068759918213
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 136521
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9445886611938477
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 1.598 Vali Acc: 0.608 Test Loss: 1.598 Test Acc: 0.608
Validation loss decreased (inf --> -0.608092).  Saving model ...
Epoch: 2 cost time: 1.2757229804992676
Epoch: 2, Steps: 17 | Train Loss: 1.195 Vali Loss: 0.699 Vali Acc: 0.873 Test Loss: 0.699 Test Acc: 0.873
Validation loss decreased (-0.608092 --> -0.872966).  Saving model ...
Epoch: 3 cost time: 1.0471820831298828
Epoch: 3, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.331 Vali Acc: 0.932 Test Loss: 0.331 Test Acc: 0.932
Validation loss decreased (-0.872966 --> -0.932429).  Saving model ...
Epoch: 4 cost time: 1.2560522556304932
Epoch: 4, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3321597576141357
Epoch: 5, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
Validation loss decreased (-0.932429 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.1967124938964844
Epoch: 6, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1151084899902344
Epoch: 7, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 8 cost time: 1.2209184169769287
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 1.2999913692474365
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1009223461151123
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1174261569976807
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.362163782119751
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3153493404388428
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0235605239868164
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2677719593048096
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.141542673110962
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.011875867843628
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1918959617614746
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 129673
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7908337116241455
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 1.749 Vali Acc: 0.478 Test Loss: 1.749 Test Acc: 0.478
Validation loss decreased (inf --> -0.478361).  Saving model ...
Epoch: 2 cost time: 1.1215860843658447
Epoch: 2, Steps: 17 | Train Loss: 1.334 Vali Loss: 0.872 Vali Acc: 0.827 Test Loss: 0.872 Test Acc: 0.827
Validation loss decreased (-0.478361 --> -0.827018).  Saving model ...
Epoch: 3 cost time: 1.1740930080413818
Epoch: 3, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.436 Vali Acc: 0.889 Test Loss: 0.436 Test Acc: 0.889
Validation loss decreased (-0.827018 --> -0.889185).  Saving model ...
Epoch: 4 cost time: 1.2240960597991943
Epoch: 4, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
Validation loss decreased (-0.889185 --> -0.940538).  Saving model ...
Epoch: 5 cost time: 1.1555111408233643
Epoch: 5, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.1450285911560059
Epoch: 6, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.0473599433898926
Epoch: 7, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 8 cost time: 1.319162368774414
Epoch: 8, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.1693761348724365
Epoch: 9, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 1.1343116760253906
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1384623050689697
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.335505485534668
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.148 Vali Acc: 0.943 Test Loss: 0.148 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0943200588226318
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9880776405334473
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 0.9484457969665527
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9393501281738281
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9821507930755615
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1385490894317627
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1122410297393799
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2711687088012695
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3382136821746826
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1817891597747803
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0596649646759033
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0700554847717285
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 115977
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5632498264312744
Epoch: 1, Steps: 17 | Train Loss: 1.737 Vali Loss: 0.775 Vali Acc: 0.868 Test Loss: 0.775 Test Acc: 0.868
Validation loss decreased (inf --> -0.867560).  Saving model ...
Epoch: 2 cost time: 1.8102788925170898
Epoch: 2, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.282 Vali Acc: 0.905 Test Loss: 0.282 Test Acc: 0.905
Validation loss decreased (-0.867560 --> -0.905403).  Saving model ...
Epoch: 3 cost time: 1.834667682647705
Epoch: 3, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
Validation loss decreased (-0.905403 --> -0.910808).  Saving model ...
Epoch: 4 cost time: 1.8151109218597412
Epoch: 4, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.910808 --> -0.940538).  Saving model ...
Epoch: 5 cost time: 1.815580129623413
Epoch: 5, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.633199691772461
Epoch: 6, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 7 cost time: 2.0437488555908203
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7630720138549805
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9006688594818115
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8059203624725342
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6196696758270264
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6017122268676758
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5342082977294922
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7249948978424072
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8348348140716553
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7801709175109863
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 251145
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1412193775177
Epoch: 1, Steps: 17 | Train Loss: 1.927 Vali Loss: 1.240 Vali Acc: 0.778 Test Loss: 1.240 Test Acc: 0.778
Validation loss decreased (inf --> -0.778366).  Saving model ...
Epoch: 2 cost time: 1.7200167179107666
Epoch: 2, Steps: 17 | Train Loss: 0.828 Vali Loss: 0.440 Vali Acc: 0.905 Test Loss: 0.440 Test Acc: 0.905
Validation loss decreased (-0.778366 --> -0.905401).  Saving model ...
Epoch: 3 cost time: 1.7852771282196045
Epoch: 3, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.260 Vali Acc: 0.924 Test Loss: 0.260 Test Acc: 0.924
Validation loss decreased (-0.905401 --> -0.924322).  Saving model ...
Epoch: 4 cost time: 1.6523106098175049
Epoch: 4, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.189 Vali Acc: 0.932 Test Loss: 0.189 Test Acc: 0.932
Validation loss decreased (-0.924322 --> -0.932431).  Saving model ...
Epoch: 5 cost time: 1.5840888023376465
Epoch: 5, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
Validation loss decreased (-0.932431 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 1.4678528308868408
Epoch: 6, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.161 Vali Acc: 0.938 Test Loss: 0.161 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6525907516479492
Epoch: 7, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.181 Vali Acc: 0.935 Test Loss: 0.181 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5209245681762695
Epoch: 8, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.7320406436920166
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 1.861065149307251
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6775295734405518
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7331385612487793
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7543137073516846
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 1.7212028503417969
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8344192504882812
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5954575538635254
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5938568115234375
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4644453525543213
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.530703067779541
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.386240005493164
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.409940481185913
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5275814533233643
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.595731496810913
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 154441
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.667966842651367
Epoch: 1, Steps: 17 | Train Loss: 2.231 Vali Loss: 1.550 Vali Acc: 0.632 Test Loss: 1.550 Test Acc: 0.632
Validation loss decreased (inf --> -0.632417).  Saving model ...
Epoch: 2 cost time: 1.083653450012207
Epoch: 2, Steps: 17 | Train Loss: 1.087 Vali Loss: 0.607 Vali Acc: 0.897 Test Loss: 0.607 Test Acc: 0.897
Validation loss decreased (-0.632417 --> -0.897291).  Saving model ...
Epoch: 3 cost time: 1.0191504955291748
Epoch: 3, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
Validation loss decreased (-0.897291 --> -0.929727).  Saving model ...
Epoch: 4 cost time: 0.9823484420776367
Epoch: 4, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.211 Vali Acc: 0.927 Test Loss: 0.211 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.158182144165039
Epoch: 5, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943242).  Saving model ...
Epoch: 6 cost time: 1.25026535987854
Epoch: 6, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.0794756412506104
Epoch: 7, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.11112642288208
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1363415718078613
Epoch: 9, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 10 cost time: 1.0710456371307373
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.086103916168213
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 12 cost time: 1.144918441772461
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.2558650970458984
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1693179607391357
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2825381755828857
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3180341720581055
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1638901233673096
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 1.264824390411377
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1508667469024658
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2897670269012451
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.158513069152832
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2732961177825928
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 1.3204710483551025
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3188023567199707
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3295481204986572
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.297523021697998
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1873173713684082
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3494834899902344
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1834657192230225
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.186645269393921
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3578109741210938
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.202347755432129
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 120009
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.86029052734375
Epoch: 1, Steps: 17 | Train Loss: 1.951 Vali Loss: 1.369 Vali Acc: 0.724 Test Loss: 1.369 Test Acc: 0.724
Validation loss decreased (inf --> -0.724311).  Saving model ...
Epoch: 2 cost time: 1.291001558303833
Epoch: 2, Steps: 17 | Train Loss: 1.032 Vali Loss: 0.621 Vali Acc: 0.870 Test Loss: 0.621 Test Acc: 0.870
Validation loss decreased (-0.724311 --> -0.870264).  Saving model ...
Epoch: 3 cost time: 1.322441577911377
Epoch: 3, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.324 Vali Acc: 0.919 Test Loss: 0.324 Test Acc: 0.919
Validation loss decreased (-0.870264 --> -0.918916).  Saving model ...
Epoch: 4 cost time: 1.4339027404785156
Epoch: 4, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.242 Vali Acc: 0.938 Test Loss: 0.242 Test Acc: 0.938
Validation loss decreased (-0.918916 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 1.3624732494354248
Epoch: 5, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.199 Vali Acc: 0.938 Test Loss: 0.199 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 1.4140591621398926
Epoch: 6, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.3398246765136719
Epoch: 7, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3863813877105713
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.4538366794586182
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3289811611175537
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.3835630416870117
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4119365215301514
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2828850746154785
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.101142168045044
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3015844821929932
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2311031818389893
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1773183345794678
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1617317199707031
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0120599269866943
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9979820251464844
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 113161
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7924346923828125
Epoch: 1, Steps: 17 | Train Loss: 2.127 Vali Loss: 1.719 Vali Acc: 0.581 Test Loss: 1.719 Test Acc: 0.581
Validation loss decreased (inf --> -0.581064).  Saving model ...
Epoch: 2 cost time: 1.181870698928833
Epoch: 2, Steps: 17 | Train Loss: 1.281 Vali Loss: 0.839 Vali Acc: 0.857 Test Loss: 0.839 Test Acc: 0.857
Validation loss decreased (-0.581064 --> -0.856748).  Saving model ...
Epoch: 3 cost time: 1.206629753112793
Epoch: 3, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.427 Vali Acc: 0.905 Test Loss: 0.427 Test Acc: 0.905
Validation loss decreased (-0.856748 --> -0.905401).  Saving model ...
Epoch: 4 cost time: 1.0771045684814453
Epoch: 4, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
Validation loss decreased (-0.905401 --> -0.921619).  Saving model ...
Epoch: 5 cost time: 1.1918466091156006
Epoch: 5, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.207 Vali Acc: 0.927 Test Loss: 0.207 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927025).  Saving model ...
Epoch: 6 cost time: 1.1045482158660889
Epoch: 6, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
Validation loss decreased (-0.927025 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.1349151134490967
Epoch: 7, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 8 cost time: 1.3518242835998535
Epoch: 8, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.1040067672729492
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 0.9481019973754883
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 0.90999436378479
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9423491954803467
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7787737846374512
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8540594577789307
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 0.9485301971435547
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9766650199890137
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9254825115203857
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 0.8950130939483643
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0552177429199219
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0097594261169434
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1417293548583984
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0393848419189453
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 23 cost time: 1.086197853088379
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 1.1057705879211426
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0036389827728271
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0042762756347656
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1821277141571045
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2020206451416016
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2107188701629639
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2191879749298096
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3112926483154297
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.061048984527588
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1236603260040283
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 34 cost time: 1.1179008483886719
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.070908784866333
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.136925458908081
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.281508445739746
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2235956192016602
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2557439804077148
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2576179504394531
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2495014667510986
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2192163467407227
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1737642288208008
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 99465
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.048644781112671
Epoch: 1, Steps: 17 | Train Loss: 2.079 Vali Loss: 1.362 Vali Acc: 0.741 Test Loss: 1.362 Test Acc: 0.741
Validation loss decreased (inf --> -0.740527).  Saving model ...
Epoch: 2 cost time: 1.743941068649292
Epoch: 2, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.472 Vali Acc: 0.895 Test Loss: 0.472 Test Acc: 0.895
Validation loss decreased (-0.740527 --> -0.894590).  Saving model ...
Epoch: 3 cost time: 1.829251766204834
Epoch: 3, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
Validation loss decreased (-0.894590 --> -0.921619).  Saving model ...
Epoch: 4 cost time: 1.7895944118499756
Epoch: 4, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
Validation loss decreased (-0.921619 --> -0.945944).  Saving model ...
Epoch: 5 cost time: 1.7677476406097412
Epoch: 5, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9451298713684082
Epoch: 6, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.7328987121582031
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6418869495391846
Epoch: 8, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8640179634094238
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7094132900238037
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8986961841583252
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7917466163635254
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7159645557403564
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8626306056976318
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.704986333847046
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8022277355194092
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 142409
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7059988975524902
Epoch: 1, Steps: 17 | Train Loss: 2.082 Vali Loss: 1.605 Vali Acc: 0.676 Test Loss: 1.605 Test Acc: 0.676
Validation loss decreased (inf --> -0.675660).  Saving model ...
Epoch: 2 cost time: 1.083432674407959
Epoch: 2, Steps: 17 | Train Loss: 1.290 Vali Loss: 0.808 Vali Acc: 0.870 Test Loss: 0.808 Test Acc: 0.870
Validation loss decreased (-0.675660 --> -0.870262).  Saving model ...
Epoch: 3 cost time: 1.0381929874420166
Epoch: 3, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.392 Vali Acc: 0.914 Test Loss: 0.392 Test Acc: 0.914
Validation loss decreased (-0.870262 --> -0.913510).  Saving model ...
Epoch: 4 cost time: 1.1021075248718262
Epoch: 4, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
Validation loss decreased (-0.913510 --> -0.921619).  Saving model ...
Epoch: 5 cost time: 1.1829311847686768
Epoch: 5, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
Validation loss decreased (-0.921619 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 1.1160502433776855
Epoch: 6, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
Validation loss decreased (-0.935133 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.1170706748962402
Epoch: 7, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.1869654655456543
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 1.1439745426177979
Epoch: 9, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1112847328186035
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 1.1127896308898926
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1207008361816406
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0740694999694824
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1822593212127686
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1173148155212402
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0961363315582275
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0322308540344238
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0875165462493896
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.038672685623169
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.031087875366211
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 94057
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6715872287750244
Epoch: 1, Steps: 17 | Train Loss: 2.176 Vali Loss: 1.805 Vali Acc: 0.468 Test Loss: 1.805 Test Acc: 0.468
Validation loss decreased (inf --> -0.467550).  Saving model ...
Epoch: 2 cost time: 1.1246840953826904
Epoch: 2, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.010 Vali Acc: 0.805 Test Loss: 1.010 Test Acc: 0.805
Validation loss decreased (-0.467550 --> -0.805395).  Saving model ...
Epoch: 3 cost time: 1.0926601886749268
Epoch: 3, Steps: 17 | Train Loss: 0.768 Vali Loss: 0.508 Vali Acc: 0.903 Test Loss: 0.508 Test Acc: 0.903
Validation loss decreased (-0.805395 --> -0.902698).  Saving model ...
Epoch: 4 cost time: 1.107790231704712
Epoch: 4, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
Validation loss decreased (-0.902698 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 1.2342219352722168
Epoch: 5, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.238 Vali Acc: 0.932 Test Loss: 0.238 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 6 cost time: 1.2219865322113037
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 1.204956293106079
Epoch: 7, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.213613748550415
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.269191026687622
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 1.2224068641662598
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.1938450336456299
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.248389482498169
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 13 cost time: 1.195002555847168
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 1.2188072204589844
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 1.2270238399505615
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 1.1875360012054443
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.251253366470337
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2601423263549805
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1991536617279053
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2434213161468506
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.183237075805664
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.216416358947754
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1888995170593262
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2985813617706299
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1891095638275146
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 76841
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.970146417617798
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 1.968 Vali Acc: 0.297 Test Loss: 1.968 Test Acc: 0.297
Validation loss decreased (inf --> -0.297278).  Saving model ...
Epoch: 2 cost time: 1.0226445198059082
Epoch: 2, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.149 Vali Acc: 0.786 Test Loss: 1.149 Test Acc: 0.786
Validation loss decreased (-0.297278 --> -0.786475).  Saving model ...
Epoch: 3 cost time: 1.1612701416015625
Epoch: 3, Steps: 17 | Train Loss: 0.910 Vali Loss: 0.662 Vali Acc: 0.843 Test Loss: 0.662 Test Acc: 0.843
Validation loss decreased (-0.786475 --> -0.843237).  Saving model ...
Epoch: 4 cost time: 1.2362735271453857
Epoch: 4, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.383 Vali Acc: 0.916 Test Loss: 0.383 Test Acc: 0.916
Validation loss decreased (-0.843237 --> -0.916212).  Saving model ...
Epoch: 5 cost time: 1.3835947513580322
Epoch: 5, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.279 Vali Acc: 0.924 Test Loss: 0.279 Test Acc: 0.924
Validation loss decreased (-0.916212 --> -0.924322).  Saving model ...
Epoch: 6 cost time: 1.3135459423065186
Epoch: 6, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
Validation loss decreased (-0.924322 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.2364590167999268
Epoch: 7, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.2895128726959229
Epoch: 8, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.2117741107940674
Epoch: 9, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1863822937011719
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3673932552337646
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 1.2689826488494873
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.167 Vali Acc: 0.938 Test Loss: 0.167 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.201350450515747
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4880802631378174
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0754897594451904
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2304821014404297
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 17 cost time: 0.9707603454589844
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1864397525787354
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.105313777923584
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0569396018981934
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1209282875061035
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 22 cost time: 1.1630380153656006
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1185874938964844
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1809897422790527
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.302391529083252
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.33662748336792
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2739884853363037
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3516409397125244
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.143596887588501
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1108043193817139
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.200075387954712
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 73417
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6835381984710693
Epoch: 1, Steps: 17 | Train Loss: 2.368 Vali Loss: 1.989 Vali Acc: 0.257 Test Loss: 1.989 Test Acc: 0.257
Validation loss decreased (inf --> -0.256737).  Saving model ...
Epoch: 2 cost time: 1.0837996006011963
Epoch: 2, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.338 Vali Acc: 0.805 Test Loss: 1.338 Test Acc: 0.805
Validation loss decreased (-0.256737 --> -0.805392).  Saving model ...
Epoch: 3 cost time: 1.088306188583374
Epoch: 3, Steps: 17 | Train Loss: 1.106 Vali Loss: 0.776 Vali Acc: 0.881 Test Loss: 0.776 Test Acc: 0.881
Validation loss decreased (-0.805392 --> -0.881073).  Saving model ...
Epoch: 4 cost time: 1.1201295852661133
Epoch: 4, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.445 Vali Acc: 0.908 Test Loss: 0.445 Test Acc: 0.908
Validation loss decreased (-0.881073 --> -0.908104).  Saving model ...
Epoch: 5 cost time: 1.0135700702667236
Epoch: 5, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.272 Vali Acc: 0.938 Test Loss: 0.272 Test Acc: 0.938
Validation loss decreased (-0.908104 --> -0.937835).  Saving model ...
Epoch: 6 cost time: 1.0494475364685059
Epoch: 6, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.1174302101135254
Epoch: 7, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.11277174949646
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1576144695281982
Epoch: 9, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.945944 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 1.0752370357513428
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0840480327606201
Epoch: 11, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1714777946472168
Epoch: 12, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1191716194152832
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1062231063842773
Epoch: 14, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1022875308990479
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0349688529968262
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1627249717712402
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.094010591506958
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1145594120025635
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 66569
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2743444442749023
Epoch: 1, Steps: 17 | Train Loss: 2.003 Vali Loss: 1.442 Vali Acc: 0.543 Test Loss: 1.442 Test Acc: 0.543
Validation loss decreased (inf --> -0.543229).  Saving model ...
Epoch: 2 cost time: 1.6745853424072266
Epoch: 2, Steps: 17 | Train Loss: 0.898 Vali Loss: 0.475 Vali Acc: 0.870 Test Loss: 0.475 Test Acc: 0.870
Validation loss decreased (-0.543229 --> -0.870266).  Saving model ...
Epoch: 3 cost time: 1.6695997714996338
Epoch: 3, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.303 Vali Acc: 0.892 Test Loss: 0.303 Test Acc: 0.892
Validation loss decreased (-0.870266 --> -0.891889).  Saving model ...
Epoch: 4 cost time: 1.5351142883300781
Epoch: 4, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
Validation loss decreased (-0.891889 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 1.987288475036621
Epoch: 5, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 1.439803123474121
Epoch: 6, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.434088945388794
Epoch: 7, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4434213638305664
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.941 Test Loss: 0.156 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.457451343536377
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8198506832122803
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5749685764312744
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 1.6449952125549316
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6632816791534424
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7627007961273193
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7004129886627197
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7567384243011475
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2362568378448486
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.793395757675171
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8486547470092773
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.918290138244629
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8187110424041748
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 125769
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5579922199249268
Epoch: 1, Steps: 17 | Train Loss: 2.152 Vali Loss: 1.680 Vali Acc: 0.543 Test Loss: 1.680 Test Acc: 0.543
Validation loss decreased (inf --> -0.543226).  Saving model ...
Epoch: 2 cost time: 1.2140228748321533
Epoch: 2, Steps: 17 | Train Loss: 1.352 Vali Loss: 0.862 Vali Acc: 0.857 Test Loss: 0.862 Test Acc: 0.857
Validation loss decreased (-0.543226 --> -0.856748).  Saving model ...
Epoch: 3 cost time: 1.1073307991027832
Epoch: 3, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.425 Vali Acc: 0.916 Test Loss: 0.425 Test Acc: 0.916
Validation loss decreased (-0.856748 --> -0.916212).  Saving model ...
Epoch: 4 cost time: 1.1302967071533203
Epoch: 4, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.264 Vali Acc: 0.938 Test Loss: 0.264 Test Acc: 0.938
Validation loss decreased (-0.916212 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 1.1320772171020508
Epoch: 5, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 1.1165239810943604
Epoch: 6, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.139857530593872
Epoch: 7, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.174295425415039
Epoch: 8, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.0894010066986084
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1199500560760498
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 1.1070103645324707
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0807669162750244
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.213550329208374
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.22175931930542
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.192631721496582
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1636455059051514
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2684454917907715
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0951788425445557
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1547067165374756
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1264114379882812
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0972166061401367
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0733890533447266
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 77417
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.965122938156128
Epoch: 1, Steps: 17 | Train Loss: 2.148 Vali Loss: 1.707 Vali Acc: 0.570 Test Loss: 1.707 Test Acc: 0.570
Validation loss decreased (inf --> -0.570253).  Saving model ...
Epoch: 2 cost time: 1.3662426471710205
Epoch: 2, Steps: 17 | Train Loss: 1.463 Vali Loss: 0.972 Vali Acc: 0.789 Test Loss: 0.972 Test Acc: 0.789
Validation loss decreased (-0.570253 --> -0.789179).  Saving model ...
Epoch: 3 cost time: 1.3752355575561523
Epoch: 3, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.505 Vali Acc: 0.886 Test Loss: 0.505 Test Acc: 0.886
Validation loss decreased (-0.789179 --> -0.886481).  Saving model ...
Epoch: 4 cost time: 1.255441427230835
Epoch: 4, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.310 Vali Acc: 0.932 Test Loss: 0.310 Test Acc: 0.932
Validation loss decreased (-0.886481 --> -0.932429).  Saving model ...
Epoch: 5 cost time: 1.297299861907959
Epoch: 5, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 6 cost time: 1.4093036651611328
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.189 Vali Acc: 0.946 Test Loss: 0.189 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.5298693180084229
Epoch: 7, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.3830218315124512
Epoch: 8, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.6191070079803467
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 1.6381890773773193
Epoch: 10, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.3457615375518799
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 1.2783353328704834
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5453782081604004
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.376333475112915
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2488844394683838
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3917982578277588
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2687721252441406
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.142967939376831
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5341317653656006
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5249278545379639
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5257232189178467
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 1.7044408321380615
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2936089038848877
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.40152907371521
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4987585544586182
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6158297061920166
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6980485916137695
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6029939651489258
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2935967445373535
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2547695636749268
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5687668323516846
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 60201
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0721027851104736
Epoch: 1, Steps: 17 | Train Loss: 2.155 Vali Loss: 1.834 Vali Acc: 0.470 Test Loss: 1.834 Test Acc: 0.470
Validation loss decreased (inf --> -0.470252).  Saving model ...
Epoch: 2 cost time: 1.4667060375213623
Epoch: 2, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.165 Vali Acc: 0.795 Test Loss: 1.165 Test Acc: 0.795
Validation loss decreased (-0.470252 --> -0.794583).  Saving model ...
Epoch: 3 cost time: 1.2243857383728027
Epoch: 3, Steps: 17 | Train Loss: 0.997 Vali Loss: 0.655 Vali Acc: 0.868 Test Loss: 0.655 Test Acc: 0.868
Validation loss decreased (-0.794583 --> -0.867561).  Saving model ...
Epoch: 4 cost time: 1.4574925899505615
Epoch: 4, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.401 Vali Acc: 0.905 Test Loss: 0.401 Test Acc: 0.905
Validation loss decreased (-0.867561 --> -0.905401).  Saving model ...
Epoch: 5 cost time: 1.241661548614502
Epoch: 5, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.279 Vali Acc: 0.935 Test Loss: 0.279 Test Acc: 0.935
Validation loss decreased (-0.905401 --> -0.935132).  Saving model ...
Epoch: 6 cost time: 1.2472186088562012
Epoch: 6, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935133).  Saving model ...
Epoch: 7 cost time: 1.3790991306304932
Epoch: 7, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.3186278343200684
Epoch: 8, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3179259300231934
Epoch: 9, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 1.2720491886138916
Epoch: 10, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1937150955200195
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.132810115814209
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4322996139526367
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 1.3841731548309326
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0547370910644531
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2217066287994385
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.112666130065918
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3014042377471924
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3573036193847656
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0683696269989014
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.302595615386963
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.12807297706604
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2097907066345215
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 56777
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.020613193511963
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 1.795 Vali Acc: 0.473 Test Loss: 1.795 Test Acc: 0.473
Validation loss decreased (inf --> -0.472955).  Saving model ...
Epoch: 2 cost time: 1.2397127151489258
Epoch: 2, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.164 Vali Acc: 0.805 Test Loss: 1.164 Test Acc: 0.805
Validation loss decreased (-0.472955 --> -0.805394).  Saving model ...
Epoch: 3 cost time: 1.321981430053711
Epoch: 3, Steps: 17 | Train Loss: 0.968 Vali Loss: 0.684 Vali Acc: 0.876 Test Loss: 0.684 Test Acc: 0.876
Validation loss decreased (-0.805394 --> -0.875669).  Saving model ...
Epoch: 4 cost time: 1.2880635261535645
Epoch: 4, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.425 Vali Acc: 0.916 Test Loss: 0.425 Test Acc: 0.916
Validation loss decreased (-0.875669 --> -0.916212).  Saving model ...
Epoch: 5 cost time: 1.1703808307647705
Epoch: 5, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.298 Vali Acc: 0.924 Test Loss: 0.298 Test Acc: 0.924
Validation loss decreased (-0.916212 --> -0.924321).  Saving model ...
Epoch: 6 cost time: 1.2613322734832764
Epoch: 6, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0573887825012207
Epoch: 7, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
Validation loss decreased (-0.924321 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.5968828201293945
Epoch: 8, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 1.4936366081237793
Epoch: 9, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.091569185256958
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.2543513774871826
Epoch: 11, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 1.3461792469024658
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2416491508483887
Epoch: 13, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3707597255706787
Epoch: 14, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 1.4334111213684082
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.2330472469329834
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3178954124450684
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3025567531585693
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2364251613616943
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.432558298110962
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2768733501434326
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.144897222518921
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0945253372192383
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.267134189605713
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.171574354171753
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 49929
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4179208278656006
Epoch: 1, Steps: 17 | Train Loss: 2.124 Vali Loss: 1.377 Vali Acc: 0.738 Test Loss: 1.377 Test Acc: 0.738
Validation loss decreased (inf --> -0.737824).  Saving model ...
Epoch: 2 cost time: 1.443380355834961
Epoch: 2, Steps: 17 | Train Loss: 0.913 Vali Loss: 0.462 Vali Acc: 0.905 Test Loss: 0.462 Test Acc: 0.905
Validation loss decreased (-0.737824 --> -0.905401).  Saving model ...
Epoch: 3 cost time: 1.4673092365264893
Epoch: 3, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.254 Vali Acc: 0.932 Test Loss: 0.254 Test Acc: 0.932
Validation loss decreased (-0.905401 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 1.9766016006469727
Epoch: 4, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 1.734029769897461
Epoch: 5, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.935133 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 1.487281084060669
Epoch: 6, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.5574932098388672
Epoch: 7, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 1.7584104537963867
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 1.8787508010864258
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 1.690481424331665
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6917319297790527
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8276174068450928
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8503594398498535
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7065486907958984
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5408334732055664
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.568556785583496
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6959776878356934
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5100605487823486
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5123894214630127
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 117449
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.810546875
Epoch: 1, Steps: 17 | Train Loss: 2.147 Vali Loss: 1.802 Vali Acc: 0.554 Test Loss: 1.802 Test Acc: 0.554
Validation loss decreased (inf --> -0.554036).  Saving model ...
Epoch: 2 cost time: 1.263566255569458
Epoch: 2, Steps: 17 | Train Loss: 1.452 Vali Loss: 0.993 Vali Acc: 0.811 Test Loss: 0.993 Test Acc: 0.811
Validation loss decreased (-0.554036 --> -0.810801).  Saving model ...
Epoch: 3 cost time: 1.253521203994751
Epoch: 3, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.504 Vali Acc: 0.908 Test Loss: 0.504 Test Acc: 0.908
Validation loss decreased (-0.810801 --> -0.908103).  Saving model ...
Epoch: 4 cost time: 1.1590890884399414
Epoch: 4, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.309 Vali Acc: 0.916 Test Loss: 0.309 Test Acc: 0.916
Validation loss decreased (-0.908103 --> -0.916213).  Saving model ...
Epoch: 5 cost time: 1.1691365242004395
Epoch: 5, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
Validation loss decreased (-0.916213 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.0809223651885986
Epoch: 6, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.145798921585083
Epoch: 7, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.2967212200164795
Epoch: 8, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.0452075004577637
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0877480506896973
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2148895263671875
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 1.2798659801483154
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1714603900909424
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 1.0715413093566895
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9814155101776123
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.125032901763916
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 1.0389208793640137
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.086106777191162
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2556047439575195
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 20 cost time: 1.0615081787109375
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1338372230529785
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.183408498764038
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1587085723876953
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9366569519042969
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.149794340133667
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2750625610351562
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0414938926696777
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0950839519500732
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2503151893615723
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 69097
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7543587684631348
Epoch: 1, Steps: 17 | Train Loss: 2.105 Vali Loss: 1.728 Vali Acc: 0.551 Test Loss: 1.728 Test Acc: 0.551
Validation loss decreased (inf --> -0.551334).  Saving model ...
Epoch: 2 cost time: 1.119842529296875
Epoch: 2, Steps: 17 | Train Loss: 1.387 Vali Loss: 0.973 Vali Acc: 0.846 Test Loss: 0.973 Test Acc: 0.846
Validation loss decreased (-0.551334 --> -0.845936).  Saving model ...
Epoch: 3 cost time: 1.110567569732666
Epoch: 3, Steps: 17 | Train Loss: 0.759 Vali Loss: 0.497 Vali Acc: 0.908 Test Loss: 0.497 Test Acc: 0.908
Validation loss decreased (-0.845936 --> -0.908103).  Saving model ...
Epoch: 4 cost time: 0.860069990158081
Epoch: 4, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.310 Vali Acc: 0.927 Test Loss: 0.310 Test Acc: 0.927
Validation loss decreased (-0.908103 --> -0.927024).  Saving model ...
Epoch: 5 cost time: 1.1447067260742188
Epoch: 5, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.235 Vali Acc: 0.935 Test Loss: 0.235 Test Acc: 0.935
Validation loss decreased (-0.927024 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 1.0820584297180176
Epoch: 6, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.1042356491088867
Epoch: 7, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.1366620063781738
Epoch: 8, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.1935393810272217
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1922385692596436
Epoch: 10, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 1.207937479019165
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0290868282318115
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.202686071395874
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.087613821029663
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0769250392913818
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.038825511932373
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0449607372283936
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1794393062591553
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0920279026031494
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2119100093841553
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3201985359191895
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.247375249862671
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1726384162902832
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.216465711593628
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2669615745544434
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 51881
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9687187671661377
Epoch: 1, Steps: 17 | Train Loss: 2.221 Vali Loss: 1.904 Vali Acc: 0.311 Test Loss: 1.904 Test Acc: 0.311
Validation loss decreased (inf --> -0.310792).  Saving model ...
Epoch: 2 cost time: 1.313297986984253
Epoch: 2, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.226 Vali Acc: 0.732 Test Loss: 1.226 Test Acc: 0.732
Validation loss decreased (-0.310792 --> -0.732420).  Saving model ...
Epoch: 3 cost time: 1.1816983222961426
Epoch: 3, Steps: 17 | Train Loss: 0.972 Vali Loss: 0.692 Vali Acc: 0.851 Test Loss: 0.692 Test Acc: 0.851
Validation loss decreased (-0.732420 --> -0.851344).  Saving model ...
Epoch: 4 cost time: 1.014186143875122
Epoch: 4, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.435 Vali Acc: 0.889 Test Loss: 0.435 Test Acc: 0.889
Validation loss decreased (-0.851344 --> -0.889185).  Saving model ...
Epoch: 5 cost time: 1.1682350635528564
Epoch: 5, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.296 Vali Acc: 0.927 Test Loss: 0.296 Test Acc: 0.927
Validation loss decreased (-0.889185 --> -0.927024).  Saving model ...
Epoch: 6 cost time: 1.2369320392608643
Epoch: 6, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
Validation loss decreased (-0.927024 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 1.1367428302764893
Epoch: 7, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.204 Vali Acc: 0.946 Test Loss: 0.204 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.2645773887634277
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.1884331703186035
Epoch: 9, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.2621829509735107
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.1804466247558594
Epoch: 11, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2329509258270264
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.168 Vali Acc: 0.938 Test Loss: 0.168 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1140410900115967
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2751224040985107
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2298388481140137
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4110591411590576
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4708309173583984
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2546594142913818
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3083748817443848
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 20 cost time: 1.4357452392578125
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1092028617858887
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.115525484085083
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3010156154632568
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4026615619659424
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.364924430847168
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2973155975341797
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3949389457702637
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.429455280303955
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.275475263595581
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 48457
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1018168926239014
Epoch: 1, Steps: 17 | Train Loss: 2.169 Vali Loss: 1.867 Vali Acc: 0.381 Test Loss: 1.867 Test Acc: 0.381
Validation loss decreased (inf --> -0.381062).  Saving model ...
Epoch: 2 cost time: 1.182210922241211
Epoch: 2, Steps: 17 | Train Loss: 1.652 Vali Loss: 1.233 Vali Acc: 0.795 Test Loss: 1.233 Test Acc: 0.795
Validation loss decreased (-0.381062 --> -0.794582).  Saving model ...
Epoch: 3 cost time: 1.2887985706329346
Epoch: 3, Steps: 17 | Train Loss: 1.080 Vali Loss: 0.739 Vali Acc: 0.892 Test Loss: 0.739 Test Acc: 0.892
Validation loss decreased (-0.794582 --> -0.891884).  Saving model ...
Epoch: 4 cost time: 1.4375793933868408
Epoch: 4, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.439 Vali Acc: 0.916 Test Loss: 0.439 Test Acc: 0.916
Validation loss decreased (-0.891884 --> -0.916212).  Saving model ...
Epoch: 5 cost time: 1.3128786087036133
Epoch: 5, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.311 Vali Acc: 0.930 Test Loss: 0.311 Test Acc: 0.930
Validation loss decreased (-0.916212 --> -0.929727).  Saving model ...
Epoch: 6 cost time: 1.2084872722625732
Epoch: 6, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.237 Vali Acc: 0.938 Test Loss: 0.237 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937835).  Saving model ...
Epoch: 7 cost time: 1.254328727722168
Epoch: 7, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.327373743057251
Epoch: 8, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.372959852218628
Epoch: 9, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 1.1438157558441162
Epoch: 10, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 1.0708367824554443
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.061047077178955
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1270484924316406
Epoch: 13, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3503777980804443
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.417574167251587
Epoch: 15, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.34065580368042
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1588199138641357
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.181783676147461
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 1.2097196578979492
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4032361507415771
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1658668518066406
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3808846473693848
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2500646114349365
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.295607328414917
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2747306823730469
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.160588264465332
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1666438579559326
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1478099822998047
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 41609
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.080629348754883
Epoch: 1, Steps: 17 | Train Loss: 2.172 Vali Loss: 1.738 Vali Acc: 0.559 Test Loss: 1.738 Test Acc: 0.559
Validation loss decreased (inf --> -0.559442).  Saving model ...
Epoch: 2 cost time: 1.1724040508270264
Epoch: 2, Steps: 17 | Train Loss: 1.448 Vali Loss: 0.948 Vali Acc: 0.868 Test Loss: 0.948 Test Acc: 0.868
Validation loss decreased (-0.559442 --> -0.867558).  Saving model ...
Epoch: 3 cost time: 1.3434491157531738
Epoch: 3, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.438 Vali Acc: 0.911 Test Loss: 0.438 Test Acc: 0.911
Validation loss decreased (-0.867558 --> -0.910806).  Saving model ...
Epoch: 4 cost time: 1.301346778869629
Epoch: 4, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.268 Vali Acc: 0.916 Test Loss: 0.268 Test Acc: 0.916
Validation loss decreased (-0.910806 --> -0.916214).  Saving model ...
Epoch: 5 cost time: 1.3418159484863281
Epoch: 5, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.215 Vali Acc: 0.932 Test Loss: 0.215 Test Acc: 0.932
Validation loss decreased (-0.916214 --> -0.932430).  Saving model ...
Epoch: 6 cost time: 1.5880703926086426
Epoch: 6, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.180 Vali Acc: 0.938 Test Loss: 0.180 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 7 cost time: 1.3179082870483398
Epoch: 7, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.1735353469848633
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2024929523468018
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2890472412109375
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.3128011226654053
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2951891422271729
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3351304531097412
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3922357559204102
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.932 Test Loss: 0.168 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3093500137329102
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4220187664031982
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.150 Vali Acc: 0.946 Test Loss: 0.150 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5367982387542725
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3459980487823486
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2280282974243164
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 1.1756861209869385
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1298792362213135
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4720826148986816
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4047555923461914
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3357081413269043
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6373441219329834
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5865757465362549
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5715124607086182
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4038407802581787
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3968160152435303
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 69417
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.919727325439453
Epoch: 1, Steps: 17 | Train Loss: 2.287 Vali Loss: 1.988 Vali Acc: 0.359 Test Loss: 1.988 Test Acc: 0.359
Validation loss decreased (inf --> -0.359440).  Saving model ...
Epoch: 2 cost time: 1.2898876667022705
Epoch: 2, Steps: 17 | Train Loss: 1.778 Vali Loss: 1.351 Vali Acc: 0.727 Test Loss: 1.351 Test Acc: 0.727
Validation loss decreased (-0.359440 --> -0.727014).  Saving model ...
Epoch: 3 cost time: 1.1826624870300293
Epoch: 3, Steps: 17 | Train Loss: 1.168 Vali Loss: 0.789 Vali Acc: 0.854 Test Loss: 0.789 Test Acc: 0.854
Validation loss decreased (-0.727014 --> -0.854046).  Saving model ...
Epoch: 4 cost time: 1.3241536617279053
Epoch: 4, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.439 Vali Acc: 0.919 Test Loss: 0.439 Test Acc: 0.919
Validation loss decreased (-0.854046 --> -0.918915).  Saving model ...
Epoch: 5 cost time: 1.2922074794769287
Epoch: 5, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.297 Vali Acc: 0.927 Test Loss: 0.297 Test Acc: 0.927
Validation loss decreased (-0.918915 --> -0.927024).  Saving model ...
Epoch: 6 cost time: 1.246825933456421
Epoch: 6, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.927024 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 1.3032429218292236
Epoch: 7, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.200 Vali Acc: 0.938 Test Loss: 0.200 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4157402515411377
Epoch: 8, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.332085132598877
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.285783290863037
Epoch: 10, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.2741048336029053
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.501215934753418
Epoch: 12, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.577460527420044
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.441091537475586
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.422461748123169
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5620019435882568
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4901704788208008
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.941 Test Loss: 0.159 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2673377990722656
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3942828178405762
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4205496311187744
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 45241
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.099006414413452
Epoch: 1, Steps: 17 | Train Loss: 2.183 Vali Loss: 1.903 Vali Acc: 0.376 Test Loss: 1.903 Test Acc: 0.376
Validation loss decreased (inf --> -0.375657).  Saving model ...
Epoch: 2 cost time: 1.279742956161499
Epoch: 2, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.421 Vali Acc: 0.684 Test Loss: 1.421 Test Acc: 0.684
Validation loss decreased (-0.375657 --> -0.683770).  Saving model ...
Epoch: 3 cost time: 1.5304677486419678
Epoch: 3, Steps: 17 | Train Loss: 1.285 Vali Loss: 0.953 Vali Acc: 0.865 Test Loss: 0.953 Test Acc: 0.865
Validation loss decreased (-0.683770 --> -0.864855).  Saving model ...
Epoch: 4 cost time: 1.392160415649414
Epoch: 4, Steps: 17 | Train Loss: 0.823 Vali Loss: 0.588 Vali Acc: 0.903 Test Loss: 0.588 Test Acc: 0.903
Validation loss decreased (-0.864855 --> -0.902697).  Saving model ...
Epoch: 5 cost time: 1.499582052230835
Epoch: 5, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.407 Vali Acc: 0.924 Test Loss: 0.407 Test Acc: 0.924
Validation loss decreased (-0.902697 --> -0.924320).  Saving model ...
Epoch: 6 cost time: 1.5297999382019043
Epoch: 6, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.299 Vali Acc: 0.927 Test Loss: 0.299 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927024).  Saving model ...
Epoch: 7 cost time: 1.2937061786651611
Epoch: 7, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.248 Vali Acc: 0.932 Test Loss: 0.248 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 8 cost time: 1.522613286972046
Epoch: 8, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.217 Vali Acc: 0.938 Test Loss: 0.217 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 9 cost time: 1.1219089031219482
Epoch: 9, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0561673641204834
Epoch: 10, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 11 cost time: 1.2464172840118408
Epoch: 11, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 12 cost time: 1.2534523010253906
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.379612922668457
Epoch: 13, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.173 Vali Acc: 0.938 Test Loss: 0.173 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 14 cost time: 1.4796671867370605
Epoch: 14, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 15 cost time: 1.3618040084838867
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 16 cost time: 1.2983059883117676
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.352013349533081
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2646243572235107
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.388153314590454
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 1.3421165943145752
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2960097789764404
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2582616806030273
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3026700019836426
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2687289714813232
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3878178596496582
Epoch: 25, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4409360885620117
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 27 cost time: 1.6035542488098145
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5442373752593994
Epoch: 28, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4194691181182861
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4947617053985596
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5055978298187256
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4192731380462646
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3764770030975342
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3302857875823975
Epoch: 34, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1905755996704102
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.4451055526733398
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 36633
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9801368713378906
Epoch: 1, Steps: 17 | Train Loss: 2.313 Vali Loss: 2.175 Vali Acc: 0.208 Test Loss: 2.175 Test Acc: 0.208
Validation loss decreased (inf --> -0.208086).  Saving model ...
Epoch: 2 cost time: 1.244391918182373
Epoch: 2, Steps: 17 | Train Loss: 1.947 Vali Loss: 1.713 Vali Acc: 0.581 Test Loss: 1.713 Test Acc: 0.581
Validation loss decreased (-0.208086 --> -0.581064).  Saving model ...
Epoch: 3 cost time: 1.3095874786376953
Epoch: 3, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.232 Vali Acc: 0.757 Test Loss: 1.232 Test Acc: 0.757
Validation loss decreased (-0.581064 --> -0.756744).  Saving model ...
Epoch: 4 cost time: 1.2351057529449463
Epoch: 4, Steps: 17 | Train Loss: 1.010 Vali Loss: 0.807 Vali Acc: 0.843 Test Loss: 0.807 Test Acc: 0.843
Validation loss decreased (-0.756744 --> -0.843235).  Saving model ...
Epoch: 5 cost time: 1.3216633796691895
Epoch: 5, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.521 Vali Acc: 0.884 Test Loss: 0.521 Test Acc: 0.884
Validation loss decreased (-0.843235 --> -0.883779).  Saving model ...
Epoch: 6 cost time: 1.381087303161621
Epoch: 6, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.378 Vali Acc: 0.908 Test Loss: 0.378 Test Acc: 0.908
Validation loss decreased (-0.883779 --> -0.908104).  Saving model ...
Epoch: 7 cost time: 1.2584538459777832
Epoch: 7, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.299 Vali Acc: 0.927 Test Loss: 0.299 Test Acc: 0.927
Validation loss decreased (-0.908104 --> -0.927024).  Saving model ...
Epoch: 8 cost time: 1.1395010948181152
Epoch: 8, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.256 Vali Acc: 0.924 Test Loss: 0.256 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3062257766723633
Epoch: 9, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 10 cost time: 1.3406639099121094
Epoch: 10, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.217 Vali Acc: 0.927 Test Loss: 0.217 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4640719890594482
Epoch: 11, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 12 cost time: 1.4210996627807617
Epoch: 12, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
Validation loss decreased (-0.932430 --> -0.943241).  Saving model ...
Epoch: 13 cost time: 1.3698108196258545
Epoch: 13, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.360497236251831
Epoch: 14, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3993277549743652
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 16 cost time: 1.6123309135437012
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 17 cost time: 1.5073275566101074
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 1.516533374786377
Epoch: 18, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5374424457550049
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.391890287399292
Epoch: 20, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 1.4519274234771729
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 1.3869755268096924
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4331209659576416
Epoch: 23, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4186968803405762
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3920040130615234
Epoch: 25, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 26 cost time: 1.6240370273590088
Epoch: 26, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.579286813735962
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5279755592346191
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.49576997756958
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 30 cost time: 1.4639678001403809
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.568080186843872
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 32 cost time: 1.587224006652832
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4985432624816895
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 34 cost time: 1.400200366973877
Epoch: 34, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.327932596206665
Epoch: 35, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2546968460083008
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4340176582336426
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 38 cost time: 1.3188471794128418
Epoch: 38, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5972344875335693
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4168710708618164
Epoch: 40, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 41 cost time: 1.5895812511444092
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5944290161132812
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4851529598236084
Epoch: 43, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.4477295875549316
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.339181661605835
Epoch: 45, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 46 cost time: 1.5309677124023438
Epoch: 46, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 47 cost time: 1.4729785919189453
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3640611171722412
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.4692633152008057
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.5511438846588135
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.611283540725708
Epoch: 51, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.6438062191009521
Epoch: 52, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.587907075881958
Epoch: 53, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 54 cost time: 1.8049983978271484
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.6513843536376953
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.555922269821167
Epoch: 56, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.5695860385894775
Epoch: 57, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.6353423595428467
Epoch: 58, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.7135276794433594
Epoch: 59, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.7000601291656494
Epoch: 60, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.6737112998962402
Epoch: 61, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.6361494064331055
Epoch: 62, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.4886610507965088
Epoch: 63, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 34921
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.218822479248047
Epoch: 1, Steps: 17 | Train Loss: 2.186 Vali Loss: 2.002 Vali Acc: 0.278 Test Loss: 2.002 Test Acc: 0.278
Validation loss decreased (inf --> -0.278358).  Saving model ...
Epoch: 2 cost time: 1.5323920249938965
Epoch: 2, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.635 Vali Acc: 0.597 Test Loss: 1.635 Test Acc: 0.597
Validation loss decreased (-0.278358 --> -0.597281).  Saving model ...
Epoch: 3 cost time: 1.4584035873413086
Epoch: 3, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.249 Vali Acc: 0.784 Test Loss: 1.249 Test Acc: 0.784
Validation loss decreased (-0.597281 --> -0.783771).  Saving model ...
Epoch: 4 cost time: 1.5045890808105469
Epoch: 4, Steps: 17 | Train Loss: 1.136 Vali Loss: 0.873 Vali Acc: 0.859 Test Loss: 0.873 Test Acc: 0.859
Validation loss decreased (-0.783771 --> -0.859451).  Saving model ...
Epoch: 5 cost time: 1.6662554740905762
Epoch: 5, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.602 Vali Acc: 0.895 Test Loss: 0.602 Test Acc: 0.895
Validation loss decreased (-0.859451 --> -0.894589).  Saving model ...
Epoch: 6 cost time: 1.4523160457611084
Epoch: 6, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.419 Vali Acc: 0.914 Test Loss: 0.419 Test Acc: 0.914
Validation loss decreased (-0.894589 --> -0.913509).  Saving model ...
Epoch: 7 cost time: 1.4050836563110352
Epoch: 7, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.339 Vali Acc: 0.914 Test Loss: 0.339 Test Acc: 0.914
Validation loss decreased (-0.913509 --> -0.913510).  Saving model ...
Epoch: 8 cost time: 1.3995110988616943
Epoch: 8, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.287 Vali Acc: 0.924 Test Loss: 0.287 Test Acc: 0.924
Validation loss decreased (-0.913510 --> -0.924321).  Saving model ...
Epoch: 9 cost time: 1.5497043132781982
Epoch: 9, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
Validation loss decreased (-0.924321 --> -0.935133).  Saving model ...
Epoch: 10 cost time: 1.5661582946777344
Epoch: 10, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.223 Vali Acc: 0.938 Test Loss: 0.223 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 11 cost time: 1.671247959136963
Epoch: 11, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 12 cost time: 1.6520333290100098
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4177052974700928
Epoch: 13, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.500727653503418
Epoch: 14, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6187310218811035
Epoch: 15, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.591498613357544
Epoch: 16, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 17 cost time: 1.4823472499847412
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 18 cost time: 1.3864264488220215
Epoch: 18, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 19 cost time: 1.2600767612457275
Epoch: 19, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.170 Vali Acc: 0.935 Test Loss: 0.170 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3912508487701416
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2361154556274414
Epoch: 21, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3867652416229248
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3675799369812012
Epoch: 23, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.50351881980896
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 25 cost time: 1.5090410709381104
Epoch: 25, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3122353553771973
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.401834487915039
Epoch: 27, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4279062747955322
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3218746185302734
Epoch: 29, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4433934688568115
Epoch: 30, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3446433544158936
Epoch: 31, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3453867435455322
Epoch: 32, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4465293884277344
Epoch: 33, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.486816644668579
Epoch: 34, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 31497
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0226175785064697
Epoch: 1, Steps: 17 | Train Loss: 2.166 Vali Loss: 1.743 Vali Acc: 0.643 Test Loss: 1.743 Test Acc: 0.643
Validation loss decreased (inf --> -0.643226).  Saving model ...
Epoch: 2 cost time: 1.4287598133087158
Epoch: 2, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.013 Vali Acc: 0.835 Test Loss: 1.013 Test Acc: 0.835
Validation loss decreased (-0.643226 --> -0.835125).  Saving model ...
Epoch: 3 cost time: 1.3134477138519287
Epoch: 3, Steps: 17 | Train Loss: 0.816 Vali Loss: 0.503 Vali Acc: 0.895 Test Loss: 0.503 Test Acc: 0.895
Validation loss decreased (-0.835125 --> -0.894590).  Saving model ...
Epoch: 4 cost time: 1.3078758716583252
Epoch: 4, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.321 Vali Acc: 0.935 Test Loss: 0.321 Test Acc: 0.935
Validation loss decreased (-0.894590 --> -0.935132).  Saving model ...
Epoch: 5 cost time: 1.4079594612121582
Epoch: 5, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.217 Vali Acc: 0.927 Test Loss: 0.217 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6045303344726562
Epoch: 6, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.5175607204437256
Epoch: 7, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4620697498321533
Epoch: 8, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.3991100788116455
Epoch: 9, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.945944 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 1.662738561630249
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5820684432983398
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4120192527770996
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3418965339660645
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.430929183959961
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5129282474517822
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5285661220550537
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.55267333984375
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5115470886230469
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4928429126739502
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 60969
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2711150646209717
Epoch: 1, Steps: 17 | Train Loss: 2.229 Vali Loss: 2.066 Vali Acc: 0.273 Test Loss: 2.066 Test Acc: 0.273
Validation loss decreased (inf --> -0.272952).  Saving model ...
Epoch: 2 cost time: 1.3662657737731934
Epoch: 2, Steps: 17 | Train Loss: 1.774 Vali Loss: 1.427 Vali Acc: 0.719 Test Loss: 1.427 Test Acc: 0.719
Validation loss decreased (-0.272952 --> -0.718905).  Saving model ...
Epoch: 3 cost time: 1.3355252742767334
Epoch: 3, Steps: 17 | Train Loss: 1.224 Vali Loss: 0.868 Vali Acc: 0.857 Test Loss: 0.868 Test Acc: 0.857
Validation loss decreased (-0.718905 --> -0.856748).  Saving model ...
Epoch: 4 cost time: 1.3917927742004395
Epoch: 4, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.517 Vali Acc: 0.884 Test Loss: 0.517 Test Acc: 0.884
Validation loss decreased (-0.856748 --> -0.883779).  Saving model ...
Epoch: 5 cost time: 1.2693812847137451
Epoch: 5, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.355 Vali Acc: 0.916 Test Loss: 0.355 Test Acc: 0.916
Validation loss decreased (-0.883779 --> -0.916213).  Saving model ...
Epoch: 6 cost time: 1.299389362335205
Epoch: 6, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.260 Vali Acc: 0.932 Test Loss: 0.260 Test Acc: 0.932
Validation loss decreased (-0.916213 --> -0.932430).  Saving model ...
Epoch: 7 cost time: 1.1153936386108398
Epoch: 7, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940538).  Saving model ...
Epoch: 8 cost time: 1.191438913345337
Epoch: 8, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.4353070259094238
Epoch: 9, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.210153579711914
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4539611339569092
Epoch: 11, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 1.3891429901123047
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4318082332611084
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 1.3161094188690186
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2063682079315186
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1367464065551758
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1360690593719482
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 18 cost time: 1.0520119667053223
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3341333866119385
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3268449306488037
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2070591449737549
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2957124710083008
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2340443134307861
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4327945709228516
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1916618347167969
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3091204166412354
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.454960823059082
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 36793
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0092639923095703
Epoch: 1, Steps: 17 | Train Loss: 2.199 Vali Loss: 1.898 Vali Acc: 0.335 Test Loss: 1.898 Test Acc: 0.335
Validation loss decreased (inf --> -0.335116).  Saving model ...
Epoch: 2 cost time: 1.2997241020202637
Epoch: 2, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.430 Vali Acc: 0.732 Test Loss: 1.430 Test Acc: 0.732
Validation loss decreased (-0.335116 --> -0.732418).  Saving model ...
Epoch: 3 cost time: 1.3376598358154297
Epoch: 3, Steps: 17 | Train Loss: 1.264 Vali Loss: 0.956 Vali Acc: 0.854 Test Loss: 0.956 Test Acc: 0.854
Validation loss decreased (-0.732418 --> -0.854044).  Saving model ...
Epoch: 4 cost time: 1.2324154376983643
Epoch: 4, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.608 Vali Acc: 0.878 Test Loss: 0.608 Test Acc: 0.878
Validation loss decreased (-0.854044 --> -0.878372).  Saving model ...
Epoch: 5 cost time: 1.2705192565917969
Epoch: 5, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.423 Vali Acc: 0.903 Test Loss: 0.423 Test Acc: 0.903
Validation loss decreased (-0.878372 --> -0.902698).  Saving model ...
Epoch: 6 cost time: 1.288649320602417
Epoch: 6, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.316 Vali Acc: 0.914 Test Loss: 0.316 Test Acc: 0.914
Validation loss decreased (-0.902698 --> -0.913510).  Saving model ...
Epoch: 7 cost time: 1.217207431793213
Epoch: 7, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.256 Vali Acc: 0.927 Test Loss: 0.256 Test Acc: 0.927
Validation loss decreased (-0.913510 --> -0.927024).  Saving model ...
Epoch: 8 cost time: 1.232018232345581
Epoch: 8, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3066139221191406
Epoch: 9, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.927024 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 1.3036134243011475
Epoch: 10, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 11 cost time: 1.207953929901123
Epoch: 11, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 12 cost time: 1.2152323722839355
Epoch: 12, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.185 Vali Acc: 0.938 Test Loss: 0.185 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2436084747314453
Epoch: 13, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 1.1039798259735107
Epoch: 14, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1588802337646484
Epoch: 15, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3478384017944336
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2384121417999268
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3910059928894043
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3279783725738525
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2545418739318848
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2931280136108398
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2647433280944824
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3425145149230957
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 28185
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.216952085494995
Epoch: 1, Steps: 17 | Train Loss: 2.340 Vali Loss: 2.150 Vali Acc: 0.165 Test Loss: 2.150 Test Acc: 0.165
Validation loss decreased (inf --> -0.164843).  Saving model ...
Epoch: 2 cost time: 1.165198564529419
Epoch: 2, Steps: 17 | Train Loss: 1.995 Vali Loss: 1.721 Vali Acc: 0.495 Test Loss: 1.721 Test Acc: 0.495
Validation loss decreased (-0.164843 --> -0.494577).  Saving model ...
Epoch: 3 cost time: 1.0452139377593994
Epoch: 3, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.241 Vali Acc: 0.776 Test Loss: 1.241 Test Acc: 0.776
Validation loss decreased (-0.494577 --> -0.775663).  Saving model ...
Epoch: 4 cost time: 1.1531317234039307
Epoch: 4, Steps: 17 | Train Loss: 1.087 Vali Loss: 0.835 Vali Acc: 0.859 Test Loss: 0.835 Test Acc: 0.859
Validation loss decreased (-0.775663 --> -0.859451).  Saving model ...
Epoch: 5 cost time: 1.1745929718017578
Epoch: 5, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.569 Vali Acc: 0.897 Test Loss: 0.569 Test Acc: 0.897
Validation loss decreased (-0.859451 --> -0.897292).  Saving model ...
Epoch: 6 cost time: 1.2887341976165771
Epoch: 6, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.394 Vali Acc: 0.914 Test Loss: 0.394 Test Acc: 0.914
Validation loss decreased (-0.897292 --> -0.913510).  Saving model ...
Epoch: 7 cost time: 1.2233774662017822
Epoch: 7, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
Validation loss decreased (-0.913510 --> -0.921618).  Saving model ...
Epoch: 8 cost time: 1.2698712348937988
Epoch: 8, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.921618 --> -0.940538).  Saving model ...
Epoch: 9 cost time: 1.1865622997283936
Epoch: 9, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2141132354736328
Epoch: 10, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 11 cost time: 1.1941554546356201
Epoch: 11, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 12 cost time: 1.203381061553955
Epoch: 12, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 13 cost time: 1.2182328701019287
Epoch: 13, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1557321548461914
Epoch: 14, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1502883434295654
Epoch: 15, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 1.2152228355407715
Epoch: 16, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0713682174682617
Epoch: 17, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2893173694610596
Epoch: 18, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.938 Test Loss: 0.162 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2798404693603516
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2963175773620605
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2628870010375977
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.160 Vali Acc: 0.938 Test Loss: 0.160 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.189978837966919
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1162736415863037
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.103754997253418
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.161444902420044
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 26473
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.861478805541992
Epoch: 1, Steps: 17 | Train Loss: 2.115 Vali Loss: 1.905 Vali Acc: 0.327 Test Loss: 1.905 Test Acc: 0.327
Validation loss decreased (inf --> -0.327008).  Saving model ...
Epoch: 2 cost time: 1.2989223003387451
Epoch: 2, Steps: 17 | Train Loss: 1.857 Vali Loss: 1.579 Vali Acc: 0.630 Test Loss: 1.579 Test Acc: 0.630
Validation loss decreased (-0.327008 --> -0.629714).  Saving model ...
Epoch: 3 cost time: 1.4639828205108643
Epoch: 3, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.226 Vali Acc: 0.762 Test Loss: 1.226 Test Acc: 0.762
Validation loss decreased (-0.629714 --> -0.762150).  Saving model ...
Epoch: 4 cost time: 1.2480010986328125
Epoch: 4, Steps: 17 | Train Loss: 1.121 Vali Loss: 0.876 Vali Acc: 0.827 Test Loss: 0.876 Test Acc: 0.827
Validation loss decreased (-0.762150 --> -0.827018).  Saving model ...
Epoch: 5 cost time: 1.2230257987976074
Epoch: 5, Steps: 17 | Train Loss: 0.785 Vali Loss: 0.592 Vali Acc: 0.876 Test Loss: 0.592 Test Acc: 0.876
Validation loss decreased (-0.827018 --> -0.875670).  Saving model ...
Epoch: 6 cost time: 1.3675956726074219
Epoch: 6, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.438 Vali Acc: 0.903 Test Loss: 0.438 Test Acc: 0.903
Validation loss decreased (-0.875670 --> -0.902698).  Saving model ...
Epoch: 7 cost time: 1.4514720439910889
Epoch: 7, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.330 Vali Acc: 0.924 Test Loss: 0.330 Test Acc: 0.924
Validation loss decreased (-0.902698 --> -0.924321).  Saving model ...
Epoch: 8 cost time: 1.250304937362671
Epoch: 8, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.277 Vali Acc: 0.938 Test Loss: 0.277 Test Acc: 0.938
Validation loss decreased (-0.924321 --> -0.937835).  Saving model ...
Epoch: 9 cost time: 1.3074700832366943
Epoch: 9, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.246 Vali Acc: 0.946 Test Loss: 0.246 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945943).  Saving model ...
Epoch: 10 cost time: 1.3947947025299072
Epoch: 10, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4097466468811035
Epoch: 11, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.406477451324463
Epoch: 12, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4477636814117432
Epoch: 13, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6196882724761963
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3072640895843506
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4100589752197266
Epoch: 16, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 17 cost time: 1.5004374980926514
Epoch: 17, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5622167587280273
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 19 cost time: 1.4248931407928467
Epoch: 19, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.599158763885498
Epoch: 20, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4799134731292725
Epoch: 21, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5673232078552246
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.542875051498413
Epoch: 23, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3895514011383057
Epoch: 24, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 25 cost time: 1.5440301895141602
Epoch: 25, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6120810508728027
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.652186393737793
Epoch: 27, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6793644428253174
Epoch: 28, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.751086711883545
Epoch: 29, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.946 Test Loss: 0.144 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6321802139282227
Epoch: 30, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5695092678070068
Epoch: 31, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.4198410511016846
Epoch: 32, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.784278392791748
Epoch: 33, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.629089593887329
Epoch: 34, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 23049
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2920892238616943
Epoch: 1, Steps: 17 | Train Loss: 2.234 Vali Loss: 1.798 Vali Acc: 0.522 Test Loss: 1.798 Test Acc: 0.522
Validation loss decreased (inf --> -0.521604).  Saving model ...
Epoch: 2 cost time: 1.4228441715240479
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 0.978 Vali Acc: 0.841 Test Loss: 0.978 Test Acc: 0.841
Validation loss decreased (-0.521604 --> -0.840531).  Saving model ...
Epoch: 3 cost time: 1.8066880702972412
Epoch: 3, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.509 Vali Acc: 0.914 Test Loss: 0.509 Test Acc: 0.914
Validation loss decreased (-0.840531 --> -0.913508).  Saving model ...
Epoch: 4 cost time: 1.7200119495391846
Epoch: 4, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
Validation loss decreased (-0.913508 --> -0.921619).  Saving model ...
Epoch: 5 cost time: 1.4254059791564941
Epoch: 5, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.243 Vali Acc: 0.927 Test Loss: 0.243 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927025).  Saving model ...
Epoch: 6 cost time: 1.457312822341919
Epoch: 6, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.927025 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 1.390336275100708
Epoch: 7, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.167 Vali Acc: 0.938 Test Loss: 0.167 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6193594932556152
Epoch: 8, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.953972578048706
Epoch: 9, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 2.0947399139404297
Epoch: 10, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 1.723351240158081
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8049793243408203
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8036508560180664
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.665052890777588
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9172604084014893
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9030814170837402
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7373104095458984
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6036465167999268
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7960209846496582
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.601761817932129
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 56745
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4411301612854004
Epoch: 1, Steps: 17 | Train Loss: 2.259 Vali Loss: 1.968 Vali Acc: 0.308 Test Loss: 1.968 Test Acc: 0.308
Validation loss decreased (inf --> -0.308088).  Saving model ...
Epoch: 2 cost time: 1.3521184921264648
Epoch: 2, Steps: 17 | Train Loss: 1.742 Vali Loss: 1.352 Vali Acc: 0.765 Test Loss: 1.352 Test Acc: 0.765
Validation loss decreased (-0.308088 --> -0.764851).  Saving model ...
Epoch: 3 cost time: 1.6443252563476562
Epoch: 3, Steps: 17 | Train Loss: 1.149 Vali Loss: 0.848 Vali Acc: 0.835 Test Loss: 0.848 Test Acc: 0.835
Validation loss decreased (-0.764851 --> -0.835127).  Saving model ...
Epoch: 4 cost time: 1.5922636985778809
Epoch: 4, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.523 Vali Acc: 0.892 Test Loss: 0.523 Test Acc: 0.892
Validation loss decreased (-0.835127 --> -0.891887).  Saving model ...
Epoch: 5 cost time: 1.8039352893829346
Epoch: 5, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
Validation loss decreased (-0.891887 --> -0.902699).  Saving model ...
Epoch: 6 cost time: 1.9295613765716553
Epoch: 6, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
Validation loss decreased (-0.902699 --> -0.935132).  Saving model ...
Epoch: 7 cost time: 1.881397008895874
Epoch: 7, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 8 cost time: 1.8914530277252197
Epoch: 8, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.210 Vali Acc: 0.938 Test Loss: 0.210 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8175253868103027
Epoch: 9, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 1.778857946395874
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 1.7273683547973633
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 1.7885634899139404
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7894086837768555
Epoch: 13, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 1.664963722229004
Epoch: 14, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7219972610473633
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7076845169067383
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 1.7083652019500732
Epoch: 17, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.617751121520996
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7961716651916504
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7488691806793213
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.844282865524292
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 22 cost time: 1.7107172012329102
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7702481746673584
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.709679365158081
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.543731689453125
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7035090923309326
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6017043590545654
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.775298833847046
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6191256046295166
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6401679515838623
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6849892139434814
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 32569
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4168829917907715
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.015 Vali Acc: 0.251 Test Loss: 2.015 Test Acc: 0.251
Validation loss decreased (inf --> -0.251331).  Saving model ...
Epoch: 2 cost time: 1.5110068321228027
Epoch: 2, Steps: 17 | Train Loss: 1.772 Vali Loss: 1.520 Vali Acc: 0.627 Test Loss: 1.520 Test Acc: 0.627
Validation loss decreased (-0.251331 --> -0.627012).  Saving model ...
Epoch: 3 cost time: 1.4394145011901855
Epoch: 3, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.013 Vali Acc: 0.805 Test Loss: 1.013 Test Acc: 0.805
Validation loss decreased (-0.627012 --> -0.805395).  Saving model ...
Epoch: 4 cost time: 1.5867364406585693
Epoch: 4, Steps: 17 | Train Loss: 0.847 Vali Loss: 0.653 Vali Acc: 0.873 Test Loss: 0.653 Test Acc: 0.873
Validation loss decreased (-0.805395 --> -0.872966).  Saving model ...
Epoch: 5 cost time: 1.5838301181793213
Epoch: 5, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.445 Vali Acc: 0.908 Test Loss: 0.445 Test Acc: 0.908
Validation loss decreased (-0.872966 --> -0.908104).  Saving model ...
Epoch: 6 cost time: 1.7423391342163086
Epoch: 6, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.327 Vali Acc: 0.924 Test Loss: 0.327 Test Acc: 0.924
Validation loss decreased (-0.908104 --> -0.924321).  Saving model ...
Epoch: 7 cost time: 1.6588399410247803
Epoch: 7, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.267 Vali Acc: 0.927 Test Loss: 0.267 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927024).  Saving model ...
Epoch: 8 cost time: 1.6479313373565674
Epoch: 8, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
Validation loss decreased (-0.927024 --> -0.935133).  Saving model ...
Epoch: 9 cost time: 1.5822560787200928
Epoch: 9, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.210 Vali Acc: 0.932 Test Loss: 0.210 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.595245122909546
Epoch: 10, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 11 cost time: 1.6062946319580078
Epoch: 11, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 12 cost time: 1.5627377033233643
Epoch: 12, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.186 Vali Acc: 0.932 Test Loss: 0.186 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.607377052307129
Epoch: 13, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5864949226379395
Epoch: 14, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.176 Vali Acc: 0.935 Test Loss: 0.176 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6579055786132812
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.673325538635254
Epoch: 16, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4309983253479004
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.172 Vali Acc: 0.938 Test Loss: 0.172 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.29402756690979
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3156569004058838
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 1.2805626392364502
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5723607540130615
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6097140312194824
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6027271747589111
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7803988456726074
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6968591213226318
Epoch: 25, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6496610641479492
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5468838214874268
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5925085544586182
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4993114471435547
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 23961
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2724363803863525
Epoch: 1, Steps: 17 | Train Loss: 2.217 Vali Loss: 2.057 Vali Acc: 0.200 Test Loss: 2.057 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 1.553985834121704
Epoch: 2, Steps: 17 | Train Loss: 1.964 Vali Loss: 1.672 Vali Acc: 0.562 Test Loss: 1.672 Test Acc: 0.562
Validation loss decreased (-0.199979 --> -0.562145).  Saving model ...
Epoch: 3 cost time: 1.5165646076202393
Epoch: 3, Steps: 17 | Train Loss: 1.546 Vali Loss: 1.272 Vali Acc: 0.754 Test Loss: 1.272 Test Acc: 0.754
Validation loss decreased (-0.562145 --> -0.754041).  Saving model ...
Epoch: 4 cost time: 1.5224711894989014
Epoch: 4, Steps: 17 | Train Loss: 1.114 Vali Loss: 0.902 Vali Acc: 0.824 Test Loss: 0.902 Test Acc: 0.824
Validation loss decreased (-0.754041 --> -0.824315).  Saving model ...
Epoch: 5 cost time: 1.5388402938842773
Epoch: 5, Steps: 17 | Train Loss: 0.793 Vali Loss: 0.638 Vali Acc: 0.873 Test Loss: 0.638 Test Acc: 0.873
Validation loss decreased (-0.824315 --> -0.872967).  Saving model ...
Epoch: 6 cost time: 1.554992437362671
Epoch: 6, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.463 Vali Acc: 0.903 Test Loss: 0.463 Test Acc: 0.903
Validation loss decreased (-0.872967 --> -0.902698).  Saving model ...
Epoch: 7 cost time: 1.7065033912658691
Epoch: 7, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
Validation loss decreased (-0.902698 --> -0.921618).  Saving model ...
Epoch: 8 cost time: 1.5539095401763916
Epoch: 8, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
Validation loss decreased (-0.921618 --> -0.929727).  Saving model ...
Epoch: 9 cost time: 1.550570011138916
Epoch: 9, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.255 Vali Acc: 0.938 Test Loss: 0.255 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937835).  Saving model ...
Epoch: 10 cost time: 1.6079115867614746
Epoch: 10, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.224 Vali Acc: 0.938 Test Loss: 0.224 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 11 cost time: 1.5446562767028809
Epoch: 11, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.211 Vali Acc: 0.932 Test Loss: 0.211 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4450244903564453
Epoch: 12, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 1.512178897857666
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5179123878479004
Epoch: 14, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5677790641784668
Epoch: 15, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.179 Vali Acc: 0.938 Test Loss: 0.179 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5005345344543457
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.173 Vali Acc: 0.938 Test Loss: 0.173 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6057982444763184
Epoch: 17, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6540281772613525
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7307052612304688
Epoch: 19, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.592231035232544
Epoch: 20, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7697556018829346
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7745018005371094
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 22249
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.425128221511841
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.100 Vali Acc: 0.205 Test Loss: 2.100 Test Acc: 0.205
Validation loss decreased (inf --> -0.205384).  Saving model ...
Epoch: 2 cost time: 1.7456555366516113
Epoch: 2, Steps: 17 | Train Loss: 1.949 Vali Loss: 1.719 Vali Acc: 0.511 Test Loss: 1.719 Test Acc: 0.511
Validation loss decreased (-0.205384 --> -0.510794).  Saving model ...
Epoch: 3 cost time: 1.684234619140625
Epoch: 3, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.305 Vali Acc: 0.722 Test Loss: 1.305 Test Acc: 0.722
Validation loss decreased (-0.510794 --> -0.721609).  Saving model ...
Epoch: 4 cost time: 1.840749740600586
Epoch: 4, Steps: 17 | Train Loss: 1.178 Vali Loss: 0.946 Vali Acc: 0.808 Test Loss: 0.946 Test Acc: 0.808
Validation loss decreased (-0.721609 --> -0.808099).  Saving model ...
Epoch: 5 cost time: 1.8243811130523682
Epoch: 5, Steps: 17 | Train Loss: 0.836 Vali Loss: 0.671 Vali Acc: 0.865 Test Loss: 0.671 Test Acc: 0.865
Validation loss decreased (-0.808099 --> -0.864858).  Saving model ...
Epoch: 6 cost time: 1.6770479679107666
Epoch: 6, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.476 Vali Acc: 0.876 Test Loss: 0.476 Test Acc: 0.876
Validation loss decreased (-0.864858 --> -0.875671).  Saving model ...
Epoch: 7 cost time: 1.6430962085723877
Epoch: 7, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.370 Vali Acc: 0.895 Test Loss: 0.370 Test Acc: 0.895
Validation loss decreased (-0.875671 --> -0.894591).  Saving model ...
Epoch: 8 cost time: 1.711618423461914
Epoch: 8, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
Validation loss decreased (-0.894591 --> -0.910808).  Saving model ...
Epoch: 9 cost time: 1.5484495162963867
Epoch: 9, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
Validation loss decreased (-0.910808 --> -0.929727).  Saving model ...
Epoch: 10 cost time: 1.632077932357788
Epoch: 10, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.236 Vali Acc: 0.927 Test Loss: 0.236 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4216482639312744
Epoch: 11, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935133).  Saving model ...
Epoch: 12 cost time: 1.5510287284851074
Epoch: 12, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 13 cost time: 1.5767862796783447
Epoch: 13, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4253056049346924
Epoch: 14, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 15 cost time: 1.4118425846099854
Epoch: 15, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 16 cost time: 1.4816434383392334
Epoch: 16, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 17 cost time: 1.4890151023864746
Epoch: 17, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 1.3998258113861084
Epoch: 18, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4584336280822754
Epoch: 19, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 20 cost time: 1.5279006958007812
Epoch: 20, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 1.4186561107635498
Epoch: 21, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5783593654632568
Epoch: 22, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4064428806304932
Epoch: 23, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3321363925933838
Epoch: 24, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.376556634902954
Epoch: 25, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5951452255249023
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6301589012145996
Epoch: 27, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4839591979980469
Epoch: 28, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 29 cost time: 1.3505866527557373
Epoch: 29, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3827993869781494
Epoch: 30, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.522028923034668
Epoch: 31, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.537390947341919
Epoch: 32, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4293959140777588
Epoch: 33, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3439478874206543
Epoch: 34, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3562097549438477
Epoch: 35, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2780895233154297
Epoch: 36, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.385810136795044
Epoch: 37, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.5615990161895752
Epoch: 38, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 18825
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.268939256668091
Epoch: 1, Steps: 17 | Train Loss: 1.582 Vali Loss: 0.481 Vali Acc: 0.857 Test Loss: 0.481 Test Acc: 0.857
Validation loss decreased (inf --> -0.856752).  Saving model ...
Epoch: 2 cost time: 1.8159332275390625
Epoch: 2, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.328 Vali Acc: 0.895 Test Loss: 0.328 Test Acc: 0.895
Validation loss decreased (-0.856752 --> -0.894591).  Saving model ...
Epoch: 3 cost time: 1.8270070552825928
Epoch: 3, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.300 Vali Acc: 0.919 Test Loss: 0.300 Test Acc: 0.919
Validation loss decreased (-0.894591 --> -0.918916).  Saving model ...
Epoch: 4 cost time: 1.4843547344207764
Epoch: 4, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.918916 --> -0.940538).  Saving model ...
Epoch: 5 cost time: 1.8039848804473877
Epoch: 5, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.289 Vali Acc: 0.908 Test Loss: 0.289 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.847496747970581
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.303 Vali Acc: 0.927 Test Loss: 0.303 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7513017654418945
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.307 Vali Acc: 0.914 Test Loss: 0.307 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.741511583328247
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.949 Test Loss: 0.268 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948646).  Saving model ...
Epoch: 9 cost time: 1.8642046451568604
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.484 Vali Acc: 0.895 Test Loss: 0.484 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7795825004577637
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.932 Test Loss: 0.305 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8324708938598633
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.341 Vali Acc: 0.943 Test Loss: 0.341 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6197304725646973
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.553 Vali Acc: 0.905 Test Loss: 0.553 Test Acc: 0.905
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3676607608795166
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.938 Test Loss: 0.382 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6215791702270508
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.098 Vali Acc: 0.846 Test Loss: 1.098 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6260032653808594
Epoch: 15, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.857 Vali Acc: 0.892 Test Loss: 0.857 Test Acc: 0.892
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7146315574645996
Epoch: 16, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.822 Vali Acc: 0.889 Test Loss: 0.822 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.670619010925293
Epoch: 17, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.696 Vali Acc: 0.916 Test Loss: 0.696 Test Acc: 0.916
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5223867893218994
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.568 Vali Acc: 0.935 Test Loss: 0.568 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 533897
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.332916021347046
Epoch: 1, Steps: 17 | Train Loss: 1.792 Vali Loss: 0.867 Vali Acc: 0.814 Test Loss: 0.867 Test Acc: 0.814
Validation loss decreased (inf --> -0.813505).  Saving model ...
Epoch: 2 cost time: 1.5468814373016357
Epoch: 2, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.813505 --> -0.902700).  Saving model ...
Epoch: 3 cost time: 1.463716745376587
Epoch: 3, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (-0.902700 --> -0.940539).  Saving model ...
Epoch: 4 cost time: 1.497840404510498
Epoch: 4, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6325914859771729
Epoch: 5, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.195 Vali Acc: 0.932 Test Loss: 0.195 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7222790718078613
Epoch: 6, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.6970694065093994
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6595168113708496
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.6866836547851562
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.728255271911621
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5696501731872559
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4783642292022705
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6547908782958984
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8874726295471191
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.683645486831665
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7296066284179688
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7586891651153564
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.903963327407837
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7959728240966797
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 340489
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.419051170349121
Epoch: 1, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.074 Vali Acc: 0.746 Test Loss: 1.074 Test Acc: 0.746
Validation loss decreased (inf --> -0.745935).  Saving model ...
Epoch: 2 cost time: 1.7008614540100098
Epoch: 2, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
Validation loss decreased (-0.745935 --> -0.921618).  Saving model ...
Epoch: 3 cost time: 1.5324053764343262
Epoch: 3, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.921618 --> -0.940539).  Saving model ...
Epoch: 4 cost time: 1.523524522781372
Epoch: 4, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 5 cost time: 1.5217556953430176
Epoch: 5, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.4719629287719727
Epoch: 6, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 7 cost time: 1.8173391819000244
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8502733707427979
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8090319633483887
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7493979930877686
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7449612617492676
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.751460075378418
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.67002272605896
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7548182010650635
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 1.7632746696472168
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8010339736938477
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5152218341827393
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4767165184020996
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7048487663269043
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6887340545654297
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.698448657989502
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6951749324798584
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6460134983062744
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5189483165740967
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 271625
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.581719398498535
Epoch: 1, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.154 Vali Acc: 0.743 Test Loss: 1.154 Test Acc: 0.743
Validation loss decreased (inf --> -0.743232).  Saving model ...
Epoch: 2 cost time: 1.7588880062103271
Epoch: 2, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.743232 --> -0.902699).  Saving model ...
Epoch: 3 cost time: 1.797886848449707
Epoch: 3, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.273 Vali Acc: 0.905 Test Loss: 0.273 Test Acc: 0.905
Validation loss decreased (-0.902699 --> -0.905403).  Saving model ...
Epoch: 4 cost time: 1.5282535552978516
Epoch: 4, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.242 Vali Acc: 0.916 Test Loss: 0.242 Test Acc: 0.916
Validation loss decreased (-0.905403 --> -0.916214).  Saving model ...
Epoch: 5 cost time: 1.4027469158172607
Epoch: 5, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
Validation loss decreased (-0.916214 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.303849458694458
Epoch: 6, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3952422142028809
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.5219075679779053
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4730803966522217
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 1.466616153717041
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4356684684753418
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.400580644607544
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4608697891235352
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6241486072540283
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.765533685684204
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8085355758666992
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6455869674682617
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.674821138381958
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8493397235870361
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 257929
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3929789066314697
Epoch: 1, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.186 Vali Acc: 0.841 Test Loss: 1.186 Test Acc: 0.841
Validation loss decreased (inf --> -0.840529).  Saving model ...
Epoch: 2 cost time: 1.3631236553192139
Epoch: 2, Steps: 17 | Train Loss: 0.765 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
Validation loss decreased (-0.840529 --> -0.889185).  Saving model ...
Epoch: 3 cost time: 1.5384900569915771
Epoch: 3, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.889185 --> -0.940538).  Saving model ...
Epoch: 4 cost time: 1.6078670024871826
Epoch: 4, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 5 cost time: 1.5070953369140625
Epoch: 5, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 1.3080272674560547
Epoch: 6, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 1.5448827743530273
Epoch: 7, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6152987480163574
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7392842769622803
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4150071144104004
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.652571439743042
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6243698596954346
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7903895378112793
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6214826107025146
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7684001922607422
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5035886764526367
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 230537
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.006246089935303
Epoch: 1, Steps: 17 | Train Loss: 1.613 Vali Loss: 0.445 Vali Acc: 0.886 Test Loss: 0.445 Test Acc: 0.886
Validation loss decreased (inf --> -0.886482).  Saving model ...
Epoch: 2 cost time: 2.0122785568237305
Epoch: 2, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.241 Vali Acc: 0.914 Test Loss: 0.241 Test Acc: 0.914
Validation loss decreased (-0.886482 --> -0.913511).  Saving model ...
Epoch: 3 cost time: 2.159421682357788
Epoch: 3, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.205 Vali Acc: 0.932 Test Loss: 0.205 Test Acc: 0.932
Validation loss decreased (-0.913511 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 2.0729308128356934
Epoch: 4, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.327 Vali Acc: 0.919 Test Loss: 0.327 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.013638973236084
Epoch: 5, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.331 Vali Acc: 0.908 Test Loss: 0.331 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1942224502563477
Epoch: 6, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.356 Vali Acc: 0.919 Test Loss: 0.356 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.248053550720215
Epoch: 7, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.454 Vali Acc: 0.919 Test Loss: 0.454 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1013214588165283
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.267 Vali Acc: 0.924 Test Loss: 0.267 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2281816005706787
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.379 Vali Acc: 0.927 Test Loss: 0.379 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1643142700195312
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.329 Vali Acc: 0.930 Test Loss: 0.329 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2299726009368896
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.348 Vali Acc: 0.927 Test Loss: 0.348 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9292199611663818
Epoch: 12, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.514 Vali Acc: 0.908 Test Loss: 0.514 Test Acc: 0.908
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6463563442230225
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.766 Vali Acc: 0.892 Test Loss: 0.766 Test Acc: 0.892
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9324324324324325
model parameter : 501001
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.353620767593384
Epoch: 1, Steps: 17 | Train Loss: 1.807 Vali Loss: 0.822 Vali Acc: 0.862 Test Loss: 0.822 Test Acc: 0.862
Validation loss decreased (inf --> -0.862154).  Saving model ...
Epoch: 2 cost time: 1.6475491523742676
Epoch: 2, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
Validation loss decreased (-0.862154 --> -0.929727).  Saving model ...
Epoch: 3 cost time: 1.9173245429992676
Epoch: 3, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.227 Vali Acc: 0.927 Test Loss: 0.227 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9489216804504395
Epoch: 4, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 1.9806511402130127
Epoch: 5, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.217 Vali Acc: 0.927 Test Loss: 0.217 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9973838329315186
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.961890697479248
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.932 Test Loss: 0.209 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8236799240112305
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8499760627746582
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9402830600738525
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8464372158050537
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 1.9980487823486328
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8170068264007568
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6399955749511719
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.943 Test Loss: 0.193 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5126714706420898
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5668582916259766
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.943 Test Loss: 0.193 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9137277603149414
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.924164056777954
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9055852890014648
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0009520053863525
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.91798734664917
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 307593
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.299384593963623
Epoch: 1, Steps: 17 | Train Loss: 1.883 Vali Loss: 1.001 Vali Acc: 0.795 Test Loss: 1.001 Test Acc: 0.795
Validation loss decreased (inf --> -0.794585).  Saving model ...
Epoch: 2 cost time: 1.7223689556121826
Epoch: 2, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.299 Vali Acc: 0.938 Test Loss: 0.299 Test Acc: 0.938
Validation loss decreased (-0.794585 --> -0.937835).  Saving model ...
Epoch: 3 cost time: 1.920546054840088
Epoch: 3, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8493611812591553
Epoch: 4, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 5 cost time: 1.7604994773864746
Epoch: 5, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 1.6686193943023682
Epoch: 6, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6758410930633545
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 1.792496919631958
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6837737560272217
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 1.7679221630096436
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 1.7990779876708984
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8213443756103516
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8417682647705078
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 1.8222119808197021
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.768009901046753
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5847349166870117
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6147820949554443
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.483541488647461
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6936142444610596
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5941619873046875
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7110686302185059
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.626142978668213
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6259191036224365
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 238729
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3709630966186523
Epoch: 1, Steps: 17 | Train Loss: 1.964 Vali Loss: 1.134 Vali Acc: 0.762 Test Loss: 1.134 Test Acc: 0.762
Validation loss decreased (inf --> -0.762151).  Saving model ...
Epoch: 2 cost time: 1.7962820529937744
Epoch: 2, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.371 Vali Acc: 0.892 Test Loss: 0.371 Test Acc: 0.892
Validation loss decreased (-0.762151 --> -0.891888).  Saving model ...
Epoch: 3 cost time: 1.7291252613067627
Epoch: 3, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.217 Vali Acc: 0.951 Test Loss: 0.217 Test Acc: 0.951
Validation loss decreased (-0.891888 --> -0.951349).  Saving model ...
Epoch: 4 cost time: 1.759080410003662
Epoch: 4, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8450877666473389
Epoch: 5, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.784553050994873
Epoch: 6, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.203 Vali Acc: 0.938 Test Loss: 0.203 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5791239738464355
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6860003471374512
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.7679667472839355
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5841724872589111
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6668968200683594
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4206326007843018
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 13 cost time: 1.4487383365631104
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6306943893432617
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6738569736480713
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.673933506011963
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7276289463043213
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7629048824310303
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6749582290649414
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.668278694152832
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6115567684173584
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5971782207489014
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 225033
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4378068447113037
Epoch: 1, Steps: 17 | Train Loss: 1.917 Vali Loss: 1.178 Vali Acc: 0.822 Test Loss: 1.178 Test Acc: 0.822
Validation loss decreased (inf --> -0.821610).  Saving model ...
Epoch: 2 cost time: 1.6884872913360596
Epoch: 2, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.413 Vali Acc: 0.895 Test Loss: 0.413 Test Acc: 0.895
Validation loss decreased (-0.821610 --> -0.894590).  Saving model ...
Epoch: 3 cost time: 1.6018521785736084
Epoch: 3, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.247 Vali Acc: 0.914 Test Loss: 0.247 Test Acc: 0.914
Validation loss decreased (-0.894590 --> -0.913511).  Saving model ...
Epoch: 4 cost time: 1.6697635650634766
Epoch: 4, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.218 Vali Acc: 0.932 Test Loss: 0.218 Test Acc: 0.932
Validation loss decreased (-0.913511 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 1.749248743057251
Epoch: 5, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (-0.932430 --> -0.954053).  Saving model ...
Epoch: 6 cost time: 1.8647663593292236
Epoch: 6, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5870320796966553
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 1.6441469192504883
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8550515174865723
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8959968090057373
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6047921180725098
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.528531789779663
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4208571910858154
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5713603496551514
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6677331924438477
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.577444314956665
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7128655910491943
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 197641
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6886348724365234
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 0.488 Vali Acc: 0.870 Test Loss: 0.488 Test Acc: 0.870
Validation loss decreased (inf --> -0.870265).  Saving model ...
Epoch: 2 cost time: 1.976273775100708
Epoch: 2, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.294 Vali Acc: 0.884 Test Loss: 0.294 Test Acc: 0.884
Validation loss decreased (-0.870265 --> -0.883781).  Saving model ...
Epoch: 3 cost time: 1.9437735080718994
Epoch: 3, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.883781 --> -0.940539).  Saving model ...
Epoch: 4 cost time: 1.9514906406402588
Epoch: 4, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.228 Vali Acc: 0.924 Test Loss: 0.228 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9670634269714355
Epoch: 5, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.272 Vali Acc: 0.932 Test Loss: 0.272 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9277129173278809
Epoch: 6, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8495457172393799
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.941253900527954
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.325 Vali Acc: 0.932 Test Loss: 0.325 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.175933599472046
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.932 Test Loss: 0.265 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.171710252761841
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.938 Test Loss: 0.253 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3338491916656494
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.397 Vali Acc: 0.916 Test Loss: 0.397 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3890671730041504
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.360 Vali Acc: 0.941 Test Loss: 0.360 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.307494640350342
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.424 Vali Acc: 0.927 Test Loss: 0.424 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9405405405405406
model parameter : 484553
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.170819044113159
Epoch: 1, Steps: 17 | Train Loss: 1.806 Vali Loss: 0.771 Vali Acc: 0.849 Test Loss: 0.771 Test Acc: 0.849
Validation loss decreased (inf --> -0.848641).  Saving model ...
Epoch: 2 cost time: 2.03887677192688
Epoch: 2, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.262 Vali Acc: 0.916 Test Loss: 0.262 Test Acc: 0.916
Validation loss decreased (-0.848641 --> -0.916214).  Saving model ...
Epoch: 3 cost time: 2.1846117973327637
Epoch: 3, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.247 Vali Acc: 0.916 Test Loss: 0.247 Test Acc: 0.916
Validation loss decreased (-0.916214 --> -0.916214).  Saving model ...
Epoch: 4 cost time: 2.298043966293335
Epoch: 4, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.264 Vali Acc: 0.914 Test Loss: 0.264 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2385129928588867
Epoch: 5, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
Validation loss decreased (-0.916214 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 2.0788044929504395
Epoch: 6, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9198887348175049
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 8 cost time: 2.2632358074188232
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.938 Test Loss: 0.234 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.262415885925293
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.938 Test Loss: 0.209 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1622650623321533
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1978821754455566
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940538).  Saving model ...
Epoch: 12 cost time: 1.7465627193450928
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.938 Test Loss: 0.227 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3849310874938965
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3007187843322754
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.938 Test Loss: 0.220 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.188307762145996
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 16 cost time: 2.0293636322021484
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.938 Test Loss: 0.223 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.010603189468384
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0772507190704346
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 19 cost time: 1.8419787883758545
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 20 cost time: 2.1202101707458496
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 21 cost time: 1.79964017868042
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6286625862121582
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.469088077545166
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5750808715820312
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4442431926727295
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 26 cost time: 1.7106668949127197
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8895211219787598
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9808251857757568
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8503048419952393
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 30 cost time: 2.064157247543335
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 1.9005067348480225
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.865144968032837
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.746265172958374
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948646).  Saving model ...
Epoch: 34 cost time: 1.8902969360351562
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 35 cost time: 1.9936542510986328
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.025602102279663
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8981924057006836
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8919713497161865
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.943 Test Loss: 0.222 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5529122352600098
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.7024879455566406
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.6245696544647217
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.7179358005523682
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.8082473278045654
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.7487385272979736
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.943 Test Loss: 0.224 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 291145
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2904701232910156
Epoch: 1, Steps: 17 | Train Loss: 1.922 Vali Loss: 1.031 Vali Acc: 0.843 Test Loss: 1.031 Test Acc: 0.843
Validation loss decreased (inf --> -0.843233).  Saving model ...
Epoch: 2 cost time: 1.654675006866455
Epoch: 2, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.337 Vali Acc: 0.914 Test Loss: 0.337 Test Acc: 0.914
Validation loss decreased (-0.843233 --> -0.913510).  Saving model ...
Epoch: 3 cost time: 1.6958258152008057
Epoch: 3, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.913510 --> -0.948647).  Saving model ...
Epoch: 4 cost time: 1.782034158706665
Epoch: 4, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.822272539138794
Epoch: 5, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.162 Vali Acc: 0.935 Test Loss: 0.162 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5938348770141602
Epoch: 6, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6422197818756104
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 1.8005518913269043
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5608134269714355
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 1.6747195720672607
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 1.7999629974365234
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7872247695922852
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8578250408172607
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8727569580078125
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0417215824127197
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.602220058441162
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.705024242401123
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4135453701019287
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6175930500030518
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8257043361663818
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 222281
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.140854835510254
Epoch: 1, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.155 Vali Acc: 0.770 Test Loss: 1.155 Test Acc: 0.770
Validation loss decreased (inf --> -0.770259).  Saving model ...
Epoch: 2 cost time: 1.7015912532806396
Epoch: 2, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.374 Vali Acc: 0.897 Test Loss: 0.374 Test Acc: 0.897
Validation loss decreased (-0.770259 --> -0.897294).  Saving model ...
Epoch: 3 cost time: 1.7042365074157715
Epoch: 3, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
Validation loss decreased (-0.897294 --> -0.935133).  Saving model ...
Epoch: 4 cost time: 1.5740127563476562
Epoch: 4, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
Validation loss decreased (-0.935133 --> -0.954052).  Saving model ...
Epoch: 5 cost time: 1.5201027393341064
Epoch: 5, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.749176263809204
Epoch: 6, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6569719314575195
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 1.599897861480713
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5300648212432861
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 1.61159348487854
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.525197982788086
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5888221263885498
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4952828884124756
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4160375595092773
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4208612442016602
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.418935775756836
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4508333206176758
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6936352252960205
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6881499290466309
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 208585
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.303256034851074
Epoch: 1, Steps: 17 | Train Loss: 2.031 Vali Loss: 1.365 Vali Acc: 0.668 Test Loss: 1.365 Test Acc: 0.668
Validation loss decreased (inf --> -0.667554).  Saving model ...
Epoch: 2 cost time: 1.569218397140503
Epoch: 2, Steps: 17 | Train Loss: 0.818 Vali Loss: 0.469 Vali Acc: 0.873 Test Loss: 0.469 Test Acc: 0.873
Validation loss decreased (-0.667554 --> -0.872968).  Saving model ...
Epoch: 3 cost time: 1.553421974182129
Epoch: 3, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.246 Vali Acc: 0.932 Test Loss: 0.246 Test Acc: 0.932
Validation loss decreased (-0.872968 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 1.4978716373443604
Epoch: 4, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 5 cost time: 1.6099879741668701
Epoch: 5, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5357410907745361
Epoch: 6, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.5386927127838135
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 1.490891695022583
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 1.5819456577301025
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5942556858062744
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6283543109893799
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.428520917892456
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5294690132141113
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4943220615386963
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.52791166305542
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4701151847839355
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3264648914337158
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6209681034088135
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 181193
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.650707721710205
Epoch: 1, Steps: 17 | Train Loss: 1.816 Vali Loss: 0.792 Vali Acc: 0.873 Test Loss: 0.792 Test Acc: 0.873
Validation loss decreased (inf --> -0.872965).  Saving model ...
Epoch: 2 cost time: 1.781050205230713
Epoch: 2, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.262 Vali Acc: 0.924 Test Loss: 0.262 Test Acc: 0.924
Validation loss decreased (-0.872965 --> -0.924322).  Saving model ...
Epoch: 3 cost time: 2.00956654548645
Epoch: 3, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
Validation loss decreased (-0.924322 --> -0.937836).  Saving model ...
Epoch: 4 cost time: 1.5873870849609375
Epoch: 4, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.205 Vali Acc: 0.914 Test Loss: 0.205 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8224432468414307
Epoch: 5, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.215 Vali Acc: 0.924 Test Loss: 0.215 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9281845092773438
Epoch: 6, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.932 Test Loss: 0.206 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.707831621170044
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8253173828125
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.265 Vali Acc: 0.932 Test Loss: 0.265 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7043726444244385
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.924 Test Loss: 0.244 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8260061740875244
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
Validation loss decreased (-0.937836 --> -0.951349).  Saving model ...
Epoch: 11 cost time: 1.8956983089447021
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8425559997558594
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.218 Vali Acc: 0.954 Test Loss: 0.218 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 1.7323722839355469
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.935 Test Loss: 0.263 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8738155364990234
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.462127923965454
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.943 Test Loss: 0.241 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.501840591430664
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.951 Test Loss: 0.227 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.422947883605957
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.678912878036499
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6953208446502686
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6987452507019043
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.949 Test Loss: 0.217 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6552155017852783
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5725600719451904
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.951 Test Loss: 0.217 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 250697
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5355072021484375
Epoch: 1, Steps: 17 | Train Loss: 2.040 Vali Loss: 1.362 Vali Acc: 0.730 Test Loss: 1.362 Test Acc: 0.730
Validation loss decreased (inf --> -0.729716).  Saving model ...
Epoch: 2 cost time: 1.7797205448150635
Epoch: 2, Steps: 17 | Train Loss: 0.851 Vali Loss: 0.419 Vali Acc: 0.905 Test Loss: 0.419 Test Acc: 0.905
Validation loss decreased (-0.729716 --> -0.905401).  Saving model ...
Epoch: 3 cost time: 1.6739349365234375
Epoch: 3, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
Validation loss decreased (-0.905401 --> -0.921619).  Saving model ...
Epoch: 4 cost time: 1.5565869808197021
Epoch: 4, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
Validation loss decreased (-0.921619 --> -0.954052).  Saving model ...
Epoch: 5 cost time: 1.5893733501434326
Epoch: 5, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.338665246963501
Epoch: 6, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.36912202835083
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3197600841522217
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3803966045379639
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 1.5982565879821777
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.583655834197998
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6071491241455078
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4566118717193604
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.470102071762085
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5095829963684082
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5035479068756104
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4701809883117676
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5123264789581299
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6121554374694824
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 153993
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7359650135040283
Epoch: 1, Steps: 17 | Train Loss: 2.031 Vali Loss: 1.459 Vali Acc: 0.719 Test Loss: 1.459 Test Acc: 0.719
Validation loss decreased (inf --> -0.718904).  Saving model ...
Epoch: 2 cost time: 1.075852870941162
Epoch: 2, Steps: 17 | Train Loss: 0.976 Vali Loss: 0.538 Vali Acc: 0.897 Test Loss: 0.538 Test Acc: 0.897
Validation loss decreased (-0.718904 --> -0.897292).  Saving model ...
Epoch: 3 cost time: 1.1132304668426514
Epoch: 3, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.285 Vali Acc: 0.916 Test Loss: 0.285 Test Acc: 0.916
Validation loss decreased (-0.897292 --> -0.916213).  Saving model ...
Epoch: 4 cost time: 1.2339749336242676
Epoch: 4, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.916213 --> -0.940539).  Saving model ...
Epoch: 5 cost time: 1.0496749877929688
Epoch: 5, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.1313443183898926
Epoch: 6, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.102005958557129
Epoch: 7, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.146 Vali Acc: 0.943 Test Loss: 0.146 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1354703903198242
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1220479011535645
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2243869304656982
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.118990182876587
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 1.0913152694702148
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0687546730041504
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 1.1069822311401367
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 1.0287106037139893
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1657421588897705
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0218892097473145
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0869624614715576
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 1.0121917724609375
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2207229137420654
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0398669242858887
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0755679607391357
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9923467636108398
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 1.0369036197662354
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9814226627349854
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0121092796325684
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0815019607543945
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0649144649505615
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9804444313049316
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.023195743560791
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.061192512512207
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9721357822418213
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9617495536804199
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 119561
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7389705181121826
Epoch: 1, Steps: 17 | Train Loss: 2.028 Vali Loss: 1.530 Vali Acc: 0.635 Test Loss: 1.530 Test Acc: 0.635
Validation loss decreased (inf --> -0.635120).  Saving model ...
Epoch: 2 cost time: 1.0293519496917725
Epoch: 2, Steps: 17 | Train Loss: 1.083 Vali Loss: 0.695 Vali Acc: 0.859 Test Loss: 0.695 Test Acc: 0.859
Validation loss decreased (-0.635120 --> -0.859453).  Saving model ...
Epoch: 3 cost time: 1.0645675659179688
Epoch: 3, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
Validation loss decreased (-0.859453 --> -0.910807).  Saving model ...
Epoch: 4 cost time: 0.9986705780029297
Epoch: 4, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.243 Vali Acc: 0.932 Test Loss: 0.243 Test Acc: 0.932
Validation loss decreased (-0.910807 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 1.0756464004516602
Epoch: 5, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.184 Vali Acc: 0.938 Test Loss: 0.184 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 1.0692362785339355
Epoch: 6, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.937836 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.069803237915039
Epoch: 7, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0576756000518799
Epoch: 8, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.169 Vali Acc: 0.932 Test Loss: 0.169 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0062365531921387
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.0016486644744873
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9318275451660156
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9902935028076172
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.093069076538086
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0584261417388916
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9410567283630371
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0935826301574707
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0285296440124512
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.121049404144287
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0277717113494873
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 112713
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6379573345184326
Epoch: 1, Steps: 17 | Train Loss: 2.233 Vali Loss: 1.695 Vali Acc: 0.584 Test Loss: 1.695 Test Acc: 0.584
Validation loss decreased (inf --> -0.583767).  Saving model ...
Epoch: 2 cost time: 1.0554578304290771
Epoch: 2, Steps: 17 | Train Loss: 1.316 Vali Loss: 0.821 Vali Acc: 0.862 Test Loss: 0.821 Test Acc: 0.862
Validation loss decreased (-0.583767 --> -0.862154).  Saving model ...
Epoch: 3 cost time: 0.9824073314666748
Epoch: 3, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.419 Vali Acc: 0.919 Test Loss: 0.419 Test Acc: 0.919
Validation loss decreased (-0.862154 --> -0.918915).  Saving model ...
Epoch: 4 cost time: 1.1175897121429443
Epoch: 4, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.259 Vali Acc: 0.932 Test Loss: 0.259 Test Acc: 0.932
Validation loss decreased (-0.918915 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 1.0201363563537598
Epoch: 5, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.1857795715332031
Epoch: 6, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.1734323501586914
Epoch: 7, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 1.2492825984954834
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.156294584274292
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2138252258300781
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 1.2956516742706299
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.2540814876556396
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2514138221740723
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.141341209411621
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2856981754302979
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1813545227050781
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2264037132263184
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1271867752075195
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1796681880950928
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9422993659973145
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0851504802703857
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 99017
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2867274284362793
Epoch: 1, Steps: 17 | Train Loss: 1.731 Vali Loss: 1.002 Vali Acc: 0.673 Test Loss: 1.002 Test Acc: 0.673
Validation loss decreased (inf --> -0.672963).  Saving model ...
Epoch: 2 cost time: 1.557664155960083
Epoch: 2, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.310 Vali Acc: 0.884 Test Loss: 0.310 Test Acc: 0.884
Validation loss decreased (-0.672963 --> -0.883781).  Saving model ...
Epoch: 3 cost time: 1.3722236156463623
Epoch: 3, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
Validation loss decreased (-0.883781 --> -0.921619).  Saving model ...
Epoch: 4 cost time: 1.4107601642608643
Epoch: 4, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929728).  Saving model ...
Epoch: 5 cost time: 1.0131540298461914
Epoch: 5, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
Validation loss decreased (-0.929728 --> -0.929728).  Saving model ...
Epoch: 6 cost time: 1.268749475479126
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
Validation loss decreased (-0.929728 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.496708869934082
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.938 Test Loss: 0.211 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3061838150024414
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6082117557525635
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.943 Test Loss: 0.193 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5830731391906738
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4907605648040771
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4490184783935547
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.938 Test Loss: 0.209 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.661250352859497
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.54656982421875
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4745569229125977
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5511682033538818
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 234185
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1620895862579346
Epoch: 1, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.287 Vali Acc: 0.757 Test Loss: 1.287 Test Acc: 0.757
Validation loss decreased (inf --> -0.756744).  Saving model ...
Epoch: 2 cost time: 1.4891207218170166
Epoch: 2, Steps: 17 | Train Loss: 0.866 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.756744 --> -0.899996).  Saving model ...
Epoch: 3 cost time: 1.2888123989105225
Epoch: 3, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.244 Vali Acc: 0.932 Test Loss: 0.244 Test Acc: 0.932
Validation loss decreased (-0.899996 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 1.2300794124603271
Epoch: 4, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 5 cost time: 1.2895636558532715
Epoch: 5, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2878050804138184
Epoch: 6, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2408931255340576
Epoch: 7, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.188 Vali Acc: 0.932 Test Loss: 0.188 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4059727191925049
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.178 Vali Acc: 0.932 Test Loss: 0.178 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6601452827453613
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.711857795715332
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.9133570194244385
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.8184797763824463
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7811176776885986
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5878853797912598
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5850512981414795
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8448083400726318
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.852168321609497
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8331186771392822
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.583326816558838
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.677788257598877
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.792334794998169
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 137481
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.824829578399658
Epoch: 1, Steps: 17 | Train Loss: 2.182 Vali Loss: 1.527 Vali Acc: 0.700 Test Loss: 1.527 Test Acc: 0.700
Validation loss decreased (inf --> -0.699985).  Saving model ...
Epoch: 2 cost time: 1.1180946826934814
Epoch: 2, Steps: 17 | Train Loss: 1.057 Vali Loss: 0.586 Vali Acc: 0.876 Test Loss: 0.586 Test Acc: 0.876
Validation loss decreased (-0.699985 --> -0.875670).  Saving model ...
Epoch: 3 cost time: 1.0738465785980225
Epoch: 3, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.295 Vali Acc: 0.924 Test Loss: 0.295 Test Acc: 0.924
Validation loss decreased (-0.875670 --> -0.924321).  Saving model ...
Epoch: 4 cost time: 1.1789577007293701
Epoch: 4, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.223 Vali Acc: 0.927 Test Loss: 0.223 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927025).  Saving model ...
Epoch: 5 cost time: 1.2370290756225586
Epoch: 5, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.927025 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 1.2799489498138428
Epoch: 6, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2569520473480225
Epoch: 7, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2403323650360107
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.946 Test Loss: 0.150 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.188699722290039
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.203171730041504
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1204288005828857
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.111741542816162
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 13 cost time: 1.0960018634796143
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 14 cost time: 1.1866395473480225
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0932462215423584
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.127939224243164
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2481918334960938
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1779885292053223
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.172403335571289
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1495912075042725
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2577037811279297
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1380343437194824
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.209892749786377
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 103049
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.989992141723633
Epoch: 1, Steps: 17 | Train Loss: 2.069 Vali Loss: 1.561 Vali Acc: 0.589 Test Loss: 1.561 Test Acc: 0.589
Validation loss decreased (inf --> -0.589174).  Saving model ...
Epoch: 2 cost time: 1.0592656135559082
Epoch: 2, Steps: 17 | Train Loss: 1.158 Vali Loss: 0.690 Vali Acc: 0.862 Test Loss: 0.690 Test Acc: 0.862
Validation loss decreased (-0.589174 --> -0.862155).  Saving model ...
Epoch: 3 cost time: 0.9757459163665771
Epoch: 3, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.361 Vali Acc: 0.908 Test Loss: 0.361 Test Acc: 0.908
Validation loss decreased (-0.862155 --> -0.908104).  Saving model ...
Epoch: 4 cost time: 1.0645458698272705
Epoch: 4, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
Validation loss decreased (-0.908104 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 1.030794382095337
Epoch: 5, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.1319489479064941
Epoch: 6, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.943241 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 1.2098472118377686
Epoch: 7, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0943832397460938
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1552097797393799
Epoch: 9, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1632630825042725
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1421606540679932
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.053853988647461
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0877137184143066
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2361626625061035
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1796808242797852
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0604279041290283
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 96201
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8642969131469727
Epoch: 1, Steps: 17 | Train Loss: 2.087 Vali Loss: 1.625 Vali Acc: 0.570 Test Loss: 1.625 Test Acc: 0.570
Validation loss decreased (inf --> -0.570254).  Saving model ...
Epoch: 2 cost time: 1.122222900390625
Epoch: 2, Steps: 17 | Train Loss: 1.200 Vali Loss: 0.791 Vali Acc: 0.846 Test Loss: 0.791 Test Acc: 0.846
Validation loss decreased (-0.570254 --> -0.845938).  Saving model ...
Epoch: 3 cost time: 1.188955545425415
Epoch: 3, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.414 Vali Acc: 0.911 Test Loss: 0.414 Test Acc: 0.911
Validation loss decreased (-0.845938 --> -0.910807).  Saving model ...
Epoch: 4 cost time: 1.1410081386566162
Epoch: 4, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
Validation loss decreased (-0.910807 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 1.1379759311676025
Epoch: 5, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.201 Vali Acc: 0.943 Test Loss: 0.201 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.0367441177368164
Epoch: 6, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1856563091278076
Epoch: 7, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 1.2720921039581299
Epoch: 8, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.115213394165039
Epoch: 9, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1735150814056396
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1857953071594238
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0829684734344482
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.0514812469482422
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0146522521972656
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1561620235443115
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2416024208068848
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2222447395324707
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1939375400543213
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1130168437957764
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1386778354644775
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0982253551483154
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2181200981140137
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 82505
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4174487590789795
Epoch: 1, Steps: 17 | Train Loss: 1.855 Vali Loss: 0.972 Vali Acc: 0.768 Test Loss: 0.972 Test Acc: 0.768
Validation loss decreased (inf --> -0.767558).  Saving model ...
Epoch: 2 cost time: 1.8318743705749512
Epoch: 2, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
Validation loss decreased (-0.767558 --> -0.929727).  Saving model ...
Epoch: 3 cost time: 1.8800380229949951
Epoch: 3, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.220 Vali Acc: 0.932 Test Loss: 0.220 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 1.5307948589324951
Epoch: 4, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
Validation loss decreased (-0.932430 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 1.4400205612182617
Epoch: 5, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3861498832702637
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.938 Test Loss: 0.206 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6780929565429688
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6749358177185059
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 1.6024196147918701
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.537748098373413
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5674872398376465
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7973828315734863
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.6463277339935303
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7264416217803955
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6331100463867188
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6151998043060303
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6409339904785156
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4597654342651367
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4903018474578857
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5219042301177979
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.830550193786621
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7751190662384033
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 225929
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9777958393096924
Epoch: 1, Steps: 17 | Train Loss: 2.060 Vali Loss: 1.373 Vali Acc: 0.732 Test Loss: 1.373 Test Acc: 0.732
Validation loss decreased (inf --> -0.732419).  Saving model ...
Epoch: 2 cost time: 1.3726909160614014
Epoch: 2, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.476 Vali Acc: 0.886 Test Loss: 0.476 Test Acc: 0.886
Validation loss decreased (-0.732419 --> -0.886482).  Saving model ...
Epoch: 3 cost time: 1.6271722316741943
Epoch: 3, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.261 Vali Acc: 0.919 Test Loss: 0.261 Test Acc: 0.919
Validation loss decreased (-0.886482 --> -0.918916).  Saving model ...
Epoch: 4 cost time: 1.4903154373168945
Epoch: 4, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
Validation loss decreased (-0.918916 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 1.5164103507995605
Epoch: 5, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
Validation loss decreased (-0.935133 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 1.6171717643737793
Epoch: 6, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7168569564819336
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.430431842803955
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 1.612222671508789
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.389955997467041
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8077940940856934
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 1.4743022918701172
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5668127536773682
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5992460250854492
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6512136459350586
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5081183910369873
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5794949531555176
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4295473098754883
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5641555786132812
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7813520431518555
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5501618385314941
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 129225
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7018814086914062
Epoch: 1, Steps: 17 | Train Loss: 2.097 Vali Loss: 1.437 Vali Acc: 0.757 Test Loss: 1.437 Test Acc: 0.757
Validation loss decreased (inf --> -0.756742).  Saving model ...
Epoch: 2 cost time: 1.1505241394042969
Epoch: 2, Steps: 17 | Train Loss: 0.989 Vali Loss: 0.541 Vali Acc: 0.897 Test Loss: 0.541 Test Acc: 0.897
Validation loss decreased (-0.756742 --> -0.897292).  Saving model ...
Epoch: 3 cost time: 1.1998214721679688
Epoch: 3, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.262 Vali Acc: 0.938 Test Loss: 0.262 Test Acc: 0.938
Validation loss decreased (-0.897292 --> -0.937835).  Saving model ...
Epoch: 4 cost time: 1.1227052211761475
Epoch: 4, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 5 cost time: 1.0153467655181885
Epoch: 5, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.940538 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 1.03513503074646
Epoch: 6, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1023173332214355
Epoch: 7, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0168874263763428
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 1.0693128108978271
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1047601699829102
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0886402130126953
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.116389274597168
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0872700214385986
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0530195236206055
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.101792335510254
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.093156099319458
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0218496322631836
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.061905860900879
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 94793
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.782827854156494
Epoch: 1, Steps: 17 | Train Loss: 2.117 Vali Loss: 1.530 Vali Acc: 0.657 Test Loss: 1.530 Test Acc: 0.657
Validation loss decreased (inf --> -0.656741).  Saving model ...
Epoch: 2 cost time: 1.0663933753967285
Epoch: 2, Steps: 17 | Train Loss: 1.170 Vali Loss: 0.711 Vali Acc: 0.854 Test Loss: 0.711 Test Acc: 0.854
Validation loss decreased (-0.656741 --> -0.854047).  Saving model ...
Epoch: 3 cost time: 0.9890727996826172
Epoch: 3, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.371 Vali Acc: 0.911 Test Loss: 0.371 Test Acc: 0.911
Validation loss decreased (-0.854047 --> -0.910807).  Saving model ...
Epoch: 4 cost time: 1.0504841804504395
Epoch: 4, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
Validation loss decreased (-0.910807 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 1.0743463039398193
Epoch: 5, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 0.9620728492736816
Epoch: 6, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.0383400917053223
Epoch: 7, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0827324390411377
Epoch: 8, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9529445171356201
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 1.0018010139465332
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0362310409545898
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0438530445098877
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.020427942276001
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9376571178436279
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0486462116241455
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0016067028045654
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8585333824157715
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9571516513824463
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0101714134216309
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 87945
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5202932357788086
Epoch: 1, Steps: 17 | Train Loss: 2.003 Vali Loss: 1.663 Vali Acc: 0.530 Test Loss: 1.663 Test Acc: 0.530
Validation loss decreased (inf --> -0.529713).  Saving model ...
Epoch: 2 cost time: 0.9417562484741211
Epoch: 2, Steps: 17 | Train Loss: 1.178 Vali Loss: 0.801 Vali Acc: 0.835 Test Loss: 0.801 Test Acc: 0.835
Validation loss decreased (-0.529713 --> -0.835127).  Saving model ...
Epoch: 3 cost time: 0.9085698127746582
Epoch: 3, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.419 Vali Acc: 0.905 Test Loss: 0.419 Test Acc: 0.905
Validation loss decreased (-0.835127 --> -0.905401).  Saving model ...
Epoch: 4 cost time: 0.8923497200012207
Epoch: 4, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.283 Vali Acc: 0.924 Test Loss: 0.283 Test Acc: 0.924
Validation loss decreased (-0.905401 --> -0.924321).  Saving model ...
Epoch: 5 cost time: 1.1514723300933838
Epoch: 5, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.224 Vali Acc: 0.938 Test Loss: 0.224 Test Acc: 0.938
Validation loss decreased (-0.924321 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 1.1717872619628906
Epoch: 6, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.195 Vali Acc: 0.943 Test Loss: 0.195 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.0320463180541992
Epoch: 7, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 1.066779613494873
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.993166446685791
Epoch: 9, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.021085500717163
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1869003772735596
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.2742397785186768
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.070183515548706
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.143266201019287
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9731771945953369
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 16 cost time: 1.122143268585205
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 1.2449285984039307
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0306305885314941
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0735375881195068
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 1.0275981426239014
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0021955966949463
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9906985759735107
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1647083759307861
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2797918319702148
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.003244161605835
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8720009326934814
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9622559547424316
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0332438945770264
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0914816856384277
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 74249
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9187493324279785
Epoch: 1, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.314 Vali Acc: 0.732 Test Loss: 1.314 Test Acc: 0.732
Validation loss decreased (inf --> -0.732419).  Saving model ...
Epoch: 2 cost time: 1.4256417751312256
Epoch: 2, Steps: 17 | Train Loss: 0.820 Vali Loss: 0.441 Vali Acc: 0.895 Test Loss: 0.441 Test Acc: 0.895
Validation loss decreased (-0.732419 --> -0.894590).  Saving model ...
Epoch: 3 cost time: 1.4840881824493408
Epoch: 3, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.278 Vali Acc: 0.919 Test Loss: 0.278 Test Acc: 0.919
Validation loss decreased (-0.894590 --> -0.918916).  Saving model ...
Epoch: 4 cost time: 0.9794652462005615
Epoch: 4, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
Validation loss decreased (-0.918916 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 1.5396664142608643
Epoch: 5, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4521698951721191
Epoch: 6, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.191 Vali Acc: 0.932 Test Loss: 0.191 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4632647037506104
Epoch: 7, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 8 cost time: 1.414186716079712
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.3638825416564941
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3746097087860107
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.319922685623169
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 1.3776435852050781
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 1.4742064476013184
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5145320892333984
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7054407596588135
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.403968095779419
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.40897798538208
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4879002571105957
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5912036895751953
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4749970436096191
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4233884811401367
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4063973426818848
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 121385
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.675750970840454
Epoch: 1, Steps: 17 | Train Loss: 2.137 Vali Loss: 1.740 Vali Acc: 0.500 Test Loss: 1.740 Test Acc: 0.500
Validation loss decreased (inf --> -0.499983).  Saving model ...
Epoch: 2 cost time: 1.0288832187652588
Epoch: 2, Steps: 17 | Train Loss: 1.326 Vali Loss: 0.883 Vali Acc: 0.830 Test Loss: 0.883 Test Acc: 0.830
Validation loss decreased (-0.499983 --> -0.829721).  Saving model ...
Epoch: 3 cost time: 1.0344161987304688
Epoch: 3, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.421 Vali Acc: 0.905 Test Loss: 0.421 Test Acc: 0.905
Validation loss decreased (-0.829721 --> -0.905401).  Saving model ...
Epoch: 4 cost time: 0.9791872501373291
Epoch: 4, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.278 Vali Acc: 0.932 Test Loss: 0.278 Test Acc: 0.932
Validation loss decreased (-0.905401 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 1.1014313697814941
Epoch: 5, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.214 Vali Acc: 0.946 Test Loss: 0.214 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 0.9349560737609863
Epoch: 6, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.0096313953399658
Epoch: 7, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 0.9800736904144287
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 0.9729642868041992
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0579438209533691
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9838266372680664
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0351147651672363
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.05208158493042
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 1.0121901035308838
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0002970695495605
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.118440866470337
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9466774463653564
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.010357141494751
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 1.0348854064941406
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.139829397201538
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 21 cost time: 0.989717960357666
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9632766246795654
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9868423938751221
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9878640174865723
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9387905597686768
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0767109394073486
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0569586753845215
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9409489631652832
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0228586196899414
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0381271839141846
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 73033
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6974148750305176
Epoch: 1, Steps: 17 | Train Loss: 2.256 Vali Loss: 1.763 Vali Acc: 0.541 Test Loss: 1.763 Test Acc: 0.541
Validation loss decreased (inf --> -0.540523).  Saving model ...
Epoch: 2 cost time: 0.9817755222320557
Epoch: 2, Steps: 17 | Train Loss: 1.489 Vali Loss: 0.964 Vali Acc: 0.851 Test Loss: 0.964 Test Acc: 0.851
Validation loss decreased (-0.540523 --> -0.851342).  Saving model ...
Epoch: 3 cost time: 0.9950056076049805
Epoch: 3, Steps: 17 | Train Loss: 0.790 Vali Loss: 0.493 Vali Acc: 0.919 Test Loss: 0.493 Test Acc: 0.919
Validation loss decreased (-0.851342 --> -0.918914).  Saving model ...
Epoch: 4 cost time: 1.0149757862091064
Epoch: 4, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.306 Vali Acc: 0.938 Test Loss: 0.306 Test Acc: 0.938
Validation loss decreased (-0.918914 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 0.9043619632720947
Epoch: 5, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.230 Vali Acc: 0.938 Test Loss: 0.230 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 0.9577746391296387
Epoch: 6, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.937836 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 0.917250394821167
Epoch: 7, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 1.0568888187408447
Epoch: 8, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0463557243347168
Epoch: 9, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9758825302124023
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0422718524932861
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 12 cost time: 0.9719464778900146
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.0743200778961182
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0873515605926514
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0083167552947998
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.0135102272033691
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0941505432128906
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0769588947296143
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.978705644607544
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.975311279296875
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9270145893096924
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9806392192840576
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 23 cost time: 1.0515689849853516
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9914977550506592
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.058267593383789
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0333480834960938
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1332755088806152
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1734819412231445
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.165684461593628
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1719772815704346
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9656975269317627
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9886610507965088
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 55817
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6766512393951416
Epoch: 1, Steps: 17 | Train Loss: 2.249 Vali Loss: 1.968 Vali Acc: 0.270 Test Loss: 1.968 Test Acc: 0.270
Validation loss decreased (inf --> -0.270251).  Saving model ...
Epoch: 2 cost time: 1.1246423721313477
Epoch: 2, Steps: 17 | Train Loss: 1.644 Vali Loss: 1.219 Vali Acc: 0.768 Test Loss: 1.219 Test Acc: 0.768
Validation loss decreased (-0.270251 --> -0.767555).  Saving model ...
Epoch: 3 cost time: 0.9731185436248779
Epoch: 3, Steps: 17 | Train Loss: 0.949 Vali Loss: 0.660 Vali Acc: 0.862 Test Loss: 0.660 Test Acc: 0.862
Validation loss decreased (-0.767555 --> -0.862156).  Saving model ...
Epoch: 4 cost time: 1.10313081741333
Epoch: 4, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.405 Vali Acc: 0.911 Test Loss: 0.405 Test Acc: 0.911
Validation loss decreased (-0.862156 --> -0.910807).  Saving model ...
Epoch: 5 cost time: 1.073953628540039
Epoch: 5, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
Validation loss decreased (-0.910807 --> -0.921619).  Saving model ...
Epoch: 6 cost time: 1.1397852897644043
Epoch: 6, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
Validation loss decreased (-0.921619 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 1.0673980712890625
Epoch: 7, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.197 Vali Acc: 0.951 Test Loss: 0.197 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951349).  Saving model ...
Epoch: 8 cost time: 1.0108275413513184
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0655999183654785
Epoch: 9, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1152241230010986
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.058382272720337
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0355219841003418
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0205743312835693
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1266343593597412
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1574430465698242
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 1.0126988887786865
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0275239944458008
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2611443996429443
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 19 cost time: 1.064746618270874
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9584193229675293
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0462632179260254
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0370726585388184
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1231389045715332
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2058932781219482
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.96285080909729
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.127007007598877
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0956897735595703
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0930798053741455
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 52393
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5780558586120605
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 1.886 Vali Acc: 0.314 Test Loss: 1.886 Test Acc: 0.314
Validation loss decreased (inf --> -0.313495).  Saving model ...
Epoch: 2 cost time: 0.9773409366607666
Epoch: 2, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.262 Vali Acc: 0.741 Test Loss: 1.262 Test Acc: 0.741
Validation loss decreased (-0.313495 --> -0.740528).  Saving model ...
Epoch: 3 cost time: 0.970250129699707
Epoch: 3, Steps: 17 | Train Loss: 1.017 Vali Loss: 0.732 Vali Acc: 0.851 Test Loss: 0.732 Test Acc: 0.851
Validation loss decreased (-0.740528 --> -0.851344).  Saving model ...
Epoch: 4 cost time: 0.905653715133667
Epoch: 4, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.441 Vali Acc: 0.911 Test Loss: 0.441 Test Acc: 0.911
Validation loss decreased (-0.851344 --> -0.910806).  Saving model ...
Epoch: 5 cost time: 1.0450093746185303
Epoch: 5, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.311 Vali Acc: 0.916 Test Loss: 0.311 Test Acc: 0.916
Validation loss decreased (-0.910806 --> -0.916213).  Saving model ...
Epoch: 6 cost time: 1.1061723232269287
Epoch: 6, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
Validation loss decreased (-0.916213 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 1.1562683582305908
Epoch: 7, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 0.9894464015960693
Epoch: 8, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 0.9962124824523926
Epoch: 9, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 0.9178545475006104
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9645977020263672
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 0.9675440788269043
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0170865058898926
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 14 cost time: 0.9647445678710938
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 0.9979166984558105
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9944090843200684
Epoch: 16, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9492037296295166
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9886972904205322
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.868544340133667
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 20 cost time: 1.055176019668579
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0124990940093994
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0202844142913818
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9836664199829102
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9590075016021729
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9054288864135742
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9286620616912842
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 1.0440645217895508
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.115983486175537
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.078932762145996
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 30 cost time: 0.9316885471343994
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9571957588195801
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9576709270477295
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8842957019805908
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9754338264465332
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9807446002960205
Epoch: 35, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0196566581726074
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9108486175537109
Epoch: 37, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0416252613067627
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9614424705505371
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 45545
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.814979076385498
Epoch: 1, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.201 Vali Acc: 0.776 Test Loss: 1.201 Test Acc: 0.776
Validation loss decreased (inf --> -0.775664).  Saving model ...
Epoch: 2 cost time: 1.2318339347839355
Epoch: 2, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.435 Vali Acc: 0.905 Test Loss: 0.435 Test Acc: 0.905
Validation loss decreased (-0.775664 --> -0.905401).  Saving model ...
Epoch: 3 cost time: 1.237260341644287
Epoch: 3, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.235 Vali Acc: 0.932 Test Loss: 0.235 Test Acc: 0.932
Validation loss decreased (-0.905401 --> -0.932430).  Saving model ...
Epoch: 4 cost time: 1.179244041442871
Epoch: 4, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.200 Vali Acc: 0.938 Test Loss: 0.200 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 5 cost time: 1.3360190391540527
Epoch: 5, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
Validation loss decreased (-0.937836 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 1.1601715087890625
Epoch: 6, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3835086822509766
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3016211986541748
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 9 cost time: 1.3963873386383057
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 1.2545406818389893
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2922639846801758
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1131129264831543
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1322405338287354
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9487206935882568
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4013619422912598
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1486923694610596
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2850258350372314
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.498319149017334
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4935557842254639
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 113065
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.033263921737671
Epoch: 1, Steps: 17 | Train Loss: 2.026 Vali Loss: 1.643 Vali Acc: 0.649 Test Loss: 1.643 Test Acc: 0.649
Validation loss decreased (inf --> -0.648632).  Saving model ...
Epoch: 2 cost time: 1.0727360248565674
Epoch: 2, Steps: 17 | Train Loss: 1.302 Vali Loss: 0.838 Vali Acc: 0.846 Test Loss: 0.838 Test Acc: 0.846
Validation loss decreased (-0.648632 --> -0.845938).  Saving model ...
Epoch: 3 cost time: 1.0461597442626953
Epoch: 3, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.444 Vali Acc: 0.905 Test Loss: 0.444 Test Acc: 0.905
Validation loss decreased (-0.845938 --> -0.905401).  Saving model ...
Epoch: 4 cost time: 1.122837781906128
Epoch: 4, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.274 Vali Acc: 0.924 Test Loss: 0.274 Test Acc: 0.924
Validation loss decreased (-0.905401 --> -0.924322).  Saving model ...
Epoch: 5 cost time: 1.1032345294952393
Epoch: 5, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.220 Vali Acc: 0.932 Test Loss: 0.220 Test Acc: 0.932
Validation loss decreased (-0.924322 --> -0.932430).  Saving model ...
Epoch: 6 cost time: 1.0945746898651123
Epoch: 6, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
Validation loss decreased (-0.932430 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.0181360244750977
Epoch: 7, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 0.9973549842834473
Epoch: 8, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 0.9272027015686035
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9343242645263672
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.021202802658081
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1575026512145996
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1065866947174072
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1558122634887695
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0477869510650635
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 16 cost time: 0.8520843982696533
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9907968044281006
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0088653564453125
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0772275924682617
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 1.0208189487457275
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9444243907928467
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0391929149627686
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0237102508544922
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1097195148468018
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1038718223571777
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1870477199554443
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0036184787750244
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9183676242828369
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0050418376922607
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 64713
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8123319149017334
Epoch: 1, Steps: 17 | Train Loss: 2.150 Vali Loss: 1.800 Vali Acc: 0.416 Test Loss: 1.800 Test Acc: 0.416
Validation loss decreased (inf --> -0.416198).  Saving model ...
Epoch: 2 cost time: 1.126007080078125
Epoch: 2, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.026 Vali Acc: 0.832 Test Loss: 1.026 Test Acc: 0.832
Validation loss decreased (-0.416198 --> -0.832422).  Saving model ...
Epoch: 3 cost time: 1.0440924167633057
Epoch: 3, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.523 Vali Acc: 0.916 Test Loss: 0.523 Test Acc: 0.916
Validation loss decreased (-0.832422 --> -0.916211).  Saving model ...
Epoch: 4 cost time: 1.0594828128814697
Epoch: 4, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.327 Vali Acc: 0.927 Test Loss: 0.327 Test Acc: 0.927
Validation loss decreased (-0.916211 --> -0.927024).  Saving model ...
Epoch: 5 cost time: 1.0244991779327393
Epoch: 5, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.231 Vali Acc: 0.946 Test Loss: 0.231 Test Acc: 0.946
Validation loss decreased (-0.927024 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 0.9961667060852051
Epoch: 6, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 0.9866247177124023
Epoch: 7, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9964809417724609
Epoch: 8, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 1.0158720016479492
Epoch: 9, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9751505851745605
Epoch: 10, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9859321117401123
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1086697578430176
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1339921951293945
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9913840293884277
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9846081733703613
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.037705898284912
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0023596286773682
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 0.9780979156494141
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 1.0585105419158936
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0048596858978271
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9904589653015137
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9653372764587402
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9668371677398682
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8738062381744385
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9484279155731201
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0113022327423096
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0995819568634033
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.182645559310913
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 47497
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6550636291503906
Epoch: 1, Steps: 17 | Train Loss: 2.214 Vali Loss: 1.854 Vali Acc: 0.470 Test Loss: 1.854 Test Acc: 0.470
Validation loss decreased (inf --> -0.470252).  Saving model ...
Epoch: 2 cost time: 1.005852222442627
Epoch: 2, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.168 Vali Acc: 0.765 Test Loss: 1.168 Test Acc: 0.765
Validation loss decreased (-0.470252 --> -0.764853).  Saving model ...
Epoch: 3 cost time: 0.9660835266113281
Epoch: 3, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.665 Vali Acc: 0.876 Test Loss: 0.665 Test Acc: 0.876
Validation loss decreased (-0.764853 --> -0.875669).  Saving model ...
Epoch: 4 cost time: 1.0875332355499268
Epoch: 4, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.418 Vali Acc: 0.892 Test Loss: 0.418 Test Acc: 0.892
Validation loss decreased (-0.875669 --> -0.891888).  Saving model ...
Epoch: 5 cost time: 0.9363279342651367
Epoch: 5, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.305 Vali Acc: 0.927 Test Loss: 0.305 Test Acc: 0.927
Validation loss decreased (-0.891888 --> -0.927024).  Saving model ...
Epoch: 6 cost time: 1.0102593898773193
Epoch: 6, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.927024 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 1.007568359375
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.199 Vali Acc: 0.938 Test Loss: 0.199 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9593822956085205
Epoch: 8, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.0324437618255615
Epoch: 9, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 1.0213994979858398
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9874472618103027
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 0.9733972549438477
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0495965480804443
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9740710258483887
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0018720626831055
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.972435712814331
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9244275093078613
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9676380157470703
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9638683795928955
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9241187572479248
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0863597393035889
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 44073
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7408432960510254
Epoch: 1, Steps: 17 | Train Loss: 2.248 Vali Loss: 2.048 Vali Acc: 0.178 Test Loss: 2.048 Test Acc: 0.178
Validation loss decreased (inf --> -0.178358).  Saving model ...
Epoch: 2 cost time: 1.0255167484283447
Epoch: 2, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.307 Vali Acc: 0.749 Test Loss: 1.307 Test Acc: 0.749
Validation loss decreased (-0.178358 --> -0.748636).  Saving model ...
Epoch: 3 cost time: 1.0018515586853027
Epoch: 3, Steps: 17 | Train Loss: 1.048 Vali Loss: 0.756 Vali Acc: 0.870 Test Loss: 0.756 Test Acc: 0.870
Validation loss decreased (-0.748636 --> -0.870263).  Saving model ...
Epoch: 4 cost time: 0.9796323776245117
Epoch: 4, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.464 Vali Acc: 0.916 Test Loss: 0.464 Test Acc: 0.916
Validation loss decreased (-0.870263 --> -0.916212).  Saving model ...
Epoch: 5 cost time: 1.0554165840148926
Epoch: 5, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.323 Vali Acc: 0.922 Test Loss: 0.323 Test Acc: 0.922
Validation loss decreased (-0.916212 --> -0.921618).  Saving model ...
Epoch: 6 cost time: 1.0596299171447754
Epoch: 6, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.249 Vali Acc: 0.938 Test Loss: 0.249 Test Acc: 0.938
Validation loss decreased (-0.921618 --> -0.937835).  Saving model ...
Epoch: 7 cost time: 1.069821834564209
Epoch: 7, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.0467753410339355
Epoch: 8, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1152491569519043
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.0408682823181152
Epoch: 10, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9468755722045898
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0461909770965576
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.0297555923461914
Epoch: 13, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0071930885314941
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.109515905380249
Epoch: 15, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0582551956176758
Epoch: 16, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0689163208007812
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1205699443817139
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1050236225128174
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1085426807403564
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.005847692489624
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 0.9907324314117432
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.144165277481079
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.110342025756836
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9146914482116699
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9590809345245361
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0243957042694092
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.072054147720337
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1290936470031738
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1566956043243408
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1446247100830078
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 37225
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8307230472564697
Epoch: 1, Steps: 17 | Train Loss: 2.090 Vali Loss: 1.347 Vali Acc: 0.768 Test Loss: 1.347 Test Acc: 0.768
Validation loss decreased (inf --> -0.767554).  Saving model ...
Epoch: 2 cost time: 1.4454894065856934
Epoch: 2, Steps: 17 | Train Loss: 0.916 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
Validation loss decreased (-0.767554 --> -0.899995).  Saving model ...
Epoch: 3 cost time: 1.3740296363830566
Epoch: 3, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.251 Vali Acc: 0.924 Test Loss: 0.251 Test Acc: 0.924
Validation loss decreased (-0.899995 --> -0.924322).  Saving model ...
Epoch: 4 cost time: 1.4952850341796875
Epoch: 4, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.245 Vali Acc: 0.908 Test Loss: 0.245 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4003808498382568
Epoch: 5, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
Validation loss decreased (-0.924322 --> -0.943242).  Saving model ...
Epoch: 6 cost time: 1.3258166313171387
Epoch: 6, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.3774569034576416
Epoch: 7, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.245 Vali Acc: 0.908 Test Loss: 0.245 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3217236995697021
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2558906078338623
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3345947265625
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3305864334106445
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 1.0941107273101807
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 13 cost time: 1.0824575424194336
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.199927806854248
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1544206142425537
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 1.3041391372680664
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.214906930923462
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.193274974822998
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.149895429611206
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2497639656066895
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1759669780731201
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0571298599243164
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1155705451965332
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1306800842285156
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1572628021240234
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 108905
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7800679206848145
Epoch: 1, Steps: 17 | Train Loss: 2.165 Vali Loss: 1.740 Vali Acc: 0.568 Test Loss: 1.740 Test Acc: 0.568
Validation loss decreased (inf --> -0.567550).  Saving model ...
Epoch: 2 cost time: 0.9855833053588867
Epoch: 2, Steps: 17 | Train Loss: 1.361 Vali Loss: 0.906 Vali Acc: 0.851 Test Loss: 0.906 Test Acc: 0.851
Validation loss decreased (-0.567550 --> -0.851342).  Saving model ...
Epoch: 3 cost time: 0.94183349609375
Epoch: 3, Steps: 17 | Train Loss: 0.696 Vali Loss: 0.465 Vali Acc: 0.916 Test Loss: 0.465 Test Acc: 0.916
Validation loss decreased (-0.851342 --> -0.916212).  Saving model ...
Epoch: 4 cost time: 0.8330686092376709
Epoch: 4, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
Validation loss decreased (-0.916212 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 0.9548134803771973
Epoch: 5, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.211 Vali Acc: 0.951 Test Loss: 0.211 Test Acc: 0.951
Validation loss decreased (-0.929727 --> -0.951349).  Saving model ...
Epoch: 6 cost time: 1.0771887302398682
Epoch: 6, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 7 cost time: 0.9627084732055664
Epoch: 7, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 1.1088652610778809
Epoch: 8, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1690316200256348
Epoch: 9, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1425433158874512
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1926617622375488
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.1491479873657227
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0177114009857178
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2784538269042969
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 0.8533356189727783
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0880753993988037
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0435845851898193
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 1.0560359954833984
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1657705307006836
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9374723434448242
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0410091876983643
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0294935703277588
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1164946556091309
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0663185119628906
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0534675121307373
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2091810703277588
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0543608665466309
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 60553
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6713926792144775
Epoch: 1, Steps: 17 | Train Loss: 2.102 Vali Loss: 1.792 Vali Acc: 0.405 Test Loss: 1.792 Test Acc: 0.405
Validation loss decreased (inf --> -0.405387).  Saving model ...
Epoch: 2 cost time: 1.1695547103881836
Epoch: 2, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.020 Vali Acc: 0.789 Test Loss: 1.020 Test Acc: 0.789
Validation loss decreased (-0.405387 --> -0.789179).  Saving model ...
Epoch: 3 cost time: 0.9974696636199951
Epoch: 3, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.538 Vali Acc: 0.892 Test Loss: 0.538 Test Acc: 0.892
Validation loss decreased (-0.789179 --> -0.891887).  Saving model ...
Epoch: 4 cost time: 0.9644811153411865
Epoch: 4, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
Validation loss decreased (-0.891887 --> -0.921618).  Saving model ...
Epoch: 5 cost time: 1.07454252243042
Epoch: 5, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
Validation loss decreased (-0.921618 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 1.0058796405792236
Epoch: 6, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 0.9867579936981201
Epoch: 7, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.0201878547668457
Epoch: 8, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.128171443939209
Epoch: 9, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 10 cost time: 1.1180031299591064
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9432151317596436
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0944337844848633
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9600911140441895
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2063324451446533
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 1.2069904804229736
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.1031317710876465
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 1.119516134262085
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 1.0042393207550049
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.089611291885376
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 0.9294633865356445
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0391700267791748
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 1.0706772804260254
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0387346744537354
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9977254867553711
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1383414268493652
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1586568355560303
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.194310188293457
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2264056205749512
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1880967617034912
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1438698768615723
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.159200668334961
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 43337
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5524790287017822
Epoch: 1, Steps: 17 | Train Loss: 2.233 Vali Loss: 1.912 Vali Acc: 0.343 Test Loss: 1.912 Test Acc: 0.343
Validation loss decreased (inf --> -0.343224).  Saving model ...
Epoch: 2 cost time: 1.2448680400848389
Epoch: 2, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.175 Vali Acc: 0.814 Test Loss: 1.175 Test Acc: 0.814
Validation loss decreased (-0.343224 --> -0.813502).  Saving model ...
Epoch: 3 cost time: 1.1233899593353271
Epoch: 3, Steps: 17 | Train Loss: 0.965 Vali Loss: 0.663 Vali Acc: 0.870 Test Loss: 0.663 Test Acc: 0.870
Validation loss decreased (-0.813502 --> -0.870264).  Saving model ...
Epoch: 4 cost time: 0.9588172435760498
Epoch: 4, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.414 Vali Acc: 0.903 Test Loss: 0.414 Test Acc: 0.903
Validation loss decreased (-0.870264 --> -0.902699).  Saving model ...
Epoch: 5 cost time: 0.9490525722503662
Epoch: 5, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.290 Vali Acc: 0.935 Test Loss: 0.290 Test Acc: 0.935
Validation loss decreased (-0.902699 --> -0.935132).  Saving model ...
Epoch: 6 cost time: 0.9434549808502197
Epoch: 6, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935133).  Saving model ...
Epoch: 7 cost time: 1.0634746551513672
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.200 Vali Acc: 0.938 Test Loss: 0.200 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 8 cost time: 1.0987670421600342
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 1.1250746250152588
Epoch: 9, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 10 cost time: 1.194779872894287
Epoch: 10, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.0155439376831055
Epoch: 11, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9929690361022949
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9574506282806396
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 1.058143138885498
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0068950653076172
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0325524806976318
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9212069511413574
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1709930896759033
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1278131008148193
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9201366901397705
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.930150032043457
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0878753662109375
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0586400032043457
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 39913
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8013765811920166
Epoch: 1, Steps: 17 | Train Loss: 2.122 Vali Loss: 1.890 Vali Acc: 0.349 Test Loss: 1.890 Test Acc: 0.349
Validation loss decreased (inf --> -0.348630).  Saving model ...
Epoch: 2 cost time: 0.96219801902771
Epoch: 2, Steps: 17 | Train Loss: 1.658 Vali Loss: 1.269 Vali Acc: 0.757 Test Loss: 1.269 Test Acc: 0.757
Validation loss decreased (-0.348630 --> -0.756744).  Saving model ...
Epoch: 3 cost time: 1.1763756275177002
Epoch: 3, Steps: 17 | Train Loss: 1.082 Vali Loss: 0.791 Vali Acc: 0.851 Test Loss: 0.791 Test Acc: 0.851
Validation loss decreased (-0.756744 --> -0.851343).  Saving model ...
Epoch: 4 cost time: 1.0125606060028076
Epoch: 4, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.489 Vali Acc: 0.895 Test Loss: 0.489 Test Acc: 0.895
Validation loss decreased (-0.851343 --> -0.894590).  Saving model ...
Epoch: 5 cost time: 1.026628017425537
Epoch: 5, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
Validation loss decreased (-0.894590 --> -0.910807).  Saving model ...
Epoch: 6 cost time: 1.0152130126953125
Epoch: 6, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
Validation loss decreased (-0.910807 --> -0.937835).  Saving model ...
Epoch: 7 cost time: 1.0966453552246094
Epoch: 7, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948646).  Saving model ...
Epoch: 8 cost time: 1.0617091655731201
Epoch: 8, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0450234413146973
Epoch: 9, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.0958244800567627
Epoch: 10, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.0579209327697754
Epoch: 11, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 0.9847257137298584
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.210092306137085
Epoch: 13, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1358141899108887
Epoch: 14, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0399458408355713
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1093862056732178
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.134324312210083
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0567171573638916
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0718417167663574
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.16929030418396
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.048405408859253
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 33065
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7177011966705322
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 1.855 Vali Acc: 0.441 Test Loss: 1.855 Test Acc: 0.441
Validation loss decreased (inf --> -0.440522).  Saving model ...
Epoch: 2 cost time: 0.9866881370544434
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.021 Vali Acc: 0.841 Test Loss: 1.021 Test Acc: 0.841
Validation loss decreased (-0.440522 --> -0.840530).  Saving model ...
Epoch: 3 cost time: 1.0494437217712402
Epoch: 3, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.479 Vali Acc: 0.903 Test Loss: 0.479 Test Acc: 0.903
Validation loss decreased (-0.840530 --> -0.902698).  Saving model ...
Epoch: 4 cost time: 1.141413688659668
Epoch: 4, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.300 Vali Acc: 0.905 Test Loss: 0.300 Test Acc: 0.905
Validation loss decreased (-0.902698 --> -0.905402).  Saving model ...
Epoch: 5 cost time: 1.110776424407959
Epoch: 5, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.215 Vali Acc: 0.938 Test Loss: 0.215 Test Acc: 0.938
Validation loss decreased (-0.905402 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 1.2003827095031738
Epoch: 6, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1311757564544678
Epoch: 7, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.188546895980835
Epoch: 8, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0846037864685059
Epoch: 9, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0195364952087402
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 1.2417867183685303
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 1.208235502243042
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2784552574157715
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 1.2134597301483154
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 1.1102983951568604
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 1.25282621383667
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1856224536895752
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.268556833267212
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2004473209381104
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1979084014892578
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0847690105438232
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0757229328155518
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.24955415725708
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2753164768218994
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2505874633789062
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 59801
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7543461322784424
Epoch: 1, Steps: 17 | Train Loss: 2.286 Vali Loss: 2.086 Vali Acc: 0.238 Test Loss: 2.086 Test Acc: 0.238
Validation loss decreased (inf --> -0.237817).  Saving model ...
Epoch: 2 cost time: 1.0574898719787598
Epoch: 2, Steps: 17 | Train Loss: 1.740 Vali Loss: 1.447 Vali Acc: 0.665 Test Loss: 1.447 Test Acc: 0.665
Validation loss decreased (-0.237817 --> -0.664850).  Saving model ...
Epoch: 3 cost time: 1.0726673603057861
Epoch: 3, Steps: 17 | Train Loss: 1.138 Vali Loss: 0.847 Vali Acc: 0.873 Test Loss: 0.847 Test Acc: 0.873
Validation loss decreased (-0.664850 --> -0.872965).  Saving model ...
Epoch: 4 cost time: 1.042102575302124
Epoch: 4, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.484 Vali Acc: 0.911 Test Loss: 0.484 Test Acc: 0.911
Validation loss decreased (-0.872965 --> -0.910806).  Saving model ...
Epoch: 5 cost time: 1.0049254894256592
Epoch: 5, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
Validation loss decreased (-0.910806 --> -0.921618).  Saving model ...
Epoch: 6 cost time: 1.004831075668335
Epoch: 6, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.248 Vali Acc: 0.924 Test Loss: 0.248 Test Acc: 0.924
Validation loss decreased (-0.921618 --> -0.924322).  Saving model ...
Epoch: 7 cost time: 0.942502498626709
Epoch: 7, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
Validation loss decreased (-0.924322 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 0.9742980003356934
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 0.9383270740509033
Epoch: 9, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 1.0345418453216553
Epoch: 10, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.0070061683654785
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1125361919403076
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 13 cost time: 1.0150959491729736
Epoch: 13, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 1.0658879280090332
Epoch: 14, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 0.9727180004119873
Epoch: 15, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 0.9886610507965088
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.009535789489746
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 18 cost time: 1.0054023265838623
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0272395610809326
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9011063575744629
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0133717060089111
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 22 cost time: 1.0225703716278076
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1111359596252441
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9814052581787109
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 0.9213542938232422
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9655501842498779
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9686069488525391
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.000328779220581
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8413562774658203
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8987388610839844
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9768455028533936
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.93869948387146
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1405246257781982
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9696698188781738
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 35625
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.4960403442382812
Epoch: 1, Steps: 17 | Train Loss: 2.272 Vali Loss: 2.074 Vali Acc: 0.238 Test Loss: 2.074 Test Acc: 0.238
Validation loss decreased (inf --> -0.237817).  Saving model ...
Epoch: 2 cost time: 1.031564474105835
Epoch: 2, Steps: 17 | Train Loss: 1.856 Vali Loss: 1.549 Vali Acc: 0.649 Test Loss: 1.549 Test Acc: 0.649
Validation loss decreased (-0.237817 --> -0.648633).  Saving model ...
Epoch: 3 cost time: 0.9810681343078613
Epoch: 3, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.054 Vali Acc: 0.808 Test Loss: 1.054 Test Acc: 0.808
Validation loss decreased (-0.648633 --> -0.808098).  Saving model ...
Epoch: 4 cost time: 1.0280978679656982
Epoch: 4, Steps: 17 | Train Loss: 0.898 Vali Loss: 0.680 Vali Acc: 0.884 Test Loss: 0.680 Test Acc: 0.884
Validation loss decreased (-0.808098 --> -0.883777).  Saving model ...
Epoch: 5 cost time: 0.9464724063873291
Epoch: 5, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.462 Vali Acc: 0.897 Test Loss: 0.462 Test Acc: 0.897
Validation loss decreased (-0.883777 --> -0.897293).  Saving model ...
Epoch: 6 cost time: 0.9453537464141846
Epoch: 6, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
Validation loss decreased (-0.897293 --> -0.921618).  Saving model ...
Epoch: 7 cost time: 1.0102691650390625
Epoch: 7, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.259 Vali Acc: 0.943 Test Loss: 0.259 Test Acc: 0.943
Validation loss decreased (-0.921618 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 0.9577302932739258
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9586062431335449
Epoch: 9, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.204 Vali Acc: 0.946 Test Loss: 0.204 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 0.9742348194122314
Epoch: 10, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 1.014512062072754
Epoch: 11, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 1.0455880165100098
Epoch: 12, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 13 cost time: 0.9627420902252197
Epoch: 13, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9881787300109863
Epoch: 14, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 0.9188442230224609
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8968296051025391
Epoch: 16, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.883986234664917
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.017481803894043
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9824831485748291
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1091716289520264
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 21 cost time: 1.039942979812622
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 22 cost time: 0.9339840412139893
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9266109466552734
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8466918468475342
Epoch: 24, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.887218713760376
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9059512615203857
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0468990802764893
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9327974319458008
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9994513988494873
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9279839992523193
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.964057207107544
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 27017
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.438873767852783
Epoch: 1, Steps: 17 | Train Loss: 2.441 Vali Loss: 2.231 Vali Acc: 0.132 Test Loss: 2.231 Test Acc: 0.132
Validation loss decreased (inf --> -0.132410).  Saving model ...
Epoch: 2 cost time: 0.9502813816070557
Epoch: 2, Steps: 17 | Train Loss: 2.060 Vali Loss: 1.784 Vali Acc: 0.492 Test Loss: 1.784 Test Acc: 0.492
Validation loss decreased (-0.132410 --> -0.491874).  Saving model ...
Epoch: 3 cost time: 0.8981270790100098
Epoch: 3, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.283 Vali Acc: 0.738 Test Loss: 1.283 Test Acc: 0.738
Validation loss decreased (-0.491874 --> -0.737825).  Saving model ...
Epoch: 4 cost time: 1.0209519863128662
Epoch: 4, Steps: 17 | Train Loss: 1.126 Vali Loss: 0.861 Vali Acc: 0.857 Test Loss: 0.861 Test Acc: 0.857
Validation loss decreased (-0.737825 --> -0.856748).  Saving model ...
Epoch: 5 cost time: 0.94895339012146
Epoch: 5, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.571 Vali Acc: 0.886 Test Loss: 0.571 Test Acc: 0.886
Validation loss decreased (-0.856748 --> -0.886481).  Saving model ...
Epoch: 6 cost time: 0.8973307609558105
Epoch: 6, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.414 Vali Acc: 0.905 Test Loss: 0.414 Test Acc: 0.905
Validation loss decreased (-0.886481 --> -0.905401).  Saving model ...
Epoch: 7 cost time: 1.0512449741363525
Epoch: 7, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
Validation loss decreased (-0.905401 --> -0.921618).  Saving model ...
Epoch: 8 cost time: 0.9563932418823242
Epoch: 8, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.266 Vali Acc: 0.935 Test Loss: 0.266 Test Acc: 0.935
Validation loss decreased (-0.921618 --> -0.935132).  Saving model ...
Epoch: 9 cost time: 1.0475616455078125
Epoch: 9, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.235 Vali Acc: 0.938 Test Loss: 0.235 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 10 cost time: 0.886422872543335
Epoch: 10, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.204 Vali Acc: 0.943 Test Loss: 0.204 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 0.9792232513427734
Epoch: 11, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9285538196563721
Epoch: 12, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 1.0296518802642822
Epoch: 13, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9299948215484619
Epoch: 14, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0159311294555664
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.174 Vali Acc: 0.938 Test Loss: 0.174 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9639027118682861
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.999382734298706
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 0.8785691261291504
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.166 Vali Acc: 0.938 Test Loss: 0.166 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.901639461517334
Epoch: 19, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8783681392669678
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9523653984069824
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9604856967926025
Epoch: 22, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9880609512329102
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 24 cost time: 0.9669981002807617
Epoch: 24, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0250334739685059
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9877619743347168
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9301567077636719
Epoch: 27, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9121193885803223
Epoch: 28, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9126265048980713
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.941 Test Loss: 0.156 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9215312004089355
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.154 Vali Acc: 0.941 Test Loss: 0.154 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.961846113204956
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.152 Vali Acc: 0.941 Test Loss: 0.152 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9989092350006104
Epoch: 32, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.941 Test Loss: 0.155 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9653184413909912
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.943 Test Loss: 0.151 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 25305
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7709267139434814
Epoch: 1, Steps: 17 | Train Loss: 2.246 Vali Loss: 2.124 Vali Acc: 0.138 Test Loss: 2.124 Test Acc: 0.138
Validation loss decreased (inf --> -0.137817).  Saving model ...
Epoch: 2 cost time: 0.9427158832550049
Epoch: 2, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.783 Vali Acc: 0.508 Test Loss: 1.783 Test Acc: 0.508
Validation loss decreased (-0.137817 --> -0.508090).  Saving model ...
Epoch: 3 cost time: 0.8893201351165771
Epoch: 3, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.402 Vali Acc: 0.697 Test Loss: 1.402 Test Acc: 0.697
Validation loss decreased (-0.508090 --> -0.697283).  Saving model ...
Epoch: 4 cost time: 0.8308839797973633
Epoch: 4, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.040 Vali Acc: 0.795 Test Loss: 1.040 Test Acc: 0.795
Validation loss decreased (-0.697283 --> -0.794584).  Saving model ...
Epoch: 5 cost time: 0.9408149719238281
Epoch: 5, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.738 Vali Acc: 0.851 Test Loss: 0.738 Test Acc: 0.851
Validation loss decreased (-0.794584 --> -0.851344).  Saving model ...
Epoch: 6 cost time: 0.9603517055511475
Epoch: 6, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.528 Vali Acc: 0.876 Test Loss: 0.528 Test Acc: 0.876
Validation loss decreased (-0.851344 --> -0.875670).  Saving model ...
Epoch: 7 cost time: 0.8951413631439209
Epoch: 7, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.394 Vali Acc: 0.895 Test Loss: 0.394 Test Acc: 0.895
Validation loss decreased (-0.875670 --> -0.894591).  Saving model ...
Epoch: 8 cost time: 0.9375431537628174
Epoch: 8, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.321 Vali Acc: 0.911 Test Loss: 0.321 Test Acc: 0.911
Validation loss decreased (-0.894591 --> -0.910808).  Saving model ...
Epoch: 9 cost time: 0.9480633735656738
Epoch: 9, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.266 Vali Acc: 0.935 Test Loss: 0.266 Test Acc: 0.935
Validation loss decreased (-0.910808 --> -0.935132).  Saving model ...
Epoch: 10 cost time: 0.9447858333587646
Epoch: 10, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935133).  Saving model ...
Epoch: 11 cost time: 1.0459694862365723
Epoch: 11, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 12 cost time: 1.014183759689331
Epoch: 12, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940538).  Saving model ...
Epoch: 13 cost time: 1.034127950668335
Epoch: 13, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 14 cost time: 0.9717395305633545
Epoch: 14, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 15 cost time: 0.8868117332458496
Epoch: 15, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 16 cost time: 0.8523905277252197
Epoch: 16, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 17 cost time: 0.8805673122406006
Epoch: 17, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 0.8470234870910645
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 19 cost time: 0.8302097320556641
Epoch: 19, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9007821083068848
Epoch: 20, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9024364948272705
Epoch: 21, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8796572685241699
Epoch: 22, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8995828628540039
Epoch: 23, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 0.7891960144042969
Epoch: 24, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.002936840057373
Epoch: 25, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9143812656402588
Epoch: 26, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 27 cost time: 0.9733977317810059
Epoch: 27, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9523141384124756
Epoch: 28, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9570221900939941
Epoch: 29, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9611737728118896
Epoch: 30, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.000924825668335
Epoch: 31, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0123250484466553
Epoch: 32, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9936554431915283
Epoch: 33, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9371521472930908
Epoch: 34, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9752819538116455
Epoch: 35, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9106247425079346
Epoch: 36, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 21881
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5711262226104736
Epoch: 1, Steps: 17 | Train Loss: 2.153 Vali Loss: 1.754 Vali Acc: 0.595 Test Loss: 1.754 Test Acc: 0.595
Validation loss decreased (inf --> -0.594577).  Saving model ...
Epoch: 2 cost time: 1.0236444473266602
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 0.958 Vali Acc: 0.841 Test Loss: 0.958 Test Acc: 0.841
Validation loss decreased (-0.594577 --> -0.840531).  Saving model ...
Epoch: 3 cost time: 1.0189218521118164
Epoch: 3, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.482 Vali Acc: 0.914 Test Loss: 0.482 Test Acc: 0.914
Validation loss decreased (-0.840531 --> -0.913509).  Saving model ...
Epoch: 4 cost time: 0.9298186302185059
Epoch: 4, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.322 Vali Acc: 0.922 Test Loss: 0.322 Test Acc: 0.922
Validation loss decreased (-0.913509 --> -0.921618).  Saving model ...
Epoch: 5 cost time: 0.9309966564178467
Epoch: 5, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.220 Vali Acc: 0.938 Test Loss: 0.220 Test Acc: 0.938
Validation loss decreased (-0.921618 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 0.9197311401367188
Epoch: 6, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.205 Vali Acc: 0.938 Test Loss: 0.205 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 7 cost time: 0.9923217296600342
Epoch: 7, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0441350936889648
Epoch: 8, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.937836 --> -0.954053).  Saving model ...
Epoch: 9 cost time: 0.9648840427398682
Epoch: 9, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 10 cost time: 0.9537744522094727
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9326815605163574
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9738671779632568
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 0.9579999446868896
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9842560291290283
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8762140274047852
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9560081958770752
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.894268274307251
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9764730930328369
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.936704158782959
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9647295475006104
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9546694755554199
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9442112445831299
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 55577
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.430246591567993
Epoch: 1, Steps: 17 | Train Loss: 2.317 Vali Loss: 1.977 Vali Acc: 0.354 Test Loss: 1.977 Test Acc: 0.354
Validation loss decreased (inf --> -0.354034).  Saving model ...
Epoch: 2 cost time: 0.9194016456604004
Epoch: 2, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.398 Vali Acc: 0.705 Test Loss: 1.398 Test Acc: 0.705
Validation loss decreased (-0.354034 --> -0.705391).  Saving model ...
Epoch: 3 cost time: 0.91011643409729
Epoch: 3, Steps: 17 | Train Loss: 1.171 Vali Loss: 0.873 Vali Acc: 0.859 Test Loss: 0.873 Test Acc: 0.859
Validation loss decreased (-0.705391 --> -0.859451).  Saving model ...
Epoch: 4 cost time: 0.9114689826965332
Epoch: 4, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.536 Vali Acc: 0.911 Test Loss: 0.536 Test Acc: 0.911
Validation loss decreased (-0.859451 --> -0.910805).  Saving model ...
Epoch: 5 cost time: 0.8986659049987793
Epoch: 5, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
Validation loss decreased (-0.910805 --> -0.921618).  Saving model ...
Epoch: 6 cost time: 0.8109798431396484
Epoch: 6, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921619).  Saving model ...
Epoch: 7 cost time: 0.8956489562988281
Epoch: 7, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.225 Vali Acc: 0.938 Test Loss: 0.225 Test Acc: 0.938
Validation loss decreased (-0.921619 --> -0.937836).  Saving model ...
Epoch: 8 cost time: 0.8701975345611572
Epoch: 8, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
Validation loss decreased (-0.937836 --> -0.951349).  Saving model ...
Epoch: 9 cost time: 0.8914740085601807
Epoch: 9, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9197642803192139
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9238247871398926
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8490333557128906
Epoch: 12, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8721442222595215
Epoch: 13, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9033946990966797
Epoch: 14, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9307928085327148
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9292459487915039
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8851661682128906
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 18 cost time: 0.9573163986206055
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 19 cost time: 0.8618369102478027
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9745686054229736
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9417035579681396
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9044919013977051
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 23 cost time: 0.8925886154174805
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8822884559631348
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 25 cost time: 0.8648123741149902
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9993724822998047
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9020237922668457
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9310243129730225
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 0.8981537818908691
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9806044101715088
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9280006885528564
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.872788667678833
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.944129228591919
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9083609580993652
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8618497848510742
Epoch: 35, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8363986015319824
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8000497817993164
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9266295433044434
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 31401
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.4296483993530273
Epoch: 1, Steps: 17 | Train Loss: 2.371 Vali Loss: 2.018 Vali Acc: 0.249 Test Loss: 2.018 Test Acc: 0.249
Validation loss decreased (inf --> -0.248628).  Saving model ...
Epoch: 2 cost time: 0.9599153995513916
Epoch: 2, Steps: 17 | Train Loss: 1.941 Vali Loss: 1.452 Vali Acc: 0.732 Test Loss: 1.452 Test Acc: 0.732
Validation loss decreased (-0.248628 --> -0.732418).  Saving model ...
Epoch: 3 cost time: 0.9167649745941162
Epoch: 3, Steps: 17 | Train Loss: 1.344 Vali Loss: 0.964 Vali Acc: 0.878 Test Loss: 0.964 Test Acc: 0.878
Validation loss decreased (-0.732418 --> -0.878369).  Saving model ...
Epoch: 4 cost time: 0.9335331916809082
Epoch: 4, Steps: 17 | Train Loss: 0.890 Vali Loss: 0.611 Vali Acc: 0.911 Test Loss: 0.611 Test Acc: 0.911
Validation loss decreased (-0.878369 --> -0.910805).  Saving model ...
Epoch: 5 cost time: 0.9401988983154297
Epoch: 5, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.410 Vali Acc: 0.919 Test Loss: 0.410 Test Acc: 0.919
Validation loss decreased (-0.910805 --> -0.918915).  Saving model ...
Epoch: 6 cost time: 0.921011209487915
Epoch: 6, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.303 Vali Acc: 0.927 Test Loss: 0.303 Test Acc: 0.927
Validation loss decreased (-0.918915 --> -0.927024).  Saving model ...
Epoch: 7 cost time: 0.8765273094177246
Epoch: 7, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.258 Vali Acc: 0.932 Test Loss: 0.258 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 8 cost time: 0.955927848815918
Epoch: 8, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.224 Vali Acc: 0.938 Test Loss: 0.224 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 9 cost time: 0.9793651103973389
Epoch: 9, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 0.8779029846191406
Epoch: 10, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 0.9493129253387451
Epoch: 11, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 0.9431004524230957
Epoch: 12, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9095211029052734
Epoch: 13, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 0.917017936706543
Epoch: 14, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0089385509490967
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8794131278991699
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 0.8950886726379395
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9852621555328369
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9360928535461426
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8831536769866943
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9612078666687012
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 22 cost time: 0.9208288192749023
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 23 cost time: 0.925915002822876
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8870282173156738
Epoch: 24, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 25 cost time: 0.9027764797210693
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.892120361328125
Epoch: 26, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9111948013305664
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9418787956237793
Epoch: 28, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9680259227752686
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 30 cost time: 1.0249426364898682
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9658348560333252
Epoch: 31, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0495707988739014
Epoch: 32, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0186641216278076
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8829293251037598
Epoch: 34, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9664697647094727
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9401490688323975
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9425516128540039
Epoch: 37, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7961063385009766
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8247292041778564
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 22793
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.58792781829834
Epoch: 1, Steps: 17 | Train Loss: 2.348 Vali Loss: 2.258 Vali Acc: 0.122 Test Loss: 2.258 Test Acc: 0.122
Validation loss decreased (inf --> -0.121599).  Saving model ...
Epoch: 2 cost time: 0.8479485511779785
Epoch: 2, Steps: 17 | Train Loss: 2.057 Vali Loss: 1.796 Vali Acc: 0.435 Test Loss: 1.796 Test Acc: 0.435
Validation loss decreased (-0.121599 --> -0.435117).  Saving model ...
Epoch: 3 cost time: 0.9159789085388184
Epoch: 3, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.327 Vali Acc: 0.697 Test Loss: 1.327 Test Acc: 0.697
Validation loss decreased (-0.435117 --> -0.697284).  Saving model ...
Epoch: 4 cost time: 0.9717302322387695
Epoch: 4, Steps: 17 | Train Loss: 1.114 Vali Loss: 0.938 Vali Acc: 0.824 Test Loss: 0.938 Test Acc: 0.824
Validation loss decreased (-0.697284 --> -0.824315).  Saving model ...
Epoch: 5 cost time: 0.8122832775115967
Epoch: 5, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.636 Vali Acc: 0.881 Test Loss: 0.636 Test Acc: 0.881
Validation loss decreased (-0.824315 --> -0.881075).  Saving model ...
Epoch: 6 cost time: 0.9493780136108398
Epoch: 6, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.881075 --> -0.899995).  Saving model ...
Epoch: 7 cost time: 0.8096239566802979
Epoch: 7, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.349 Vali Acc: 0.922 Test Loss: 0.349 Test Acc: 0.922
Validation loss decreased (-0.899995 --> -0.921618).  Saving model ...
Epoch: 8 cost time: 1.0937347412109375
Epoch: 8, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.284 Vali Acc: 0.927 Test Loss: 0.284 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 9 cost time: 0.9292843341827393
Epoch: 9, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.251 Vali Acc: 0.927 Test Loss: 0.251 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927025).  Saving model ...
Epoch: 10 cost time: 0.9267358779907227
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
Validation loss decreased (-0.927025 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 0.8429269790649414
Epoch: 11, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 0.9449949264526367
Epoch: 12, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.947117805480957
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 0.9282357692718506
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9536371231079102
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9745101928710938
Epoch: 16, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0385470390319824
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9266932010650635
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.164 Vali Acc: 0.938 Test Loss: 0.164 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9511229991912842
Epoch: 19, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9209537506103516
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.00482177734375
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 22 cost time: 0.943009614944458
Epoch: 22, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9511511325836182
Epoch: 23, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8925528526306152
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.170 Vali Acc: 0.935 Test Loss: 0.170 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9166696071624756
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.160 Vali Acc: 0.938 Test Loss: 0.160 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8984806537628174
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9019334316253662
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9272525310516357
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9845747947692871
Epoch: 29, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.941 Test Loss: 0.159 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9522824287414551
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.88958740234375
Epoch: 31, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 21081
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7886693477630615
Epoch: 1, Steps: 17 | Train Loss: 2.290 Vali Loss: 2.113 Vali Acc: 0.186 Test Loss: 2.113 Test Acc: 0.186
Validation loss decreased (inf --> -0.186465).  Saving model ...
Epoch: 2 cost time: 0.9540071487426758
Epoch: 2, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.720 Vali Acc: 0.551 Test Loss: 1.720 Test Acc: 0.551
Validation loss decreased (-0.186465 --> -0.551334).  Saving model ...
Epoch: 3 cost time: 0.9383103847503662
Epoch: 3, Steps: 17 | Train Loss: 1.597 Vali Loss: 1.295 Vali Acc: 0.778 Test Loss: 1.295 Test Acc: 0.778
Validation loss decreased (-0.551334 --> -0.778365).  Saving model ...
Epoch: 4 cost time: 1.011390209197998
Epoch: 4, Steps: 17 | Train Loss: 1.196 Vali Loss: 0.923 Vali Acc: 0.865 Test Loss: 0.923 Test Acc: 0.865
Validation loss decreased (-0.778365 --> -0.864856).  Saving model ...
Epoch: 5 cost time: 0.9162769317626953
Epoch: 5, Steps: 17 | Train Loss: 0.844 Vali Loss: 0.651 Vali Acc: 0.905 Test Loss: 0.651 Test Acc: 0.905
Validation loss decreased (-0.864856 --> -0.905399).  Saving model ...
Epoch: 6 cost time: 0.9029068946838379
Epoch: 6, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.473 Vali Acc: 0.914 Test Loss: 0.473 Test Acc: 0.914
Validation loss decreased (-0.905399 --> -0.913509).  Saving model ...
Epoch: 7 cost time: 0.9109716415405273
Epoch: 7, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.360 Vali Acc: 0.927 Test Loss: 0.360 Test Acc: 0.927
Validation loss decreased (-0.913509 --> -0.927023).  Saving model ...
Epoch: 8 cost time: 0.9364266395568848
Epoch: 8, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929727).  Saving model ...
Epoch: 9 cost time: 0.9684367179870605
Epoch: 9, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.929727 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 0.9538097381591797
Epoch: 10, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9248096942901611
Epoch: 11, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 12 cost time: 0.9589555263519287
Epoch: 12, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 13 cost time: 0.9769566059112549
Epoch: 13, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9759447574615479
Epoch: 14, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9255874156951904
Epoch: 15, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 16 cost time: 0.8337259292602539
Epoch: 16, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 17 cost time: 0.9105415344238281
Epoch: 17, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9197831153869629
Epoch: 18, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 19 cost time: 0.8686103820800781
Epoch: 19, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 20 cost time: 0.926476001739502
Epoch: 20, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 0.9608840942382812
Epoch: 21, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0956125259399414
Epoch: 22, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 23 cost time: 0.9340939521789551
Epoch: 23, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 24 cost time: 0.9030971527099609
Epoch: 24, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.906686544418335
Epoch: 25, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8620989322662354
Epoch: 26, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9380590915679932
Epoch: 27, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9562861919403076
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 29 cost time: 0.9044873714447021
Epoch: 29, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.991464376449585
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8512265682220459
Epoch: 31, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9288578033447266
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7927427291870117
Epoch: 33, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9477932453155518
Epoch: 34, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9365746974945068
Epoch: 35, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7677054405212402
Epoch: 36, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.93607497215271
Epoch: 37, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9265625476837158
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 17657
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5488600730895996
Epoch: 1, Steps: 17 | Train Loss: 2.161 Vali Loss: 1.693 Vali Acc: 0.608 Test Loss: 1.693 Test Acc: 0.608
Validation loss decreased (inf --> -0.608091).  Saving model ...
Epoch: 2 cost time: 0.8732059001922607
Epoch: 2, Steps: 17 | Train Loss: 1.393 Vali Loss: 0.881 Vali Acc: 0.846 Test Loss: 0.881 Test Acc: 0.846
Validation loss decreased (-0.608091 --> -0.845937).  Saving model ...
Epoch: 3 cost time: 0.9747827053070068
Epoch: 3, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.498 Vali Acc: 0.886 Test Loss: 0.498 Test Acc: 0.886
Validation loss decreased (-0.845937 --> -0.886482).  Saving model ...
Epoch: 4 cost time: 0.8879234790802002
Epoch: 4, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.316 Vali Acc: 0.924 Test Loss: 0.316 Test Acc: 0.924
Validation loss decreased (-0.886482 --> -0.924321).  Saving model ...
Epoch: 5 cost time: 0.8311965465545654
Epoch: 5, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9442713260650635
Epoch: 6, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.924321 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 0.9718770980834961
Epoch: 7, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.0348713397979736
Epoch: 8, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0671617984771729
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 1.0443360805511475
Epoch: 10, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0194716453552246
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9719498157501221
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.0081210136413574
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9416494369506836
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 0.94960618019104
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9620199203491211
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8592560291290283
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9775080680847168
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8905625343322754
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.000946044921875
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0387680530548096
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9758563041687012
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9278264045715332
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9339923858642578
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 53465
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6150877475738525
Epoch: 1, Steps: 17 | Train Loss: 2.326 Vali Loss: 1.990 Vali Acc: 0.292 Test Loss: 1.990 Test Acc: 0.292
Validation loss decreased (inf --> -0.291872).  Saving model ...
Epoch: 2 cost time: 0.9143779277801514
Epoch: 2, Steps: 17 | Train Loss: 1.773 Vali Loss: 1.382 Vali Acc: 0.757 Test Loss: 1.382 Test Acc: 0.757
Validation loss decreased (-0.291872 --> -0.756743).  Saving model ...
Epoch: 3 cost time: 0.9753513336181641
Epoch: 3, Steps: 17 | Train Loss: 1.180 Vali Loss: 0.875 Vali Acc: 0.851 Test Loss: 0.875 Test Acc: 0.851
Validation loss decreased (-0.756743 --> -0.851343).  Saving model ...
Epoch: 4 cost time: 0.9216952323913574
Epoch: 4, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.538 Vali Acc: 0.886 Test Loss: 0.538 Test Acc: 0.886
Validation loss decreased (-0.851343 --> -0.886481).  Saving model ...
Epoch: 5 cost time: 0.9054262638092041
Epoch: 5, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.373 Vali Acc: 0.919 Test Loss: 0.373 Test Acc: 0.919
Validation loss decreased (-0.886481 --> -0.918915).  Saving model ...
Epoch: 6 cost time: 0.9078633785247803
Epoch: 6, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.274 Vali Acc: 0.932 Test Loss: 0.274 Test Acc: 0.932
Validation loss decreased (-0.918915 --> -0.932430).  Saving model ...
Epoch: 7 cost time: 0.9007244110107422
Epoch: 7, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 8 cost time: 0.9658083915710449
Epoch: 8, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 9 cost time: 0.9321799278259277
Epoch: 9, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.197 Vali Acc: 0.938 Test Loss: 0.197 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9955663681030273
Epoch: 10, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.181 Vali Acc: 0.935 Test Loss: 0.181 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8730580806732178
Epoch: 11, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 0.9118568897247314
Epoch: 12, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 0.9740934371948242
Epoch: 13, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.07627272605896
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.914607048034668
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9830770492553711
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0530853271484375
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9862551689147949
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1337597370147705
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8953533172607422
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9759066104888916
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.979179859161377
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 29289
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.508086919784546
Epoch: 1, Steps: 17 | Train Loss: 2.347 Vali Loss: 2.137 Vali Acc: 0.181 Test Loss: 2.137 Test Acc: 0.181
Validation loss decreased (inf --> -0.181060).  Saving model ...
Epoch: 2 cost time: 0.9603888988494873
Epoch: 2, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.580 Vali Acc: 0.603 Test Loss: 1.580 Test Acc: 0.603
Validation loss decreased (-0.181060 --> -0.602687).  Saving model ...
Epoch: 3 cost time: 0.8669006824493408
Epoch: 3, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.079 Vali Acc: 0.838 Test Loss: 1.079 Test Acc: 0.838
Validation loss decreased (-0.602687 --> -0.837827).  Saving model ...
Epoch: 4 cost time: 0.9144062995910645
Epoch: 4, Steps: 17 | Train Loss: 0.924 Vali Loss: 0.703 Vali Acc: 0.878 Test Loss: 0.703 Test Acc: 0.878
Validation loss decreased (-0.837827 --> -0.878371).  Saving model ...
Epoch: 5 cost time: 0.9118461608886719
Epoch: 5, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.479 Vali Acc: 0.914 Test Loss: 0.479 Test Acc: 0.914
Validation loss decreased (-0.878371 --> -0.913509).  Saving model ...
Epoch: 6 cost time: 0.9294745922088623
Epoch: 6, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.348 Vali Acc: 0.924 Test Loss: 0.348 Test Acc: 0.924
Validation loss decreased (-0.913509 --> -0.924321).  Saving model ...
Epoch: 7 cost time: 0.8620951175689697
Epoch: 7, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9165654182434082
Epoch: 8, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.243 Vali Acc: 0.927 Test Loss: 0.243 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927025).  Saving model ...
Epoch: 9 cost time: 1.0223875045776367
Epoch: 9, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.226 Vali Acc: 0.932 Test Loss: 0.226 Test Acc: 0.932
Validation loss decreased (-0.927025 --> -0.932430).  Saving model ...
Epoch: 10 cost time: 1.0090885162353516
Epoch: 10, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 1.016692876815796
Epoch: 11, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9934606552124023
Epoch: 12, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9177324771881104
Epoch: 13, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0704357624053955
Epoch: 14, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9201438426971436
Epoch: 15, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 16 cost time: 0.9861016273498535
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.945944 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 0.9777553081512451
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8749411106109619
Epoch: 18, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.000908613204956
Epoch: 19, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9900920391082764
Epoch: 20, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9630846977233887
Epoch: 21, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9651279449462891
Epoch: 22, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.030139684677124
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0217299461364746
Epoch: 24, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8634674549102783
Epoch: 25, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9438579082489014
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 20681
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.670722246170044
Epoch: 1, Steps: 17 | Train Loss: 2.363 Vali Loss: 2.147 Vali Acc: 0.173 Test Loss: 2.147 Test Acc: 0.173
Validation loss decreased (inf --> -0.172952).  Saving model ...
Epoch: 2 cost time: 0.9892911911010742
Epoch: 2, Steps: 17 | Train Loss: 1.982 Vali Loss: 1.732 Vali Acc: 0.481 Test Loss: 1.732 Test Acc: 0.481
Validation loss decreased (-0.172952 --> -0.481064).  Saving model ...
Epoch: 3 cost time: 1.0165278911590576
Epoch: 3, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.275 Vali Acc: 0.735 Test Loss: 1.275 Test Acc: 0.735
Validation loss decreased (-0.481064 --> -0.735122).  Saving model ...
Epoch: 4 cost time: 0.971660852432251
Epoch: 4, Steps: 17 | Train Loss: 1.147 Vali Loss: 0.913 Vali Acc: 0.811 Test Loss: 0.913 Test Acc: 0.811
Validation loss decreased (-0.735122 --> -0.810802).  Saving model ...
Epoch: 5 cost time: 0.8513402938842773
Epoch: 5, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.654 Vali Acc: 0.857 Test Loss: 0.654 Test Acc: 0.857
Validation loss decreased (-0.810802 --> -0.856750).  Saving model ...
Epoch: 6 cost time: 0.9340434074401855
Epoch: 6, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.484 Vali Acc: 0.897 Test Loss: 0.484 Test Acc: 0.897
Validation loss decreased (-0.856750 --> -0.897292).  Saving model ...
Epoch: 7 cost time: 0.8205111026763916
Epoch: 7, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
Validation loss decreased (-0.897292 --> -0.921618).  Saving model ...
Epoch: 8 cost time: 0.9644763469696045
Epoch: 8, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.309 Vali Acc: 0.919 Test Loss: 0.309 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9798593521118164
Epoch: 9, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
Validation loss decreased (-0.921618 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 0.8903121948242188
Epoch: 10, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 11 cost time: 0.8102011680603027
Epoch: 11, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.211 Vali Acc: 0.938 Test Loss: 0.211 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8260469436645508
Epoch: 12, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 0.9055676460266113
Epoch: 13, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.989494800567627
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9991664886474609
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.0080201625823975
Epoch: 16, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 0.8968353271484375
Epoch: 17, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8858726024627686
Epoch: 18, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9258620738983154
Epoch: 19, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9593536853790283
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9583613872528076
Epoch: 21, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8961830139160156
Epoch: 22, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0304481983184814
Epoch: 23, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.009676456451416
Epoch: 24, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1704189777374268
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.943 Test Loss: 0.154 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.076646327972412
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 18969
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.740156888961792
Epoch: 1, Steps: 17 | Train Loss: 2.324 Vali Loss: 2.130 Vali Acc: 0.132 Test Loss: 2.130 Test Acc: 0.132
Validation loss decreased (inf --> -0.132411).  Saving model ...
Epoch: 2 cost time: 1.007535696029663
Epoch: 2, Steps: 17 | Train Loss: 1.980 Vali Loss: 1.724 Vali Acc: 0.541 Test Loss: 1.724 Test Acc: 0.541
Validation loss decreased (-0.132411 --> -0.540523).  Saving model ...
Epoch: 3 cost time: 0.8023955821990967
Epoch: 3, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.308 Vali Acc: 0.816 Test Loss: 1.308 Test Acc: 0.816
Validation loss decreased (-0.540523 --> -0.816203).  Saving model ...
Epoch: 4 cost time: 0.9719300270080566
Epoch: 4, Steps: 17 | Train Loss: 1.201 Vali Loss: 0.949 Vali Acc: 0.854 Test Loss: 0.949 Test Acc: 0.854
Validation loss decreased (-0.816203 --> -0.854045).  Saving model ...
Epoch: 5 cost time: 0.9211926460266113
Epoch: 5, Steps: 17 | Train Loss: 0.864 Vali Loss: 0.687 Vali Acc: 0.878 Test Loss: 0.687 Test Acc: 0.878
Validation loss decreased (-0.854045 --> -0.878372).  Saving model ...
Epoch: 6 cost time: 0.9667501449584961
Epoch: 6, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.492 Vali Acc: 0.911 Test Loss: 0.492 Test Acc: 0.911
Validation loss decreased (-0.878372 --> -0.910806).  Saving model ...
Epoch: 7 cost time: 1.006058692932129
Epoch: 7, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.381 Vali Acc: 0.922 Test Loss: 0.381 Test Acc: 0.922
Validation loss decreased (-0.910806 --> -0.921618).  Saving model ...
Epoch: 8 cost time: 0.9945321083068848
Epoch: 8, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921618).  Saving model ...
Epoch: 9 cost time: 0.9339649677276611
Epoch: 9, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
Validation loss decreased (-0.921618 --> -0.935132).  Saving model ...
Epoch: 10 cost time: 0.9309642314910889
Epoch: 10, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 11 cost time: 0.8631529808044434
Epoch: 11, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.221 Vali Acc: 0.949 Test Loss: 0.221 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 1.141963243484497
Epoch: 12, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9246354103088379
Epoch: 13, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 0.9349315166473389
Epoch: 14, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 15 cost time: 0.9530646800994873
Epoch: 15, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.0160837173461914
Epoch: 16, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 0.9303879737854004
Epoch: 17, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9612529277801514
Epoch: 18, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8722460269927979
Epoch: 19, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9206132888793945
Epoch: 20, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8571927547454834
Epoch: 21, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 22 cost time: 0.943061351776123
Epoch: 22, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9795341491699219
Epoch: 23, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9500386714935303
Epoch: 24, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.942244291305542
Epoch: 25, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9767842292785645
Epoch: 26, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8655381202697754
Epoch: 27, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0983688831329346
Epoch: 28, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0452959537506104
Epoch: 29, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1459541320800781
Epoch: 30, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0558733940124512
Epoch: 31, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_PatchTST_UEA_ftM_sl29_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 15545
model size : 0.37MB
