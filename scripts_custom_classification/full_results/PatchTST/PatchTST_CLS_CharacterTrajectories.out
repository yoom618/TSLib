Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.107823848724365
Epoch: 1, Steps: 89 | Train Loss: 1.185 Vali Loss: 0.633 Vali Acc: 0.813 Test Loss: 0.633 Test Acc: 0.813
Validation loss decreased (inf --> -0.812668).  Saving model ...
Epoch: 2 cost time: 6.175902605056763
Epoch: 2, Steps: 89 | Train Loss: 0.375 Vali Loss: 0.640 Vali Acc: 0.861 Test Loss: 0.640 Test Acc: 0.861
Validation loss decreased (-0.812668 --> -0.860718).  Saving model ...
Epoch: 3 cost time: 7.13320517539978
Epoch: 3, Steps: 89 | Train Loss: 0.360 Vali Loss: 0.374 Vali Acc: 0.916 Test Loss: 0.374 Test Acc: 0.916
Validation loss decreased (-0.860718 --> -0.915734).  Saving model ...
Epoch: 4 cost time: 6.4071738719940186
Epoch: 4, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.489 Vali Acc: 0.896 Test Loss: 0.489 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.717846632003784
Epoch: 5, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.158515453338623
Epoch: 6, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.299 Vali Acc: 0.946 Test Loss: 0.299 Test Acc: 0.946
Validation loss decreased (-0.915734 --> -0.945679).  Saving model ...
Epoch: 7 cost time: 6.3730998039245605
Epoch: 7, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.479 Vali Acc: 0.903 Test Loss: 0.479 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.2287657260894775
Epoch: 8, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.425 Vali Acc: 0.946 Test Loss: 0.425 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.80247950553894
Epoch: 9, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.404 Vali Acc: 0.938 Test Loss: 0.404 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.258867502212524
Epoch: 10, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.335 Vali Acc: 0.958 Test Loss: 0.335 Test Acc: 0.958
Validation loss decreased (-0.945679 --> -0.957518).  Saving model ...
Epoch: 11 cost time: 5.67116904258728
Epoch: 11, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.347 Vali Acc: 0.955 Test Loss: 0.347 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.250917911529541
Epoch: 12, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.557 Vali Acc: 0.961 Test Loss: 0.557 Test Acc: 0.961
Validation loss decreased (-0.957518 --> -0.960997).  Saving model ...
Epoch: 13 cost time: 9.23447036743164
Epoch: 13, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.941 Vali Acc: 0.850 Test Loss: 0.941 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.722623825073242
Epoch: 14, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.638 Vali Acc: 0.930 Test Loss: 0.638 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.127530336380005
Epoch: 15, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.677 Vali Acc: 0.932 Test Loss: 0.677 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.038883209228516
Epoch: 16, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.726 Vali Acc: 0.935 Test Loss: 0.726 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.397131443023682
Epoch: 17, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.392 Vali Acc: 0.954 Test Loss: 0.392 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.979128360748291
Epoch: 18, Steps: 89 | Train Loss: 0.273 Vali Loss: 2.247 Vali Acc: 0.768 Test Loss: 2.247 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.342670440673828
Epoch: 19, Steps: 89 | Train Loss: 0.253 Vali Loss: 1.130 Vali Acc: 0.924 Test Loss: 1.130 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.809948682785034
Epoch: 20, Steps: 89 | Train Loss: 0.191 Vali Loss: 4.449 Vali Acc: 0.765 Test Loss: 4.449 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.332545518875122
Epoch: 21, Steps: 89 | Train Loss: 0.197 Vali Loss: 1.052 Vali Acc: 0.935 Test Loss: 1.052 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.60111927986145
Epoch: 22, Steps: 89 | Train Loss: 0.216 Vali Loss: 1.697 Vali Acc: 0.879 Test Loss: 1.697 Test Acc: 0.879
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 866836
model size : 5.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.887232542037964
Epoch: 1, Steps: 89 | Train Loss: 1.303 Vali Loss: 0.453 Vali Acc: 0.859 Test Loss: 0.453 Test Acc: 0.859
Validation loss decreased (inf --> -0.858631).  Saving model ...
Epoch: 2 cost time: 4.354599714279175
Epoch: 2, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.308 Vali Acc: 0.921 Test Loss: 0.308 Test Acc: 0.921
Validation loss decreased (-0.858631 --> -0.920610).  Saving model ...
Epoch: 3 cost time: 4.610656976699829
Epoch: 3, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.526 Vali Acc: 0.877 Test Loss: 0.526 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.081674098968506
Epoch: 4, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.652 Vali Acc: 0.842 Test Loss: 0.652 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9368348121643066
Epoch: 5, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.399 Vali Acc: 0.917 Test Loss: 0.399 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.4292478561401367
Epoch: 6, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.920610 --> -0.925484).  Saving model ...
Epoch: 7 cost time: 3.5276830196380615
Epoch: 7, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.392 Vali Acc: 0.937 Test Loss: 0.392 Test Acc: 0.937
Validation loss decreased (-0.925484 --> -0.936626).  Saving model ...
Epoch: 8 cost time: 3.586510419845581
Epoch: 8, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.556 Vali Acc: 0.917 Test Loss: 0.556 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.833043813705444
Epoch: 9, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.327 Vali Acc: 0.933 Test Loss: 0.327 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.984318971633911
Epoch: 10, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.552 Vali Acc: 0.913 Test Loss: 0.552 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.362979888916016
Epoch: 11, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.319 Vali Acc: 0.951 Test Loss: 0.319 Test Acc: 0.951
Validation loss decreased (-0.936626 --> -0.951250).  Saving model ...
Epoch: 12 cost time: 9.536131381988525
Epoch: 12, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.659 Vali Acc: 0.930 Test Loss: 0.659 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.338424921035767
Epoch: 13, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.356 Vali Acc: 0.944 Test Loss: 0.356 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.243925333023071
Epoch: 14, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.928 Vali Acc: 0.840 Test Loss: 0.928 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.462188243865967
Epoch: 15, Steps: 89 | Train Loss: 0.124 Vali Loss: 1.027 Vali Acc: 0.806 Test Loss: 1.027 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.812414169311523
Epoch: 16, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.211 Vali Acc: 0.955 Test Loss: 0.211 Test Acc: 0.955
Validation loss decreased (-0.951250 --> -0.954733).  Saving model ...
Epoch: 17 cost time: 8.110964298248291
Epoch: 17, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.972 Vali Acc: 0.838 Test Loss: 0.972 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.375080347061157
Epoch: 18, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.600 Vali Acc: 0.934 Test Loss: 0.600 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.130305051803589
Epoch: 19, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.384 Vali Acc: 0.920 Test Loss: 0.384 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.119362354278564
Epoch: 20, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.856 Vali Acc: 0.884 Test Loss: 0.856 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 8.89976716041565
Epoch: 21, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.402 Vali Acc: 0.964 Test Loss: 0.402 Test Acc: 0.964
Validation loss decreased (-0.954733 --> -0.964481).  Saving model ...
Epoch: 22 cost time: 8.936715841293335
Epoch: 22, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.313 Vali Acc: 0.965 Test Loss: 0.313 Test Acc: 0.965
Validation loss decreased (-0.964481 --> -0.965178).  Saving model ...
Epoch: 23 cost time: 9.707639932632446
Epoch: 23, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.422 Vali Acc: 0.939 Test Loss: 0.422 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.483715295791626
Epoch: 24, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.999 Vali Acc: 0.903 Test Loss: 0.999 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 12.121228694915771
Epoch: 25, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.406 Vali Acc: 0.965 Test Loss: 0.406 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.228118658065796
Epoch: 26, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.351 Vali Acc: 0.956 Test Loss: 0.351 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 9.496582984924316
Epoch: 27, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.635 Vali Acc: 0.928 Test Loss: 0.635 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 10.137628555297852
Epoch: 28, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.506 Vali Acc: 0.951 Test Loss: 0.506 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 10.081860303878784
Epoch: 29, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.431 Vali Acc: 0.954 Test Loss: 0.431 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 8.579371929168701
Epoch: 30, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.649 Vali Acc: 0.940 Test Loss: 0.649 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 8.102503061294556
Epoch: 31, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.642 Vali Acc: 0.933 Test Loss: 0.642 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 8.932085037231445
Epoch: 32, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.536 Vali Acc: 0.955 Test Loss: 0.536 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 675476
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.11107063293457
Epoch: 1, Steps: 89 | Train Loss: 1.334 Vali Loss: 0.456 Vali Acc: 0.870 Test Loss: 0.456 Test Acc: 0.870
Validation loss decreased (inf --> -0.869773).  Saving model ...
Epoch: 2 cost time: 8.586413860321045
Epoch: 2, Steps: 89 | Train Loss: 0.375 Vali Loss: 0.300 Vali Acc: 0.909 Test Loss: 0.300 Test Acc: 0.909
Validation loss decreased (-0.869773 --> -0.908771).  Saving model ...
Epoch: 3 cost time: 6.853041887283325
Epoch: 3, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.224 Vali Acc: 0.934 Test Loss: 0.224 Test Acc: 0.934
Validation loss decreased (-0.908771 --> -0.933842).  Saving model ...
Epoch: 4 cost time: 13.520259857177734
Epoch: 4, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
Validation loss decreased (-0.933842 --> -0.937324).  Saving model ...
Epoch: 5 cost time: 13.56036114692688
Epoch: 5, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.224 Vali Acc: 0.939 Test Loss: 0.224 Test Acc: 0.939
Validation loss decreased (-0.937324 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 12.575082778930664
Epoch: 6, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.715884685516357
Epoch: 7, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.720 Vali Acc: 0.854 Test Loss: 0.720 Test Acc: 0.854
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.637701988220215
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.938716 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 15.675264120101929
Epoch: 9, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.447 Vali Acc: 0.887 Test Loss: 0.447 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 16.826910972595215
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.957519 --> -0.958215).  Saving model ...
Epoch: 11 cost time: 13.872422218322754
Epoch: 11, Steps: 89 | Train Loss: 0.142 Vali Loss: 2.870 Vali Acc: 0.628 Test Loss: 2.870 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.30345916748047
Epoch: 12, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
Validation loss decreased (-0.958215 --> -0.972144).  Saving model ...
Epoch: 13 cost time: 14.553172826766968
Epoch: 13, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.449 Vali Acc: 0.884 Test Loss: 0.449 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.838804483413696
Epoch: 14, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.311 Vali Acc: 0.938 Test Loss: 0.311 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.225736856460571
Epoch: 15, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.216 Vali Acc: 0.964 Test Loss: 0.216 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 13.166324138641357
Epoch: 16, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.427 Vali Acc: 0.942 Test Loss: 0.427 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.858070373535156
Epoch: 17, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.258 Vali Acc: 0.955 Test Loss: 0.258 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.806302309036255
Epoch: 18, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.356 Vali Acc: 0.954 Test Loss: 0.356 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.786066770553589
Epoch: 19, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.318 Vali Acc: 0.953 Test Loss: 0.318 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 15.406224489212036
Epoch: 20, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.317 Vali Acc: 0.953 Test Loss: 0.317 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 15.152741432189941
Epoch: 21, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.428 Vali Acc: 0.945 Test Loss: 0.428 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 13.856530666351318
Epoch: 22, Steps: 89 | Train Loss: 0.129 Vali Loss: 2.239 Vali Acc: 0.779 Test Loss: 2.239 Test Acc: 0.779
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 599188
model size : 4.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.798520088195801
Epoch: 1, Steps: 89 | Train Loss: 1.509 Vali Loss: 0.509 Vali Acc: 0.843 Test Loss: 0.509 Test Acc: 0.843
Validation loss decreased (inf --> -0.843310).  Saving model ...
Epoch: 2 cost time: 4.896251201629639
Epoch: 2, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.290 Vali Acc: 0.914 Test Loss: 0.290 Test Acc: 0.914
Validation loss decreased (-0.843310 --> -0.914343).  Saving model ...
Epoch: 3 cost time: 5.01189112663269
Epoch: 3, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.914343 --> -0.931056).  Saving model ...
Epoch: 4 cost time: 5.202119827270508
Epoch: 4, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.192 Vali Acc: 0.947 Test Loss: 0.192 Test Acc: 0.947
Validation loss decreased (-0.931056 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 5.05509090423584
Epoch: 5, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.947073 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 5.002404689788818
Epoch: 6, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.258 Vali Acc: 0.928 Test Loss: 0.258 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.8191752433776855
Epoch: 7, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.705111980438232
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.951948 --> -0.966572).  Saving model ...
Epoch: 9 cost time: 5.477783441543579
Epoch: 9, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
Validation loss decreased (-0.966572 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 5.2261433601379395
Epoch: 10, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.270 Vali Acc: 0.953 Test Loss: 0.270 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.523716926574707
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.276 Vali Acc: 0.945 Test Loss: 0.276 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.596422910690308
Epoch: 12, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.461061716079712
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.300 Vali Acc: 0.952 Test Loss: 0.300 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.9871015548706055
Epoch: 14, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.275 Vali Acc: 0.948 Test Loss: 0.275 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.127649307250977
Epoch: 15, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.264 Vali Acc: 0.934 Test Loss: 0.264 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.616492986679077
Epoch: 16, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.286 Vali Acc: 0.946 Test Loss: 0.286 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.928851842880249
Epoch: 17, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.287 Vali Acc: 0.940 Test Loss: 0.287 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.713791847229004
Epoch: 18, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.660839080810547
Epoch: 19, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.391 Vali Acc: 0.951 Test Loss: 0.391 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 538388
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.565269470214844
Epoch: 1, Steps: 89 | Train Loss: 1.626 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
Validation loss decreased (inf --> -0.821721).  Saving model ...
Epoch: 2 cost time: 5.226455450057983
Epoch: 2, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.366 Vali Acc: 0.880 Test Loss: 0.366 Test Acc: 0.880
Validation loss decreased (-0.821721 --> -0.879523).  Saving model ...
Epoch: 3 cost time: 5.0251147747039795
Epoch: 3, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.488 Vali Acc: 0.858 Test Loss: 0.488 Test Acc: 0.858
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.199368238449097
Epoch: 4, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.259 Vali Acc: 0.912 Test Loss: 0.259 Test Acc: 0.912
Validation loss decreased (-0.879523 --> -0.912254).  Saving model ...
Epoch: 5 cost time: 5.423656702041626
Epoch: 5, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
Validation loss decreased (-0.912254 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 5.21199631690979
Epoch: 6, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.192710638046265
Epoch: 7, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.959609).  Saving model ...
Epoch: 8 cost time: 5.141119718551636
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.252622604370117
Epoch: 9, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.283 Vali Acc: 0.927 Test Loss: 0.283 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.335973262786865
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.302 Vali Acc: 0.914 Test Loss: 0.302 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.825961589813232
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
Validation loss decreased (-0.959609 --> -0.963787).  Saving model ...
Epoch: 12 cost time: 5.396644115447998
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.429 Vali Acc: 0.898 Test Loss: 0.429 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.101916074752808
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.934372901916504
Epoch: 14, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.323091506958008
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.295487880706787
Epoch: 16, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.999104738235474
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
Validation loss decreased (-0.963787 --> -0.972840).  Saving model ...
Epoch: 18 cost time: 5.399731159210205
Epoch: 18, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.275 Vali Acc: 0.957 Test Loss: 0.275 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.572267770767212
Epoch: 19, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.287 Vali Acc: 0.935 Test Loss: 0.287 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.544726848602295
Epoch: 20, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.382 Vali Acc: 0.910 Test Loss: 0.382 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.468709230422974
Epoch: 21, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.432569742202759
Epoch: 22, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.228 Vali Acc: 0.947 Test Loss: 0.228 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.25685977935791
Epoch: 23, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.5761096477508545
Epoch: 24, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.366 Vali Acc: 0.942 Test Loss: 0.366 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.585458755493164
Epoch: 25, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.235 Vali Acc: 0.953 Test Loss: 0.235 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.361454963684082
Epoch: 26, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.206 Vali Acc: 0.962 Test Loss: 0.206 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.0401434898376465
Epoch: 27, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.224 Vali Acc: 0.946 Test Loss: 0.224 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 501140
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.370008230209351
Epoch: 1, Steps: 89 | Train Loss: 1.774 Vali Loss: 0.749 Vali Acc: 0.769 Test Loss: 0.749 Test Acc: 0.769
Validation loss decreased (inf --> -0.769491).  Saving model ...
Epoch: 2 cost time: 5.517280101776123
Epoch: 2, Steps: 89 | Train Loss: 0.493 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
Validation loss decreased (-0.769491 --> -0.905986).  Saving model ...
Epoch: 3 cost time: 5.583845853805542
Epoch: 3, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.905986 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 5.449901819229126
Epoch: 4, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.155 Vali Acc: 0.953 Test Loss: 0.155 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.487562417984009
Epoch: 5, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.52034592628479
Epoch: 6, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 4.884109973907471
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.025048494338989
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.961698 --> -0.974929).  Saving model ...
Epoch: 9 cost time: 5.101380109786987
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.251869201660156
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.95390772819519
Epoch: 11, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.175807476043701
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.17075514793396
Epoch: 13, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.352431058883667
Epoch: 14, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.077007532119751
Epoch: 15, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.293644189834595
Epoch: 16, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.0963661670684814
Epoch: 17, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.716395139694214
Epoch: 18, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 471572
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.000649929046631
Epoch: 1, Steps: 89 | Train Loss: 1.834 Vali Loss: 0.709 Vali Acc: 0.835 Test Loss: 0.709 Test Acc: 0.835
Validation loss decreased (inf --> -0.834951).  Saving model ...
Epoch: 2 cost time: 4.8631911277771
Epoch: 2, Steps: 89 | Train Loss: 0.518 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
Validation loss decreased (-0.834951 --> -0.905985).  Saving model ...
Epoch: 3 cost time: 4.836995840072632
Epoch: 3, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.206 Vali Acc: 0.940 Test Loss: 0.206 Test Acc: 0.940
Validation loss decreased (-0.905985 --> -0.940109).  Saving model ...
Epoch: 4 cost time: 5.041053295135498
Epoch: 4, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.905177593231201
Epoch: 5, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
Validation loss decreased (-0.940109 --> -0.945681).  Saving model ...
Epoch: 6 cost time: 4.6866114139556885
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.179 Vali Acc: 0.940 Test Loss: 0.179 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.838210344314575
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.945681 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 4.9808433055877686
Epoch: 8, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.811631202697754
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.232665538787842
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.962394).  Saving model ...
Epoch: 11 cost time: 5.095913410186768
Epoch: 11, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.962394 --> -0.970054).  Saving model ...
Epoch: 12 cost time: 4.783371925354004
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.867783784866333
Epoch: 13, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.783230781555176
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.859754800796509
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.229 Vali Acc: 0.951 Test Loss: 0.229 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.472606182098389
Epoch: 16, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.355 Vali Acc: 0.910 Test Loss: 0.355 Test Acc: 0.910
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.379075765609741
Epoch: 17, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.544084310531616
Epoch: 18, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.718541860580444
Epoch: 19, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.518034219741821
Epoch: 20, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.261696100234985
Epoch: 21, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.208 Vali Acc: 0.961 Test Loss: 0.208 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 457364
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.777395725250244
Epoch: 1, Steps: 89 | Train Loss: 1.170 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
Validation loss decreased (inf --> -0.832863).  Saving model ...
Epoch: 2 cost time: 19.852656364440918
Epoch: 2, Steps: 89 | Train Loss: 0.499 Vali Loss: 0.418 Vali Acc: 0.895 Test Loss: 0.418 Test Acc: 0.895
Validation loss decreased (-0.832863 --> -0.894843).  Saving model ...
Epoch: 3 cost time: 20.906670570373535
Epoch: 3, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.331 Vali Acc: 0.935 Test Loss: 0.331 Test Acc: 0.935
Validation loss decreased (-0.894843 --> -0.934537).  Saving model ...
Epoch: 4 cost time: 23.764790296554565
Epoch: 4, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.789341926574707
Epoch: 5, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.934537 --> -0.944287).  Saving model ...
Epoch: 6 cost time: 17.59575343132019
Epoch: 6, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.468 Vali Acc: 0.903 Test Loss: 0.468 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.220263242721558
Epoch: 7, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.411 Vali Acc: 0.919 Test Loss: 0.411 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.615741968154907
Epoch: 8, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.311 Vali Acc: 0.942 Test Loss: 0.311 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 20.868595838546753
Epoch: 9, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.560 Vali Acc: 0.928 Test Loss: 0.560 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 21.822241067886353
Epoch: 10, Steps: 89 | Train Loss: 0.176 Vali Loss: 2.078 Vali Acc: 0.756 Test Loss: 2.078 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 22.567790031433105
Epoch: 11, Steps: 89 | Train Loss: 0.136 Vali Loss: 1.080 Vali Acc: 0.905 Test Loss: 1.080 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 18.260951280593872
Epoch: 12, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.760 Vali Acc: 0.897 Test Loss: 0.760 Test Acc: 0.897
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 16.363482236862183
Epoch: 13, Steps: 89 | Train Loss: 0.200 Vali Loss: 1.330 Vali Acc: 0.843 Test Loss: 1.330 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 20.156073570251465
Epoch: 14, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.944287 --> -0.948466).  Saving model ...
Epoch: 15 cost time: 18.63455295562744
Epoch: 15, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.362 Vali Acc: 0.962 Test Loss: 0.362 Test Acc: 0.962
Validation loss decreased (-0.948466 --> -0.961696).  Saving model ...
Epoch: 16 cost time: 15.534260749816895
Epoch: 16, Steps: 89 | Train Loss: 0.174 Vali Loss: 1.233 Vali Acc: 0.784 Test Loss: 1.233 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 19.52302861213684
Epoch: 17, Steps: 89 | Train Loss: 0.130 Vali Loss: 2.618 Vali Acc: 0.869 Test Loss: 2.618 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 18.447571516036987
Epoch: 18, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.448 Vali Acc: 0.956 Test Loss: 0.448 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 20.761096000671387
Epoch: 19, Steps: 89 | Train Loss: 0.124 Vali Loss: 1.152 Vali Acc: 0.912 Test Loss: 1.152 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 21.579463958740234
Epoch: 20, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.929 Vali Acc: 0.928 Test Loss: 0.929 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 19.332260370254517
Epoch: 21, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.878 Vali Acc: 0.944 Test Loss: 0.878 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 20.73224687576294
Epoch: 22, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.801 Vali Acc: 0.942 Test Loss: 0.801 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 20.10214376449585
Epoch: 23, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.568 Vali Acc: 0.949 Test Loss: 0.568 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 17.967260122299194
Epoch: 24, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.456 Vali Acc: 0.955 Test Loss: 0.456 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 23.408524990081787
Epoch: 25, Steps: 89 | Train Loss: 0.175 Vali Loss: 16.522 Vali Acc: 0.404 Test Loss: 16.522 Test Acc: 0.404
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 768148
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 21.92648148536682
Epoch: 1, Steps: 89 | Train Loss: 1.248 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
Validation loss decreased (inf --> -0.838435).  Saving model ...
Epoch: 2 cost time: 19.544256925582886
Epoch: 2, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.366 Vali Acc: 0.914 Test Loss: 0.366 Test Acc: 0.914
Validation loss decreased (-0.838435 --> -0.914342).  Saving model ...
Epoch: 3 cost time: 18.176332712173462
Epoch: 3, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.251 Vali Acc: 0.923 Test Loss: 0.251 Test Acc: 0.923
Validation loss decreased (-0.914342 --> -0.923396).  Saving model ...
Epoch: 4 cost time: 11.405771017074585
Epoch: 4, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.427 Vali Acc: 0.903 Test Loss: 0.427 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.36201047897339
Epoch: 5, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.353 Vali Acc: 0.915 Test Loss: 0.353 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.286991834640503
Epoch: 6, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.597 Vali Acc: 0.857 Test Loss: 0.597 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.383594751358032
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.367 Vali Acc: 0.928 Test Loss: 0.367 Test Acc: 0.928
Validation loss decreased (-0.923396 --> -0.928269).  Saving model ...
Epoch: 8 cost time: 20.50176501274109
Epoch: 8, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.370 Vali Acc: 0.928 Test Loss: 0.370 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.75550866127014
Epoch: 9, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.749 Vali Acc: 0.874 Test Loss: 0.749 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.823243618011475
Epoch: 10, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.488 Vali Acc: 0.919 Test Loss: 0.488 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.137279748916626
Epoch: 11, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
Validation loss decreased (-0.928269 --> -0.949162).  Saving model ...
Epoch: 12 cost time: 18.33806037902832
Epoch: 12, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.521116018295288
Epoch: 13, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
Validation loss decreased (-0.949162 --> -0.949857).  Saving model ...
Epoch: 14 cost time: 15.1481614112854
Epoch: 14, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.569 Vali Acc: 0.919 Test Loss: 0.569 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 17.559272050857544
Epoch: 15, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.299 Vali Acc: 0.955 Test Loss: 0.299 Test Acc: 0.955
Validation loss decreased (-0.949857 --> -0.955429).  Saving model ...
Epoch: 16 cost time: 17.68246364593506
Epoch: 16, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.868 Vali Acc: 0.909 Test Loss: 0.868 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 16.454834938049316
Epoch: 17, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.434 Vali Acc: 0.943 Test Loss: 0.434 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.697087287902832
Epoch: 18, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.751 Vali Acc: 0.896 Test Loss: 0.751 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 14.435655117034912
Epoch: 19, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.674 Vali Acc: 0.915 Test Loss: 0.674 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 13.293633222579956
Epoch: 20, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.346 Vali Acc: 0.955 Test Loss: 0.346 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 14.645610809326172
Epoch: 21, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.390 Vali Acc: 0.960 Test Loss: 0.390 Test Acc: 0.960
Validation loss decreased (-0.955429 --> -0.960303).  Saving model ...
Epoch: 22 cost time: 10.479633092880249
Epoch: 22, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.562 Vali Acc: 0.955 Test Loss: 0.562 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 13.358556747436523
Epoch: 23, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.331 Vali Acc: 0.953 Test Loss: 0.331 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 13.592889547348022
Epoch: 24, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.256 Vali Acc: 0.973 Test Loss: 0.256 Test Acc: 0.973
Validation loss decreased (-0.960303 --> -0.972839).  Saving model ...
Epoch: 25 cost time: 11.398351907730103
Epoch: 25, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.628 Vali Acc: 0.908 Test Loss: 0.628 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 14.14612340927124
Epoch: 26, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.407 Vali Acc: 0.964 Test Loss: 0.407 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 13.56788444519043
Epoch: 27, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.644 Vali Acc: 0.925 Test Loss: 0.644 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 13.198113918304443
Epoch: 28, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.690 Vali Acc: 0.928 Test Loss: 0.690 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 13.396596193313599
Epoch: 29, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.980 Vali Acc: 0.927 Test Loss: 0.980 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 13.265459060668945
Epoch: 30, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.813 Vali Acc: 0.907 Test Loss: 0.813 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 10.881121397018433
Epoch: 31, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.550 Vali Acc: 0.941 Test Loss: 0.550 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 12.956116914749146
Epoch: 32, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.450 Vali Acc: 0.968 Test Loss: 0.450 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 12.986393928527832
Epoch: 33, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.737 Vali Acc: 0.954 Test Loss: 0.737 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 10.998827457427979
Epoch: 34, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.533 Vali Acc: 0.965 Test Loss: 0.533 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 576788
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.952178239822388
Epoch: 1, Steps: 89 | Train Loss: 1.429 Vali Loss: 0.543 Vali Acc: 0.836 Test Loss: 0.543 Test Acc: 0.836
Validation loss decreased (inf --> -0.835649).  Saving model ...
Epoch: 2 cost time: 13.789482831954956
Epoch: 2, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
Validation loss decreased (-0.835649 --> -0.889272).  Saving model ...
Epoch: 3 cost time: 13.655104398727417
Epoch: 3, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
Validation loss decreased (-0.889272 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 14.759573936462402
Epoch: 4, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.372 Vali Acc: 0.909 Test Loss: 0.372 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.331498622894287
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.211 Vali Acc: 0.955 Test Loss: 0.211 Test Acc: 0.955
Validation loss decreased (-0.929663 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 12.402951002120972
Epoch: 6, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.349 Vali Acc: 0.895 Test Loss: 0.349 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.11103916168213
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.236 Vali Acc: 0.945 Test Loss: 0.236 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.69850444793701
Epoch: 8, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.425294876098633
Epoch: 9, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.390 Vali Acc: 0.917 Test Loss: 0.390 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 17.87265133857727
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.443 Vali Acc: 0.921 Test Loss: 0.443 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 18.989017486572266
Epoch: 11, Steps: 89 | Train Loss: 0.094 Vali Loss: 1.186 Vali Acc: 0.857 Test Loss: 1.186 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 18.846110105514526
Epoch: 12, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.449 Vali Acc: 0.920 Test Loss: 0.449 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 15.875124216079712
Epoch: 13, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.311 Vali Acc: 0.940 Test Loss: 0.311 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 16.39007878303528
Epoch: 14, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.217 Vali Acc: 0.956 Test Loss: 0.217 Test Acc: 0.956
Validation loss decreased (-0.955430 --> -0.956126).  Saving model ...
Epoch: 15 cost time: 15.088386535644531
Epoch: 15, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.706 Vali Acc: 0.880 Test Loss: 0.706 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 16.19780945777893
Epoch: 16, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.228 Vali Acc: 0.953 Test Loss: 0.228 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 16.011377334594727
Epoch: 17, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.259 Vali Acc: 0.960 Test Loss: 0.259 Test Acc: 0.960
Validation loss decreased (-0.956126 --> -0.959607).  Saving model ...
Epoch: 18 cost time: 13.544891119003296
Epoch: 18, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.755 Vali Acc: 0.918 Test Loss: 0.755 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 15.69352102279663
Epoch: 19, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 14.727100372314453
Epoch: 20, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.273 Vali Acc: 0.954 Test Loss: 0.273 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 15.280790090560913
Epoch: 21, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.653 Vali Acc: 0.930 Test Loss: 0.653 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 14.864576578140259
Epoch: 22, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.262 Vali Acc: 0.958 Test Loss: 0.262 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 15.489886283874512
Epoch: 23, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.237 Vali Acc: 0.962 Test Loss: 0.237 Test Acc: 0.962
Validation loss decreased (-0.959607 --> -0.961697).  Saving model ...
Epoch: 24 cost time: 13.857829809188843
Epoch: 24, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.625 Vali Acc: 0.946 Test Loss: 0.625 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 13.126482963562012
Epoch: 25, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.266 Vali Acc: 0.967 Test Loss: 0.266 Test Acc: 0.967
Validation loss decreased (-0.961697 --> -0.966571).  Saving model ...
Epoch: 26 cost time: 14.958075284957886
Epoch: 26, Steps: 89 | Train Loss: 0.140 Vali Loss: 1.021 Vali Acc: 0.920 Test Loss: 1.021 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 14.958057641983032
Epoch: 27, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.348 Vali Acc: 0.952 Test Loss: 0.348 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 14.403489589691162
Epoch: 28, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.794 Vali Acc: 0.917 Test Loss: 0.794 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 14.505290508270264
Epoch: 29, Steps: 89 | Train Loss: 0.141 Vali Loss: 1.878 Vali Acc: 0.709 Test Loss: 1.878 Test Acc: 0.709
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 15.621657371520996
Epoch: 30, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.853 Vali Acc: 0.921 Test Loss: 0.853 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 13.723883628845215
Epoch: 31, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.706 Vali Acc: 0.935 Test Loss: 0.706 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 14.736698389053345
Epoch: 32, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.375 Vali Acc: 0.953 Test Loss: 0.375 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 15.31772232055664
Epoch: 33, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.511 Vali Acc: 0.936 Test Loss: 0.511 Test Acc: 0.936
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 14.676271677017212
Epoch: 34, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.810 Vali Acc: 0.916 Test Loss: 0.810 Test Acc: 0.916
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 16.012336254119873
Epoch: 35, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.661 Vali Acc: 0.919 Test Loss: 0.661 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 500500
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.994605779647827
Epoch: 1, Steps: 89 | Train Loss: 1.492 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
Validation loss decreased (inf --> -0.830774).  Saving model ...
Epoch: 2 cost time: 6.497549295425415
Epoch: 2, Steps: 89 | Train Loss: 0.405 Vali Loss: 0.337 Vali Acc: 0.902 Test Loss: 0.337 Test Acc: 0.902
Validation loss decreased (-0.830774 --> -0.901807).  Saving model ...
Epoch: 3 cost time: 6.593760013580322
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.180 Vali Acc: 0.955 Test Loss: 0.180 Test Acc: 0.955
Validation loss decreased (-0.901807 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 6.6904308795928955
Epoch: 4, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.385 Vali Acc: 0.908 Test Loss: 0.385 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.33434534072876
Epoch: 5, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.372 Vali Acc: 0.896 Test Loss: 0.372 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.03985333442688
Epoch: 6, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.7208404541015625
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.865510702133179
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.218 Vali Acc: 0.940 Test Loss: 0.218 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.606827259063721
Epoch: 9, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.284 Vali Acc: 0.938 Test Loss: 0.284 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.8680243492126465
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.235 Vali Acc: 0.939 Test Loss: 0.235 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.7441136837005615
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.508 Vali Acc: 0.901 Test Loss: 0.508 Test Acc: 0.901
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.7735373973846436
Epoch: 12, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.206 Vali Acc: 0.962 Test Loss: 0.206 Test Acc: 0.962
Validation loss decreased (-0.955430 --> -0.962393).  Saving model ...
Epoch: 13 cost time: 6.764905691146851
Epoch: 13, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.962393 --> -0.970054).  Saving model ...
Epoch: 14 cost time: 6.790561199188232
Epoch: 14, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.655795574188232
Epoch: 15, Steps: 89 | Train Loss: 0.094 Vali Loss: 1.015 Vali Acc: 0.843 Test Loss: 1.015 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.982809066772461
Epoch: 16, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.405 Vali Acc: 0.914 Test Loss: 0.405 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.74506688117981
Epoch: 17, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.255 Vali Acc: 0.948 Test Loss: 0.255 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.605204105377197
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.971447).  Saving model ...
Epoch: 19 cost time: 6.338714122772217
Epoch: 19, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.258 Vali Acc: 0.961 Test Loss: 0.258 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.77067756652832
Epoch: 20, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.341 Vali Acc: 0.936 Test Loss: 0.341 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.842429161071777
Epoch: 21, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.245 Vali Acc: 0.966 Test Loss: 0.245 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.6871418952941895
Epoch: 22, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.269 Vali Acc: 0.967 Test Loss: 0.269 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.261325836181641
Epoch: 23, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.585 Vali Acc: 0.943 Test Loss: 0.585 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.117025136947632
Epoch: 24, Steps: 89 | Train Loss: 0.082 Vali Loss: 1.326 Vali Acc: 0.805 Test Loss: 1.326 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.022008895874023
Epoch: 25, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.367 Vali Acc: 0.951 Test Loss: 0.367 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.127695322036743
Epoch: 26, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.989 Vali Acc: 0.903 Test Loss: 0.989 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.3030781745910645
Epoch: 27, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.337 Vali Acc: 0.960 Test Loss: 0.337 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.6459949016571045
Epoch: 28, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.285 Vali Acc: 0.960 Test Loss: 0.285 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 439700
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.000592231750488
Epoch: 1, Steps: 89 | Train Loss: 1.634 Vali Loss: 0.579 Vali Acc: 0.843 Test Loss: 0.579 Test Acc: 0.843
Validation loss decreased (inf --> -0.843309).  Saving model ...
Epoch: 2 cost time: 5.970498323440552
Epoch: 2, Steps: 89 | Train Loss: 0.404 Vali Loss: 0.461 Vali Acc: 0.868 Test Loss: 0.461 Test Acc: 0.868
Validation loss decreased (-0.843309 --> -0.867683).  Saving model ...
Epoch: 3 cost time: 5.593565940856934
Epoch: 3, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
Validation loss decreased (-0.867683 --> -0.953341).  Saving model ...
Epoch: 4 cost time: 6.0980448722839355
Epoch: 4, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
Validation loss decreased (-0.953341 --> -0.963091).  Saving model ...
Epoch: 5 cost time: 5.802019834518433
Epoch: 5, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.963091 --> -0.965180).  Saving model ...
Epoch: 6 cost time: 6.021657943725586
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.965180 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 6.211066007614136
Epoch: 7, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970055).  Saving model ...
Epoch: 8 cost time: 6.591362714767456
Epoch: 8, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.8179309368133545
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.79847526550293
Epoch: 10, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.269 Vali Acc: 0.938 Test Loss: 0.269 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.752560377120972
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 6.078373670578003
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.537074327468872
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.675771951675415
Epoch: 14, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.735140800476074
Epoch: 15, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.123824834823608
Epoch: 16, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.207387685775757
Epoch: 17, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.344 Vali Acc: 0.927 Test Loss: 0.344 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.302767515182495
Epoch: 18, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.285 Vali Acc: 0.947 Test Loss: 0.285 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.371540069580078
Epoch: 19, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.870058298110962
Epoch: 20, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.232 Vali Acc: 0.952 Test Loss: 0.232 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.784396648406982
Epoch: 21, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 402452
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.71293306350708
Epoch: 1, Steps: 89 | Train Loss: 1.829 Vali Loss: 0.672 Vali Acc: 0.828 Test Loss: 0.672 Test Acc: 0.828
Validation loss decreased (inf --> -0.827988).  Saving model ...
Epoch: 2 cost time: 5.741142272949219
Epoch: 2, Steps: 89 | Train Loss: 0.487 Vali Loss: 0.313 Vali Acc: 0.922 Test Loss: 0.313 Test Acc: 0.922
Validation loss decreased (-0.827988 --> -0.922002).  Saving model ...
Epoch: 3 cost time: 6.607631683349609
Epoch: 3, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
Validation loss decreased (-0.922002 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 6.415668487548828
Epoch: 4, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.175 Vali Acc: 0.939 Test Loss: 0.175 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.223957538604736
Epoch: 5, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.952644 --> -0.966573).  Saving model ...
Epoch: 6 cost time: 6.069013833999634
Epoch: 6, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.984569072723389
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
Validation loss decreased (-0.966573 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 5.8900580406188965
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.205 Vali Acc: 0.936 Test Loss: 0.205 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.174215078353882
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.594509840011597
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.164 Vali Acc: 0.955 Test Loss: 0.164 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.661294937133789
Epoch: 11, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.3298585414886475
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.188 Vali Acc: 0.951 Test Loss: 0.188 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.765229225158691
Epoch: 13, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.7491021156311035
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.968502044677734
Epoch: 15, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.294 Vali Acc: 0.943 Test Loss: 0.294 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.051400661468506
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.731154441833496
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 372884
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.282880306243896
Epoch: 1, Steps: 89 | Train Loss: 1.962 Vali Loss: 0.763 Vali Acc: 0.821 Test Loss: 0.763 Test Acc: 0.821
Validation loss decreased (inf --> -0.821023).  Saving model ...
Epoch: 2 cost time: 6.020758390426636
Epoch: 2, Steps: 89 | Train Loss: 0.538 Vali Loss: 0.332 Vali Acc: 0.904 Test Loss: 0.332 Test Acc: 0.904
Validation loss decreased (-0.821023 --> -0.903896).  Saving model ...
Epoch: 3 cost time: 6.39560604095459
Epoch: 3, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.903896 --> -0.937324).  Saving model ...
Epoch: 4 cost time: 6.304032564163208
Epoch: 4, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.937324 --> -0.944288).  Saving model ...
Epoch: 5 cost time: 6.378251314163208
Epoch: 5, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
Validation loss decreased (-0.944288 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 6.082417011260986
Epoch: 6, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.327788352966309
Epoch: 7, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.963787 --> -0.970055).  Saving model ...
Epoch: 8 cost time: 6.641276121139526
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
Validation loss decreased (-0.970055 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 6.967625856399536
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.932249069213867
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.622558832168579
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 12 cost time: 6.620129346847534
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.849656581878662
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.779338121414185
Epoch: 14, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.572 Vali Acc: 0.899 Test Loss: 0.572 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.22564435005188
Epoch: 15, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.693341970443726
Epoch: 16, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.749522924423218
Epoch: 17, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.37409234046936
Epoch: 18, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.183452844619751
Epoch: 19, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.177 Vali Acc: 0.961 Test Loss: 0.177 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.922215461730957
Epoch: 20, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.816836833953857
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.203 Vali Acc: 0.951 Test Loss: 0.203 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 358676
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.443949699401855
Epoch: 1, Steps: 89 | Train Loss: 1.174 Vali Loss: 0.374 Vali Acc: 0.893 Test Loss: 0.374 Test Acc: 0.893
Validation loss decreased (inf --> -0.892754).  Saving model ...
Epoch: 2 cost time: 15.309736490249634
Epoch: 2, Steps: 89 | Train Loss: 0.408 Vali Loss: 0.484 Vali Acc: 0.884 Test Loss: 0.484 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.323884725570679
Epoch: 3, Steps: 89 | Train Loss: 0.341 Vali Loss: 0.346 Vali Acc: 0.931 Test Loss: 0.346 Test Acc: 0.931
Validation loss decreased (-0.892754 --> -0.931055).  Saving model ...
Epoch: 4 cost time: 15.001698732376099
Epoch: 4, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.338 Vali Acc: 0.932 Test Loss: 0.338 Test Acc: 0.932
Validation loss decreased (-0.931055 --> -0.932448).  Saving model ...
Epoch: 5 cost time: 12.554722785949707
Epoch: 5, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.732 Vali Acc: 0.813 Test Loss: 0.732 Test Acc: 0.813
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.091548681259155
Epoch: 6, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.228 Vali Acc: 0.955 Test Loss: 0.228 Test Acc: 0.955
Validation loss decreased (-0.932448 --> -0.954733).  Saving model ...
Epoch: 7 cost time: 14.909716367721558
Epoch: 7, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.249 Vali Acc: 0.945 Test Loss: 0.249 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.2073073387146
Epoch: 8, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.504 Vali Acc: 0.932 Test Loss: 0.504 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 15.37697458267212
Epoch: 9, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.886 Vali Acc: 0.900 Test Loss: 0.886 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.520065546035767
Epoch: 10, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.722 Vali Acc: 0.909 Test Loss: 0.722 Test Acc: 0.909
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.907658338546753
Epoch: 11, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.548 Vali Acc: 0.933 Test Loss: 0.548 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.139338493347168
Epoch: 12, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.340 Vali Acc: 0.960 Test Loss: 0.340 Test Acc: 0.960
Validation loss decreased (-0.954733 --> -0.959607).  Saving model ...
Epoch: 13 cost time: 14.688611507415771
Epoch: 13, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.276 Vali Acc: 0.960 Test Loss: 0.276 Test Acc: 0.960
Validation loss decreased (-0.959607 --> -0.959607).  Saving model ...
Epoch: 14 cost time: 12.452871799468994
Epoch: 14, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.654 Vali Acc: 0.916 Test Loss: 0.654 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.610574007034302
Epoch: 15, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.774 Vali Acc: 0.938 Test Loss: 0.774 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.0077064037323
Epoch: 16, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.633 Vali Acc: 0.938 Test Loss: 0.633 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 13.921121835708618
Epoch: 17, Steps: 89 | Train Loss: 0.162 Vali Loss: 1.110 Vali Acc: 0.908 Test Loss: 1.110 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.674362659454346
Epoch: 18, Steps: 89 | Train Loss: 0.151 Vali Loss: 1.090 Vali Acc: 0.921 Test Loss: 1.090 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 12.952582597732544
Epoch: 19, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.814 Vali Acc: 0.929 Test Loss: 0.814 Test Acc: 0.929
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 12.016842365264893
Epoch: 20, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.752 Vali Acc: 0.944 Test Loss: 0.752 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 11.168685913085938
Epoch: 21, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.477 Vali Acc: 0.962 Test Loss: 0.477 Test Acc: 0.962
Validation loss decreased (-0.959607 --> -0.962391).  Saving model ...
Epoch: 22 cost time: 11.853647232055664
Epoch: 22, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.349 Vali Acc: 0.971 Test Loss: 0.349 Test Acc: 0.971
Validation loss decreased (-0.962391 --> -0.970749).  Saving model ...
Epoch: 23 cost time: 10.861000299453735
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.986 Vali Acc: 0.934 Test Loss: 0.986 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.711288690567017
Epoch: 24, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.780 Vali Acc: 0.935 Test Loss: 0.780 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 11.427438497543335
Epoch: 25, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.715 Vali Acc: 0.937 Test Loss: 0.715 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 12.598807096481323
Epoch: 26, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.490 Vali Acc: 0.960 Test Loss: 0.490 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 10.452019453048706
Epoch: 27, Steps: 89 | Train Loss: 0.084 Vali Loss: 1.117 Vali Acc: 0.932 Test Loss: 1.117 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 11.776840686798096
Epoch: 28, Steps: 89 | Train Loss: 0.240 Vali Loss: 3.877 Vali Acc: 0.770 Test Loss: 3.877 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 10.654362201690674
Epoch: 29, Steps: 89 | Train Loss: 0.139 Vali Loss: 1.273 Vali Acc: 0.905 Test Loss: 1.273 Test Acc: 0.905
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 12.492165327072144
Epoch: 30, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.591 Vali Acc: 0.965 Test Loss: 0.591 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 11.22340989112854
Epoch: 31, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.863 Vali Acc: 0.947 Test Loss: 0.863 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 9.68392300605774
Epoch: 32, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.979 Vali Acc: 0.941 Test Loss: 0.979 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 718804
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.132866859436035
Epoch: 1, Steps: 89 | Train Loss: 1.273 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
Validation loss decreased (inf --> -0.841221).  Saving model ...
Epoch: 2 cost time: 10.866351127624512
Epoch: 2, Steps: 89 | Train Loss: 0.334 Vali Loss: 0.283 Vali Acc: 0.908 Test Loss: 0.283 Test Acc: 0.908
Validation loss decreased (-0.841221 --> -0.908075).  Saving model ...
Epoch: 3 cost time: 13.3173668384552
Epoch: 3, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.249 Vali Acc: 0.939 Test Loss: 0.249 Test Acc: 0.939
Validation loss decreased (-0.908075 --> -0.939413).  Saving model ...
Epoch: 4 cost time: 9.000684976577759
Epoch: 4, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.321 Vali Acc: 0.915 Test Loss: 0.321 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.673514604568481
Epoch: 5, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.255 Vali Acc: 0.946 Test Loss: 0.255 Test Acc: 0.946
Validation loss decreased (-0.939413 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 11.62800145149231
Epoch: 6, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.850 Vali Acc: 0.862 Test Loss: 0.850 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.75735354423523
Epoch: 7, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.263 Vali Acc: 0.947 Test Loss: 0.263 Test Acc: 0.947
Validation loss decreased (-0.945680 --> -0.947073).  Saving model ...
Epoch: 8 cost time: 10.514979362487793
Epoch: 8, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.256 Vali Acc: 0.943 Test Loss: 0.256 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.78095269203186
Epoch: 9, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.839 Vali Acc: 0.813 Test Loss: 0.839 Test Acc: 0.813
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.331408977508545
Epoch: 10, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.755 Vali Acc: 0.905 Test Loss: 0.755 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.50595235824585
Epoch: 11, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.326 Vali Acc: 0.920 Test Loss: 0.326 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.382202863693237
Epoch: 12, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.643 Vali Acc: 0.905 Test Loss: 0.643 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.649838924407959
Epoch: 13, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.409 Vali Acc: 0.944 Test Loss: 0.409 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.949586391448975
Epoch: 14, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
Validation loss decreased (-0.947073 --> -0.963090).  Saving model ...
Epoch: 15 cost time: 14.227912902832031
Epoch: 15, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.265 Vali Acc: 0.959 Test Loss: 0.265 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.619612693786621
Epoch: 16, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.387 Vali Acc: 0.948 Test Loss: 0.387 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.88443112373352
Epoch: 17, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.818 Vali Acc: 0.916 Test Loss: 0.818 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.545912265777588
Epoch: 18, Steps: 89 | Train Loss: 0.129 Vali Loss: 1.474 Vali Acc: 0.841 Test Loss: 1.474 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.368155241012573
Epoch: 19, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.524 Vali Acc: 0.924 Test Loss: 0.524 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.121374130249023
Epoch: 20, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.944 Vali Acc: 0.907 Test Loss: 0.944 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 11.963269710540771
Epoch: 21, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.332 Vali Acc: 0.968 Test Loss: 0.332 Test Acc: 0.968
Validation loss decreased (-0.963090 --> -0.967963).  Saving model ...
Epoch: 22 cost time: 11.20844554901123
Epoch: 22, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.331 Vali Acc: 0.955 Test Loss: 0.331 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 12.56049633026123
Epoch: 23, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.519 Vali Acc: 0.932 Test Loss: 0.519 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.50357723236084
Epoch: 24, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.555 Vali Acc: 0.946 Test Loss: 0.555 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 12.402262210845947
Epoch: 25, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.579 Vali Acc: 0.948 Test Loss: 0.579 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 11.187728881835938
Epoch: 26, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.803 Vali Acc: 0.927 Test Loss: 0.803 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 13.37433409690857
Epoch: 27, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.441 Vali Acc: 0.961 Test Loss: 0.441 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 12.962172746658325
Epoch: 28, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.405 Vali Acc: 0.951 Test Loss: 0.405 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 11.82343053817749
Epoch: 29, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.302 Vali Acc: 0.957 Test Loss: 0.302 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 11.409969091415405
Epoch: 30, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.381 Vali Acc: 0.955 Test Loss: 0.381 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 11.1686692237854
Epoch: 31, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.582 Vali Acc: 0.953 Test Loss: 0.582 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 527444
model size : 4.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.608688592910767
Epoch: 1, Steps: 89 | Train Loss: 1.381 Vali Loss: 0.573 Vali Acc: 0.838 Test Loss: 0.573 Test Acc: 0.838
Validation loss decreased (inf --> -0.837738).  Saving model ...
Epoch: 2 cost time: 11.814671516418457
Epoch: 2, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
Validation loss decreased (-0.837738 --> -0.930360).  Saving model ...
Epoch: 3 cost time: 11.202625513076782
Epoch: 3, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.259 Vali Acc: 0.923 Test Loss: 0.259 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.40264368057251
Epoch: 4, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.329 Vali Acc: 0.918 Test Loss: 0.329 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.496065616607666
Epoch: 5, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.401 Vali Acc: 0.894 Test Loss: 0.401 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.550986289978027
Epoch: 6, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
Validation loss decreased (-0.930360 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 12.53057861328125
Epoch: 7, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.276 Vali Acc: 0.919 Test Loss: 0.276 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.01019024848938
Epoch: 8, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.955430 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 10.356119155883789
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.478 Vali Acc: 0.907 Test Loss: 0.478 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.02894902229309
Epoch: 10, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.175 Vali Acc: 0.969 Test Loss: 0.175 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.969358).  Saving model ...
Epoch: 11 cost time: 11.596508264541626
Epoch: 11, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.280 Vali Acc: 0.952 Test Loss: 0.280 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.382889747619629
Epoch: 12, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.573 Vali Acc: 0.915 Test Loss: 0.573 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.886391401290894
Epoch: 13, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.267 Vali Acc: 0.948 Test Loss: 0.267 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.753304719924927
Epoch: 14, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.306 Vali Acc: 0.955 Test Loss: 0.306 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.045331478118896
Epoch: 15, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.473104000091553
Epoch: 16, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.677 Vali Acc: 0.917 Test Loss: 0.677 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.11620831489563
Epoch: 17, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.566 Vali Acc: 0.918 Test Loss: 0.566 Test Acc: 0.918
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.666254043579102
Epoch: 18, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.459 Vali Acc: 0.941 Test Loss: 0.459 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.252362966537476
Epoch: 19, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.243 Vali Acc: 0.955 Test Loss: 0.243 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.927163362503052
Epoch: 20, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.446 Vali Acc: 0.949 Test Loss: 0.446 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 451156
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.4633262157440186
Epoch: 1, Steps: 89 | Train Loss: 1.577 Vali Loss: 0.560 Vali Acc: 0.845 Test Loss: 0.560 Test Acc: 0.845
Validation loss decreased (inf --> -0.845398).  Saving model ...
Epoch: 2 cost time: 5.504488468170166
Epoch: 2, Steps: 89 | Train Loss: 0.408 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
Validation loss decreased (-0.845398 --> -0.907378).  Saving model ...
Epoch: 3 cost time: 4.889165878295898
Epoch: 3, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.240 Vali Acc: 0.925 Test Loss: 0.240 Test Acc: 0.925
Validation loss decreased (-0.907378 --> -0.925485).  Saving model ...
Epoch: 4 cost time: 4.885901689529419
Epoch: 4, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.199 Vali Acc: 0.947 Test Loss: 0.199 Test Acc: 0.947
Validation loss decreased (-0.925485 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 5.291050672531128
Epoch: 5, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.279 Vali Acc: 0.932 Test Loss: 0.279 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.874936103820801
Epoch: 6, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.947073 --> -0.957519).  Saving model ...
Epoch: 7 cost time: 5.0760111808776855
Epoch: 7, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.305 Vali Acc: 0.929 Test Loss: 0.305 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.863994836807251
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
Validation loss decreased (-0.957519 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 5.233281373977661
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.964483 --> -0.970054).  Saving model ...
Epoch: 10 cost time: 5.461322546005249
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.970054 --> -0.977018).  Saving model ...
Epoch: 11 cost time: 5.533992052078247
Epoch: 11, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.525972127914429
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.959029912948608
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.204 Vali Acc: 0.946 Test Loss: 0.204 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.564134836196899
Epoch: 14, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.193 Vali Acc: 0.964 Test Loss: 0.193 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.810391664505005
Epoch: 15, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.205 Vali Acc: 0.954 Test Loss: 0.205 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.888206720352173
Epoch: 16, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.747 Vali Acc: 0.876 Test Loss: 0.747 Test Acc: 0.876
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.776865720748901
Epoch: 17, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.306 Vali Acc: 0.951 Test Loss: 0.306 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.2324395179748535
Epoch: 18, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.160 Vali Acc: 0.968 Test Loss: 0.160 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.081378221511841
Epoch: 19, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.246 Vali Acc: 0.960 Test Loss: 0.246 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.90815544128418
Epoch: 20, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.437 Vali Acc: 0.898 Test Loss: 0.437 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 390356
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.920356512069702
Epoch: 1, Steps: 89 | Train Loss: 1.597 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
Validation loss decreased (inf --> -0.841220).  Saving model ...
Epoch: 2 cost time: 5.167022466659546
Epoch: 2, Steps: 89 | Train Loss: 0.438 Vali Loss: 0.316 Vali Acc: 0.905 Test Loss: 0.316 Test Acc: 0.905
Validation loss decreased (-0.841220 --> -0.905289).  Saving model ...
Epoch: 3 cost time: 4.789341926574707
Epoch: 3, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
Validation loss decreased (-0.905289 --> -0.945681).  Saving model ...
Epoch: 4 cost time: 5.1625683307647705
Epoch: 4, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.945681 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 5.136755704879761
Epoch: 5, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.957519 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 5.407716274261475
Epoch: 6, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 5.438691139221191
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.973537).  Saving model ...
Epoch: 8 cost time: 4.924025297164917
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 9 cost time: 5.32916259765625
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.254 Vali Acc: 0.936 Test Loss: 0.254 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.6390745639801025
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.872427940368652
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.472 Vali Acc: 0.915 Test Loss: 0.472 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.895188808441162
Epoch: 12, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.169 Vali Acc: 0.965 Test Loss: 0.169 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.214407682418823
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.993889331817627
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.206 Vali Acc: 0.951 Test Loss: 0.206 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.074116468429565
Epoch: 15, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.202 Vali Acc: 0.955 Test Loss: 0.202 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.167043685913086
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.268650770187378
Epoch: 17, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.367701292037964
Epoch: 18, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.203 Vali Acc: 0.964 Test Loss: 0.203 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 353108
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.132267236709595
Epoch: 1, Steps: 89 | Train Loss: 1.815 Vali Loss: 0.697 Vali Acc: 0.797 Test Loss: 0.697 Test Acc: 0.797
Validation loss decreased (inf --> -0.797347).  Saving model ...
Epoch: 2 cost time: 4.644837856292725
Epoch: 2, Steps: 89 | Train Loss: 0.511 Vali Loss: 0.310 Vali Acc: 0.918 Test Loss: 0.310 Test Acc: 0.918
Validation loss decreased (-0.797347 --> -0.917824).  Saving model ...
Epoch: 3 cost time: 5.318583965301514
Epoch: 3, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.917824 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 6.577377557754517
Epoch: 4, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
Validation loss decreased (-0.929663 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 6.419849395751953
Epoch: 5, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 6.125317335128784
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.963787 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 5.885705471038818
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.422925710678101
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
Validation loss decreased (-0.973536 --> -0.979108).  Saving model ...
Epoch: 9 cost time: 6.198943853378296
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.895780801773071
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.341 Vali Acc: 0.928 Test Loss: 0.341 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.181874990463257
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.8455469608306885
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.162 Vali Acc: 0.955 Test Loss: 0.162 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.437840938568115
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.875610828399658
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.768860816955566
Epoch: 15, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.240228891372681
Epoch: 16, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.780662775039673
Epoch: 17, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.240034341812134
Epoch: 18, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.304 Vali Acc: 0.946 Test Loss: 0.304 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 323540
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.956940174102783
Epoch: 1, Steps: 89 | Train Loss: 1.854 Vali Loss: 0.743 Vali Acc: 0.818 Test Loss: 0.743 Test Acc: 0.818
Validation loss decreased (inf --> -0.817541).  Saving model ...
Epoch: 2 cost time: 5.863014459609985
Epoch: 2, Steps: 89 | Train Loss: 0.532 Vali Loss: 0.326 Vali Acc: 0.913 Test Loss: 0.326 Test Acc: 0.913
Validation loss decreased (-0.817541 --> -0.912949).  Saving model ...
Epoch: 3 cost time: 5.4959352016448975
Epoch: 3, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
Validation loss decreased (-0.912949 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 6.163960933685303
Epoch: 4, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.632072687149048
Epoch: 5, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
Validation loss decreased (-0.951948 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 5.867053985595703
Epoch: 6, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.39845609664917
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.958912 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 5.393677473068237
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 4.952872276306152
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.628619194030762
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 5.733992338180542
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
Validation loss decreased (-0.963787 --> -0.965876).  Saving model ...
Epoch: 12 cost time: 5.368033409118652
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.965876 --> -0.978411).  Saving model ...
Epoch: 13 cost time: 5.080991506576538
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.583132266998291
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.171753644943237
Epoch: 15, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.712819576263428
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.317890405654907
Epoch: 17, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.361721038818359
Epoch: 18, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.208 Vali Acc: 0.955 Test Loss: 0.208 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.657890796661377
Epoch: 19, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.038087606430054
Epoch: 20, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.316693544387817
Epoch: 21, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.032413959503174
Epoch: 22, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm128_nh16_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 309332
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.81663703918457
Epoch: 1, Steps: 89 | Train Loss: 1.306 Vali Loss: 0.595 Vali Acc: 0.831 Test Loss: 0.595 Test Acc: 0.831
Validation loss decreased (inf --> -0.830774).  Saving model ...
Epoch: 2 cost time: 11.426295518875122
Epoch: 2, Steps: 89 | Train Loss: 0.360 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
Validation loss decreased (-0.830774 --> -0.930360).  Saving model ...
Epoch: 3 cost time: 12.02539587020874
Epoch: 3, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.374 Vali Acc: 0.884 Test Loss: 0.374 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.129084825515747
Epoch: 4, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.402 Vali Acc: 0.899 Test Loss: 0.402 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.89257264137268
Epoch: 5, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.223 Vali Acc: 0.952 Test Loss: 0.223 Test Acc: 0.952
Validation loss decreased (-0.930360 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 10.184489011764526
Epoch: 6, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.397 Vali Acc: 0.912 Test Loss: 0.397 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.839245557785034
Epoch: 7, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.231 Vali Acc: 0.952 Test Loss: 0.231 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.62128758430481
Epoch: 8, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.419 Vali Acc: 0.912 Test Loss: 0.419 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.154507875442505
Epoch: 9, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.381 Vali Acc: 0.943 Test Loss: 0.381 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.611602306365967
Epoch: 10, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.292 Vali Acc: 0.948 Test Loss: 0.292 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.141493797302246
Epoch: 11, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.489 Vali Acc: 0.935 Test Loss: 0.489 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.72127628326416
Epoch: 12, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.554 Vali Acc: 0.928 Test Loss: 0.554 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.753318071365356
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.530 Vali Acc: 0.948 Test Loss: 0.530 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.052774429321289
Epoch: 14, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.486 Vali Acc: 0.919 Test Loss: 0.486 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.278186082839966
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.403 Vali Acc: 0.939 Test Loss: 0.403 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 384660
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.630276441574097
Epoch: 1, Steps: 89 | Train Loss: 1.614 Vali Loss: 0.551 Vali Acc: 0.847 Test Loss: 0.551 Test Acc: 0.847
Validation loss decreased (inf --> -0.847488).  Saving model ...
Epoch: 2 cost time: 5.056063652038574
Epoch: 2, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.349 Vali Acc: 0.897 Test Loss: 0.349 Test Acc: 0.897
Validation loss decreased (-0.847488 --> -0.896932).  Saving model ...
Epoch: 3 cost time: 5.814221143722534
Epoch: 3, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.220 Vali Acc: 0.932 Test Loss: 0.220 Test Acc: 0.932
Validation loss decreased (-0.896932 --> -0.932449).  Saving model ...
Epoch: 4 cost time: 5.475738763809204
Epoch: 4, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.310 Vali Acc: 0.908 Test Loss: 0.310 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.398995637893677
Epoch: 5, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.341 Vali Acc: 0.912 Test Loss: 0.341 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.243195056915283
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.359 Vali Acc: 0.895 Test Loss: 0.359 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.1522908210754395
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.932449 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 5.623154401779175
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.068084955215454
Epoch: 9, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.303 Vali Acc: 0.924 Test Loss: 0.303 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.5184550285339355
Epoch: 10, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.584 Vali Acc: 0.862 Test Loss: 0.584 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.330394983291626
Epoch: 11, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.263 Vali Acc: 0.942 Test Loss: 0.263 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.62039041519165
Epoch: 12, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.304 Vali Acc: 0.928 Test Loss: 0.304 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.938755750656128
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.363 Vali Acc: 0.928 Test Loss: 0.363 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.875590801239014
Epoch: 14, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.405 Vali Acc: 0.928 Test Loss: 0.405 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.625330686569214
Epoch: 15, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.334 Vali Acc: 0.946 Test Loss: 0.334 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.541019439697266
Epoch: 16, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.262 Vali Acc: 0.951 Test Loss: 0.262 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.72900128364563
Epoch: 17, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.329 Vali Acc: 0.951 Test Loss: 0.329 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 288980
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.267546653747559
Epoch: 1, Steps: 89 | Train Loss: 1.704 Vali Loss: 0.613 Vali Acc: 0.834 Test Loss: 0.613 Test Acc: 0.834
Validation loss decreased (inf --> -0.834256).  Saving model ...
Epoch: 2 cost time: 6.245084524154663
Epoch: 2, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.290 Vali Acc: 0.916 Test Loss: 0.290 Test Acc: 0.916
Validation loss decreased (-0.834256 --> -0.915735).  Saving model ...
Epoch: 3 cost time: 6.3990466594696045
Epoch: 3, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.220 Vali Acc: 0.940 Test Loss: 0.220 Test Acc: 0.940
Validation loss decreased (-0.915735 --> -0.940109).  Saving model ...
Epoch: 4 cost time: 6.413060665130615
Epoch: 4, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
Validation loss decreased (-0.940109 --> -0.949162).  Saving model ...
Epoch: 5 cost time: 6.19757866859436
Epoch: 5, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.949162 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 6.513756990432739
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.089792728424072
Epoch: 7, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.960305).  Saving model ...
Epoch: 8 cost time: 6.839166641235352
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.813220977783203
Epoch: 9, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
Validation loss decreased (-0.960305 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 6.891739130020142
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.589188098907471
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.890065908432007
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.271839141845703
Epoch: 13, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.566 Vali Acc: 0.854 Test Loss: 0.566 Test Acc: 0.854
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.983712434768677
Epoch: 14, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.269 Vali Acc: 0.939 Test Loss: 0.269 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.59327507019043
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.275652647018433
Epoch: 16, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.171395540237427
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.746062994003296
Epoch: 18, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.294820785522461
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 250836
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.760446310043335
Epoch: 1, Steps: 89 | Train Loss: 1.893 Vali Loss: 0.718 Vali Acc: 0.820 Test Loss: 0.718 Test Acc: 0.820
Validation loss decreased (inf --> -0.819631).  Saving model ...
Epoch: 2 cost time: 7.179786205291748
Epoch: 2, Steps: 89 | Train Loss: 0.535 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
Validation loss decreased (-0.819631 --> -0.890665).  Saving model ...
Epoch: 3 cost time: 6.202850103378296
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.245 Vali Acc: 0.919 Test Loss: 0.245 Test Acc: 0.919
Validation loss decreased (-0.890665 --> -0.919218).  Saving model ...
Epoch: 4 cost time: 6.854381561279297
Epoch: 4, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
Validation loss decreased (-0.919218 --> -0.930360).  Saving model ...
Epoch: 5 cost time: 6.89485502243042
Epoch: 5, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
Validation loss decreased (-0.930360 --> -0.947770).  Saving model ...
Epoch: 6 cost time: 7.074628829956055
Epoch: 6, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.028226375579834
Epoch: 7, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.947770 --> -0.966573).  Saving model ...
Epoch: 8 cost time: 5.955070972442627
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.834881067276001
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.751144647598267
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.966573 --> -0.974929).  Saving model ...
Epoch: 11 cost time: 7.028473615646362
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.321 Vali Acc: 0.905 Test Loss: 0.321 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.352314233779907
Epoch: 12, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.891067981719971
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.177 Vali Acc: 0.939 Test Loss: 0.177 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.856219530105591
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.812085866928101
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.273 Vali Acc: 0.928 Test Loss: 0.273 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.394795656204224
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.736751317977905
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.929720878601074
Epoch: 18, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.237 Vali Acc: 0.942 Test Loss: 0.237 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.777212142944336
Epoch: 19, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.843767166137695
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 220436
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.996243476867676
Epoch: 1, Steps: 89 | Train Loss: 1.981 Vali Loss: 0.838 Vali Acc: 0.779 Test Loss: 0.838 Test Acc: 0.779
Validation loss decreased (inf --> -0.779240).  Saving model ...
Epoch: 2 cost time: 6.166492700576782
Epoch: 2, Steps: 89 | Train Loss: 0.585 Vali Loss: 0.365 Vali Acc: 0.916 Test Loss: 0.365 Test Acc: 0.916
Validation loss decreased (-0.779240 --> -0.915735).  Saving model ...
Epoch: 3 cost time: 6.5090012550354
Epoch: 3, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.239 Vali Acc: 0.925 Test Loss: 0.239 Test Acc: 0.925
Validation loss decreased (-0.915735 --> -0.925485).  Saving model ...
Epoch: 4 cost time: 5.67987322807312
Epoch: 4, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.925485 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 6.496894359588623
Epoch: 5, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.145 Vali Acc: 0.953 Test Loss: 0.145 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.952645).  Saving model ...
Epoch: 6 cost time: 6.595920085906982
Epoch: 6, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.952645 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 6.543447494506836
Epoch: 7, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.965180 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 5.565063714981079
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 9 cost time: 6.444944620132446
Epoch: 9, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.975626 --> -0.980501).  Saving model ...
Epoch: 10 cost time: 6.680970907211304
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.961 Test Loss: 0.124 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.941173076629639
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.24838924407959
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.039250135421753
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.335781574249268
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.143600940704346
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.916991472244263
Epoch: 16, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.513172626495361
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.689942121505737
Epoch: 18, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.354962348937988
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 201812
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.65229868888855
Epoch: 1, Steps: 89 | Train Loss: 2.126 Vali Loss: 0.972 Vali Acc: 0.743 Test Loss: 0.972 Test Acc: 0.743
Validation loss decreased (inf --> -0.743026).  Saving model ...
Epoch: 2 cost time: 6.7253570556640625
Epoch: 2, Steps: 89 | Train Loss: 0.699 Vali Loss: 0.475 Vali Acc: 0.881 Test Loss: 0.475 Test Acc: 0.881
Validation loss decreased (-0.743026 --> -0.880914).  Saving model ...
Epoch: 3 cost time: 6.2886762619018555
Epoch: 3, Steps: 89 | Train Loss: 0.356 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
Validation loss decreased (-0.880914 --> -0.934538).  Saving model ...
Epoch: 4 cost time: 6.533370494842529
Epoch: 4, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.224 Vali Acc: 0.939 Test Loss: 0.224 Test Acc: 0.939
Validation loss decreased (-0.934538 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 6.5743725299835205
Epoch: 5, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.939413 --> -0.965180).  Saving model ...
Epoch: 6 cost time: 5.807393789291382
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.140 Vali Acc: 0.953 Test Loss: 0.140 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.350665330886841
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 5.770550727844238
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.459351301193237
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 4.989200592041016
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.171 Vali Acc: 0.939 Test Loss: 0.171 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.553443431854248
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.786700963973999
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.978411).  Saving model ...
Epoch: 13 cost time: 5.7643883228302
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.567077875137329
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.506506681442261
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.134458303451538
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.049405813217163
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.82415771484375
Epoch: 18, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.8881285190582275
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.580641984939575
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.9075927734375
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.721946716308594
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 187028
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.126850366592407
Epoch: 1, Steps: 89 | Train Loss: 2.294 Vali Loss: 1.133 Vali Acc: 0.737 Test Loss: 1.133 Test Acc: 0.737
Validation loss decreased (inf --> -0.736757).  Saving model ...
Epoch: 2 cost time: 6.863597393035889
Epoch: 2, Steps: 89 | Train Loss: 0.797 Vali Loss: 0.541 Vali Acc: 0.854 Test Loss: 0.541 Test Acc: 0.854
Validation loss decreased (-0.736757 --> -0.854451).  Saving model ...
Epoch: 3 cost time: 6.327395439147949
Epoch: 3, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.339 Vali Acc: 0.912 Test Loss: 0.339 Test Acc: 0.912
Validation loss decreased (-0.854451 --> -0.911557).  Saving model ...
Epoch: 4 cost time: 5.92268443107605
Epoch: 4, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.203 Vali Acc: 0.942 Test Loss: 0.203 Test Acc: 0.942
Validation loss decreased (-0.911557 --> -0.942199).  Saving model ...
Epoch: 5 cost time: 6.047023773193359
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.942199 --> -0.959608).  Saving model ...
Epoch: 6 cost time: 7.1695637702941895
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.393523216247559
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.959608 --> -0.959609).  Saving model ...
Epoch: 8 cost time: 6.59395432472229
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.959609 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 6.311779260635376
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.692056655883789
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.008279085159302
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.432438135147095
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.219744682312012
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.433640003204346
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.006703853607178
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.098005056381226
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.548374176025391
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.604978084564209
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 179924
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.397283792495728
Epoch: 1, Steps: 89 | Train Loss: 1.323 Vali Loss: 0.440 Vali Acc: 0.877 Test Loss: 0.440 Test Acc: 0.877
Validation loss decreased (inf --> -0.876737).  Saving model ...
Epoch: 2 cost time: 12.777642965316772
Epoch: 2, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.291 Vali Acc: 0.915 Test Loss: 0.291 Test Acc: 0.915
Validation loss decreased (-0.876737 --> -0.915039).  Saving model ...
Epoch: 3 cost time: 17.793760061264038
Epoch: 3, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.278 Vali Acc: 0.920 Test Loss: 0.278 Test Acc: 0.920
Validation loss decreased (-0.915039 --> -0.919914).  Saving model ...
Epoch: 4 cost time: 17.11355972290039
Epoch: 4, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
Validation loss decreased (-0.919914 --> -0.949162).  Saving model ...
Epoch: 5 cost time: 17.161329984664917
Epoch: 5, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.295 Vali Acc: 0.943 Test Loss: 0.295 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.762370586395264
Epoch: 6, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949162 --> -0.949858).  Saving model ...
Epoch: 7 cost time: 18.49727487564087
Epoch: 7, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.076536655426025
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.289 Vali Acc: 0.951 Test Loss: 0.289 Test Acc: 0.951
Validation loss decreased (-0.949858 --> -0.951251).  Saving model ...
Epoch: 9 cost time: 16.575358629226685
Epoch: 9, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.991 Vali Acc: 0.869 Test Loss: 0.991 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.881092548370361
Epoch: 10, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.517 Vali Acc: 0.907 Test Loss: 0.517 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.24218225479126
Epoch: 11, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.214 Vali Acc: 0.960 Test Loss: 0.214 Test Acc: 0.960
Validation loss decreased (-0.951251 --> -0.959608).  Saving model ...
Epoch: 12 cost time: 16.98232126235962
Epoch: 12, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.358 Vali Acc: 0.928 Test Loss: 0.358 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.18283724784851
Epoch: 13, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.309 Vali Acc: 0.955 Test Loss: 0.309 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 14.931041240692139
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.548 Vali Acc: 0.914 Test Loss: 0.548 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.934718608856201
Epoch: 15, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.212 Vali Acc: 0.972 Test Loss: 0.212 Test Acc: 0.972
Validation loss decreased (-0.959608 --> -0.972143).  Saving model ...
Epoch: 16 cost time: 14.965097904205322
Epoch: 16, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.491 Vali Acc: 0.921 Test Loss: 0.491 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.48030400276184
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.445 Vali Acc: 0.932 Test Loss: 0.445 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 16.176564931869507
Epoch: 18, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.303 Vali Acc: 0.962 Test Loss: 0.303 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.596604585647583
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.307 Vali Acc: 0.971 Test Loss: 0.307 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 14.618059396743774
Epoch: 20, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.376 Vali Acc: 0.958 Test Loss: 0.376 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 15.40659761428833
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.320 Vali Acc: 0.966 Test Loss: 0.320 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 14.9281485080719
Epoch: 22, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.820 Vali Acc: 0.892 Test Loss: 0.820 Test Acc: 0.892
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 15.431076288223267
Epoch: 23, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.344 Vali Acc: 0.959 Test Loss: 0.344 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 14.919271469116211
Epoch: 24, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.689 Vali Acc: 0.900 Test Loss: 0.689 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 14.243497371673584
Epoch: 25, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.396 Vali Acc: 0.963 Test Loss: 0.396 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 335124
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.903834819793701
Epoch: 1, Steps: 89 | Train Loss: 1.603 Vali Loss: 0.609 Vali Acc: 0.823 Test Loss: 0.609 Test Acc: 0.823
Validation loss decreased (inf --> -0.823114).  Saving model ...
Epoch: 2 cost time: 6.724758625030518
Epoch: 2, Steps: 89 | Train Loss: 0.436 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
Validation loss decreased (-0.823114 --> -0.903200).  Saving model ...
Epoch: 3 cost time: 6.689955949783325
Epoch: 3, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.903200 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 6.514225482940674
Epoch: 4, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.81481409072876
Epoch: 5, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.943591 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 7.795808553695679
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.233554363250732
Epoch: 7, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.237 Vali Acc: 0.938 Test Loss: 0.237 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.039501905441284
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.032614231109619
Epoch: 9, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.237 Vali Acc: 0.946 Test Loss: 0.237 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.270182132720947
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.732013702392578
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.955 Vali Acc: 0.838 Test Loss: 0.955 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.339568376541138
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.378 Vali Acc: 0.940 Test Loss: 0.378 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.4251697063446045
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.298 Vali Acc: 0.942 Test Loss: 0.298 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.921811580657959
Epoch: 14, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.436 Vali Acc: 0.921 Test Loss: 0.436 Test Acc: 0.921
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.956008672714233
Epoch: 15, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.275 Vali Acc: 0.957 Test Loss: 0.275 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 239444
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.380496263504028
Epoch: 1, Steps: 89 | Train Loss: 1.713 Vali Loss: 0.619 Vali Acc: 0.836 Test Loss: 0.619 Test Acc: 0.836
Validation loss decreased (inf --> -0.836345).  Saving model ...
Epoch: 2 cost time: 6.866561412811279
Epoch: 2, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.308 Vali Acc: 0.915 Test Loss: 0.308 Test Acc: 0.915
Validation loss decreased (-0.836345 --> -0.915039).  Saving model ...
Epoch: 3 cost time: 6.6181628704071045
Epoch: 3, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.206 Vali Acc: 0.940 Test Loss: 0.206 Test Acc: 0.940
Validation loss decreased (-0.915039 --> -0.940109).  Saving model ...
Epoch: 4 cost time: 5.955304384231567
Epoch: 4, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
Validation loss decreased (-0.940109 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 6.1792988777160645
Epoch: 5, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.9731035232543945
Epoch: 6, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.146 Vali Acc: 0.955 Test Loss: 0.146 Test Acc: 0.955
Validation loss decreased (-0.953341 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 6.8682544231414795
Epoch: 7, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.157715797424316
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.075515985488892
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.955430 --> -0.956823).  Saving model ...
Epoch: 10 cost time: 6.699175119400024
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 7.257553339004517
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.963787 --> -0.965180).  Saving model ...
Epoch: 12 cost time: 7.503755331039429
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.965180 --> -0.970054).  Saving model ...
Epoch: 13 cost time: 7.1050803661346436
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.587452411651611
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.197 Vali Acc: 0.955 Test Loss: 0.197 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.313454866409302
Epoch: 15, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.109434127807617
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.254 Vali Acc: 0.946 Test Loss: 0.254 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.805333852767944
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.227 Vali Acc: 0.945 Test Loss: 0.227 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.18169903755188
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.353870153427124
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.2557079792022705
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.282 Vali Acc: 0.942 Test Loss: 0.282 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.717893838882446
Epoch: 21, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.349858999252319
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.974233).  Saving model ...
Epoch: 23 cost time: 6.265406131744385
Epoch: 23, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.276 Vali Acc: 0.958 Test Loss: 0.276 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.672995090484619
Epoch: 24, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.356 Vali Acc: 0.940 Test Loss: 0.356 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.24421238899231
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.116263389587402
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.9446282386779785
Epoch: 27, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.281 Vali Acc: 0.942 Test Loss: 0.281 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.051894426345825
Epoch: 28, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.616923570632935
Epoch: 29, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.204 Vali Acc: 0.970 Test Loss: 0.204 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.136750936508179
Epoch: 30, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.184 Vali Acc: 0.969 Test Loss: 0.184 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.8446125984191895
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.378 Vali Acc: 0.943 Test Loss: 0.378 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.321013927459717
Epoch: 32, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.241 Vali Acc: 0.971 Test Loss: 0.241 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 201300
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.159644365310669
Epoch: 1, Steps: 89 | Train Loss: 1.902 Vali Loss: 0.727 Vali Acc: 0.812 Test Loss: 0.727 Test Acc: 0.812
Validation loss decreased (inf --> -0.811970).  Saving model ...
Epoch: 2 cost time: 6.107590198516846
Epoch: 2, Steps: 89 | Train Loss: 0.530 Vali Loss: 0.380 Vali Acc: 0.888 Test Loss: 0.380 Test Acc: 0.888
Validation loss decreased (-0.811970 --> -0.887879).  Saving model ...
Epoch: 3 cost time: 6.381802797317505
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.887879 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 6.416893243789673
Epoch: 4, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.929663 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 7.497796058654785
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.159 Vali Acc: 0.953 Test Loss: 0.159 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.853785753250122
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.982991933822632
Epoch: 7, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.962394 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 6.555489540100098
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.674500465393066
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.626189470291138
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.489905118942261
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 12 cost time: 6.304514408111572
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.273 Vali Acc: 0.923 Test Loss: 0.273 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.967549085617065
Epoch: 13, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.107295513153076
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 15 cost time: 6.3904032707214355
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.426 Vali Acc: 0.917 Test Loss: 0.426 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.437013864517212
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.682052850723267
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.035976409912109
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.0538246631622314
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.767703533172607
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.109045028686523
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.792909145355225
Epoch: 22, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.162 Vali Acc: 0.966 Test Loss: 0.162 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.93527626991272
Epoch: 23, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.228 Vali Acc: 0.947 Test Loss: 0.228 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.881673574447632
Epoch: 24, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 170900
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.957352876663208
Epoch: 1, Steps: 89 | Train Loss: 2.047 Vali Loss: 0.889 Vali Acc: 0.796 Test Loss: 0.889 Test Acc: 0.796
Validation loss decreased (inf --> -0.795952).  Saving model ...
Epoch: 2 cost time: 6.04132080078125
Epoch: 2, Steps: 89 | Train Loss: 0.614 Vali Loss: 0.400 Vali Acc: 0.884 Test Loss: 0.400 Test Acc: 0.884
Validation loss decreased (-0.795952 --> -0.883701).  Saving model ...
Epoch: 3 cost time: 6.078566074371338
Epoch: 3, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
Validation loss decreased (-0.883701 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 5.59304404258728
Epoch: 4, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
Validation loss decreased (-0.941502 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 5.601640462875366
Epoch: 5, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
Validation loss decreased (-0.945680 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 5.910522937774658
Epoch: 6, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 5.943765163421631
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
Validation loss decreased (-0.966573 --> -0.967269).  Saving model ...
Epoch: 8 cost time: 5.953162670135498
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.851612567901611
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 10 cost time: 5.917385101318359
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.966446161270142
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.106905221939087
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.053771018981934
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 6.130824565887451
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.655140399932861
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.1159632205963135
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.513117074966431
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 6.468348979949951
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.2613525390625
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.837218523025513
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.565696716308594
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 22 cost time: 5.882057428359985
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.70933723449707
Epoch: 23, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.090671539306641
Epoch: 24, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.60994029045105
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.58964991569519
Epoch: 26, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.330 Vali Acc: 0.933 Test Loss: 0.330 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.945953130722046
Epoch: 27, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.215 Vali Acc: 0.966 Test Loss: 0.215 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.930533170700073
Epoch: 28, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.9309704303741455
Epoch: 29, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.8718788623809814
Epoch: 30, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.794686794281006
Epoch: 31, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 152276
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.097736835479736
Epoch: 1, Steps: 89 | Train Loss: 2.201 Vali Loss: 1.036 Vali Acc: 0.797 Test Loss: 1.036 Test Acc: 0.797
Validation loss decreased (inf --> -0.796647).  Saving model ...
Epoch: 2 cost time: 5.474503517150879
Epoch: 2, Steps: 89 | Train Loss: 0.752 Vali Loss: 0.509 Vali Acc: 0.859 Test Loss: 0.509 Test Acc: 0.859
Validation loss decreased (-0.796647 --> -0.859326).  Saving model ...
Epoch: 3 cost time: 5.19340968132019
Epoch: 3, Steps: 89 | Train Loss: 0.397 Vali Loss: 0.284 Vali Acc: 0.932 Test Loss: 0.284 Test Acc: 0.932
Validation loss decreased (-0.859326 --> -0.931752).  Saving model ...
Epoch: 4 cost time: 5.061981201171875
Epoch: 4, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.931752 --> -0.944288).  Saving model ...
Epoch: 5 cost time: 5.112084627151489
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
Validation loss decreased (-0.944288 --> -0.953341).  Saving model ...
Epoch: 6 cost time: 5.0618860721588135
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.953341 --> -0.968662).  Saving model ...
Epoch: 7 cost time: 5.613625526428223
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 5.412392616271973
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.136 Vali Acc: 0.956 Test Loss: 0.136 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.353450775146484
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.507166862487793
Epoch: 10, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.526008367538452
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.380035877227783
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.538870096206665
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.358239412307739
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.151204347610474
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.960330009460449
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.387224435806274
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 5.434504508972168
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.275819778442383
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.2484259605407715
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.061192750930786
Epoch: 21, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.089761734008789
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.952678918838501
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.983286).  Saving model ...
Epoch: 24 cost time: 5.297393083572388
Epoch: 24, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.350429058074951
Epoch: 25, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.02846622467041
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.105268716812134
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.89872932434082
Epoch: 28, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.7733635902404785
Epoch: 29, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.106076717376709
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.547088861465454
Epoch: 31, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.203670263290405
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.526743173599243
Epoch: 33, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.175 Vali Acc: 0.970 Test Loss: 0.175 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 137492
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.052173852920532
Epoch: 1, Steps: 89 | Train Loss: 2.292 Vali Loss: 1.138 Vali Acc: 0.756 Test Loss: 1.138 Test Acc: 0.756
Validation loss decreased (inf --> -0.756256).  Saving model ...
Epoch: 2 cost time: 5.117945432662964
Epoch: 2, Steps: 89 | Train Loss: 0.831 Vali Loss: 0.526 Vali Acc: 0.859 Test Loss: 0.526 Test Acc: 0.859
Validation loss decreased (-0.756256 --> -0.858630).  Saving model ...
Epoch: 3 cost time: 5.0760862827301025
Epoch: 3, Steps: 89 | Train Loss: 0.442 Vali Loss: 0.316 Vali Acc: 0.919 Test Loss: 0.316 Test Acc: 0.919
Validation loss decreased (-0.858630 --> -0.918521).  Saving model ...
Epoch: 4 cost time: 5.316771030426025
Epoch: 4, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.222 Vali Acc: 0.942 Test Loss: 0.222 Test Acc: 0.942
Validation loss decreased (-0.918521 --> -0.942198).  Saving model ...
Epoch: 5 cost time: 5.643238067626953
Epoch: 5, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
Validation loss decreased (-0.942198 --> -0.945681).  Saving model ...
Epoch: 6 cost time: 5.452641010284424
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.945681 --> -0.970751).  Saving model ...
Epoch: 7 cost time: 5.343214511871338
Epoch: 7, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.775771379470825
Epoch: 8, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 6.026373863220215
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 5.9790871143341064
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.782235860824585
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.132403135299683
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 13 cost time: 5.938856601715088
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.25716495513916
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 15 cost time: 5.769076347351074
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.967 Test Loss: 0.092 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.48060154914856
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.680062294006348
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.138315677642822
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.033628463745117
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.172499656677246
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 21 cost time: 7.820915222167969
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.569023609161377
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.245003700256348
Epoch: 23, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.5244927406311035
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.292249441146851
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.879456043243408
Epoch: 26, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 7.948588848114014
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 8.200085163116455
Epoch: 28, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.063440799713135
Epoch: 29, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 7.440104722976685
Epoch: 30, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 130388
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 18.779674291610718
Epoch: 1, Steps: 89 | Train Loss: 1.392 Vali Loss: 0.541 Vali Acc: 0.849 Test Loss: 0.541 Test Acc: 0.849
Validation loss decreased (inf --> -0.848880).  Saving model ...
Epoch: 2 cost time: 17.098380088806152
Epoch: 2, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.295 Vali Acc: 0.918 Test Loss: 0.295 Test Acc: 0.918
Validation loss decreased (-0.848880 --> -0.917824).  Saving model ...
Epoch: 3 cost time: 18.89619731903076
Epoch: 3, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.917824 --> -0.937323).  Saving model ...
Epoch: 4 cost time: 18.785887002944946
Epoch: 4, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.342 Vali Acc: 0.934 Test Loss: 0.342 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.172350645065308
Epoch: 5, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.537 Vali Acc: 0.867 Test Loss: 0.537 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.432600975036621
Epoch: 6, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.554 Vali Acc: 0.868 Test Loss: 0.554 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.658766269683838
Epoch: 7, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.284 Vali Acc: 0.937 Test Loss: 0.284 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 17.822970390319824
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.457 Vali Acc: 0.914 Test Loss: 0.457 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.935127973556519
Epoch: 9, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.304 Vali Acc: 0.957 Test Loss: 0.304 Test Acc: 0.957
Validation loss decreased (-0.937323 --> -0.956821).  Saving model ...
Epoch: 10 cost time: 15.15850043296814
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.408 Vali Acc: 0.947 Test Loss: 0.408 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.599746704101562
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.363 Vali Acc: 0.954 Test Loss: 0.363 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.178820133209229
Epoch: 12, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.387 Vali Acc: 0.930 Test Loss: 0.387 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 15.372170448303223
Epoch: 13, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.279 Vali Acc: 0.951 Test Loss: 0.279 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 15.484775304794312
Epoch: 14, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.570 Vali Acc: 0.928 Test Loss: 0.570 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 15.151678562164307
Epoch: 15, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.360 Vali Acc: 0.953 Test Loss: 0.360 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.74063777923584
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.368 Vali Acc: 0.958 Test Loss: 0.368 Test Acc: 0.958
Validation loss decreased (-0.956821 --> -0.957517).  Saving model ...
Epoch: 17 cost time: 14.863327741622925
Epoch: 17, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.364 Vali Acc: 0.948 Test Loss: 0.364 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 14.981655836105347
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.494 Vali Acc: 0.943 Test Loss: 0.494 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 14.638438940048218
Epoch: 19, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.408 Vali Acc: 0.942 Test Loss: 0.408 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 16.831658840179443
Epoch: 20, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.357 Vali Acc: 0.959 Test Loss: 0.357 Test Acc: 0.959
Validation loss decreased (-0.957517 --> -0.958910).  Saving model ...
Epoch: 21 cost time: 15.414660215377808
Epoch: 21, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.357 Vali Acc: 0.960 Test Loss: 0.357 Test Acc: 0.960
Validation loss decreased (-0.958910 --> -0.959606).  Saving model ...
Epoch: 22 cost time: 12.009011507034302
Epoch: 22, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.230 Vali Acc: 0.970 Test Loss: 0.230 Test Acc: 0.970
Validation loss decreased (-0.959606 --> -0.970053).  Saving model ...
Epoch: 23 cost time: 14.231359243392944
Epoch: 23, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.610 Vali Acc: 0.942 Test Loss: 0.610 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 14.093241930007935
Epoch: 24, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.435 Vali Acc: 0.955 Test Loss: 0.435 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.712138891220093
Epoch: 25, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.515 Vali Acc: 0.955 Test Loss: 0.515 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 13.4955153465271
Epoch: 26, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.539 Vali Acc: 0.944 Test Loss: 0.539 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 12.494792461395264
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.405 Vali Acc: 0.958 Test Loss: 0.405 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 12.22635006904602
Epoch: 28, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.635 Vali Acc: 0.935 Test Loss: 0.635 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 13.940732955932617
Epoch: 29, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.432 Vali Acc: 0.958 Test Loss: 0.432 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 16.21217679977417
Epoch: 30, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.482 Vali Acc: 0.951 Test Loss: 0.482 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 13.646249771118164
Epoch: 31, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.520 Vali Acc: 0.960 Test Loss: 0.520 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 15.70104718208313
Epoch: 32, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.721 Vali Acc: 0.932 Test Loss: 0.721 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 310356
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.013020753860474
Epoch: 1, Steps: 89 | Train Loss: 1.608 Vali Loss: 0.628 Vali Acc: 0.801 Test Loss: 0.628 Test Acc: 0.801
Validation loss decreased (inf --> -0.800829).  Saving model ...
Epoch: 2 cost time: 6.7508509159088135
Epoch: 2, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.432 Vali Acc: 0.864 Test Loss: 0.432 Test Acc: 0.864
Validation loss decreased (-0.800829 --> -0.863505).  Saving model ...
Epoch: 3 cost time: 7.100645542144775
Epoch: 3, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.308 Vali Acc: 0.905 Test Loss: 0.308 Test Acc: 0.905
Validation loss decreased (-0.863505 --> -0.905289).  Saving model ...
Epoch: 4 cost time: 6.556196451187134
Epoch: 4, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.245 Vali Acc: 0.921 Test Loss: 0.245 Test Acc: 0.921
Validation loss decreased (-0.905289 --> -0.920610).  Saving model ...
Epoch: 5 cost time: 6.5695881843566895
Epoch: 5, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.920610 --> -0.931056).  Saving model ...
Epoch: 6 cost time: 7.1133482456207275
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
Validation loss decreased (-0.931056 --> -0.952645).  Saving model ...
Epoch: 7 cost time: 6.606968641281128
Epoch: 7, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.317 Vali Acc: 0.912 Test Loss: 0.317 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.882071495056152
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.403 Vali Acc: 0.898 Test Loss: 0.403 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.146297454833984
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
Validation loss decreased (-0.952645 --> -0.953341).  Saving model ...
Epoch: 10 cost time: 7.399034261703491
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.394206762313843
Epoch: 11, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
Validation loss decreased (-0.953341 --> -0.963090).  Saving model ...
Epoch: 12 cost time: 6.676833391189575
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.918813705444336
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.314 Vali Acc: 0.941 Test Loss: 0.314 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.510383367538452
Epoch: 14, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.349 Vali Acc: 0.947 Test Loss: 0.349 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.792221307754517
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.755 Vali Acc: 0.896 Test Loss: 0.755 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.963086128234863
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.307 Vali Acc: 0.948 Test Loss: 0.307 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.6324687004089355
Epoch: 17, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.269 Vali Acc: 0.949 Test Loss: 0.269 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.878628253936768
Epoch: 18, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.207 Vali Acc: 0.967 Test Loss: 0.207 Test Acc: 0.967
Validation loss decreased (-0.963090 --> -0.967268).  Saving model ...
Epoch: 19 cost time: 6.828957796096802
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.312 Vali Acc: 0.945 Test Loss: 0.312 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.077907085418701
Epoch: 20, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
Validation loss decreased (-0.967268 --> -0.970054).  Saving model ...
Epoch: 21 cost time: 6.582891225814819
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.305 Vali Acc: 0.946 Test Loss: 0.305 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.0562098026275635
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.230 Vali Acc: 0.968 Test Loss: 0.230 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.492305517196655
Epoch: 23, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.319 Vali Acc: 0.954 Test Loss: 0.319 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.233567476272583
Epoch: 24, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.750 Vali Acc: 0.900 Test Loss: 0.750 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.632789850234985
Epoch: 25, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.299 Vali Acc: 0.966 Test Loss: 0.299 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.638368606567383
Epoch: 26, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.364 Vali Acc: 0.952 Test Loss: 0.364 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.656781435012817
Epoch: 27, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.387 Vali Acc: 0.949 Test Loss: 0.387 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.358509540557861
Epoch: 28, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.484 Vali Acc: 0.937 Test Loss: 0.484 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.375148057937622
Epoch: 29, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.515 Vali Acc: 0.928 Test Loss: 0.515 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.385958194732666
Epoch: 30, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.284 Vali Acc: 0.956 Test Loss: 0.284 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 214676
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.3547046184539795
Epoch: 1, Steps: 89 | Train Loss: 1.730 Vali Loss: 0.661 Vali Acc: 0.816 Test Loss: 0.661 Test Acc: 0.816
Validation loss decreased (inf --> -0.816149).  Saving model ...
Epoch: 2 cost time: 6.175051212310791
Epoch: 2, Steps: 89 | Train Loss: 0.469 Vali Loss: 0.354 Vali Acc: 0.901 Test Loss: 0.354 Test Acc: 0.901
Validation loss decreased (-0.816149 --> -0.901111).  Saving model ...
Epoch: 3 cost time: 5.8417980670928955
Epoch: 3, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
Validation loss decreased (-0.901111 --> -0.942199).  Saving model ...
Epoch: 4 cost time: 5.894683837890625
Epoch: 4, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.178 Vali Acc: 0.945 Test Loss: 0.178 Test Acc: 0.945
Validation loss decreased (-0.942199 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 5.464287757873535
Epoch: 5, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
Validation loss decreased (-0.944984 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 5.915301561355591
Epoch: 6, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.951252 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 5.883984088897705
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.69847559928894
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.741814374923706
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.391206979751587
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 11 cost time: 6.130542039871216
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.166029453277588
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.194232702255249
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.76041841506958
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.70864462852478
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.089541673660278
Epoch: 16, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.200 Vali Acc: 0.953 Test Loss: 0.200 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.747580051422119
Epoch: 17, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.221 Vali Acc: 0.956 Test Loss: 0.221 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.190271377563477
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.262559652328491
Epoch: 19, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.249 Vali Acc: 0.948 Test Loss: 0.249 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.088387250900269
Epoch: 20, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.225 Vali Acc: 0.947 Test Loss: 0.225 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 176532
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.236738681793213
Epoch: 1, Steps: 89 | Train Loss: 1.908 Vali Loss: 0.778 Vali Acc: 0.816 Test Loss: 0.778 Test Acc: 0.816
Validation loss decreased (inf --> -0.816148).  Saving model ...
Epoch: 2 cost time: 7.5170087814331055
Epoch: 2, Steps: 89 | Train Loss: 0.550 Vali Loss: 0.403 Vali Acc: 0.886 Test Loss: 0.403 Test Acc: 0.886
Validation loss decreased (-0.816148 --> -0.886486).  Saving model ...
Epoch: 3 cost time: 7.708723068237305
Epoch: 3, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.246 Vali Acc: 0.923 Test Loss: 0.246 Test Acc: 0.923
Validation loss decreased (-0.886486 --> -0.923396).  Saving model ...
Epoch: 4 cost time: 8.125436067581177
Epoch: 4, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.923396 --> -0.948466).  Saving model ...
Epoch: 5 cost time: 8.223395109176636
Epoch: 5, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
Validation loss decreased (-0.948466 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 7.875808238983154
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
Validation loss decreased (-0.963090 --> -0.963091).  Saving model ...
Epoch: 7 cost time: 8.473344802856445
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.154 Vali Acc: 0.953 Test Loss: 0.154 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.260398626327515
Epoch: 8, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.963787).  Saving model ...
Epoch: 9 cost time: 8.196150302886963
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.969358).  Saving model ...
Epoch: 10 cost time: 7.767498016357422
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.315295457839966
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.723180294036865
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.914910793304443
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.969358 --> -0.969358).  Saving model ...
Epoch: 14 cost time: 7.55765962600708
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.128 Vali Acc: 0.960 Test Loss: 0.128 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.927058458328247
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.16754674911499
Epoch: 16, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.969358 --> -0.972840).  Saving model ...
Epoch: 17 cost time: 7.724514007568359
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.474835157394409
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 19 cost time: 7.028752088546753
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.973537 --> -0.979804).  Saving model ...
Epoch: 20 cost time: 7.947791576385498
Epoch: 20, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.13675308227539
Epoch: 21, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.45851993560791
Epoch: 22, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.4351160526275635
Epoch: 23, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.922381639480591
Epoch: 24, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.606788158416748
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.350 Vali Acc: 0.931 Test Loss: 0.350 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.1923017501831055
Epoch: 26, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.212 Vali Acc: 0.964 Test Loss: 0.212 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.545414209365845
Epoch: 27, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 7.2008631229400635
Epoch: 28, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.197 Vali Acc: 0.966 Test Loss: 0.197 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.898380756378174
Epoch: 29, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 146132
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.884894371032715
Epoch: 1, Steps: 89 | Train Loss: 2.030 Vali Loss: 0.830 Vali Acc: 0.786 Test Loss: 0.830 Test Acc: 0.786
Validation loss decreased (inf --> -0.786203).  Saving model ...
Epoch: 2 cost time: 6.547902822494507
Epoch: 2, Steps: 89 | Train Loss: 0.600 Vali Loss: 0.371 Vali Acc: 0.903 Test Loss: 0.371 Test Acc: 0.903
Validation loss decreased (-0.786203 --> -0.902503).  Saving model ...
Epoch: 3 cost time: 6.912717580795288
Epoch: 3, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.240 Vali Acc: 0.939 Test Loss: 0.240 Test Acc: 0.939
Validation loss decreased (-0.902503 --> -0.939413).  Saving model ...
Epoch: 4 cost time: 6.343004465103149
Epoch: 4, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.939413 --> -0.943592).  Saving model ...
Epoch: 5 cost time: 6.360384702682495
Epoch: 5, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.264 Vali Acc: 0.905 Test Loss: 0.264 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.0634541511535645
Epoch: 6, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
Validation loss decreased (-0.943592 --> -0.947770).  Saving model ...
Epoch: 7 cost time: 6.655725479125977
Epoch: 7, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
Validation loss decreased (-0.947770 --> -0.963091).  Saving model ...
Epoch: 8 cost time: 7.438407897949219
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.963091 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 6.330398321151733
Epoch: 9, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 5.915661334991455
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.992409706115723
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.96191668510437
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 13 cost time: 6.753870725631714
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.627003908157349
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.4764769077301025
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.849130153656006
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.479777574539185
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.130984306335449
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.2457733154296875
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.532175779342651
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.367040157318115
Epoch: 21, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.554151773452759
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 127508
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.931979179382324
Epoch: 1, Steps: 89 | Train Loss: 2.245 Vali Loss: 1.068 Vali Acc: 0.796 Test Loss: 1.068 Test Acc: 0.796
Validation loss decreased (inf --> -0.795950).  Saving model ...
Epoch: 2 cost time: 5.423809766769409
Epoch: 2, Steps: 89 | Train Loss: 0.773 Vali Loss: 0.501 Vali Acc: 0.865 Test Loss: 0.501 Test Acc: 0.865
Validation loss decreased (-0.795950 --> -0.864897).  Saving model ...
Epoch: 3 cost time: 4.660736560821533
Epoch: 3, Steps: 89 | Train Loss: 0.394 Vali Loss: 0.287 Vali Acc: 0.921 Test Loss: 0.287 Test Acc: 0.921
Validation loss decreased (-0.864897 --> -0.920610).  Saving model ...
Epoch: 4 cost time: 5.807518720626831
Epoch: 4, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.920610 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 5.543739080429077
Epoch: 5, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.147 Vali Acc: 0.961 Test Loss: 0.147 Test Acc: 0.961
Validation loss decreased (-0.943591 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 4.974212408065796
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.961001 --> -0.972144).  Saving model ...
Epoch: 7 cost time: 7.317998647689819
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.716273307800293
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.247665166854858
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 6.74566650390625
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 6.969387531280518
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.286981105804443
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.78344202041626
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 14 cost time: 6.136138439178467
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.429020404815674
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.981197).  Saving model ...
Epoch: 16 cost time: 6.53361439704895
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.265544652938843
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.401147127151489
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.426985025405884
Epoch: 19, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.136361598968506
Epoch: 20, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.775425434112549
Epoch: 21, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.4731690883636475
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.877981424331665
Epoch: 23, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.775841474533081
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.611225605010986
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 112724
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.779823064804077
Epoch: 1, Steps: 89 | Train Loss: 2.375 Vali Loss: 1.215 Vali Acc: 0.769 Test Loss: 1.215 Test Acc: 0.769
Validation loss decreased (inf --> -0.768790).  Saving model ...
Epoch: 2 cost time: 5.982781887054443
Epoch: 2, Steps: 89 | Train Loss: 0.883 Vali Loss: 0.540 Vali Acc: 0.871 Test Loss: 0.540 Test Acc: 0.871
Validation loss decreased (-0.768790 --> -0.871165).  Saving model ...
Epoch: 3 cost time: 5.22268009185791
Epoch: 3, Steps: 89 | Train Loss: 0.446 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
Validation loss decreased (-0.871165 --> -0.922002).  Saving model ...
Epoch: 4 cost time: 5.850677967071533
Epoch: 4, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
Validation loss decreased (-0.922002 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 6.211593151092529
Epoch: 5, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.939413 --> -0.965180).  Saving model ...
Epoch: 6 cost time: 6.6766746044158936
Epoch: 6, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.043602466583252
Epoch: 7, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.967269).  Saving model ...
Epoch: 8 cost time: 7.398072719573975
Epoch: 8, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.967269 --> -0.973537).  Saving model ...
Epoch: 9 cost time: 6.596709251403809
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 6.131653070449829
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.509855270385742
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.014738082885742
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.206923246383667
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.807142019271851
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 5.95422887802124
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 6.543773889541626
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 17 cost time: 6.606509685516357
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.226203441619873
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.426707029342651
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.472707509994507
Epoch: 20, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.1408374309539795
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.000246047973633
Epoch: 22, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.243981122970581
Epoch: 23, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.592499017715454
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.200408458709717
Epoch: 25, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.905029535293579
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm64_nh16_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 105620
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.850203037261963
Epoch: 1, Steps: 89 | Train Loss: 1.592 Vali Loss: 0.599 Vali Acc: 0.812 Test Loss: 0.599 Test Acc: 0.812
Validation loss decreased (inf --> -0.811972).  Saving model ...
Epoch: 2 cost time: 5.193634510040283
Epoch: 2, Steps: 89 | Train Loss: 0.410 Vali Loss: 0.401 Vali Acc: 0.883 Test Loss: 0.401 Test Acc: 0.883
Validation loss decreased (-0.811972 --> -0.883004).  Saving model ...
Epoch: 3 cost time: 6.13769268989563
Epoch: 3, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
Validation loss decreased (-0.883004 --> -0.942199).  Saving model ...
Epoch: 4 cost time: 6.6878509521484375
Epoch: 4, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.255 Vali Acc: 0.919 Test Loss: 0.255 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.430448770523071
Epoch: 5, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.596712827682495
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.134639024734497
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.942199 --> -0.951252).  Saving model ...
Epoch: 8 cost time: 5.7765443325042725
Epoch: 8, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.91908597946167
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.282 Vali Acc: 0.928 Test Loss: 0.282 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.013041734695435
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.951252 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 7.053532361984253
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 6.313411235809326
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 1.635 Vali Acc: 0.775 Test Loss: 1.635 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.154271841049194
Epoch: 13, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.068863153457642
Epoch: 14, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.280 Vali Acc: 0.960 Test Loss: 0.280 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.673586845397949
Epoch: 15, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.298 Vali Acc: 0.960 Test Loss: 0.298 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.606892824172974
Epoch: 16, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.233 Vali Acc: 0.962 Test Loss: 0.233 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.24357795715332
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.366 Vali Acc: 0.935 Test Loss: 0.366 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.33454155921936
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.259 Vali Acc: 0.957 Test Loss: 0.259 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.2585999965667725
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.969 Test Loss: 0.203 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969357).  Saving model ...
Epoch: 20 cost time: 7.305329322814941
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.311 Vali Acc: 0.943 Test Loss: 0.311 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.895216226577759
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.332 Vali Acc: 0.938 Test Loss: 0.332 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.015641927719116
Epoch: 22, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.325 Vali Acc: 0.955 Test Loss: 0.325 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.010741949081421
Epoch: 23, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.277 Vali Acc: 0.959 Test Loss: 0.277 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.289525270462036
Epoch: 24, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.411 Vali Acc: 0.943 Test Loss: 0.411 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.520433664321899
Epoch: 25, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.424 Vali Acc: 0.942 Test Loss: 0.424 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.370921611785889
Epoch: 26, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.240 Vali Acc: 0.965 Test Loss: 0.240 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.139575004577637
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.322 Vali Acc: 0.949 Test Loss: 0.322 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.169408559799194
Epoch: 28, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.623 Vali Acc: 0.912 Test Loss: 0.623 Test Acc: 0.912
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.55959677696228
Epoch: 29, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.255 Vali Acc: 0.965 Test Loss: 0.255 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 180436
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.6360063552856445
Epoch: 1, Steps: 89 | Train Loss: 1.944 Vali Loss: 0.751 Vali Acc: 0.806 Test Loss: 0.751 Test Acc: 0.806
Validation loss decreased (inf --> -0.806399).  Saving model ...
Epoch: 2 cost time: 5.853780508041382
Epoch: 2, Steps: 89 | Train Loss: 0.543 Vali Loss: 0.354 Vali Acc: 0.901 Test Loss: 0.354 Test Acc: 0.901
Validation loss decreased (-0.806399 --> -0.901111).  Saving model ...
Epoch: 3 cost time: 5.812724828720093
Epoch: 3, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.259 Vali Acc: 0.923 Test Loss: 0.259 Test Acc: 0.923
Validation loss decreased (-0.901111 --> -0.922699).  Saving model ...
Epoch: 4 cost time: 5.766556978225708
Epoch: 4, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
Validation loss decreased (-0.922699 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 5.657878160476685
Epoch: 5, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.220 Vali Acc: 0.942 Test Loss: 0.220 Test Acc: 0.942
Validation loss decreased (-0.939413 --> -0.941502).  Saving model ...
Epoch: 6 cost time: 4.624440908432007
Epoch: 6, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
Validation loss decreased (-0.941502 --> -0.964484).  Saving model ...
Epoch: 7 cost time: 5.396956920623779
Epoch: 7, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.844350337982178
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.451104640960693
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.377149820327759
Epoch: 10, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.164 Vali Acc: 0.955 Test Loss: 0.164 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.772058010101318
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.945172071456909
Epoch: 12, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.376672744750977
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.964484 --> -0.966573).  Saving model ...
Epoch: 14 cost time: 5.976730108261108
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.2807629108428955
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.939 Test Loss: 0.234 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.422178030014038
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.189528942108154
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.499872207641602
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.969492435455322
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.270 Vali Acc: 0.939 Test Loss: 0.270 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.26044225692749
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.088571548461914
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.577299356460571
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.227 Vali Acc: 0.946 Test Loss: 0.227 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.44784688949585
Epoch: 23, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.969358).  Saving model ...
Epoch: 24 cost time: 4.923501014709473
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.203 Vali Acc: 0.953 Test Loss: 0.203 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.229341506958008
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.917731046676636
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.265 Vali Acc: 0.943 Test Loss: 0.265 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.016932487487793
Epoch: 27, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.260 Vali Acc: 0.945 Test Loss: 0.260 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.739389657974243
Epoch: 28, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.730 Vali Acc: 0.873 Test Loss: 0.730 Test Acc: 0.873
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.676512718200684
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.186 Vali Acc: 0.960 Test Loss: 0.186 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.958957195281982
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.299 Vali Acc: 0.939 Test Loss: 0.299 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.499903202056885
Epoch: 31, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.269 Vali Acc: 0.948 Test Loss: 0.269 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.736327886581421
Epoch: 32, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 6.064296007156372
Epoch: 33, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.330 Vali Acc: 0.947 Test Loss: 0.330 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 132596
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.17192268371582
Epoch: 1, Steps: 89 | Train Loss: 2.147 Vali Loss: 0.882 Vali Acc: 0.776 Test Loss: 0.882 Test Acc: 0.776
Validation loss decreased (inf --> -0.775757).  Saving model ...
Epoch: 2 cost time: 6.4978461265563965
Epoch: 2, Steps: 89 | Train Loss: 0.592 Vali Loss: 0.394 Vali Acc: 0.898 Test Loss: 0.394 Test Acc: 0.898
Validation loss decreased (-0.775757 --> -0.898325).  Saving model ...
Epoch: 3 cost time: 6.4156434535980225
Epoch: 3, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
Validation loss decreased (-0.898325 --> -0.926181).  Saving model ...
Epoch: 4 cost time: 6.522779703140259
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.205 Vali Acc: 0.936 Test Loss: 0.205 Test Acc: 0.936
Validation loss decreased (-0.926181 --> -0.935931).  Saving model ...
Epoch: 5 cost time: 6.572788238525391
Epoch: 5, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
Validation loss decreased (-0.935931 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 6.292650461196899
Epoch: 6, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.680940389633179
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
Validation loss decreased (-0.954037 --> -0.958216).  Saving model ...
Epoch: 8 cost time: 6.327946424484253
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
Validation loss decreased (-0.958216 --> -0.966573).  Saving model ...
Epoch: 9 cost time: 6.006784200668335
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.966573 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 5.216554641723633
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.0590479373931885
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.906684875488281
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.293 Vali Acc: 0.914 Test Loss: 0.293 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.755109071731567
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.146921873092651
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.848710536956787
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.987712383270264
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.377485990524292
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 18 cost time: 4.718357563018799
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.085839509963989
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.402 Vali Acc: 0.920 Test Loss: 0.402 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.992190599441528
Epoch: 20, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.444577217102051
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.287617206573486
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 23 cost time: 6.243102312088013
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.127164363861084
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.695096492767334
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.228 Vali Acc: 0.948 Test Loss: 0.228 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.191999435424805
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.146949768066406
Epoch: 27, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.120752334594727
Epoch: 28, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.261671304702759
Epoch: 29, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.239740610122681
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.260 Vali Acc: 0.946 Test Loss: 0.260 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.872846841812134
Epoch: 31, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.166 Vali Acc: 0.964 Test Loss: 0.166 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.395943880081177
Epoch: 32, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.249 Vali Acc: 0.951 Test Loss: 0.249 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 113524
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.335407972335815
Epoch: 1, Steps: 89 | Train Loss: 2.225 Vali Loss: 1.068 Vali Acc: 0.776 Test Loss: 1.068 Test Acc: 0.776
Validation loss decreased (inf --> -0.776452).  Saving model ...
Epoch: 2 cost time: 6.032886743545532
Epoch: 2, Steps: 89 | Train Loss: 0.722 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
Validation loss decreased (-0.776452 --> -0.878129).  Saving model ...
Epoch: 3 cost time: 5.419155597686768
Epoch: 3, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.298 Vali Acc: 0.916 Test Loss: 0.298 Test Acc: 0.916
Validation loss decreased (-0.878129 --> -0.916432).  Saving model ...
Epoch: 4 cost time: 5.285815715789795
Epoch: 4, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.217 Vali Acc: 0.945 Test Loss: 0.217 Test Acc: 0.945
Validation loss decreased (-0.916432 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 5.7815842628479
Epoch: 5, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.944984 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 5.823137998580933
Epoch: 6, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.026727914810181
Epoch: 7, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.227543830871582
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
Validation loss decreased (-0.951948 --> -0.959609).  Saving model ...
Epoch: 9 cost time: 4.788143157958984
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
Validation loss decreased (-0.959609 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 5.129441738128662
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.581020832061768
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.1389923095703125
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967966).  Saving model ...
Epoch: 13 cost time: 5.342346429824829
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.505979537963867
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.967966 --> -0.972840).  Saving model ...
Epoch: 15 cost time: 4.929481267929077
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 16 cost time: 5.72159481048584
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.153381824493408
Epoch: 17, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.113015174865723
Epoch: 18, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.34295654296875
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 20 cost time: 4.506308555603027
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.805124044418335
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.8630530834198
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 23 cost time: 5.841547250747681
Epoch: 23, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.016629695892334
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.851174831390381
Epoch: 25, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.401179075241089
Epoch: 26, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.467672109603882
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.346623182296753
Epoch: 28, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.102748155593872
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.331082105636597
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.601404190063477
Epoch: 31, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.728872776031494
Epoch: 32, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 98324
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.420138597488403
Epoch: 1, Steps: 89 | Train Loss: 2.397 Vali Loss: 1.304 Vali Acc: 0.717 Test Loss: 1.304 Test Acc: 0.717
Validation loss decreased (inf --> -0.716561).  Saving model ...
Epoch: 2 cost time: 6.127853870391846
Epoch: 2, Steps: 89 | Train Loss: 0.881 Vali Loss: 0.549 Vali Acc: 0.853 Test Loss: 0.549 Test Acc: 0.853
Validation loss decreased (-0.716561 --> -0.853059).  Saving model ...
Epoch: 3 cost time: 6.570719003677368
Epoch: 3, Steps: 89 | Train Loss: 0.443 Vali Loss: 0.324 Vali Acc: 0.911 Test Loss: 0.324 Test Acc: 0.911
Validation loss decreased (-0.853059 --> -0.910860).  Saving model ...
Epoch: 4 cost time: 6.109143018722534
Epoch: 4, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.229 Vali Acc: 0.939 Test Loss: 0.229 Test Acc: 0.939
Validation loss decreased (-0.910860 --> -0.938716).  Saving model ...
Epoch: 5 cost time: 4.807273864746094
Epoch: 5, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
Validation loss decreased (-0.938716 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 6.238318204879761
Epoch: 6, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.950555 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 6.681168794631958
Epoch: 7, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.954037 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 6.351849555969238
Epoch: 8, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 5.869485139846802
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 5.601986408233643
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.107 Vali Acc: 0.966 Test Loss: 0.107 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.409788370132446
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.931550025939941
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.861059188842773
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.033229351043701
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 15 cost time: 5.909005880355835
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.880075216293335
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 17 cost time: 5.843270540237427
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.757529973983765
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.800137281417847
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.426352500915527
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.981197).  Saving model ...
Epoch: 21 cost time: 5.424250364303589
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.0598084926605225
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 23 cost time: 5.756230115890503
Epoch: 23, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.908239841461182
Epoch: 24, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.417665958404541
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.208698511123657
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.050740480422974
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.057100057601929
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.264617204666138
Epoch: 29, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.981643438339233
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.147486925125122
Epoch: 31, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 7.07735276222229
Epoch: 32, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 89012
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.600402355194092
Epoch: 1, Steps: 89 | Train Loss: 2.477 Vali Loss: 1.516 Vali Acc: 0.654 Test Loss: 1.516 Test Acc: 0.654
Validation loss decreased (inf --> -0.653885).  Saving model ...
Epoch: 2 cost time: 6.250629186630249
Epoch: 2, Steps: 89 | Train Loss: 1.093 Vali Loss: 0.660 Vali Acc: 0.826 Test Loss: 0.660 Test Acc: 0.826
Validation loss decreased (-0.653885 --> -0.825899).  Saving model ...
Epoch: 3 cost time: 5.914003610610962
Epoch: 3, Steps: 89 | Train Loss: 0.536 Vali Loss: 0.382 Vali Acc: 0.916 Test Loss: 0.382 Test Acc: 0.916
Validation loss decreased (-0.825899 --> -0.915734).  Saving model ...
Epoch: 4 cost time: 5.8754191398620605
Epoch: 4, Steps: 89 | Train Loss: 0.345 Vali Loss: 0.294 Vali Acc: 0.923 Test Loss: 0.294 Test Acc: 0.923
Validation loss decreased (-0.915734 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 6.303585529327393
Epoch: 5, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.201 Vali Acc: 0.947 Test Loss: 0.201 Test Acc: 0.947
Validation loss decreased (-0.922699 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 6.253197908401489
Epoch: 6, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.947073 --> -0.951252).  Saving model ...
Epoch: 7 cost time: 5.841097593307495
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.951252 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 5.6998443603515625
Epoch: 8, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966573).  Saving model ...
Epoch: 9 cost time: 6.316470146179199
Epoch: 9, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.074492931365967
Epoch: 10, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.213100433349609
Epoch: 11, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.966573 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 4.967831373214722
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.141 Vali Acc: 0.955 Test Loss: 0.141 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.60497260093689
Epoch: 13, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.0751729011535645
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 6.097887992858887
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.68196702003479
Epoch: 16, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.129929304122925
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.92176365852356
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.914508819580078
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.249339818954468
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.966 Test Loss: 0.140 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.151389837265015
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.800627708435059
Epoch: 22, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.9176459312438965
Epoch: 23, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.833651304244995
Epoch: 24, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 81620
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.727569818496704
Epoch: 1, Steps: 89 | Train Loss: 2.527 Vali Loss: 1.644 Vali Acc: 0.657 Test Loss: 1.644 Test Acc: 0.657
Validation loss decreased (inf --> -0.656669).  Saving model ...
Epoch: 2 cost time: 6.727833986282349
Epoch: 2, Steps: 89 | Train Loss: 1.235 Vali Loss: 0.779 Vali Acc: 0.815 Test Loss: 0.779 Test Acc: 0.815
Validation loss decreased (-0.656669 --> -0.814755).  Saving model ...
Epoch: 3 cost time: 6.883664846420288
Epoch: 3, Steps: 89 | Train Loss: 0.646 Vali Loss: 0.469 Vali Acc: 0.884 Test Loss: 0.469 Test Acc: 0.884
Validation loss decreased (-0.814755 --> -0.883700).  Saving model ...
Epoch: 4 cost time: 6.586307764053345
Epoch: 4, Steps: 89 | Train Loss: 0.414 Vali Loss: 0.323 Vali Acc: 0.919 Test Loss: 0.323 Test Acc: 0.919
Validation loss decreased (-0.883700 --> -0.918520).  Saving model ...
Epoch: 5 cost time: 6.562593698501587
Epoch: 5, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
Validation loss decreased (-0.918520 --> -0.946377).  Saving model ...
Epoch: 6 cost time: 7.094602584838867
Epoch: 6, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.189 Vali Acc: 0.947 Test Loss: 0.189 Test Acc: 0.947
Validation loss decreased (-0.946377 --> -0.947073).  Saving model ...
Epoch: 7 cost time: 7.252901315689087
Epoch: 7, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.947073 --> -0.957519).  Saving model ...
Epoch: 8 cost time: 6.088153600692749
Epoch: 8, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.957519 --> -0.963787).  Saving model ...
Epoch: 9 cost time: 5.891429424285889
Epoch: 9, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.963787 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 6.112105846405029
Epoch: 10, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.506649494171143
Epoch: 11, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.246434926986694
Epoch: 12, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.974929 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 5.948498725891113
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.167733669281006
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.116108655929565
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 5.78351616859436
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.512103319168091
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.1340930461883545
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.9670090675354
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.046403884887695
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 21 cost time: 7.04683256149292
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.153125762939453
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.958197593688965
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.611715078353882
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.055211067199707
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.103805065155029
Epoch: 26, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.083 Vali Acc: 0.972 Test Loss: 0.083 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.925445556640625
Epoch: 27, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.97149920463562
Epoch: 28, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.333213806152344
Epoch: 29, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.787164688110352
Epoch: 30, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 78068
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.71547245979309
Epoch: 1, Steps: 89 | Train Loss: 1.704 Vali Loss: 0.589 Vali Acc: 0.853 Test Loss: 0.589 Test Acc: 0.853
Validation loss decreased (inf --> -0.853058).  Saving model ...
Epoch: 2 cost time: 5.9203081130981445
Epoch: 2, Steps: 89 | Train Loss: 0.448 Vali Loss: 0.366 Vali Acc: 0.884 Test Loss: 0.366 Test Acc: 0.884
Validation loss decreased (-0.853058 --> -0.883701).  Saving model ...
Epoch: 3 cost time: 6.88389253616333
Epoch: 3, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.883701 --> -0.944288).  Saving model ...
Epoch: 4 cost time: 6.881625175476074
Epoch: 4, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.247 Vali Acc: 0.923 Test Loss: 0.247 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.2517249584198
Epoch: 5, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.440599203109741
Epoch: 6, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
Validation loss decreased (-0.944288 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 5.589217185974121
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.165 Vali Acc: 0.953 Test Loss: 0.165 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.760666370391846
Epoch: 8, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 7.379190683364868
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 7.850802659988403
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.349206209182739
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.302475452423096
Epoch: 12, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966572).  Saving model ...
Epoch: 13 cost time: 7.4784440994262695
Epoch: 13, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.198 Vali Acc: 0.963 Test Loss: 0.198 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.8719162940979
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
Validation loss decreased (-0.966572 --> -0.967965).  Saving model ...
Epoch: 15 cost time: 5.728919506072998
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.497040748596191
Epoch: 16, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.962 Test Loss: 0.233 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.440523624420166
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.226 Vali Acc: 0.953 Test Loss: 0.226 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.628693103790283
Epoch: 18, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.267 Vali Acc: 0.961 Test Loss: 0.267 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.4401116371154785
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.866 Vali Acc: 0.891 Test Loss: 0.866 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.848646879196167
Epoch: 20, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.564 Vali Acc: 0.911 Test Loss: 0.564 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.67726731300354
Epoch: 21, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.545 Vali Acc: 0.908 Test Loss: 0.545 Test Acc: 0.908
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.859699249267578
Epoch: 22, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.237 Vali Acc: 0.962 Test Loss: 0.237 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.629754304885864
Epoch: 23, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.274 Vali Acc: 0.960 Test Loss: 0.274 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.345757007598877
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.199 Vali Acc: 0.965 Test Loss: 0.199 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 155476
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.031553983688354
Epoch: 1, Steps: 89 | Train Loss: 2.035 Vali Loss: 0.838 Vali Acc: 0.767 Test Loss: 0.838 Test Acc: 0.767
Validation loss decreased (inf --> -0.767401).  Saving model ...
Epoch: 2 cost time: 7.3586106300354
Epoch: 2, Steps: 89 | Train Loss: 0.558 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.767401 --> -0.874647).  Saving model ...
Epoch: 3 cost time: 6.75284481048584
Epoch: 3, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.274 Vali Acc: 0.916 Test Loss: 0.274 Test Acc: 0.916
Validation loss decreased (-0.874647 --> -0.915735).  Saving model ...
Epoch: 4 cost time: 6.692820072174072
Epoch: 4, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
Validation loss decreased (-0.915735 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 6.677809000015259
Epoch: 5, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.162 Vali Acc: 0.955 Test Loss: 0.162 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 6.350762367248535
Epoch: 6, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.954734 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 7.24874210357666
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.087828636169434
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.831324100494385
Epoch: 9, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.4113922119140625
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 6.772756338119507
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.0040905475616455
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.810756206512451
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.312 Vali Acc: 0.914 Test Loss: 0.312 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.656835079193115
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.372603416442871
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970751).  Saving model ...
Epoch: 16 cost time: 5.898870468139648
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.165 Vali Acc: 0.961 Test Loss: 0.165 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.663453817367554
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.169 Vali Acc: 0.961 Test Loss: 0.169 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.067384719848633
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.946 Test Loss: 0.211 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.758981466293335
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.210 Vali Acc: 0.945 Test Loss: 0.210 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.826227903366089
Epoch: 20, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.131379842758179
Epoch: 21, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.57294487953186
Epoch: 22, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.360231161117554
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.204 Vali Acc: 0.962 Test Loss: 0.204 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.944868087768555
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.126286506652832
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.219 Vali Acc: 0.957 Test Loss: 0.219 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 107636
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.258001565933228
Epoch: 1, Steps: 89 | Train Loss: 2.127 Vali Loss: 0.926 Vali Acc: 0.781 Test Loss: 0.926 Test Acc: 0.781
Validation loss decreased (inf --> -0.780631).  Saving model ...
Epoch: 2 cost time: 6.436162233352661
Epoch: 2, Steps: 89 | Train Loss: 0.648 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
Validation loss decreased (-0.780631 --> -0.874647).  Saving model ...
Epoch: 3 cost time: 7.576173305511475
Epoch: 3, Steps: 89 | Train Loss: 0.351 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
Validation loss decreased (-0.874647 --> -0.877434).  Saving model ...
Epoch: 4 cost time: 7.345681428909302
Epoch: 4, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.186 Vali Acc: 0.940 Test Loss: 0.186 Test Acc: 0.940
Validation loss decreased (-0.877434 --> -0.940110).  Saving model ...
Epoch: 5 cost time: 7.5789806842803955
Epoch: 5, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
Validation loss decreased (-0.940110 --> -0.947770).  Saving model ...
Epoch: 6 cost time: 6.676617383956909
Epoch: 6, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
Validation loss decreased (-0.947770 --> -0.963091).  Saving model ...
Epoch: 7 cost time: 5.986197233200073
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 7.0891125202178955
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.964483 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 7.220848798751831
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 6.519092082977295
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.373675107955933
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.2665770053863525
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.968662 --> -0.970055).  Saving model ...
Epoch: 13 cost time: 6.436999320983887
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.970055 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 6.676342248916626
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.794877052307129
Epoch: 15, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.6668853759765625
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.322105169296265
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.185075044631958
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.012004852294922
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.965003728866577
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.216275453567505
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.252931833267212
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.606262445449829
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.409 Vali Acc: 0.932 Test Loss: 0.409 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 88564
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.380317449569702
Epoch: 1, Steps: 89 | Train Loss: 2.237 Vali Loss: 1.069 Vali Acc: 0.746 Test Loss: 1.069 Test Acc: 0.746
Validation loss decreased (inf --> -0.745811).  Saving model ...
Epoch: 2 cost time: 6.875035524368286
Epoch: 2, Steps: 89 | Train Loss: 0.711 Vali Loss: 0.457 Vali Acc: 0.879 Test Loss: 0.457 Test Acc: 0.879
Validation loss decreased (-0.745811 --> -0.878826).  Saving model ...
Epoch: 3 cost time: 6.507529020309448
Epoch: 3, Steps: 89 | Train Loss: 0.375 Vali Loss: 0.303 Vali Acc: 0.910 Test Loss: 0.303 Test Acc: 0.910
Validation loss decreased (-0.878826 --> -0.910164).  Saving model ...
Epoch: 4 cost time: 6.370240926742554
Epoch: 4, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
Validation loss decreased (-0.910164 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 6.222173452377319
Epoch: 5, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.938020 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 6.79665207862854
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.951948 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 7.250446796417236
Epoch: 7, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.132 Vali Acc: 0.958 Test Loss: 0.132 Test Acc: 0.958
Validation loss decreased (-0.954037 --> -0.958216).  Saving model ...
Epoch: 8 cost time: 7.518032073974609
Epoch: 8, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.958216 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 7.438009262084961
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.256476163864136
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.488422632217407
Epoch: 11, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.366848468780518
Epoch: 12, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.967965 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 6.696209669113159
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.934832334518433
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.507045745849609
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.139592170715332
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.975292921066284
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.003644943237305
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.356444597244263
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.814013957977295
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.775660753250122
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.159795045852661
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 73364
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.134005069732666
Epoch: 1, Steps: 89 | Train Loss: 2.424 Vali Loss: 1.409 Vali Acc: 0.650 Test Loss: 1.409 Test Acc: 0.650
Validation loss decreased (inf --> -0.649707).  Saving model ...
Epoch: 2 cost time: 6.510885000228882
Epoch: 2, Steps: 89 | Train Loss: 0.978 Vali Loss: 0.606 Vali Acc: 0.852 Test Loss: 0.606 Test Acc: 0.852
Validation loss decreased (-0.649707 --> -0.851665).  Saving model ...
Epoch: 3 cost time: 6.070671081542969
Epoch: 3, Steps: 89 | Train Loss: 0.490 Vali Loss: 0.361 Vali Acc: 0.907 Test Loss: 0.361 Test Acc: 0.907
Validation loss decreased (-0.851665 --> -0.907378).  Saving model ...
Epoch: 4 cost time: 5.901882886886597
Epoch: 4, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.907378 --> -0.933145).  Saving model ...
Epoch: 5 cost time: 5.817099332809448
Epoch: 5, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
Validation loss decreased (-0.933145 --> -0.953341).  Saving model ...
Epoch: 6 cost time: 6.446093320846558
Epoch: 6, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
Validation loss decreased (-0.953341 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 6.349885940551758
Epoch: 7, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.959609).  Saving model ...
Epoch: 8 cost time: 6.040581703186035
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.238210916519165
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
Validation loss decreased (-0.959609 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 5.923250198364258
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 6.191601514816284
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 5.936181306838989
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 13 cost time: 5.7312586307525635
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.975626).  Saving model ...
Epoch: 14 cost time: 5.730214834213257
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 6.2636940479278564
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.184461832046509
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.023126125335693
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.977019 --> -0.977019).  Saving model ...
Epoch: 18 cost time: 5.793407440185547
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.3267457485198975
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.201472520828247
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.136835813522339
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.038511276245117
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.037773847579956
Epoch: 23, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.646012783050537
Epoch: 24, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.718259811401367
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.5135498046875
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.312417507171631
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 64052
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.907857418060303
Epoch: 1, Steps: 89 | Train Loss: 2.610 Vali Loss: 1.672 Vali Acc: 0.652 Test Loss: 1.672 Test Acc: 0.652
Validation loss decreased (inf --> -0.651794).  Saving model ...
Epoch: 2 cost time: 7.035213232040405
Epoch: 2, Steps: 89 | Train Loss: 1.196 Vali Loss: 0.722 Vali Acc: 0.845 Test Loss: 0.722 Test Acc: 0.845
Validation loss decreased (-0.651794 --> -0.845397).  Saving model ...
Epoch: 3 cost time: 5.626239776611328
Epoch: 3, Steps: 89 | Train Loss: 0.589 Vali Loss: 0.436 Vali Acc: 0.899 Test Loss: 0.436 Test Acc: 0.899
Validation loss decreased (-0.845397 --> -0.899021).  Saving model ...
Epoch: 4 cost time: 6.680794715881348
Epoch: 4, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.281 Vali Acc: 0.932 Test Loss: 0.281 Test Acc: 0.932
Validation loss decreased (-0.899021 --> -0.932448).  Saving model ...
Epoch: 5 cost time: 7.195553779602051
Epoch: 5, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
Validation loss decreased (-0.932448 --> -0.946377).  Saving model ...
Epoch: 6 cost time: 7.453666687011719
Epoch: 6, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
Validation loss decreased (-0.946377 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 7.005274534225464
Epoch: 7, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.677958965301514
Epoch: 8, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.952644 --> -0.966573).  Saving model ...
Epoch: 9 cost time: 6.890789985656738
Epoch: 9, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.966573 --> -0.967269).  Saving model ...
Epoch: 10 cost time: 6.376493215560913
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.967269 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 6.49213433265686
Epoch: 11, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 6.667097568511963
Epoch: 12, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 13 cost time: 6.517576456069946
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 14 cost time: 6.1986243724823
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.340423583984375
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.224782705307007
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.945247411727905
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.94484543800354
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.960 Test Loss: 0.119 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.719767332077026
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.963 Test Loss: 0.110 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.665101051330566
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.975626 --> -0.981893).  Saving model ...
Epoch: 21 cost time: 5.715237617492676
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.675312280654907
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.036074638366699
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.76700234413147
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.379815578460693
Epoch: 25, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.804585218429565
Epoch: 26, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.187801361083984
Epoch: 27, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.00133204460144
Epoch: 28, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.030593156814575
Epoch: 29, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.392574787139893
Epoch: 30, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 56660
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.158009767532349
Epoch: 1, Steps: 89 | Train Loss: 2.588 Vali Loss: 1.745 Vali Acc: 0.613 Test Loss: 1.745 Test Acc: 0.613
Validation loss decreased (inf --> -0.612796).  Saving model ...
Epoch: 2 cost time: 5.673738718032837
Epoch: 2, Steps: 89 | Train Loss: 1.305 Vali Loss: 0.813 Vali Acc: 0.818 Test Loss: 0.813 Test Acc: 0.818
Validation loss decreased (-0.612796 --> -0.818237).  Saving model ...
Epoch: 3 cost time: 5.102458953857422
Epoch: 3, Steps: 89 | Train Loss: 0.671 Vali Loss: 0.509 Vali Acc: 0.875 Test Loss: 0.509 Test Acc: 0.875
Validation loss decreased (-0.818237 --> -0.875343).  Saving model ...
Epoch: 4 cost time: 5.609377861022949
Epoch: 4, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.360 Vali Acc: 0.908 Test Loss: 0.360 Test Acc: 0.908
Validation loss decreased (-0.875343 --> -0.908074).  Saving model ...
Epoch: 5 cost time: 5.638502836227417
Epoch: 5, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.272 Vali Acc: 0.927 Test Loss: 0.272 Test Acc: 0.927
Validation loss decreased (-0.908074 --> -0.926877).  Saving model ...
Epoch: 6 cost time: 5.644014835357666
Epoch: 6, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.926877 --> -0.944288).  Saving model ...
Epoch: 7 cost time: 5.244158983230591
Epoch: 7, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.944288 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 5.061676263809204
Epoch: 8, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.615206003189087
Epoch: 9, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.966573).  Saving model ...
Epoch: 10 cost time: 6.442471981048584
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.966573 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 6.765787839889526
Epoch: 11, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.848333120346069
Epoch: 12, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 13 cost time: 6.891308069229126
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.723958969116211
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.974233 --> -0.980501).  Saving model ...
Epoch: 15 cost time: 5.991190195083618
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.753144979476929
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.0963780879974365
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.908353567123413
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.654875040054321
Epoch: 19, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.289607524871826
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.055579423904419
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.8923256397247314
Epoch: 22, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.330444097518921
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.432901620864868
Epoch: 24, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 53108
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.037209033966064
Epoch: 1, Steps: 89 | Train Loss: 1.638 Vali Loss: 0.581 Vali Acc: 0.838 Test Loss: 0.581 Test Acc: 0.838
Validation loss decreased (inf --> -0.837738).  Saving model ...
Epoch: 2 cost time: 6.275864124298096
Epoch: 2, Steps: 89 | Train Loss: 0.441 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
Validation loss decreased (-0.837738 --> -0.910860).  Saving model ...
Epoch: 3 cost time: 5.514467716217041
Epoch: 3, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.355 Vali Acc: 0.909 Test Loss: 0.355 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.867616176605225
Epoch: 4, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
Validation loss decreased (-0.910860 --> -0.936627).  Saving model ...
Epoch: 5 cost time: 6.083069801330566
Epoch: 5, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.936627 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 6.37673544883728
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.351223707199097
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.497408866882324
Epoch: 8, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
Validation loss decreased (-0.948466 --> -0.954734).  Saving model ...
Epoch: 9 cost time: 5.60275411605835
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
Validation loss decreased (-0.954734 --> -0.955430).  Saving model ...
Epoch: 10 cost time: 6.460079193115234
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.339524030685425
Epoch: 11, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.958215).  Saving model ...
Epoch: 12 cost time: 6.23655366897583
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
Validation loss decreased (-0.958215 --> -0.960305).  Saving model ...
Epoch: 13 cost time: 6.701958894729614
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.967269).  Saving model ...
Epoch: 14 cost time: 6.932010173797607
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.266 Vali Acc: 0.953 Test Loss: 0.266 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.937462091445923
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.289 Vali Acc: 0.939 Test Loss: 0.289 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.067235708236694
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.237 Vali Acc: 0.960 Test Loss: 0.237 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.14342474937439
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.198 Vali Acc: 0.964 Test Loss: 0.198 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.255665302276611
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.959 Test Loss: 0.238 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.1445887088775635
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.246 Vali Acc: 0.959 Test Loss: 0.246 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.467566728591919
Epoch: 20, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.221 Vali Acc: 0.965 Test Loss: 0.221 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.392549276351929
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.369 Vali Acc: 0.951 Test Loss: 0.369 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.635982513427734
Epoch: 22, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.326 Vali Acc: 0.951 Test Loss: 0.326 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.0724122524261475
Epoch: 23, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.242 Vali Acc: 0.967 Test Loss: 0.242 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 142996
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.333731412887573
Epoch: 1, Steps: 89 | Train Loss: 1.996 Vali Loss: 0.842 Vali Acc: 0.781 Test Loss: 0.842 Test Acc: 0.781
Validation loss decreased (inf --> -0.780632).  Saving model ...
Epoch: 2 cost time: 5.456807374954224
Epoch: 2, Steps: 89 | Train Loss: 0.610 Vali Loss: 0.419 Vali Acc: 0.880 Test Loss: 0.419 Test Acc: 0.880
Validation loss decreased (-0.780632 --> -0.879522).  Saving model ...
Epoch: 3 cost time: 5.185427665710449
Epoch: 3, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
Validation loss decreased (-0.879522 --> -0.926181).  Saving model ...
Epoch: 4 cost time: 5.69073224067688
Epoch: 4, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.229 Vali Acc: 0.939 Test Loss: 0.229 Test Acc: 0.939
Validation loss decreased (-0.926181 --> -0.938716).  Saving model ...
Epoch: 5 cost time: 5.794540882110596
Epoch: 5, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.938716 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 5.669816970825195
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.213728427886963
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.136 Vali Acc: 0.961 Test Loss: 0.136 Test Acc: 0.961
Validation loss decreased (-0.960305 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 5.190751075744629
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 6.108112812042236
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.961698 --> -0.970054).  Saving model ...
Epoch: 10 cost time: 6.7533040046691895
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.935 Test Loss: 0.235 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.495239496231079
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.269582509994507
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.6751203536987305
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.95404052734375
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.222824573516846
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.617238759994507
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.8185975551605225
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.468 Vali Acc: 0.893 Test Loss: 0.468 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.499264717102051
Epoch: 18, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.465175628662109
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 95156
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.859752416610718
Epoch: 1, Steps: 89 | Train Loss: 2.117 Vali Loss: 0.882 Vali Acc: 0.819 Test Loss: 0.882 Test Acc: 0.819
Validation loss decreased (inf --> -0.818933).  Saving model ...
Epoch: 2 cost time: 6.599014043807983
Epoch: 2, Steps: 89 | Train Loss: 0.632 Vali Loss: 0.426 Vali Acc: 0.878 Test Loss: 0.426 Test Acc: 0.878
Validation loss decreased (-0.818933 --> -0.878129).  Saving model ...
Epoch: 3 cost time: 6.6879777908325195
Epoch: 3, Steps: 89 | Train Loss: 0.356 Vali Loss: 0.289 Vali Acc: 0.920 Test Loss: 0.289 Test Acc: 0.920
Validation loss decreased (-0.878129 --> -0.919914).  Saving model ...
Epoch: 4 cost time: 5.817723035812378
Epoch: 4, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
Validation loss decreased (-0.919914 --> -0.942199).  Saving model ...
Epoch: 5 cost time: 6.532207012176514
Epoch: 5, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
Validation loss decreased (-0.942199 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 6.521475076675415
Epoch: 6, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.209 Vali Acc: 0.925 Test Loss: 0.209 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.8485987186431885
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
Validation loss decreased (-0.951948 --> -0.960305).  Saving model ...
Epoch: 8 cost time: 5.999374151229858
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.954676389694214
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.953304767608643
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.941637277603149
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.960305 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 5.047382593154907
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.629504919052124
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.5752317905426025
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.462220191955566
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.6116557121276855
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970055).  Saving model ...
Epoch: 17 cost time: 4.813205718994141
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.127815246582031
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.458775758743286
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.301578760147095
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.363969326019287
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.29555082321167
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.973536).  Saving model ...
Epoch: 23 cost time: 5.537317991256714
Epoch: 23, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.724525213241577
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.254 Vali Acc: 0.940 Test Loss: 0.254 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.499155282974243
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.202807426452637
Epoch: 26, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.178208589553833
Epoch: 27, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.075037717819214
Epoch: 28, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.756431579589844
Epoch: 29, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.655595779418945
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.395910739898682
Epoch: 31, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 32 cost time: 5.364003896713257
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.521610260009766
Epoch: 33, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.94539213180542
Epoch: 34, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.167361736297607
Epoch: 35, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.2859578132629395
Epoch: 36, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 5.780347108840942
Epoch: 37, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.206 Vali Acc: 0.961 Test Loss: 0.206 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 5.732306480407715
Epoch: 38, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 5.20153546333313
Epoch: 39, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 7.035604953765869
Epoch: 40, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.224 Vali Acc: 0.964 Test Loss: 0.224 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 6.8355488777160645
Epoch: 41, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 76084
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.288166999816895
Epoch: 1, Steps: 89 | Train Loss: 2.305 Vali Loss: 1.138 Vali Acc: 0.796 Test Loss: 1.138 Test Acc: 0.796
Validation loss decreased (inf --> -0.795950).  Saving model ...
Epoch: 2 cost time: 6.505382537841797
Epoch: 2, Steps: 89 | Train Loss: 0.802 Vali Loss: 0.518 Vali Acc: 0.860 Test Loss: 0.518 Test Acc: 0.860
Validation loss decreased (-0.795950 --> -0.860023).  Saving model ...
Epoch: 3 cost time: 6.323807239532471
Epoch: 3, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
Validation loss decreased (-0.860023 --> -0.922003).  Saving model ...
Epoch: 4 cost time: 6.384662389755249
Epoch: 4, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.247 Vali Acc: 0.932 Test Loss: 0.247 Test Acc: 0.932
Validation loss decreased (-0.922003 --> -0.931752).  Saving model ...
Epoch: 5 cost time: 6.650054216384888
Epoch: 5, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.196 Vali Acc: 0.940 Test Loss: 0.196 Test Acc: 0.940
Validation loss decreased (-0.931752 --> -0.940109).  Saving model ...
Epoch: 6 cost time: 6.455487012863159
Epoch: 6, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.940109 --> -0.949163).  Saving model ...
Epoch: 7 cost time: 4.75628662109375
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.949163 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 5.8767781257629395
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.228899955749512
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 5.893498182296753
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.091552734375
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.074594497680664
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.106034994125366
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.004389047622681
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.407960414886475
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.012621641159058
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.130 Vali Acc: 0.958 Test Loss: 0.130 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.029971599578857
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.974233).  Saving model ...
Epoch: 18 cost time: 5.956801414489746
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 19 cost time: 6.170467376708984
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 20 cost time: 5.3330237865448
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.103800535202026
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.95256495475769
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.009585857391357
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.9836108684539795
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.194201231002808
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.172032594680786
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.181981325149536
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.010144472122192
Epoch: 28, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.741314888000488
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 60884
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.812631607055664
Epoch: 1, Steps: 89 | Train Loss: 2.446 Vali Loss: 1.382 Vali Acc: 0.746 Test Loss: 1.382 Test Acc: 0.746
Validation loss decreased (inf --> -0.745808).  Saving model ...
Epoch: 2 cost time: 4.623236179351807
Epoch: 2, Steps: 89 | Train Loss: 0.963 Vali Loss: 0.604 Vali Acc: 0.839 Test Loss: 0.604 Test Acc: 0.839
Validation loss decreased (-0.745808 --> -0.839130).  Saving model ...
Epoch: 3 cost time: 4.995059967041016
Epoch: 3, Steps: 89 | Train Loss: 0.482 Vali Loss: 0.354 Vali Acc: 0.906 Test Loss: 0.354 Test Acc: 0.906
Validation loss decreased (-0.839130 --> -0.905985).  Saving model ...
Epoch: 4 cost time: 5.190553903579712
Epoch: 4, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
Validation loss decreased (-0.905985 --> -0.924789).  Saving model ...
Epoch: 5 cost time: 5.4091105461120605
Epoch: 5, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
Validation loss decreased (-0.924789 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 5.201717376708984
Epoch: 6, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.69341254234314
Epoch: 7, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.950555 --> -0.951252).  Saving model ...
Epoch: 8 cost time: 5.242670297622681
Epoch: 8, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.951252 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 5.369854211807251
Epoch: 9, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 10 cost time: 5.399580240249634
Epoch: 10, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
Validation loss decreased (-0.969358 --> -0.969358).  Saving model ...
Epoch: 11 cost time: 5.227290153503418
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 5.174490451812744
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 13 cost time: 6.881864309310913
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.9125282764434814
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.557173252105713
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.973537 --> -0.978411).  Saving model ...
Epoch: 16 cost time: 6.8265907764434814
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 17 cost time: 5.489068031311035
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.468470573425293
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 19 cost time: 6.541363000869751
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.291739225387573
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.338390111923218
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.111622333526611
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.992965221405029
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.556100845336914
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.823878526687622
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.360440731048584
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.23578143119812
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.818053245544434
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 29 cost time: 5.60973596572876
Epoch: 29, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.613156080245972
Epoch: 30, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.590779781341553
Epoch: 31, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.695836782455444
Epoch: 32, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 5.7058892250061035
Epoch: 33, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.69952917098999
Epoch: 34, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 5.346437454223633
Epoch: 35, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 5.158052444458008
Epoch: 36, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.382143497467041
Epoch: 37, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.961725473403931
Epoch: 38, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 51572
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.682738304138184
Epoch: 1, Steps: 89 | Train Loss: 2.620 Vali Loss: 1.655 Vali Acc: 0.708 Test Loss: 1.655 Test Acc: 0.708
Validation loss decreased (inf --> -0.708201).  Saving model ...
Epoch: 2 cost time: 5.18002462387085
Epoch: 2, Steps: 89 | Train Loss: 1.239 Vali Loss: 0.769 Vali Acc: 0.812 Test Loss: 0.769 Test Acc: 0.812
Validation loss decreased (-0.708201 --> -0.811970).  Saving model ...
Epoch: 3 cost time: 4.918099403381348
Epoch: 3, Steps: 89 | Train Loss: 0.647 Vali Loss: 0.484 Vali Acc: 0.881 Test Loss: 0.484 Test Acc: 0.881
Validation loss decreased (-0.811970 --> -0.880914).  Saving model ...
Epoch: 4 cost time: 4.220978498458862
Epoch: 4, Steps: 89 | Train Loss: 0.416 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.880914 --> -0.924788).  Saving model ...
Epoch: 5 cost time: 4.631664991378784
Epoch: 5, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.254 Vali Acc: 0.935 Test Loss: 0.254 Test Acc: 0.935
Validation loss decreased (-0.924788 --> -0.935234).  Saving model ...
Epoch: 6 cost time: 5.216629505157471
Epoch: 6, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.7102272510528564
Epoch: 7, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.935234 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 5.289210796356201
Epoch: 8, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.4134862422943115
Epoch: 9, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.108238220214844
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 5.259490489959717
Epoch: 11, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.964483 --> -0.974929).  Saving model ...
Epoch: 12 cost time: 4.554179430007935
Epoch: 12, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.371483325958252
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.8510422706604
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 4.990970611572266
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980500).  Saving model ...
Epoch: 16 cost time: 4.709226608276367
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.443238258361816
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.901581764221191
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.828205347061157
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 20 cost time: 4.923835515975952
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.289439678192139
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.406933307647705
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.570944786071777
Epoch: 23, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.538893461227417
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.8226478099823
Epoch: 25, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.885758399963379
Epoch: 26, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.692493677139282
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.48084020614624
Epoch: 28, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.157149314880371
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 44180
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.569913625717163
Epoch: 1, Steps: 89 | Train Loss: 2.715 Vali Loss: 1.874 Vali Acc: 0.601 Test Loss: 1.874 Test Acc: 0.601
Validation loss decreased (inf --> -0.600956).  Saving model ...
Epoch: 2 cost time: 5.7420125007629395
Epoch: 2, Steps: 89 | Train Loss: 1.398 Vali Loss: 0.870 Vali Acc: 0.795 Test Loss: 0.870 Test Acc: 0.795
Validation loss decreased (-0.600956 --> -0.794560).  Saving model ...
Epoch: 3 cost time: 6.016252040863037
Epoch: 3, Steps: 89 | Train Loss: 0.726 Vali Loss: 0.546 Vali Acc: 0.866 Test Loss: 0.546 Test Acc: 0.866
Validation loss decreased (-0.794560 --> -0.866290).  Saving model ...
Epoch: 4 cost time: 5.708799362182617
Epoch: 4, Steps: 89 | Train Loss: 0.468 Vali Loss: 0.384 Vali Acc: 0.907 Test Loss: 0.384 Test Acc: 0.907
Validation loss decreased (-0.866290 --> -0.907378).  Saving model ...
Epoch: 5 cost time: 5.980115652084351
Epoch: 5, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
Validation loss decreased (-0.907378 --> -0.936627).  Saving model ...
Epoch: 6 cost time: 6.176259517669678
Epoch: 6, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.224 Vali Acc: 0.940 Test Loss: 0.224 Test Acc: 0.940
Validation loss decreased (-0.936627 --> -0.940109).  Saving model ...
Epoch: 7 cost time: 6.235682964324951
Epoch: 7, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.940109 --> -0.957519).  Saving model ...
Epoch: 8 cost time: 6.497166633605957
Epoch: 8, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
Validation loss decreased (-0.957519 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 5.4677207469940186
Epoch: 9, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.6155478954315186
Epoch: 10, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.3976686000823975
Epoch: 11, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 5.466549873352051
Epoch: 12, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
Validation loss decreased (-0.969358 --> -0.979108).  Saving model ...
Epoch: 13 cost time: 5.500326871871948
Epoch: 13, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.311955213546753
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.595421075820923
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3953335285186768
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 3.4573962688446045
Epoch: 17, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 18 cost time: 5.023425579071045
Epoch: 18, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.527591228485107
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.311688423156738
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.982590).  Saving model ...
Epoch: 21 cost time: 5.250394344329834
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.744506597518921
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.744326114654541
Epoch: 23, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.994460821151733
Epoch: 24, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.784462928771973
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.226150751113892
Epoch: 26, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.069019079208374
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.079196929931641
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.083986520767212
Epoch: 29, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.109101057052612
Epoch: 30, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm32_nh4_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 40628
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.7820680141448975
Epoch: 1, Steps: 89 | Train Loss: 2.022 Vali Loss: 0.775 Vali Acc: 0.811 Test Loss: 0.775 Test Acc: 0.811
Validation loss decreased (inf --> -0.810577).  Saving model ...
Epoch: 2 cost time: 4.48078727722168
Epoch: 2, Steps: 89 | Train Loss: 0.553 Vali Loss: 0.364 Vali Acc: 0.896 Test Loss: 0.364 Test Acc: 0.896
Validation loss decreased (-0.810577 --> -0.896236).  Saving model ...
Epoch: 3 cost time: 4.839525938034058
Epoch: 3, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.896236 --> -0.933145).  Saving model ...
Epoch: 4 cost time: 4.964842319488525
Epoch: 4, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
Validation loss decreased (-0.933145 --> -0.938717).  Saving model ...
Epoch: 5 cost time: 4.961319208145142
Epoch: 5, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
Validation loss decreased (-0.938717 --> -0.949859).  Saving model ...
Epoch: 6 cost time: 4.924765348434448
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
Validation loss decreased (-0.949859 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 4.5958802700042725
Epoch: 7, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.6258931159973145
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.243 Vali Acc: 0.936 Test Loss: 0.243 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.862215757369995
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.867096662521362
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.774606466293335
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.193 Vali Acc: 0.947 Test Loss: 0.193 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.245234966278076
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.962394).  Saving model ...
Epoch: 13 cost time: 5.59794545173645
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.962394 --> -0.965180).  Saving model ...
Epoch: 14 cost time: 5.5402281284332275
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.523242235183716
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.291900157928467
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.946105003356934
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.362724542617798
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 19 cost time: 5.564208269119263
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.983420372009277
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.182 Vali Acc: 0.955 Test Loss: 0.182 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.466342210769653
Epoch: 21, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.208 Vali Acc: 0.953 Test Loss: 0.208 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.698886156082153
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.470489025115967
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.2945942878723145
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.061366558074951
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
Validation loss decreased (-0.968662 --> -0.970054).  Saving model ...
Epoch: 26 cost time: 5.083723783493042
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.237 Vali Acc: 0.953 Test Loss: 0.237 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.068723440170288
Epoch: 27, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.208 Vali Acc: 0.955 Test Loss: 0.208 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.7012200355529785
Epoch: 28, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.188 Vali Acc: 0.964 Test Loss: 0.188 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.627733469009399
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.711167335510254
Epoch: 30, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.210 Vali Acc: 0.962 Test Loss: 0.210 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.006687879562378
Epoch: 31, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.195 Vali Acc: 0.966 Test Loss: 0.195 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 5.1132652759552
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.974232).  Saving model ...
Epoch: 33 cost time: 4.567413091659546
Epoch: 33, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.964 Test Loss: 0.185 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.785945415496826
Epoch: 34, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.920665740966797
Epoch: 35, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.8829262256622314
Epoch: 36, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.287 Vali Acc: 0.947 Test Loss: 0.287 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.53925347328186
Epoch: 37, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.604950666427612
Epoch: 38, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.325 Vali Acc: 0.946 Test Loss: 0.325 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 5.122042179107666
Epoch: 39, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.222 Vali Acc: 0.965 Test Loss: 0.222 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 5.030817985534668
Epoch: 40, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.231 Vali Acc: 0.962 Test Loss: 0.231 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.307648420333862
Epoch: 41, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.383 Vali Acc: 0.938 Test Loss: 0.383 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 5.174378395080566
Epoch: 42, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.318 Vali Acc: 0.949 Test Loss: 0.318 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 87540
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.730885744094849
Epoch: 1, Steps: 89 | Train Loss: 2.300 Vali Loss: 1.139 Vali Acc: 0.768 Test Loss: 1.139 Test Acc: 0.768
Validation loss decreased (inf --> -0.768094).  Saving model ...
Epoch: 2 cost time: 5.285333633422852
Epoch: 2, Steps: 89 | Train Loss: 0.752 Vali Loss: 0.537 Vali Acc: 0.851 Test Loss: 0.537 Test Acc: 0.851
Validation loss decreased (-0.768094 --> -0.850970).  Saving model ...
Epoch: 3 cost time: 5.212067365646362
Epoch: 3, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.850970 --> -0.900414).  Saving model ...
Epoch: 4 cost time: 5.529179573059082
Epoch: 4, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
Validation loss decreased (-0.900414 --> -0.935234).  Saving model ...
Epoch: 5 cost time: 5.33189582824707
Epoch: 5, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.935234 --> -0.947770).  Saving model ...
Epoch: 6 cost time: 5.288066387176514
Epoch: 6, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.947770 --> -0.947770).  Saving model ...
Epoch: 7 cost time: 5.271977186203003
Epoch: 7, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
Validation loss decreased (-0.947770 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 6.347406625747681
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.142482280731201
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
Validation loss decreased (-0.961001 --> -0.965876).  Saving model ...
Epoch: 10 cost time: 7.238603115081787
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.807942628860474
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.572275400161743
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.24918007850647
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.562831878662109
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
Validation loss decreased (-0.965876 --> -0.971447).  Saving model ...
Epoch: 15 cost time: 7.9365222454071045
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.535098552703857
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.6229636669158936
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.471360921859741
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.903985023498535
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.445984125137329
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.296387672424316
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.201963663101196
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.315224885940552
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.387007236480713
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 63620
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.3381383419036865
Epoch: 1, Steps: 89 | Train Loss: 2.489 Vali Loss: 1.413 Vali Acc: 0.691 Test Loss: 1.413 Test Acc: 0.691
Validation loss decreased (inf --> -0.690794).  Saving model ...
Epoch: 2 cost time: 4.835475206375122
Epoch: 2, Steps: 89 | Train Loss: 0.927 Vali Loss: 0.578 Vali Acc: 0.859 Test Loss: 0.578 Test Acc: 0.859
Validation loss decreased (-0.690794 --> -0.858629).  Saving model ...
Epoch: 3 cost time: 5.312443017959595
Epoch: 3, Steps: 89 | Train Loss: 0.453 Vali Loss: 0.340 Vali Acc: 0.909 Test Loss: 0.340 Test Acc: 0.909
Validation loss decreased (-0.858629 --> -0.908771).  Saving model ...
Epoch: 4 cost time: 5.9596521854400635
Epoch: 4, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.237 Vali Acc: 0.940 Test Loss: 0.237 Test Acc: 0.940
Validation loss decreased (-0.908771 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 6.030231952667236
Epoch: 5, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.940109 --> -0.949859).  Saving model ...
Epoch: 6 cost time: 5.943251132965088
Epoch: 6, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
Validation loss decreased (-0.949859 --> -0.953341).  Saving model ...
Epoch: 7 cost time: 4.91623067855835
Epoch: 7, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.953341 --> -0.959609).  Saving model ...
Epoch: 8 cost time: 5.110994338989258
Epoch: 8, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.959609 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 4.5509936809539795
Epoch: 9, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.427623271942139
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.755584478378296
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.973537).  Saving model ...
Epoch: 12 cost time: 4.475883483886719
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.131 Vali Acc: 0.958 Test Loss: 0.131 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.865885496139526
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.846775770187378
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974233).  Saving model ...
Epoch: 15 cost time: 4.937622308731079
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.066730976104736
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.133284330368042
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.037622690200806
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.963 Test Loss: 0.110 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.020316123962402
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.3017613887786865
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.3842315673828125
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.383667469024658
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.209 Vali Acc: 0.932 Test Loss: 0.209 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.29018497467041
Epoch: 23, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.979781627655029
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 25 cost time: 4.515459775924683
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.348053932189941
Epoch: 26, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.7153480052948
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.359985828399658
Epoch: 28, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.569627523422241
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.91061544418335
Epoch: 30, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.328256130218506
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.9833924770355225
Epoch: 32, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.892093181610107
Epoch: 33, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.390715599060059
Epoch: 34, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 54084
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.209887504577637
Epoch: 1, Steps: 89 | Train Loss: 2.658 Vali Loss: 1.703 Vali Acc: 0.655 Test Loss: 1.703 Test Acc: 0.655
Validation loss decreased (inf --> -0.655275).  Saving model ...
Epoch: 2 cost time: 5.374984979629517
Epoch: 2, Steps: 89 | Train Loss: 1.164 Vali Loss: 0.687 Vali Acc: 0.848 Test Loss: 0.687 Test Acc: 0.848
Validation loss decreased (-0.655275 --> -0.848183).  Saving model ...
Epoch: 3 cost time: 5.179157495498657
Epoch: 3, Steps: 89 | Train Loss: 0.573 Vali Loss: 0.411 Vali Acc: 0.895 Test Loss: 0.411 Test Acc: 0.895
Validation loss decreased (-0.848183 --> -0.894843).  Saving model ...
Epoch: 4 cost time: 5.638086795806885
Epoch: 4, Steps: 89 | Train Loss: 0.372 Vali Loss: 0.307 Vali Acc: 0.918 Test Loss: 0.307 Test Acc: 0.918
Validation loss decreased (-0.894843 --> -0.917824).  Saving model ...
Epoch: 5 cost time: 4.874020576477051
Epoch: 5, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.917824 --> -0.937323).  Saving model ...
Epoch: 6 cost time: 6.526144504547119
Epoch: 6, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.937323 --> -0.943591).  Saving model ...
Epoch: 7 cost time: 5.9805755615234375
Epoch: 7, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
Validation loss decreased (-0.943591 --> -0.954734).  Saving model ...
Epoch: 8 cost time: 6.3556013107299805
Epoch: 8, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.954734 --> -0.958216).  Saving model ...
Epoch: 9 cost time: 6.350032806396484
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 6.353492021560669
Epoch: 10, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.131443023681641
Epoch: 11, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.961698 --> -0.965180).  Saving model ...
Epoch: 12 cost time: 6.221131324768066
Epoch: 12, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.268811464309692
Epoch: 13, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 14 cost time: 4.903362989425659
Epoch: 14, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 5.83826756477356
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.482120037078857
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970055).  Saving model ...
Epoch: 17 cost time: 5.733092308044434
Epoch: 17, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.280632495880127
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 19 cost time: 5.5003886222839355
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.361549139022827
Epoch: 20, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.4652485847473145
Epoch: 21, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 22 cost time: 5.911529779434204
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 23 cost time: 5.593161344528198
Epoch: 23, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.432844161987305
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.293527126312256
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.395562171936035
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.956 Test Loss: 0.148 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.673296213150024
Epoch: 27, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.049652338027954
Epoch: 28, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.816051959991455
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.865499258041382
Epoch: 30, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 31 cost time: 5.869601011276245
Epoch: 31, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 32 cost time: 6.168951034545898
Epoch: 32, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 7.4258928298950195
Epoch: 33, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.663021564483643
Epoch: 34, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 6.745316982269287
Epoch: 35, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 6.93940281867981
Epoch: 36, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 6.942066192626953
Epoch: 37, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 38 cost time: 7.107406854629517
Epoch: 38, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.595348596572876
Epoch: 39, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.757882833480835
Epoch: 40, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 6.5787293910980225
Epoch: 41, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 6.2214250564575195
Epoch: 42, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 5.314937114715576
Epoch: 43, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 6.3226025104522705
Epoch: 44, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 5.761725187301636
Epoch: 45, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 5.474702596664429
Epoch: 46, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 4.955369472503662
Epoch: 47, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 46484
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.346166133880615
Epoch: 1, Steps: 89 | Train Loss: 2.628 Vali Loss: 1.876 Vali Acc: 0.622 Test Loss: 1.876 Test Acc: 0.622
Validation loss decreased (inf --> -0.621848).  Saving model ...
Epoch: 2 cost time: 5.058873891830444
Epoch: 2, Steps: 89 | Train Loss: 1.408 Vali Loss: 0.882 Vali Acc: 0.799 Test Loss: 0.882 Test Acc: 0.799
Validation loss decreased (-0.621848 --> -0.799434).  Saving model ...
Epoch: 3 cost time: 5.916835308074951
Epoch: 3, Steps: 89 | Train Loss: 0.726 Vali Loss: 0.572 Vali Acc: 0.847 Test Loss: 0.572 Test Acc: 0.847
Validation loss decreased (-0.799434 --> -0.847487).  Saving model ...
Epoch: 4 cost time: 5.918614387512207
Epoch: 4, Steps: 89 | Train Loss: 0.473 Vali Loss: 0.398 Vali Acc: 0.898 Test Loss: 0.398 Test Acc: 0.898
Validation loss decreased (-0.847487 --> -0.898325).  Saving model ...
Epoch: 5 cost time: 6.869257688522339
Epoch: 5, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.304 Vali Acc: 0.914 Test Loss: 0.304 Test Acc: 0.914
Validation loss decreased (-0.898325 --> -0.914342).  Saving model ...
Epoch: 6 cost time: 6.540733575820923
Epoch: 6, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.914342 --> -0.940805).  Saving model ...
Epoch: 7 cost time: 5.882466077804565
Epoch: 7, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.940805 --> -0.949859).  Saving model ...
Epoch: 8 cost time: 6.865304708480835
Epoch: 8, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.13460111618042
Epoch: 9, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.227 Vali Acc: 0.934 Test Loss: 0.227 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.366399049758911
Epoch: 10, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.949859 --> -0.951948).  Saving model ...
Epoch: 11 cost time: 5.044042348861694
Epoch: 11, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
Validation loss decreased (-0.951948 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 6.7182135581970215
Epoch: 12, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.793198585510254
Epoch: 13, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.970751 --> -0.974929).  Saving model ...
Epoch: 14 cost time: 6.456351041793823
Epoch: 14, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.761670351028442
Epoch: 15, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.2306976318359375
Epoch: 16, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 17 cost time: 7.489184379577637
Epoch: 17, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.660765171051025
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.185834169387817
Epoch: 19, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.793014287948608
Epoch: 20, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.303925275802612
Epoch: 21, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.022987604141235
Epoch: 22, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.810125827789307
Epoch: 23, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.790365219116211
Epoch: 24, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.048360347747803
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.19464373588562
Epoch: 26, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 41828
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.37716817855835
Epoch: 1, Steps: 89 | Train Loss: 2.772 Vali Loss: 2.151 Vali Acc: 0.503 Test Loss: 2.151 Test Acc: 0.503
Validation loss decreased (inf --> -0.502764).  Saving model ...
Epoch: 2 cost time: 5.8370680809021
Epoch: 2, Steps: 89 | Train Loss: 1.741 Vali Loss: 1.179 Vali Acc: 0.765 Test Loss: 1.179 Test Acc: 0.765
Validation loss decreased (-0.502764 --> -0.765309).  Saving model ...
Epoch: 3 cost time: 6.965403318405151
Epoch: 3, Steps: 89 | Train Loss: 0.947 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
Validation loss decreased (-0.765309 --> -0.849575).  Saving model ...
Epoch: 4 cost time: 6.759369611740112
Epoch: 4, Steps: 89 | Train Loss: 0.591 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
Validation loss decreased (-0.849575 --> -0.889271).  Saving model ...
Epoch: 5 cost time: 6.5090789794921875
Epoch: 5, Steps: 89 | Train Loss: 0.432 Vali Loss: 0.363 Vali Acc: 0.913 Test Loss: 0.363 Test Acc: 0.913
Validation loss decreased (-0.889271 --> -0.912949).  Saving model ...
Epoch: 6 cost time: 5.845051288604736
Epoch: 6, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.287 Vali Acc: 0.928 Test Loss: 0.287 Test Acc: 0.928
Validation loss decreased (-0.912949 --> -0.927574).  Saving model ...
Epoch: 7 cost time: 7.228168725967407
Epoch: 7, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.225 Vali Acc: 0.938 Test Loss: 0.225 Test Acc: 0.938
Validation loss decreased (-0.927574 --> -0.938020).  Saving model ...
Epoch: 8 cost time: 7.062626838684082
Epoch: 8, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
Validation loss decreased (-0.938020 --> -0.949859).  Saving model ...
Epoch: 9 cost time: 7.100519895553589
Epoch: 9, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.738062143325806
Epoch: 10, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.949859 --> -0.951948).  Saving model ...
Epoch: 11 cost time: 7.061599969863892
Epoch: 11, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.951948 --> -0.957519).  Saving model ...
Epoch: 12 cost time: 5.6988959312438965
Epoch: 12, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.957519 --> -0.967965).  Saving model ...
Epoch: 13 cost time: 6.603210687637329
Epoch: 13, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.711161851882935
Epoch: 14, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.973536).  Saving model ...
Epoch: 15 cost time: 4.848489999771118
Epoch: 15, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.150102138519287
Epoch: 16, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.973536 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 6.219028472900391
Epoch: 17, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.352340221405029
Epoch: 18, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.190683364868164
Epoch: 19, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.23314094543457
Epoch: 20, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 21 cost time: 6.044682025909424
Epoch: 21, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.833319425582886
Epoch: 22, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.286756277084351
Epoch: 23, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.905165195465088
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.22023344039917
Epoch: 25, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.091 Vali Acc: 0.969 Test Loss: 0.091 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.6136369705200195
Epoch: 26, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 27 cost time: 5.410349130630493
Epoch: 27, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.742797136306763
Epoch: 28, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.708649635314941
Epoch: 29, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.394171237945557
Epoch: 30, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.0028088092803955
Epoch: 31, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.604391574859619
Epoch: 32, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.977019 --> -0.977019).  Saving model ...
Epoch: 33 cost time: 5.433251142501831
Epoch: 33, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.407122373580933
Epoch: 34, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.433077573776245
Epoch: 35, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.303163766860962
Epoch: 36, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.89195990562439
Epoch: 37, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 6.714927673339844
Epoch: 38, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 7.181206464767456
Epoch: 39, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 7.708822011947632
Epoch: 40, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 8.308881521224976
Epoch: 41, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 8.018136024475098
Epoch: 42, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.096 Vali Acc: 0.969 Test Loss: 0.096 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 38132
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.38500452041626
Epoch: 1, Steps: 89 | Train Loss: 2.837 Vali Loss: 2.252 Vali Acc: 0.470 Test Loss: 2.252 Test Acc: 0.470
Validation loss decreased (inf --> -0.470033).  Saving model ...
Epoch: 2 cost time: 8.870595693588257
Epoch: 2, Steps: 89 | Train Loss: 1.863 Vali Loss: 1.287 Vali Acc: 0.742 Test Loss: 1.287 Test Acc: 0.742
Validation loss decreased (-0.470033 --> -0.741631).  Saving model ...
Epoch: 3 cost time: 8.192468881607056
Epoch: 3, Steps: 89 | Train Loss: 1.062 Vali Loss: 0.782 Vali Acc: 0.833 Test Loss: 0.782 Test Acc: 0.833
Validation loss decreased (-0.741631 --> -0.832861).  Saving model ...
Epoch: 4 cost time: 8.988659858703613
Epoch: 4, Steps: 89 | Train Loss: 0.700 Vali Loss: 0.563 Vali Acc: 0.859 Test Loss: 0.563 Test Acc: 0.859
Validation loss decreased (-0.832861 --> -0.858629).  Saving model ...
Epoch: 5 cost time: 9.353953838348389
Epoch: 5, Steps: 89 | Train Loss: 0.507 Vali Loss: 0.414 Vali Acc: 0.903 Test Loss: 0.414 Test Acc: 0.903
Validation loss decreased (-0.858629 --> -0.903199).  Saving model ...
Epoch: 6 cost time: 9.248852968215942
Epoch: 6, Steps: 89 | Train Loss: 0.403 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
Validation loss decreased (-0.903199 --> -0.919217).  Saving model ...
Epoch: 7 cost time: 8.721848487854004
Epoch: 7, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.268 Vali Acc: 0.934 Test Loss: 0.268 Test Acc: 0.934
Validation loss decreased (-0.919217 --> -0.933841).  Saving model ...
Epoch: 8 cost time: 8.950664281845093
Epoch: 8, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.235 Vali Acc: 0.939 Test Loss: 0.235 Test Acc: 0.939
Validation loss decreased (-0.933841 --> -0.939413).  Saving model ...
Epoch: 9 cost time: 7.88684868812561
Epoch: 9, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
Validation loss decreased (-0.939413 --> -0.952644).  Saving model ...
Epoch: 10 cost time: 9.116824388504028
Epoch: 10, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.196 Vali Acc: 0.940 Test Loss: 0.196 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.50560188293457
Epoch: 11, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
Validation loss decreased (-0.952644 --> -0.956127).  Saving model ...
Epoch: 12 cost time: 8.987288475036621
Epoch: 12, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
Validation loss decreased (-0.956127 --> -0.963090).  Saving model ...
Epoch: 13 cost time: 8.070749998092651
Epoch: 13, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
Validation loss decreased (-0.963090 --> -0.972143).  Saving model ...
Epoch: 14 cost time: 8.11493444442749
Epoch: 14, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.716771602630615
Epoch: 15, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.230653285980225
Epoch: 16, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972143 --> -0.972840).  Saving model ...
Epoch: 17 cost time: 8.047606468200684
Epoch: 17, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.803434133529663
Epoch: 18, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973536).  Saving model ...
Epoch: 19 cost time: 8.630727767944336
Epoch: 19, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 20 cost time: 8.033843994140625
Epoch: 20, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.905627012252808
Epoch: 21, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 22 cost time: 6.800909757614136
Epoch: 22, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.418904304504395
Epoch: 23, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 24 cost time: 8.589093208312988
Epoch: 24, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
Validation loss decreased (-0.977715 --> -0.981893).  Saving model ...
Epoch: 25 cost time: 7.787671327590942
Epoch: 25, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.1843297481536865
Epoch: 26, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.955807447433472
Epoch: 27, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 8.524922132492065
Epoch: 28, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 7.54729962348938
Epoch: 29, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 8.145837545394897
Epoch: 30, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 8.854066848754883
Epoch: 31, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 8.96984338760376
Epoch: 32, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 9.125785112380981
Epoch: 33, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 8.884739637374878
Epoch: 34, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 36356
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.546045064926147
Epoch: 1, Steps: 89 | Train Loss: 2.029 Vali Loss: 0.847 Vali Acc: 0.760 Test Loss: 0.847 Test Acc: 0.760
Validation loss decreased (inf --> -0.759741).  Saving model ...
Epoch: 2 cost time: 6.651870489120483
Epoch: 2, Steps: 89 | Train Loss: 0.578 Vali Loss: 0.402 Vali Acc: 0.889 Test Loss: 0.402 Test Acc: 0.889
Validation loss decreased (-0.759741 --> -0.888575).  Saving model ...
Epoch: 3 cost time: 7.468371868133545
Epoch: 3, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
Validation loss decreased (-0.888575 --> -0.927574).  Saving model ...
Epoch: 4 cost time: 7.235285758972168
Epoch: 4, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
Validation loss decreased (-0.927574 --> -0.934538).  Saving model ...
Epoch: 5 cost time: 7.160112380981445
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
Validation loss decreased (-0.934538 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 6.887652635574341
Epoch: 6, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.638031005859375
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.172 Vali Acc: 0.945 Test Loss: 0.172 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.983798265457153
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.196 Vali Acc: 0.947 Test Loss: 0.196 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.454457759857178
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.951252 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 6.93518853187561
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.4824841022491455
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.532926797866821
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.097288608551025
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.178 Vali Acc: 0.955 Test Loss: 0.178 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.064974784851074
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.362773656845093
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.961698 --> -0.973537).  Saving model ...
Epoch: 16 cost time: 7.3873069286346436
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.187296152114868
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.819398403167725
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.818600654602051
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.365283250808716
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.087262868881226
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.7777934074401855
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.838675498962402
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.979168176651001
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.960 Test Loss: 0.189 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.479968547821045
Epoch: 25, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.195 Vali Acc: 0.960 Test Loss: 0.195 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 74868
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.916932582855225
Epoch: 1, Steps: 89 | Train Loss: 2.331 Vali Loss: 1.219 Vali Acc: 0.733 Test Loss: 1.219 Test Acc: 0.733
Validation loss decreased (inf --> -0.732578).  Saving model ...
Epoch: 2 cost time: 7.3441197872161865
Epoch: 2, Steps: 89 | Train Loss: 0.817 Vali Loss: 0.520 Vali Acc: 0.872 Test Loss: 0.520 Test Acc: 0.872
Validation loss decreased (-0.732578 --> -0.871861).  Saving model ...
Epoch: 3 cost time: 7.177770137786865
Epoch: 3, Steps: 89 | Train Loss: 0.412 Vali Loss: 0.353 Vali Acc: 0.895 Test Loss: 0.353 Test Acc: 0.895
Validation loss decreased (-0.871861 --> -0.894843).  Saving model ...
Epoch: 4 cost time: 7.7043187618255615
Epoch: 4, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.310 Vali Acc: 0.907 Test Loss: 0.310 Test Acc: 0.907
Validation loss decreased (-0.894843 --> -0.906682).  Saving model ...
Epoch: 5 cost time: 6.330319881439209
Epoch: 5, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.215 Vali Acc: 0.938 Test Loss: 0.215 Test Acc: 0.938
Validation loss decreased (-0.906682 --> -0.938020).  Saving model ...
Epoch: 6 cost time: 6.84346604347229
Epoch: 6, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
Validation loss decreased (-0.938020 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 6.6019086837768555
Epoch: 7, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
Validation loss decreased (-0.955430 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 7.949771404266357
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.959608).  Saving model ...
Epoch: 9 cost time: 7.671252489089966
Epoch: 9, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.959608 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 7.079630613327026
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.203409194946289
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.961698).  Saving model ...
Epoch: 12 cost time: 7.232703685760498
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.961698 --> -0.967965).  Saving model ...
Epoch: 13 cost time: 7.836969375610352
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 14 cost time: 8.035014390945435
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.73114800453186
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.253612279891968
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.406355619430542
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.504326105117798
Epoch: 18, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.970897197723389
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.24585747718811
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.387168884277344
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.117579936981201
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.109349250793457
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 50948
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.825245141983032
Epoch: 1, Steps: 89 | Train Loss: 2.543 Vali Loss: 1.546 Vali Acc: 0.702 Test Loss: 1.546 Test Acc: 0.702
Validation loss decreased (inf --> -0.701934).  Saving model ...
Epoch: 2 cost time: 7.773751974105835
Epoch: 2, Steps: 89 | Train Loss: 1.020 Vali Loss: 0.628 Vali Acc: 0.840 Test Loss: 0.628 Test Acc: 0.840
Validation loss decreased (-0.701934 --> -0.839827).  Saving model ...
Epoch: 3 cost time: 7.212673187255859
Epoch: 3, Steps: 89 | Train Loss: 0.491 Vali Loss: 0.377 Vali Acc: 0.898 Test Loss: 0.377 Test Acc: 0.898
Validation loss decreased (-0.839827 --> -0.897629).  Saving model ...
Epoch: 4 cost time: 7.182451009750366
Epoch: 4, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
Validation loss decreased (-0.897629 --> -0.905986).  Saving model ...
Epoch: 5 cost time: 7.108654260635376
Epoch: 5, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.905986 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 7.585559844970703
Epoch: 6, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
Validation loss decreased (-0.945680 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 7.518268585205078
Epoch: 7, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.954037 --> -0.958216).  Saving model ...
Epoch: 8 cost time: 6.5883612632751465
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.92845606803894
Epoch: 9, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
Validation loss decreased (-0.958216 --> -0.958216).  Saving model ...
Epoch: 10 cost time: 6.895206928253174
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.958216 --> -0.959609).  Saving model ...
Epoch: 11 cost time: 7.092468976974487
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.959609 --> -0.970055).  Saving model ...
Epoch: 12 cost time: 6.9739580154418945
Epoch: 12, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.7067296504974365
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 6.21299147605896
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 15 cost time: 6.99483585357666
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.007913827896118
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.107 Vali Acc: 0.964 Test Loss: 0.107 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.822160243988037
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.108 Vali Acc: 0.964 Test Loss: 0.108 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.241665363311768
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.130 Vali Acc: 0.958 Test Loss: 0.130 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.28575325012207
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.0106494426727295
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.278085231781006
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.535854339599609
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.311753273010254
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.49595832824707
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 41412
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.469897747039795
Epoch: 1, Steps: 89 | Train Loss: 2.677 Vali Loss: 1.772 Vali Acc: 0.643 Test Loss: 1.772 Test Acc: 0.643
Validation loss decreased (inf --> -0.642740).  Saving model ...
Epoch: 2 cost time: 8.518903970718384
Epoch: 2, Steps: 89 | Train Loss: 1.221 Vali Loss: 0.730 Vali Acc: 0.835 Test Loss: 0.730 Test Acc: 0.835
Validation loss decreased (-0.642740 --> -0.834951).  Saving model ...
Epoch: 3 cost time: 8.870289087295532
Epoch: 3, Steps: 89 | Train Loss: 0.597 Vali Loss: 0.447 Vali Acc: 0.883 Test Loss: 0.447 Test Acc: 0.883
Validation loss decreased (-0.834951 --> -0.883004).  Saving model ...
Epoch: 4 cost time: 8.336124658584595
Epoch: 4, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.883004 --> -0.902504).  Saving model ...
Epoch: 5 cost time: 9.604905366897583
Epoch: 5, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
Validation loss decreased (-0.902504 --> -0.922003).  Saving model ...
Epoch: 6 cost time: 9.247678279876709
Epoch: 6, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
Validation loss decreased (-0.922003 --> -0.928271).  Saving model ...
Epoch: 7 cost time: 8.816207647323608
Epoch: 7, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
Validation loss decreased (-0.928271 --> -0.951252).  Saving model ...
Epoch: 8 cost time: 9.503492832183838
Epoch: 8, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951252 --> -0.951948).  Saving model ...
Epoch: 9 cost time: 8.285229206085205
Epoch: 9, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.951948 --> -0.962394).  Saving model ...
Epoch: 10 cost time: 7.203977346420288
Epoch: 10, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.977346181869507
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.135 Vali Acc: 0.960 Test Loss: 0.135 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.5240538120269775
Epoch: 12, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.138 Vali Acc: 0.955 Test Loss: 0.138 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.054874181747437
Epoch: 13, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.962394 --> -0.970055).  Saving model ...
Epoch: 14 cost time: 8.12768292427063
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.145 Vali Acc: 0.955 Test Loss: 0.145 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.370550632476807
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.107 Vali Acc: 0.963 Test Loss: 0.107 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.989680767059326
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.408660650253296
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.121 Vali Acc: 0.960 Test Loss: 0.121 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.809898138046265
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 19 cost time: 6.660141229629517
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.495187520980835
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 21 cost time: 7.009359121322632
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.972144 --> -0.974929).  Saving model ...
Epoch: 22 cost time: 6.516732931137085
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.008783340454102
Epoch: 23, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.0258629322052
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.610117435455322
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.737594366073608
Epoch: 26, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.778055429458618
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.343600511550903
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.153726577758789
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 30 cost time: 6.689021348953247
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.116083860397339
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.33388876914978
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.437946796417236
Epoch: 33, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.231795072555542
Epoch: 34, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.924993276596069
Epoch: 35, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 6.241886854171753
Epoch: 36, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 7.298750162124634
Epoch: 37, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 7.369309663772583
Epoch: 38, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 7.257986783981323
Epoch: 39, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 33812
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.67557168006897
Epoch: 1, Steps: 89 | Train Loss: 2.806 Vali Loss: 2.046 Vali Acc: 0.561 Test Loss: 2.046 Test Acc: 0.561
Validation loss decreased (inf --> -0.560564).  Saving model ...
Epoch: 2 cost time: 5.223987340927124
Epoch: 2, Steps: 89 | Train Loss: 1.523 Vali Loss: 0.919 Vali Acc: 0.818 Test Loss: 0.919 Test Acc: 0.818
Validation loss decreased (-0.560564 --> -0.818236).  Saving model ...
Epoch: 3 cost time: 6.290616035461426
Epoch: 3, Steps: 89 | Train Loss: 0.753 Vali Loss: 0.549 Vali Acc: 0.867 Test Loss: 0.549 Test Acc: 0.867
Validation loss decreased (-0.818236 --> -0.866986).  Saving model ...
Epoch: 4 cost time: 6.080262660980225
Epoch: 4, Steps: 89 | Train Loss: 0.482 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
Validation loss decreased (-0.866986 --> -0.899717).  Saving model ...
Epoch: 5 cost time: 5.9880897998809814
Epoch: 5, Steps: 89 | Train Loss: 0.355 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
Validation loss decreased (-0.899717 --> -0.930359).  Saving model ...
Epoch: 6 cost time: 6.27957558631897
Epoch: 6, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.231 Vali Acc: 0.940 Test Loss: 0.231 Test Acc: 0.940
Validation loss decreased (-0.930359 --> -0.940109).  Saving model ...
Epoch: 7 cost time: 5.60808539390564
Epoch: 7, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.212 Vali Acc: 0.943 Test Loss: 0.212 Test Acc: 0.943
Validation loss decreased (-0.940109 --> -0.942895).  Saving model ...
Epoch: 8 cost time: 6.224043607711792
Epoch: 8, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
Validation loss decreased (-0.942895 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 6.246258974075317
Epoch: 9, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.045990228652954
Epoch: 10, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.988513946533203
Epoch: 11, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (-0.961001 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 5.297344207763672
Epoch: 12, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.0796058177948
Epoch: 13, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.122730255126953
Epoch: 14, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.322054862976074
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.969358 --> -0.972840).  Saving model ...
Epoch: 16 cost time: 5.7469799518585205
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 17 cost time: 6.092575788497925
Epoch: 17, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.973537 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 5.804322004318237
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.502934455871582
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.157260179519653
Epoch: 20, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.096868276596069
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 22 cost time: 5.31188702583313
Epoch: 22, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.581557035446167
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.343969345092773
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 25 cost time: 5.403636932373047
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 26 cost time: 5.440313816070557
Epoch: 26, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.461206436157227
Epoch: 27, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.267677307128906
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.410506010055542
Epoch: 29, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.9160802364349365
Epoch: 30, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 31 cost time: 6.965877532958984
Epoch: 31, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.834703207015991
Epoch: 32, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 33 cost time: 6.882466554641724
Epoch: 33, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.821546792984009
Epoch: 34, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.857051372528076
Epoch: 35, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.033099412918091
Epoch: 36, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.161671161651611
Epoch: 37, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 6.387469053268433
Epoch: 38, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 6.101478099822998
Epoch: 39, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.983286).  Saving model ...
Epoch: 40 cost time: 5.76154899597168
Epoch: 40, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.116101026535034
Epoch: 41, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.291329622268677
Epoch: 42, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.547082185745239
Epoch: 43, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 7.557987451553345
Epoch: 44, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 7.3967907428741455
Epoch: 45, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 7.214724540710449
Epoch: 46, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 6.340528726577759
Epoch: 47, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 6.649563312530518
Epoch: 48, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 7.023231267929077
Epoch: 49, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 29156
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.812820911407471
Epoch: 1, Steps: 89 | Train Loss: 2.816 Vali Loss: 2.214 Vali Acc: 0.485 Test Loss: 2.214 Test Acc: 0.485
Validation loss decreased (inf --> -0.485354).  Saving model ...
Epoch: 2 cost time: 6.7043845653533936
Epoch: 2, Steps: 89 | Train Loss: 1.763 Vali Loss: 1.166 Vali Acc: 0.758 Test Loss: 1.166 Test Acc: 0.758
Validation loss decreased (-0.485354 --> -0.757649).  Saving model ...
Epoch: 3 cost time: 6.8344337940216064
Epoch: 3, Steps: 89 | Train Loss: 0.973 Vali Loss: 0.717 Vali Acc: 0.847 Test Loss: 0.717 Test Acc: 0.847
Validation loss decreased (-0.757649 --> -0.846789).  Saving model ...
Epoch: 4 cost time: 6.528693437576294
Epoch: 4, Steps: 89 | Train Loss: 0.654 Vali Loss: 0.517 Vali Acc: 0.886 Test Loss: 0.517 Test Acc: 0.886
Validation loss decreased (-0.846789 --> -0.885789).  Saving model ...
Epoch: 5 cost time: 6.425323724746704
Epoch: 5, Steps: 89 | Train Loss: 0.481 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
Validation loss decreased (-0.885789 --> -0.902503).  Saving model ...
Epoch: 6 cost time: 6.572942018508911
Epoch: 6, Steps: 89 | Train Loss: 0.377 Vali Loss: 0.306 Vali Acc: 0.928 Test Loss: 0.306 Test Acc: 0.928
Validation loss decreased (-0.902503 --> -0.927574).  Saving model ...
Epoch: 7 cost time: 6.648416042327881
Epoch: 7, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
Validation loss decreased (-0.927574 --> -0.940805).  Saving model ...
Epoch: 8 cost time: 6.456704378128052
Epoch: 8, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
Validation loss decreased (-0.940805 --> -0.951948).  Saving model ...
Epoch: 9 cost time: 6.137001037597656
Epoch: 9, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
Validation loss decreased (-0.951948 --> -0.954037).  Saving model ...
Epoch: 10 cost time: 6.161754131317139
Epoch: 10, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.191803932189941
Epoch: 11, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
Validation loss decreased (-0.954037 --> -0.961001).  Saving model ...
Epoch: 12 cost time: 6.30246901512146
Epoch: 12, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.9661102294921875
Epoch: 13, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
Validation loss decreased (-0.961001 --> -0.965876).  Saving model ...
Epoch: 14 cost time: 6.7284159660339355
Epoch: 14, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.967269).  Saving model ...
Epoch: 15 cost time: 6.620004653930664
Epoch: 15, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.967269 --> -0.974233).  Saving model ...
Epoch: 16 cost time: 6.685371398925781
Epoch: 16, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.0837016105651855
Epoch: 17, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 18 cost time: 6.055815935134888
Epoch: 18, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 19 cost time: 6.635735034942627
Epoch: 19, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.70919942855835
Epoch: 20, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 21 cost time: 7.051154851913452
Epoch: 21, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.77448844909668
Epoch: 22, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.821252346038818
Epoch: 23, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.125603199005127
Epoch: 24, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.439945459365845
Epoch: 25, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
Validation loss decreased (-0.977715 --> -0.983982).  Saving model ...
Epoch: 26 cost time: 6.662353038787842
Epoch: 26, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.791186332702637
Epoch: 27, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.721519231796265
Epoch: 28, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.534662485122681
Epoch: 29, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.071063280105591
Epoch: 30, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.888252019882202
Epoch: 31, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 5.739607810974121
Epoch: 32, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.365612745285034
Epoch: 33, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.2334325313568115
Epoch: 34, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 5.986880540847778
Epoch: 35, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 25460
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.07474946975708
Epoch: 1, Steps: 89 | Train Loss: 2.817 Vali Loss: 2.229 Vali Acc: 0.499 Test Loss: 2.229 Test Acc: 0.499
Validation loss decreased (inf --> -0.499281).  Saving model ...
Epoch: 2 cost time: 5.63122296333313
Epoch: 2, Steps: 89 | Train Loss: 1.872 Vali Loss: 1.299 Vali Acc: 0.753 Test Loss: 1.299 Test Acc: 0.753
Validation loss decreased (-0.499281 --> -0.752773).  Saving model ...
Epoch: 3 cost time: 5.312530755996704
Epoch: 3, Steps: 89 | Train Loss: 1.103 Vali Loss: 0.833 Vali Acc: 0.835 Test Loss: 0.833 Test Acc: 0.835
Validation loss decreased (-0.752773 --> -0.834950).  Saving model ...
Epoch: 4 cost time: 5.214712381362915
Epoch: 4, Steps: 89 | Train Loss: 0.762 Vali Loss: 0.601 Vali Acc: 0.862 Test Loss: 0.601 Test Acc: 0.862
Validation loss decreased (-0.834950 --> -0.862111).  Saving model ...
Epoch: 5 cost time: 5.160103797912598
Epoch: 5, Steps: 89 | Train Loss: 0.562 Vali Loss: 0.462 Vali Acc: 0.891 Test Loss: 0.462 Test Acc: 0.891
Validation loss decreased (-0.862111 --> -0.890664).  Saving model ...
Epoch: 6 cost time: 5.477100849151611
Epoch: 6, Steps: 89 | Train Loss: 0.445 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
Validation loss decreased (-0.890664 --> -0.899718).  Saving model ...
Epoch: 7 cost time: 4.84349799156189
Epoch: 7, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
Validation loss decreased (-0.899718 --> -0.926181).  Saving model ...
Epoch: 8 cost time: 5.212333679199219
Epoch: 8, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.273 Vali Acc: 0.928 Test Loss: 0.273 Test Acc: 0.928
Validation loss decreased (-0.926181 --> -0.928270).  Saving model ...
Epoch: 9 cost time: 5.887051343917847
Epoch: 9, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
Validation loss decreased (-0.928270 --> -0.942895).  Saving model ...
Epoch: 10 cost time: 5.9768171310424805
Epoch: 10, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.942895 --> -0.951948).  Saving model ...
Epoch: 11 cost time: 6.1198694705963135
Epoch: 11, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
Validation loss decreased (-0.951948 --> -0.962394).  Saving model ...
Epoch: 12 cost time: 5.517006158828735
Epoch: 12, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.962394 --> -0.962394).  Saving model ...
Epoch: 13 cost time: 5.411466360092163
Epoch: 13, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.145 Vali Acc: 0.955 Test Loss: 0.145 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.80092978477478
Epoch: 14, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.453522682189941
Epoch: 15, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.968662).  Saving model ...
Epoch: 16 cost time: 4.848496198654175
Epoch: 16, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 17 cost time: 5.584863901138306
Epoch: 17, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 18 cost time: 6.0035295486450195
Epoch: 18, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.733814716339111
Epoch: 19, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.936809539794922
Epoch: 20, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.62081241607666
Epoch: 21, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 22 cost time: 5.792449712753296
Epoch: 22, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.619877815246582
Epoch: 23, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 24 cost time: 5.966279745101929
Epoch: 24, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.787250995635986
Epoch: 25, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.565441370010376
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.663605213165283
Epoch: 27, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.88863468170166
Epoch: 28, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.7855634689331055
Epoch: 29, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.591878414154053
Epoch: 30, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.833756446838379
Epoch: 31, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.608453035354614
Epoch: 32, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.193877220153809
Epoch: 33, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 23684
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.107798337936401
Epoch: 1, Steps: 89 | Train Loss: 2.104 Vali Loss: 0.837 Vali Acc: 0.809 Test Loss: 0.837 Test Acc: 0.809
Validation loss decreased (inf --> -0.809184).  Saving model ...
Epoch: 2 cost time: 5.530229806900024
Epoch: 2, Steps: 89 | Train Loss: 0.606 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
Validation loss decreased (-0.809184 --> -0.875344).  Saving model ...
Epoch: 3 cost time: 5.533995628356934
Epoch: 3, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.875344 --> -0.902504).  Saving model ...
Epoch: 4 cost time: 5.480484485626221
Epoch: 4, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
Validation loss decreased (-0.902504 --> -0.941502).  Saving model ...
Epoch: 5 cost time: 6.165576219558716
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.941502 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 6.27680516242981
Epoch: 6, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.898679971694946
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
Validation loss decreased (-0.948466 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 5.381469011306763
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.961001 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 5.826390266418457
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.785018682479858
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.860126256942749
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.719067335128784
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.754786968231201
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.128552675247192
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.834367990493774
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.943602800369263
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.653434991836548
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.41746711730957
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 68532
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.802709102630615
Epoch: 1, Steps: 89 | Train Loss: 2.362 Vali Loss: 1.232 Vali Acc: 0.744 Test Loss: 1.232 Test Acc: 0.744
Validation loss decreased (inf --> -0.744417).  Saving model ...
Epoch: 2 cost time: 4.833274602890015
Epoch: 2, Steps: 89 | Train Loss: 0.883 Vali Loss: 0.550 Vali Acc: 0.870 Test Loss: 0.550 Test Acc: 0.870
Validation loss decreased (-0.744417 --> -0.869772).  Saving model ...
Epoch: 3 cost time: 5.039291858673096
Epoch: 3, Steps: 89 | Train Loss: 0.461 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
Validation loss decreased (-0.869772 --> -0.890665).  Saving model ...
Epoch: 4 cost time: 5.076985120773315
Epoch: 4, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
Validation loss decreased (-0.890665 --> -0.925485).  Saving model ...
Epoch: 5 cost time: 5.114210367202759
Epoch: 5, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.212 Vali Acc: 0.939 Test Loss: 0.212 Test Acc: 0.939
Validation loss decreased (-0.925485 --> -0.939413).  Saving model ...
Epoch: 6 cost time: 4.6836841106414795
Epoch: 6, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.939413 --> -0.940806).  Saving model ...
Epoch: 7 cost time: 4.934221982955933
Epoch: 7, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.940806 --> -0.947770).  Saving model ...
Epoch: 8 cost time: 5.211099863052368
Epoch: 8, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
Validation loss decreased (-0.947770 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 4.88808536529541
Epoch: 9, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.960305).  Saving model ...
Epoch: 10 cost time: 5.025864839553833
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.111867904663086
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.166077613830566
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
Validation loss decreased (-0.960305 --> -0.963091).  Saving model ...
Epoch: 13 cost time: 4.77973484992981
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.963091 --> -0.967965).  Saving model ...
Epoch: 14 cost time: 5.064672231674194
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.955 Test Loss: 0.141 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.463824272155762
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.314493179321289
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.844792366027832
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.098526954650879
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.989809036254883
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.076110124588013
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.193033695220947
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.967965 --> -0.972144).  Saving model ...
Epoch: 22 cost time: 5.677911043167114
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.252845048904419
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.207457780838013
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.593029499053955
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.157624244689941
Epoch: 26, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.635472536087036
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.03107762336731
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.338083982467651
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.748260974884033
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.347226619720459
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.233 Vali Acc: 0.946 Test Loss: 0.233 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 44612
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.3220534324646
Epoch: 1, Steps: 89 | Train Loss: 2.433 Vali Loss: 1.431 Vali Acc: 0.705 Test Loss: 1.431 Test Acc: 0.705
Validation loss decreased (inf --> -0.705417).  Saving model ...
Epoch: 2 cost time: 5.472827911376953
Epoch: 2, Steps: 89 | Train Loss: 0.966 Vali Loss: 0.645 Vali Acc: 0.828 Test Loss: 0.645 Test Acc: 0.828
Validation loss decreased (-0.705417 --> -0.827988).  Saving model ...
Epoch: 3 cost time: 5.564934730529785
Epoch: 3, Steps: 89 | Train Loss: 0.507 Vali Loss: 0.394 Vali Acc: 0.887 Test Loss: 0.394 Test Acc: 0.887
Validation loss decreased (-0.827988 --> -0.887183).  Saving model ...
Epoch: 4 cost time: 5.668325901031494
Epoch: 4, Steps: 89 | Train Loss: 0.328 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
Validation loss decreased (-0.887183 --> -0.910861).  Saving model ...
Epoch: 5 cost time: 5.328082084655762
Epoch: 5, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.910861 --> -0.944288).  Saving model ...
Epoch: 6 cost time: 5.548584222793579
Epoch: 6, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.944288 --> -0.951948).  Saving model ...
Epoch: 7 cost time: 5.260452508926392
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
Validation loss decreased (-0.951948 --> -0.953341).  Saving model ...
Epoch: 8 cost time: 5.3088538646698
Epoch: 8, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.953341 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 5.668036937713623
Epoch: 9, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 5.311458349227905
Epoch: 10, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.658140659332275
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.967269).  Saving model ...
Epoch: 12 cost time: 5.287953615188599
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.155 Vali Acc: 0.948 Test Loss: 0.155 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.675310850143433
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.073307037353516
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 5.603710651397705
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.112 Vali Acc: 0.963 Test Loss: 0.112 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.005819797515869
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.37091588973999
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.18908953666687
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 19 cost time: 5.191560983657837
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.390445232391357
Epoch: 20, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.103 Vali Acc: 0.964 Test Loss: 0.103 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.3568174839019775
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.975626).  Saving model ...
Epoch: 22 cost time: 4.746390104293823
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.682199954986572
Epoch: 23, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.019527435302734
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.963 Test Loss: 0.118 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.6480889320373535
Epoch: 25, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.3704893589019775
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.639875888824463
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.539594650268555
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.3632800579071045
Epoch: 29, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.979703187942505
Epoch: 30, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.485218286514282
Epoch: 31, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 35076
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.090513467788696
Epoch: 1, Steps: 89 | Train Loss: 2.681 Vali Loss: 1.771 Vali Acc: 0.631 Test Loss: 1.771 Test Acc: 0.631
Validation loss decreased (inf --> -0.630902).  Saving model ...
Epoch: 2 cost time: 5.479525089263916
Epoch: 2, Steps: 89 | Train Loss: 1.288 Vali Loss: 0.762 Vali Acc: 0.832 Test Loss: 0.762 Test Acc: 0.832
Validation loss decreased (-0.630902 --> -0.832165).  Saving model ...
Epoch: 3 cost time: 5.683560371398926
Epoch: 3, Steps: 89 | Train Loss: 0.640 Vali Loss: 0.477 Vali Acc: 0.881 Test Loss: 0.477 Test Acc: 0.881
Validation loss decreased (-0.832165 --> -0.880914).  Saving model ...
Epoch: 4 cost time: 5.302899122238159
Epoch: 4, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.343 Vali Acc: 0.914 Test Loss: 0.343 Test Acc: 0.914
Validation loss decreased (-0.880914 --> -0.914342).  Saving model ...
Epoch: 5 cost time: 5.220502138137817
Epoch: 5, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
Validation loss decreased (-0.914342 --> -0.924788).  Saving model ...
Epoch: 6 cost time: 5.478790760040283
Epoch: 6, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.228 Vali Acc: 0.938 Test Loss: 0.228 Test Acc: 0.938
Validation loss decreased (-0.924788 --> -0.938020).  Saving model ...
Epoch: 7 cost time: 5.270897626876831
Epoch: 7, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.938020 --> -0.943591).  Saving model ...
Epoch: 8 cost time: 5.7242395877838135
Epoch: 8, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
Validation loss decreased (-0.943591 --> -0.954734).  Saving model ...
Epoch: 9 cost time: 5.6790547370910645
Epoch: 9, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.4026100635528564
Epoch: 10, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
Validation loss decreased (-0.954734 --> -0.958912).  Saving model ...
Epoch: 11 cost time: 5.772370100021362
Epoch: 11, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.964483).  Saving model ...
Epoch: 12 cost time: 5.825209617614746
Epoch: 12, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.30441951751709
Epoch: 13, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.27235221862793
Epoch: 14, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967966).  Saving model ...
Epoch: 15 cost time: 6.057210445404053
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.967966 --> -0.969358).  Saving model ...
Epoch: 16 cost time: 6.332010507583618
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.114 Vali Acc: 0.960 Test Loss: 0.114 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.2788755893707275
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.462922096252441
Epoch: 18, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 19 cost time: 6.036008358001709
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971448).  Saving model ...
Epoch: 20 cost time: 6.154295444488525
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.136531591415405
Epoch: 21, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.24567174911499
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.02566385269165
Epoch: 23, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.84529447555542
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.8578925132751465
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.971448 --> -0.972840).  Saving model ...
Epoch: 26 cost time: 5.933290004730225
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.881407976150513
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.048184394836426
Epoch: 28, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.113479137420654
Epoch: 29, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 30 cost time: 5.857626676559448
Epoch: 30, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.04374361038208
Epoch: 31, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.074421644210815
Epoch: 32, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.272182941436768
Epoch: 33, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.434214353561401
Epoch: 34, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.84294867515564
Epoch: 35, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.552345275878906
Epoch: 36, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.792942047119141
Epoch: 37, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.597151279449463
Epoch: 38, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 39 cost time: 5.676807165145874
Epoch: 39, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.690599679946899
Epoch: 40, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.58822226524353
Epoch: 41, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 42 cost time: 5.711805105209351
Epoch: 42, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.51888370513916
Epoch: 43, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.29296612739563
Epoch: 44, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.190 Vali Acc: 0.955 Test Loss: 0.190 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 5.423590183258057
Epoch: 45, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 46 cost time: 5.1138575077056885
Epoch: 46, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.500893592834473
Epoch: 47, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.577595949172974
Epoch: 48, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 5.581475019454956
Epoch: 49, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 50 cost time: 5.080080270767212
Epoch: 50, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.2806031703948975
Epoch: 51, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 5.072125673294067
Epoch: 52, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 4.830442428588867
Epoch: 53, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 5.06157112121582
Epoch: 54, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 5.137010812759399
Epoch: 55, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 4.523954153060913
Epoch: 56, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 4.557952880859375
Epoch: 57, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 4.782518625259399
Epoch: 58, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 4.867544412612915
Epoch: 59, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 27476
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.890416383743286
Epoch: 1, Steps: 89 | Train Loss: 2.766 Vali Loss: 2.035 Vali Acc: 0.563 Test Loss: 2.035 Test Acc: 0.563
Validation loss decreased (inf --> -0.563350).  Saving model ...
Epoch: 2 cost time: 4.952778577804565
Epoch: 2, Steps: 89 | Train Loss: 1.556 Vali Loss: 0.945 Vali Acc: 0.776 Test Loss: 0.945 Test Acc: 0.776
Validation loss decreased (-0.563350 --> -0.775757).  Saving model ...
Epoch: 3 cost time: 5.079771518707275
Epoch: 3, Steps: 89 | Train Loss: 0.769 Vali Loss: 0.575 Vali Acc: 0.874 Test Loss: 0.575 Test Acc: 0.874
Validation loss decreased (-0.775757 --> -0.873950).  Saving model ...
Epoch: 4 cost time: 4.914168834686279
Epoch: 4, Steps: 89 | Train Loss: 0.509 Vali Loss: 0.426 Vali Acc: 0.889 Test Loss: 0.426 Test Acc: 0.889
Validation loss decreased (-0.873950 --> -0.888575).  Saving model ...
Epoch: 5 cost time: 5.058964729309082
Epoch: 5, Steps: 89 | Train Loss: 0.368 Vali Loss: 0.328 Vali Acc: 0.921 Test Loss: 0.328 Test Acc: 0.921
Validation loss decreased (-0.888575 --> -0.921306).  Saving model ...
Epoch: 6 cost time: 4.870724678039551
Epoch: 6, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.921306 --> -0.931056).  Saving model ...
Epoch: 7 cost time: 4.686722040176392
Epoch: 7, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.931056 --> -0.951948).  Saving model ...
Epoch: 8 cost time: 4.848759412765503
Epoch: 8, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
Validation loss decreased (-0.951948 --> -0.956126).  Saving model ...
Epoch: 9 cost time: 5.048558950424194
Epoch: 9, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.308008432388306
Epoch: 10, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.956126 --> -0.965180).  Saving model ...
Epoch: 11 cost time: 4.352624177932739
Epoch: 11, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966573).  Saving model ...
Epoch: 12 cost time: 4.674469947814941
Epoch: 12, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.966573 --> -0.967965).  Saving model ...
Epoch: 13 cost time: 5.157650947570801
Epoch: 13, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 14 cost time: 5.094931125640869
Epoch: 14, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.152625560760498
Epoch: 15, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 16 cost time: 5.122650623321533
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.978411).  Saving model ...
Epoch: 17 cost time: 5.045283317565918
Epoch: 17, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.070067405700684
Epoch: 18, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.9547576904296875
Epoch: 19, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.139476537704468
Epoch: 20, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.149676561355591
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.093109369277954
Epoch: 22, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.070513486862183
Epoch: 23, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.948513507843018
Epoch: 24, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 25 cost time: 4.898904085159302
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 26 cost time: 5.025402545928955
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.800646781921387
Epoch: 27, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.707703590393066
Epoch: 28, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.8478734493255615
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.904635667800903
Epoch: 30, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.003530263900757
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.9418625831604
Epoch: 32, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.988954305648804
Epoch: 33, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.726181745529175
Epoch: 34, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.724327325820923
Epoch: 35, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 22820
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.393053770065308
Epoch: 1, Steps: 89 | Train Loss: 2.829 Vali Loss: 2.261 Vali Acc: 0.460 Test Loss: 2.261 Test Acc: 0.460
Validation loss decreased (inf --> -0.460284).  Saving model ...
Epoch: 2 cost time: 4.996793746948242
Epoch: 2, Steps: 89 | Train Loss: 1.854 Vali Loss: 1.257 Vali Acc: 0.726 Test Loss: 1.257 Test Acc: 0.726
Validation loss decreased (-0.460284 --> -0.726311).  Saving model ...
Epoch: 3 cost time: 4.895215749740601
Epoch: 3, Steps: 89 | Train Loss: 1.059 Vali Loss: 0.773 Vali Acc: 0.829 Test Loss: 0.773 Test Acc: 0.829
Validation loss decreased (-0.726311 --> -0.828683).  Saving model ...
Epoch: 4 cost time: 5.133270978927612
Epoch: 4, Steps: 89 | Train Loss: 0.691 Vali Loss: 0.562 Vali Acc: 0.864 Test Loss: 0.562 Test Acc: 0.864
Validation loss decreased (-0.828683 --> -0.864201).  Saving model ...
Epoch: 5 cost time: 5.000390529632568
Epoch: 5, Steps: 89 | Train Loss: 0.508 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
Validation loss decreased (-0.864201 --> -0.899717).  Saving model ...
Epoch: 6 cost time: 5.070012331008911
Epoch: 6, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.321 Vali Acc: 0.926 Test Loss: 0.321 Test Acc: 0.926
Validation loss decreased (-0.899717 --> -0.926181).  Saving model ...
Epoch: 7 cost time: 5.425344705581665
Epoch: 7, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.256 Vali Acc: 0.939 Test Loss: 0.256 Test Acc: 0.939
Validation loss decreased (-0.926181 --> -0.939412).  Saving model ...
Epoch: 8 cost time: 5.023693084716797
Epoch: 8, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.25334620475769
Epoch: 9, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
Validation loss decreased (-0.939412 --> -0.953341).  Saving model ...
Epoch: 10 cost time: 4.463912010192871
Epoch: 10, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.6324169635772705
Epoch: 11, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
Validation loss decreased (-0.953341 --> -0.960305).  Saving model ...
Epoch: 12 cost time: 4.735997676849365
Epoch: 12, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.341266393661499
Epoch: 13, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.960305 --> -0.965180).  Saving model ...
Epoch: 14 cost time: 4.475362777709961
Epoch: 14, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.564505338668823
Epoch: 15, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.971447).  Saving model ...
Epoch: 16 cost time: 4.285937547683716
Epoch: 16, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.324204683303833
Epoch: 17, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.974233).  Saving model ...
Epoch: 18 cost time: 4.42460298538208
Epoch: 18, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 19 cost time: 4.47242546081543
Epoch: 19, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 20 cost time: 4.302650690078735
Epoch: 20, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.439869403839111
Epoch: 21, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.363409519195557
Epoch: 22, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 23 cost time: 4.1048970222473145
Epoch: 23, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 24 cost time: 4.479172229766846
Epoch: 24, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.151072978973389
Epoch: 25, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 26 cost time: 4.455655097961426
Epoch: 26, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.492479085922241
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.276275873184204
Epoch: 28, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.191997051239014
Epoch: 29, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.426050186157227
Epoch: 30, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.382970809936523
Epoch: 31, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.963 Test Loss: 0.120 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.087975025177002
Epoch: 32, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.813552141189575
Epoch: 33, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.855632305145264
Epoch: 34, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.721965551376343
Epoch: 35, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 19124
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.497069358825684
Epoch: 1, Steps: 89 | Train Loss: 2.957 Vali Loss: 2.421 Vali Acc: 0.371 Test Loss: 2.421 Test Acc: 0.371
Validation loss decreased (inf --> -0.371146).  Saving model ...
Epoch: 2 cost time: 5.0851969718933105
Epoch: 2, Steps: 89 | Train Loss: 2.016 Vali Loss: 1.411 Vali Acc: 0.721 Test Loss: 1.411 Test Acc: 0.721
Validation loss decreased (-0.371146 --> -0.720738).  Saving model ...
Epoch: 3 cost time: 4.902416229248047
Epoch: 3, Steps: 89 | Train Loss: 1.184 Vali Loss: 0.871 Vali Acc: 0.815 Test Loss: 0.871 Test Acc: 0.815
Validation loss decreased (-0.720738 --> -0.815451).  Saving model ...
Epoch: 4 cost time: 4.671003580093384
Epoch: 4, Steps: 89 | Train Loss: 0.772 Vali Loss: 0.626 Vali Acc: 0.866 Test Loss: 0.626 Test Acc: 0.866
Validation loss decreased (-0.815451 --> -0.865593).  Saving model ...
Epoch: 5 cost time: 4.943417072296143
Epoch: 5, Steps: 89 | Train Loss: 0.587 Vali Loss: 0.483 Vali Acc: 0.896 Test Loss: 0.483 Test Acc: 0.896
Validation loss decreased (-0.865593 --> -0.896235).  Saving model ...
Epoch: 6 cost time: 4.827033519744873
Epoch: 6, Steps: 89 | Train Loss: 0.452 Vali Loss: 0.373 Vali Acc: 0.918 Test Loss: 0.373 Test Acc: 0.918
Validation loss decreased (-0.896235 --> -0.917824).  Saving model ...
Epoch: 7 cost time: 4.925756931304932
Epoch: 7, Steps: 89 | Train Loss: 0.356 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.917824 --> -0.931055).  Saving model ...
Epoch: 8 cost time: 4.955395698547363
Epoch: 8, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.252 Vali Acc: 0.940 Test Loss: 0.252 Test Acc: 0.940
Validation loss decreased (-0.931055 --> -0.940109).  Saving model ...
Epoch: 9 cost time: 4.8293116092681885
Epoch: 9, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.221 Vali Acc: 0.949 Test Loss: 0.221 Test Acc: 0.949
Validation loss decreased (-0.940109 --> -0.949162).  Saving model ...
Epoch: 10 cost time: 5.376140117645264
Epoch: 10, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
Validation loss decreased (-0.949162 --> -0.956823).  Saving model ...
Epoch: 11 cost time: 5.170484781265259
Epoch: 11, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.518773078918457
Epoch: 12, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
Validation loss decreased (-0.956823 --> -0.958912).  Saving model ...
Epoch: 13 cost time: 4.756539583206177
Epoch: 13, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.958912 --> -0.966572).  Saving model ...
Epoch: 14 cost time: 5.250396966934204
Epoch: 14, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.185233116149902
Epoch: 15, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.168484926223755
Epoch: 16, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.966572 --> -0.967965).  Saving model ...
Epoch: 17 cost time: 5.506550550460815
Epoch: 17, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 18 cost time: 5.478301525115967
Epoch: 18, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 19 cost time: 5.242491006851196
Epoch: 19, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.180553436279297
Epoch: 20, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 21 cost time: 5.337428092956543
Epoch: 21, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974233).  Saving model ...
Epoch: 22 cost time: 5.111934423446655
Epoch: 22, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.079694747924805
Epoch: 23, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.182254314422607
Epoch: 24, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 25 cost time: 4.566297292709351
Epoch: 25, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 26 cost time: 4.885209798812866
Epoch: 26, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 27 cost time: 4.871542930603027
Epoch: 27, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.971914529800415
Epoch: 28, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.910833120346069
Epoch: 29, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.805863618850708
Epoch: 30, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.185467958450317
Epoch: 31, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 32 cost time: 5.633240699768066
Epoch: 32, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.242773771286011
Epoch: 33, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.636474847793579
Epoch: 34, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.660472631454468
Epoch: 35, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.980501 --> -0.981893).  Saving model ...
Epoch: 36 cost time: 4.6625285148620605
Epoch: 36, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.339340448379517
Epoch: 37, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.242637395858765
Epoch: 38, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.024350881576538
Epoch: 39, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 5.309442758560181
Epoch: 40, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.988940000534058
Epoch: 41, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 5.154675006866455
Epoch: 42, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 5.125957727432251
Epoch: 43, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.325376272201538
Epoch: 44, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 5.015277147293091
Epoch: 45, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el3_dm16_nh4_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 17348
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.790643215179443
Epoch: 1, Steps: 89 | Train Loss: 1.167 Vali Loss: 0.602 Vali Acc: 0.836 Test Loss: 0.602 Test Acc: 0.836
Validation loss decreased (inf --> -0.835649).  Saving model ...
Epoch: 2 cost time: 6.52628493309021
Epoch: 2, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.600 Vali Acc: 0.843 Test Loss: 0.600 Test Acc: 0.843
Validation loss decreased (-0.835649 --> -0.843309).  Saving model ...
Epoch: 3 cost time: 5.672887802124023
Epoch: 3, Steps: 89 | Train Loss: 0.401 Vali Loss: 0.411 Vali Acc: 0.909 Test Loss: 0.411 Test Acc: 0.909
Validation loss decreased (-0.843309 --> -0.909467).  Saving model ...
Epoch: 4 cost time: 6.294559478759766
Epoch: 4, Steps: 89 | Train Loss: 0.428 Vali Loss: 0.447 Vali Acc: 0.908 Test Loss: 0.447 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.666990280151367
Epoch: 5, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.510 Vali Acc: 0.929 Test Loss: 0.510 Test Acc: 0.929
Validation loss decreased (-0.909467 --> -0.928964).  Saving model ...
Epoch: 6 cost time: 6.400109767913818
Epoch: 6, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.573 Vali Acc: 0.907 Test Loss: 0.573 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.359536409378052
Epoch: 7, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.368 Vali Acc: 0.942 Test Loss: 0.368 Test Acc: 0.942
Validation loss decreased (-0.928964 --> -0.942197).  Saving model ...
Epoch: 8 cost time: 6.022439002990723
Epoch: 8, Steps: 89 | Train Loss: 0.179 Vali Loss: 1.674 Vali Acc: 0.815 Test Loss: 1.674 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.828078985214233
Epoch: 9, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.988 Vali Acc: 0.878 Test Loss: 0.988 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.882676124572754
Epoch: 10, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.572 Vali Acc: 0.917 Test Loss: 0.572 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.066908121109009
Epoch: 11, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.666 Vali Acc: 0.907 Test Loss: 0.666 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.796730041503906
Epoch: 12, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.546 Vali Acc: 0.925 Test Loss: 0.546 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.097278118133545
Epoch: 13, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.681 Vali Acc: 0.916 Test Loss: 0.681 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.096262454986572
Epoch: 14, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.336 Vali Acc: 0.962 Test Loss: 0.336 Test Acc: 0.962
Validation loss decreased (-0.942197 --> -0.962392).  Saving model ...
Epoch: 15 cost time: 6.866159439086914
Epoch: 15, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.494 Vali Acc: 0.948 Test Loss: 0.494 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.5328474044799805
Epoch: 16, Steps: 89 | Train Loss: 0.133 Vali Loss: 1.738 Vali Acc: 0.870 Test Loss: 1.738 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.465282201766968
Epoch: 17, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.483 Vali Acc: 0.967 Test Loss: 0.483 Test Acc: 0.967
Validation loss decreased (-0.962392 --> -0.967265).  Saving model ...
Epoch: 18 cost time: 7.164424180984497
Epoch: 18, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.489 Vali Acc: 0.948 Test Loss: 0.489 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.655400037765503
Epoch: 19, Steps: 89 | Train Loss: 0.109 Vali Loss: 1.846 Vali Acc: 0.890 Test Loss: 1.846 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.229860305786133
Epoch: 20, Steps: 89 | Train Loss: 0.311 Vali Loss: 2.683 Vali Acc: 0.834 Test Loss: 2.683 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.089869499206543
Epoch: 21, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.877 Vali Acc: 0.941 Test Loss: 0.877 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.149579763412476
Epoch: 22, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.582 Vali Acc: 0.955 Test Loss: 0.582 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.276991128921509
Epoch: 23, Steps: 89 | Train Loss: 0.148 Vali Loss: 1.166 Vali Acc: 0.905 Test Loss: 1.166 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.892494201660156
Epoch: 24, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.637 Vali Acc: 0.961 Test Loss: 0.637 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.293821811676025
Epoch: 25, Steps: 89 | Train Loss: 0.195 Vali Loss: 1.300 Vali Acc: 0.929 Test Loss: 1.300 Test Acc: 0.929
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.805755138397217
Epoch: 26, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.673 Vali Acc: 0.949 Test Loss: 0.673 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.770992994308472
Epoch: 27, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.684 Vali Acc: 0.937 Test Loss: 0.684 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 734356
model size : 5.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.917763710021973
Epoch: 1, Steps: 89 | Train Loss: 1.284 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
Validation loss decreased (inf --> -0.844006).  Saving model ...
Epoch: 2 cost time: 7.696590423583984
Epoch: 2, Steps: 89 | Train Loss: 0.441 Vali Loss: 0.262 Vali Acc: 0.937 Test Loss: 0.262 Test Acc: 0.937
Validation loss decreased (-0.844006 --> -0.936627).  Saving model ...
Epoch: 3 cost time: 7.399325847625732
Epoch: 3, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.353 Vali Acc: 0.906 Test Loss: 0.353 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.6415934562683105
Epoch: 4, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.374 Vali Acc: 0.917 Test Loss: 0.374 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.03804612159729
Epoch: 5, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.293 Vali Acc: 0.942 Test Loss: 0.293 Test Acc: 0.942
Validation loss decreased (-0.936627 --> -0.941501).  Saving model ...
Epoch: 6 cost time: 7.588788270950317
Epoch: 6, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.338 Vali Acc: 0.931 Test Loss: 0.338 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.136972188949585
Epoch: 7, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
Validation loss decreased (-0.941501 --> -0.951948).  Saving model ...
Epoch: 8 cost time: 7.069321632385254
Epoch: 8, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.281 Vali Acc: 0.943 Test Loss: 0.281 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.944672584533691
Epoch: 9, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.305 Vali Acc: 0.951 Test Loss: 0.305 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.95522665977478
Epoch: 10, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.299 Vali Acc: 0.960 Test Loss: 0.299 Test Acc: 0.960
Validation loss decreased (-0.951948 --> -0.959607).  Saving model ...
Epoch: 11 cost time: 7.030202150344849
Epoch: 11, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.351 Vali Acc: 0.948 Test Loss: 0.351 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.960385799407959
Epoch: 12, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.290 Vali Acc: 0.948 Test Loss: 0.290 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.106760025024414
Epoch: 13, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.455 Vali Acc: 0.931 Test Loss: 0.455 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.39476752281189
Epoch: 14, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.324 Vali Acc: 0.953 Test Loss: 0.324 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.063726902008057
Epoch: 15, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.649 Vali Acc: 0.938 Test Loss: 0.649 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.079101324081421
Epoch: 16, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.466 Vali Acc: 0.946 Test Loss: 0.466 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.258730173110962
Epoch: 17, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.282 Vali Acc: 0.960 Test Loss: 0.282 Test Acc: 0.960
Validation loss decreased (-0.959607 --> -0.960304).  Saving model ...
Epoch: 18 cost time: 5.886322498321533
Epoch: 18, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.360 Vali Acc: 0.960 Test Loss: 0.360 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.681009292602539
Epoch: 19, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.329 Vali Acc: 0.958 Test Loss: 0.329 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.832760334014893
Epoch: 20, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.334 Vali Acc: 0.965 Test Loss: 0.334 Test Acc: 0.965
Validation loss decreased (-0.960304 --> -0.965178).  Saving model ...
Epoch: 21 cost time: 6.753458499908447
Epoch: 21, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.560 Vali Acc: 0.949 Test Loss: 0.560 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.827026128768921
Epoch: 22, Steps: 89 | Train Loss: 0.139 Vali Loss: 1.039 Vali Acc: 0.899 Test Loss: 1.039 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.138190746307373
Epoch: 23, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.390 Vali Acc: 0.958 Test Loss: 0.390 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.181014776229858
Epoch: 24, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.550 Vali Acc: 0.937 Test Loss: 0.550 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.470608472824097
Epoch: 25, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.451 Vali Acc: 0.955 Test Loss: 0.451 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.51439094543457
Epoch: 26, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.614 Vali Acc: 0.953 Test Loss: 0.614 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.711578369140625
Epoch: 27, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.960 Vali Acc: 0.893 Test Loss: 0.960 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.8841731548309326
Epoch: 28, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.427 Vali Acc: 0.957 Test Loss: 0.427 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.297231197357178
Epoch: 29, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.530 Vali Acc: 0.958 Test Loss: 0.530 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.324353933334351
Epoch: 30, Steps: 89 | Train Loss: 0.145 Vali Loss: 3.400 Vali Acc: 0.714 Test Loss: 3.400 Test Acc: 0.714
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 542996
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.915002107620239
Epoch: 1, Steps: 89 | Train Loss: 1.358 Vali Loss: 0.589 Vali Acc: 0.817 Test Loss: 0.589 Test Acc: 0.817
Validation loss decreased (inf --> -0.816846).  Saving model ...
Epoch: 2 cost time: 4.717281341552734
Epoch: 2, Steps: 89 | Train Loss: 0.386 Vali Loss: 0.306 Vali Acc: 0.898 Test Loss: 0.306 Test Acc: 0.898
Validation loss decreased (-0.816846 --> -0.898326).  Saving model ...
Epoch: 3 cost time: 5.9432172775268555
Epoch: 3, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
Validation loss decreased (-0.898326 --> -0.928271).  Saving model ...
Epoch: 4 cost time: 5.768303871154785
Epoch: 4, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
Validation loss decreased (-0.928271 --> -0.956823).  Saving model ...
Epoch: 5 cost time: 6.209914445877075
Epoch: 5, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.361 Vali Acc: 0.909 Test Loss: 0.361 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.809043645858765
Epoch: 6, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.364 Vali Acc: 0.919 Test Loss: 0.364 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.896363735198975
Epoch: 7, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.288 Vali Acc: 0.947 Test Loss: 0.288 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.901806354522705
Epoch: 8, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.289 Vali Acc: 0.943 Test Loss: 0.289 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.975668430328369
Epoch: 9, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.524606466293335
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.230 Vali Acc: 0.964 Test Loss: 0.230 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.963786).  Saving model ...
Epoch: 11 cost time: 5.446436166763306
Epoch: 11, Steps: 89 | Train Loss: 0.108 Vali Loss: 1.215 Vali Acc: 0.811 Test Loss: 1.215 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.319685220718384
Epoch: 12, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.426 Vali Acc: 0.940 Test Loss: 0.426 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.751421213150024
Epoch: 13, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.325 Vali Acc: 0.933 Test Loss: 0.325 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.776335000991821
Epoch: 14, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.843 Vali Acc: 0.859 Test Loss: 0.843 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.977148532867432
Epoch: 15, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.445 Vali Acc: 0.923 Test Loss: 0.445 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.673482894897461
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.250 Vali Acc: 0.967 Test Loss: 0.250 Test Acc: 0.967
Validation loss decreased (-0.963786 --> -0.967268).  Saving model ...
Epoch: 17 cost time: 6.248018503189087
Epoch: 17, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.574 Vali Acc: 0.935 Test Loss: 0.574 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.5169878005981445
Epoch: 18, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.256 Vali Acc: 0.963 Test Loss: 0.256 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.190625190734863
Epoch: 19, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.653 Vali Acc: 0.934 Test Loss: 0.653 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.956680536270142
Epoch: 20, Steps: 89 | Train Loss: 0.109 Vali Loss: 1.116 Vali Acc: 0.872 Test Loss: 1.116 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.1808860301971436
Epoch: 21, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.356 Vali Acc: 0.956 Test Loss: 0.356 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.536953449249268
Epoch: 22, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.818 Vali Acc: 0.892 Test Loss: 0.818 Test Acc: 0.892
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.445087194442749
Epoch: 23, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.265 Vali Acc: 0.958 Test Loss: 0.265 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.674550533294678
Epoch: 24, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.381 Vali Acc: 0.957 Test Loss: 0.381 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.6606080532073975
Epoch: 25, Steps: 89 | Train Loss: 0.186 Vali Loss: 1.332 Vali Acc: 0.829 Test Loss: 1.332 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.760086536407471
Epoch: 26, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.209 Vali Acc: 0.973 Test Loss: 0.209 Test Acc: 0.973
Validation loss decreased (-0.967268 --> -0.972839).  Saving model ...
Epoch: 27 cost time: 7.697067737579346
Epoch: 27, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.440 Vali Acc: 0.956 Test Loss: 0.440 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 8.1145339012146
Epoch: 28, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.444 Vali Acc: 0.930 Test Loss: 0.444 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 8.00139832496643
Epoch: 29, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.273 Vali Acc: 0.969 Test Loss: 0.273 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 9.208977460861206
Epoch: 30, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.532 Vali Acc: 0.928 Test Loss: 0.532 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 8.92469072341919
Epoch: 31, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.558 Vali Acc: 0.941 Test Loss: 0.558 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 8.563212633132935
Epoch: 32, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.344 Vali Acc: 0.957 Test Loss: 0.344 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 8.13843297958374
Epoch: 33, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.490 Vali Acc: 0.944 Test Loss: 0.490 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 7.857131481170654
Epoch: 34, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.556 Vali Acc: 0.942 Test Loss: 0.556 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 6.714193820953369
Epoch: 35, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.726 Vali Acc: 0.933 Test Loss: 0.726 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.656932353973389
Epoch: 36, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.312 Vali Acc: 0.963 Test Loss: 0.312 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 466708
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.156328439712524
Epoch: 1, Steps: 89 | Train Loss: 1.521 Vali Loss: 0.538 Vali Acc: 0.842 Test Loss: 0.538 Test Acc: 0.842
Validation loss decreased (inf --> -0.841917).  Saving model ...
Epoch: 2 cost time: 3.106309413909912
Epoch: 2, Steps: 89 | Train Loss: 0.398 Vali Loss: 0.280 Vali Acc: 0.919 Test Loss: 0.280 Test Acc: 0.919
Validation loss decreased (-0.841917 --> -0.918521).  Saving model ...
Epoch: 3 cost time: 3.3555026054382324
Epoch: 3, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.251 Vali Acc: 0.924 Test Loss: 0.251 Test Acc: 0.924
Validation loss decreased (-0.918521 --> -0.924092).  Saving model ...
Epoch: 4 cost time: 3.4524428844451904
Epoch: 4, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.218 Vali Acc: 0.939 Test Loss: 0.218 Test Acc: 0.939
Validation loss decreased (-0.924092 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 3.430511951446533
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
Validation loss decreased (-0.939413 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 3.3680498600006104
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.223 Vali Acc: 0.936 Test Loss: 0.223 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3148488998413086
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.233 Vali Acc: 0.949 Test Loss: 0.233 Test Acc: 0.949
Validation loss decreased (-0.942895 --> -0.949162).  Saving model ...
Epoch: 8 cost time: 3.380925416946411
Epoch: 8, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949162 --> -0.949858).  Saving model ...
Epoch: 9 cost time: 3.403592824935913
Epoch: 9, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.431 Vali Acc: 0.910 Test Loss: 0.431 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.402867317199707
Epoch: 10, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.259 Vali Acc: 0.939 Test Loss: 0.259 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3663570880889893
Epoch: 11, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.296421527862549
Epoch: 12, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
Validation loss decreased (-0.949858 --> -0.964483).  Saving model ...
Epoch: 13 cost time: 3.2128047943115234
Epoch: 13, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.964483 --> -0.972143).  Saving model ...
Epoch: 14 cost time: 3.309569835662842
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.548 Vali Acc: 0.905 Test Loss: 0.548 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3591668605804443
Epoch: 15, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.536 Vali Acc: 0.905 Test Loss: 0.536 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2804114818573
Epoch: 16, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.233 Vali Acc: 0.964 Test Loss: 0.233 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3956375122070312
Epoch: 17, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.253 Vali Acc: 0.953 Test Loss: 0.253 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.4400064945220947
Epoch: 18, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.591 Vali Acc: 0.884 Test Loss: 0.591 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.368124008178711
Epoch: 19, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.284 Vali Acc: 0.952 Test Loss: 0.284 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.223755359649658
Epoch: 20, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.195702314376831
Epoch: 21, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.459 Vali Acc: 0.914 Test Loss: 0.459 Test Acc: 0.914
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.614997148513794
Epoch: 22, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.254 Vali Acc: 0.959 Test Loss: 0.254 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.648390769958496
Epoch: 23, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.476 Vali Acc: 0.912 Test Loss: 0.476 Test Acc: 0.912
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 405908
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.092269659042358
Epoch: 1, Steps: 89 | Train Loss: 1.695 Vali Loss: 0.663 Vali Acc: 0.785 Test Loss: 0.663 Test Acc: 0.785
Validation loss decreased (inf --> -0.784812).  Saving model ...
Epoch: 2 cost time: 3.3242852687835693
Epoch: 2, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
Validation loss decreased (-0.784812 --> -0.925485).  Saving model ...
Epoch: 3 cost time: 3.6257574558258057
Epoch: 3, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
Validation loss decreased (-0.925485 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 3.420779228210449
Epoch: 4, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.302 Vali Acc: 0.905 Test Loss: 0.302 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.407151699066162
Epoch: 5, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
Validation loss decreased (-0.942895 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 3.4685537815093994
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.959609 --> -0.968662).  Saving model ...
Epoch: 7 cost time: 3.3566205501556396
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.543872594833374
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.154 Vali Acc: 0.955 Test Loss: 0.154 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.326425790786743
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 3.7381906509399414
Epoch: 10, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.145 Vali Acc: 0.956 Test Loss: 0.145 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3488574028015137
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4366514682769775
Epoch: 12, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3260657787323
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 14 cost time: 3.3652126789093018
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.293 Vali Acc: 0.937 Test Loss: 0.293 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.635324239730835
Epoch: 15, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.184286117553711
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.378225326538086
Epoch: 17, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.396 Vali Acc: 0.920 Test Loss: 0.396 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.4222259521484375
Epoch: 18, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2603542804718018
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.155 Vali Acc: 0.974 Test Loss: 0.155 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.974232).  Saving model ...
Epoch: 20 cost time: 3.3744800090789795
Epoch: 20, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.195 Vali Acc: 0.969 Test Loss: 0.195 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3771779537200928
Epoch: 21, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.501662254333496
Epoch: 22, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.4262242317199707
Epoch: 23, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.4050230979919434
Epoch: 24, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.776 Vali Acc: 0.896 Test Loss: 0.776 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.4902939796447754
Epoch: 25, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.464 Vali Acc: 0.937 Test Loss: 0.464 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.3998024463653564
Epoch: 26, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.221 Vali Acc: 0.965 Test Loss: 0.221 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.3578412532806396
Epoch: 27, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.266 Vali Acc: 0.964 Test Loss: 0.266 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.480207681655884
Epoch: 28, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.346 Vali Acc: 0.932 Test Loss: 0.346 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.4176571369171143
Epoch: 29, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.216 Vali Acc: 0.972 Test Loss: 0.216 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 368660
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.808382511138916
Epoch: 1, Steps: 89 | Train Loss: 1.809 Vali Loss: 0.698 Vali Acc: 0.804 Test Loss: 0.698 Test Acc: 0.804
Validation loss decreased (inf --> -0.804311).  Saving model ...
Epoch: 2 cost time: 3.5062942504882812
Epoch: 2, Steps: 89 | Train Loss: 0.492 Vali Loss: 0.292 Vali Acc: 0.924 Test Loss: 0.292 Test Acc: 0.924
Validation loss decreased (-0.804311 --> -0.924092).  Saving model ...
Epoch: 3 cost time: 3.6605303287506104
Epoch: 3, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.180 Vali Acc: 0.955 Test Loss: 0.180 Test Acc: 0.955
Validation loss decreased (-0.924092 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 3.4896655082702637
Epoch: 4, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.241 Vali Acc: 0.927 Test Loss: 0.241 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5823581218719482
Epoch: 5, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.954734 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 3.6948494911193848
Epoch: 6, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 3.694038152694702
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.282754421234131
Epoch: 8, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.963787 --> -0.970055).  Saving model ...
Epoch: 9 cost time: 3.5788214206695557
Epoch: 9, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.624234199523926
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.973537).  Saving model ...
Epoch: 11 cost time: 3.5524580478668213
Epoch: 11, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5859615802764893
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.438079833984375
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.6805362701416016
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.220 Vali Acc: 0.942 Test Loss: 0.220 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.54377818107605
Epoch: 15, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.237079620361328
Epoch: 16, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.276129961013794
Epoch: 17, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.154 Vali Acc: 0.966 Test Loss: 0.154 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.5559637546539307
Epoch: 18, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.463550329208374
Epoch: 19, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.194 Vali Acc: 0.969 Test Loss: 0.194 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.6186695098876953
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.161 Vali Acc: 0.974 Test Loss: 0.161 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974232).  Saving model ...
Epoch: 21 cost time: 3.663827896118164
Epoch: 21, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.567854166030884
Epoch: 22, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.4764976501464844
Epoch: 23, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.746504783630371
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.320 Vali Acc: 0.946 Test Loss: 0.320 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.6063220500946045
Epoch: 25, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.6756486892700195
Epoch: 26, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.265 Vali Acc: 0.956 Test Loss: 0.265 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.47420334815979
Epoch: 27, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.3708741664886475
Epoch: 28, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.145 Vali Acc: 0.979 Test Loss: 0.145 Test Acc: 0.979
Validation loss decreased (-0.974232 --> -0.979107).  Saving model ...
Epoch: 29 cost time: 3.5162739753723145
Epoch: 29, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.507469415664673
Epoch: 30, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.236 Vali Acc: 0.955 Test Loss: 0.236 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.1597390174865723
Epoch: 31, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.188 Vali Acc: 0.968 Test Loss: 0.188 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.370626926422119
Epoch: 32, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.222 Vali Acc: 0.965 Test Loss: 0.222 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.4228360652923584
Epoch: 33, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.190 Vali Acc: 0.964 Test Loss: 0.190 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.647185802459717
Epoch: 34, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.380 Vali Acc: 0.942 Test Loss: 0.380 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.455291509628296
Epoch: 35, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.215 Vali Acc: 0.960 Test Loss: 0.215 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.316373109817505
Epoch: 36, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.214 Vali Acc: 0.961 Test Loss: 0.214 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.3521602153778076
Epoch: 37, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.223 Vali Acc: 0.967 Test Loss: 0.223 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.3502581119537354
Epoch: 38, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.241 Vali Acc: 0.965 Test Loss: 0.241 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 339092
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.94330358505249
Epoch: 1, Steps: 89 | Train Loss: 1.833 Vali Loss: 0.702 Vali Acc: 0.844 Test Loss: 0.702 Test Acc: 0.844
Validation loss decreased (inf --> -0.844004).  Saving model ...
Epoch: 2 cost time: 3.326110601425171
Epoch: 2, Steps: 89 | Train Loss: 0.517 Vali Loss: 0.352 Vali Acc: 0.899 Test Loss: 0.352 Test Acc: 0.899
Validation loss decreased (-0.844004 --> -0.899022).  Saving model ...
Epoch: 3 cost time: 3.1984200477600098
Epoch: 3, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
Validation loss decreased (-0.899022 --> -0.932449).  Saving model ...
Epoch: 4 cost time: 3.2363250255584717
Epoch: 4, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
Validation loss decreased (-0.932449 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 3.024709939956665
Epoch: 5, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.951948 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 3.0248796939849854
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1435840129852295
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0255649089813232
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3415966033935547
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.00520920753479
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0945181846618652
Epoch: 11, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.219 Vali Acc: 0.929 Test Loss: 0.219 Test Acc: 0.929
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.207007884979248
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 3.316354513168335
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.043194532394409
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1287593841552734
Epoch: 15, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 16 cost time: 3.3268277645111084
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1664907932281494
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.185 Vali Acc: 0.955 Test Loss: 0.185 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.319713830947876
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 19 cost time: 3.307215929031372
Epoch: 19, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2916131019592285
Epoch: 20, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2641735076904297
Epoch: 21, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.285 Vali Acc: 0.939 Test Loss: 0.285 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.117701292037964
Epoch: 22, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.239 Vali Acc: 0.946 Test Loss: 0.239 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.2399957180023193
Epoch: 23, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2372851371765137
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.355067014694214
Epoch: 25, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.5650813579559326
Epoch: 26, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.270589590072632
Epoch: 27, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.418 Vali Acc: 0.913 Test Loss: 0.418 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.542377471923828
Epoch: 28, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.257 Vali Acc: 0.947 Test Loss: 0.257 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 324884
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.863474130630493
Epoch: 1, Steps: 89 | Train Loss: 1.186 Vali Loss: 0.664 Vali Acc: 0.820 Test Loss: 0.664 Test Acc: 0.820
Validation loss decreased (inf --> -0.819631).  Saving model ...
Epoch: 2 cost time: 9.787407159805298
Epoch: 2, Steps: 89 | Train Loss: 0.432 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
Validation loss decreased (-0.819631 --> -0.855844).  Saving model ...
Epoch: 3 cost time: 9.836673498153687
Epoch: 3, Steps: 89 | Train Loss: 0.330 Vali Loss: 0.402 Vali Acc: 0.909 Test Loss: 0.402 Test Acc: 0.909
Validation loss decreased (-0.855844 --> -0.908770).  Saving model ...
Epoch: 4 cost time: 10.941096067428589
Epoch: 4, Steps: 89 | Train Loss: 0.329 Vali Loss: 0.585 Vali Acc: 0.891 Test Loss: 0.585 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.531729698181152
Epoch: 5, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.382 Vali Acc: 0.935 Test Loss: 0.382 Test Acc: 0.935
Validation loss decreased (-0.908770 --> -0.934537).  Saving model ...
Epoch: 6 cost time: 9.892640590667725
Epoch: 6, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.392 Vali Acc: 0.930 Test Loss: 0.392 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.298876523971558
Epoch: 7, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.508 Vali Acc: 0.918 Test Loss: 0.508 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.037336826324463
Epoch: 8, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
Validation loss decreased (-0.934537 --> -0.958215).  Saving model ...
Epoch: 9 cost time: 9.684431791305542
Epoch: 9, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.513 Vali Acc: 0.935 Test Loss: 0.513 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.614152193069458
Epoch: 10, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.432 Vali Acc: 0.934 Test Loss: 0.432 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.714539527893066
Epoch: 11, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.465 Vali Acc: 0.955 Test Loss: 0.465 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.988350868225098
Epoch: 12, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.297 Vali Acc: 0.953 Test Loss: 0.297 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.430667638778687
Epoch: 13, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.406 Vali Acc: 0.944 Test Loss: 0.406 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.616754055023193
Epoch: 14, Steps: 89 | Train Loss: 0.127 Vali Loss: 1.504 Vali Acc: 0.903 Test Loss: 1.504 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.884501695632935
Epoch: 15, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.317 Vali Acc: 0.966 Test Loss: 0.317 Test Acc: 0.966
Validation loss decreased (-0.958215 --> -0.965874).  Saving model ...
Epoch: 16 cost time: 9.262498617172241
Epoch: 16, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.660 Vali Acc: 0.931 Test Loss: 0.660 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.224387168884277
Epoch: 17, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.706 Vali Acc: 0.955 Test Loss: 0.706 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.48931360244751
Epoch: 18, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.607 Vali Acc: 0.946 Test Loss: 0.607 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.50841236114502
Epoch: 19, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.529 Vali Acc: 0.932 Test Loss: 0.529 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.805461883544922
Epoch: 20, Steps: 89 | Train Loss: 0.184 Vali Loss: 1.281 Vali Acc: 0.889 Test Loss: 1.281 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.395653486251831
Epoch: 21, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.681 Vali Acc: 0.944 Test Loss: 0.681 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.285787105560303
Epoch: 22, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.526 Vali Acc: 0.946 Test Loss: 0.526 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.02957797050476
Epoch: 23, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.733 Vali Acc: 0.937 Test Loss: 0.733 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.286868572235107
Epoch: 24, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.553 Vali Acc: 0.959 Test Loss: 0.553 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.977835655212402
Epoch: 25, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.586 Vali Acc: 0.954 Test Loss: 0.586 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 668564
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.464065313339233
Epoch: 1, Steps: 89 | Train Loss: 1.259 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
Validation loss decreased (inf --> -0.878129).  Saving model ...
Epoch: 2 cost time: 7.464285373687744
Epoch: 2, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.314 Vali Acc: 0.912 Test Loss: 0.314 Test Acc: 0.912
Validation loss decreased (-0.878129 --> -0.912253).  Saving model ...
Epoch: 3 cost time: 6.913087606430054
Epoch: 3, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.265 Vali Acc: 0.932 Test Loss: 0.265 Test Acc: 0.932
Validation loss decreased (-0.912253 --> -0.931752).  Saving model ...
Epoch: 4 cost time: 5.403525352478027
Epoch: 4, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.563 Vali Acc: 0.893 Test Loss: 0.563 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.343802452087402
Epoch: 5, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.338 Vali Acc: 0.934 Test Loss: 0.338 Test Acc: 0.934
Validation loss decreased (-0.931752 --> -0.933841).  Saving model ...
Epoch: 6 cost time: 5.84345555305481
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.302 Vali Acc: 0.935 Test Loss: 0.302 Test Acc: 0.935
Validation loss decreased (-0.933841 --> -0.935234).  Saving model ...
Epoch: 7 cost time: 5.876498460769653
Epoch: 7, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.778 Vali Acc: 0.893 Test Loss: 0.778 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.696256875991821
Epoch: 8, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.935234 --> -0.958215).  Saving model ...
Epoch: 9 cost time: 8.672189235687256
Epoch: 9, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.304 Vali Acc: 0.953 Test Loss: 0.304 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.59527587890625
Epoch: 10, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.109522819519043
Epoch: 11, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.187 Vali Acc: 0.971 Test Loss: 0.187 Test Acc: 0.971
Validation loss decreased (-0.958215 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 9.588404655456543
Epoch: 12, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.389 Vali Acc: 0.942 Test Loss: 0.389 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.778600454330444
Epoch: 13, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.264 Vali Acc: 0.952 Test Loss: 0.264 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.979628086090088
Epoch: 14, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.218 Vali Acc: 0.965 Test Loss: 0.218 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.610218048095703
Epoch: 15, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.476 Vali Acc: 0.935 Test Loss: 0.476 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.012975454330444
Epoch: 16, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.568 Vali Acc: 0.907 Test Loss: 0.568 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.257116556167603
Epoch: 17, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.350 Vali Acc: 0.964 Test Loss: 0.350 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.017045259475708
Epoch: 18, Steps: 89 | Train Loss: 0.135 Vali Loss: 1.328 Vali Acc: 0.877 Test Loss: 1.328 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.390486478805542
Epoch: 19, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.460 Vali Acc: 0.955 Test Loss: 0.460 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.48000979423523
Epoch: 20, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.287 Vali Acc: 0.967 Test Loss: 0.287 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.513242483139038
Epoch: 21, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 477204
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.40348505973816
Epoch: 1, Steps: 89 | Train Loss: 1.372 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
Validation loss decreased (inf --> -0.846791).  Saving model ...
Epoch: 2 cost time: 9.018578290939331
Epoch: 2, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.319 Vali Acc: 0.902 Test Loss: 0.319 Test Acc: 0.902
Validation loss decreased (-0.846791 --> -0.901807).  Saving model ...
Epoch: 3 cost time: 9.609238147735596
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.901807 --> -0.936627).  Saving model ...
Epoch: 4 cost time: 9.704375982284546
Epoch: 4, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.566874742507935
Epoch: 5, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.200 Vali Acc: 0.955 Test Loss: 0.200 Test Acc: 0.955
Validation loss decreased (-0.936627 --> -0.954733).  Saving model ...
Epoch: 6 cost time: 9.731280326843262
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.321 Vali Acc: 0.915 Test Loss: 0.321 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.872600317001343
Epoch: 7, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.408 Vali Acc: 0.897 Test Loss: 0.408 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.861958026885986
Epoch: 8, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.265 Vali Acc: 0.945 Test Loss: 0.265 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.846424102783203
Epoch: 9, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.255 Vali Acc: 0.942 Test Loss: 0.255 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.583734035491943
Epoch: 10, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.382490396499634
Epoch: 11, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.283 Vali Acc: 0.945 Test Loss: 0.283 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.940515279769897
Epoch: 12, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.264 Vali Acc: 0.946 Test Loss: 0.264 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.397778272628784
Epoch: 13, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.265 Vali Acc: 0.952 Test Loss: 0.265 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.617287874221802
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.211 Vali Acc: 0.960 Test Loss: 0.211 Test Acc: 0.960
Validation loss decreased (-0.954733 --> -0.960304).  Saving model ...
Epoch: 15 cost time: 10.101095199584961
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
Validation loss decreased (-0.960304 --> -0.963090).  Saving model ...
Epoch: 16 cost time: 8.002980947494507
Epoch: 16, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.279 Vali Acc: 0.958 Test Loss: 0.279 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.61641812324524
Epoch: 17, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.503 Vali Acc: 0.893 Test Loss: 0.503 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.108553171157837
Epoch: 18, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.402 Vali Acc: 0.942 Test Loss: 0.402 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.281650304794312
Epoch: 19, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.435 Vali Acc: 0.947 Test Loss: 0.435 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.286428451538086
Epoch: 20, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.293 Vali Acc: 0.955 Test Loss: 0.293 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.843867063522339
Epoch: 21, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.391 Vali Acc: 0.932 Test Loss: 0.391 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.492254495620728
Epoch: 22, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.405 Vali Acc: 0.953 Test Loss: 0.405 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.00257921218872
Epoch: 23, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.395 Vali Acc: 0.958 Test Loss: 0.395 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.644778490066528
Epoch: 24, Steps: 89 | Train Loss: 0.140 Vali Loss: 1.302 Vali Acc: 0.850 Test Loss: 1.302 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.346387386322021
Epoch: 25, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.795 Vali Acc: 0.917 Test Loss: 0.795 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 400916
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.273980617523193
Epoch: 1, Steps: 89 | Train Loss: 1.546 Vali Loss: 0.600 Vali Acc: 0.830 Test Loss: 0.600 Test Acc: 0.830
Validation loss decreased (inf --> -0.830078).  Saving model ...
Epoch: 2 cost time: 4.160618305206299
Epoch: 2, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.830078 --> -0.936627).  Saving model ...
Epoch: 3 cost time: 4.616403818130493
Epoch: 3, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
Validation loss decreased (-0.936627 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 4.301062822341919
Epoch: 4, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.063078880310059
Epoch: 5, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.941502 --> -0.944288).  Saving model ...
Epoch: 6 cost time: 3.8068270683288574
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
Validation loss decreased (-0.944288 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 4.37756609916687
Epoch: 7, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
Validation loss decreased (-0.956823 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 4.163466691970825
Epoch: 8, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.786778926849365
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.332631587982178
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.346 Vali Acc: 0.912 Test Loss: 0.346 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.163268804550171
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.197 Vali Acc: 0.954 Test Loss: 0.197 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.818850994110107
Epoch: 12, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.254620552062988
Epoch: 13, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.265 Vali Acc: 0.948 Test Loss: 0.265 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.452489852905273
Epoch: 14, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.441 Vali Acc: 0.907 Test Loss: 0.441 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.994983196258545
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.008498191833496
Epoch: 16, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.410157918930054
Epoch: 17, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.204 Vali Acc: 0.962 Test Loss: 0.204 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 340116
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.733880043029785
Epoch: 1, Steps: 89 | Train Loss: 1.604 Vali Loss: 0.608 Vali Acc: 0.836 Test Loss: 0.608 Test Acc: 0.836
Validation loss decreased (inf --> -0.836345).  Saving model ...
Epoch: 2 cost time: 4.229766845703125
Epoch: 2, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.255 Vali Acc: 0.932 Test Loss: 0.255 Test Acc: 0.932
Validation loss decreased (-0.836345 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 4.435752868652344
Epoch: 3, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.247 Vali Acc: 0.924 Test Loss: 0.247 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.372580528259277
Epoch: 4, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
Validation loss decreased (-0.931752 --> -0.964483).  Saving model ...
Epoch: 5 cost time: 4.267005443572998
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7650809288024902
Epoch: 6, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.286791086196899
Epoch: 7, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.283789396286011
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.314 Vali Acc: 0.929 Test Loss: 0.314 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.3699631690979
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.964483 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 4.304449558258057
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.962319850921631
Epoch: 11, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7406399250030518
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4347636699676514
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.350 Vali Acc: 0.942 Test Loss: 0.350 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.773169994354248
Epoch: 14, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.8495609760284424
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.058561325073242
Epoch: 16, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.9884963035583496
Epoch: 17, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.964656352996826
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.161 Vali Acc: 0.969 Test Loss: 0.161 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.782332181930542
Epoch: 19, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.236 Vali Acc: 0.953 Test Loss: 0.236 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 302868
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.51158881187439
Epoch: 1, Steps: 89 | Train Loss: 1.785 Vali Loss: 0.680 Vali Acc: 0.810 Test Loss: 0.680 Test Acc: 0.810
Validation loss decreased (inf --> -0.809882).  Saving model ...
Epoch: 2 cost time: 3.795217275619507
Epoch: 2, Steps: 89 | Train Loss: 0.492 Vali Loss: 0.316 Vali Acc: 0.910 Test Loss: 0.316 Test Acc: 0.910
Validation loss decreased (-0.809882 --> -0.910164).  Saving model ...
Epoch: 3 cost time: 4.114825010299683
Epoch: 3, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.192 Vali Acc: 0.955 Test Loss: 0.192 Test Acc: 0.955
Validation loss decreased (-0.910164 --> -0.954733).  Saving model ...
Epoch: 4 cost time: 3.9288277626037598
Epoch: 4, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.954733 --> -0.964483).  Saving model ...
Epoch: 5 cost time: 4.0637946128845215
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.150 Vali Acc: 0.947 Test Loss: 0.150 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.945906639099121
Epoch: 6, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.132 Vali Acc: 0.960 Test Loss: 0.132 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.144460201263428
Epoch: 7, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.964483 --> -0.973536).  Saving model ...
Epoch: 8 cost time: 3.8015859127044678
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.990856170654297
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.973536 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 4.095527172088623
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.067052364349365
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.1219000816345215
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.8546249866485596
Epoch: 13, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.087606430053711
Epoch: 14, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.069747447967529
Epoch: 15, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.176681041717529
Epoch: 16, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.046154975891113
Epoch: 17, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.042346954345703
Epoch: 18, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.05191707611084
Epoch: 19, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.212 Vali Acc: 0.947 Test Loss: 0.212 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 273300
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.4701313972473145
Epoch: 1, Steps: 89 | Train Loss: 1.910 Vali Loss: 0.770 Vali Acc: 0.814 Test Loss: 0.770 Test Acc: 0.814
Validation loss decreased (inf --> -0.814059).  Saving model ...
Epoch: 2 cost time: 3.935046911239624
Epoch: 2, Steps: 89 | Train Loss: 0.550 Vali Loss: 0.407 Vali Acc: 0.885 Test Loss: 0.407 Test Acc: 0.885
Validation loss decreased (-0.814059 --> -0.885093).  Saving model ...
Epoch: 3 cost time: 3.7508432865142822
Epoch: 3, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.254 Vali Acc: 0.923 Test Loss: 0.254 Test Acc: 0.923
Validation loss decreased (-0.885093 --> -0.923396).  Saving model ...
Epoch: 4 cost time: 3.6466567516326904
Epoch: 4, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.923396 --> -0.958216).  Saving model ...
Epoch: 5 cost time: 3.798929452896118
Epoch: 5, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.958216 --> -0.970055).  Saving model ...
Epoch: 6 cost time: 4.0917885303497314
Epoch: 6, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.210577964782715
Epoch: 7, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.147 Vali Acc: 0.955 Test Loss: 0.147 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.157456636428833
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.143894910812378
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 4.420032262802124
Epoch: 10, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6790268421173096
Epoch: 11, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.392220973968506
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.970751 --> -0.977715).  Saving model ...
Epoch: 13 cost time: 3.6395788192749023
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6040048599243164
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.85947585105896
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7910428047180176
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8513529300689697
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 3.686922311782837
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.453 Vali Acc: 0.886 Test Loss: 0.453 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.643575429916382
Epoch: 19, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8086698055267334
Epoch: 20, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.225 Vali Acc: 0.947 Test Loss: 0.225 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.8276174068450928
Epoch: 21, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.9636101722717285
Epoch: 22, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.182 Vali Acc: 0.961 Test Loss: 0.182 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.815600633621216
Epoch: 23, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.754340171813965
Epoch: 24, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.871819019317627
Epoch: 25, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.8190553188323975
Epoch: 26, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.4082109928131104
Epoch: 27, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 259092
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.597606658935547
Epoch: 1, Steps: 89 | Train Loss: 1.204 Vali Loss: 0.440 Vali Acc: 0.864 Test Loss: 0.440 Test Acc: 0.864
Validation loss decreased (inf --> -0.864202).  Saving model ...
Epoch: 2 cost time: 7.45776891708374
Epoch: 2, Steps: 89 | Train Loss: 0.379 Vali Loss: 1.084 Vali Acc: 0.749 Test Loss: 1.084 Test Acc: 0.749
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.695379257202148
Epoch: 3, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.439 Vali Acc: 0.910 Test Loss: 0.439 Test Acc: 0.910
Validation loss decreased (-0.864202 --> -0.910163).  Saving model ...
Epoch: 4 cost time: 6.754624366760254
Epoch: 4, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.391 Vali Acc: 0.923 Test Loss: 0.391 Test Acc: 0.923
Validation loss decreased (-0.910163 --> -0.923394).  Saving model ...
Epoch: 5 cost time: 6.536576509475708
Epoch: 5, Steps: 89 | Train Loss: 0.352 Vali Loss: 1.451 Vali Acc: 0.846 Test Loss: 1.451 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.89505410194397
Epoch: 6, Steps: 89 | Train Loss: 0.240 Vali Loss: 1.222 Vali Acc: 0.850 Test Loss: 1.222 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.1159751415252686
Epoch: 7, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.287 Vali Acc: 0.953 Test Loss: 0.287 Test Acc: 0.953
Validation loss decreased (-0.923394 --> -0.952643).  Saving model ...
Epoch: 8 cost time: 6.08116888999939
Epoch: 8, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.567 Vali Acc: 0.901 Test Loss: 0.567 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.140393018722534
Epoch: 9, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.747 Vali Acc: 0.907 Test Loss: 0.747 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.192085981369019
Epoch: 10, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.837 Vali Acc: 0.865 Test Loss: 0.837 Test Acc: 0.865
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.94664454460144
Epoch: 11, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.694 Vali Acc: 0.921 Test Loss: 0.694 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.837523460388184
Epoch: 12, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.599 Vali Acc: 0.930 Test Loss: 0.599 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.352465867996216
Epoch: 13, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.711 Vali Acc: 0.897 Test Loss: 0.711 Test Acc: 0.897
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.44424843788147
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.318 Vali Acc: 0.957 Test Loss: 0.318 Test Acc: 0.957
Validation loss decreased (-0.952643 --> -0.956821).  Saving model ...
Epoch: 15 cost time: 7.9635937213897705
Epoch: 15, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.695 Vali Acc: 0.932 Test Loss: 0.695 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.423930883407593
Epoch: 16, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.608 Vali Acc: 0.954 Test Loss: 0.608 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.35399580001831
Epoch: 17, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.598 Vali Acc: 0.948 Test Loss: 0.598 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.295196056365967
Epoch: 18, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.477 Vali Acc: 0.954 Test Loss: 0.477 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.430432081222534
Epoch: 19, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.914 Vali Acc: 0.942 Test Loss: 0.914 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.03288984298706
Epoch: 20, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.912 Vali Acc: 0.942 Test Loss: 0.912 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.509040355682373
Epoch: 21, Steps: 89 | Train Loss: 0.226 Vali Loss: 1.594 Vali Acc: 0.865 Test Loss: 1.594 Test Acc: 0.865
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.000646829605103
Epoch: 22, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.504 Vali Acc: 0.952 Test Loss: 0.504 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.91550087928772
Epoch: 23, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.516 Vali Acc: 0.963 Test Loss: 0.516 Test Acc: 0.963
Validation loss decreased (-0.956821 --> -0.963087).  Saving model ...
Epoch: 24 cost time: 8.671032667160034
Epoch: 24, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.739 Vali Acc: 0.938 Test Loss: 0.739 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.504032373428345
Epoch: 25, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.541 Vali Acc: 0.961 Test Loss: 0.541 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 8.617828845977783
Epoch: 26, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.681 Vali Acc: 0.949 Test Loss: 0.681 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 8.415724515914917
Epoch: 27, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.591 Vali Acc: 0.961 Test Loss: 0.591 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 8.569110870361328
Epoch: 28, Steps: 89 | Train Loss: 0.089 Vali Loss: 1.913 Vali Acc: 0.891 Test Loss: 1.913 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 8.251442670822144
Epoch: 29, Steps: 89 | Train Loss: 0.216 Vali Loss: 1.193 Vali Acc: 0.928 Test Loss: 1.193 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 8.27504014968872
Epoch: 30, Steps: 89 | Train Loss: 0.175 Vali Loss: 1.232 Vali Acc: 0.904 Test Loss: 1.232 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 8.212838888168335
Epoch: 31, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.881 Vali Acc: 0.940 Test Loss: 0.881 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 8.805375814437866
Epoch: 32, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.952 Vali Acc: 0.949 Test Loss: 0.952 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 8.641530752182007
Epoch: 33, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.576 Vali Acc: 0.963 Test Loss: 0.576 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 635668
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.223397731781006
Epoch: 1, Steps: 89 | Train Loss: 1.339 Vali Loss: 0.464 Vali Acc: 0.854 Test Loss: 0.464 Test Acc: 0.854
Validation loss decreased (inf --> -0.854452).  Saving model ...
Epoch: 2 cost time: 8.398244142532349
Epoch: 2, Steps: 89 | Train Loss: 0.383 Vali Loss: 0.427 Vali Acc: 0.888 Test Loss: 0.427 Test Acc: 0.888
Validation loss decreased (-0.854452 --> -0.887879).  Saving model ...
Epoch: 3 cost time: 8.234736680984497
Epoch: 3, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.844 Vali Acc: 0.840 Test Loss: 0.844 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.450474977493286
Epoch: 4, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.341 Vali Acc: 0.915 Test Loss: 0.341 Test Acc: 0.915
Validation loss decreased (-0.887879 --> -0.915038).  Saving model ...
Epoch: 5 cost time: 6.871943473815918
Epoch: 5, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.271 Vali Acc: 0.942 Test Loss: 0.271 Test Acc: 0.942
Validation loss decreased (-0.915038 --> -0.942198).  Saving model ...
Epoch: 6 cost time: 7.197203874588013
Epoch: 6, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
Validation loss decreased (-0.942198 --> -0.945680).  Saving model ...
Epoch: 7 cost time: 7.041420221328735
Epoch: 7, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.347 Vali Acc: 0.929 Test Loss: 0.347 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.050839424133301
Epoch: 8, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.203 Vali Acc: 0.962 Test Loss: 0.203 Test Acc: 0.962
Validation loss decreased (-0.945680 --> -0.961697).  Saving model ...
Epoch: 9 cost time: 6.49962043762207
Epoch: 9, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.464 Vali Acc: 0.896 Test Loss: 0.464 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.582351922988892
Epoch: 10, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.284 Vali Acc: 0.939 Test Loss: 0.284 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.6690778732299805
Epoch: 11, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.439 Vali Acc: 0.944 Test Loss: 0.439 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.951935052871704
Epoch: 12, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.523 Vali Acc: 0.916 Test Loss: 0.523 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.009894609451294
Epoch: 13, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.612 Vali Acc: 0.890 Test Loss: 0.612 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.590927600860596
Epoch: 14, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.289 Vali Acc: 0.958 Test Loss: 0.289 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.774304151535034
Epoch: 15, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.628 Vali Acc: 0.930 Test Loss: 0.628 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.271970748901367
Epoch: 16, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.427 Vali Acc: 0.951 Test Loss: 0.427 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.994750261306763
Epoch: 17, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.504 Vali Acc: 0.948 Test Loss: 0.504 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.125631332397461
Epoch: 18, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.518 Vali Acc: 0.936 Test Loss: 0.518 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 444308
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.601271152496338
Epoch: 1, Steps: 89 | Train Loss: 1.387 Vali Loss: 0.628 Vali Acc: 0.795 Test Loss: 0.628 Test Acc: 0.795
Validation loss decreased (inf --> -0.794562).  Saving model ...
Epoch: 2 cost time: 6.501283645629883
Epoch: 2, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.305 Vali Acc: 0.914 Test Loss: 0.305 Test Acc: 0.914
Validation loss decreased (-0.794562 --> -0.913646).  Saving model ...
Epoch: 3 cost time: 6.098320960998535
Epoch: 3, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.277 Vali Acc: 0.924 Test Loss: 0.277 Test Acc: 0.924
Validation loss decreased (-0.913646 --> -0.924092).  Saving model ...
Epoch: 4 cost time: 7.044755458831787
Epoch: 4, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.291 Vali Acc: 0.928 Test Loss: 0.291 Test Acc: 0.928
Validation loss decreased (-0.924092 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 5.830225706100464
Epoch: 5, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.384557723999023
Epoch: 6, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
Validation loss decreased (-0.928270 --> -0.935234).  Saving model ...
Epoch: 7 cost time: 7.417154550552368
Epoch: 7, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
Validation loss decreased (-0.935234 --> -0.959608).  Saving model ...
Epoch: 8 cost time: 7.714466571807861
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
Validation loss decreased (-0.959608 --> -0.961697).  Saving model ...
Epoch: 9 cost time: 7.263023376464844
Epoch: 9, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.160 Vali Acc: 0.968 Test Loss: 0.160 Test Acc: 0.968
Validation loss decreased (-0.961697 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 7.105069160461426
Epoch: 10, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.528 Vali Acc: 0.891 Test Loss: 0.528 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.584540605545044
Epoch: 11, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.8322060108184814
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.322 Vali Acc: 0.930 Test Loss: 0.322 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.494983434677124
Epoch: 13, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
Validation loss decreased (-0.967965 --> -0.972143).  Saving model ...
Epoch: 14 cost time: 7.162583589553833
Epoch: 14, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.263 Vali Acc: 0.960 Test Loss: 0.263 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.924328088760376
Epoch: 15, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.342 Vali Acc: 0.948 Test Loss: 0.342 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.322751760482788
Epoch: 16, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.332 Vali Acc: 0.932 Test Loss: 0.332 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.183683633804321
Epoch: 17, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.449 Vali Acc: 0.925 Test Loss: 0.449 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.171204090118408
Epoch: 18, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.497 Vali Acc: 0.938 Test Loss: 0.497 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.8485894203186035
Epoch: 19, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.241 Vali Acc: 0.970 Test Loss: 0.241 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.363409757614136
Epoch: 20, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.231 Vali Acc: 0.969 Test Loss: 0.231 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.62364935874939
Epoch: 21, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.244 Vali Acc: 0.967 Test Loss: 0.244 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.429319620132446
Epoch: 22, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.149 Vali Acc: 0.974 Test Loss: 0.149 Test Acc: 0.974
Validation loss decreased (-0.972143 --> -0.973536).  Saving model ...
Epoch: 23 cost time: 7.115920066833496
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.240 Vali Acc: 0.967 Test Loss: 0.240 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.461257219314575
Epoch: 24, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.397 Vali Acc: 0.953 Test Loss: 0.397 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.51753044128418
Epoch: 25, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.285 Vali Acc: 0.964 Test Loss: 0.285 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.0992114543914795
Epoch: 26, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.729 Vali Acc: 0.909 Test Loss: 0.729 Test Acc: 0.909
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.983987092971802
Epoch: 27, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.400 Vali Acc: 0.945 Test Loss: 0.400 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.760176181793213
Epoch: 28, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.359 Vali Acc: 0.955 Test Loss: 0.359 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.501589059829712
Epoch: 29, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.271 Vali Acc: 0.969 Test Loss: 0.271 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.621167182922363
Epoch: 30, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.227 Vali Acc: 0.974 Test Loss: 0.227 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 7.813384056091309
Epoch: 31, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.301 Vali Acc: 0.962 Test Loss: 0.301 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 7.392457962036133
Epoch: 32, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.251 Vali Acc: 0.968 Test Loss: 0.251 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 368020
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.341747283935547
Epoch: 1, Steps: 89 | Train Loss: 1.523 Vali Loss: 0.606 Vali Acc: 0.827 Test Loss: 0.606 Test Acc: 0.827
Validation loss decreased (inf --> -0.826596).  Saving model ...
Epoch: 2 cost time: 3.9957504272460938
Epoch: 2, Steps: 89 | Train Loss: 0.418 Vali Loss: 0.277 Vali Acc: 0.914 Test Loss: 0.277 Test Acc: 0.914
Validation loss decreased (-0.826596 --> -0.914343).  Saving model ...
Epoch: 3 cost time: 3.7018496990203857
Epoch: 3, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.296 Vali Acc: 0.910 Test Loss: 0.296 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.70624041557312
Epoch: 4, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.914343 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 3.4428763389587402
Epoch: 5, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.943591 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 3.6235764026641846
Epoch: 6, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5700058937072754
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.958216 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 3.6751575469970703
Epoch: 8, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.251262664794922
Epoch: 9, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.445059299468994
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.383559465408325
Epoch: 11, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.371 Vali Acc: 0.929 Test Loss: 0.371 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.341432571411133
Epoch: 12, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.470583438873291
Epoch: 13, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.217 Vali Acc: 0.953 Test Loss: 0.217 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.4835236072540283
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.268 Vali Acc: 0.957 Test Loss: 0.268 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.432738780975342
Epoch: 15, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.187 Vali Acc: 0.974 Test Loss: 0.187 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974232).  Saving model ...
Epoch: 16 cost time: 3.5571043491363525
Epoch: 16, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.425 Vali Acc: 0.933 Test Loss: 0.425 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4549834728240967
Epoch: 17, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.277 Vali Acc: 0.951 Test Loss: 0.277 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.560016632080078
Epoch: 18, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6427273750305176
Epoch: 19, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.201 Vali Acc: 0.962 Test Loss: 0.201 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.566246747970581
Epoch: 20, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.216 Vali Acc: 0.959 Test Loss: 0.216 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.4403510093688965
Epoch: 21, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.172 Vali Acc: 0.969 Test Loss: 0.172 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.384903907775879
Epoch: 22, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.256 Vali Acc: 0.955 Test Loss: 0.256 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.4905567169189453
Epoch: 23, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.414 Vali Acc: 0.915 Test Loss: 0.414 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.4307899475097656
Epoch: 24, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.174 Vali Acc: 0.976 Test Loss: 0.174 Test Acc: 0.976
Validation loss decreased (-0.974232 --> -0.976321).  Saving model ...
Epoch: 25 cost time: 3.3512091636657715
Epoch: 25, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.207 Vali Acc: 0.977 Test Loss: 0.207 Test Acc: 0.977
Validation loss decreased (-0.976321 --> -0.977017).  Saving model ...
Epoch: 26 cost time: 3.46996808052063
Epoch: 26, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2856709957122803
Epoch: 27, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.320 Vali Acc: 0.956 Test Loss: 0.320 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.908201217651367
Epoch: 28, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.233 Vali Acc: 0.955 Test Loss: 0.233 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.672168254852295
Epoch: 29, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.234 Vali Acc: 0.962 Test Loss: 0.234 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.7542665004730225
Epoch: 30, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.475 Vali Acc: 0.961 Test Loss: 0.475 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.603294610977173
Epoch: 31, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.328 Vali Acc: 0.955 Test Loss: 0.328 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.558992862701416
Epoch: 32, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.234 Vali Acc: 0.971 Test Loss: 0.234 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.7993083000183105
Epoch: 33, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.8546142578125
Epoch: 34, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.358 Vali Acc: 0.957 Test Loss: 0.358 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.045631647109985
Epoch: 35, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.504 Vali Acc: 0.949 Test Loss: 0.504 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 307220
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.131891965866089
Epoch: 1, Steps: 89 | Train Loss: 1.710 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
Validation loss decreased (inf --> -0.821721).  Saving model ...
Epoch: 2 cost time: 3.825584888458252
Epoch: 2, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.327 Vali Acc: 0.897 Test Loss: 0.327 Test Acc: 0.897
Validation loss decreased (-0.821721 --> -0.896933).  Saving model ...
Epoch: 3 cost time: 2.5753395557403564
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.896933 --> -0.944288).  Saving model ...
Epoch: 4 cost time: 2.397463083267212
Epoch: 4, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.944288 --> -0.948466).  Saving model ...
Epoch: 5 cost time: 2.288642406463623
Epoch: 5, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.948466 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 3.4665110111236572
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5485074520111084
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 3.619886875152588
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.915574789047241
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6758456230163574
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.5571184158325195
Epoch: 11, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.906106472015381
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.140 Vali Acc: 0.966 Test Loss: 0.140 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7785441875457764
Epoch: 13, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.8583295345306396
Epoch: 14, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.8128347396850586
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.6855266094207764
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.213 Vali Acc: 0.962 Test Loss: 0.213 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.8663432598114014
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.331 Vali Acc: 0.935 Test Loss: 0.331 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 269972
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.347967147827148
Epoch: 1, Steps: 89 | Train Loss: 1.816 Vali Loss: 0.699 Vali Acc: 0.820 Test Loss: 0.699 Test Acc: 0.820
Validation loss decreased (inf --> -0.819631).  Saving model ...
Epoch: 2 cost time: 3.9740936756134033
Epoch: 2, Steps: 89 | Train Loss: 0.505 Vali Loss: 0.311 Vali Acc: 0.913 Test Loss: 0.311 Test Acc: 0.913
Validation loss decreased (-0.819631 --> -0.912950).  Saving model ...
Epoch: 3 cost time: 3.596195697784424
Epoch: 3, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
Validation loss decreased (-0.912950 --> -0.956823).  Saving model ...
Epoch: 4 cost time: 4.007588863372803
Epoch: 4, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
Validation loss decreased (-0.956823 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 3.240084648132324
Epoch: 5, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4262547492980957
Epoch: 6, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.961001 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 3.5719616413116455
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.717064619064331
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.634500741958618
Epoch: 9, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4614369869232178
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.001516342163086
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.417750597000122
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.539095401763916
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.6473653316497803
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.6492156982421875
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.223 Vali Acc: 0.947 Test Loss: 0.223 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.6901049613952637
Epoch: 16, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 240404
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.543304920196533
Epoch: 1, Steps: 89 | Train Loss: 1.901 Vali Loss: 0.790 Vali Acc: 0.796 Test Loss: 0.790 Test Acc: 0.796
Validation loss decreased (inf --> -0.795953).  Saving model ...
Epoch: 2 cost time: 1.567044973373413
Epoch: 2, Steps: 89 | Train Loss: 0.562 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
Validation loss decreased (-0.795953 --> -0.905985).  Saving model ...
Epoch: 3 cost time: 1.552067518234253
Epoch: 3, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
Validation loss decreased (-0.905985 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 1.44596529006958
Epoch: 4, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
Validation loss decreased (-0.941502 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 1.4733428955078125
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.953341 --> -0.970055).  Saving model ...
Epoch: 6 cost time: 1.4837567806243896
Epoch: 6, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.970055 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 1.6357510089874268
Epoch: 7, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4559204578399658
Epoch: 8, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5841519832611084
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6062772274017334
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 1.6241846084594727
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 1.5502688884735107
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6825783252716064
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 14 cost time: 1.5130746364593506
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5821456909179688
Epoch: 15, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 16 cost time: 1.5585453510284424
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.180 Vali Acc: 0.945 Test Loss: 0.180 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5711805820465088
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5332021713256836
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3930895328521729
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6274333000183105
Epoch: 20, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.184 Vali Acc: 0.968 Test Loss: 0.184 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.571488857269287
Epoch: 21, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.183 Vali Acc: 0.966 Test Loss: 0.183 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5554864406585693
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5992484092712402
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.175 Vali Acc: 0.968 Test Loss: 0.175 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4793426990509033
Epoch: 24, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4856724739074707
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm128_nh16_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 226196
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.731159925460815
Epoch: 1, Steps: 89 | Train Loss: 1.344 Vali Loss: 0.470 Vali Acc: 0.865 Test Loss: 0.470 Test Acc: 0.865
Validation loss decreased (inf --> -0.864898).  Saving model ...
Epoch: 2 cost time: 7.542974233627319
Epoch: 2, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
Validation loss decreased (-0.864898 --> -0.888576).  Saving model ...
Epoch: 3 cost time: 7.733067274093628
Epoch: 3, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.373 Vali Acc: 0.902 Test Loss: 0.373 Test Acc: 0.902
Validation loss decreased (-0.888576 --> -0.901807).  Saving model ...
Epoch: 4 cost time: 8.05053973197937
Epoch: 4, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.457 Vali Acc: 0.894 Test Loss: 0.457 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.034141063690186
Epoch: 5, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
Validation loss decreased (-0.901807 --> -0.937323).  Saving model ...
Epoch: 6 cost time: 8.393720149993896
Epoch: 6, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.559 Vali Acc: 0.911 Test Loss: 0.559 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.435781955718994
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.280 Vali Acc: 0.948 Test Loss: 0.280 Test Acc: 0.948
Validation loss decreased (-0.937323 --> -0.947769).  Saving model ...
Epoch: 8 cost time: 7.905645132064819
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
Validation loss decreased (-0.947769 --> -0.954037).  Saving model ...
Epoch: 9 cost time: 8.372089385986328
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.369 Vali Acc: 0.936 Test Loss: 0.369 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.09809136390686
Epoch: 10, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.388 Vali Acc: 0.930 Test Loss: 0.388 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.57028841972351
Epoch: 11, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.468 Vali Acc: 0.937 Test Loss: 0.468 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.075459480285645
Epoch: 12, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.365 Vali Acc: 0.933 Test Loss: 0.365 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.6368021965026855
Epoch: 13, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.290 Vali Acc: 0.964 Test Loss: 0.290 Test Acc: 0.964
Validation loss decreased (-0.954037 --> -0.963785).  Saving model ...
Epoch: 14 cost time: 7.548911809921265
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.401 Vali Acc: 0.949 Test Loss: 0.401 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.213432312011719
Epoch: 15, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.331 Vali Acc: 0.946 Test Loss: 0.331 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.6527886390686035
Epoch: 16, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.459 Vali Acc: 0.945 Test Loss: 0.459 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.122053623199463
Epoch: 17, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.841 Vali Acc: 0.890 Test Loss: 0.841 Test Acc: 0.890
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.757338523864746
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.446 Vali Acc: 0.951 Test Loss: 0.446 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.056590557098389
Epoch: 19, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.301 Vali Acc: 0.961 Test Loss: 0.301 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.314953088760376
Epoch: 20, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.523 Vali Acc: 0.933 Test Loss: 0.523 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.942123889923096
Epoch: 21, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.697 Vali Acc: 0.925 Test Loss: 0.697 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.361369371414185
Epoch: 22, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.367 Vali Acc: 0.963 Test Loss: 0.367 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.503542900085449
Epoch: 23, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.544 Vali Acc: 0.939 Test Loss: 0.544 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 334676
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.289197206497192
Epoch: 1, Steps: 89 | Train Loss: 1.579 Vali Loss: 0.577 Vali Acc: 0.823 Test Loss: 0.577 Test Acc: 0.823
Validation loss decreased (inf --> -0.823114).  Saving model ...
Epoch: 2 cost time: 3.4312548637390137
Epoch: 2, Steps: 89 | Train Loss: 0.437 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
Validation loss decreased (-0.823114 --> -0.874648).  Saving model ...
Epoch: 3 cost time: 3.3897454738616943
Epoch: 3, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.353 Vali Acc: 0.896 Test Loss: 0.353 Test Acc: 0.896
Validation loss decreased (-0.874648 --> -0.895540).  Saving model ...
Epoch: 4 cost time: 3.3849291801452637
Epoch: 4, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
Validation loss decreased (-0.895540 --> -0.949163).  Saving model ...
Epoch: 5 cost time: 3.4250378608703613
Epoch: 5, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.364 Vali Acc: 0.887 Test Loss: 0.364 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.572343349456787
Epoch: 6, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.398 Vali Acc: 0.891 Test Loss: 0.398 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.172776937484741
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
Validation loss decreased (-0.949163 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 3.6088643074035645
Epoch: 8, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 3.95292067527771
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7699832916259766
Epoch: 10, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9216506481170654
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.178 Vali Acc: 0.961 Test Loss: 0.178 Test Acc: 0.961
Validation loss decreased (-0.957519 --> -0.961001).  Saving model ...
Epoch: 12 cost time: 3.8787198066711426
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 4.032924175262451
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.223 Vali Acc: 0.961 Test Loss: 0.223 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.959930896759033
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.265 Vali Acc: 0.949 Test Loss: 0.265 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8695595264434814
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.306 Vali Acc: 0.943 Test Loss: 0.306 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.919584274291992
Epoch: 16, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.238 Vali Acc: 0.960 Test Loss: 0.238 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7979800701141357
Epoch: 17, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 18 cost time: 4.523622751235962
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.277 Vali Acc: 0.952 Test Loss: 0.277 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.346159934997559
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.170 Vali Acc: 0.971 Test Loss: 0.170 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.434072732925415
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.25175142288208
Epoch: 21, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.406 Vali Acc: 0.926 Test Loss: 0.406 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.490097284317017
Epoch: 22, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.195 Vali Acc: 0.969 Test Loss: 0.195 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.433391571044922
Epoch: 23, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.511 Vali Acc: 0.923 Test Loss: 0.511 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.319665908813477
Epoch: 24, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.367 Vali Acc: 0.953 Test Loss: 0.367 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.719192981719971
Epoch: 25, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.492 Vali Acc: 0.946 Test Loss: 0.492 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.295658111572266
Epoch: 26, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.391 Vali Acc: 0.953 Test Loss: 0.391 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.006140470504761
Epoch: 27, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.224 Vali Acc: 0.973 Test Loss: 0.224 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 238996
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.640687942504883
Epoch: 1, Steps: 89 | Train Loss: 1.663 Vali Loss: 0.647 Vali Acc: 0.823 Test Loss: 0.647 Test Acc: 0.823
Validation loss decreased (inf --> -0.823113).  Saving model ...
Epoch: 2 cost time: 4.252575397491455
Epoch: 2, Steps: 89 | Train Loss: 0.452 Vali Loss: 0.300 Vali Acc: 0.909 Test Loss: 0.300 Test Acc: 0.909
Validation loss decreased (-0.823113 --> -0.908771).  Saving model ...
Epoch: 3 cost time: 4.345203876495361
Epoch: 3, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
Validation loss decreased (-0.908771 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 4.090099096298218
Epoch: 4, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.941502 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 3.857004165649414
Epoch: 5, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.83120059967041
Epoch: 6, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.960305 --> -0.972144).  Saving model ...
Epoch: 7 cost time: 3.9294309616088867
Epoch: 7, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8849129676818848
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.174 Vali Acc: 0.947 Test Loss: 0.174 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6355507373809814
Epoch: 9, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.795116662979126
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.064373254776001
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.077216148376465
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.1291184425354
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.1516618728637695
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.195 Vali Acc: 0.962 Test Loss: 0.195 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.398434400558472
Epoch: 15, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.290 Vali Acc: 0.945 Test Loss: 0.290 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.016251564025879
Epoch: 16, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 200852
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.909578323364258
Epoch: 1, Steps: 89 | Train Loss: 1.832 Vali Loss: 0.710 Vali Acc: 0.814 Test Loss: 0.710 Test Acc: 0.814
Validation loss decreased (inf --> -0.814060).  Saving model ...
Epoch: 2 cost time: 4.103156805038452
Epoch: 2, Steps: 89 | Train Loss: 0.497 Vali Loss: 0.343 Vali Acc: 0.911 Test Loss: 0.343 Test Acc: 0.911
Validation loss decreased (-0.814060 --> -0.910860).  Saving model ...
Epoch: 3 cost time: 4.195799350738525
Epoch: 3, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.247 Vali Acc: 0.927 Test Loss: 0.247 Test Acc: 0.927
Validation loss decreased (-0.910860 --> -0.926878).  Saving model ...
Epoch: 4 cost time: 3.804095983505249
Epoch: 4, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
Validation loss decreased (-0.926878 --> -0.954734).  Saving model ...
Epoch: 5 cost time: 3.9327006340026855
Epoch: 5, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
Validation loss decreased (-0.954734 --> -0.963091).  Saving model ...
Epoch: 6 cost time: 4.164499759674072
Epoch: 6, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9125359058380127
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.164 Vali Acc: 0.953 Test Loss: 0.164 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.980269432067871
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
Validation loss decreased (-0.963091 --> -0.966573).  Saving model ...
Epoch: 9 cost time: 3.978841781616211
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9401931762695312
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.969358).  Saving model ...
Epoch: 11 cost time: 4.24639368057251
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.400092840194702
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.1410582065582275
Epoch: 13, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.175 Vali Acc: 0.953 Test Loss: 0.175 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8802459239959717
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.335920810699463
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 16 cost time: 4.40725040435791
Epoch: 16, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.679220199584961
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.510769605636597
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.244 Vali Acc: 0.942 Test Loss: 0.244 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.395362854003906
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.195 Vali Acc: 0.961 Test Loss: 0.195 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.571573495864868
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.4627954959869385
Epoch: 21, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.2441246509552
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.210 Vali Acc: 0.969 Test Loss: 0.210 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.866603136062622
Epoch: 23, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.971447 --> -0.977018).  Saving model ...
Epoch: 24 cost time: 4.556012392044067
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.290 Vali Acc: 0.938 Test Loss: 0.290 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.857551097869873
Epoch: 25, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.5714027881622314
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.845159530639648
Epoch: 27, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.872873544692993
Epoch: 28, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.856222152709961
Epoch: 29, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.316 Vali Acc: 0.946 Test Loss: 0.316 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.67102575302124
Epoch: 30, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.710235834121704
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.334 Vali Acc: 0.951 Test Loss: 0.334 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.307809114456177
Epoch: 32, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.146 Vali Acc: 0.974 Test Loss: 0.146 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.527954816818237
Epoch: 33, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.971 Test Loss: 0.169 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 170452
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.789010524749756
Epoch: 1, Steps: 89 | Train Loss: 2.062 Vali Loss: 0.855 Vali Acc: 0.788 Test Loss: 0.855 Test Acc: 0.788
Validation loss decreased (inf --> -0.787596).  Saving model ...
Epoch: 2 cost time: 4.020825624465942
Epoch: 2, Steps: 89 | Train Loss: 0.618 Vali Loss: 0.381 Vali Acc: 0.902 Test Loss: 0.381 Test Acc: 0.902
Validation loss decreased (-0.787596 --> -0.901807).  Saving model ...
Epoch: 3 cost time: 4.205491781234741
Epoch: 3, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.227 Vali Acc: 0.942 Test Loss: 0.227 Test Acc: 0.942
Validation loss decreased (-0.901807 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 4.453797817230225
Epoch: 4, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.941502 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 4.482300519943237
Epoch: 5, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
Validation loss decreased (-0.947770 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 4.575166702270508
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.959609 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 4.625554800033569
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.237342357635498
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.246635437011719
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 4.171741008758545
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.693275690078735
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.237216472625732
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.447946548461914
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.974233 --> -0.979804).  Saving model ...
Epoch: 14 cost time: 3.8788938522338867
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7804136276245117
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7458763122558594
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9200637340545654
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.918431520462036
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6742684841156006
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.8857829570770264
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.855759620666504
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.09066104888916
Epoch: 22, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.294929027557373
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 151828
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.159729242324829
Epoch: 1, Steps: 89 | Train Loss: 2.200 Vali Loss: 1.010 Vali Acc: 0.790 Test Loss: 1.010 Test Acc: 0.790
Validation loss decreased (inf --> -0.789683).  Saving model ...
Epoch: 2 cost time: 3.496037483215332
Epoch: 2, Steps: 89 | Train Loss: 0.724 Vali Loss: 0.458 Vali Acc: 0.882 Test Loss: 0.458 Test Acc: 0.882
Validation loss decreased (-0.789683 --> -0.881611).  Saving model ...
Epoch: 3 cost time: 3.6929516792297363
Epoch: 3, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.272 Vali Acc: 0.929 Test Loss: 0.272 Test Acc: 0.929
Validation loss decreased (-0.881611 --> -0.928967).  Saving model ...
Epoch: 4 cost time: 3.424325704574585
Epoch: 4, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.928967 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 3.765080213546753
Epoch: 5, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.951948 --> -0.966572).  Saving model ...
Epoch: 6 cost time: 3.6800262928009033
Epoch: 6, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.621060371398926
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.966572 --> -0.973537).  Saving model ...
Epoch: 8 cost time: 3.557783365249634
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973537 --> -0.977019).  Saving model ...
Epoch: 9 cost time: 3.5074634552001953
Epoch: 9, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.623605489730835
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 4.080749273300171
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.1424126625061035
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.079179763793945
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.390195608139038
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 15 cost time: 4.232763051986694
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.060571908950806
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.541240930557251
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.612730503082275
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.532517194747925
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.466986894607544
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.679823875427246
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.245563268661499
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.427461624145508
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.3986430168151855
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 137044
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.635528326034546
Epoch: 1, Steps: 89 | Train Loss: 2.269 Vali Loss: 1.128 Vali Acc: 0.761 Test Loss: 1.128 Test Acc: 0.761
Validation loss decreased (inf --> -0.761131).  Saving model ...
Epoch: 2 cost time: 3.908778429031372
Epoch: 2, Steps: 89 | Train Loss: 0.818 Vali Loss: 0.502 Vali Acc: 0.873 Test Loss: 0.502 Test Acc: 0.873
Validation loss decreased (-0.761131 --> -0.872558).  Saving model ...
Epoch: 3 cost time: 4.2734785079956055
Epoch: 3, Steps: 89 | Train Loss: 0.415 Vali Loss: 0.291 Vali Acc: 0.924 Test Loss: 0.291 Test Acc: 0.924
Validation loss decreased (-0.872558 --> -0.924092).  Saving model ...
Epoch: 4 cost time: 4.224295377731323
Epoch: 4, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.217 Vali Acc: 0.942 Test Loss: 0.217 Test Acc: 0.942
Validation loss decreased (-0.924092 --> -0.941502).  Saving model ...
Epoch: 5 cost time: 4.259461402893066
Epoch: 5, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
Validation loss decreased (-0.941502 --> -0.946377).  Saving model ...
Epoch: 6 cost time: 4.233610153198242
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
Validation loss decreased (-0.946377 --> -0.958216).  Saving model ...
Epoch: 7 cost time: 4.383250713348389
Epoch: 7, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.958216 --> -0.977018).  Saving model ...
Epoch: 8 cost time: 4.008253335952759
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.121444463729858
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.081070423126221
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.977018 --> -0.977019).  Saving model ...
Epoch: 11 cost time: 4.040074348449707
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.381119012832642
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 3.9117581844329834
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.103703022003174
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.016002178192139
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.187 Vali Acc: 0.947 Test Loss: 0.187 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.0547401905059814
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.923534393310547
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.843470335006714
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.633291006088257
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.428647756576538
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.653160333633423
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.611497640609741
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 129940
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.4805684089660645
Epoch: 1, Steps: 89 | Train Loss: 1.379 Vali Loss: 0.479 Vali Acc: 0.859 Test Loss: 0.479 Test Acc: 0.859
Validation loss decreased (inf --> -0.859327).  Saving model ...
Epoch: 2 cost time: 4.896201133728027
Epoch: 2, Steps: 89 | Train Loss: 0.403 Vali Loss: 0.299 Vali Acc: 0.913 Test Loss: 0.299 Test Acc: 0.913
Validation loss decreased (-0.859327 --> -0.912950).  Saving model ...
Epoch: 3 cost time: 5.885044097900391
Epoch: 3, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
Validation loss decreased (-0.912950 --> -0.926181).  Saving model ...
Epoch: 4 cost time: 6.0464417934417725
Epoch: 4, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.317 Vali Acc: 0.927 Test Loss: 0.317 Test Acc: 0.927
Validation loss decreased (-0.926181 --> -0.926877).  Saving model ...
Epoch: 5 cost time: 6.001944541931152
Epoch: 5, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
Validation loss decreased (-0.926877 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 6.540019989013672
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.217 Vali Acc: 0.953 Test Loss: 0.217 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.950622081756592
Epoch: 7, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.444759368896484
Epoch: 8, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.310 Vali Acc: 0.948 Test Loss: 0.310 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.63869833946228
Epoch: 9, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.254 Vali Acc: 0.960 Test Loss: 0.254 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.058645248413086
Epoch: 10, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.410 Vali Acc: 0.935 Test Loss: 0.410 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.574865102767944
Epoch: 11, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.253 Vali Acc: 0.961 Test Loss: 0.253 Test Acc: 0.961
Validation loss decreased (-0.960305 --> -0.961000).  Saving model ...
Epoch: 12 cost time: 8.253667116165161
Epoch: 12, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.303 Vali Acc: 0.962 Test Loss: 0.303 Test Acc: 0.962
Validation loss decreased (-0.961000 --> -0.962393).  Saving model ...
Epoch: 13 cost time: 9.061392307281494
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.284 Vali Acc: 0.964 Test Loss: 0.284 Test Acc: 0.964
Validation loss decreased (-0.962393 --> -0.964482).  Saving model ...
Epoch: 14 cost time: 8.639297723770142
Epoch: 14, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.344 Vali Acc: 0.946 Test Loss: 0.344 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.922719478607178
Epoch: 15, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.358 Vali Acc: 0.949 Test Loss: 0.358 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.396188497543335
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.249 Vali Acc: 0.969 Test Loss: 0.249 Test Acc: 0.969
Validation loss decreased (-0.964482 --> -0.969357).  Saving model ...
Epoch: 17 cost time: 7.7795305252075195
Epoch: 17, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.664 Vali Acc: 0.919 Test Loss: 0.664 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.055550813674927
Epoch: 18, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.368 Vali Acc: 0.960 Test Loss: 0.368 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.5498881340026855
Epoch: 19, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.356 Vali Acc: 0.953 Test Loss: 0.356 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.3718671798706055
Epoch: 20, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.442 Vali Acc: 0.952 Test Loss: 0.442 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.800112724304199
Epoch: 21, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.257 Vali Acc: 0.966 Test Loss: 0.257 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.209734678268433
Epoch: 22, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.278 Vali Acc: 0.974 Test Loss: 0.278 Test Acc: 0.974
Validation loss decreased (-0.969357 --> -0.973535).  Saving model ...
Epoch: 23 cost time: 7.371068477630615
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.742 Vali Acc: 0.934 Test Loss: 0.742 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.422292709350586
Epoch: 24, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.734 Vali Acc: 0.924 Test Loss: 0.734 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.7627081871032715
Epoch: 25, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.357 Vali Acc: 0.957 Test Loss: 0.357 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.901334047317505
Epoch: 26, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.725 Vali Acc: 0.941 Test Loss: 0.725 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.061825752258301
Epoch: 27, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.611 Vali Acc: 0.935 Test Loss: 0.611 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.799219846725464
Epoch: 28, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.531 Vali Acc: 0.954 Test Loss: 0.531 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.173572540283203
Epoch: 29, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.556 Vali Acc: 0.944 Test Loss: 0.556 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.79013204574585
Epoch: 30, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.627 Vali Acc: 0.946 Test Loss: 0.627 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 7.473686695098877
Epoch: 31, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.512 Vali Acc: 0.955 Test Loss: 0.512 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 7.17097020149231
Epoch: 32, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.546 Vali Acc: 0.948 Test Loss: 0.546 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 301652
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.07450532913208
Epoch: 1, Steps: 89 | Train Loss: 1.543 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
Validation loss decreased (inf --> -0.840523).  Saving model ...
Epoch: 2 cost time: 3.458207607269287
Epoch: 2, Steps: 89 | Train Loss: 0.413 Vali Loss: 0.328 Vali Acc: 0.907 Test Loss: 0.328 Test Acc: 0.907
Validation loss decreased (-0.840523 --> -0.907378).  Saving model ...
Epoch: 3 cost time: 3.5088768005371094
Epoch: 3, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.907378 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 3.3469038009643555
Epoch: 4, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.217 Vali Acc: 0.932 Test Loss: 0.217 Test Acc: 0.932
Validation loss decreased (-0.929663 --> -0.932449).  Saving model ...
Epoch: 5 cost time: 3.439653158187866
Epoch: 5, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
Validation loss decreased (-0.932449 --> -0.947769).  Saving model ...
Epoch: 6 cost time: 3.527414321899414
Epoch: 6, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.573211431503296
Epoch: 7, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.177 Vali Acc: 0.942 Test Loss: 0.177 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.571232557296753
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.947769 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 3.5799317359924316
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2249248027801514
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
Validation loss decreased (-0.957519 --> -0.967965).  Saving model ...
Epoch: 11 cost time: 3.6658928394317627
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5225677490234375
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.571687936782837
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.230 Vali Acc: 0.961 Test Loss: 0.230 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.54712176322937
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.235 Vali Acc: 0.953 Test Loss: 0.235 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.330929756164551
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.679 Vali Acc: 0.912 Test Loss: 0.679 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.750101327896118
Epoch: 16, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.329 Vali Acc: 0.934 Test Loss: 0.329 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.7765750885009766
Epoch: 17, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.405 Vali Acc: 0.932 Test Loss: 0.405 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.780694007873535
Epoch: 18, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.289 Vali Acc: 0.954 Test Loss: 0.289 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.756533622741699
Epoch: 19, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.6369636058807373
Epoch: 20, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.338 Vali Acc: 0.935 Test Loss: 0.338 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 205972
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.160503625869751
Epoch: 1, Steps: 89 | Train Loss: 1.686 Vali Loss: 0.622 Vali Acc: 0.827 Test Loss: 0.622 Test Acc: 0.827
Validation loss decreased (inf --> -0.827292).  Saving model ...
Epoch: 2 cost time: 3.541987657546997
Epoch: 2, Steps: 89 | Train Loss: 0.471 Vali Loss: 0.421 Vali Acc: 0.872 Test Loss: 0.421 Test Acc: 0.872
Validation loss decreased (-0.827292 --> -0.871862).  Saving model ...
Epoch: 3 cost time: 3.947042226791382
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.350 Vali Acc: 0.893 Test Loss: 0.350 Test Acc: 0.893
Validation loss decreased (-0.871862 --> -0.893451).  Saving model ...
Epoch: 4 cost time: 3.6461870670318604
Epoch: 4, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.146 Vali Acc: 0.955 Test Loss: 0.146 Test Acc: 0.955
Validation loss decreased (-0.893451 --> -0.954734).  Saving model ...
Epoch: 5 cost time: 3.811347246170044
Epoch: 5, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.774648666381836
Epoch: 6, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.413 Vali Acc: 0.873 Test Loss: 0.413 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.058541774749756
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.954734 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 3.568916082382202
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4841723442077637
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.136 Vali Acc: 0.961 Test Loss: 0.136 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.627490520477295
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 11 cost time: 3.934209108352661
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.876316547393799
Epoch: 12, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.965876 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 3.8559908866882324
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 14 cost time: 3.5753509998321533
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.810335874557495
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.232 Vali Acc: 0.949 Test Loss: 0.232 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.846604108810425
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8322181701660156
Epoch: 17, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.7617690563201904
Epoch: 18, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.755 Vali Acc: 0.889 Test Loss: 0.755 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6825661659240723
Epoch: 19, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.343 Vali Acc: 0.938 Test Loss: 0.343 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.8515138626098633
Epoch: 20, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.185 Vali Acc: 0.964 Test Loss: 0.185 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.7746832370758057
Epoch: 21, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.7710771560668945
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.960 Test Loss: 0.209 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5361740589141846
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.202 Vali Acc: 0.962 Test Loss: 0.202 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 167828
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.957167863845825
Epoch: 1, Steps: 89 | Train Loss: 1.857 Vali Loss: 0.731 Vali Acc: 0.820 Test Loss: 0.731 Test Acc: 0.820
Validation loss decreased (inf --> -0.820327).  Saving model ...
Epoch: 2 cost time: 3.695683240890503
Epoch: 2, Steps: 89 | Train Loss: 0.541 Vali Loss: 0.393 Vali Acc: 0.885 Test Loss: 0.393 Test Acc: 0.885
Validation loss decreased (-0.820327 --> -0.885094).  Saving model ...
Epoch: 3 cost time: 3.794140100479126
Epoch: 3, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.241 Vali Acc: 0.927 Test Loss: 0.241 Test Acc: 0.927
Validation loss decreased (-0.885094 --> -0.926878).  Saving model ...
Epoch: 4 cost time: 3.6995203495025635
Epoch: 4, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.926878 --> -0.943592).  Saving model ...
Epoch: 5 cost time: 2.7846758365631104
Epoch: 5, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
Validation loss decreased (-0.943592 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 2.89009428024292
Epoch: 6, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0815815925598145
Epoch: 7, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.981005907058716
Epoch: 8, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.959609 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 3.2972099781036377
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969358 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 3.1396660804748535
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1925787925720215
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 12 cost time: 3.2591679096221924
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.057727336883545
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 14 cost time: 3.4429965019226074
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.377 Vali Acc: 0.921 Test Loss: 0.377 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4166183471679688
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.443483591079712
Epoch: 16, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3684940338134766
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.259 Vali Acc: 0.923 Test Loss: 0.259 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.713050127029419
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.4479541778564453
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.3140344619750977
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5555124282836914
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.406740188598633
Epoch: 22, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.360417604446411
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.957 Test Loss: 0.224 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 137428
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.9499125480651855
Epoch: 1, Steps: 89 | Train Loss: 2.143 Vali Loss: 0.914 Vali Acc: 0.767 Test Loss: 0.914 Test Acc: 0.767
Validation loss decreased (inf --> -0.766704).  Saving model ...
Epoch: 2 cost time: 3.3781769275665283
Epoch: 2, Steps: 89 | Train Loss: 0.635 Vali Loss: 0.409 Vali Acc: 0.891 Test Loss: 0.409 Test Acc: 0.891
Validation loss decreased (-0.766704 --> -0.891361).  Saving model ...
Epoch: 3 cost time: 3.260673761367798
Epoch: 3, Steps: 89 | Train Loss: 0.314 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.891361 --> -0.944288).  Saving model ...
Epoch: 4 cost time: 3.7840147018432617
Epoch: 4, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.944288 --> -0.958912).  Saving model ...
Epoch: 5 cost time: 3.6678643226623535
Epoch: 5, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.958912 --> -0.966573).  Saving model ...
Epoch: 6 cost time: 3.765127658843994
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.662916421890259
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 3.7250237464904785
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.968662 --> -0.970055).  Saving model ...
Epoch: 9 cost time: 3.6686131954193115
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.970055 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 3.944293260574341
Epoch: 10, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 3.9091880321502686
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 3.6577882766723633
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5692250728607178
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.730947256088257
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 15 cost time: 3.9727349281311035
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 16 cost time: 3.8346054553985596
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9635298252105713
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.713961601257324
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.8936538696289062
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.170 Vali Acc: 0.971 Test Loss: 0.170 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.56487774848938
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.663451671600342
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.648674726486206
Epoch: 22, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.4074251651763916
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.196 Vali Acc: 0.961 Test Loss: 0.196 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.123567581176758
Epoch: 24, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.8942439556121826
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 118804
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.185544013977051
Epoch: 1, Steps: 89 | Train Loss: 2.234 Vali Loss: 1.075 Vali Acc: 0.776 Test Loss: 1.075 Test Acc: 0.776
Validation loss decreased (inf --> -0.775755).  Saving model ...
Epoch: 2 cost time: 2.933605432510376
Epoch: 2, Steps: 89 | Train Loss: 0.758 Vali Loss: 0.511 Vali Acc: 0.868 Test Loss: 0.511 Test Acc: 0.868
Validation loss decreased (-0.775755 --> -0.867683).  Saving model ...
Epoch: 3 cost time: 3.3159823417663574
Epoch: 3, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.281 Vali Acc: 0.923 Test Loss: 0.281 Test Acc: 0.923
Validation loss decreased (-0.867683 --> -0.922699).  Saving model ...
Epoch: 4 cost time: 3.3834609985351562
Epoch: 4, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
Validation loss decreased (-0.922699 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 3.2006711959838867
Epoch: 5, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.365701675415039
Epoch: 6, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.947073 --> -0.957519).  Saving model ...
Epoch: 7 cost time: 3.231276750564575
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
Validation loss decreased (-0.957519 --> -0.966573).  Saving model ...
Epoch: 8 cost time: 3.419149398803711
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 3.5474843978881836
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.325212001800537
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 3.703563690185547
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3226897716522217
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.191 Vali Acc: 0.955 Test Loss: 0.191 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.154386281967163
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.356510877609253
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.124 Vali Acc: 0.966 Test Loss: 0.124 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7654731273651123
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 16 cost time: 3.300994396209717
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.974233 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 3.6919355392456055
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.614732265472412
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3728044033050537
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5144236087799072
Epoch: 20, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.721320629119873
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.967074155807495
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.8975470066070557
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.23150897026062
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.833434820175171
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.068101406097412
Epoch: 26, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 104020
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.120668888092041
Epoch: 1, Steps: 89 | Train Loss: 2.325 Vali Loss: 1.184 Vali Acc: 0.709 Test Loss: 1.184 Test Acc: 0.709
Validation loss decreased (inf --> -0.708902).  Saving model ...
Epoch: 2 cost time: 4.074052333831787
Epoch: 2, Steps: 89 | Train Loss: 0.836 Vali Loss: 0.583 Vali Acc: 0.811 Test Loss: 0.583 Test Acc: 0.811
Validation loss decreased (-0.708902 --> -0.811276).  Saving model ...
Epoch: 3 cost time: 3.6717751026153564
Epoch: 3, Steps: 89 | Train Loss: 0.432 Vali Loss: 0.330 Vali Acc: 0.912 Test Loss: 0.330 Test Acc: 0.912
Validation loss decreased (-0.811276 --> -0.912253).  Saving model ...
Epoch: 4 cost time: 3.4437568187713623
Epoch: 4, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
Validation loss decreased (-0.912253 --> -0.935235).  Saving model ...
Epoch: 5 cost time: 3.2973504066467285
Epoch: 5, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
Validation loss decreased (-0.935235 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 3.538818120956421
Epoch: 6, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.950555 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 3.548579454421997
Epoch: 7, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.132 Vali Acc: 0.961 Test Loss: 0.132 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.704608917236328
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.962394 --> -0.974929).  Saving model ...
Epoch: 9 cost time: 3.66294527053833
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6989309787750244
Epoch: 10, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.131 Vali Acc: 0.953 Test Loss: 0.131 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9532675743103027
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4975531101226807
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.981197).  Saving model ...
Epoch: 13 cost time: 3.5773627758026123
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5852651596069336
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8134233951568604
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.212369680404663
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2802529335021973
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.450164556503296
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.3721437454223633
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.7032954692840576
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.689861536026001
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.3732399940490723
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 96916
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.4863221645355225
Epoch: 1, Steps: 89 | Train Loss: 1.397 Vali Loss: 0.583 Vali Acc: 0.799 Test Loss: 0.583 Test Acc: 0.799
Validation loss decreased (inf --> -0.799437).  Saving model ...
Epoch: 2 cost time: 5.345905780792236
Epoch: 2, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.473 Vali Acc: 0.866 Test Loss: 0.473 Test Acc: 0.866
Validation loss decreased (-0.799437 --> -0.865594).  Saving model ...
Epoch: 3 cost time: 5.110260725021362
Epoch: 3, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
Validation loss decreased (-0.865594 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 5.531821250915527
Epoch: 4, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.340 Vali Acc: 0.920 Test Loss: 0.340 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.812042236328125
Epoch: 5, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.238 Vali Acc: 0.940 Test Loss: 0.238 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.185004711151123
Epoch: 6, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.350 Vali Acc: 0.927 Test Loss: 0.350 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.732488632202148
Epoch: 7, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.374 Vali Acc: 0.938 Test Loss: 0.374 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.4703004360198975
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
Validation loss decreased (-0.941502 --> -0.961697).  Saving model ...
Epoch: 9 cost time: 6.545075178146362
Epoch: 9, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.853423595428467
Epoch: 10, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.019651174545288
Epoch: 11, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
Validation loss decreased (-0.961697 --> -0.966572).  Saving model ...
Epoch: 12 cost time: 4.952940940856934
Epoch: 12, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.313 Vali Acc: 0.955 Test Loss: 0.313 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.355091094970703
Epoch: 13, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.477 Vali Acc: 0.936 Test Loss: 0.477 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.200613260269165
Epoch: 14, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.330 Vali Acc: 0.960 Test Loss: 0.330 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.2560038566589355
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.309 Vali Acc: 0.955 Test Loss: 0.309 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.777802228927612
Epoch: 16, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.323 Vali Acc: 0.962 Test Loss: 0.323 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.612072229385376
Epoch: 17, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.279 Vali Acc: 0.958 Test Loss: 0.279 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.99988055229187
Epoch: 18, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.348 Vali Acc: 0.954 Test Loss: 0.348 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.439322233200073
Epoch: 19, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.573 Vali Acc: 0.920 Test Loss: 0.573 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.494616508483887
Epoch: 20, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.480 Vali Acc: 0.954 Test Loss: 0.480 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.2485010623931885
Epoch: 21, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.536 Vali Acc: 0.939 Test Loss: 0.536 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 285140
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.293517827987671
Epoch: 1, Steps: 89 | Train Loss: 1.571 Vali Loss: 0.580 Vali Acc: 0.818 Test Loss: 0.580 Test Acc: 0.818
Validation loss decreased (inf --> -0.817543).  Saving model ...
Epoch: 2 cost time: 3.7025842666625977
Epoch: 2, Steps: 89 | Train Loss: 0.470 Vali Loss: 0.344 Vali Acc: 0.905 Test Loss: 0.344 Test Acc: 0.905
Validation loss decreased (-0.817543 --> -0.904593).  Saving model ...
Epoch: 3 cost time: 3.5567877292633057
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.904593 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 3.736513137817383
Epoch: 4, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.191 Vali Acc: 0.954 Test Loss: 0.191 Test Acc: 0.954
Validation loss decreased (-0.943591 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 3.8568997383117676
Epoch: 5, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.634629249572754
Epoch: 6, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.702655792236328
Epoch: 7, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.954037 --> -0.956126).  Saving model ...
Epoch: 8 cost time: 3.682361602783203
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5460739135742188
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.311 Vali Acc: 0.924 Test Loss: 0.311 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5338387489318848
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.303 Vali Acc: 0.936 Test Loss: 0.303 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6883151531219482
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
Validation loss decreased (-0.956126 --> -0.962394).  Saving model ...
Epoch: 12 cost time: 3.614973783493042
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.316 Vali Acc: 0.924 Test Loss: 0.316 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7986247539520264
Epoch: 13, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7131035327911377
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.231 Vali Acc: 0.956 Test Loss: 0.231 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.6402456760406494
Epoch: 15, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.604581356048584
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.180 Vali Acc: 0.968 Test Loss: 0.180 Test Acc: 0.968
Validation loss decreased (-0.962394 --> -0.967965).  Saving model ...
Epoch: 17 cost time: 3.774527072906494
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.278 Vali Acc: 0.946 Test Loss: 0.278 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4100990295410156
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.218 Vali Acc: 0.963 Test Loss: 0.218 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0558884143829346
Epoch: 19, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.245 Vali Acc: 0.956 Test Loss: 0.245 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.2418036460876465
Epoch: 20, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.322 Vali Acc: 0.953 Test Loss: 0.322 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.151796340942383
Epoch: 21, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.449 Vali Acc: 0.922 Test Loss: 0.449 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.622586965560913
Epoch: 22, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.259 Vali Acc: 0.960 Test Loss: 0.259 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.2351608276367188
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.332 Vali Acc: 0.949 Test Loss: 0.332 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.330263376235962
Epoch: 24, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.488 Vali Acc: 0.930 Test Loss: 0.488 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.365105390548706
Epoch: 25, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.178 Vali Acc: 0.968 Test Loss: 0.178 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 26 cost time: 3.279841899871826
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.233 Vali Acc: 0.969 Test Loss: 0.233 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969357).  Saving model ...
Epoch: 27 cost time: 3.431427240371704
Epoch: 27, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.270 Vali Acc: 0.958 Test Loss: 0.270 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4298923015594482
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.303 Vali Acc: 0.960 Test Loss: 0.303 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1595640182495117
Epoch: 29, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.325 Vali Acc: 0.958 Test Loss: 0.325 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.277017831802368
Epoch: 30, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.350 Vali Acc: 0.958 Test Loss: 0.350 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.5628130435943604
Epoch: 31, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.249 Vali Acc: 0.971 Test Loss: 0.249 Test Acc: 0.971
Validation loss decreased (-0.969357 --> -0.971446).  Saving model ...
Epoch: 32 cost time: 3.258143186569214
Epoch: 32, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.256 Vali Acc: 0.973 Test Loss: 0.256 Test Acc: 0.973
Validation loss decreased (-0.971446 --> -0.972839).  Saving model ...
Epoch: 33 cost time: 3.201495885848999
Epoch: 33, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.397 Vali Acc: 0.952 Test Loss: 0.397 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.443298578262329
Epoch: 34, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.281 Vali Acc: 0.971 Test Loss: 0.281 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.4494566917419434
Epoch: 35, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.5014686584472656
Epoch: 36, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.280 Vali Acc: 0.966 Test Loss: 0.280 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.2974367141723633
Epoch: 37, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.352 Vali Acc: 0.960 Test Loss: 0.352 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.4758999347686768
Epoch: 38, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.232 Vali Acc: 0.974 Test Loss: 0.232 Test Acc: 0.974
Validation loss decreased (-0.972839 --> -0.974232).  Saving model ...
Epoch: 39 cost time: 3.770948886871338
Epoch: 39, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.527 Vali Acc: 0.938 Test Loss: 0.527 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.3414618968963623
Epoch: 40, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.282 Vali Acc: 0.967 Test Loss: 0.282 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.750755786895752
Epoch: 41, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.342 Vali Acc: 0.964 Test Loss: 0.342 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.8963868618011475
Epoch: 42, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.262 Vali Acc: 0.974 Test Loss: 0.262 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.2112069129943848
Epoch: 43, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.329 Vali Acc: 0.963 Test Loss: 0.329 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.5297439098358154
Epoch: 44, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
Validation loss decreased (-0.974232 --> -0.974927).  Saving model ...
Epoch: 45 cost time: 3.547175168991089
Epoch: 45, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.454 Vali Acc: 0.955 Test Loss: 0.454 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.3299624919891357
Epoch: 46, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.310 Vali Acc: 0.969 Test Loss: 0.310 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.5645344257354736
Epoch: 47, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.366 Vali Acc: 0.967 Test Loss: 0.366 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.654007911682129
Epoch: 48, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.484 Vali Acc: 0.955 Test Loss: 0.484 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.547828197479248
Epoch: 49, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.325 Vali Acc: 0.975 Test Loss: 0.325 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.599243640899658
Epoch: 50, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.400 Vali Acc: 0.967 Test Loss: 0.400 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.665647506713867
Epoch: 51, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.381 Vali Acc: 0.973 Test Loss: 0.381 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.4320483207702637
Epoch: 52, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.333 Vali Acc: 0.974 Test Loss: 0.333 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.532693386077881
Epoch: 53, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.977 Test Loss: 0.312 Test Acc: 0.977
Validation loss decreased (-0.974927 --> -0.977016).  Saving model ...
Epoch: 54 cost time: 3.559558629989624
Epoch: 54, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.267 Vali Acc: 0.976 Test Loss: 0.267 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.4864771366119385
Epoch: 55, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.237 Vali Acc: 0.974 Test Loss: 0.237 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.5794734954833984
Epoch: 56, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.309 Vali Acc: 0.969 Test Loss: 0.309 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.396519899368286
Epoch: 57, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.459 Vali Acc: 0.963 Test Loss: 0.459 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.6189069747924805
Epoch: 58, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.315 Vali Acc: 0.971 Test Loss: 0.315 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.463818311691284
Epoch: 59, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.374 Vali Acc: 0.970 Test Loss: 0.374 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.4604897499084473
Epoch: 60, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.399 Vali Acc: 0.971 Test Loss: 0.399 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.5505638122558594
Epoch: 61, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.465 Vali Acc: 0.953 Test Loss: 0.465 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.608307123184204
Epoch: 62, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.400 Vali Acc: 0.967 Test Loss: 0.400 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 3.375657558441162
Epoch: 63, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.353 Vali Acc: 0.969 Test Loss: 0.353 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 189460
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.701130151748657
Epoch: 1, Steps: 89 | Train Loss: 1.705 Vali Loss: 0.651 Vali Acc: 0.826 Test Loss: 0.651 Test Acc: 0.826
Validation loss decreased (inf --> -0.825899).  Saving model ...
Epoch: 2 cost time: 3.205188274383545
Epoch: 2, Steps: 89 | Train Loss: 0.505 Vali Loss: 0.330 Vali Acc: 0.912 Test Loss: 0.330 Test Acc: 0.912
Validation loss decreased (-0.825899 --> -0.911557).  Saving model ...
Epoch: 3 cost time: 3.204759120941162
Epoch: 3, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
Validation loss decreased (-0.911557 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 3.0315709114074707
Epoch: 4, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
Validation loss decreased (-0.929663 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 3.312250852584839
Epoch: 5, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.153 Vali Acc: 0.956 Test Loss: 0.153 Test Acc: 0.956
Validation loss decreased (-0.954037 --> -0.956127).  Saving model ...
Epoch: 6 cost time: 3.0787298679351807
Epoch: 6, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.956127 --> -0.970055).  Saving model ...
Epoch: 7 cost time: 3.098416328430176
Epoch: 7, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2440061569213867
Epoch: 8, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.831979751586914
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.340867042541504
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5952022075653076
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.93400502204895
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.24580979347229
Epoch: 13, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.248 Vali Acc: 0.946 Test Loss: 0.248 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.307434558868408
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.312 Vali Acc: 0.933 Test Loss: 0.312 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.1714930534362793
Epoch: 15, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.1632068157196045
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 151316
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.38243293762207
Epoch: 1, Steps: 89 | Train Loss: 1.912 Vali Loss: 0.810 Vali Acc: 0.773 Test Loss: 0.810 Test Acc: 0.773
Validation loss decreased (inf --> -0.772972).  Saving model ...
Epoch: 2 cost time: 2.5818116664886475
Epoch: 2, Steps: 89 | Train Loss: 0.574 Vali Loss: 0.416 Vali Acc: 0.868 Test Loss: 0.416 Test Acc: 0.868
Validation loss decreased (-0.772972 --> -0.868380).  Saving model ...
Epoch: 3 cost time: 3.755173921585083
Epoch: 3, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.327 Vali Acc: 0.901 Test Loss: 0.327 Test Acc: 0.901
Validation loss decreased (-0.868380 --> -0.901111).  Saving model ...
Epoch: 4 cost time: 3.5521302223205566
Epoch: 4, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.266 Vali Acc: 0.904 Test Loss: 0.266 Test Acc: 0.904
Validation loss decreased (-0.901111 --> -0.903897).  Saving model ...
Epoch: 5 cost time: 3.430227518081665
Epoch: 5, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.903897 --> -0.957519).  Saving model ...
Epoch: 6 cost time: 3.4512040615081787
Epoch: 6, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.957519 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 3.533834218978882
Epoch: 7, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4515182971954346
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 3.653162956237793
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.671464681625366
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 3.400613784790039
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.970055 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 3.599006414413452
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.483612060546875
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.591306686401367
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 15 cost time: 3.5833582878112793
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.773679494857788
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.553839921951294
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.8193001747131348
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.7515504360198975
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.013391733169556
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.217 Vali Acc: 0.947 Test Loss: 0.217 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.8911147117614746
Epoch: 21, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.170 Vali Acc: 0.966 Test Loss: 0.170 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.9421029090881348
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.73294997215271
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.4347128868103027
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.245 Vali Acc: 0.945 Test Loss: 0.245 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 120916
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.164987087249756
Epoch: 1, Steps: 89 | Train Loss: 2.023 Vali Loss: 0.859 Vali Acc: 0.815 Test Loss: 0.859 Test Acc: 0.815
Validation loss decreased (inf --> -0.815451).  Saving model ...
Epoch: 2 cost time: 3.6492919921875
Epoch: 2, Steps: 89 | Train Loss: 0.625 Vali Loss: 0.442 Vali Acc: 0.871 Test Loss: 0.442 Test Acc: 0.871
Validation loss decreased (-0.815451 --> -0.871165).  Saving model ...
Epoch: 3 cost time: 3.662881851196289
Epoch: 3, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.228 Vali Acc: 0.939 Test Loss: 0.228 Test Acc: 0.939
Validation loss decreased (-0.871165 --> -0.939413).  Saving model ...
Epoch: 4 cost time: 3.889430522918701
Epoch: 4, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.230 Vali Acc: 0.934 Test Loss: 0.230 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6765689849853516
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.135 Vali Acc: 0.960 Test Loss: 0.135 Test Acc: 0.960
Validation loss decreased (-0.939413 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 3.4576637744903564
Epoch: 6, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.960305 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 3.7629213333129883
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.962394 --> -0.973537).  Saving model ...
Epoch: 8 cost time: 3.3140437602996826
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.973537).  Saving model ...
Epoch: 9 cost time: 3.243486166000366
Epoch: 9, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.146 Vali Acc: 0.950 Test Loss: 0.146 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4975504875183105
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.973537 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 3.346806049346924
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3882291316986084
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3021721839904785
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.369380474090576
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.439304828643799
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.5357556343078613
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.119 Vali Acc: 0.960 Test Loss: 0.119 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4157087802886963
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.0328354835510254
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 19 cost time: 3.526723861694336
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.262284994125366
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.486255645751953
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.3410298824310303
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4593915939331055
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.285348415374756
Epoch: 24, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.6450729370117188
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.5262787342071533
Epoch: 26, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 27 cost time: 3.2889976501464844
Epoch: 27, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.011400938034058
Epoch: 28, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.258 Vali Acc: 0.955 Test Loss: 0.258 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.7910501956939697
Epoch: 29, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.032032012939453
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.6518876552581787
Epoch: 31, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 32 cost time: 3.827608108520508
Epoch: 32, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 33 cost time: 4.064552068710327
Epoch: 33, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.8662922382354736
Epoch: 34, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.9638748168945312
Epoch: 35, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.688021421432495
Epoch: 36, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.0571608543396
Epoch: 37, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.579923391342163
Epoch: 38, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.79953670501709
Epoch: 39, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.751406669616699
Epoch: 40, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.212 Vali Acc: 0.968 Test Loss: 0.212 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.9341557025909424
Epoch: 41, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.837618112564087
Epoch: 42, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.179 Vali Acc: 0.966 Test Loss: 0.179 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 102292
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.024037837982178
Epoch: 1, Steps: 89 | Train Loss: 2.292 Vali Loss: 1.096 Vali Acc: 0.753 Test Loss: 1.096 Test Acc: 0.753
Validation loss decreased (inf --> -0.752775).  Saving model ...
Epoch: 2 cost time: 3.6415469646453857
Epoch: 2, Steps: 89 | Train Loss: 0.780 Vali Loss: 0.534 Vali Acc: 0.854 Test Loss: 0.534 Test Acc: 0.854
Validation loss decreased (-0.752775 --> -0.853755).  Saving model ...
Epoch: 3 cost time: 3.767341136932373
Epoch: 3, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
Validation loss decreased (-0.853755 --> -0.918521).  Saving model ...
Epoch: 4 cost time: 3.847877264022827
Epoch: 4, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.244 Vali Acc: 0.932 Test Loss: 0.244 Test Acc: 0.932
Validation loss decreased (-0.918521 --> -0.932449).  Saving model ...
Epoch: 5 cost time: 3.5316131114959717
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
Validation loss decreased (-0.932449 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 3.6826839447021484
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7960045337677
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5664286613464355
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.965876 --> -0.977019).  Saving model ...
Epoch: 9 cost time: 3.7390849590301514
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.772798776626587
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6800851821899414
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.977019 --> -0.977019).  Saving model ...
Epoch: 12 cost time: 3.736032724380493
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5746634006500244
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6445233821868896
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.237415075302124
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 16 cost time: 3.3200290203094482
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3097872734069824
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 18 cost time: 3.283005952835083
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.177948474884033
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3156588077545166
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3026208877563477
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.266103744506836
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 23 cost time: 3.3824706077575684
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.393024206161499
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.6013598442077637
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.26636004447937
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.394658088684082
Epoch: 27, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.3207080364227295
Epoch: 28, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.4320907592773438
Epoch: 29, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.282104253768921
Epoch: 30, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.3333466053009033
Epoch: 31, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.5503885746002197
Epoch: 32, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 87508
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.7010297775268555
Epoch: 1, Steps: 89 | Train Loss: 2.270 Vali Loss: 1.184 Vali Acc: 0.729 Test Loss: 1.184 Test Acc: 0.729
Validation loss decreased (inf --> -0.729097).  Saving model ...
Epoch: 2 cost time: 3.502467393875122
Epoch: 2, Steps: 89 | Train Loss: 0.890 Vali Loss: 0.569 Vali Acc: 0.872 Test Loss: 0.569 Test Acc: 0.872
Validation loss decreased (-0.729097 --> -0.871861).  Saving model ...
Epoch: 3 cost time: 3.6556344032287598
Epoch: 3, Steps: 89 | Train Loss: 0.474 Vali Loss: 0.342 Vali Acc: 0.919 Test Loss: 0.342 Test Acc: 0.919
Validation loss decreased (-0.871861 --> -0.919217).  Saving model ...
Epoch: 4 cost time: 3.6579036712646484
Epoch: 4, Steps: 89 | Train Loss: 0.301 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
Validation loss decreased (-0.919217 --> -0.940805).  Saving model ...
Epoch: 5 cost time: 3.578425645828247
Epoch: 5, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.940805 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 3.690242290496826
Epoch: 6, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6687986850738525
Epoch: 7, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.951948 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 3.7222795486450195
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 3.6382052898406982
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.756632089614868
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 3.655667304992676
Epoch: 11, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.706617593765259
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7017722129821777
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.104 Vali Acc: 0.966 Test Loss: 0.104 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.4780609607696533
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 3.664072275161743
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 3.5542662143707275
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.204 Vali Acc: 0.947 Test Loss: 0.204 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6983866691589355
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.9064505100250244
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.154259920120239
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.278043508529663
Epoch: 20, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.049501895904541
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 22 cost time: 3.899303913116455
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9711151123046875
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.980501 --> -0.981893).  Saving model ...
Epoch: 24 cost time: 3.915402889251709
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.35209059715271
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.895202398300171
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 27 cost time: 3.606929302215576
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8362231254577637
Epoch: 28, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.608428716659546
Epoch: 29, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.863459825515747
Epoch: 30, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.592081308364868
Epoch: 31, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.45746111869812
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.5119893550872803
Epoch: 33, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.3643057346343994
Epoch: 34, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.288240671157837
Epoch: 35, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.220716953277588
Epoch: 36, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm64_nh16_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 80404
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.825106620788574
Epoch: 1, Steps: 89 | Train Loss: 1.608 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
Validation loss decreased (inf --> -0.840523).  Saving model ...
Epoch: 2 cost time: 3.408407688140869
Epoch: 2, Steps: 89 | Train Loss: 0.439 Vali Loss: 0.293 Vali Acc: 0.918 Test Loss: 0.293 Test Acc: 0.918
Validation loss decreased (-0.840523 --> -0.917824).  Saving model ...
Epoch: 3 cost time: 2.920119285583496
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.300 Vali Acc: 0.909 Test Loss: 0.300 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8669960498809814
Epoch: 4, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
Validation loss decreased (-0.917824 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 3.386040210723877
Epoch: 5, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.879741668701172
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.215 Vali Acc: 0.940 Test Loss: 0.215 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3772990703582764
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.950555 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 3.3878931999206543
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3662021160125732
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3229498863220215
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.256 Vali Acc: 0.932 Test Loss: 0.256 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.338949203491211
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.963787).  Saving model ...
Epoch: 12 cost time: 3.4409823417663574
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.314 Vali Acc: 0.941 Test Loss: 0.314 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4911627769470215
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.187 Vali Acc: 0.962 Test Loss: 0.187 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3435513973236084
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.399 Vali Acc: 0.942 Test Loss: 0.399 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.191685914993286
Epoch: 15, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.293 Vali Acc: 0.953 Test Loss: 0.293 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0533721446990967
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.211 Vali Acc: 0.960 Test Loss: 0.211 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.6586804389953613
Epoch: 17, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.306 Vali Acc: 0.960 Test Loss: 0.306 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.7293660640716553
Epoch: 18, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.241 Vali Acc: 0.955 Test Loss: 0.241 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.714545249938965
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.291 Vali Acc: 0.955 Test Loss: 0.291 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.5834381580352783
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.277 Vali Acc: 0.960 Test Loss: 0.277 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.4919495582580566
Epoch: 21, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.317 Vali Acc: 0.956 Test Loss: 0.317 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 159412
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.822332143783569
Epoch: 1, Steps: 89 | Train Loss: 1.913 Vali Loss: 0.765 Vali Acc: 0.802 Test Loss: 0.765 Test Acc: 0.802
Validation loss decreased (inf --> -0.801524).  Saving model ...
Epoch: 2 cost time: 3.8310558795928955
Epoch: 2, Steps: 89 | Train Loss: 0.552 Vali Loss: 0.390 Vali Acc: 0.893 Test Loss: 0.390 Test Acc: 0.893
Validation loss decreased (-0.801524 --> -0.893450).  Saving model ...
Epoch: 3 cost time: 4.097078084945679
Epoch: 3, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
Validation loss decreased (-0.893450 --> -0.925485).  Saving model ...
Epoch: 4 cost time: 3.8038816452026367
Epoch: 4, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.925485 --> -0.951252).  Saving model ...
Epoch: 5 cost time: 3.7473762035369873
Epoch: 5, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.219932556152344
Epoch: 6, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.728862762451172
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.708519697189331
Epoch: 8, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.951252 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 4.004098653793335
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7495932579040527
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.662353038787842
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.1409385204315186
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.7153828144073486
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.883868932723999
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.132523059844971
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.867433547973633
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.372 Vali Acc: 0.907 Test Loss: 0.372 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.6621763706207275
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.190 Vali Acc: 0.955 Test Loss: 0.190 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.10272479057312
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 111572
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.245425462722778
Epoch: 1, Steps: 89 | Train Loss: 2.118 Vali Loss: 0.921 Vali Acc: 0.762 Test Loss: 0.921 Test Acc: 0.762
Validation loss decreased (inf --> -0.761829).  Saving model ...
Epoch: 2 cost time: 4.189819574356079
Epoch: 2, Steps: 89 | Train Loss: 0.622 Vali Loss: 0.431 Vali Acc: 0.891 Test Loss: 0.431 Test Acc: 0.891
Validation loss decreased (-0.761829 --> -0.891361).  Saving model ...
Epoch: 3 cost time: 3.6817264556884766
Epoch: 3, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
Validation loss decreased (-0.891361 --> -0.933145).  Saving model ...
Epoch: 4 cost time: 4.093559741973877
Epoch: 4, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
Validation loss decreased (-0.933145 --> -0.952645).  Saving model ...
Epoch: 5 cost time: 4.120447158813477
Epoch: 5, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.952645 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 3.774949312210083
Epoch: 6, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.222253084182739
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
Validation loss decreased (-0.958216 --> -0.963091).  Saving model ...
Epoch: 8 cost time: 3.9181830883026123
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.963091 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 3.5568506717681885
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.133 Vali Acc: 0.961 Test Loss: 0.133 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8346354961395264
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 11 cost time: 3.746236562728882
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.590129852294922
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.965876 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 4.172605276107788
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.476404905319214
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.404989242553711
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8432507514953613
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 3.434434652328491
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.966047525405884
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.8766708374023438
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.683868885040283
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.4396936893463135
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.822072744369507
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 23 cost time: 3.5235769748687744
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.525765895843506
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.675607442855835
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.216 Vali Acc: 0.953 Test Loss: 0.216 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.4714012145996094
Epoch: 26, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.522507667541504
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.089823007583618
Epoch: 28, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.237431764602661
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.19239354133606
Epoch: 30, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.207 Vali Acc: 0.955 Test Loss: 0.207 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.5251784324646
Epoch: 31, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.228 Vali Acc: 0.948 Test Loss: 0.228 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.067357540130615
Epoch: 32, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 92500
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.3123297691345215
Epoch: 1, Steps: 89 | Train Loss: 2.290 Vali Loss: 1.087 Vali Acc: 0.768 Test Loss: 1.087 Test Acc: 0.768
Validation loss decreased (inf --> -0.768095).  Saving model ...
Epoch: 2 cost time: 3.715470552444458
Epoch: 2, Steps: 89 | Train Loss: 0.716 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
Validation loss decreased (-0.768095 --> -0.869772).  Saving model ...
Epoch: 3 cost time: 4.168769598007202
Epoch: 3, Steps: 89 | Train Loss: 0.363 Vali Loss: 0.267 Vali Acc: 0.928 Test Loss: 0.267 Test Acc: 0.928
Validation loss decreased (-0.869772 --> -0.927574).  Saving model ...
Epoch: 4 cost time: 3.863961696624756
Epoch: 4, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
Validation loss decreased (-0.927574 --> -0.946377).  Saving model ...
Epoch: 5 cost time: 3.7706527709960938
Epoch: 5, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.0476837158203125
Epoch: 6, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
Validation loss decreased (-0.946377 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 3.8552350997924805
Epoch: 7, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
Validation loss decreased (-0.961001 --> -0.961002).  Saving model ...
Epoch: 8 cost time: 3.8729376792907715
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.467686414718628
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (-0.961002 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 3.866053819656372
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.969358).  Saving model ...
Epoch: 11 cost time: 4.158555746078491
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 4.182636499404907
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.941819429397583
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.83343505859375
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.328882455825806
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.021746397018433
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.680894136428833
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.3304901123046875
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.141801834106445
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.768078088760376
Epoch: 20, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.237850904464722
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 77300
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.271050691604614
Epoch: 1, Steps: 89 | Train Loss: 2.440 Vali Loss: 1.344 Vali Acc: 0.767 Test Loss: 1.344 Test Acc: 0.767
Validation loss decreased (inf --> -0.766700).  Saving model ...
Epoch: 2 cost time: 3.617324113845825
Epoch: 2, Steps: 89 | Train Loss: 0.901 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
Validation loss decreased (-0.766700 --> -0.855844).  Saving model ...
Epoch: 3 cost time: 3.269519329071045
Epoch: 3, Steps: 89 | Train Loss: 0.452 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
Validation loss decreased (-0.855844 --> -0.925484).  Saving model ...
Epoch: 4 cost time: 3.582899808883667
Epoch: 4, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
Validation loss decreased (-0.925484 --> -0.940805).  Saving model ...
Epoch: 5 cost time: 3.748889446258545
Epoch: 5, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
Validation loss decreased (-0.940805 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 3.57262921333313
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.954734 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 3.345410108566284
Epoch: 7, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 3.2648487091064453
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.35691499710083
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 3.2885067462921143
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0282633304595947
Epoch: 11, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 3.142361879348755
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.974233 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 3.25584077835083
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0708351135253906
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2185304164886475
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8527815341949463
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2364814281463623
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.1733405590057373
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.03548526763916
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.2754714488983154
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.28481125831604
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.3762638568878174
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 67988
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.419347524642944
Epoch: 1, Steps: 89 | Train Loss: 2.577 Vali Loss: 1.590 Vali Acc: 0.694 Test Loss: 1.590 Test Acc: 0.694
Validation loss decreased (inf --> -0.693577).  Saving model ...
Epoch: 2 cost time: 3.5953197479248047
Epoch: 2, Steps: 89 | Train Loss: 1.147 Vali Loss: 0.687 Vali Acc: 0.855 Test Loss: 0.687 Test Acc: 0.855
Validation loss decreased (-0.693577 --> -0.855146).  Saving model ...
Epoch: 3 cost time: 3.4792392253875732
Epoch: 3, Steps: 89 | Train Loss: 0.568 Vali Loss: 0.408 Vali Acc: 0.914 Test Loss: 0.408 Test Acc: 0.914
Validation loss decreased (-0.855146 --> -0.913645).  Saving model ...
Epoch: 4 cost time: 3.4087491035461426
Epoch: 4, Steps: 89 | Train Loss: 0.363 Vali Loss: 0.295 Vali Acc: 0.923 Test Loss: 0.295 Test Acc: 0.923
Validation loss decreased (-0.913645 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 3.4664647579193115
Epoch: 5, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.226 Vali Acc: 0.947 Test Loss: 0.226 Test Acc: 0.947
Validation loss decreased (-0.922699 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 3.462991237640381
Epoch: 6, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
Validation loss decreased (-0.947073 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 3.4658734798431396
Epoch: 7, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
Validation loss decreased (-0.952644 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 3.346191167831421
Epoch: 8, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.955430 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 3.45283579826355
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 3.477093458175659
Epoch: 10, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 3.576996088027954
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 3.3895797729492188
Epoch: 12, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4789416790008545
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.426044225692749
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 3.488980293273926
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3231818675994873
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.165 Vali Acc: 0.947 Test Loss: 0.165 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4481966495513916
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 18 cost time: 3.5030288696289062
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3867688179016113
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.410210371017456
Epoch: 20, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.48952579498291
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4061059951782227
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.5477912425994873
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.528895139694214
Epoch: 24, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.419727325439453
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.3522024154663086
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.466902732849121
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 60596
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.5963358879089355
Epoch: 1, Steps: 89 | Train Loss: 2.605 Vali Loss: 1.710 Vali Acc: 0.614 Test Loss: 1.710 Test Acc: 0.614
Validation loss decreased (inf --> -0.614189).  Saving model ...
Epoch: 2 cost time: 3.373387336730957
Epoch: 2, Steps: 89 | Train Loss: 1.269 Vali Loss: 0.815 Vali Acc: 0.807 Test Loss: 0.815 Test Acc: 0.807
Validation loss decreased (-0.614189 --> -0.807095).  Saving model ...
Epoch: 3 cost time: 3.331530809402466
Epoch: 3, Steps: 89 | Train Loss: 0.680 Vali Loss: 0.496 Vali Acc: 0.881 Test Loss: 0.496 Test Acc: 0.881
Validation loss decreased (-0.807095 --> -0.880914).  Saving model ...
Epoch: 4 cost time: 3.322772979736328
Epoch: 4, Steps: 89 | Train Loss: 0.437 Vali Loss: 0.351 Vali Acc: 0.909 Test Loss: 0.351 Test Acc: 0.909
Validation loss decreased (-0.880914 --> -0.909467).  Saving model ...
Epoch: 5 cost time: 2.949470281600952
Epoch: 5, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
Validation loss decreased (-0.909467 --> -0.937323).  Saving model ...
Epoch: 6 cost time: 3.1043519973754883
Epoch: 6, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.937323 --> -0.940806).  Saving model ...
Epoch: 7 cost time: 3.1224679946899414
Epoch: 7, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
Validation loss decreased (-0.940806 --> -0.949163).  Saving model ...
Epoch: 8 cost time: 3.0012502670288086
Epoch: 8, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
Validation loss decreased (-0.949163 --> -0.963787).  Saving model ...
Epoch: 9 cost time: 2.960029363632202
Epoch: 9, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
Validation loss decreased (-0.963787 --> -0.965876).  Saving model ...
Epoch: 10 cost time: 3.014241933822632
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.965876 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 2.969050407409668
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 2.9924228191375732
Epoch: 12, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1288726329803467
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0402653217315674
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0977699756622314
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.016425848007202
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 17 cost time: 3.151850700378418
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.014357328414917
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0614800453186035
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 3.010183572769165
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9941508769989014
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982590).  Saving model ...
Epoch: 22 cost time: 2.9723947048187256
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9784045219421387
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.9440221786499023
Epoch: 24, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.791670560836792
Epoch: 25, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.6544511318206787
Epoch: 26, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.7393946647644043
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.5760793685913086
Epoch: 28, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 29 cost time: 3.6114277839660645
Epoch: 29, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.6002614498138428
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.6441752910614014
Epoch: 31, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.648650646209717
Epoch: 32, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.3719606399536133
Epoch: 33, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.3177990913391113
Epoch: 34, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.5570058822631836
Epoch: 35, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.4318795204162598
Epoch: 36, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.4189579486846924
Epoch: 37, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.357574939727783
Epoch: 38, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 57044
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.748579502105713
Epoch: 1, Steps: 89 | Train Loss: 1.658 Vali Loss: 0.566 Vali Acc: 0.843 Test Loss: 0.566 Test Acc: 0.843
Validation loss decreased (inf --> -0.843309).  Saving model ...
Epoch: 2 cost time: 3.570335626602173
Epoch: 2, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
Validation loss decreased (-0.843309 --> -0.926181).  Saving model ...
Epoch: 3 cost time: 3.433307647705078
Epoch: 3, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.264 Vali Acc: 0.921 Test Loss: 0.264 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.493281126022339
Epoch: 4, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.926181 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 3.4012675285339355
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5532469749450684
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
Validation loss decreased (-0.943591 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 3.3331594467163086
Epoch: 7, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.965180 --> -0.973536).  Saving model ...
Epoch: 8 cost time: 3.442154884338379
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.207 Vali Acc: 0.945 Test Loss: 0.207 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3430685997009277
Epoch: 9, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.354 Vali Acc: 0.913 Test Loss: 0.354 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5473029613494873
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3484294414520264
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.185 Vali Acc: 0.955 Test Loss: 0.185 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.427541732788086
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.380373001098633
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.4385478496551514
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.271 Vali Acc: 0.942 Test Loss: 0.271 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.342222213745117
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.279 Vali Acc: 0.949 Test Loss: 0.279 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.4634451866149902
Epoch: 16, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.295 Vali Acc: 0.953 Test Loss: 0.295 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.697744846343994
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.216 Vali Acc: 0.962 Test Loss: 0.216 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 142772
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.427177429199219
Epoch: 1, Steps: 89 | Train Loss: 1.920 Vali Loss: 0.814 Vali Acc: 0.818 Test Loss: 0.814 Test Acc: 0.818
Validation loss decreased (inf --> -0.818237).  Saving model ...
Epoch: 2 cost time: 3.099881172180176
Epoch: 2, Steps: 89 | Train Loss: 0.575 Vali Loss: 0.449 Vali Acc: 0.868 Test Loss: 0.449 Test Acc: 0.868
Validation loss decreased (-0.818237 --> -0.868380).  Saving model ...
Epoch: 3 cost time: 3.1048974990844727
Epoch: 3, Steps: 89 | Train Loss: 0.322 Vali Loss: 0.306 Vali Acc: 0.907 Test Loss: 0.306 Test Acc: 0.907
Validation loss decreased (-0.868380 --> -0.906682).  Saving model ...
Epoch: 4 cost time: 3.2731311321258545
Epoch: 4, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.222 Vali Acc: 0.940 Test Loss: 0.222 Test Acc: 0.940
Validation loss decreased (-0.906682 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 3.1752986907958984
Epoch: 5, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
Validation loss decreased (-0.940109 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 3.2616171836853027
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.055903911590576
Epoch: 7, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4326634407043457
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2374188899993896
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.404475212097168
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
Validation loss decreased (-0.961001 --> -0.961001).  Saving model ...
Epoch: 11 cost time: 3.1918468475341797
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3451290130615234
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.961698).  Saving model ...
Epoch: 13 cost time: 3.4255497455596924
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
Validation loss decreased (-0.961698 --> -0.967965).  Saving model ...
Epoch: 14 cost time: 2.928784132003784
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.188 Vali Acc: 0.951 Test Loss: 0.188 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9788999557495117
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.236416816711426
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968661).  Saving model ...
Epoch: 17 cost time: 3.304644823074341
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.287 Vali Acc: 0.942 Test Loss: 0.287 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.152031421661377
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.210 Vali Acc: 0.954 Test Loss: 0.210 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.592503309249878
Epoch: 19, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5550613403320312
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.290 Vali Acc: 0.939 Test Loss: 0.290 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6205203533172607
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.3981807231903076
Epoch: 22, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.261 Vali Acc: 0.946 Test Loss: 0.261 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.6289730072021484
Epoch: 23, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.261 Vali Acc: 0.942 Test Loss: 0.261 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.3977415561676025
Epoch: 24, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.4796926975250244
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.70188307762146
Epoch: 26, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.656 Vali Acc: 0.864 Test Loss: 0.656 Test Acc: 0.864
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 94932
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.388436555862427
Epoch: 1, Steps: 89 | Train Loss: 2.111 Vali Loss: 0.936 Vali Acc: 0.763 Test Loss: 0.936 Test Acc: 0.763
Validation loss decreased (inf --> -0.763222).  Saving model ...
Epoch: 2 cost time: 3.2277374267578125
Epoch: 2, Steps: 89 | Train Loss: 0.659 Vali Loss: 0.444 Vali Acc: 0.870 Test Loss: 0.444 Test Acc: 0.870
Validation loss decreased (-0.763222 --> -0.870469).  Saving model ...
Epoch: 3 cost time: 3.4115636348724365
Epoch: 3, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
Validation loss decreased (-0.870469 --> -0.922003).  Saving model ...
Epoch: 4 cost time: 3.6523044109344482
Epoch: 4, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.922003 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 3.3437294960021973
Epoch: 5, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
Validation loss decreased (-0.943591 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 3.503415822982788
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.147 Vali Acc: 0.953 Test Loss: 0.147 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.329186201095581
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.954734 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 3.402874708175659
Epoch: 8, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4062464237213135
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 3.3398382663726807
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.963787 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 3.5214531421661377
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3867108821868896
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6194305419921875
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3402435779571533
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.19181489944458
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 16 cost time: 3.4228556156158447
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 3.3354053497314453
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.177 Vali Acc: 0.947 Test Loss: 0.177 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.321535110473633
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2984793186187744
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.41593074798584
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2017533779144287
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.5651440620422363
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.0357744693756104
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 24 cost time: 3.0447371006011963
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.987470865249634
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.1571168899536133
Epoch: 26, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.2472727298736572
Epoch: 27, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.1340649127960205
Epoch: 28, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.938 Test Loss: 0.223 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.972590684890747
Epoch: 29, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.9995474815368652
Epoch: 30, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.227 Vali Acc: 0.951 Test Loss: 0.227 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.966400146484375
Epoch: 31, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.216 Vali Acc: 0.962 Test Loss: 0.216 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.908930778503418
Epoch: 32, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.28043794631958
Epoch: 33, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 75860
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.280461549758911
Epoch: 1, Steps: 89 | Train Loss: 2.259 Vali Loss: 1.155 Vali Acc: 0.749 Test Loss: 1.155 Test Acc: 0.749
Validation loss decreased (inf --> -0.748596).  Saving model ...
Epoch: 2 cost time: 2.8546254634857178
Epoch: 2, Steps: 89 | Train Loss: 0.784 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
Validation loss decreased (-0.748596 --> -0.822418).  Saving model ...
Epoch: 3 cost time: 2.894078493118286
Epoch: 3, Steps: 89 | Train Loss: 0.423 Vali Loss: 0.318 Vali Acc: 0.911 Test Loss: 0.318 Test Acc: 0.911
Validation loss decreased (-0.822418 --> -0.910860).  Saving model ...
Epoch: 4 cost time: 3.0196943283081055
Epoch: 4, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.217 Vali Acc: 0.942 Test Loss: 0.217 Test Acc: 0.942
Validation loss decreased (-0.910860 --> -0.942198).  Saving model ...
Epoch: 5 cost time: 2.946059226989746
Epoch: 5, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.194 Vali Acc: 0.947 Test Loss: 0.194 Test Acc: 0.947
Validation loss decreased (-0.942198 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 3.010641098022461
Epoch: 6, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
Validation loss decreased (-0.947073 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 3.1216177940368652
Epoch: 7, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.354698896408081
Epoch: 8, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.142 Vali Acc: 0.955 Test Loss: 0.142 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2784712314605713
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.967269).  Saving model ...
Epoch: 10 cost time: 3.211690664291382
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3435511589050293
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 3.101046323776245
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.391252279281616
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.48561954498291
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 15 cost time: 3.394076108932495
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2688493728637695
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.145 Vali Acc: 0.955 Test Loss: 0.145 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.302255392074585
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.089650869369507
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 19 cost time: 2.24405574798584
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.977715).  Saving model ...
Epoch: 20 cost time: 2.1013331413269043
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9824044704437256
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.4720282554626465
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.4196255207061768
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5077569484710693
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.3636586666107178
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.189 Vali Acc: 0.953 Test Loss: 0.189 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.3924829959869385
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.4789443016052246
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.725215435028076
Epoch: 28, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.7322967052459717
Epoch: 29, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 60660
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.716789245605469
Epoch: 1, Steps: 89 | Train Loss: 2.437 Vali Loss: 1.356 Vali Acc: 0.710 Test Loss: 1.356 Test Acc: 0.710
Validation loss decreased (inf --> -0.709596).  Saving model ...
Epoch: 2 cost time: 3.6418328285217285
Epoch: 2, Steps: 89 | Train Loss: 0.940 Vali Loss: 0.575 Vali Acc: 0.860 Test Loss: 0.575 Test Acc: 0.860
Validation loss decreased (-0.709596 --> -0.860022).  Saving model ...
Epoch: 3 cost time: 3.805802822113037
Epoch: 3, Steps: 89 | Train Loss: 0.466 Vali Loss: 0.346 Vali Acc: 0.907 Test Loss: 0.346 Test Acc: 0.907
Validation loss decreased (-0.860022 --> -0.907378).  Saving model ...
Epoch: 4 cost time: 3.437878370285034
Epoch: 4, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.234 Vali Acc: 0.934 Test Loss: 0.234 Test Acc: 0.934
Validation loss decreased (-0.907378 --> -0.933842).  Saving model ...
Epoch: 5 cost time: 3.199866771697998
Epoch: 5, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (-0.933842 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 3.5702357292175293
Epoch: 6, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
Validation loss decreased (-0.951252 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 3.62365984916687
Epoch: 7, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6507372856140137
Epoch: 8, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.960305 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 3.199502468109131
Epoch: 9, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.962394 --> -0.970055).  Saving model ...
Epoch: 10 cost time: 3.5413575172424316
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
Validation loss decreased (-0.970055 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 3.430046558380127
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3652212619781494
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.288076162338257
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 3.2825615406036377
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.275003671646118
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.27264666557312
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.128152370452881
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 18 cost time: 2.713484048843384
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8480427265167236
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.914970874786377
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 21 cost time: 2.975203514099121
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8220818042755127
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8464019298553467
Epoch: 23, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.8790762424468994
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 25 cost time: 2.9779627323150635
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.517916202545166
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.029527187347412
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 28 cost time: 2.8761706352233887
Epoch: 28, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0497899055480957
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.67503023147583
Epoch: 30, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.8866491317749023
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.117300271987915
Epoch: 32, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.901517629623413
Epoch: 33, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.1528618335723877
Epoch: 34, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.244884729385376
Epoch: 35, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.434704065322876
Epoch: 36, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.3888330459594727
Epoch: 37, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 51348
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.549980640411377
Epoch: 1, Steps: 89 | Train Loss: 2.535 Vali Loss: 1.650 Vali Acc: 0.630 Test Loss: 1.650 Test Acc: 0.630
Validation loss decreased (inf --> -0.630206).  Saving model ...
Epoch: 2 cost time: 3.4035511016845703
Epoch: 2, Steps: 89 | Train Loss: 1.205 Vali Loss: 0.771 Vali Acc: 0.797 Test Loss: 0.771 Test Acc: 0.797
Validation loss decreased (-0.630206 --> -0.797346).  Saving model ...
Epoch: 3 cost time: 3.3784067630767822
Epoch: 3, Steps: 89 | Train Loss: 0.633 Vali Loss: 0.482 Vali Acc: 0.876 Test Loss: 0.482 Test Acc: 0.876
Validation loss decreased (-0.797346 --> -0.876040).  Saving model ...
Epoch: 4 cost time: 3.251960515975952
Epoch: 4, Steps: 89 | Train Loss: 0.407 Vali Loss: 0.317 Vali Acc: 0.924 Test Loss: 0.317 Test Acc: 0.924
Validation loss decreased (-0.876040 --> -0.924092).  Saving model ...
Epoch: 5 cost time: 3.4836223125457764
Epoch: 5, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.232 Vali Acc: 0.942 Test Loss: 0.232 Test Acc: 0.942
Validation loss decreased (-0.924092 --> -0.942198).  Saving model ...
Epoch: 6 cost time: 3.302143096923828
Epoch: 6, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
Validation loss decreased (-0.942198 --> -0.951251).  Saving model ...
Epoch: 7 cost time: 3.4619767665863037
Epoch: 7, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2687323093414307
Epoch: 8, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
Validation loss decreased (-0.951251 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 3.2541024684906006
Epoch: 9, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.960305 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 3.3301026821136475
Epoch: 10, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 3.3274478912353516
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.130 Vali Acc: 0.961 Test Loss: 0.130 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.58492112159729
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 13 cost time: 3.162304162979126
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2543654441833496
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974233).  Saving model ...
Epoch: 15 cost time: 3.2408037185668945
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2748091220855713
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 17 cost time: 3.2206356525421143
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.980500).  Saving model ...
Epoch: 18 cost time: 3.2833805084228516
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.252810001373291
Epoch: 19, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1983892917633057
Epoch: 20, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.355846643447876
Epoch: 21, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.983286).  Saving model ...
Epoch: 22 cost time: 3.307513475418091
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5003867149353027
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7790207862854004
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.9515247344970703
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.0704879760742188
Epoch: 26, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1128714084625244
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.119917154312134
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.972701072692871
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.0492138862609863
Epoch: 30, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.9788050651550293
Epoch: 31, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 43956
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.327220678329468
Epoch: 1, Steps: 89 | Train Loss: 2.601 Vali Loss: 1.789 Vali Acc: 0.621 Test Loss: 1.789 Test Acc: 0.621
Validation loss decreased (inf --> -0.621152).  Saving model ...
Epoch: 2 cost time: 2.6214799880981445
Epoch: 2, Steps: 89 | Train Loss: 1.339 Vali Loss: 0.850 Vali Acc: 0.812 Test Loss: 0.850 Test Acc: 0.812
Validation loss decreased (-0.621152 --> -0.811969).  Saving model ...
Epoch: 3 cost time: 2.7554752826690674
Epoch: 3, Steps: 89 | Train Loss: 0.700 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
Validation loss decreased (-0.811969 --> -0.855844).  Saving model ...
Epoch: 4 cost time: 2.626863718032837
Epoch: 4, Steps: 89 | Train Loss: 0.472 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
Validation loss decreased (-0.855844 --> -0.899718).  Saving model ...
Epoch: 5 cost time: 2.9472029209136963
Epoch: 5, Steps: 89 | Train Loss: 0.342 Vali Loss: 0.308 Vali Acc: 0.916 Test Loss: 0.308 Test Acc: 0.916
Validation loss decreased (-0.899718 --> -0.915735).  Saving model ...
Epoch: 6 cost time: 2.8630120754241943
Epoch: 6, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.234 Vali Acc: 0.940 Test Loss: 0.234 Test Acc: 0.940
Validation loss decreased (-0.915735 --> -0.940109).  Saving model ...
Epoch: 7 cost time: 3.5186736583709717
Epoch: 7, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
Validation loss decreased (-0.940109 --> -0.952644).  Saving model ...
Epoch: 8 cost time: 3.145408868789673
Epoch: 8, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.952644 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 3.1805624961853027
Epoch: 9, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2724781036376953
Epoch: 10, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 3.1382181644439697
Epoch: 11, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.963787 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 3.334791660308838
Epoch: 12, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0834410190582275
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.398313045501709
Epoch: 14, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2465779781341553
Epoch: 15, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.130409002304077
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.977715).  Saving model ...
Epoch: 17 cost time: 3.2391650676727295
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3434441089630127
Epoch: 18, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.393892765045166
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 3.34656023979187
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4240939617156982
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1948771476745605
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.4891197681427
Epoch: 23, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.2959213256835938
Epoch: 24, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.4194865226745605
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.279857635498047
Epoch: 26, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.122 Vali Acc: 0.960 Test Loss: 0.122 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.2030694484710693
Epoch: 27, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 28 cost time: 3.2725729942321777
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1541154384613037
Epoch: 29, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 30 cost time: 3.3274431228637695
Epoch: 30, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.980501).  Saving model ...
Epoch: 31 cost time: 3.0754613876342773
Epoch: 31, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.2349600791931152
Epoch: 32, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.982590).  Saving model ...
Epoch: 33 cost time: 2.6540937423706055
Epoch: 33, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.8013734817504883
Epoch: 34, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.858506441116333
Epoch: 35, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.824956178665161
Epoch: 36, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.9351797103881836
Epoch: 37, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.8316025733947754
Epoch: 38, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.848189115524292
Epoch: 39, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.7642083168029785
Epoch: 40, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.675053119659424
Epoch: 41, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.828392267227173
Epoch: 42, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 40404
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9568066596984863
Epoch: 1, Steps: 89 | Train Loss: 1.577 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
Validation loss decreased (inf --> -0.822417).  Saving model ...
Epoch: 2 cost time: 2.8537960052490234
Epoch: 2, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.346 Vali Acc: 0.895 Test Loss: 0.346 Test Acc: 0.895
Validation loss decreased (-0.822417 --> -0.894843).  Saving model ...
Epoch: 3 cost time: 2.930309534072876
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.342 Vali Acc: 0.902 Test Loss: 0.342 Test Acc: 0.902
Validation loss decreased (-0.894843 --> -0.901807).  Saving model ...
Epoch: 4 cost time: 2.885782241821289
Epoch: 4, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
Validation loss decreased (-0.901807 --> -0.942895).  Saving model ...
Epoch: 5 cost time: 3.2403666973114014
Epoch: 5, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.942895 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 3.4205880165100098
Epoch: 6, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
Validation loss decreased (-0.951948 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 3.5116522312164307
Epoch: 7, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3750076293945312
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.192 Vali Acc: 0.955 Test Loss: 0.192 Test Acc: 0.955
Validation loss decreased (-0.952644 --> -0.954733).  Saving model ...
Epoch: 9 cost time: 3.3973612785339355
Epoch: 9, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.247 Vali Acc: 0.942 Test Loss: 0.247 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4789540767669678
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
Validation loss decreased (-0.954733 --> -0.961001).  Saving model ...
Epoch: 11 cost time: 3.514301061630249
Epoch: 11, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.525 Vali Acc: 0.893 Test Loss: 0.525 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6772851943969727
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
Validation loss decreased (-0.961001 --> -0.968661).  Saving model ...
Epoch: 13 cost time: 3.5580592155456543
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
Validation loss decreased (-0.968661 --> -0.974233).  Saving model ...
Epoch: 14 cost time: 3.469947576522827
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.199 Vali Acc: 0.962 Test Loss: 0.199 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2774879932403564
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.315 Vali Acc: 0.939 Test Loss: 0.315 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3739781379699707
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.660656452178955
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.178 Vali Acc: 0.970 Test Loss: 0.178 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6539227962493896
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.5523130893707275
Epoch: 19, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.264 Vali Acc: 0.953 Test Loss: 0.264 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.590134620666504
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.221 Vali Acc: 0.966 Test Loss: 0.221 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.4717628955841064
Epoch: 21, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5702080726623535
Epoch: 22, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.244 Vali Acc: 0.962 Test Loss: 0.244 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1261496543884277
Epoch: 23, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.229 Vali Acc: 0.969 Test Loss: 0.229 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 134452
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.826420545578003
Epoch: 1, Steps: 89 | Train Loss: 1.998 Vali Loss: 0.836 Vali Acc: 0.819 Test Loss: 0.836 Test Acc: 0.819
Validation loss decreased (inf --> -0.818933).  Saving model ...
Epoch: 2 cost time: 3.2387912273406982
Epoch: 2, Steps: 89 | Train Loss: 0.611 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
Validation loss decreased (-0.818933 --> -0.869773).  Saving model ...
Epoch: 3 cost time: 3.325881004333496
Epoch: 3, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.308 Vali Acc: 0.920 Test Loss: 0.308 Test Acc: 0.920
Validation loss decreased (-0.869773 --> -0.919913).  Saving model ...
Epoch: 4 cost time: 3.370866537094116
Epoch: 4, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
Validation loss decreased (-0.919913 --> -0.925485).  Saving model ...
Epoch: 5 cost time: 3.303671360015869
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.925485 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 3.3850669860839844
Epoch: 6, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.164 Vali Acc: 0.953 Test Loss: 0.164 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1342244148254395
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3924918174743652
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.186 Vali Acc: 0.945 Test Loss: 0.186 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.980003595352173
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.266 Vali Acc: 0.916 Test Loss: 0.266 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.064443588256836
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 3.037473201751709
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.912475347518921
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.011232852935791
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.966581344604492
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.9459612369537354
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.966572).  Saving model ...
Epoch: 16 cost time: 2.7397818565368652
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8407278060913086
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.324 Vali Acc: 0.930 Test Loss: 0.324 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9308345317840576
Epoch: 18, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.181 Vali Acc: 0.961 Test Loss: 0.181 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9078779220581055
Epoch: 19, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.227 Vali Acc: 0.962 Test Loss: 0.227 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.8943326473236084
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.968661).  Saving model ...
Epoch: 21 cost time: 2.962670087814331
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.302 Vali Acc: 0.934 Test Loss: 0.302 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0069117546081543
Epoch: 22, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.217 Vali Acc: 0.951 Test Loss: 0.217 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0287528038024902
Epoch: 23, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.289 Vali Acc: 0.932 Test Loss: 0.289 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.9887733459472656
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.964 Test Loss: 0.195 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.451462507247925
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.161 Vali Acc: 0.966 Test Loss: 0.161 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.161350727081299
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.4275026321411133
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.318 Vali Acc: 0.942 Test Loss: 0.318 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.263317108154297
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.964 Test Loss: 0.205 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.3287806510925293
Epoch: 29, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.308 Vali Acc: 0.937 Test Loss: 0.308 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.440901279449463
Epoch: 30, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.246 Vali Acc: 0.959 Test Loss: 0.246 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 86612
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.508808135986328
Epoch: 1, Steps: 89 | Train Loss: 2.135 Vali Loss: 0.939 Vali Acc: 0.768 Test Loss: 0.939 Test Acc: 0.768
Validation loss decreased (inf --> -0.768096).  Saving model ...
Epoch: 2 cost time: 3.3397216796875
Epoch: 2, Steps: 89 | Train Loss: 0.644 Vali Loss: 0.481 Vali Acc: 0.854 Test Loss: 0.481 Test Acc: 0.854
Validation loss decreased (-0.768096 --> -0.853756).  Saving model ...
Epoch: 3 cost time: 3.375894784927368
Epoch: 3, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
Validation loss decreased (-0.853756 --> -0.918521).  Saving model ...
Epoch: 4 cost time: 3.4143309593200684
Epoch: 4, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.918521 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 3.377797842025757
Epoch: 5, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
Validation loss decreased (-0.947770 --> -0.949859).  Saving model ...
Epoch: 6 cost time: 3.38875675201416
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.949859 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 3.307246685028076
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.338212728500366
Epoch: 8, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.163 Vali Acc: 0.938 Test Loss: 0.163 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2502281665802
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.958912 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 3.490689992904663
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3047006130218506
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.457404136657715
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2609684467315674
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.385348081588745
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.294790029525757
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2603297233581543
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.2483150959014893
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.9971704483032227
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.322190284729004
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 67540
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.207229137420654
Epoch: 1, Steps: 89 | Train Loss: 2.295 Vali Loss: 1.168 Vali Acc: 0.762 Test Loss: 1.168 Test Acc: 0.762
Validation loss decreased (inf --> -0.761827).  Saving model ...
Epoch: 2 cost time: 2.7591030597686768
Epoch: 2, Steps: 89 | Train Loss: 0.809 Vali Loss: 0.535 Vali Acc: 0.864 Test Loss: 0.535 Test Acc: 0.864
Validation loss decreased (-0.761827 --> -0.863504).  Saving model ...
Epoch: 3 cost time: 2.8479042053222656
Epoch: 3, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
Validation loss decreased (-0.863504 --> -0.918520).  Saving model ...
Epoch: 4 cost time: 2.8691399097442627
Epoch: 4, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.235 Vali Acc: 0.940 Test Loss: 0.235 Test Acc: 0.940
Validation loss decreased (-0.918520 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 2.7506611347198486
Epoch: 5, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
Validation loss decreased (-0.940109 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 2.784528970718384
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
Validation loss decreased (-0.942895 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 2.7631728649139404
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.784017324447632
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.966572).  Saving model ...
Epoch: 9 cost time: 2.7733614444732666
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7250285148620605
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.133 Vali Acc: 0.958 Test Loss: 0.133 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7538554668426514
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.77730131149292
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.966572 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 2.7325000762939453
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 14 cost time: 2.7198245525360107
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8297030925750732
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.566195011138916
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.251720428466797
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.973537 --> -0.979108).  Saving model ...
Epoch: 18 cost time: 3.0597763061523438
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.177532911300659
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2560648918151855
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.305100917816162
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.318535804748535
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.255182981491089
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.298901081085205
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.1924188137054443
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 26 cost time: 3.3410720825195312
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.293649435043335
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3300728797912598
Epoch: 28, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.164506196975708
Epoch: 29, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.152 Vali Acc: 0.961 Test Loss: 0.152 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.3880414962768555
Epoch: 30, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.3179075717926025
Epoch: 31, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.3890628814697266
Epoch: 32, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.4289941787719727
Epoch: 33, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.3956308364868164
Epoch: 34, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.335360288619995
Epoch: 35, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.233 Vali Acc: 0.954 Test Loss: 0.233 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 52340
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.518449306488037
Epoch: 1, Steps: 89 | Train Loss: 2.524 Vali Loss: 1.493 Vali Acc: 0.692 Test Loss: 1.493 Test Acc: 0.692
Validation loss decreased (inf --> -0.691489).  Saving model ...
Epoch: 2 cost time: 3.314282178878784
Epoch: 2, Steps: 89 | Train Loss: 1.033 Vali Loss: 0.642 Vali Acc: 0.840 Test Loss: 0.642 Test Acc: 0.840
Validation loss decreased (-0.691489 --> -0.839826).  Saving model ...
Epoch: 3 cost time: 3.183192729949951
Epoch: 3, Steps: 89 | Train Loss: 0.506 Vali Loss: 0.395 Vali Acc: 0.893 Test Loss: 0.395 Test Acc: 0.893
Validation loss decreased (-0.839826 --> -0.893450).  Saving model ...
Epoch: 4 cost time: 3.248307704925537
Epoch: 4, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.244 Vali Acc: 0.943 Test Loss: 0.244 Test Acc: 0.943
Validation loss decreased (-0.893450 --> -0.942894).  Saving model ...
Epoch: 5 cost time: 3.1721999645233154
Epoch: 5, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.220 Vali Acc: 0.939 Test Loss: 0.220 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9555776119232178
Epoch: 6, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
Validation loss decreased (-0.942894 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 2.71816349029541
Epoch: 7, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
Validation loss decreased (-0.955430 --> -0.966572).  Saving model ...
Epoch: 8 cost time: 3.0468192100524902
Epoch: 8, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 2.9647769927978516
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9031314849853516
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 2.93532657623291
Epoch: 11, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.970751 --> -0.974929).  Saving model ...
Epoch: 12 cost time: 2.9204912185668945
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.111 Vali Acc: 0.963 Test Loss: 0.111 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.868861436843872
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 2.8583977222442627
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0757827758789062
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 16 cost time: 2.9149410724639893
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0186376571655273
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.866816282272339
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.8163845539093018
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.87195086479187
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.866403102874756
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.494119167327881
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.1227805614471436
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.4581048488616943
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.373110771179199
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 43028
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.437089920043945
Epoch: 1, Steps: 89 | Train Loss: 2.691 Vali Loss: 1.696 Vali Acc: 0.671 Test Loss: 1.696 Test Acc: 0.671
Validation loss decreased (inf --> -0.671292).  Saving model ...
Epoch: 2 cost time: 3.5772573947906494
Epoch: 2, Steps: 89 | Train Loss: 1.234 Vali Loss: 0.775 Vali Acc: 0.802 Test Loss: 0.775 Test Acc: 0.802
Validation loss decreased (-0.671292 --> -0.801524).  Saving model ...
Epoch: 3 cost time: 3.5059237480163574
Epoch: 3, Steps: 89 | Train Loss: 0.641 Vali Loss: 0.477 Vali Acc: 0.887 Test Loss: 0.477 Test Acc: 0.887
Validation loss decreased (-0.801524 --> -0.887182).  Saving model ...
Epoch: 4 cost time: 3.5114283561706543
Epoch: 4, Steps: 89 | Train Loss: 0.419 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
Validation loss decreased (-0.887182 --> -0.899718).  Saving model ...
Epoch: 5 cost time: 3.957918882369995
Epoch: 5, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.234 Vali Acc: 0.942 Test Loss: 0.234 Test Acc: 0.942
Validation loss decreased (-0.899718 --> -0.942198).  Saving model ...
Epoch: 6 cost time: 3.5098648071289062
Epoch: 6, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
Validation loss decreased (-0.942198 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 3.5988364219665527
Epoch: 7, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.960305).  Saving model ...
Epoch: 8 cost time: 4.054704189300537
Epoch: 8, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.960305 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 3.619677782058716
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4808971881866455
Epoch: 10, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 3.7268457412719727
Epoch: 11, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
Validation loss decreased (-0.970055 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 3.3512167930603027
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3211653232574463
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 14 cost time: 3.979532241821289
Epoch: 14, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974233).  Saving model ...
Epoch: 15 cost time: 3.439584732055664
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 16 cost time: 3.748843193054199
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 17 cost time: 3.8626716136932373
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 18 cost time: 3.5526392459869385
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.829012632369995
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6083593368530273
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.616328239440918
Epoch: 21, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.802284002304077
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.1620569229125977
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.1708486080169678
Epoch: 24, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.5205321311950684
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.0836687088012695
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.283849000930786
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 35636
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.7562761306762695
Epoch: 1, Steps: 89 | Train Loss: 2.635 Vali Loss: 1.815 Vali Acc: 0.627 Test Loss: 1.815 Test Acc: 0.627
Validation loss decreased (inf --> -0.626723).  Saving model ...
Epoch: 2 cost time: 2.9358322620391846
Epoch: 2, Steps: 89 | Train Loss: 1.355 Vali Loss: 0.837 Vali Acc: 0.816 Test Loss: 0.837 Test Acc: 0.816
Validation loss decreased (-0.626723 --> -0.816148).  Saving model ...
Epoch: 3 cost time: 3.100369930267334
Epoch: 3, Steps: 89 | Train Loss: 0.707 Vali Loss: 0.526 Vali Acc: 0.877 Test Loss: 0.526 Test Acc: 0.877
Validation loss decreased (-0.816148 --> -0.876736).  Saving model ...
Epoch: 4 cost time: 3.2937979698181152
Epoch: 4, Steps: 89 | Train Loss: 0.464 Vali Loss: 0.371 Vali Acc: 0.909 Test Loss: 0.371 Test Acc: 0.909
Validation loss decreased (-0.876736 --> -0.908771).  Saving model ...
Epoch: 5 cost time: 3.053912878036499
Epoch: 5, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.270 Vali Acc: 0.930 Test Loss: 0.270 Test Acc: 0.930
Validation loss decreased (-0.908771 --> -0.930359).  Saving model ...
Epoch: 6 cost time: 2.989135503768921
Epoch: 6, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
Validation loss decreased (-0.930359 --> -0.949162).  Saving model ...
Epoch: 7 cost time: 3.3791067600250244
Epoch: 7, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.949162 --> -0.958215).  Saving model ...
Epoch: 8 cost time: 3.1410398483276367
Epoch: 8, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.348043203353882
Epoch: 9, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.958215 --> -0.965180).  Saving model ...
Epoch: 10 cost time: 3.3781683444976807
Epoch: 10, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 2.769287109375
Epoch: 11, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 3.8006155490875244
Epoch: 12, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 3.7013461589813232
Epoch: 13, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 3.4059553146362305
Epoch: 14, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 3.812718629837036
Epoch: 15, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 16 cost time: 3.485966920852661
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4643373489379883
Epoch: 17, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.977715 --> -0.981893).  Saving model ...
Epoch: 18 cost time: 3.806452512741089
Epoch: 18, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5060698986053467
Epoch: 19, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.523911237716675
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.094 Vali Acc: 0.967 Test Loss: 0.094 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.7703840732574463
Epoch: 21, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.5802102088928223
Epoch: 22, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.40958309173584
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.9285390377044678
Epoch: 24, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 25 cost time: 3.4866387844085693
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5555591583251953
Epoch: 26, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.673105001449585
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5236294269561768
Epoch: 28, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.6192431449890137
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.719419002532959
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.2045812606811523
Epoch: 31, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.7826201915740967
Epoch: 32, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.457335948944092
Epoch: 33, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.431929349899292
Epoch: 34, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm32_nh4_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 32084
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.947675466537476
Epoch: 1, Steps: 89 | Train Loss: 1.990 Vali Loss: 0.818 Vali Acc: 0.806 Test Loss: 0.818 Test Acc: 0.806
Validation loss decreased (inf --> -0.806399).  Saving model ...
Epoch: 2 cost time: 3.7062582969665527
Epoch: 2, Steps: 89 | Train Loss: 0.589 Vali Loss: 0.422 Vali Acc: 0.880 Test Loss: 0.422 Test Acc: 0.880
Validation loss decreased (-0.806399 --> -0.879522).  Saving model ...
Epoch: 3 cost time: 3.60245943069458
Epoch: 3, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.275 Vali Acc: 0.913 Test Loss: 0.275 Test Acc: 0.913
Validation loss decreased (-0.879522 --> -0.912950).  Saving model ...
Epoch: 4 cost time: 2.9787657260894775
Epoch: 4, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.250 Vali Acc: 0.923 Test Loss: 0.250 Test Acc: 0.923
Validation loss decreased (-0.912950 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 3.5557773113250732
Epoch: 5, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
Validation loss decreased (-0.922699 --> -0.935235).  Saving model ...
Epoch: 6 cost time: 2.9577276706695557
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
Validation loss decreased (-0.935235 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 3.0752663612365723
Epoch: 7, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
Validation loss decreased (-0.952644 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 3.0721652507781982
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6251513957977295
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.613374948501587
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.224 Vali Acc: 0.939 Test Loss: 0.224 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.939122200012207
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 2.394853115081787
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8726844787597656
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.609171152114868
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9248411655426025
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.817000150680542
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.8772165775299072
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.8289716243743896
Epoch: 18, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.8579046726226807
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.7993216514587402
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.448174476623535
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 77924
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.6088738441467285
Epoch: 1, Steps: 89 | Train Loss: 2.343 Vali Loss: 1.222 Vali Acc: 0.737 Test Loss: 1.222 Test Acc: 0.737
Validation loss decreased (inf --> -0.737453).  Saving model ...
Epoch: 2 cost time: 3.1492714881896973
Epoch: 2, Steps: 89 | Train Loss: 0.834 Vali Loss: 0.545 Vali Acc: 0.866 Test Loss: 0.545 Test Acc: 0.866
Validation loss decreased (-0.737453 --> -0.865593).  Saving model ...
Epoch: 3 cost time: 3.3348605632781982
Epoch: 3, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.366 Vali Acc: 0.893 Test Loss: 0.366 Test Acc: 0.893
Validation loss decreased (-0.865593 --> -0.892754).  Saving model ...
Epoch: 4 cost time: 3.2234790325164795
Epoch: 4, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.892754 --> -0.917128).  Saving model ...
Epoch: 5 cost time: 3.3737547397613525
Epoch: 5, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.917128 --> -0.947770).  Saving model ...
Epoch: 6 cost time: 3.2316534519195557
Epoch: 6, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.947770 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 3.3923094272613525
Epoch: 7, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.960305).  Saving model ...
Epoch: 8 cost time: 3.2581286430358887
Epoch: 8, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
Validation loss decreased (-0.960305 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 3.354860305786133
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.435546398162842
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.133 Vali Acc: 0.961 Test Loss: 0.133 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1926169395446777
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 3.317620277404785
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.241271734237671
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.29500412940979
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.134246826171875
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2842230796813965
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2660953998565674
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.2648611068725586
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.196195602416992
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 20 cost time: 3.191204071044922
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.071920156478882
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 22 cost time: 3.1471316814422607
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9742350578308105
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1790499687194824
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.108808755874634
Epoch: 25, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.132589101791382
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.99741792678833
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.0705244541168213
Epoch: 28, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.188 Vali Acc: 0.951 Test Loss: 0.188 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.0958120822906494
Epoch: 29, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.234 Vali Acc: 0.946 Test Loss: 0.234 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.119191884994507
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.083064079284668
Epoch: 31, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 54004
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.421309232711792
Epoch: 1, Steps: 89 | Train Loss: 2.512 Vali Loss: 1.474 Vali Acc: 0.720 Test Loss: 1.474 Test Acc: 0.720
Validation loss decreased (inf --> -0.720041).  Saving model ...
Epoch: 2 cost time: 3.0695316791534424
Epoch: 2, Steps: 89 | Train Loss: 0.994 Vali Loss: 0.627 Vali Acc: 0.851 Test Loss: 0.627 Test Acc: 0.851
Validation loss decreased (-0.720041 --> -0.850969).  Saving model ...
Epoch: 3 cost time: 3.0858590602874756
Epoch: 3, Steps: 89 | Train Loss: 0.503 Vali Loss: 0.396 Vali Acc: 0.891 Test Loss: 0.396 Test Acc: 0.891
Validation loss decreased (-0.850969 --> -0.891361).  Saving model ...
Epoch: 4 cost time: 2.986345052719116
Epoch: 4, Steps: 89 | Train Loss: 0.338 Vali Loss: 0.324 Vali Acc: 0.901 Test Loss: 0.324 Test Acc: 0.901
Validation loss decreased (-0.891361 --> -0.901111).  Saving model ...
Epoch: 5 cost time: 2.7950000762939453
Epoch: 5, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.901111 --> -0.944288).  Saving model ...
Epoch: 6 cost time: 3.4445040225982666
Epoch: 6, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.168 Vali Acc: 0.964 Test Loss: 0.168 Test Acc: 0.964
Validation loss decreased (-0.944288 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 3.4631059169769287
Epoch: 7, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.201357126235962
Epoch: 8, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4225897789001465
Epoch: 9, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 3.3600618839263916
Epoch: 10, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.324799060821533
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.132 Vali Acc: 0.960 Test Loss: 0.132 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4211504459381104
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4906628131866455
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 14 cost time: 3.28889536857605
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 3.4165172576904297
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3531696796417236
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3097915649414062
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.3755784034729004
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.462653636932373
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.409900426864624
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.386888027191162
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.148 Vali Acc: 0.950 Test Loss: 0.148 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.3985798358917236
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.3404080867767334
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.977019 --> -0.977019).  Saving model ...
Epoch: 24 cost time: 3.314608573913574
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.170962333679199
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3075156211853027
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.4523022174835205
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.1809709072113037
Epoch: 28, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.327798843383789
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.398432731628418
Epoch: 30, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.975996255874634
Epoch: 31, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.9581427574157715
Epoch: 32, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.1178135871887207
Epoch: 33, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 44468
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.224881887435913
Epoch: 1, Steps: 89 | Train Loss: 2.602 Vali Loss: 1.715 Vali Acc: 0.670 Test Loss: 1.715 Test Acc: 0.670
Validation loss decreased (inf --> -0.669899).  Saving model ...
Epoch: 2 cost time: 2.5281357765197754
Epoch: 2, Steps: 89 | Train Loss: 1.207 Vali Loss: 0.730 Vali Acc: 0.838 Test Loss: 0.730 Test Acc: 0.838
Validation loss decreased (-0.669899 --> -0.838433).  Saving model ...
Epoch: 3 cost time: 2.879098653793335
Epoch: 3, Steps: 89 | Train Loss: 0.596 Vali Loss: 0.456 Vali Acc: 0.891 Test Loss: 0.456 Test Acc: 0.891
Validation loss decreased (-0.838433 --> -0.891360).  Saving model ...
Epoch: 4 cost time: 2.7848763465881348
Epoch: 4, Steps: 89 | Train Loss: 0.392 Vali Loss: 0.337 Vali Acc: 0.909 Test Loss: 0.337 Test Acc: 0.909
Validation loss decreased (-0.891360 --> -0.909467).  Saving model ...
Epoch: 5 cost time: 2.6753199100494385
Epoch: 5, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.260 Vali Acc: 0.923 Test Loss: 0.260 Test Acc: 0.923
Validation loss decreased (-0.909467 --> -0.923396).  Saving model ...
Epoch: 6 cost time: 2.8825037479400635
Epoch: 6, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.217 Vali Acc: 0.939 Test Loss: 0.217 Test Acc: 0.939
Validation loss decreased (-0.923396 --> -0.938716).  Saving model ...
Epoch: 7 cost time: 2.9464330673217773
Epoch: 7, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
Validation loss decreased (-0.938716 --> -0.951948).  Saving model ...
Epoch: 8 cost time: 2.580240249633789
Epoch: 8, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.951948 --> -0.956126).  Saving model ...
Epoch: 9 cost time: 2.929908037185669
Epoch: 9, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.158 Vali Acc: 0.952 Test Loss: 0.158 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8971383571624756
Epoch: 10, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.956126 --> -0.962394).  Saving model ...
Epoch: 11 cost time: 2.7645490169525146
Epoch: 11, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9168150424957275
Epoch: 12, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.968662).  Saving model ...
Epoch: 13 cost time: 3.4148693084716797
Epoch: 13, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1709837913513184
Epoch: 14, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5199851989746094
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2082033157348633
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.1930902004241943
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 18 cost time: 3.0043468475341797
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.051586627960205
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (-0.969358 --> -0.972144).  Saving model ...
Epoch: 20 cost time: 3.2179625034332275
Epoch: 20, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4135844707489014
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 22 cost time: 3.2453460693359375
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.408137559890747
Epoch: 23, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5212948322296143
Epoch: 24, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.3238821029663086
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.603484869003296
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.385859727859497
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.129878282546997
Epoch: 28, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.2400319576263428
Epoch: 29, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.415712594985962
Epoch: 30, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.973537).  Saving model ...
Epoch: 31 cost time: 3.170206308364868
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.227508068084717
Epoch: 32, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.400503158569336
Epoch: 33, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.2640395164489746
Epoch: 34, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.3552231788635254
Epoch: 35, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.2595818042755127
Epoch: 36, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.166877508163452
Epoch: 37, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.7920002937316895
Epoch: 38, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.7304461002349854
Epoch: 39, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.8000802993774414
Epoch: 40, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 36868
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.115426301956177
Epoch: 1, Steps: 89 | Train Loss: 2.793 Vali Loss: 2.023 Vali Acc: 0.593 Test Loss: 2.023 Test Acc: 0.593
Validation loss decreased (inf --> -0.592598).  Saving model ...
Epoch: 2 cost time: 2.899657726287842
Epoch: 2, Steps: 89 | Train Loss: 1.507 Vali Loss: 0.898 Vali Acc: 0.772 Test Loss: 0.898 Test Acc: 0.772
Validation loss decreased (-0.592598 --> -0.771579).  Saving model ...
Epoch: 3 cost time: 2.8605265617370605
Epoch: 3, Steps: 89 | Train Loss: 0.740 Vali Loss: 0.540 Vali Acc: 0.880 Test Loss: 0.540 Test Acc: 0.880
Validation loss decreased (-0.771579 --> -0.879521).  Saving model ...
Epoch: 4 cost time: 2.569730043411255
Epoch: 4, Steps: 89 | Train Loss: 0.484 Vali Loss: 0.405 Vali Acc: 0.894 Test Loss: 0.405 Test Acc: 0.894
Validation loss decreased (-0.879521 --> -0.894146).  Saving model ...
Epoch: 5 cost time: 2.8792927265167236
Epoch: 5, Steps: 89 | Train Loss: 0.353 Vali Loss: 0.299 Vali Acc: 0.923 Test Loss: 0.299 Test Acc: 0.923
Validation loss decreased (-0.894146 --> -0.922699).  Saving model ...
Epoch: 6 cost time: 2.946737766265869
Epoch: 6, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.235 Vali Acc: 0.942 Test Loss: 0.235 Test Acc: 0.942
Validation loss decreased (-0.922699 --> -0.942198).  Saving model ...
Epoch: 7 cost time: 2.973825216293335
Epoch: 7, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.942198 --> -0.943591).  Saving model ...
Epoch: 8 cost time: 2.938612461090088
Epoch: 8, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
Validation loss decreased (-0.943591 --> -0.949162).  Saving model ...
Epoch: 9 cost time: 3.0956408977508545
Epoch: 9, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.872507095336914
Epoch: 10, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
Validation loss decreased (-0.949162 --> -0.961001).  Saving model ...
Epoch: 11 cost time: 2.8355441093444824
Epoch: 11, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.963787).  Saving model ...
Epoch: 12 cost time: 2.9323081970214844
Epoch: 12, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 3.3167455196380615
Epoch: 13, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.215221643447876
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3635270595550537
Epoch: 15, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.205355644226074
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 17 cost time: 3.2604942321777344
Epoch: 17, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3727340698242188
Epoch: 18, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.098 Vali Acc: 0.969 Test Loss: 0.098 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1639692783355713
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.4541664123535156
Epoch: 20, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 21 cost time: 3.3837363719940186
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2206106185913086
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.095 Vali Acc: 0.967 Test Loss: 0.095 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.408907413482666
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3095011711120605
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.2610440254211426
Epoch: 25, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.3323159217834473
Epoch: 26, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 27 cost time: 3.3762660026550293
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3150970935821533
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.475616931915283
Epoch: 29, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 30 cost time: 3.4008944034576416
Epoch: 30, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3152008056640625
Epoch: 31, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.333031177520752
Epoch: 32, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 33 cost time: 3.245694875717163
Epoch: 33, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.3494062423706055
Epoch: 34, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.3547780513763428
Epoch: 35, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.195185899734497
Epoch: 36, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.9452383518218994
Epoch: 37, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.8447659015655518
Epoch: 38, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.9829437732696533
Epoch: 39, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.953714370727539
Epoch: 40, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.023188352584839
Epoch: 41, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.629624605178833
Epoch: 42, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 32212
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.827708959579468
Epoch: 1, Steps: 89 | Train Loss: 2.856 Vali Loss: 2.242 Vali Acc: 0.448 Test Loss: 2.242 Test Acc: 0.448
Validation loss decreased (inf --> -0.448446).  Saving model ...
Epoch: 2 cost time: 2.9693360328674316
Epoch: 2, Steps: 89 | Train Loss: 1.771 Vali Loss: 1.190 Vali Acc: 0.753 Test Loss: 1.190 Test Acc: 0.753
Validation loss decreased (-0.448446 --> -0.753470).  Saving model ...
Epoch: 3 cost time: 3.074162483215332
Epoch: 3, Steps: 89 | Train Loss: 0.966 Vali Loss: 0.706 Vali Acc: 0.848 Test Loss: 0.706 Test Acc: 0.848
Validation loss decreased (-0.753470 --> -0.848182).  Saving model ...
Epoch: 4 cost time: 3.240429639816284
Epoch: 4, Steps: 89 | Train Loss: 0.631 Vali Loss: 0.499 Vali Acc: 0.883 Test Loss: 0.499 Test Acc: 0.883
Validation loss decreased (-0.848182 --> -0.883003).  Saving model ...
Epoch: 5 cost time: 3.147740602493286
Epoch: 5, Steps: 89 | Train Loss: 0.458 Vali Loss: 0.378 Vali Acc: 0.908 Test Loss: 0.378 Test Acc: 0.908
Validation loss decreased (-0.883003 --> -0.908074).  Saving model ...
Epoch: 6 cost time: 2.8123834133148193
Epoch: 6, Steps: 89 | Train Loss: 0.365 Vali Loss: 0.318 Vali Acc: 0.919 Test Loss: 0.318 Test Acc: 0.919
Validation loss decreased (-0.908074 --> -0.919217).  Saving model ...
Epoch: 7 cost time: 3.271919012069702
Epoch: 7, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
Validation loss decreased (-0.919217 --> -0.934538).  Saving model ...
Epoch: 8 cost time: 3.2606585025787354
Epoch: 8, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.934538 --> -0.944287).  Saving model ...
Epoch: 9 cost time: 3.4570276737213135
Epoch: 9, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.189 Vali Acc: 0.953 Test Loss: 0.189 Test Acc: 0.953
Validation loss decreased (-0.944287 --> -0.953341).  Saving model ...
Epoch: 10 cost time: 3.8690152168273926
Epoch: 10, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.780327320098877
Epoch: 11, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
Validation loss decreased (-0.953341 --> -0.958912).  Saving model ...
Epoch: 12 cost time: 3.532323122024536
Epoch: 12, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.963787).  Saving model ...
Epoch: 13 cost time: 3.4336507320404053
Epoch: 13, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.905548572540283
Epoch: 14, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.967269).  Saving model ...
Epoch: 15 cost time: 3.6494054794311523
Epoch: 15, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
Validation loss decreased (-0.967269 --> -0.967269).  Saving model ...
Epoch: 16 cost time: 3.5143611431121826
Epoch: 16, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.967269 --> -0.971447).  Saving model ...
Epoch: 17 cost time: 3.705683946609497
Epoch: 17, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.909231662750244
Epoch: 18, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.447951316833496
Epoch: 19, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.737032175064087
Epoch: 20, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 21 cost time: 3.8739259243011475
Epoch: 21, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7643072605133057
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.459419012069702
Epoch: 23, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.6585490703582764
Epoch: 24, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.826338291168213
Epoch: 25, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.6677794456481934
Epoch: 26, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.776203155517578
Epoch: 27, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.974929 --> -0.974930).  Saving model ...
Epoch: 28 cost time: 3.852037191390991
Epoch: 28, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4450266361236572
Epoch: 29, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.6829333305358887
Epoch: 30, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.7008209228515625
Epoch: 31, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.6063976287841797
Epoch: 32, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
Validation loss decreased (-0.974930 --> -0.974930).  Saving model ...
Epoch: 33 cost time: 3.6569254398345947
Epoch: 33, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.589533805847168
Epoch: 34, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.8288190364837646
Epoch: 35, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.2820634841918945
Epoch: 36, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.974930 --> -0.976322).  Saving model ...
Epoch: 37 cost time: 3.4494287967681885
Epoch: 37, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.981197).  Saving model ...
Epoch: 38 cost time: 3.2128593921661377
Epoch: 38, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.8460254669189453
Epoch: 39, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.3515098094940186
Epoch: 40, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.1845998764038086
Epoch: 41, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.0084166526794434
Epoch: 42, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.102 Vali Acc: 0.966 Test Loss: 0.102 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.065121650695801
Epoch: 43, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.29420804977417
Epoch: 44, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.8639094829559326
Epoch: 45, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.997272253036499
Epoch: 46, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.319807767868042
Epoch: 47, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 28516
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.738717079162598
Epoch: 1, Steps: 89 | Train Loss: 2.871 Vali Loss: 2.284 Vali Acc: 0.496 Test Loss: 2.284 Test Acc: 0.496
Validation loss decreased (inf --> -0.495799).  Saving model ...
Epoch: 2 cost time: 3.3506152629852295
Epoch: 2, Steps: 89 | Train Loss: 1.889 Vali Loss: 1.314 Vali Acc: 0.721 Test Loss: 1.314 Test Acc: 0.721
Validation loss decreased (-0.495799 --> -0.720739).  Saving model ...
Epoch: 3 cost time: 2.820916175842285
Epoch: 3, Steps: 89 | Train Loss: 1.114 Vali Loss: 0.832 Vali Acc: 0.799 Test Loss: 0.832 Test Acc: 0.799
Validation loss decreased (-0.720739 --> -0.798738).  Saving model ...
Epoch: 4 cost time: 3.1761441230773926
Epoch: 4, Steps: 89 | Train Loss: 0.749 Vali Loss: 0.621 Vali Acc: 0.847 Test Loss: 0.621 Test Acc: 0.847
Validation loss decreased (-0.798738 --> -0.846790).  Saving model ...
Epoch: 5 cost time: 3.4590089321136475
Epoch: 5, Steps: 89 | Train Loss: 0.562 Vali Loss: 0.457 Vali Acc: 0.891 Test Loss: 0.457 Test Acc: 0.891
Validation loss decreased (-0.846790 --> -0.890664).  Saving model ...
Epoch: 6 cost time: 3.5657401084899902
Epoch: 6, Steps: 89 | Train Loss: 0.433 Vali Loss: 0.360 Vali Acc: 0.917 Test Loss: 0.360 Test Acc: 0.917
Validation loss decreased (-0.890664 --> -0.917127).  Saving model ...
Epoch: 7 cost time: 4.015181541442871
Epoch: 7, Steps: 89 | Train Loss: 0.347 Vali Loss: 0.313 Vali Acc: 0.928 Test Loss: 0.313 Test Acc: 0.928
Validation loss decreased (-0.917127 --> -0.927573).  Saving model ...
Epoch: 8 cost time: 3.931009292602539
Epoch: 8, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.927573 --> -0.944287).  Saving model ...
Epoch: 9 cost time: 3.661524772644043
Epoch: 9, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.210 Vali Acc: 0.954 Test Loss: 0.210 Test Acc: 0.954
Validation loss decreased (-0.944287 --> -0.954037).  Saving model ...
Epoch: 10 cost time: 3.77854323387146
Epoch: 10, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.954037 --> -0.958912).  Saving model ...
Epoch: 11 cost time: 3.879098653793335
Epoch: 11, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.958912 --> -0.958912).  Saving model ...
Epoch: 12 cost time: 3.86887264251709
Epoch: 12, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
Validation loss decreased (-0.958912 --> -0.958912).  Saving model ...
Epoch: 13 cost time: 3.4611217975616455
Epoch: 13, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.958912 --> -0.962394).  Saving model ...
Epoch: 14 cost time: 4.102761507034302
Epoch: 14, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.970751).  Saving model ...
Epoch: 15 cost time: 3.983726978302002
Epoch: 15, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7646687030792236
Epoch: 16, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.970751 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 4.060797452926636
Epoch: 17, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 18 cost time: 4.085064649581909
Epoch: 18, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.477428436279297
Epoch: 19, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 20 cost time: 3.8730554580688477
Epoch: 20, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8475968837738037
Epoch: 21, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 22 cost time: 3.544682502746582
Epoch: 22, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.685072660446167
Epoch: 23, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.6352107524871826
Epoch: 24, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.5359363555908203
Epoch: 25, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.0253124237060547
Epoch: 26, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 27 cost time: 3.682607650756836
Epoch: 27, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5604310035705566
Epoch: 28, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.250927686691284
Epoch: 29, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 30 cost time: 3.6662325859069824
Epoch: 30, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.628910779953003
Epoch: 31, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.2800393104553223
Epoch: 32, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.8565664291381836
Epoch: 33, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.2744038105010986
Epoch: 34, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.906113862991333
Epoch: 35, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.30359148979187
Epoch: 36, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.268519163131714
Epoch: 37, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.030573844909668
Epoch: 38, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.9861960411071777
Epoch: 39, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 26740
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.455390691757202
Epoch: 1, Steps: 89 | Train Loss: 2.042 Vali Loss: 0.878 Vali Acc: 0.798 Test Loss: 0.878 Test Acc: 0.798
Validation loss decreased (inf --> -0.798041).  Saving model ...
Epoch: 2 cost time: 3.371640920639038
Epoch: 2, Steps: 89 | Train Loss: 0.618 Vali Loss: 0.420 Vali Acc: 0.880 Test Loss: 0.420 Test Acc: 0.880
Validation loss decreased (-0.798041 --> -0.880219).  Saving model ...
Epoch: 3 cost time: 3.310697078704834
Epoch: 3, Steps: 89 | Train Loss: 0.332 Vali Loss: 0.290 Vali Acc: 0.918 Test Loss: 0.290 Test Acc: 0.918
Validation loss decreased (-0.880219 --> -0.917824).  Saving model ...
Epoch: 4 cost time: 2.92165470123291
Epoch: 4, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.917824 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 3.3909945487976074
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
Validation loss decreased (-0.943591 --> -0.952644).  Saving model ...
Epoch: 6 cost time: 3.357830286026001
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.952644 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 3.105484962463379
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.194876194000244
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3832383155822754
Epoch: 9, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7876312732696533
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 3.388181686401367
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9141063690185547
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.964483).  Saving model ...
Epoch: 13 cost time: 3.7685275077819824
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.641179084777832
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.964483 --> -0.970054).  Saving model ...
Epoch: 15 cost time: 3.7970027923583984
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8652608394622803
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.583444833755493
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.209 Vali Acc: 0.947 Test Loss: 0.209 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4026122093200684
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.771055221557617
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6673192977905273
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.4242005348205566
Epoch: 21, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9034178256988525
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.887061595916748
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.1894726753234863
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 69476
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.5178141593933105
Epoch: 1, Steps: 89 | Train Loss: 2.343 Vali Loss: 1.276 Vali Acc: 0.745 Test Loss: 1.276 Test Acc: 0.745
Validation loss decreased (inf --> -0.745113).  Saving model ...
Epoch: 2 cost time: 3.008699655532837
Epoch: 2, Steps: 89 | Train Loss: 0.835 Vali Loss: 0.552 Vali Acc: 0.868 Test Loss: 0.552 Test Acc: 0.868
Validation loss decreased (-0.745113 --> -0.868379).  Saving model ...
Epoch: 3 cost time: 3.0782310962677
Epoch: 3, Steps: 89 | Train Loss: 0.450 Vali Loss: 0.365 Vali Acc: 0.890 Test Loss: 0.365 Test Acc: 0.890
Validation loss decreased (-0.868379 --> -0.889968).  Saving model ...
Epoch: 4 cost time: 3.07769513130188
Epoch: 4, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.309 Vali Acc: 0.905 Test Loss: 0.309 Test Acc: 0.905
Validation loss decreased (-0.889968 --> -0.905289).  Saving model ...
Epoch: 5 cost time: 3.2803523540496826
Epoch: 5, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
Validation loss decreased (-0.905289 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 2.9973087310791016
Epoch: 6, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.945680 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 3.2109591960906982
Epoch: 7, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0954413414001465
Epoch: 8, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.225644826889038
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 2.76871395111084
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9418342113494873
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.71504807472229
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966573).  Saving model ...
Epoch: 13 cost time: 2.772275447845459
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.966573 --> -0.970751).  Saving model ...
Epoch: 14 cost time: 2.7837812900543213
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.138 Vali Acc: 0.961 Test Loss: 0.138 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7244439125061035
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7233192920684814
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.838629722595215
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.178 Vali Acc: 0.947 Test Loss: 0.178 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.69582200050354
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7775192260742188
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.720280647277832
Epoch: 20, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.8073313236236572
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.8710989952087402
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.7011847496032715
Epoch: 23, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 45556
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.247726917266846
Epoch: 1, Steps: 89 | Train Loss: 2.507 Vali Loss: 1.519 Vali Acc: 0.689 Test Loss: 1.519 Test Acc: 0.689
Validation loss decreased (inf --> -0.689400).  Saving model ...
Epoch: 2 cost time: 3.1748945713043213
Epoch: 2, Steps: 89 | Train Loss: 1.046 Vali Loss: 0.657 Vali Acc: 0.820 Test Loss: 0.657 Test Acc: 0.820
Validation loss decreased (-0.689400 --> -0.819631).  Saving model ...
Epoch: 3 cost time: 3.1524877548217773
Epoch: 3, Steps: 89 | Train Loss: 0.531 Vali Loss: 0.409 Vali Acc: 0.898 Test Loss: 0.409 Test Acc: 0.898
Validation loss decreased (-0.819631 --> -0.897628).  Saving model ...
Epoch: 4 cost time: 2.9579005241394043
Epoch: 4, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.281 Vali Acc: 0.930 Test Loss: 0.281 Test Acc: 0.930
Validation loss decreased (-0.897628 --> -0.930359).  Saving model ...
Epoch: 5 cost time: 2.9843645095825195
Epoch: 5, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
Validation loss decreased (-0.930359 --> -0.949162).  Saving model ...
Epoch: 6 cost time: 3.21634578704834
Epoch: 6, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.949162 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 3.087977170944214
Epoch: 7, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.329453945159912
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.030888080596924
Epoch: 9, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
Validation loss decreased (-0.956126 --> -0.961001).  Saving model ...
Epoch: 10 cost time: 3.162501573562622
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.961001 --> -0.970054).  Saving model ...
Epoch: 11 cost time: 3.198279857635498
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2120683193206787
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0807573795318604
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.111159324645996
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.090083360671997
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.974233).  Saving model ...
Epoch: 16 cost time: 3.0675947666168213
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.960 Test Loss: 0.125 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.058692216873169
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.960 Test Loss: 0.127 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1832005977630615
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.140 Vali Acc: 0.953 Test Loss: 0.140 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.982823133468628
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 20 cost time: 3.0625600814819336
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0779080390930176
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.0840275287628174
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.960 Test Loss: 0.115 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.124319553375244
Epoch: 23, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.956 Test Loss: 0.142 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.1570076942443848
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.1410117149353027
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.0955545902252197
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.797773599624634
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.6778151988983154
Epoch: 28, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.7548410892486572
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 36020
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.0813939571380615
Epoch: 1, Steps: 89 | Train Loss: 2.664 Vali Loss: 1.747 Vali Acc: 0.609 Test Loss: 1.747 Test Acc: 0.609
Validation loss decreased (inf --> -0.608618).  Saving model ...
Epoch: 2 cost time: 2.7100045680999756
Epoch: 2, Steps: 89 | Train Loss: 1.231 Vali Loss: 0.739 Vali Acc: 0.836 Test Loss: 0.739 Test Acc: 0.836
Validation loss decreased (-0.608618 --> -0.835647).  Saving model ...
Epoch: 3 cost time: 2.601943016052246
Epoch: 3, Steps: 89 | Train Loss: 0.611 Vali Loss: 0.470 Vali Acc: 0.880 Test Loss: 0.470 Test Acc: 0.880
Validation loss decreased (-0.835647 --> -0.879522).  Saving model ...
Epoch: 4 cost time: 2.8623111248016357
Epoch: 4, Steps: 89 | Train Loss: 0.409 Vali Loss: 0.338 Vali Acc: 0.908 Test Loss: 0.338 Test Acc: 0.908
Validation loss decreased (-0.879522 --> -0.908075).  Saving model ...
Epoch: 5 cost time: 2.8602075576782227
Epoch: 5, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.278 Vali Acc: 0.916 Test Loss: 0.278 Test Acc: 0.916
Validation loss decreased (-0.908075 --> -0.916432).  Saving model ...
Epoch: 6 cost time: 2.7719061374664307
Epoch: 6, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.219 Vali Acc: 0.942 Test Loss: 0.219 Test Acc: 0.942
Validation loss decreased (-0.916432 --> -0.941502).  Saving model ...
Epoch: 7 cost time: 2.6982314586639404
Epoch: 7, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.941502 --> -0.951252).  Saving model ...
Epoch: 8 cost time: 2.7106049060821533
Epoch: 8, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.951252 --> -0.954037).  Saving model ...
Epoch: 9 cost time: 2.7595789432525635
Epoch: 9, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.954734).  Saving model ...
Epoch: 10 cost time: 2.832392930984497
Epoch: 10, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.149 Vali Acc: 0.953 Test Loss: 0.149 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6677393913269043
Epoch: 11, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.954734 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 3.0852675437927246
Epoch: 12, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0480144023895264
Epoch: 13, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0520310401916504
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1092023849487305
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2149343490600586
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 17 cost time: 3.0472748279571533
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.078645706176758
Epoch: 18, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0599095821380615
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 20 cost time: 3.025151252746582
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0834691524505615
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.204263687133789
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.1210827827453613
Epoch: 23, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.134300947189331
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.0638978481292725
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.1325557231903076
Epoch: 26, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.0018160343170166
Epoch: 27, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.149 Vali Acc: 0.953 Test Loss: 0.149 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.0368621349334717
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.0768086910247803
Epoch: 29, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 28420
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.739419221878052
Epoch: 1, Steps: 89 | Train Loss: 2.784 Vali Loss: 2.047 Vali Acc: 0.570 Test Loss: 2.047 Test Acc: 0.570
Validation loss decreased (inf --> -0.570314).  Saving model ...
Epoch: 2 cost time: 3.168752908706665
Epoch: 2, Steps: 89 | Train Loss: 1.549 Vali Loss: 0.959 Vali Acc: 0.786 Test Loss: 0.959 Test Acc: 0.786
Validation loss decreased (-0.570314 --> -0.786202).  Saving model ...
Epoch: 3 cost time: 3.0715837478637695
Epoch: 3, Steps: 89 | Train Loss: 0.778 Vali Loss: 0.584 Vali Acc: 0.860 Test Loss: 0.584 Test Acc: 0.860
Validation loss decreased (-0.786202 --> -0.860022).  Saving model ...
Epoch: 4 cost time: 3.1482675075531006
Epoch: 4, Steps: 89 | Train Loss: 0.520 Vali Loss: 0.449 Vali Acc: 0.879 Test Loss: 0.449 Test Acc: 0.879
Validation loss decreased (-0.860022 --> -0.878826).  Saving model ...
Epoch: 5 cost time: 3.1535987854003906
Epoch: 5, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.321 Vali Acc: 0.916 Test Loss: 0.321 Test Acc: 0.916
Validation loss decreased (-0.878826 --> -0.916431).  Saving model ...
Epoch: 6 cost time: 2.9130868911743164
Epoch: 6, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.263 Vali Acc: 0.932 Test Loss: 0.263 Test Acc: 0.932
Validation loss decreased (-0.916431 --> -0.932449).  Saving model ...
Epoch: 7 cost time: 2.734602212905884
Epoch: 7, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.932449 --> -0.940806).  Saving model ...
Epoch: 8 cost time: 2.79559588432312
Epoch: 8, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
Validation loss decreased (-0.940806 --> -0.953341).  Saving model ...
Epoch: 9 cost time: 2.8350534439086914
Epoch: 9, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8893070220947266
Epoch: 10, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
Validation loss decreased (-0.953341 --> -0.959609).  Saving model ...
Epoch: 11 cost time: 2.851496458053589
Epoch: 11, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
Validation loss decreased (-0.959609 --> -0.963787).  Saving model ...
Epoch: 12 cost time: 2.8400628566741943
Epoch: 12, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.963787 --> -0.970055).  Saving model ...
Epoch: 13 cost time: 2.7873857021331787
Epoch: 13, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8594233989715576
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 15 cost time: 2.8427538871765137
Epoch: 15, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 16 cost time: 3.0327939987182617
Epoch: 16, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 2.7645535469055176
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8008904457092285
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7058591842651367
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8411571979522705
Epoch: 20, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 21 cost time: 2.7997236251831055
Epoch: 21, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0235815048217773
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 23 cost time: 3.0441999435424805
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.240445375442505
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.1034507751464844
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.051128625869751
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.966 Test Loss: 0.106 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.0503737926483154
Epoch: 27, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.2364614009857178
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 29 cost time: 3.050668478012085
Epoch: 29, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1418917179107666
Epoch: 30, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.2221758365631104
Epoch: 31, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.041553258895874
Epoch: 32, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.1431496143341064
Epoch: 33, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.092219829559326
Epoch: 34, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 35 cost time: 3.274193286895752
Epoch: 35, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.013982057571411
Epoch: 36, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.228487253189087
Epoch: 37, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 38 cost time: 3.1657371520996094
Epoch: 38, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.1252167224884033
Epoch: 39, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.180194139480591
Epoch: 40, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.004542112350464
Epoch: 41, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.1051454544067383
Epoch: 42, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.058826446533203
Epoch: 43, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.230482578277588
Epoch: 44, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 45 cost time: 3.0133938789367676
Epoch: 45, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.1291918754577637
Epoch: 46, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.1451127529144287
Epoch: 47, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.7824809551239014
Epoch: 48, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.7611351013183594
Epoch: 49, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.661473035812378
Epoch: 50, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.9183270931243896
Epoch: 51, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.756904125213623
Epoch: 52, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.8279218673706055
Epoch: 53, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.8355069160461426
Epoch: 54, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 23764
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9803943634033203
Epoch: 1, Steps: 89 | Train Loss: 2.818 Vali Loss: 2.213 Vali Acc: 0.592 Test Loss: 2.213 Test Acc: 0.592
Validation loss decreased (inf --> -0.591900).  Saving model ...
Epoch: 2 cost time: 2.418178081512451
Epoch: 2, Steps: 89 | Train Loss: 1.757 Vali Loss: 1.147 Vali Acc: 0.769 Test Loss: 1.147 Test Acc: 0.769
Validation loss decreased (-0.591900 --> -0.769487).  Saving model ...
Epoch: 3 cost time: 2.519902467727661
Epoch: 3, Steps: 89 | Train Loss: 0.947 Vali Loss: 0.702 Vali Acc: 0.840 Test Loss: 0.702 Test Acc: 0.840
Validation loss decreased (-0.769487 --> -0.839826).  Saving model ...
Epoch: 4 cost time: 2.983644723892212
Epoch: 4, Steps: 89 | Train Loss: 0.620 Vali Loss: 0.489 Vali Acc: 0.891 Test Loss: 0.489 Test Acc: 0.891
Validation loss decreased (-0.839826 --> -0.890664).  Saving model ...
Epoch: 5 cost time: 2.7025563716888428
Epoch: 5, Steps: 89 | Train Loss: 0.443 Vali Loss: 0.393 Vali Acc: 0.903 Test Loss: 0.393 Test Acc: 0.903
Validation loss decreased (-0.890664 --> -0.903199).  Saving model ...
Epoch: 6 cost time: 2.5940558910369873
Epoch: 6, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
Validation loss decreased (-0.903199 --> -0.924788).  Saving model ...
Epoch: 7 cost time: 2.717992067337036
Epoch: 7, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.252 Vali Acc: 0.942 Test Loss: 0.252 Test Acc: 0.942
Validation loss decreased (-0.924788 --> -0.941502).  Saving model ...
Epoch: 8 cost time: 3.2411437034606934
Epoch: 8, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
Validation loss decreased (-0.941502 --> -0.949162).  Saving model ...
Epoch: 9 cost time: 3.0711722373962402
Epoch: 9, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2294838428497314
Epoch: 10, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.949162 --> -0.958215).  Saving model ...
Epoch: 11 cost time: 3.276792049407959
Epoch: 11, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.202725410461426
Epoch: 12, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
Validation loss decreased (-0.958215 --> -0.961001).  Saving model ...
Epoch: 13 cost time: 3.3016738891601562
Epoch: 13, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.966572).  Saving model ...
Epoch: 14 cost time: 2.963430404663086
Epoch: 14, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.966572 --> -0.970054).  Saving model ...
Epoch: 15 cost time: 2.103839635848999
Epoch: 15, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.121504545211792
Epoch: 16, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1442551612854004
Epoch: 17, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.973536).  Saving model ...
Epoch: 18 cost time: 1.9736974239349365
Epoch: 18, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2197697162628174
Epoch: 19, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2667226791381836
Epoch: 20, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.976322).  Saving model ...
Epoch: 21 cost time: 3.2453598976135254
Epoch: 21, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.370098352432251
Epoch: 22, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0711822509765625
Epoch: 23, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.2969441413879395
Epoch: 24, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.981197).  Saving model ...
Epoch: 25 cost time: 3.276977062225342
Epoch: 25, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2093632221221924
Epoch: 26, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3487448692321777
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.1441423892974854
Epoch: 28, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.226809024810791
Epoch: 29, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.239774703979492
Epoch: 30, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.089646339416504
Epoch: 31, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.0876197814941406
Epoch: 32, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.210858106613159
Epoch: 33, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 34 cost time: 2.8301901817321777
Epoch: 34, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.111574411392212
Epoch: 35, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.0423221588134766
Epoch: 36, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.93007755279541
Epoch: 37, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.1599066257476807
Epoch: 38, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.8545069694519043
Epoch: 39, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.998408079147339
Epoch: 40, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.582078456878662
Epoch: 41, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.721906900405884
Epoch: 42, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.5618863105773926
Epoch: 43, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 20068
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9751956462860107
Epoch: 1, Steps: 89 | Train Loss: 2.887 Vali Loss: 2.353 Vali Acc: 0.409 Test Loss: 2.353 Test Acc: 0.409
Validation loss decreased (inf --> -0.408751).  Saving model ...
Epoch: 2 cost time: 2.8339102268218994
Epoch: 2, Steps: 89 | Train Loss: 2.011 Vali Loss: 1.424 Vali Acc: 0.710 Test Loss: 1.424 Test Acc: 0.710
Validation loss decreased (-0.408751 --> -0.709596).  Saving model ...
Epoch: 3 cost time: 2.546440839767456
Epoch: 3, Steps: 89 | Train Loss: 1.210 Vali Loss: 0.896 Vali Acc: 0.806 Test Loss: 0.896 Test Acc: 0.806
Validation loss decreased (-0.709596 --> -0.806398).  Saving model ...
Epoch: 4 cost time: 2.760470151901245
Epoch: 4, Steps: 89 | Train Loss: 0.815 Vali Loss: 0.672 Vali Acc: 0.843 Test Loss: 0.672 Test Acc: 0.843
Validation loss decreased (-0.806398 --> -0.842612).  Saving model ...
Epoch: 5 cost time: 2.62235689163208
Epoch: 5, Steps: 89 | Train Loss: 0.609 Vali Loss: 0.536 Vali Acc: 0.868 Test Loss: 0.536 Test Acc: 0.868
Validation loss decreased (-0.842612 --> -0.867683).  Saving model ...
Epoch: 6 cost time: 2.717323064804077
Epoch: 6, Steps: 89 | Train Loss: 0.494 Vali Loss: 0.423 Vali Acc: 0.901 Test Loss: 0.423 Test Acc: 0.901
Validation loss decreased (-0.867683 --> -0.901110).  Saving model ...
Epoch: 7 cost time: 2.5807931423187256
Epoch: 7, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.350 Vali Acc: 0.915 Test Loss: 0.350 Test Acc: 0.915
Validation loss decreased (-0.901110 --> -0.915038).  Saving model ...
Epoch: 8 cost time: 2.7553532123565674
Epoch: 8, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.301 Vali Acc: 0.927 Test Loss: 0.301 Test Acc: 0.927
Validation loss decreased (-0.915038 --> -0.926877).  Saving model ...
Epoch: 9 cost time: 3.0749738216400146
Epoch: 9, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.242 Vali Acc: 0.936 Test Loss: 0.242 Test Acc: 0.936
Validation loss decreased (-0.926877 --> -0.935931).  Saving model ...
Epoch: 10 cost time: 3.105456590652466
Epoch: 10, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.209 Vali Acc: 0.947 Test Loss: 0.209 Test Acc: 0.947
Validation loss decreased (-0.935931 --> -0.947073).  Saving model ...
Epoch: 11 cost time: 3.0870702266693115
Epoch: 11, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
Validation loss decreased (-0.947073 --> -0.953341).  Saving model ...
Epoch: 12 cost time: 2.9395453929901123
Epoch: 12, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.953341 --> -0.956823).  Saving model ...
Epoch: 13 cost time: 3.156721830368042
Epoch: 13, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.963787).  Saving model ...
Epoch: 14 cost time: 2.758021593093872
Epoch: 14, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.967269).  Saving model ...
Epoch: 15 cost time: 3.0211594104766846
Epoch: 15, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.366466760635376
Epoch: 16, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.501203775405884
Epoch: 17, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.968662).  Saving model ...
Epoch: 18 cost time: 3.7438039779663086
Epoch: 18, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 19 cost time: 3.551936388015747
Epoch: 19, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 20 cost time: 3.321913719177246
Epoch: 20, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 21 cost time: 3.500427007675171
Epoch: 21, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4659600257873535
Epoch: 22, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.329148054122925
Epoch: 23, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 24 cost time: 3.5238146781921387
Epoch: 24, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.339040994644165
Epoch: 25, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.4655418395996094
Epoch: 26, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.0188188552856445
Epoch: 27, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.323561191558838
Epoch: 28, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 29 cost time: 3.2509725093841553
Epoch: 29, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.977019 --> -0.979108).  Saving model ...
Epoch: 30 cost time: 3.215841054916382
Epoch: 30, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.9140071868896484
Epoch: 31, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.8580331802368164
Epoch: 32, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.6556153297424316
Epoch: 33, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.8778960704803467
Epoch: 34, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.751044988632202
Epoch: 35, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.747317314147949
Epoch: 36, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.775071620941162
Epoch: 37, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.8284049034118652
Epoch: 38, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.733729362487793
Epoch: 39, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 18292
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.6448633670806885
Epoch: 1, Steps: 89 | Train Loss: 2.039 Vali Loss: 0.889 Vali Acc: 0.754 Test Loss: 0.889 Test Acc: 0.754
Validation loss decreased (inf --> -0.754169).  Saving model ...
Epoch: 2 cost time: 2.432861328125
Epoch: 2, Steps: 89 | Train Loss: 0.653 Vali Loss: 0.479 Vali Acc: 0.857 Test Loss: 0.479 Test Acc: 0.857
Validation loss decreased (-0.754169 --> -0.856541).  Saving model ...
Epoch: 3 cost time: 3.2916905879974365
Epoch: 3, Steps: 89 | Train Loss: 0.372 Vali Loss: 0.359 Vali Acc: 0.891 Test Loss: 0.359 Test Acc: 0.891
Validation loss decreased (-0.856541 --> -0.890665).  Saving model ...
Epoch: 4 cost time: 3.296156883239746
Epoch: 4, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
Validation loss decreased (-0.890665 --> -0.938716).  Saving model ...
Epoch: 5 cost time: 3.369537115097046
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
Validation loss decreased (-0.938716 --> -0.945681).  Saving model ...
Epoch: 6 cost time: 3.340034008026123
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
Validation loss decreased (-0.945681 --> -0.951948).  Saving model ...
Epoch: 7 cost time: 3.24835205078125
Epoch: 7, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.208 Vali Acc: 0.929 Test Loss: 0.208 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.13956618309021
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
Validation loss decreased (-0.951948 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 3.496663808822632
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.398021936416626
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2497692108154297
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.434030771255493
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.5800983905792236
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.376056432723999
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.4301154613494873
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.471506357192993
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.171 Vali Acc: 0.964 Test Loss: 0.171 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.5657904148101807
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.971447).  Saving model ...
Epoch: 18 cost time: 3.439368724822998
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.480750799179077
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.197 Vali Acc: 0.953 Test Loss: 0.197 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.312657356262207
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.721693515777588
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.480959892272949
Epoch: 22, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.301 Vali Acc: 0.945 Test Loss: 0.301 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.29166579246521
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.231 Vali Acc: 0.956 Test Loss: 0.231 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3996775150299072
Epoch: 24, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.269 Vali Acc: 0.951 Test Loss: 0.269 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.659055233001709
Epoch: 25, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.190 Vali Acc: 0.966 Test Loss: 0.190 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.8591434955596924
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.964 Test Loss: 0.227 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.157829523086548
Epoch: 27, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.964 Test Loss: 0.189 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 65252
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.286101579666138
Epoch: 1, Steps: 89 | Train Loss: 2.304 Vali Loss: 1.223 Vali Acc: 0.740 Test Loss: 1.223 Test Acc: 0.740
Validation loss decreased (inf --> -0.739542).  Saving model ...
Epoch: 2 cost time: 2.768462657928467
Epoch: 2, Steps: 89 | Train Loss: 0.844 Vali Loss: 0.581 Vali Acc: 0.838 Test Loss: 0.581 Test Acc: 0.838
Validation loss decreased (-0.739542 --> -0.837738).  Saving model ...
Epoch: 3 cost time: 2.6758573055267334
Epoch: 3, Steps: 89 | Train Loss: 0.444 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.837738 --> -0.899718).  Saving model ...
Epoch: 4 cost time: 2.6401631832122803
Epoch: 4, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.270 Vali Acc: 0.921 Test Loss: 0.270 Test Acc: 0.921
Validation loss decreased (-0.899718 --> -0.920610).  Saving model ...
Epoch: 5 cost time: 2.8498287200927734
Epoch: 5, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.920610 --> -0.940806).  Saving model ...
Epoch: 6 cost time: 3.004415273666382
Epoch: 6, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.940806 --> -0.947770).  Saving model ...
Epoch: 7 cost time: 2.7274887561798096
Epoch: 7, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.947770 --> -0.957519).  Saving model ...
Epoch: 8 cost time: 2.999704122543335
Epoch: 8, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8270204067230225
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
Validation loss decreased (-0.957519 --> -0.961001).  Saving model ...
Epoch: 10 cost time: 3.2425525188446045
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.172 Vali Acc: 0.942 Test Loss: 0.172 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1139705181121826
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.148 Vali Acc: 0.955 Test Loss: 0.148 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2944297790527344
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1174869537353516
Epoch: 13, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.961001 --> -0.965180).  Saving model ...
Epoch: 14 cost time: 3.311918020248413
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 15 cost time: 3.1835522651672363
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.969358).  Saving model ...
Epoch: 16 cost time: 3.1324822902679443
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1088759899139404
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.111119270324707
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970054).  Saving model ...
Epoch: 19 cost time: 3.1305110454559326
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3406283855438232
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.332732915878296
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2058188915252686
Epoch: 22, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4787514209747314
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2827351093292236
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.295874834060669
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.2117083072662354
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.1489439010620117
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.172752857208252
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 41332
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.162672281265259
Epoch: 1, Steps: 89 | Train Loss: 2.522 Vali Loss: 1.538 Vali Acc: 0.668 Test Loss: 1.538 Test Acc: 0.668
Validation loss decreased (inf --> -0.667812).  Saving model ...
Epoch: 2 cost time: 3.1046512126922607
Epoch: 2, Steps: 89 | Train Loss: 1.038 Vali Loss: 0.646 Vali Acc: 0.829 Test Loss: 0.646 Test Acc: 0.829
Validation loss decreased (-0.667812 --> -0.828684).  Saving model ...
Epoch: 3 cost time: 2.6234705448150635
Epoch: 3, Steps: 89 | Train Loss: 0.525 Vali Loss: 0.405 Vali Acc: 0.886 Test Loss: 0.405 Test Acc: 0.886
Validation loss decreased (-0.828684 --> -0.886486).  Saving model ...
Epoch: 4 cost time: 2.6891839504241943
Epoch: 4, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.292 Vali Acc: 0.923 Test Loss: 0.292 Test Acc: 0.923
Validation loss decreased (-0.886486 --> -0.923395).  Saving model ...
Epoch: 5 cost time: 2.6749966144561768
Epoch: 5, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.923395 --> -0.930360).  Saving model ...
Epoch: 6 cost time: 2.5947256088256836
Epoch: 6, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.930360 --> -0.948466).  Saving model ...
Epoch: 7 cost time: 2.78192138671875
Epoch: 7, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
Validation loss decreased (-0.948466 --> -0.953341).  Saving model ...
Epoch: 8 cost time: 2.780918598175049
Epoch: 8, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.953341 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 2.731745958328247
Epoch: 9, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 2.7223458290100098
Epoch: 10, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6393754482269287
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7461276054382324
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.964483 --> -0.965180).  Saving model ...
Epoch: 13 cost time: 2.76131534576416
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6484532356262207
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6776084899902344
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.159 Vali Acc: 0.953 Test Loss: 0.159 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.0564053058624268
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.967269).  Saving model ...
Epoch: 17 cost time: 3.038330078125
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972144).  Saving model ...
Epoch: 18 cost time: 3.075711488723755
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.122 Vali Acc: 0.958 Test Loss: 0.122 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.997159481048584
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9472477436065674
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.964 Test Loss: 0.115 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.104517698287964
Epoch: 21, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 22 cost time: 3.163612127304077
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.973537 --> -0.977715).  Saving model ...
Epoch: 23 cost time: 3.0504345893859863
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 24 cost time: 3.0541067123413086
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.0490760803222656
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.127925157546997
Epoch: 26, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.0207226276397705
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.9154915809631348
Epoch: 28, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.119162082672119
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.1907525062561035
Epoch: 30, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.9518775939941406
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.0762412548065186
Epoch: 32, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.063201665878296
Epoch: 33, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 31796
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.278239011764526
Epoch: 1, Steps: 89 | Train Loss: 2.685 Vali Loss: 1.802 Vali Acc: 0.687 Test Loss: 1.802 Test Acc: 0.687
Validation loss decreased (inf --> -0.686612).  Saving model ...
Epoch: 2 cost time: 2.5595457553863525
Epoch: 2, Steps: 89 | Train Loss: 1.287 Vali Loss: 0.801 Vali Acc: 0.804 Test Loss: 0.801 Test Acc: 0.804
Validation loss decreased (-0.686612 --> -0.803613).  Saving model ...
Epoch: 3 cost time: 2.6929831504821777
Epoch: 3, Steps: 89 | Train Loss: 0.640 Vali Loss: 0.518 Vali Acc: 0.868 Test Loss: 0.518 Test Acc: 0.868
Validation loss decreased (-0.803613 --> -0.867683).  Saving model ...
Epoch: 4 cost time: 2.6061739921569824
Epoch: 4, Steps: 89 | Train Loss: 0.429 Vali Loss: 0.369 Vali Acc: 0.907 Test Loss: 0.369 Test Acc: 0.907
Validation loss decreased (-0.867683 --> -0.907378).  Saving model ...
Epoch: 5 cost time: 2.4040048122406006
Epoch: 5, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.279 Vali Acc: 0.927 Test Loss: 0.279 Test Acc: 0.927
Validation loss decreased (-0.907378 --> -0.926877).  Saving model ...
Epoch: 6 cost time: 2.5711214542388916
Epoch: 6, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.926877 --> -0.943591).  Saving model ...
Epoch: 7 cost time: 2.56463885307312
Epoch: 7, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.191 Vali Acc: 0.954 Test Loss: 0.191 Test Acc: 0.954
Validation loss decreased (-0.943591 --> -0.954037).  Saving model ...
Epoch: 8 cost time: 2.543907403945923
Epoch: 8, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 2.454680919647217
Epoch: 9, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.241 Vali Acc: 0.921 Test Loss: 0.241 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5896074771881104
Epoch: 10, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.955430 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 2.6501379013061523
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.522167444229126
Epoch: 12, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5691397190093994
Epoch: 13, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.14945387840271
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0335640907287598
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.964483 --> -0.972144).  Saving model ...
Epoch: 16 cost time: 2.9614522457122803
Epoch: 16, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1398026943206787
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9866926670074463
Epoch: 18, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.944147825241089
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.2074716091156006
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.0650508403778076
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.924515724182129
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.063607692718506
Epoch: 23, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.2061350345611572
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.866780996322632
Epoch: 25, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 26 cost time: 2.812997341156006
Epoch: 26, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9245591163635254
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9943459033966064
Epoch: 28, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.003955125808716
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 30 cost time: 2.9842140674591064
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 31 cost time: 3.1238248348236084
Epoch: 31, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 32 cost time: 2.986154794692993
Epoch: 32, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.9537065029144287
Epoch: 33, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.074039936065674
Epoch: 34, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 35 cost time: 3.0558648109436035
Epoch: 35, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.843411445617676
Epoch: 36, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.705759286880493
Epoch: 37, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.641115427017212
Epoch: 38, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.5870161056518555
Epoch: 39, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.745772123336792
Epoch: 40, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.6580238342285156
Epoch: 41, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.6490297317504883
Epoch: 42, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.5216751098632812
Epoch: 43, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.6220877170562744
Epoch: 44, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 24196
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.141067981719971
Epoch: 1, Steps: 89 | Train Loss: 2.796 Vali Loss: 2.123 Vali Acc: 0.581 Test Loss: 2.123 Test Acc: 0.581
Validation loss decreased (inf --> -0.580759).  Saving model ...
Epoch: 2 cost time: 2.6337952613830566
Epoch: 2, Steps: 89 | Train Loss: 1.615 Vali Loss: 0.991 Vali Acc: 0.787 Test Loss: 0.991 Test Acc: 0.787
Validation loss decreased (-0.580759 --> -0.786898).  Saving model ...
Epoch: 3 cost time: 2.710200786590576
Epoch: 3, Steps: 89 | Train Loss: 0.810 Vali Loss: 0.618 Vali Acc: 0.843 Test Loss: 0.618 Test Acc: 0.843
Validation loss decreased (-0.786898 --> -0.843309).  Saving model ...
Epoch: 4 cost time: 2.7758777141571045
Epoch: 4, Steps: 89 | Train Loss: 0.536 Vali Loss: 0.456 Vali Acc: 0.889 Test Loss: 0.456 Test Acc: 0.889
Validation loss decreased (-0.843309 --> -0.889271).  Saving model ...
Epoch: 5 cost time: 2.963829755783081
Epoch: 5, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.341 Vali Acc: 0.913 Test Loss: 0.341 Test Acc: 0.913
Validation loss decreased (-0.889271 --> -0.912949).  Saving model ...
Epoch: 6 cost time: 2.7983477115631104
Epoch: 6, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.912949 --> -0.931056).  Saving model ...
Epoch: 7 cost time: 2.9783005714416504
Epoch: 7, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
Validation loss decreased (-0.931056 --> -0.940805).  Saving model ...
Epoch: 8 cost time: 2.9311587810516357
Epoch: 8, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.198 Vali Acc: 0.953 Test Loss: 0.198 Test Acc: 0.953
Validation loss decreased (-0.940805 --> -0.952644).  Saving model ...
Epoch: 9 cost time: 2.8902640342712402
Epoch: 9, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
Validation loss decreased (-0.952644 --> -0.956823).  Saving model ...
Epoch: 10 cost time: 2.872950553894043
Epoch: 10, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.165 Vali Acc: 0.953 Test Loss: 0.165 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0630691051483154
Epoch: 11, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
Validation loss decreased (-0.956823 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 3.1166274547576904
Epoch: 12, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.102695941925049
Epoch: 13, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 14 cost time: 3.1486239433288574
Epoch: 14, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 15 cost time: 3.0685267448425293
Epoch: 15, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9302456378936768
Epoch: 16, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 17 cost time: 3.1029434204101562
Epoch: 17, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.641200065612793
Epoch: 18, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.977019).  Saving model ...
Epoch: 19 cost time: 3.621659278869629
Epoch: 19, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.224562883377075
Epoch: 20, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.689474582672119
Epoch: 21, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.980501).  Saving model ...
Epoch: 22 cost time: 3.6194658279418945
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3805956840515137
Epoch: 23, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5995848178863525
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.7923359870910645
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.513461112976074
Epoch: 26, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.2098605632781982
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.2690682411193848
Epoch: 28, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.8289592266082764
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.3762705326080322
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.2748231887817383
Epoch: 31, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 19540
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.632297992706299
Epoch: 1, Steps: 89 | Train Loss: 2.859 Vali Loss: 2.273 Vali Acc: 0.460 Test Loss: 2.273 Test Acc: 0.460
Validation loss decreased (inf --> -0.460284).  Saving model ...
Epoch: 2 cost time: 2.757030725479126
Epoch: 2, Steps: 89 | Train Loss: 1.842 Vali Loss: 1.237 Vali Acc: 0.730 Test Loss: 1.237 Test Acc: 0.730
Validation loss decreased (-0.460284 --> -0.729793).  Saving model ...
Epoch: 3 cost time: 3.044402599334717
Epoch: 3, Steps: 89 | Train Loss: 1.025 Vali Loss: 0.734 Vali Acc: 0.850 Test Loss: 0.734 Test Acc: 0.850
Validation loss decreased (-0.729793 --> -0.850271).  Saving model ...
Epoch: 4 cost time: 3.1317126750946045
Epoch: 4, Steps: 89 | Train Loss: 0.660 Vali Loss: 0.529 Vali Acc: 0.883 Test Loss: 0.529 Test Acc: 0.883
Validation loss decreased (-0.850271 --> -0.883003).  Saving model ...
Epoch: 5 cost time: 2.8996574878692627
Epoch: 5, Steps: 89 | Train Loss: 0.475 Vali Loss: 0.397 Vali Acc: 0.913 Test Loss: 0.397 Test Acc: 0.913
Validation loss decreased (-0.883003 --> -0.912949).  Saving model ...
Epoch: 6 cost time: 3.3307268619537354
Epoch: 6, Steps: 89 | Train Loss: 0.372 Vali Loss: 0.316 Vali Acc: 0.928 Test Loss: 0.316 Test Acc: 0.928
Validation loss decreased (-0.912949 --> -0.927573).  Saving model ...
Epoch: 7 cost time: 3.1176822185516357
Epoch: 7, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.254 Vali Acc: 0.946 Test Loss: 0.254 Test Acc: 0.946
Validation loss decreased (-0.927573 --> -0.945680).  Saving model ...
Epoch: 8 cost time: 3.263072967529297
Epoch: 8, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.219 Vali Acc: 0.948 Test Loss: 0.219 Test Acc: 0.948
Validation loss decreased (-0.945680 --> -0.947769).  Saving model ...
Epoch: 9 cost time: 3.414215326309204
Epoch: 9, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (-0.947769 --> -0.951252).  Saving model ...
Epoch: 10 cost time: 3.4896256923675537
Epoch: 10, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
Validation loss decreased (-0.951252 --> -0.965179).  Saving model ...
Epoch: 11 cost time: 3.1172730922698975
Epoch: 11, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6507861614227295
Epoch: 12, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.965179 --> -0.966572).  Saving model ...
Epoch: 13 cost time: 3.5101075172424316
Epoch: 13, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1289451122283936
Epoch: 14, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3855321407318115
Epoch: 15, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6278905868530273
Epoch: 16, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.966572 --> -0.972840).  Saving model ...
Epoch: 17 cost time: 3.2851064205169678
Epoch: 17, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.421100616455078
Epoch: 18, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 19 cost time: 3.521244764328003
Epoch: 19, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6447269916534424
Epoch: 20, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 21 cost time: 3.2699503898620605
Epoch: 21, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6071982383728027
Epoch: 22, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 23 cost time: 3.4509472846984863
Epoch: 23, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4375739097595215
Epoch: 24, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.67044734954834
Epoch: 25, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979108).  Saving model ...
Epoch: 26 cost time: 3.6950976848602295
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4974365234375
Epoch: 27, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.77626371383667
Epoch: 28, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.7086434364318848
Epoch: 29, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.5086123943328857
Epoch: 30, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.501789093017578
Epoch: 31, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.4132626056671143
Epoch: 32, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 33 cost time: 2.847569704055786
Epoch: 33, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2262134552001953
Epoch: 34, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.2861247062683105
Epoch: 35, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.761305809020996
Epoch: 36, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.2482478618621826
Epoch: 37, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.255236864089966
Epoch: 38, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.849487543106079
Epoch: 39, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.154630661010742
Epoch: 40, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.1183652877807617
Epoch: 41, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.8645286560058594
Epoch: 42, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 15844
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.461841344833374
Epoch: 1, Steps: 89 | Train Loss: 2.900 Vali Loss: 2.376 Vali Acc: 0.393 Test Loss: 2.376 Test Acc: 0.393
Validation loss decreased (inf --> -0.393430).  Saving model ...
Epoch: 2 cost time: 1.5398364067077637
Epoch: 2, Steps: 89 | Train Loss: 1.986 Vali Loss: 1.377 Vali Acc: 0.760 Test Loss: 1.377 Test Acc: 0.760
Validation loss decreased (-0.393430 --> -0.759736).  Saving model ...
Epoch: 3 cost time: 1.4600334167480469
Epoch: 3, Steps: 89 | Train Loss: 1.163 Vali Loss: 0.838 Vali Acc: 0.831 Test Loss: 0.838 Test Acc: 0.831
Validation loss decreased (-0.759736 --> -0.831468).  Saving model ...
Epoch: 4 cost time: 1.4829418659210205
Epoch: 4, Steps: 89 | Train Loss: 0.761 Vali Loss: 0.610 Vali Acc: 0.865 Test Loss: 0.610 Test Acc: 0.865
Validation loss decreased (-0.831468 --> -0.864896).  Saving model ...
Epoch: 5 cost time: 1.5030286312103271
Epoch: 5, Steps: 89 | Train Loss: 0.565 Vali Loss: 0.476 Vali Acc: 0.893 Test Loss: 0.476 Test Acc: 0.893
Validation loss decreased (-0.864896 --> -0.892753).  Saving model ...
Epoch: 6 cost time: 1.4277377128601074
Epoch: 6, Steps: 89 | Train Loss: 0.438 Vali Loss: 0.377 Vali Acc: 0.909 Test Loss: 0.377 Test Acc: 0.909
Validation loss decreased (-0.892753 --> -0.909467).  Saving model ...
Epoch: 7 cost time: 1.4069244861602783
Epoch: 7, Steps: 89 | Train Loss: 0.355 Vali Loss: 0.311 Vali Acc: 0.914 Test Loss: 0.311 Test Acc: 0.914
Validation loss decreased (-0.909467 --> -0.913646).  Saving model ...
Epoch: 8 cost time: 1.4892933368682861
Epoch: 8, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.259 Vali Acc: 0.936 Test Loss: 0.259 Test Acc: 0.936
Validation loss decreased (-0.913646 --> -0.935931).  Saving model ...
Epoch: 9 cost time: 1.519277572631836
Epoch: 9, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.219 Vali Acc: 0.947 Test Loss: 0.219 Test Acc: 0.947
Validation loss decreased (-0.935931 --> -0.947073).  Saving model ...
Epoch: 10 cost time: 1.5482673645019531
Epoch: 10, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.194 Vali Acc: 0.953 Test Loss: 0.194 Test Acc: 0.953
Validation loss decreased (-0.947073 --> -0.952644).  Saving model ...
Epoch: 11 cost time: 1.5461094379425049
Epoch: 11, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
Validation loss decreased (-0.952644 --> -0.963090).  Saving model ...
Epoch: 12 cost time: 1.5596692562103271
Epoch: 12, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
Validation loss decreased (-0.963090 --> -0.963090).  Saving model ...
Epoch: 13 cost time: 1.4603872299194336
Epoch: 13, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6041665077209473
Epoch: 14, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
Validation loss decreased (-0.963090 --> -0.972144).  Saving model ...
Epoch: 15 cost time: 1.5169003009796143
Epoch: 15, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 16 cost time: 1.533651351928711
Epoch: 16, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5686111450195312
Epoch: 17, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 18 cost time: 1.6172823905944824
Epoch: 18, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974233).  Saving model ...
Epoch: 19 cost time: 1.554328203201294
Epoch: 19, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 20 cost time: 1.6183407306671143
Epoch: 20, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4984941482543945
Epoch: 21, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4808416366577148
Epoch: 22, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 23 cost time: 1.4974632263183594
Epoch: 23, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.563258171081543
Epoch: 24, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.564682960510254
Epoch: 25, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4886634349822998
Epoch: 26, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5737648010253906
Epoch: 27, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 28 cost time: 1.61317777633667
Epoch: 28, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4783270359039307
Epoch: 29, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4812109470367432
Epoch: 30, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 31 cost time: 1.480545997619629
Epoch: 31, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.654085636138916
Epoch: 32, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5229873657226562
Epoch: 33, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5087296962738037
Epoch: 34, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 35 cost time: 1.7681925296783447
Epoch: 35, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 36 cost time: 1.7100129127502441
Epoch: 36, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6447207927703857
Epoch: 37, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7178926467895508
Epoch: 38, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.7236261367797852
Epoch: 39, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.7727742195129395
Epoch: 40, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.6722991466522217
Epoch: 41, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.769038200378418
Epoch: 42, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.6645941734313965
Epoch: 43, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.5281078815460205
Epoch: 44, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 45 cost time: 1.663053274154663
Epoch: 45, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.5355350971221924
Epoch: 46, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.588801622390747
Epoch: 47, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.5899899005889893
Epoch: 48, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.7416791915893555
Epoch: 49, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.5814721584320068
Epoch: 50, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.6922435760498047
Epoch: 51, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.6872785091400146
Epoch: 52, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.5422005653381348
Epoch: 53, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.5781521797180176
Epoch: 54, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el2_dm16_nh4_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 14068
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.788243055343628
Epoch: 1, Steps: 89 | Train Loss: 1.217 Vali Loss: 0.659 Vali Acc: 0.826 Test Loss: 0.659 Test Acc: 0.826
Validation loss decreased (inf --> -0.825899).  Saving model ...
Epoch: 2 cost time: 3.2361457347869873
Epoch: 2, Steps: 89 | Train Loss: 0.459 Vali Loss: 0.397 Vali Acc: 0.909 Test Loss: 0.397 Test Acc: 0.909
Validation loss decreased (-0.825899 --> -0.908770).  Saving model ...
Epoch: 3 cost time: 3.3206050395965576
Epoch: 3, Steps: 89 | Train Loss: 0.351 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2851130962371826
Epoch: 4, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.351 Vali Acc: 0.931 Test Loss: 0.351 Test Acc: 0.931
Validation loss decreased (-0.908770 --> -0.931055).  Saving model ...
Epoch: 5 cost time: 3.270782947540283
Epoch: 5, Steps: 89 | Train Loss: 0.470 Vali Loss: 0.781 Vali Acc: 0.886 Test Loss: 0.781 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2342753410339355
Epoch: 6, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.657 Vali Acc: 0.908 Test Loss: 0.657 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.041419506072998
Epoch: 7, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.432 Vali Acc: 0.950 Test Loss: 0.432 Test Acc: 0.950
Validation loss decreased (-0.931055 --> -0.949856).  Saving model ...
Epoch: 8 cost time: 3.005631685256958
Epoch: 8, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.546 Vali Acc: 0.919 Test Loss: 0.546 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4531641006469727
Epoch: 9, Steps: 89 | Train Loss: 0.355 Vali Loss: 0.751 Vali Acc: 0.919 Test Loss: 0.751 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.262730360031128
Epoch: 10, Steps: 89 | Train Loss: 0.345 Vali Loss: 0.526 Vali Acc: 0.948 Test Loss: 0.526 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.234560251235962
Epoch: 11, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.494 Vali Acc: 0.945 Test Loss: 0.494 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.462437629699707
Epoch: 12, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.309 Vali Acc: 0.969 Test Loss: 0.309 Test Acc: 0.969
Validation loss decreased (-0.949856 --> -0.969356).  Saving model ...
Epoch: 13 cost time: 2.4057435989379883
Epoch: 13, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.590 Vali Acc: 0.948 Test Loss: 0.590 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2811124324798584
Epoch: 14, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.498 Vali Acc: 0.963 Test Loss: 0.498 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6270899772644043
Epoch: 15, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.959 Vali Acc: 0.931 Test Loss: 0.959 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5030646324157715
Epoch: 16, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.571 Vali Acc: 0.957 Test Loss: 0.571 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7399322986602783
Epoch: 17, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.668 Vali Acc: 0.955 Test Loss: 0.668 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5524790287017822
Epoch: 18, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.596 Vali Acc: 0.947 Test Loss: 0.596 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5395753383636475
Epoch: 19, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.707 Vali Acc: 0.942 Test Loss: 0.707 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.811345100402832
Epoch: 20, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.436 Vali Acc: 0.964 Test Loss: 0.436 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4718799591064453
Epoch: 21, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.805 Vali Acc: 0.947 Test Loss: 0.805 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.693988561630249
Epoch: 22, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.887 Vali Acc: 0.940 Test Loss: 0.887 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 601876
model size : 4.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9209606647491455
Epoch: 1, Steps: 89 | Train Loss: 1.316 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
Validation loss decreased (inf --> -0.875344).  Saving model ...
Epoch: 2 cost time: 3.078705310821533
Epoch: 2, Steps: 89 | Train Loss: 0.387 Vali Loss: 0.324 Vali Acc: 0.915 Test Loss: 0.324 Test Acc: 0.915
Validation loss decreased (-0.875344 --> -0.915039).  Saving model ...
Epoch: 3 cost time: 3.1037487983703613
Epoch: 3, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.915039 --> -0.940805).  Saving model ...
Epoch: 4 cost time: 3.4899227619171143
Epoch: 4, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.234 Vali Acc: 0.952 Test Loss: 0.234 Test Acc: 0.952
Validation loss decreased (-0.940805 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 3.119696617126465
Epoch: 5, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.350 Vali Acc: 0.928 Test Loss: 0.350 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2089860439300537
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.226 Vali Acc: 0.956 Test Loss: 0.226 Test Acc: 0.956
Validation loss decreased (-0.951948 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 3.3830225467681885
Epoch: 7, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.229 Vali Acc: 0.960 Test Loss: 0.229 Test Acc: 0.960
Validation loss decreased (-0.956126 --> -0.959608).  Saving model ...
Epoch: 8 cost time: 3.0881235599517822
Epoch: 8, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.366 Vali Acc: 0.939 Test Loss: 0.366 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.208406686782837
Epoch: 9, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.303 Vali Acc: 0.958 Test Loss: 0.303 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3798303604125977
Epoch: 10, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.326 Vali Acc: 0.952 Test Loss: 0.326 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.115980386734009
Epoch: 11, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.334 Vali Acc: 0.942 Test Loss: 0.334 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1119608879089355
Epoch: 12, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.344 Vali Acc: 0.942 Test Loss: 0.344 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.30462646484375
Epoch: 13, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.378 Vali Acc: 0.953 Test Loss: 0.378 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.024125337600708
Epoch: 14, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.341 Vali Acc: 0.964 Test Loss: 0.341 Test Acc: 0.964
Validation loss decreased (-0.959608 --> -0.964481).  Saving model ...
Epoch: 15 cost time: 2.9223995208740234
Epoch: 15, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.476 Vali Acc: 0.951 Test Loss: 0.476 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9563653469085693
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.604 Vali Acc: 0.924 Test Loss: 0.604 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1167478561401367
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.335 Vali Acc: 0.960 Test Loss: 0.335 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.3883235454559326
Epoch: 18, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.355 Vali Acc: 0.952 Test Loss: 0.355 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.0054171085357666
Epoch: 19, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.504 Vali Acc: 0.946 Test Loss: 0.504 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.9445109367370605
Epoch: 20, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.362 Vali Acc: 0.960 Test Loss: 0.362 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3059487342834473
Epoch: 21, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.529 Vali Acc: 0.953 Test Loss: 0.529 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9817442893981934
Epoch: 22, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.857 Vali Acc: 0.922 Test Loss: 0.857 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.891385316848755
Epoch: 23, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.373 Vali Acc: 0.963 Test Loss: 0.373 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.1396901607513428
Epoch: 24, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.639 Vali Acc: 0.951 Test Loss: 0.639 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 410516
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7517545223236084
Epoch: 1, Steps: 89 | Train Loss: 1.398 Vali Loss: 0.605 Vali Acc: 0.806 Test Loss: 0.605 Test Acc: 0.806
Validation loss decreased (inf --> -0.805704).  Saving model ...
Epoch: 2 cost time: 2.0201785564422607
Epoch: 2, Steps: 89 | Train Loss: 0.414 Vali Loss: 0.323 Vali Acc: 0.913 Test Loss: 0.323 Test Acc: 0.913
Validation loss decreased (-0.805704 --> -0.912949).  Saving model ...
Epoch: 3 cost time: 2.0990617275238037
Epoch: 3, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
Validation loss decreased (-0.912949 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 2.0859391689300537
Epoch: 4, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
Validation loss decreased (-0.929663 --> -0.952644).  Saving model ...
Epoch: 5 cost time: 2.455751657485962
Epoch: 5, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
Validation loss decreased (-0.952644 --> -0.956126).  Saving model ...
Epoch: 6 cost time: 2.052962064743042
Epoch: 6, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.264 Vali Acc: 0.932 Test Loss: 0.264 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.508617877960205
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2716002464294434
Epoch: 8, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.430 Vali Acc: 0.919 Test Loss: 0.430 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8919198513031006
Epoch: 9, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.251 Vali Acc: 0.953 Test Loss: 0.251 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.294066905975342
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.223 Vali Acc: 0.963 Test Loss: 0.223 Test Acc: 0.963
Validation loss decreased (-0.956126 --> -0.963090).  Saving model ...
Epoch: 11 cost time: 2.352428436279297
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.241 Vali Acc: 0.951 Test Loss: 0.241 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6190812587738037
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.250 Vali Acc: 0.964 Test Loss: 0.250 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.964482).  Saving model ...
Epoch: 13 cost time: 2.561541795730591
Epoch: 13, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.351 Vali Acc: 0.937 Test Loss: 0.351 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.294213056564331
Epoch: 14, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.243 Vali Acc: 0.953 Test Loss: 0.243 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2033939361572266
Epoch: 15, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.598 Vali Acc: 0.903 Test Loss: 0.598 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.265321731567383
Epoch: 16, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.661 Vali Acc: 0.903 Test Loss: 0.661 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.9839422702789307
Epoch: 17, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.382 Vali Acc: 0.948 Test Loss: 0.382 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.201378583908081
Epoch: 18, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.323 Vali Acc: 0.946 Test Loss: 0.323 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.1604926586151123
Epoch: 19, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.510 Vali Acc: 0.921 Test Loss: 0.510 Test Acc: 0.921
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.8240559101104736
Epoch: 20, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.310 Vali Acc: 0.962 Test Loss: 0.310 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.0610196590423584
Epoch: 21, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.2804982662200928
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.385 Vali Acc: 0.948 Test Loss: 0.385 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 334228
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3594448566436768
Epoch: 1, Steps: 89 | Train Loss: 1.495 Vali Loss: 0.630 Vali Acc: 0.807 Test Loss: 0.630 Test Acc: 0.807
Validation loss decreased (inf --> -0.807097).  Saving model ...
Epoch: 2 cost time: 2.2836685180664062
Epoch: 2, Steps: 89 | Train Loss: 0.402 Vali Loss: 0.329 Vali Acc: 0.916 Test Loss: 0.329 Test Acc: 0.916
Validation loss decreased (-0.807097 --> -0.915735).  Saving model ...
Epoch: 3 cost time: 2.049204111099243
Epoch: 3, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.142366886138916
Epoch: 4, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.915735 --> -0.933146).  Saving model ...
Epoch: 5 cost time: 2.2009360790252686
Epoch: 5, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.933146 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 2.2179713249206543
Epoch: 6, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
Validation loss decreased (-0.956823 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 2.306734561920166
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.236647605895996
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 2.100653648376465
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.071279525756836
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.034027576446533
Epoch: 11, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.195 Vali Acc: 0.966 Test Loss: 0.195 Test Acc: 0.966
Validation loss decreased (-0.962394 --> -0.965875).  Saving model ...
Epoch: 12 cost time: 2.1842565536499023
Epoch: 12, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1642282009124756
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.193 Vali Acc: 0.960 Test Loss: 0.193 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1114187240600586
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.210 Vali Acc: 0.960 Test Loss: 0.210 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.099691152572632
Epoch: 15, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1275577545166016
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
Validation loss decreased (-0.965875 --> -0.966572).  Saving model ...
Epoch: 17 cost time: 1.9072701930999756
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.282 Vali Acc: 0.958 Test Loss: 0.282 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9119112491607666
Epoch: 18, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.249 Vali Acc: 0.965 Test Loss: 0.249 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.995685338973999
Epoch: 19, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
Validation loss decreased (-0.966572 --> -0.972143).  Saving model ...
Epoch: 20 cost time: 1.9689335823059082
Epoch: 20, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.375 Vali Acc: 0.937 Test Loss: 0.375 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9160850048065186
Epoch: 21, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.315 Vali Acc: 0.955 Test Loss: 0.315 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9820506572723389
Epoch: 22, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.077608823776245
Epoch: 23, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.358 Vali Acc: 0.949 Test Loss: 0.358 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.060865879058838
Epoch: 24, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.972143 --> -0.974928).  Saving model ...
Epoch: 25 cost time: 1.9287827014923096
Epoch: 25, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.322 Vali Acc: 0.952 Test Loss: 0.322 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9627444744110107
Epoch: 26, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.416 Vali Acc: 0.944 Test Loss: 0.416 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9190919399261475
Epoch: 27, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.372 Vali Acc: 0.952 Test Loss: 0.372 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9121575355529785
Epoch: 28, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.390 Vali Acc: 0.951 Test Loss: 0.390 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9667067527770996
Epoch: 29, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.289 Vali Acc: 0.967 Test Loss: 0.289 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9014503955841064
Epoch: 30, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.277 Vali Acc: 0.967 Test Loss: 0.277 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.801123857498169
Epoch: 31, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.246 Vali Acc: 0.967 Test Loss: 0.246 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.06915283203125
Epoch: 32, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.297 Vali Acc: 0.964 Test Loss: 0.297 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6816143989562988
Epoch: 33, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.232 Vali Acc: 0.976 Test Loss: 0.232 Test Acc: 0.976
Validation loss decreased (-0.974928 --> -0.976321).  Saving model ...
Epoch: 34 cost time: 2.097456216812134
Epoch: 34, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.391 Vali Acc: 0.944 Test Loss: 0.391 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1084842681884766
Epoch: 35, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.0840675830841064
Epoch: 36, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.272 Vali Acc: 0.969 Test Loss: 0.272 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.2414257526397705
Epoch: 37, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.222 Vali Acc: 0.972 Test Loss: 0.222 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.311349391937256
Epoch: 38, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.307 Vali Acc: 0.962 Test Loss: 0.307 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.213705062866211
Epoch: 39, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.314 Vali Acc: 0.969 Test Loss: 0.314 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.3753433227539062
Epoch: 40, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.397 Vali Acc: 0.963 Test Loss: 0.397 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.2939693927764893
Epoch: 41, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.265 Vali Acc: 0.973 Test Loss: 0.265 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.1947851181030273
Epoch: 42, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.297 Vali Acc: 0.967 Test Loss: 0.297 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.1857240200042725
Epoch: 43, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.315 Vali Acc: 0.965 Test Loss: 0.315 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 273428
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.275446653366089
Epoch: 1, Steps: 89 | Train Loss: 1.636 Vali Loss: 0.595 Vali Acc: 0.840 Test Loss: 0.595 Test Acc: 0.840
Validation loss decreased (inf --> -0.839827).  Saving model ...
Epoch: 2 cost time: 1.956477403640747
Epoch: 2, Steps: 89 | Train Loss: 0.431 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
Validation loss decreased (-0.839827 --> -0.935234).  Saving model ...
Epoch: 3 cost time: 2.088087320327759
Epoch: 3, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
Validation loss decreased (-0.935234 --> -0.956823).  Saving model ...
Epoch: 4 cost time: 2.094722270965576
Epoch: 4, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.256 Vali Acc: 0.912 Test Loss: 0.256 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.263493061065674
Epoch: 5, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.078115463256836
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.147 Vali Acc: 0.961 Test Loss: 0.147 Test Acc: 0.961
Validation loss decreased (-0.956823 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 2.0039327144622803
Epoch: 7, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0952682495117188
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
Validation loss decreased (-0.961001 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 1.983398675918579
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 2.0654940605163574
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.092426061630249
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.010969400405884
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 13 cost time: 2.0691120624542236
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.091521739959717
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974233).  Saving model ...
Epoch: 15 cost time: 2.039525270462036
Epoch: 15, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.210 Vali Acc: 0.961 Test Loss: 0.210 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7199862003326416
Epoch: 16, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9760403633117676
Epoch: 17, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9492406845092773
Epoch: 18, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9366059303283691
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 20 cost time: 1.9195518493652344
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9661891460418701
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.214 Vali Acc: 0.971 Test Loss: 0.214 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8631958961486816
Epoch: 22, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.950247049331665
Epoch: 23, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.193 Vali Acc: 0.970 Test Loss: 0.193 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.90378999710083
Epoch: 24, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.258 Vali Acc: 0.955 Test Loss: 0.258 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8935637474060059
Epoch: 25, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.423 Vali Acc: 0.914 Test Loss: 0.423 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8891043663024902
Epoch: 26, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.404 Vali Acc: 0.939 Test Loss: 0.404 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.858562707901001
Epoch: 27, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8573131561279297
Epoch: 28, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.253 Vali Acc: 0.962 Test Loss: 0.253 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9070587158203125
Epoch: 29, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.327 Vali Acc: 0.955 Test Loss: 0.327 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 236180
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2555272579193115
Epoch: 1, Steps: 89 | Train Loss: 1.805 Vali Loss: 0.732 Vali Acc: 0.782 Test Loss: 0.732 Test Acc: 0.782
Validation loss decreased (inf --> -0.782026).  Saving model ...
Epoch: 2 cost time: 1.9690544605255127
Epoch: 2, Steps: 89 | Train Loss: 0.536 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
Validation loss decreased (-0.782026 --> -0.874648).  Saving model ...
Epoch: 3 cost time: 2.0823240280151367
Epoch: 3, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
Validation loss decreased (-0.874648 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 2.0660297870635986
Epoch: 4, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.221 Vali Acc: 0.932 Test Loss: 0.221 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0832502841949463
Epoch: 5, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.153 Vali Acc: 0.952 Test Loss: 0.153 Test Acc: 0.952
Validation loss decreased (-0.942895 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 2.124594211578369
Epoch: 6, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.951948 --> -0.968662).  Saving model ...
Epoch: 7 cost time: 1.9923739433288574
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
Validation loss decreased (-0.968662 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 2.0482125282287598
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.01568865776062
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1964094638824463
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9728553295135498
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1579833030700684
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0961313247680664
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9944403171539307
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.974 Test Loss: 0.149 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9678850173950195
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.028536796569824
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.030956745147705
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 206612
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1200010776519775
Epoch: 1, Steps: 89 | Train Loss: 1.871 Vali Loss: 0.763 Vali Acc: 0.808 Test Loss: 0.763 Test Acc: 0.808
Validation loss decreased (inf --> -0.807792).  Saving model ...
Epoch: 2 cost time: 2.0755186080932617
Epoch: 2, Steps: 89 | Train Loss: 0.553 Vali Loss: 0.384 Vali Acc: 0.886 Test Loss: 0.384 Test Acc: 0.886
Validation loss decreased (-0.807792 --> -0.885790).  Saving model ...
Epoch: 3 cost time: 1.9670302867889404
Epoch: 3, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
Validation loss decreased (-0.885790 --> -0.922003).  Saving model ...
Epoch: 4 cost time: 1.9972546100616455
Epoch: 4, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
Validation loss decreased (-0.922003 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 1.9198131561279297
Epoch: 5, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9448113441467285
Epoch: 6, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 2.0613114833831787
Epoch: 7, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.967269 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 1.9378807544708252
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8147611618041992
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.977715).  Saving model ...
Epoch: 10 cost time: 1.8663008213043213
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8777563571929932
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8283278942108154
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
Validation loss decreased (-0.977715 --> -0.983982).  Saving model ...
Epoch: 13 cost time: 1.8793971538543701
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.816016674041748
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8114004135131836
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9842298030853271
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8082761764526367
Epoch: 17, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8904132843017578
Epoch: 18, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9436993598937988
Epoch: 19, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.820180892944336
Epoch: 20, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7797448635101318
Epoch: 21, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7942376136779785
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.243 Vali Acc: 0.953 Test Loss: 0.243 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 192404
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.901115655899048
Epoch: 1, Steps: 89 | Train Loss: 1.212 Vali Loss: 0.608 Vali Acc: 0.843 Test Loss: 0.608 Test Acc: 0.843
Validation loss decreased (inf --> -0.842612).  Saving model ...
Epoch: 2 cost time: 3.5822815895080566
Epoch: 2, Steps: 89 | Train Loss: 0.465 Vali Loss: 0.547 Vali Acc: 0.882 Test Loss: 0.547 Test Acc: 0.882
Validation loss decreased (-0.842612 --> -0.882307).  Saving model ...
Epoch: 3 cost time: 3.499682664871216
Epoch: 3, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
Validation loss decreased (-0.882307 --> -0.888574).  Saving model ...
Epoch: 4 cost time: 3.6659820079803467
Epoch: 4, Steps: 89 | Train Loss: 0.357 Vali Loss: 0.521 Vali Acc: 0.893 Test Loss: 0.521 Test Acc: 0.893
Validation loss decreased (-0.888574 --> -0.892752).  Saving model ...
Epoch: 5 cost time: 3.453061580657959
Epoch: 5, Steps: 89 | Train Loss: 0.339 Vali Loss: 0.375 Vali Acc: 0.937 Test Loss: 0.375 Test Acc: 0.937
Validation loss decreased (-0.892752 --> -0.936626).  Saving model ...
Epoch: 6 cost time: 3.6822755336761475
Epoch: 6, Steps: 89 | Train Loss: 0.318 Vali Loss: 0.341 Vali Acc: 0.952 Test Loss: 0.341 Test Acc: 0.952
Validation loss decreased (-0.936626 --> -0.951946).  Saving model ...
Epoch: 7 cost time: 3.62365460395813
Epoch: 7, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.458 Vali Acc: 0.942 Test Loss: 0.458 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7892537117004395
Epoch: 8, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.373 Vali Acc: 0.958 Test Loss: 0.373 Test Acc: 0.958
Validation loss decreased (-0.951946 --> -0.957517).  Saving model ...
Epoch: 9 cost time: 3.606081008911133
Epoch: 9, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.761 Vali Acc: 0.910 Test Loss: 0.761 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.807257890701294
Epoch: 10, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.617 Vali Acc: 0.942 Test Loss: 0.617 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.640491008758545
Epoch: 11, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.491 Vali Acc: 0.958 Test Loss: 0.491 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.753365993499756
Epoch: 12, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.402 Vali Acc: 0.969 Test Loss: 0.402 Test Acc: 0.969
Validation loss decreased (-0.957517 --> -0.968659).  Saving model ...
Epoch: 13 cost time: 3.656066656112671
Epoch: 13, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.646 Vali Acc: 0.947 Test Loss: 0.646 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.681142807006836
Epoch: 14, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.771 Vali Acc: 0.941 Test Loss: 0.771 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7791953086853027
Epoch: 15, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.816 Vali Acc: 0.945 Test Loss: 0.816 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7389028072357178
Epoch: 16, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.947 Vali Acc: 0.937 Test Loss: 0.947 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.692854642868042
Epoch: 17, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.587 Vali Acc: 0.963 Test Loss: 0.587 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.481801748275757
Epoch: 18, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.607 Vali Acc: 0.951 Test Loss: 0.607 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.7046802043914795
Epoch: 19, Steps: 89 | Train Loss: 0.207 Vali Loss: 1.464 Vali Acc: 0.883 Test Loss: 1.464 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.7554798126220703
Epoch: 20, Steps: 89 | Train Loss: 0.201 Vali Loss: 1.109 Vali Acc: 0.932 Test Loss: 1.109 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.839632511138916
Epoch: 21, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.857 Vali Acc: 0.947 Test Loss: 0.857 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.299159526824951
Epoch: 22, Steps: 89 | Train Loss: 0.109 Vali Loss: 1.191 Vali Acc: 0.927 Test Loss: 1.191 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 568980
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.02379298210144
Epoch: 1, Steps: 89 | Train Loss: 1.273 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
Validation loss decreased (inf --> -0.855148).  Saving model ...
Epoch: 2 cost time: 2.4043643474578857
Epoch: 2, Steps: 89 | Train Loss: 0.392 Vali Loss: 0.560 Vali Acc: 0.865 Test Loss: 0.560 Test Acc: 0.865
Validation loss decreased (-0.855148 --> -0.864897).  Saving model ...
Epoch: 3 cost time: 2.7446391582489014
Epoch: 3, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.864897 --> -0.940806).  Saving model ...
Epoch: 4 cost time: 2.2200570106506348
Epoch: 4, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.350 Vali Acc: 0.923 Test Loss: 0.350 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.654109477996826
Epoch: 5, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.258 Vali Acc: 0.939 Test Loss: 0.258 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.514591693878174
Epoch: 6, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.541 Vali Acc: 0.891 Test Loss: 0.541 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.592599868774414
Epoch: 7, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.222 Vali Acc: 0.964 Test Loss: 0.222 Test Acc: 0.964
Validation loss decreased (-0.940806 --> -0.964482).  Saving model ...
Epoch: 8 cost time: 2.779183864593506
Epoch: 8, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.497 Vali Acc: 0.902 Test Loss: 0.497 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6785223484039307
Epoch: 9, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.384 Vali Acc: 0.939 Test Loss: 0.384 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4071574211120605
Epoch: 10, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.505 Vali Acc: 0.919 Test Loss: 0.505 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.5254828929901123
Epoch: 11, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.626 Vali Acc: 0.921 Test Loss: 0.626 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.832199811935425
Epoch: 12, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.391 Vali Acc: 0.944 Test Loss: 0.391 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.595393419265747
Epoch: 13, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.401 Vali Acc: 0.945 Test Loss: 0.401 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.5996930599212646
Epoch: 14, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.434 Vali Acc: 0.951 Test Loss: 0.434 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.598867893218994
Epoch: 15, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.303 Vali Acc: 0.961 Test Loss: 0.303 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.5037832260131836
Epoch: 16, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.636 Vali Acc: 0.925 Test Loss: 0.636 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.858729839324951
Epoch: 17, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.572 Vali Acc: 0.942 Test Loss: 0.572 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 377620
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.529768705368042
Epoch: 1, Steps: 89 | Train Loss: 1.359 Vali Loss: 0.547 Vali Acc: 0.836 Test Loss: 0.547 Test Acc: 0.836
Validation loss decreased (inf --> -0.835649).  Saving model ...
Epoch: 2 cost time: 3.3975884914398193
Epoch: 2, Steps: 89 | Train Loss: 0.397 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.835649 --> -0.902504).  Saving model ...
Epoch: 3 cost time: 3.376474618911743
Epoch: 3, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.902504 --> -0.948466).  Saving model ...
Epoch: 4 cost time: 3.2908053398132324
Epoch: 4, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
Validation loss decreased (-0.948466 --> -0.956126).  Saving model ...
Epoch: 5 cost time: 3.4475162029266357
Epoch: 5, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
Validation loss decreased (-0.956126 --> -0.959608).  Saving model ...
Epoch: 6 cost time: 3.2998111248016357
Epoch: 6, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.382 Vali Acc: 0.933 Test Loss: 0.382 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.273231267929077
Epoch: 7, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.318 Vali Acc: 0.926 Test Loss: 0.318 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0416202545166016
Epoch: 8, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.959608 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 3.403129816055298
Epoch: 9, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.231 Vali Acc: 0.956 Test Loss: 0.231 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.338805913925171
Epoch: 10, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.962394 --> -0.962394).  Saving model ...
Epoch: 11 cost time: 3.2095305919647217
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 3.678328514099121
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.374 Vali Acc: 0.946 Test Loss: 0.374 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2102015018463135
Epoch: 13, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.193 Vali Acc: 0.974 Test Loss: 0.193 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 14 cost time: 2.525684118270874
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.230 Vali Acc: 0.964 Test Loss: 0.230 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7990479469299316
Epoch: 15, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.238 Vali Acc: 0.962 Test Loss: 0.238 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.252628803253174
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.571 Vali Acc: 0.929 Test Loss: 0.571 Test Acc: 0.929
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7490036487579346
Epoch: 17, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.422 Vali Acc: 0.937 Test Loss: 0.422 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5693626403808594
Epoch: 18, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.364 Vali Acc: 0.955 Test Loss: 0.364 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.560520648956299
Epoch: 19, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.244 Vali Acc: 0.969 Test Loss: 0.244 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.6168062686920166
Epoch: 20, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.322 Vali Acc: 0.951 Test Loss: 0.322 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.1043970584869385
Epoch: 21, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.375 Vali Acc: 0.959 Test Loss: 0.375 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2113399505615234
Epoch: 22, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.317 Vali Acc: 0.957 Test Loss: 0.317 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.8577709197998047
Epoch: 23, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.276 Vali Acc: 0.963 Test Loss: 0.276 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 301332
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.493241310119629
Epoch: 1, Steps: 89 | Train Loss: 1.441 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
Validation loss decreased (inf --> -0.837738).  Saving model ...
Epoch: 2 cost time: 2.319002866744995
Epoch: 2, Steps: 89 | Train Loss: 0.412 Vali Loss: 0.347 Vali Acc: 0.898 Test Loss: 0.347 Test Acc: 0.898
Validation loss decreased (-0.837738 --> -0.898325).  Saving model ...
Epoch: 3 cost time: 2.2267584800720215
Epoch: 3, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.397 Vali Acc: 0.887 Test Loss: 0.397 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3699872493743896
Epoch: 4, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.898325 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 2.3628990650177
Epoch: 5, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3421661853790283
Epoch: 6, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
Validation loss decreased (-0.954037 --> -0.968661).  Saving model ...
Epoch: 7 cost time: 2.2727954387664795
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4038326740264893
Epoch: 8, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.968661 --> -0.973536).  Saving model ...
Epoch: 9 cost time: 2.2458505630493164
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.321608304977417
Epoch: 10, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2073209285736084
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.436269760131836
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2008256912231445
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.414912462234497
Epoch: 14, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.213773250579834
Epoch: 15, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.345 Vali Acc: 0.944 Test Loss: 0.345 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.327913284301758
Epoch: 16, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.365 Vali Acc: 0.942 Test Loss: 0.365 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.279970407485962
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.179 Vali Acc: 0.969 Test Loss: 0.179 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.46626353263855
Epoch: 18, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.220 Vali Acc: 0.968 Test Loss: 0.220 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 240532
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6270618438720703
Epoch: 1, Steps: 89 | Train Loss: 1.570 Vali Loss: 0.573 Vali Acc: 0.848 Test Loss: 0.573 Test Acc: 0.848
Validation loss decreased (inf --> -0.848184).  Saving model ...
Epoch: 2 cost time: 2.332585096359253
Epoch: 2, Steps: 89 | Train Loss: 0.458 Vali Loss: 0.330 Vali Acc: 0.901 Test Loss: 0.330 Test Acc: 0.901
Validation loss decreased (-0.848184 --> -0.901111).  Saving model ...
Epoch: 3 cost time: 2.294092893600464
Epoch: 3, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
Validation loss decreased (-0.901111 --> -0.924789).  Saving model ...
Epoch: 4 cost time: 2.301553726196289
Epoch: 4, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
Validation loss decreased (-0.924789 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 2.344420909881592
Epoch: 5, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.939413 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 2.2114949226379395
Epoch: 6, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
Validation loss decreased (-0.954037 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 1.8594741821289062
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.93690824508667
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9957692623138428
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.007244348526001
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.042567014694214
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9354372024536133
Epoch: 12, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9238698482513428
Epoch: 13, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6346461772918701
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0873939990997314
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9717190265655518
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.250 Vali Acc: 0.948 Test Loss: 0.250 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 203284
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6353518962860107
Epoch: 1, Steps: 89 | Train Loss: 1.830 Vali Loss: 0.726 Vali Acc: 0.801 Test Loss: 0.726 Test Acc: 0.801
Validation loss decreased (inf --> -0.800828).  Saving model ...
Epoch: 2 cost time: 2.0657761096954346
Epoch: 2, Steps: 89 | Train Loss: 0.535 Vali Loss: 0.340 Vali Acc: 0.907 Test Loss: 0.340 Test Acc: 0.907
Validation loss decreased (-0.800828 --> -0.906682).  Saving model ...
Epoch: 3 cost time: 2.1859018802642822
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.224 Vali Acc: 0.943 Test Loss: 0.224 Test Acc: 0.943
Validation loss decreased (-0.906682 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 2.1081764698028564
Epoch: 4, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
Validation loss decreased (-0.942895 --> -0.958912).  Saving model ...
Epoch: 5 cost time: 2.214021921157837
Epoch: 5, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1308774948120117
Epoch: 6, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 2.3998825550079346
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.116 Vali Acc: 0.963 Test Loss: 0.116 Test Acc: 0.963
Validation loss decreased (-0.960305 --> -0.963091).  Saving model ...
Epoch: 8 cost time: 2.633854866027832
Epoch: 8, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5644688606262207
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.963091 --> -0.977019).  Saving model ...
Epoch: 10 cost time: 2.5013372898101807
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.82322096824646
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.717020273208618
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.661468505859375
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6754353046417236
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 15 cost time: 2.650904893875122
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5789599418640137
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.753760814666748
Epoch: 17, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5714573860168457
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.713024854660034
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.7784245014190674
Epoch: 20, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.250 Vali Acc: 0.951 Test Loss: 0.250 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.42423677444458
Epoch: 21, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.601606845855713
Epoch: 22, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.251 Vali Acc: 0.940 Test Loss: 0.251 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7483198642730713
Epoch: 23, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6641016006469727
Epoch: 24, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.244 Vali Acc: 0.947 Test Loss: 0.244 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 173716
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8389992713928223
Epoch: 1, Steps: 89 | Train Loss: 1.866 Vali Loss: 0.769 Vali Acc: 0.820 Test Loss: 0.769 Test Acc: 0.820
Validation loss decreased (inf --> -0.820327).  Saving model ...
Epoch: 2 cost time: 2.441527843475342
Epoch: 2, Steps: 89 | Train Loss: 0.562 Vali Loss: 0.365 Vali Acc: 0.911 Test Loss: 0.365 Test Acc: 0.911
Validation loss decreased (-0.820327 --> -0.910860).  Saving model ...
Epoch: 3 cost time: 2.745091676712036
Epoch: 3, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.910860 --> -0.931056).  Saving model ...
Epoch: 4 cost time: 2.813533306121826
Epoch: 4, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
Validation loss decreased (-0.931056 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 1.8418817520141602
Epoch: 5, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
Validation loss decreased (-0.953341 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 2.1669726371765137
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 2.16943097114563
Epoch: 7, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 1.8947455883026123
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.290550470352173
Epoch: 9, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 2.420908212661743
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 11 cost time: 1.998798131942749
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.397019147872925
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.232334613800049
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.166794538497925
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.083 Vali Acc: 0.974 Test Loss: 0.083 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 15 cost time: 2.4645771980285645
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.978412).  Saving model ...
Epoch: 16 cost time: 2.2144980430603027
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.064135789871216
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.342712163925171
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.063502073287964
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0952460765838623
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.635756254196167
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4120728969573975
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7664005756378174
Epoch: 23, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.225 Vali Acc: 0.947 Test Loss: 0.225 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.715723991394043
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.567981004714966
Epoch: 25, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.237 Vali Acc: 0.955 Test Loss: 0.237 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 159508
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.69318699836731
Epoch: 1, Steps: 89 | Train Loss: 1.149 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
Validation loss decreased (inf --> -0.848184).  Saving model ...
Epoch: 2 cost time: 4.439963340759277
Epoch: 2, Steps: 89 | Train Loss: 0.423 Vali Loss: 0.422 Vali Acc: 0.904 Test Loss: 0.422 Test Acc: 0.904
Validation loss decreased (-0.848184 --> -0.903895).  Saving model ...
Epoch: 3 cost time: 4.838543653488159
Epoch: 3, Steps: 89 | Train Loss: 0.329 Vali Loss: 0.608 Vali Acc: 0.889 Test Loss: 0.608 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.516581773757935
Epoch: 4, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.625 Vali Acc: 0.891 Test Loss: 0.625 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.768856048583984
Epoch: 5, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.445 Vali Acc: 0.930 Test Loss: 0.445 Test Acc: 0.930
Validation loss decreased (-0.903895 --> -0.930358).  Saving model ...
Epoch: 6 cost time: 4.569627285003662
Epoch: 6, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.433 Vali Acc: 0.938 Test Loss: 0.433 Test Acc: 0.938
Validation loss decreased (-0.930358 --> -0.938018).  Saving model ...
Epoch: 7 cost time: 4.554858446121216
Epoch: 7, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.587 Vali Acc: 0.918 Test Loss: 0.587 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.99540114402771
Epoch: 8, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.711 Vali Acc: 0.912 Test Loss: 0.711 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.325656414031982
Epoch: 9, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.495 Vali Acc: 0.928 Test Loss: 0.495 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.626514673233032
Epoch: 10, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.773 Vali Acc: 0.921 Test Loss: 0.773 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.939410448074341
Epoch: 11, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.415 Vali Acc: 0.956 Test Loss: 0.415 Test Acc: 0.956
Validation loss decreased (-0.938018 --> -0.956124).  Saving model ...
Epoch: 12 cost time: 4.083853244781494
Epoch: 12, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.555 Vali Acc: 0.952 Test Loss: 0.555 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.905371189117432
Epoch: 13, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.721 Vali Acc: 0.946 Test Loss: 0.721 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.525206565856934
Epoch: 14, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.475 Vali Acc: 0.962 Test Loss: 0.475 Test Acc: 0.962
Validation loss decreased (-0.956124 --> -0.961694).  Saving model ...
Epoch: 15 cost time: 4.270681619644165
Epoch: 15, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.646 Vali Acc: 0.949 Test Loss: 0.646 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.942591190338135
Epoch: 16, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.844 Vali Acc: 0.948 Test Loss: 0.844 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.504003286361694
Epoch: 17, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.545 Vali Acc: 0.958 Test Loss: 0.545 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.9825685024261475
Epoch: 18, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.510 Vali Acc: 0.964 Test Loss: 0.510 Test Acc: 0.964
Validation loss decreased (-0.961694 --> -0.963783).  Saving model ...
Epoch: 19 cost time: 3.5123186111450195
Epoch: 19, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.660 Vali Acc: 0.955 Test Loss: 0.660 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3847763538360596
Epoch: 20, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.851 Vali Acc: 0.948 Test Loss: 0.851 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.352331638336182
Epoch: 21, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.850 Vali Acc: 0.946 Test Loss: 0.850 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6353964805603027
Epoch: 22, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.821 Vali Acc: 0.944 Test Loss: 0.821 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.5702803134918213
Epoch: 23, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.762 Vali Acc: 0.942 Test Loss: 0.762 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.5973455905914307
Epoch: 24, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.674 Vali Acc: 0.959 Test Loss: 0.674 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.4384069442749023
Epoch: 25, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.704 Vali Acc: 0.960 Test Loss: 0.704 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.6107048988342285
Epoch: 26, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.667 Vali Acc: 0.959 Test Loss: 0.667 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.3840625286102295
Epoch: 27, Steps: 89 | Train Loss: 0.150 Vali Loss: 1.250 Vali Acc: 0.919 Test Loss: 1.250 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.9054012298583984
Epoch: 28, Steps: 89 | Train Loss: 0.155 Vali Loss: 1.003 Vali Acc: 0.948 Test Loss: 1.003 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 552532
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.8353517055511475
Epoch: 1, Steps: 89 | Train Loss: 1.314 Vali Loss: 0.676 Vali Acc: 0.838 Test Loss: 0.676 Test Acc: 0.838
Validation loss decreased (inf --> -0.838433).  Saving model ...
Epoch: 2 cost time: 2.770831823348999
Epoch: 2, Steps: 89 | Train Loss: 0.410 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
Validation loss decreased (-0.838433 --> -0.891361).  Saving model ...
Epoch: 3 cost time: 3.8704936504364014
Epoch: 3, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.295 Vali Acc: 0.932 Test Loss: 0.295 Test Acc: 0.932
Validation loss decreased (-0.891361 --> -0.932448).  Saving model ...
Epoch: 4 cost time: 3.7773020267486572
Epoch: 4, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.447 Vali Acc: 0.898 Test Loss: 0.447 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.066428899765015
Epoch: 5, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.323 Vali Acc: 0.931 Test Loss: 0.323 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.450699806213379
Epoch: 6, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.453 Vali Acc: 0.904 Test Loss: 0.453 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.197396755218506
Epoch: 7, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.740 Vali Acc: 0.846 Test Loss: 0.740 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.4918277263641357
Epoch: 8, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.381 Vali Acc: 0.937 Test Loss: 0.381 Test Acc: 0.937
Validation loss decreased (-0.932448 --> -0.937322).  Saving model ...
Epoch: 9 cost time: 3.324704885482788
Epoch: 9, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.782470464706421
Epoch: 10, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.240 Vali Acc: 0.959 Test Loss: 0.240 Test Acc: 0.959
Validation loss decreased (-0.937322 --> -0.958911).  Saving model ...
Epoch: 11 cost time: 3.976198673248291
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.263 Vali Acc: 0.960 Test Loss: 0.263 Test Acc: 0.960
Validation loss decreased (-0.958911 --> -0.960304).  Saving model ...
Epoch: 12 cost time: 3.6630563735961914
Epoch: 12, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.229 Vali Acc: 0.969 Test Loss: 0.229 Test Acc: 0.969
Validation loss decreased (-0.960304 --> -0.969357).  Saving model ...
Epoch: 13 cost time: 4.1760094165802
Epoch: 13, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.289 Vali Acc: 0.961 Test Loss: 0.289 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.892857789993286
Epoch: 14, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.496 Vali Acc: 0.937 Test Loss: 0.496 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.059995412826538
Epoch: 15, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.336 Vali Acc: 0.966 Test Loss: 0.336 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.849771499633789
Epoch: 16, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.288 Vali Acc: 0.967 Test Loss: 0.288 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.067754745483398
Epoch: 17, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.398 Vali Acc: 0.954 Test Loss: 0.398 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.849231481552124
Epoch: 18, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.256 Vali Acc: 0.965 Test Loss: 0.256 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.189618825912476
Epoch: 19, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.480 Vali Acc: 0.942 Test Loss: 0.480 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.790677070617676
Epoch: 20, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.577 Vali Acc: 0.937 Test Loss: 0.577 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.034266948699951
Epoch: 21, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.303 Vali Acc: 0.966 Test Loss: 0.303 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.9985179901123047
Epoch: 22, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.370 Vali Acc: 0.963 Test Loss: 0.370 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 361172
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.1837217807769775
Epoch: 1, Steps: 89 | Train Loss: 1.393 Vali Loss: 0.629 Vali Acc: 0.808 Test Loss: 0.629 Test Acc: 0.808
Validation loss decreased (inf --> -0.807793).  Saving model ...
Epoch: 2 cost time: 3.9485814571380615
Epoch: 2, Steps: 89 | Train Loss: 0.416 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
Validation loss decreased (-0.807793 --> -0.900414).  Saving model ...
Epoch: 3 cost time: 2.4475584030151367
Epoch: 3, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.900414 --> -0.940806).  Saving model ...
Epoch: 4 cost time: 2.909342050552368
Epoch: 4, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
Validation loss decreased (-0.940806 --> -0.946377).  Saving model ...
Epoch: 5 cost time: 2.630336046218872
Epoch: 5, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.293 Vali Acc: 0.935 Test Loss: 0.293 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6795694828033447
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
Validation loss decreased (-0.946377 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 3.2979230880737305
Epoch: 7, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.203 Vali Acc: 0.962 Test Loss: 0.203 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3527538776397705
Epoch: 8, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.220525026321411
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.307 Vali Acc: 0.951 Test Loss: 0.307 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6689891815185547
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3907084465026855
Epoch: 11, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.369 Vali Acc: 0.934 Test Loss: 0.369 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8525784015655518
Epoch: 12, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.421 Vali Acc: 0.921 Test Loss: 0.421 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.604229688644409
Epoch: 13, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.776093006134033
Epoch: 14, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.328 Vali Acc: 0.954 Test Loss: 0.328 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.614492416381836
Epoch: 15, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.281 Vali Acc: 0.957 Test Loss: 0.281 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.061239242553711
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.287 Vali Acc: 0.964 Test Loss: 0.287 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 284884
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.602710723876953
Epoch: 1, Steps: 89 | Train Loss: 1.531 Vali Loss: 0.610 Vali Acc: 0.825 Test Loss: 0.610 Test Acc: 0.825
Validation loss decreased (inf --> -0.824506).  Saving model ...
Epoch: 2 cost time: 2.3251538276672363
Epoch: 2, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
Validation loss decreased (-0.824506 --> -0.899022).  Saving model ...
Epoch: 3 cost time: 2.3728368282318115
Epoch: 3, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
Validation loss decreased (-0.899022 --> -0.946377).  Saving model ...
Epoch: 4 cost time: 2.4758243560791016
Epoch: 4, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.214 Vali Acc: 0.934 Test Loss: 0.214 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2566380500793457
Epoch: 5, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
Validation loss decreased (-0.946377 --> -0.956127).  Saving model ...
Epoch: 6 cost time: 2.346540927886963
Epoch: 6, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
Validation loss decreased (-0.956127 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 2.1960811614990234
Epoch: 7, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 2.4012649059295654
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4949798583984375
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
Validation loss decreased (-0.963787 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 2.4216935634613037
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.328784704208374
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.195 Vali Acc: 0.965 Test Loss: 0.195 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.40421199798584
Epoch: 12, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.310540199279785
Epoch: 13, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.194 Vali Acc: 0.962 Test Loss: 0.194 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.485889196395874
Epoch: 14, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.246 Vali Acc: 0.954 Test Loss: 0.246 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.382361888885498
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970054).  Saving model ...
Epoch: 16 cost time: 2.4106345176696777
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.292 Vali Acc: 0.947 Test Loss: 0.292 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.540433168411255
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.189 Vali Acc: 0.969 Test Loss: 0.189 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4087939262390137
Epoch: 18, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.175 Vali Acc: 0.969 Test Loss: 0.175 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.304180383682251
Epoch: 19, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.305 Vali Acc: 0.955 Test Loss: 0.305 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4653074741363525
Epoch: 20, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.394284725189209
Epoch: 21, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.221 Vali Acc: 0.955 Test Loss: 0.221 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4196479320526123
Epoch: 22, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4303388595581055
Epoch: 23, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.235 Vali Acc: 0.963 Test Loss: 0.235 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.416679620742798
Epoch: 24, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.504 Vali Acc: 0.914 Test Loss: 0.504 Test Acc: 0.914
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.523467540740967
Epoch: 25, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.246 Vali Acc: 0.972 Test Loss: 0.246 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972142).  Saving model ...
Epoch: 26 cost time: 1.989931344985962
Epoch: 26, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.470 Vali Acc: 0.944 Test Loss: 0.470 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.073723554611206
Epoch: 27, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.263 Vali Acc: 0.965 Test Loss: 0.263 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.294288396835327
Epoch: 28, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.335 Vali Acc: 0.958 Test Loss: 0.335 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1258785724639893
Epoch: 29, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.389 Vali Acc: 0.958 Test Loss: 0.389 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1200802326202393
Epoch: 30, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.357 Vali Acc: 0.955 Test Loss: 0.357 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.2694716453552246
Epoch: 31, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.221 Vali Acc: 0.966 Test Loss: 0.221 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.0847835540771484
Epoch: 32, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.320 Vali Acc: 0.959 Test Loss: 0.320 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0933077335357666
Epoch: 33, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.309 Vali Acc: 0.966 Test Loss: 0.309 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.065088987350464
Epoch: 34, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.252 Vali Acc: 0.964 Test Loss: 0.252 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.12640118598938
Epoch: 35, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.372 Vali Acc: 0.964 Test Loss: 0.372 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 224084
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.419583559036255
Epoch: 1, Steps: 89 | Train Loss: 1.688 Vali Loss: 0.601 Vali Acc: 0.835 Test Loss: 0.601 Test Acc: 0.835
Validation loss decreased (inf --> -0.834952).  Saving model ...
Epoch: 2 cost time: 1.9591665267944336
Epoch: 2, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.306 Vali Acc: 0.928 Test Loss: 0.306 Test Acc: 0.928
Validation loss decreased (-0.834952 --> -0.928270).  Saving model ...
Epoch: 3 cost time: 1.7926983833312988
Epoch: 3, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.229 Vali Acc: 0.923 Test Loss: 0.229 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.337261915206909
Epoch: 4, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.928270 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 2.2563652992248535
Epoch: 5, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.307 Vali Acc: 0.909 Test Loss: 0.307 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.31630277633667
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.314 Vali Acc: 0.919 Test Loss: 0.314 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3582708835601807
Epoch: 7, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.961698 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 2.2536823749542236
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2746946811676025
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3661916255950928
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3279061317443848
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.367719888687134
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.273564100265503
Epoch: 13, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.331 Vali Acc: 0.938 Test Loss: 0.331 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3030619621276855
Epoch: 14, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3715219497680664
Epoch: 15, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2280192375183105
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.200 Vali Acc: 0.960 Test Loss: 0.200 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.229836940765381
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 186836
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6300086975097656
Epoch: 1, Steps: 89 | Train Loss: 1.860 Vali Loss: 0.726 Vali Acc: 0.790 Test Loss: 0.726 Test Acc: 0.790
Validation loss decreased (inf --> -0.790383).  Saving model ...
Epoch: 2 cost time: 2.3413734436035156
Epoch: 2, Steps: 89 | Train Loss: 0.555 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.790383 --> -0.903200).  Saving model ...
Epoch: 3 cost time: 2.3075485229492188
Epoch: 3, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.217 Vali Acc: 0.939 Test Loss: 0.217 Test Acc: 0.939
Validation loss decreased (-0.903200 --> -0.938716).  Saving model ...
Epoch: 4 cost time: 2.372816562652588
Epoch: 4, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
Validation loss decreased (-0.938716 --> -0.954734).  Saving model ...
Epoch: 5 cost time: 2.2777206897735596
Epoch: 5, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
Validation loss decreased (-0.954734 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 2.3686270713806152
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 2.353698492050171
Epoch: 7, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.107 Vali Acc: 0.966 Test Loss: 0.107 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2707738876342773
Epoch: 8, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.975626).  Saving model ...
Epoch: 9 cost time: 2.44888973236084
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1668927669525146
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.080367088317871
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.975626 --> -0.979804).  Saving model ...
Epoch: 12 cost time: 2.094508171081543
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0867362022399902
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0587048530578613
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.025916337966919
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.083897352218628
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.995084285736084
Epoch: 17, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.039628028869629
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0738651752471924
Epoch: 19, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0655019283294678
Epoch: 20, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.064199924468994
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 157268
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.666231632232666
Epoch: 1, Steps: 89 | Train Loss: 1.842 Vali Loss: 0.796 Vali Acc: 0.770 Test Loss: 0.796 Test Acc: 0.770
Validation loss decreased (inf --> -0.770187).  Saving model ...
Epoch: 2 cost time: 2.3013947010040283
Epoch: 2, Steps: 89 | Train Loss: 0.570 Vali Loss: 0.377 Vali Acc: 0.893 Test Loss: 0.377 Test Acc: 0.893
Validation loss decreased (-0.770187 --> -0.893450).  Saving model ...
Epoch: 3 cost time: 2.3379218578338623
Epoch: 3, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.893450 --> -0.931056).  Saving model ...
Epoch: 4 cost time: 2.243255138397217
Epoch: 4, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.931056 --> -0.948466).  Saving model ...
Epoch: 5 cost time: 2.161888837814331
Epoch: 5, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.197 Vali Acc: 0.939 Test Loss: 0.197 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.287525177001953
Epoch: 6, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.948466 --> -0.968662).  Saving model ...
Epoch: 7 cost time: 1.486990213394165
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.164 Vali Acc: 0.947 Test Loss: 0.164 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4176263809204102
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 1.4284420013427734
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3714818954467773
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.969358 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 1.489140272140503
Epoch: 11, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2686352729797363
Epoch: 12, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2781739234924316
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0751116275787354
Epoch: 14, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 15 cost time: 2.1597025394439697
Epoch: 15, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2187817096710205
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0235135555267334
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1038618087768555
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1067514419555664
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.107538938522339
Epoch: 20, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1407551765441895
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.224 Vali Acc: 0.954 Test Loss: 0.224 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0542876720428467
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9765598773956299
Epoch: 23, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.12772798538208
Epoch: 24, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.161 Vali Acc: 0.966 Test Loss: 0.161 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm128_nh16_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 143060
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.577850341796875
Epoch: 1, Steps: 89 | Train Loss: 1.331 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
Validation loss decreased (inf --> -0.827989).  Saving model ...
Epoch: 2 cost time: 3.544595241546631
Epoch: 2, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.827989 --> -0.933145).  Saving model ...
Epoch: 3 cost time: 3.333312749862671
Epoch: 3, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
Validation loss decreased (-0.933145 --> -0.937323).  Saving model ...
Epoch: 4 cost time: 3.430596351623535
Epoch: 4, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.539 Vali Acc: 0.852 Test Loss: 0.539 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3532309532165527
Epoch: 5, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4232773780822754
Epoch: 6, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.232 Vali Acc: 0.943 Test Loss: 0.232 Test Acc: 0.943
Validation loss decreased (-0.937323 --> -0.942895).  Saving model ...
Epoch: 7 cost time: 3.4888052940368652
Epoch: 7, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.489 Vali Acc: 0.896 Test Loss: 0.489 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.220654249191284
Epoch: 8, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.203 Vali Acc: 0.955 Test Loss: 0.203 Test Acc: 0.955
Validation loss decreased (-0.942895 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 3.615729808807373
Epoch: 9, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.347 Vali Acc: 0.941 Test Loss: 0.347 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.744927406311035
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.255 Vali Acc: 0.958 Test Loss: 0.255 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.958215).  Saving model ...
Epoch: 11 cost time: 2.9977543354034424
Epoch: 11, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.347 Vali Acc: 0.949 Test Loss: 0.347 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4913368225097656
Epoch: 12, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.312 Vali Acc: 0.953 Test Loss: 0.312 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9392848014831543
Epoch: 13, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.341 Vali Acc: 0.958 Test Loss: 0.341 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.492218494415283
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.343 Vali Acc: 0.944 Test Loss: 0.343 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7701101303100586
Epoch: 15, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.478 Vali Acc: 0.938 Test Loss: 0.478 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.8513638973236084
Epoch: 16, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.350 Vali Acc: 0.953 Test Loss: 0.350 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4849135875701904
Epoch: 17, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.594 Vali Acc: 0.937 Test Loss: 0.594 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.057384729385376
Epoch: 18, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.547 Vali Acc: 0.942 Test Loss: 0.547 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5368194580078125
Epoch: 19, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.274 Vali Acc: 0.969 Test Loss: 0.274 Test Acc: 0.969
Validation loss decreased (-0.958215 --> -0.968660).  Saving model ...
Epoch: 20 cost time: 2.989673376083374
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.315 Vali Acc: 0.965 Test Loss: 0.315 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.404094934463501
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.412 Vali Acc: 0.960 Test Loss: 0.412 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.6131136417388916
Epoch: 22, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.812 Vali Acc: 0.925 Test Loss: 0.812 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.345383644104004
Epoch: 23, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.446 Vali Acc: 0.942 Test Loss: 0.446 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.578054189682007
Epoch: 24, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.474 Vali Acc: 0.957 Test Loss: 0.474 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.4212653636932373
Epoch: 25, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.292 Vali Acc: 0.966 Test Loss: 0.292 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.4521825313568115
Epoch: 26, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.474 Vali Acc: 0.959 Test Loss: 0.474 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.5486879348754883
Epoch: 27, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.395 Vali Acc: 0.961 Test Loss: 0.395 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.416966676712036
Epoch: 28, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.391 Vali Acc: 0.964 Test Loss: 0.391 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.5735878944396973
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.633 Vali Acc: 0.937 Test Loss: 0.633 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 284692
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.487450361251831
Epoch: 1, Steps: 89 | Train Loss: 1.530 Vali Loss: 0.598 Vali Acc: 0.811 Test Loss: 0.598 Test Acc: 0.811
Validation loss decreased (inf --> -0.810579).  Saving model ...
Epoch: 2 cost time: 2.0999648571014404
Epoch: 2, Steps: 89 | Train Loss: 0.450 Vali Loss: 0.416 Vali Acc: 0.864 Test Loss: 0.416 Test Acc: 0.864
Validation loss decreased (-0.810579 --> -0.864202).  Saving model ...
Epoch: 3 cost time: 2.220844030380249
Epoch: 3, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.274 Vali Acc: 0.916 Test Loss: 0.274 Test Acc: 0.916
Validation loss decreased (-0.864202 --> -0.916432).  Saving model ...
Epoch: 4 cost time: 2.1668994426727295
Epoch: 4, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.916432 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 2.185706377029419
Epoch: 5, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
Validation loss decreased (-0.951948 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 2.273850917816162
Epoch: 6, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.959608).  Saving model ...
Epoch: 7 cost time: 2.1101038455963135
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.242697238922119
Epoch: 8, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
Validation loss decreased (-0.959608 --> -0.963787).  Saving model ...
Epoch: 9 cost time: 2.3057281970977783
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.249 Vali Acc: 0.942 Test Loss: 0.249 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.275705337524414
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.184 Vali Acc: 0.964 Test Loss: 0.184 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 2.2582547664642334
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1526052951812744
Epoch: 12, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.194 Vali Acc: 0.955 Test Loss: 0.194 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2794296741485596
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.247 Vali Acc: 0.949 Test Loss: 0.247 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.153989553451538
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965876).  Saving model ...
Epoch: 15 cost time: 2.0243327617645264
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9479470252990723
Epoch: 16, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.518 Vali Acc: 0.927 Test Loss: 0.518 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9721882343292236
Epoch: 17, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
Validation loss decreased (-0.965876 --> -0.970054).  Saving model ...
Epoch: 18 cost time: 2.041388988494873
Epoch: 18, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.227 Vali Acc: 0.972 Test Loss: 0.227 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972143).  Saving model ...
Epoch: 19 cost time: 1.9332654476165771
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.292 Vali Acc: 0.949 Test Loss: 0.292 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.04300856590271
Epoch: 20, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.303 Vali Acc: 0.944 Test Loss: 0.303 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0456039905548096
Epoch: 21, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.288 Vali Acc: 0.964 Test Loss: 0.288 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0660619735717773
Epoch: 22, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.409 Vali Acc: 0.955 Test Loss: 0.409 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.0045416355133057
Epoch: 23, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.383 Vali Acc: 0.948 Test Loss: 0.383 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9711627960205078
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.249 Vali Acc: 0.964 Test Loss: 0.249 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.078625202178955
Epoch: 25, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.970 Test Loss: 0.235 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7372643947601318
Epoch: 26, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.320 Vali Acc: 0.960 Test Loss: 0.320 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.1599769592285156
Epoch: 27, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.481 Vali Acc: 0.946 Test Loss: 0.481 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.180838108062744
Epoch: 28, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.329 Vali Acc: 0.963 Test Loss: 0.329 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 189012
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.687673568725586
Epoch: 1, Steps: 89 | Train Loss: 1.723 Vali Loss: 0.658 Vali Acc: 0.822 Test Loss: 0.658 Test Acc: 0.822
Validation loss decreased (inf --> -0.821720).  Saving model ...
Epoch: 2 cost time: 2.0644421577453613
Epoch: 2, Steps: 89 | Train Loss: 0.475 Vali Loss: 0.320 Vali Acc: 0.901 Test Loss: 0.320 Test Acc: 0.901
Validation loss decreased (-0.821720 --> -0.901111).  Saving model ...
Epoch: 3 cost time: 2.2628438472747803
Epoch: 3, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.290 Vali Acc: 0.909 Test Loss: 0.290 Test Acc: 0.909
Validation loss decreased (-0.901111 --> -0.909468).  Saving model ...
Epoch: 4 cost time: 2.155874013900757
Epoch: 4, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.909468 --> -0.948466).  Saving model ...
Epoch: 5 cost time: 2.278473377227783
Epoch: 5, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.144 Vali Acc: 0.955 Test Loss: 0.144 Test Acc: 0.955
Validation loss decreased (-0.948466 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 2.276371717453003
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
Validation loss decreased (-0.954734 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 2.311617136001587
Epoch: 7, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1629717350006104
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.229982614517212
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2628021240234375
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2414252758026123
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.968661).  Saving model ...
Epoch: 12 cost time: 2.03049635887146
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.968661 --> -0.970054).  Saving model ...
Epoch: 13 cost time: 2.102919340133667
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2388205528259277
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.970054 --> -0.972840).  Saving model ...
Epoch: 15 cost time: 2.1369943618774414
Epoch: 15, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.977715).  Saving model ...
Epoch: 16 cost time: 2.161043167114258
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2059013843536377
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2306361198425293
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1689491271972656
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.172976493835449
Epoch: 20, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.043076753616333
Epoch: 21, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.315 Vali Acc: 0.942 Test Loss: 0.315 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.252791166305542
Epoch: 22, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.203 Vali Acc: 0.963 Test Loss: 0.203 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.160559892654419
Epoch: 23, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.357 Vali Acc: 0.937 Test Loss: 0.357 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.858811378479004
Epoch: 24, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.258 Vali Acc: 0.955 Test Loss: 0.258 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8829076290130615
Epoch: 25, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.297 Vali Acc: 0.942 Test Loss: 0.297 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 150868
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.433605432510376
Epoch: 1, Steps: 89 | Train Loss: 1.902 Vali Loss: 0.724 Vali Acc: 0.806 Test Loss: 0.724 Test Acc: 0.806
Validation loss decreased (inf --> -0.805703).  Saving model ...
Epoch: 2 cost time: 1.855966329574585
Epoch: 2, Steps: 89 | Train Loss: 0.544 Vali Loss: 0.348 Vali Acc: 0.904 Test Loss: 0.348 Test Acc: 0.904
Validation loss decreased (-0.805703 --> -0.903896).  Saving model ...
Epoch: 3 cost time: 1.7029821872711182
Epoch: 3, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.245 Vali Acc: 0.934 Test Loss: 0.245 Test Acc: 0.934
Validation loss decreased (-0.903896 --> -0.933842).  Saving model ...
Epoch: 4 cost time: 1.8356051445007324
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
Validation loss decreased (-0.933842 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 1.9146559238433838
Epoch: 5, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.030393600463867
Epoch: 6, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
Validation loss decreased (-0.954037 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 1.7172462940216064
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2188308238983154
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
Validation loss decreased (-0.958912 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 2.047590494155884
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.122 Vali Acc: 0.960 Test Loss: 0.122 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0795552730560303
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.037357807159424
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0302984714508057
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0517406463623047
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9706790447235107
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.975626).  Saving model ...
Epoch: 15 cost time: 2.199002504348755
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.975626 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 1.9684491157531738
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0865025520324707
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.146054983139038
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2247118949890137
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.191 Vali Acc: 0.964 Test Loss: 0.191 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1151063442230225
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.105236291885376
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.1449389457702637
Epoch: 22, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.091294765472412
Epoch: 23, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2509543895721436
Epoch: 24, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.217 Vali Acc: 0.951 Test Loss: 0.217 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.160635232925415
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 120468
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3362221717834473
Epoch: 1, Steps: 89 | Train Loss: 2.058 Vali Loss: 0.885 Vali Acc: 0.811 Test Loss: 0.885 Test Acc: 0.811
Validation loss decreased (inf --> -0.810576).  Saving model ...
Epoch: 2 cost time: 2.101331949234009
Epoch: 2, Steps: 89 | Train Loss: 0.634 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
Validation loss decreased (-0.810576 --> -0.900414).  Saving model ...
Epoch: 3 cost time: 2.0263311862945557
Epoch: 3, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.257 Vali Acc: 0.935 Test Loss: 0.257 Test Acc: 0.935
Validation loss decreased (-0.900414 --> -0.934538).  Saving model ...
Epoch: 4 cost time: 2.221891164779663
Epoch: 4, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.183 Vali Acc: 0.945 Test Loss: 0.183 Test Acc: 0.945
Validation loss decreased (-0.934538 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 1.9960787296295166
Epoch: 5, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
Validation loss decreased (-0.944984 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 1.5405097007751465
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 1.8753681182861328
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 2.0278213024139404
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
Validation loss decreased (-0.969358 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 1.892296552658081
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8784842491149902
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974233).  Saving model ...
Epoch: 11 cost time: 1.9232721328735352
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 12 cost time: 1.8144075870513916
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.86285400390625
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.925729513168335
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.134502649307251
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.142002582550049
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.078754425048828
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.096996784210205
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.209908962249756
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.981197).  Saving model ...
Epoch: 20 cost time: 2.200186252593994
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1972005367279053
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.279336452484131
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1712324619293213
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1779110431671143
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.145850658416748
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.1285269260406494
Epoch: 26, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1548924446105957
Epoch: 27, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.428 Vali Acc: 0.924 Test Loss: 0.428 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.2278432846069336
Epoch: 28, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.187885046005249
Epoch: 29, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 101844
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2116668224334717
Epoch: 1, Steps: 89 | Train Loss: 2.245 Vali Loss: 1.083 Vali Acc: 0.759 Test Loss: 1.083 Test Acc: 0.759
Validation loss decreased (inf --> -0.759042).  Saving model ...
Epoch: 2 cost time: 2.120225429534912
Epoch: 2, Steps: 89 | Train Loss: 0.793 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
Validation loss decreased (-0.759042 --> -0.849577).  Saving model ...
Epoch: 3 cost time: 2.2214138507843018
Epoch: 3, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.317 Vali Acc: 0.912 Test Loss: 0.317 Test Acc: 0.912
Validation loss decreased (-0.849577 --> -0.911557).  Saving model ...
Epoch: 4 cost time: 2.0855906009674072
Epoch: 4, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
Validation loss decreased (-0.911557 --> -0.947769).  Saving model ...
Epoch: 5 cost time: 2.137338161468506
Epoch: 5, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.947769 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 2.026477098464966
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.959609).  Saving model ...
Epoch: 7 cost time: 2.1393446922302246
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
Validation loss decreased (-0.959609 --> -0.972144).  Saving model ...
Epoch: 8 cost time: 2.128100872039795
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1831936836242676
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 2.1535465717315674
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 2.1607985496520996
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0843329429626465
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6966357231140137
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8948893547058105
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9614222049713135
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.975626 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 1.9124886989593506
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8452024459838867
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9465649127960205
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8036534786224365
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0770890712738037
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.015498161315918
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8065838813781738
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0347392559051514
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.76474928855896
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0592498779296875
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 87060
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.408127546310425
Epoch: 1, Steps: 89 | Train Loss: 2.231 Vali Loss: 1.161 Vali Acc: 0.730 Test Loss: 1.161 Test Acc: 0.730
Validation loss decreased (inf --> -0.729793).  Saving model ...
Epoch: 2 cost time: 2.0505824089050293
Epoch: 2, Steps: 89 | Train Loss: 0.839 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
Validation loss decreased (-0.729793 --> -0.860719).  Saving model ...
Epoch: 3 cost time: 2.0223336219787598
Epoch: 3, Steps: 89 | Train Loss: 0.446 Vali Loss: 0.337 Vali Acc: 0.912 Test Loss: 0.337 Test Acc: 0.912
Validation loss decreased (-0.860719 --> -0.912253).  Saving model ...
Epoch: 4 cost time: 2.093177556991577
Epoch: 4, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.250 Vali Acc: 0.932 Test Loss: 0.250 Test Acc: 0.932
Validation loss decreased (-0.912253 --> -0.932449).  Saving model ...
Epoch: 5 cost time: 2.0132365226745605
Epoch: 5, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.207 Vali Acc: 0.939 Test Loss: 0.207 Test Acc: 0.939
Validation loss decreased (-0.932449 --> -0.939413).  Saving model ...
Epoch: 6 cost time: 2.043562650680542
Epoch: 6, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
Validation loss decreased (-0.939413 --> -0.963090).  Saving model ...
Epoch: 7 cost time: 2.078477144241333
Epoch: 7, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1276931762695312
Epoch: 8, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.963090 --> -0.970055).  Saving model ...
Epoch: 9 cost time: 2.187945604324341
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 2.1344406604766846
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 11 cost time: 2.1916322708129883
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.039658308029175
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 2.196342945098877
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0268044471740723
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.981197).  Saving model ...
Epoch: 15 cost time: 2.1481120586395264
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
Validation loss decreased (-0.981197 --> -0.983982).  Saving model ...
Epoch: 16 cost time: 2.0714879035949707
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2083423137664795
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0562117099761963
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.16538405418396
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1334893703460693
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9692628383636475
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3250720500946045
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.089526653289795
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.035456895828247
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983983).  Saving model ...
Epoch: 25 cost time: 1.9877989292144775
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.982527494430542
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9407627582550049
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0733449459075928
Epoch: 28, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8234565258026123
Epoch: 29, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9731907844543457
Epoch: 30, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9683361053466797
Epoch: 31, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9147391319274902
Epoch: 32, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9926247596740723
Epoch: 33, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9872188568115234
Epoch: 34, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 79956
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.084922552108765
Epoch: 1, Steps: 89 | Train Loss: 1.366 Vali Loss: 0.616 Vali Acc: 0.819 Test Loss: 0.616 Test Acc: 0.819
Validation loss decreased (inf --> -0.818935).  Saving model ...
Epoch: 2 cost time: 2.943169593811035
Epoch: 2, Steps: 89 | Train Loss: 0.408 Vali Loss: 0.410 Vali Acc: 0.883 Test Loss: 0.410 Test Acc: 0.883
Validation loss decreased (-0.818935 --> -0.883004).  Saving model ...
Epoch: 3 cost time: 3.4588630199432373
Epoch: 3, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.437 Vali Acc: 0.891 Test Loss: 0.437 Test Acc: 0.891
Validation loss decreased (-0.883004 --> -0.890664).  Saving model ...
Epoch: 4 cost time: 3.2114369869232178
Epoch: 4, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
Validation loss decreased (-0.890664 --> -0.929663).  Saving model ...
Epoch: 5 cost time: 3.2637133598327637
Epoch: 5, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.432 Vali Acc: 0.897 Test Loss: 0.432 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.434699773788452
Epoch: 6, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.283 Vali Acc: 0.934 Test Loss: 0.283 Test Acc: 0.934
Validation loss decreased (-0.929663 --> -0.933841).  Saving model ...
Epoch: 7 cost time: 3.2678496837615967
Epoch: 7, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.290 Vali Acc: 0.949 Test Loss: 0.290 Test Acc: 0.949
Validation loss decreased (-0.933841 --> -0.949161).  Saving model ...
Epoch: 8 cost time: 3.2900125980377197
Epoch: 8, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.297 Vali Acc: 0.960 Test Loss: 0.297 Test Acc: 0.960
Validation loss decreased (-0.949161 --> -0.959607).  Saving model ...
Epoch: 9 cost time: 3.608456611633301
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.683 Vali Acc: 0.914 Test Loss: 0.683 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4725513458251953
Epoch: 10, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2386956214904785
Epoch: 11, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.241 Vali Acc: 0.964 Test Loss: 0.241 Test Acc: 0.964
Validation loss decreased (-0.959607 --> -0.963786).  Saving model ...
Epoch: 12 cost time: 3.338852882385254
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.310 Vali Acc: 0.959 Test Loss: 0.310 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2658045291900635
Epoch: 13, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.488 Vali Acc: 0.938 Test Loss: 0.488 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4325573444366455
Epoch: 14, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.530 Vali Acc: 0.932 Test Loss: 0.530 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3679158687591553
Epoch: 15, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.315 Vali Acc: 0.961 Test Loss: 0.315 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.5953047275543213
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.307 Vali Acc: 0.971 Test Loss: 0.307 Test Acc: 0.971
Validation loss decreased (-0.963786 --> -0.971445).  Saving model ...
Epoch: 17 cost time: 3.2233004570007324
Epoch: 17, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.346 Vali Acc: 0.962 Test Loss: 0.346 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4583661556243896
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.430 Vali Acc: 0.939 Test Loss: 0.430 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4418933391571045
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.438 Vali Acc: 0.949 Test Loss: 0.438 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.271803379058838
Epoch: 20, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.371 Vali Acc: 0.965 Test Loss: 0.371 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.3646113872528076
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.519 Vali Acc: 0.930 Test Loss: 0.519 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3558897972106934
Epoch: 22, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.422 Vali Acc: 0.958 Test Loss: 0.422 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3956589698791504
Epoch: 23, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.516 Vali Acc: 0.938 Test Loss: 0.516 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.589982748031616
Epoch: 24, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.570 Vali Acc: 0.946 Test Loss: 0.570 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.481536388397217
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.465 Vali Acc: 0.959 Test Loss: 0.465 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.1927123069763184
Epoch: 26, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.657 Vali Acc: 0.943 Test Loss: 0.657 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 268180
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3323397636413574
Epoch: 1, Steps: 89 | Train Loss: 1.520 Vali Loss: 0.605 Vali Acc: 0.805 Test Loss: 0.605 Test Acc: 0.805
Validation loss decreased (inf --> -0.805008).  Saving model ...
Epoch: 2 cost time: 2.0201165676116943
Epoch: 2, Steps: 89 | Train Loss: 0.442 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
Validation loss decreased (-0.805008 --> -0.912949).  Saving model ...
Epoch: 3 cost time: 2.173187732696533
Epoch: 3, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
Validation loss decreased (-0.912949 --> -0.922003).  Saving model ...
Epoch: 4 cost time: 2.2535712718963623
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
Validation loss decreased (-0.922003 --> -0.934538).  Saving model ...
Epoch: 5 cost time: 2.149024724960327
Epoch: 5, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
Validation loss decreased (-0.934538 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 2.113313674926758
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 2.054260492324829
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0379323959350586
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
Validation loss decreased (-0.960305 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 2.1448962688446045
Epoch: 9, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.198 Vali Acc: 0.960 Test Loss: 0.198 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1370370388031006
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.270 Vali Acc: 0.939 Test Loss: 0.270 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.212246894836426
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1092581748962402
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.222181558609009
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.178 Vali Acc: 0.968 Test Loss: 0.178 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0804190635681152
Epoch: 14, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.241 Vali Acc: 0.957 Test Loss: 0.241 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2795913219451904
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.195 Vali Acc: 0.963 Test Loss: 0.195 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0804948806762695
Epoch: 16, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.230 Vali Acc: 0.959 Test Loss: 0.230 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2611610889434814
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.199 Vali Acc: 0.964 Test Loss: 0.199 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1694657802581787
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.974232).  Saving model ...
Epoch: 19 cost time: 2.1487648487091064
Epoch: 19, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.421 Vali Acc: 0.936 Test Loss: 0.421 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.168887138366699
Epoch: 20, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1969797611236572
Epoch: 21, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1247153282165527
Epoch: 22, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.216 Vali Acc: 0.969 Test Loss: 0.216 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1876182556152344
Epoch: 23, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.431 Vali Acc: 0.944 Test Loss: 0.431 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0889101028442383
Epoch: 24, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.341 Vali Acc: 0.960 Test Loss: 0.341 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2090039253234863
Epoch: 25, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.650 Vali Acc: 0.932 Test Loss: 0.650 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.184018611907959
Epoch: 26, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.290 Vali Acc: 0.969 Test Loss: 0.290 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.1340370178222656
Epoch: 27, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.348 Vali Acc: 0.958 Test Loss: 0.348 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.822899341583252
Epoch: 28, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.320 Vali Acc: 0.964 Test Loss: 0.320 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 172500
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.405510425567627
Epoch: 1, Steps: 89 | Train Loss: 1.640 Vali Loss: 0.692 Vali Acc: 0.810 Test Loss: 0.692 Test Acc: 0.810
Validation loss decreased (inf --> -0.809882).  Saving model ...
Epoch: 2 cost time: 1.934532880783081
Epoch: 2, Steps: 89 | Train Loss: 0.495 Vali Loss: 0.365 Vali Acc: 0.882 Test Loss: 0.365 Test Acc: 0.882
Validation loss decreased (-0.809882 --> -0.881612).  Saving model ...
Epoch: 3 cost time: 1.8760700225830078
Epoch: 3, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.881612 --> -0.917128).  Saving model ...
Epoch: 4 cost time: 2.0446016788482666
Epoch: 4, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.215 Vali Acc: 0.938 Test Loss: 0.215 Test Acc: 0.938
Validation loss decreased (-0.917128 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 1.9217736721038818
Epoch: 5, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.217 Vali Acc: 0.938 Test Loss: 0.217 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.961059331893921
Epoch: 6, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9333479404449463
Epoch: 7, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.828660011291504
Epoch: 8, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.938020 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 2.1289796829223633
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1098668575286865
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 2.014490842819214
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.967269 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 2.118894338607788
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.112898826599121
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.166 Vali Acc: 0.964 Test Loss: 0.166 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1364221572875977
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0935189723968506
Epoch: 15, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 16 cost time: 1.9603698253631592
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0566487312316895
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.087045669555664
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2184653282165527
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.308 Vali Acc: 0.928 Test Loss: 0.308 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0199663639068604
Epoch: 20, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.276 Vali Acc: 0.955 Test Loss: 0.276 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9654269218444824
Epoch: 21, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.211 Vali Acc: 0.953 Test Loss: 0.211 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.1992828845977783
Epoch: 22, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.184 Vali Acc: 0.971 Test Loss: 0.184 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.158956289291382
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2121965885162354
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1150104999542236
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977714).  Saving model ...
Epoch: 26 cost time: 2.135291814804077
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.129225730895996
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.232 Vali Acc: 0.955 Test Loss: 0.232 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.224179744720459
Epoch: 28, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.216 Vali Acc: 0.960 Test Loss: 0.216 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.081068992614746
Epoch: 29, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.248 Vali Acc: 0.955 Test Loss: 0.248 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1674113273620605
Epoch: 30, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.179 Vali Acc: 0.971 Test Loss: 0.179 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9318914413452148
Epoch: 31, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.961 Test Loss: 0.215 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.1426026821136475
Epoch: 32, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.483 Vali Acc: 0.919 Test Loss: 0.483 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.1748850345611572
Epoch: 33, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.528 Vali Acc: 0.919 Test Loss: 0.528 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.9278364181518555
Epoch: 34, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.190 Vali Acc: 0.971 Test Loss: 0.190 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.010218381881714
Epoch: 35, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 134356
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2640273571014404
Epoch: 1, Steps: 89 | Train Loss: 1.804 Vali Loss: 0.721 Vali Acc: 0.828 Test Loss: 0.721 Test Acc: 0.828
Validation loss decreased (inf --> -0.827987).  Saving model ...
Epoch: 2 cost time: 1.9409019947052002
Epoch: 2, Steps: 89 | Train Loss: 0.538 Vali Loss: 0.377 Vali Acc: 0.899 Test Loss: 0.377 Test Acc: 0.899
Validation loss decreased (-0.827987 --> -0.899021).  Saving model ...
Epoch: 3 cost time: 1.8356540203094482
Epoch: 3, Steps: 89 | Train Loss: 0.318 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
Validation loss decreased (-0.899021 --> -0.936627).  Saving model ...
Epoch: 4 cost time: 1.9986882209777832
Epoch: 4, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.257 Vali Acc: 0.920 Test Loss: 0.257 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0426430702209473
Epoch: 5, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
Validation loss decreased (-0.936627 --> -0.963091).  Saving model ...
Epoch: 6 cost time: 1.9451525211334229
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8475868701934814
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0834059715270996
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9954872131347656
Epoch: 9, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.963091 --> -0.965180).  Saving model ...
Epoch: 10 cost time: 2.0316576957702637
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 2.090454578399658
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.164 Vali Acc: 0.953 Test Loss: 0.164 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0826268196105957
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 2.0988640785217285
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5961079597473145
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.400465965270996
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.223588705062866
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 17 cost time: 2.7640380859375
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4345791339874268
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5397140979766846
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 20 cost time: 2.671288251876831
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.344395875930786
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6446380615234375
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.558842182159424
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3364970684051514
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.637427806854248
Epoch: 25, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.182 Vali Acc: 0.961 Test Loss: 0.182 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4451746940612793
Epoch: 26, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.3506383895874023
Epoch: 27, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.259 Vali Acc: 0.957 Test Loss: 0.259 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.5798277854919434
Epoch: 28, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.4401679039001465
Epoch: 29, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.201 Vali Acc: 0.964 Test Loss: 0.201 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 103956
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8213722705841064
Epoch: 1, Steps: 89 | Train Loss: 2.105 Vali Loss: 0.874 Vali Acc: 0.798 Test Loss: 0.874 Test Acc: 0.798
Validation loss decreased (inf --> -0.798041).  Saving model ...
Epoch: 2 cost time: 2.217508554458618
Epoch: 2, Steps: 89 | Train Loss: 0.624 Vali Loss: 0.405 Vali Acc: 0.886 Test Loss: 0.405 Test Acc: 0.886
Validation loss decreased (-0.798041 --> -0.886486).  Saving model ...
Epoch: 3 cost time: 2.6305649280548096
Epoch: 3, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
Validation loss decreased (-0.886486 --> -0.933145).  Saving model ...
Epoch: 4 cost time: 2.42187762260437
Epoch: 4, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.933145 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 2.175072193145752
Epoch: 5, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
Validation loss decreased (-0.957519 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 2.2634055614471436
Epoch: 6, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.959609 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 2.1101717948913574
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.961698 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 2.3167006969451904
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.965180 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 2.0587551593780518
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.154034376144409
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.321199417114258
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.099963426589966
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.052725076675415
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982590).  Saving model ...
Epoch: 14 cost time: 2.4206440448760986
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9658455848693848
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3388004302978516
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6317782402038574
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.34745717048645
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.506260871887207
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5186004638671875
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.3059306144714355
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.481358289718628
Epoch: 22, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3569390773773193
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 85332
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7081239223480225
Epoch: 1, Steps: 89 | Train Loss: 2.239 Vali Loss: 1.108 Vali Acc: 0.734 Test Loss: 1.108 Test Acc: 0.734
Validation loss decreased (inf --> -0.733972).  Saving model ...
Epoch: 2 cost time: 2.385618209838867
Epoch: 2, Steps: 89 | Train Loss: 0.784 Vali Loss: 0.507 Vali Acc: 0.869 Test Loss: 0.507 Test Acc: 0.869
Validation loss decreased (-0.733972 --> -0.869076).  Saving model ...
Epoch: 3 cost time: 2.539020538330078
Epoch: 3, Steps: 89 | Train Loss: 0.419 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
Validation loss decreased (-0.869076 --> -0.910860).  Saving model ...
Epoch: 4 cost time: 2.2769384384155273
Epoch: 4, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
Validation loss decreased (-0.910860 --> -0.938717).  Saving model ...
Epoch: 5 cost time: 2.441567897796631
Epoch: 5, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
Validation loss decreased (-0.938717 --> -0.956126).  Saving model ...
Epoch: 6 cost time: 2.5874695777893066
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2199456691741943
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
Validation loss decreased (-0.956126 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 2.3244881629943848
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.964483 --> -0.976322).  Saving model ...
Epoch: 9 cost time: 2.1277084350585938
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4225733280181885
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6587040424346924
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 2.383037567138672
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3760502338409424
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6856184005737305
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3958632946014404
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3384296894073486
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 17 cost time: 2.6353251934051514
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.126 Vali Acc: 0.961 Test Loss: 0.126 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.45740008354187
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.345884084701538
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8831298351287842
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8814263343811035
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9685802459716797
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0322928428649902
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.024290084838867
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.1168429851531982
Epoch: 25, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.908724308013916
Epoch: 26, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 70548
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.260582208633423
Epoch: 1, Steps: 89 | Train Loss: 2.202 Vali Loss: 1.146 Vali Acc: 0.764 Test Loss: 1.146 Test Acc: 0.764
Validation loss decreased (inf --> -0.763916).  Saving model ...
Epoch: 2 cost time: 2.074733018875122
Epoch: 2, Steps: 89 | Train Loss: 0.848 Vali Loss: 0.550 Vali Acc: 0.858 Test Loss: 0.550 Test Acc: 0.858
Validation loss decreased (-0.763916 --> -0.857933).  Saving model ...
Epoch: 3 cost time: 2.012930154800415
Epoch: 3, Steps: 89 | Train Loss: 0.455 Vali Loss: 0.337 Vali Acc: 0.913 Test Loss: 0.337 Test Acc: 0.913
Validation loss decreased (-0.857933 --> -0.912949).  Saving model ...
Epoch: 4 cost time: 2.122096061706543
Epoch: 4, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
Validation loss decreased (-0.912949 --> -0.926181).  Saving model ...
Epoch: 5 cost time: 2.2622499465942383
Epoch: 5, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
Validation loss decreased (-0.926181 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 2.121732234954834
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
Validation loss decreased (-0.951252 --> -0.952645).  Saving model ...
Epoch: 7 cost time: 2.178947687149048
Epoch: 7, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.952645 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 2.087141990661621
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 2.195406913757324
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.283597230911255
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 2.1471993923187256
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 2.150843381881714
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2762980461120605
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1103081703186035
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 2.2696592807769775
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0794663429260254
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978412).  Saving model ...
Epoch: 17 cost time: 2.125741481781006
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.228273868560791
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
Validation loss decreased (-0.978412 --> -0.979108).  Saving model ...
Epoch: 19 cost time: 2.239901304244995
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 20 cost time: 2.1483187675476074
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2117297649383545
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0890870094299316
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3285157680511475
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1474716663360596
Epoch: 24, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.251 Vali Acc: 0.949 Test Loss: 0.251 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.185593843460083
Epoch: 25, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2523488998413086
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.242616653442383
Epoch: 27, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 28 cost time: 2.200326681137085
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.306988477706909
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1811766624450684
Epoch: 30, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.0499563217163086
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.9656784534454346
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.9054031372070312
Epoch: 33, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6940054893493652
Epoch: 34, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.0770413875579834
Epoch: 35, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.7970893383026123
Epoch: 36, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.027869462966919
Epoch: 37, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 63444
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6107804775238037
Epoch: 1, Steps: 89 | Train Loss: 1.333 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
Validation loss decreased (inf --> -0.866987).  Saving model ...
Epoch: 2 cost time: 2.660207748413086
Epoch: 2, Steps: 89 | Train Loss: 0.447 Vali Loss: 0.445 Vali Acc: 0.868 Test Loss: 0.445 Test Acc: 0.868
Validation loss decreased (-0.866987 --> -0.868380).  Saving model ...
Epoch: 3 cost time: 3.4421918392181396
Epoch: 3, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
Validation loss decreased (-0.868380 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 3.4671945571899414
Epoch: 4, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6009809970855713
Epoch: 5, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.656 Vali Acc: 0.896 Test Loss: 0.656 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3820364475250244
Epoch: 6, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.254 Vali Acc: 0.940 Test Loss: 0.254 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.73295259475708
Epoch: 7, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.708878755569458
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.289 Vali Acc: 0.953 Test Loss: 0.289 Test Acc: 0.953
Validation loss decreased (-0.952644 --> -0.953340).  Saving model ...
Epoch: 9 cost time: 3.430553674697876
Epoch: 9, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.373 Vali Acc: 0.927 Test Loss: 0.373 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5916359424591064
Epoch: 10, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.419 Vali Acc: 0.944 Test Loss: 0.419 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8537700176239014
Epoch: 11, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.280 Vali Acc: 0.967 Test Loss: 0.280 Test Acc: 0.967
Validation loss decreased (-0.953340 --> -0.967267).  Saving model ...
Epoch: 12 cost time: 3.227604866027832
Epoch: 12, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.289 Vali Acc: 0.959 Test Loss: 0.289 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4598422050476074
Epoch: 13, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.322 Vali Acc: 0.958 Test Loss: 0.322 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1852760314941406
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.364 Vali Acc: 0.952 Test Loss: 0.364 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.597687244415283
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.375 Vali Acc: 0.958 Test Loss: 0.375 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.5175187587738037
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.614 Vali Acc: 0.910 Test Loss: 0.614 Test Acc: 0.910
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.3727123737335205
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.266 Vali Acc: 0.967 Test Loss: 0.266 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.283763885498047
Epoch: 18, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.539 Vali Acc: 0.929 Test Loss: 0.539 Test Acc: 0.929
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.5312883853912354
Epoch: 19, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.540 Vali Acc: 0.930 Test Loss: 0.540 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.285491943359375
Epoch: 20, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.519 Vali Acc: 0.942 Test Loss: 0.519 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.31062650680542
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.388 Vali Acc: 0.962 Test Loss: 0.388 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 259924
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.458549737930298
Epoch: 1, Steps: 89 | Train Loss: 1.527 Vali Loss: 0.640 Vali Acc: 0.826 Test Loss: 0.640 Test Acc: 0.826
Validation loss decreased (inf --> -0.825899).  Saving model ...
Epoch: 2 cost time: 2.3151168823242188
Epoch: 2, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.350 Vali Acc: 0.895 Test Loss: 0.350 Test Acc: 0.895
Validation loss decreased (-0.825899 --> -0.894843).  Saving model ...
Epoch: 3 cost time: 1.9613349437713623
Epoch: 3, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.894843 --> -0.917128).  Saving model ...
Epoch: 4 cost time: 2.0616018772125244
Epoch: 4, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.255 Vali Acc: 0.928 Test Loss: 0.255 Test Acc: 0.928
Validation loss decreased (-0.917128 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 1.9737277030944824
Epoch: 5, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.203 Vali Acc: 0.942 Test Loss: 0.203 Test Acc: 0.942
Validation loss decreased (-0.928270 --> -0.942199).  Saving model ...
Epoch: 6 cost time: 1.9852347373962402
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.942199 --> -0.948466).  Saving model ...
Epoch: 7 cost time: 1.9599804878234863
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
Validation loss decreased (-0.948466 --> -0.959608).  Saving model ...
Epoch: 8 cost time: 1.439453363418579
Epoch: 8, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8755037784576416
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
Validation loss decreased (-0.959608 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 1.9793670177459717
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0542383193969727
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9798271656036377
Epoch: 12, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9578771591186523
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.287 Vali Acc: 0.943 Test Loss: 0.287 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2696115970611572
Epoch: 14, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.233 Vali Acc: 0.959 Test Loss: 0.233 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1204404830932617
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.296 Vali Acc: 0.942 Test Loss: 0.296 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2422776222229004
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.246 Vali Acc: 0.958 Test Loss: 0.246 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2253777980804443
Epoch: 17, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.261 Vali Acc: 0.960 Test Loss: 0.261 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2241501808166504
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.214 Vali Acc: 0.964 Test Loss: 0.214 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2336809635162354
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.256 Vali Acc: 0.957 Test Loss: 0.256 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 164244
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.325963258743286
Epoch: 1, Steps: 89 | Train Loss: 1.689 Vali Loss: 0.642 Vali Acc: 0.839 Test Loss: 0.642 Test Acc: 0.839
Validation loss decreased (inf --> -0.839130).  Saving model ...
Epoch: 2 cost time: 2.1198089122772217
Epoch: 2, Steps: 89 | Train Loss: 0.480 Vali Loss: 0.407 Vali Acc: 0.893 Test Loss: 0.407 Test Acc: 0.893
Validation loss decreased (-0.839130 --> -0.892754).  Saving model ...
Epoch: 3 cost time: 2.195517063140869
Epoch: 3, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.311 Vali Acc: 0.899 Test Loss: 0.311 Test Acc: 0.899
Validation loss decreased (-0.892754 --> -0.899022).  Saving model ...
Epoch: 4 cost time: 2.023948907852173
Epoch: 4, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
Validation loss decreased (-0.899022 --> -0.949162).  Saving model ...
Epoch: 5 cost time: 2.163714647293091
Epoch: 5, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.949162 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 2.223268985748291
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1468334197998047
Epoch: 7, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.153 Vali Acc: 0.952 Test Loss: 0.153 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.080644369125366
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.956823 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 2.2044320106506348
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.967269).  Saving model ...
Epoch: 10 cost time: 2.1363275051116943
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.177762985229492
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0854387283325195
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.213160753250122
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0551207065582275
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.119232654571533
Epoch: 15, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.262 Vali Acc: 0.945 Test Loss: 0.262 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1525330543518066
Epoch: 16, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1871371269226074
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0629045963287354
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1976115703582764
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 126100
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2761354446411133
Epoch: 1, Steps: 89 | Train Loss: 1.926 Vali Loss: 0.796 Vali Acc: 0.798 Test Loss: 0.796 Test Acc: 0.798
Validation loss decreased (inf --> -0.798042).  Saving model ...
Epoch: 2 cost time: 1.8220720291137695
Epoch: 2, Steps: 89 | Train Loss: 0.586 Vali Loss: 0.427 Vali Acc: 0.882 Test Loss: 0.427 Test Acc: 0.882
Validation loss decreased (-0.798042 --> -0.881611).  Saving model ...
Epoch: 3 cost time: 1.971836805343628
Epoch: 3, Steps: 89 | Train Loss: 0.329 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
Validation loss decreased (-0.881611 --> -0.922003).  Saving model ...
Epoch: 4 cost time: 1.7962274551391602
Epoch: 4, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.922003 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 1.9254064559936523
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.951948 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 1.9619438648223877
Epoch: 6, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9517631530761719
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.100649833679199
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.186 Vali Acc: 0.945 Test Loss: 0.186 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8805944919586182
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.181 Vali Acc: 0.940 Test Loss: 0.181 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2258572578430176
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.958912 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 2.2034318447113037
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.068096399307251
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 13 cost time: 2.1017284393310547
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.191584348678589
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.166456699371338
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1196250915527344
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.225 Vali Acc: 0.939 Test Loss: 0.225 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1841182708740234
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.115957021713257
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2004148960113525
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.105397939682007
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3257532119750977
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.228172779083252
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 95700
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3653550148010254
Epoch: 1, Steps: 89 | Train Loss: 2.046 Vali Loss: 0.901 Vali Acc: 0.777 Test Loss: 0.901 Test Acc: 0.777
Validation loss decreased (inf --> -0.777150).  Saving model ...
Epoch: 2 cost time: 2.0755457878112793
Epoch: 2, Steps: 89 | Train Loss: 0.656 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
Validation loss decreased (-0.777150 --> -0.871862).  Saving model ...
Epoch: 3 cost time: 2.20920467376709
Epoch: 3, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.246 Vali Acc: 0.939 Test Loss: 0.246 Test Acc: 0.939
Validation loss decreased (-0.871862 --> -0.938716).  Saving model ...
Epoch: 4 cost time: 2.004667282104492
Epoch: 4, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.938716 --> -0.948466).  Saving model ...
Epoch: 5 cost time: 2.1211891174316406
Epoch: 5, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.948466 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 2.0645010471343994
Epoch: 6, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.091848373413086
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.961698 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 2.112795114517212
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.027148962020874
Epoch: 9, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980501).  Saving model ...
Epoch: 10 cost time: 2.0755302906036377
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6562514305114746
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9849269390106201
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9380888938903809
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8433113098144531
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9230070114135742
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0061607360839844
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0040700435638428
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0111289024353027
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9118781089782715
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 77076
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.570145606994629
Epoch: 1, Steps: 89 | Train Loss: 2.173 Vali Loss: 1.058 Vali Acc: 0.779 Test Loss: 1.058 Test Acc: 0.779
Validation loss decreased (inf --> -0.779237).  Saving model ...
Epoch: 2 cost time: 2.1061220169067383
Epoch: 2, Steps: 89 | Train Loss: 0.788 Vali Loss: 0.511 Vali Acc: 0.873 Test Loss: 0.511 Test Acc: 0.873
Validation loss decreased (-0.779237 --> -0.872558).  Saving model ...
Epoch: 3 cost time: 2.058743953704834
Epoch: 3, Steps: 89 | Train Loss: 0.423 Vali Loss: 0.316 Vali Acc: 0.924 Test Loss: 0.316 Test Acc: 0.924
Validation loss decreased (-0.872558 --> -0.924092).  Saving model ...
Epoch: 4 cost time: 2.2334179878234863
Epoch: 4, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.217 Vali Acc: 0.938 Test Loss: 0.217 Test Acc: 0.938
Validation loss decreased (-0.924092 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 2.1107921600341797
Epoch: 5, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
Validation loss decreased (-0.938020 --> -0.959608).  Saving model ...
Epoch: 6 cost time: 2.1988584995269775
Epoch: 6, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
Validation loss decreased (-0.959608 --> -0.975625).  Saving model ...
Epoch: 7 cost time: 1.9811975955963135
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0717740058898926
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2212634086608887
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0960140228271484
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.074667453765869
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.975625 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 2.0563902854919434
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.13620662689209
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0206117630004883
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1268341541290283
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.006833791732788
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.108738422393799
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0611705780029297
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.013676404953003
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8890674114227295
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8418309688568115
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 62292
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.528841733932495
Epoch: 1, Steps: 89 | Train Loss: 2.324 Vali Loss: 1.226 Vali Acc: 0.717 Test Loss: 1.226 Test Acc: 0.717
Validation loss decreased (inf --> -0.716562).  Saving model ...
Epoch: 2 cost time: 1.6392827033996582
Epoch: 2, Steps: 89 | Train Loss: 0.895 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
Validation loss decreased (-0.716562 --> -0.849576).  Saving model ...
Epoch: 3 cost time: 1.8186695575714111
Epoch: 3, Steps: 89 | Train Loss: 0.485 Vali Loss: 0.358 Vali Acc: 0.905 Test Loss: 0.358 Test Acc: 0.905
Validation loss decreased (-0.849576 --> -0.904593).  Saving model ...
Epoch: 4 cost time: 1.7271666526794434
Epoch: 4, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
Validation loss decreased (-0.904593 --> -0.935234).  Saving model ...
Epoch: 5 cost time: 1.8426666259765625
Epoch: 5, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (-0.935234 --> -0.956126).  Saving model ...
Epoch: 6 cost time: 1.9219951629638672
Epoch: 6, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
Validation loss decreased (-0.956126 --> -0.963090).  Saving model ...
Epoch: 7 cost time: 1.8751122951507568
Epoch: 7, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 1.7562181949615479
Epoch: 8, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.966573).  Saving model ...
Epoch: 9 cost time: 1.7170019149780273
Epoch: 9, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.966573 --> -0.973537).  Saving model ...
Epoch: 10 cost time: 1.8613181114196777
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.973537 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 1.8214828968048096
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980500).  Saving model ...
Epoch: 12 cost time: 1.7495241165161133
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.835876703262329
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.023873805999756
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1500236988067627
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9285407066345215
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9701368808746338
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9837369918823242
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9718778133392334
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9626526832580566
Epoch: 20, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0374622344970703
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
Validation loss decreased (-0.980500 --> -0.981893).  Saving model ...
Epoch: 22 cost time: 1.9757404327392578
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9643187522888184
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0542633533477783
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0164554119110107
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9558124542236328
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.065310478210449
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.003457546234131
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.0805673599243164
Epoch: 29, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9856336116790771
Epoch: 30, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9230051040649414
Epoch: 31, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm64_nh16_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 55188
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.92560076713562
Epoch: 1, Steps: 89 | Train Loss: 1.613 Vali Loss: 0.593 Vali Acc: 0.826 Test Loss: 0.593 Test Acc: 0.826
Validation loss decreased (inf --> -0.825899).  Saving model ...
Epoch: 2 cost time: 2.5395867824554443
Epoch: 2, Steps: 89 | Train Loss: 0.447 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
Validation loss decreased (-0.825899 --> -0.889272).  Saving model ...
Epoch: 3 cost time: 2.3411576747894287
Epoch: 3, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.259 Vali Acc: 0.935 Test Loss: 0.259 Test Acc: 0.935
Validation loss decreased (-0.889272 --> -0.934538).  Saving model ...
Epoch: 4 cost time: 2.535447597503662
Epoch: 4, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.934538 --> -0.945681).  Saving model ...
Epoch: 5 cost time: 2.557391881942749
Epoch: 5, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
Validation loss decreased (-0.945681 --> -0.949859).  Saving model ...
Epoch: 6 cost time: 2.1916301250457764
Epoch: 6, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0722548961639404
Epoch: 7, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.949859 --> -0.958216).  Saving model ...
Epoch: 8 cost time: 2.3124783039093018
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.285 Vali Acc: 0.932 Test Loss: 0.285 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.261510133743286
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.034600019454956
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.961698).  Saving model ...
Epoch: 11 cost time: 2.2844934463500977
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.967269).  Saving model ...
Epoch: 12 cost time: 2.300384044647217
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.227 Vali Acc: 0.951 Test Loss: 0.227 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9602429866790771
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
Validation loss decreased (-0.967269 --> -0.967269).  Saving model ...
Epoch: 14 cost time: 2.268608331680298
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.170684814453125
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.216 Vali Acc: 0.956 Test Loss: 0.216 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0674238204956055
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972143).  Saving model ...
Epoch: 17 cost time: 2.210484504699707
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.259 Vali Acc: 0.951 Test Loss: 0.259 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.178790807723999
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.281 Vali Acc: 0.949 Test Loss: 0.281 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8328039646148682
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.248 Vali Acc: 0.959 Test Loss: 0.248 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.344456434249878
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.954 Test Loss: 0.232 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.56415057182312
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.399 Vali Acc: 0.933 Test Loss: 0.399 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.500546932220459
Epoch: 22, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.230 Vali Acc: 0.965 Test Loss: 0.230 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.171191453933716
Epoch: 23, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.302 Vali Acc: 0.953 Test Loss: 0.302 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4566102027893066
Epoch: 24, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.274 Vali Acc: 0.960 Test Loss: 0.274 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.509665012359619
Epoch: 25, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.229 Vali Acc: 0.964 Test Loss: 0.229 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.2299768924713135
Epoch: 26, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.227 Vali Acc: 0.967 Test Loss: 0.227 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 138388
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.852001190185547
Epoch: 1, Steps: 89 | Train Loss: 1.883 Vali Loss: 0.771 Vali Acc: 0.815 Test Loss: 0.771 Test Acc: 0.815
Validation loss decreased (inf --> -0.815452).  Saving model ...
Epoch: 2 cost time: 2.2240376472473145
Epoch: 2, Steps: 89 | Train Loss: 0.564 Vali Loss: 0.414 Vali Acc: 0.878 Test Loss: 0.414 Test Acc: 0.878
Validation loss decreased (-0.815452 --> -0.878130).  Saving model ...
Epoch: 3 cost time: 2.5111396312713623
Epoch: 3, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.320 Vali Acc: 0.893 Test Loss: 0.320 Test Acc: 0.893
Validation loss decreased (-0.878130 --> -0.893451).  Saving model ...
Epoch: 4 cost time: 2.513028383255005
Epoch: 4, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.203 Vali Acc: 0.942 Test Loss: 0.203 Test Acc: 0.942
Validation loss decreased (-0.893451 --> -0.942199).  Saving model ...
Epoch: 5 cost time: 2.2292938232421875
Epoch: 5, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.223 Vali Acc: 0.936 Test Loss: 0.223 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3502423763275146
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
Validation loss decreased (-0.942199 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 2.449748992919922
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.962394).  Saving model ...
Epoch: 8 cost time: 2.6004106998443604
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1559574604034424
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
Validation loss decreased (-0.962394 --> -0.963091).  Saving model ...
Epoch: 10 cost time: 2.490508794784546
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 2.5389773845672607
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.137 Vali Acc: 0.961 Test Loss: 0.137 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5457968711853027
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.216592311859131
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.147 Vali Acc: 0.961 Test Loss: 0.147 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.549361228942871
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.545330762863159
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.244150400161743
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.270 Vali Acc: 0.926 Test Loss: 0.270 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.477266788482666
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.499103307723999
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.199 Vali Acc: 0.955 Test Loss: 0.199 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.306696653366089
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1746633052825928
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 90548
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.45957612991333
Epoch: 1, Steps: 89 | Train Loss: 2.043 Vali Loss: 0.916 Vali Acc: 0.769 Test Loss: 0.916 Test Acc: 0.769
Validation loss decreased (inf --> -0.768793).  Saving model ...
Epoch: 2 cost time: 2.2038211822509766
Epoch: 2, Steps: 89 | Train Loss: 0.635 Vali Loss: 0.474 Vali Acc: 0.870 Test Loss: 0.474 Test Acc: 0.870
Validation loss decreased (-0.768793 --> -0.870469).  Saving model ...
Epoch: 3 cost time: 2.201385974884033
Epoch: 3, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.282 Vali Acc: 0.928 Test Loss: 0.282 Test Acc: 0.928
Validation loss decreased (-0.870469 --> -0.927574).  Saving model ...
Epoch: 4 cost time: 2.080707311630249
Epoch: 4, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
Validation loss decreased (-0.927574 --> -0.952644).  Saving model ...
Epoch: 5 cost time: 2.241900682449341
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2086002826690674
Epoch: 6, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9575963020324707
Epoch: 7, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1907827854156494
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.952644 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 2.490915536880493
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 2.170797109603882
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4895195960998535
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.967965 --> -0.975626).  Saving model ...
Epoch: 12 cost time: 2.4885802268981934
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4543204307556152
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1017465591430664
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.113 Vali Acc: 0.966 Test Loss: 0.113 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3602635860443115
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.953 Test Loss: 0.154 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4691214561462402
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.131512403488159
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4468350410461426
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.4981706142425537
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3169219493865967
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2167470455169678
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 71476
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5524983406066895
Epoch: 1, Steps: 89 | Train Loss: 2.258 Vali Loss: 1.170 Vali Acc: 0.747 Test Loss: 1.170 Test Acc: 0.747
Validation loss decreased (inf --> -0.746506).  Saving model ...
Epoch: 2 cost time: 1.9565129280090332
Epoch: 2, Steps: 89 | Train Loss: 0.815 Vali Loss: 0.534 Vali Acc: 0.851 Test Loss: 0.534 Test Acc: 0.851
Validation loss decreased (-0.746506 --> -0.850970).  Saving model ...
Epoch: 3 cost time: 1.85591459274292
Epoch: 3, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.333 Vali Acc: 0.911 Test Loss: 0.333 Test Acc: 0.911
Validation loss decreased (-0.850970 --> -0.910860).  Saving model ...
Epoch: 4 cost time: 2.094809055328369
Epoch: 4, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.250 Vali Acc: 0.934 Test Loss: 0.250 Test Acc: 0.934
Validation loss decreased (-0.910860 --> -0.933842).  Saving model ...
Epoch: 5 cost time: 2.100142478942871
Epoch: 5, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
Validation loss decreased (-0.933842 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 2.171448230743408
Epoch: 6, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.172 Vali Acc: 0.947 Test Loss: 0.172 Test Acc: 0.947
Validation loss decreased (-0.942895 --> -0.947073).  Saving model ...
Epoch: 7 cost time: 1.968782663345337
Epoch: 7, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.947073 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 2.1097936630249023
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 9 cost time: 2.1456820964813232
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.04154896736145
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.965876 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 2.1026976108551025
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.114 Vali Acc: 0.960 Test Loss: 0.114 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8908696174621582
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0630674362182617
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.997910499572754
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0399327278137207
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9979188442230225
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9520719051361084
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.019775867462158
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9706096649169922
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9010796546936035
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 56276
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.523881435394287
Epoch: 1, Steps: 89 | Train Loss: 2.481 Vali Loss: 1.421 Vali Acc: 0.704 Test Loss: 1.421 Test Acc: 0.704
Validation loss decreased (inf --> -0.704025).  Saving model ...
Epoch: 2 cost time: 2.2713472843170166
Epoch: 2, Steps: 89 | Train Loss: 0.995 Vali Loss: 0.635 Vali Acc: 0.839 Test Loss: 0.635 Test Acc: 0.839
Validation loss decreased (-0.704025 --> -0.839130).  Saving model ...
Epoch: 3 cost time: 2.184589147567749
Epoch: 3, Steps: 89 | Train Loss: 0.514 Vali Loss: 0.404 Vali Acc: 0.892 Test Loss: 0.404 Test Acc: 0.892
Validation loss decreased (-0.839130 --> -0.892057).  Saving model ...
Epoch: 4 cost time: 2.1543052196502686
Epoch: 4, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.275 Vali Acc: 0.928 Test Loss: 0.275 Test Acc: 0.928
Validation loss decreased (-0.892057 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 2.2033963203430176
Epoch: 5, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.223 Vali Acc: 0.940 Test Loss: 0.223 Test Acc: 0.940
Validation loss decreased (-0.928270 --> -0.940109).  Saving model ...
Epoch: 6 cost time: 2.2021243572235107
Epoch: 6, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.940109 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 2.172485828399658
Epoch: 7, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.958912 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 2.246903657913208
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1409666538238525
Epoch: 9, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.134 Vali Acc: 0.958 Test Loss: 0.134 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.162360668182373
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.958912 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 2.0124430656433105
Epoch: 11, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.970055 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 2.2367968559265137
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 2.283953905105591
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1133527755737305
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.227372407913208
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2089662551879883
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0525245666503906
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 18 cost time: 2.2638165950775146
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2518744468688965
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.214837074279785
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.206543207168579
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2576940059661865
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.208517551422119
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1829936504364014
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.2015860080718994
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.2694294452667236
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.23420786857605
Epoch: 27, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 46964
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.4130475521087646
Epoch: 1, Steps: 89 | Train Loss: 2.613 Vali Loss: 1.689 Vali Acc: 0.666 Test Loss: 1.689 Test Acc: 0.666
Validation loss decreased (inf --> -0.666418).  Saving model ...
Epoch: 2 cost time: 1.9610083103179932
Epoch: 2, Steps: 89 | Train Loss: 1.223 Vali Loss: 0.768 Vali Acc: 0.816 Test Loss: 0.768 Test Acc: 0.816
Validation loss decreased (-0.666418 --> -0.816148).  Saving model ...
Epoch: 3 cost time: 2.090639591217041
Epoch: 3, Steps: 89 | Train Loss: 0.632 Vali Loss: 0.481 Vali Acc: 0.888 Test Loss: 0.481 Test Acc: 0.888
Validation loss decreased (-0.816148 --> -0.887878).  Saving model ...
Epoch: 4 cost time: 2.0784244537353516
Epoch: 4, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.346 Vali Acc: 0.916 Test Loss: 0.346 Test Acc: 0.916
Validation loss decreased (-0.887878 --> -0.915735).  Saving model ...
Epoch: 5 cost time: 2.009249448776245
Epoch: 5, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
Validation loss decreased (-0.915735 --> -0.933145).  Saving model ...
Epoch: 6 cost time: 2.126460313796997
Epoch: 6, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.091641902923584
Epoch: 7, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
Validation loss decreased (-0.933145 --> -0.954734).  Saving model ...
Epoch: 8 cost time: 2.0907483100891113
Epoch: 8, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
Validation loss decreased (-0.954734 --> -0.963787).  Saving model ...
Epoch: 9 cost time: 2.0462474822998047
Epoch: 9, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1222569942474365
Epoch: 10, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 2.0554041862487793
Epoch: 11, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 2.261586904525757
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2712907791137695
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 14 cost time: 2.195906162261963
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 15 cost time: 2.2296266555786133
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2284369468688965
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 17 cost time: 2.207503080368042
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.289292573928833
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1856470108032227
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.101633310317993
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980500).  Saving model ...
Epoch: 21 cost time: 2.193875551223755
Epoch: 21, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.179727792739868
Epoch: 22, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.953 Test Loss: 0.135 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.300964117050171
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0810134410858154
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.349550724029541
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.451457977294922
Epoch: 26, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.179861068725586
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.3374924659729004
Epoch: 28, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.2324490547180176
Epoch: 29, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.130445957183838
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 39572
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2821731567382812
Epoch: 1, Steps: 89 | Train Loss: 2.589 Vali Loss: 1.780 Vali Acc: 0.609 Test Loss: 1.780 Test Acc: 0.609
Validation loss decreased (inf --> -0.609314).  Saving model ...
Epoch: 2 cost time: 2.2520651817321777
Epoch: 2, Steps: 89 | Train Loss: 1.342 Vali Loss: 0.871 Vali Acc: 0.801 Test Loss: 0.871 Test Acc: 0.801
Validation loss decreased (-0.609314 --> -0.800827).  Saving model ...
Epoch: 3 cost time: 2.1708507537841797
Epoch: 3, Steps: 89 | Train Loss: 0.712 Vali Loss: 0.541 Vali Acc: 0.877 Test Loss: 0.541 Test Acc: 0.877
Validation loss decreased (-0.800827 --> -0.877432).  Saving model ...
Epoch: 4 cost time: 2.2240118980407715
Epoch: 4, Steps: 89 | Train Loss: 0.473 Vali Loss: 0.379 Vali Acc: 0.906 Test Loss: 0.379 Test Acc: 0.906
Validation loss decreased (-0.877432 --> -0.905985).  Saving model ...
Epoch: 5 cost time: 2.100731134414673
Epoch: 5, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.278 Vali Acc: 0.936 Test Loss: 0.278 Test Acc: 0.936
Validation loss decreased (-0.905985 --> -0.935930).  Saving model ...
Epoch: 6 cost time: 1.871241807937622
Epoch: 6, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
Validation loss decreased (-0.935930 --> -0.946377).  Saving model ...
Epoch: 7 cost time: 2.0047428607940674
Epoch: 7, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.946377 --> -0.949859).  Saving model ...
Epoch: 8 cost time: 1.8348538875579834
Epoch: 8, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (-0.949859 --> -0.956127).  Saving model ...
Epoch: 9 cost time: 1.7946488857269287
Epoch: 9, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.956127 --> -0.966572).  Saving model ...
Epoch: 10 cost time: 1.77947998046875
Epoch: 10, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
Validation loss decreased (-0.966572 --> -0.973536).  Saving model ...
Epoch: 11 cost time: 1.8578073978424072
Epoch: 11, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9884107112884521
Epoch: 12, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.963085651397705
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8809654712677002
Epoch: 14, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.976322).  Saving model ...
Epoch: 15 cost time: 2.0021378993988037
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.008711814880371
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8826179504394531
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.976322 --> -0.979804).  Saving model ...
Epoch: 18 cost time: 2.1502842903137207
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2112202644348145
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 20 cost time: 2.2600414752960205
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0629067420959473
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.980501).  Saving model ...
Epoch: 22 cost time: 2.3337461948394775
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3347039222717285
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.050236940383911
Epoch: 24, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.192188262939453
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.189511775970459
Epoch: 26, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.2838327884674072
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.348191738128662
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.983286).  Saving model ...
Epoch: 29 cost time: 2.2339131832122803
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3312058448791504
Epoch: 30, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.2040865421295166
Epoch: 31, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.2642593383789062
Epoch: 32, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.115654706954956
Epoch: 33, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.2081451416015625
Epoch: 34, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.2424097061157227
Epoch: 35, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.2037322521209717
Epoch: 36, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.315534830093384
Epoch: 37, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.1534156799316406
Epoch: 38, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 36020
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.479954719543457
Epoch: 1, Steps: 89 | Train Loss: 1.645 Vali Loss: 0.645 Vali Acc: 0.815 Test Loss: 0.645 Test Acc: 0.815
Validation loss decreased (inf --> -0.814757).  Saving model ...
Epoch: 2 cost time: 2.1382062435150146
Epoch: 2, Steps: 89 | Train Loss: 0.446 Vali Loss: 0.315 Vali Acc: 0.902 Test Loss: 0.315 Test Acc: 0.902
Validation loss decreased (-0.814757 --> -0.901807).  Saving model ...
Epoch: 3 cost time: 1.8704726696014404
Epoch: 3, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
Validation loss decreased (-0.901807 --> -0.927574).  Saving model ...
Epoch: 4 cost time: 1.9241650104522705
Epoch: 4, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
Validation loss decreased (-0.927574 --> -0.934538).  Saving model ...
Epoch: 5 cost time: 2.0012667179107666
Epoch: 5, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.934538 --> -0.947770).  Saving model ...
Epoch: 6 cost time: 2.0309550762176514
Epoch: 6, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.186 Vali Acc: 0.945 Test Loss: 0.186 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9940829277038574
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.580531358718872
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0153450965881348
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
Validation loss decreased (-0.947770 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 2.0408895015716553
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.386 Vali Acc: 0.916 Test Loss: 0.386 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1228480339050293
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9477763175964355
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1005029678344727
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6272649765014648
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2927613258361816
Epoch: 15, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.322 Vali Acc: 0.937 Test Loss: 0.322 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3787152767181396
Epoch: 16, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.2468721866607666
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.230 Vali Acc: 0.952 Test Loss: 0.230 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.9006073474884033
Epoch: 18, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.283 Vali Acc: 0.957 Test Loss: 0.283 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.2001376152038574
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.296 Vali Acc: 0.939 Test Loss: 0.296 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 130068
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0639309883117676
Epoch: 1, Steps: 89 | Train Loss: 1.953 Vali Loss: 0.869 Vali Acc: 0.740 Test Loss: 0.869 Test Acc: 0.740
Validation loss decreased (inf --> -0.739546).  Saving model ...
Epoch: 2 cost time: 2.4081616401672363
Epoch: 2, Steps: 89 | Train Loss: 0.617 Vali Loss: 0.417 Vali Acc: 0.882 Test Loss: 0.417 Test Acc: 0.882
Validation loss decreased (-0.739546 --> -0.881611).  Saving model ...
Epoch: 3 cost time: 2.7223305702209473
Epoch: 3, Steps: 89 | Train Loss: 0.341 Vali Loss: 0.269 Vali Acc: 0.929 Test Loss: 0.269 Test Acc: 0.929
Validation loss decreased (-0.881611 --> -0.928967).  Saving model ...
Epoch: 4 cost time: 3.368335247039795
Epoch: 4, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5594513416290283
Epoch: 5, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.194 Vali Acc: 0.945 Test Loss: 0.194 Test Acc: 0.945
Validation loss decreased (-0.928967 --> -0.944984).  Saving model ...
Epoch: 6 cost time: 3.5996851921081543
Epoch: 6, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
Validation loss decreased (-0.944984 --> -0.954734).  Saving model ...
Epoch: 7 cost time: 2.871424913406372
Epoch: 7, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
Validation loss decreased (-0.954734 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 3.326570987701416
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 2.5667126178741455
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.094029188156128
Epoch: 10, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.947827100753784
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3286375999450684
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.919743061065674
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.5556905269622803
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.4015026092529297
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.392592191696167
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.967269 --> -0.970054).  Saving model ...
Epoch: 17 cost time: 2.4376883506774902
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.350534439086914
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.435279607772827
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.213 Vali Acc: 0.954 Test Loss: 0.213 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5205609798431396
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.488426446914673
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5595219135284424
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.2973225116729736
Epoch: 23, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.8655359745025635
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.199 Vali Acc: 0.960 Test Loss: 0.199 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.544548988342285
Epoch: 25, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.234 Vali Acc: 0.956 Test Loss: 0.234 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.4049978256225586
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.964 Test Loss: 0.205 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 82228
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.503933668136597
Epoch: 1, Steps: 89 | Train Loss: 2.102 Vali Loss: 0.933 Vali Acc: 0.790 Test Loss: 0.933 Test Acc: 0.790
Validation loss decreased (inf --> -0.790381).  Saving model ...
Epoch: 2 cost time: 3.6483373641967773
Epoch: 2, Steps: 89 | Train Loss: 0.655 Vali Loss: 0.439 Vali Acc: 0.878 Test Loss: 0.439 Test Acc: 0.878
Validation loss decreased (-0.790381 --> -0.878129).  Saving model ...
Epoch: 3 cost time: 3.3498356342315674
Epoch: 3, Steps: 89 | Train Loss: 0.353 Vali Loss: 0.309 Vali Acc: 0.912 Test Loss: 0.309 Test Acc: 0.912
Validation loss decreased (-0.878129 --> -0.912253).  Saving model ...
Epoch: 4 cost time: 2.9666497707366943
Epoch: 4, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.912253 --> -0.931056).  Saving model ...
Epoch: 5 cost time: 2.662238359451294
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
Validation loss decreased (-0.931056 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 2.8489863872528076
Epoch: 6, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
Validation loss decreased (-0.951948 --> -0.959609).  Saving model ...
Epoch: 7 cost time: 3.2886571884155273
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.129 Vali Acc: 0.961 Test Loss: 0.129 Test Acc: 0.961
Validation loss decreased (-0.959609 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 3.5551419258117676
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.961001 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 3.1666202545166016
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6181344985961914
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1629068851470947
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 12 cost time: 2.5531299114227295
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.126 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7296054363250732
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.965876 --> -0.972840).  Saving model ...
Epoch: 14 cost time: 3.3600893020629883
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5770857334136963
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.518472671508789
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8240740299224854
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8460404872894287
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 19 cost time: 3.122924566268921
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.89914870262146
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.082252264022827
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 22 cost time: 3.2145705223083496
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5820906162261963
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6781005859375
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.638329029083252
Epoch: 25, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.677083730697632
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.3430263996124268
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.265000820159912
Epoch: 28, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.583547592163086
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.221 Vali Acc: 0.951 Test Loss: 0.221 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.369802236557007
Epoch: 30, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.9916863441467285
Epoch: 31, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.246 Vali Acc: 0.955 Test Loss: 0.246 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 63156
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.420063257217407
Epoch: 1, Steps: 89 | Train Loss: 2.328 Vali Loss: 1.198 Vali Acc: 0.728 Test Loss: 1.198 Test Acc: 0.728
Validation loss decreased (inf --> -0.728400).  Saving model ...
Epoch: 2 cost time: 2.9307198524475098
Epoch: 2, Steps: 89 | Train Loss: 0.829 Vali Loss: 0.537 Vali Acc: 0.870 Test Loss: 0.537 Test Acc: 0.870
Validation loss decreased (-0.728400 --> -0.870468).  Saving model ...
Epoch: 3 cost time: 3.365830183029175
Epoch: 3, Steps: 89 | Train Loss: 0.433 Vali Loss: 0.340 Vali Acc: 0.908 Test Loss: 0.340 Test Acc: 0.908
Validation loss decreased (-0.870468 --> -0.908075).  Saving model ...
Epoch: 4 cost time: 3.369266986846924
Epoch: 4, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.255 Vali Acc: 0.932 Test Loss: 0.255 Test Acc: 0.932
Validation loss decreased (-0.908075 --> -0.931752).  Saving model ...
Epoch: 5 cost time: 3.1847846508026123
Epoch: 5, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
Validation loss decreased (-0.931752 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 2.765944719314575
Epoch: 6, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.175 Vali Acc: 0.953 Test Loss: 0.175 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.953341).  Saving model ...
Epoch: 7 cost time: 2.5912623405456543
Epoch: 7, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.584388494491577
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
Validation loss decreased (-0.953341 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 2.598503828048706
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 2.5910017490386963
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 11 cost time: 2.398709535598755
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.298708915710449
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.955 Test Loss: 0.140 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1418304443359375
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0406055450439453
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 2.2554209232330322
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.969358 --> -0.972840).  Saving model ...
Epoch: 16 cost time: 2.4142661094665527
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5319368839263916
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.046931028366089
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.707345485687256
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 20 cost time: 2.923348903656006
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.103485584259033
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 22 cost time: 2.3826568126678467
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 23 cost time: 2.611398935317993
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.512094736099243
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 25 cost time: 2.9611010551452637
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8148038387298584
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.4295389652252197
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.0276808738708496
Epoch: 28, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.596956253051758
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.797187328338623
Epoch: 30, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.50580096244812
Epoch: 31, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.445122241973877
Epoch: 32, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.861396312713623
Epoch: 33, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.639404535293579
Epoch: 34, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 47956
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.4672911167144775
Epoch: 1, Steps: 89 | Train Loss: 2.419 Vali Loss: 1.429 Vali Acc: 0.696 Test Loss: 1.429 Test Acc: 0.696
Validation loss decreased (inf --> -0.695668).  Saving model ...
Epoch: 2 cost time: 2.7434134483337402
Epoch: 2, Steps: 89 | Train Loss: 1.024 Vali Loss: 0.629 Vali Acc: 0.838 Test Loss: 0.629 Test Acc: 0.838
Validation loss decreased (-0.695668 --> -0.837737).  Saving model ...
Epoch: 3 cost time: 2.9057395458221436
Epoch: 3, Steps: 89 | Train Loss: 0.530 Vali Loss: 0.387 Vali Acc: 0.902 Test Loss: 0.387 Test Acc: 0.902
Validation loss decreased (-0.837737 --> -0.901807).  Saving model ...
Epoch: 4 cost time: 2.5730161666870117
Epoch: 4, Steps: 89 | Train Loss: 0.342 Vali Loss: 0.294 Vali Acc: 0.928 Test Loss: 0.294 Test Acc: 0.928
Validation loss decreased (-0.901807 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 2.5367181301116943
Epoch: 5, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
Validation loss decreased (-0.928270 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 2.5930542945861816
Epoch: 6, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
Validation loss decreased (-0.951252 --> -0.951252).  Saving model ...
Epoch: 7 cost time: 2.626664876937866
Epoch: 7, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.951252 --> -0.966572).  Saving model ...
Epoch: 8 cost time: 2.670149326324463
Epoch: 8, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.897151231765747
Epoch: 9, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
Validation loss decreased (-0.966572 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 2.50321888923645
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 3.0705955028533936
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.794431447982788
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4620063304901123
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 14 cost time: 2.592721462249756
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.10681414604187
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7233359813690186
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2672085762023926
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.374781608581543
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.150035858154297
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0756115913391113
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 21 cost time: 2.216230630874634
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1396737098693848
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.09076189994812
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.976322 --> -0.979804).  Saving model ...
Epoch: 24 cost time: 2.8265578746795654
Epoch: 24, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.212585926055908
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 26 cost time: 2.9487037658691406
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6520588397979736
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.3217034339904785
Epoch: 28, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.8267128467559814
Epoch: 29, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.7777233123779297
Epoch: 30, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.4064247608184814
Epoch: 31, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.4901559352874756
Epoch: 32, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.305370569229126
Epoch: 33, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.49627947807312
Epoch: 34, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.4414761066436768
Epoch: 35, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 38644
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.384370565414429
Epoch: 1, Steps: 89 | Train Loss: 2.608 Vali Loss: 1.717 Vali Acc: 0.575 Test Loss: 1.717 Test Acc: 0.575
Validation loss decreased (inf --> -0.574495).  Saving model ...
Epoch: 2 cost time: 3.5460712909698486
Epoch: 2, Steps: 89 | Train Loss: 1.254 Vali Loss: 0.773 Vali Acc: 0.841 Test Loss: 0.773 Test Acc: 0.841
Validation loss decreased (-0.574495 --> -0.841218).  Saving model ...
Epoch: 3 cost time: 3.744837522506714
Epoch: 3, Steps: 89 | Train Loss: 0.659 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
Validation loss decreased (-0.841218 --> -0.888574).  Saving model ...
Epoch: 4 cost time: 3.5224015712738037
Epoch: 4, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.335 Vali Acc: 0.918 Test Loss: 0.335 Test Acc: 0.918
Validation loss decreased (-0.888574 --> -0.917824).  Saving model ...
Epoch: 5 cost time: 3.5053696632385254
Epoch: 5, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.240 Vali Acc: 0.940 Test Loss: 0.240 Test Acc: 0.940
Validation loss decreased (-0.917824 --> -0.940109).  Saving model ...
Epoch: 6 cost time: 3.2304883003234863
Epoch: 6, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
Validation loss decreased (-0.940109 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 3.640657424926758
Epoch: 7, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
Validation loss decreased (-0.952644 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 2.8245604038238525
Epoch: 8, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.955430 --> -0.966572).  Saving model ...
Epoch: 9 cost time: 3.767435073852539
Epoch: 9, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.966572 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 3.0906341075897217
Epoch: 10, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5027272701263428
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1370186805725098
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5630366802215576
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 14 cost time: 3.5696070194244385
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3216497898101807
Epoch: 15, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974233).  Saving model ...
Epoch: 16 cost time: 3.6328349113464355
Epoch: 16, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2558999061584473
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
Validation loss decreased (-0.974233 --> -0.979108).  Saving model ...
Epoch: 18 cost time: 3.416781425476074
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.625213146209717
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 20 cost time: 3.4290168285369873
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.610879898071289
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 22 cost time: 2.06278133392334
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.225485324859619
Epoch: 23, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.263169288635254
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1289114952087402
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.3168222904205322
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.969 Test Loss: 0.098 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.3798556327819824
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.3742830753326416
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 29 cost time: 2.4363160133361816
Epoch: 29, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.333874464035034
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.707439422607422
Epoch: 31, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.1749770641326904
Epoch: 32, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.158885955810547
Epoch: 33, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.477311134338379
Epoch: 34, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.3329524993896484
Epoch: 35, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.2655584812164307
Epoch: 36, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 37 cost time: 3.259634017944336
Epoch: 37, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.3081777095794678
Epoch: 38, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.156 Vali Acc: 0.966 Test Loss: 0.156 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.8907930850982666
Epoch: 39, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.041058301925659
Epoch: 40, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.61214017868042
Epoch: 41, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.969067335128784
Epoch: 42, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.715658664703369
Epoch: 43, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.655082941055298
Epoch: 44, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.4052696228027344
Epoch: 45, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.035565137863159
Epoch: 46, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 31252
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.336621522903442
Epoch: 1, Steps: 89 | Train Loss: 2.675 Vali Loss: 1.822 Vali Acc: 0.643 Test Loss: 1.822 Test Acc: 0.643
Validation loss decreased (inf --> -0.642739).  Saving model ...
Epoch: 2 cost time: 2.609090805053711
Epoch: 2, Steps: 89 | Train Loss: 1.361 Vali Loss: 0.873 Vali Acc: 0.804 Test Loss: 0.873 Test Acc: 0.804
Validation loss decreased (-0.642739 --> -0.804309).  Saving model ...
Epoch: 3 cost time: 2.3867852687835693
Epoch: 3, Steps: 89 | Train Loss: 0.732 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
Validation loss decreased (-0.804309 --> -0.844005).  Saving model ...
Epoch: 4 cost time: 2.1924214363098145
Epoch: 4, Steps: 89 | Train Loss: 0.480 Vali Loss: 0.383 Vali Acc: 0.912 Test Loss: 0.383 Test Acc: 0.912
Validation loss decreased (-0.844005 --> -0.911556).  Saving model ...
Epoch: 5 cost time: 2.476963996887207
Epoch: 5, Steps: 89 | Train Loss: 0.342 Vali Loss: 0.282 Vali Acc: 0.942 Test Loss: 0.282 Test Acc: 0.942
Validation loss decreased (-0.911556 --> -0.941501).  Saving model ...
Epoch: 6 cost time: 3.0692138671875
Epoch: 6, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.941501 --> -0.944287).  Saving model ...
Epoch: 7 cost time: 3.331770420074463
Epoch: 7, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.944287 --> -0.957519).  Saving model ...
Epoch: 8 cost time: 3.051987409591675
Epoch: 8, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.164 Vali Acc: 0.955 Test Loss: 0.164 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6770732402801514
Epoch: 9, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
Validation loss decreased (-0.957519 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 3.1477303504943848
Epoch: 10, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.365090847015381
Epoch: 11, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.964483 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 2.416977882385254
Epoch: 12, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4460835456848145
Epoch: 13, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.395251512527466
Epoch: 14, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2888216972351074
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.439910888671875
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 2.1096341609954834
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3726227283477783
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5338637828826904
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 20 cost time: 2.808544635772705
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4245400428771973
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 22 cost time: 2.417933225631714
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5624427795410156
Epoch: 23, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.85779070854187
Epoch: 24, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.026859760284424
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.117450475692749
Epoch: 26, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.461986541748047
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 28 cost time: 2.415215015411377
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.425747871398926
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4154982566833496
Epoch: 30, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.3495101928710938
Epoch: 31, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.4717886447906494
Epoch: 32, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.9755468368530273
Epoch: 33, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.707730531692505
Epoch: 34, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.929694414138794
Epoch: 35, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.7351832389831543
Epoch: 36, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.1735963821411133
Epoch: 37, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 27700
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.887025833129883
Epoch: 1, Steps: 89 | Train Loss: 1.602 Vali Loss: 0.572 Vali Acc: 0.852 Test Loss: 0.572 Test Acc: 0.852
Validation loss decreased (inf --> -0.852362).  Saving model ...
Epoch: 2 cost time: 3.1079022884368896
Epoch: 2, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
Validation loss decreased (-0.852362 --> -0.903200).  Saving model ...
Epoch: 3 cost time: 2.530449151992798
Epoch: 3, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.903200 --> -0.903200).  Saving model ...
Epoch: 4 cost time: 2.4863345623016357
Epoch: 4, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.198 Vali Acc: 0.947 Test Loss: 0.198 Test Acc: 0.947
Validation loss decreased (-0.903200 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 2.4156618118286133
Epoch: 5, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.947073 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 2.5040700435638428
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3065545558929443
Epoch: 7, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7985477447509766
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.160 Vali Acc: 0.961 Test Loss: 0.160 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4314522743225098
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6889808177948
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.186 Vali Acc: 0.960 Test Loss: 0.186 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.538623094558716
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2610344886779785
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8582382202148438
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4037864208221436
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.179 Vali Acc: 0.968 Test Loss: 0.179 Test Acc: 0.968
Validation loss decreased (-0.963787 --> -0.967965).  Saving model ...
Epoch: 15 cost time: 2.4593966007232666
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7679455280303955
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.209 Vali Acc: 0.960 Test Loss: 0.209 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.318554162979126
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.569641351699829
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.198 Vali Acc: 0.969 Test Loss: 0.198 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968661).  Saving model ...
Epoch: 19 cost time: 2.505013942718506
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.254 Vali Acc: 0.959 Test Loss: 0.254 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2194671630859375
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.960 Test Loss: 0.222 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.335505247116089
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.567687511444092
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.301 Vali Acc: 0.955 Test Loss: 0.301 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3050878047943115
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.256 Vali Acc: 0.958 Test Loss: 0.256 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.4536290168762207
Epoch: 24, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.272 Vali Acc: 0.964 Test Loss: 0.272 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.421219825744629
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.306 Vali Acc: 0.956 Test Loss: 0.306 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.894625186920166
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.345 Vali Acc: 0.952 Test Loss: 0.345 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.754092216491699
Epoch: 27, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.287 Vali Acc: 0.958 Test Loss: 0.287 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.5287394523620605
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.971 Test Loss: 0.221 Test Acc: 0.971
Validation loss decreased (-0.968661 --> -0.971446).  Saving model ...
Epoch: 29 cost time: 2.4833877086639404
Epoch: 29, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.282 Vali Acc: 0.957 Test Loss: 0.282 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5233466625213623
Epoch: 30, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.244 Vali Acc: 0.963 Test Loss: 0.244 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.9899988174438477
Epoch: 31, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.590 Vali Acc: 0.947 Test Loss: 0.590 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.9119749069213867
Epoch: 32, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.328 Vali Acc: 0.951 Test Loss: 0.328 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.4004063606262207
Epoch: 33, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.249 Vali Acc: 0.960 Test Loss: 0.249 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.338036298751831
Epoch: 34, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.354 Vali Acc: 0.948 Test Loss: 0.354 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.5756444931030273
Epoch: 35, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.336 Vali Acc: 0.954 Test Loss: 0.336 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.3835933208465576
Epoch: 36, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.307 Vali Acc: 0.962 Test Loss: 0.307 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.403712272644043
Epoch: 37, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.410 Vali Acc: 0.952 Test Loss: 0.410 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.6225006580352783
Epoch: 38, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.310 Vali Acc: 0.968 Test Loss: 0.310 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 125908
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.832212209701538
Epoch: 1, Steps: 89 | Train Loss: 1.925 Vali Loss: 0.834 Vali Acc: 0.801 Test Loss: 0.834 Test Acc: 0.801
Validation loss decreased (inf --> -0.800827).  Saving model ...
Epoch: 2 cost time: 3.506626605987549
Epoch: 2, Steps: 89 | Train Loss: 0.610 Vali Loss: 0.428 Vali Acc: 0.887 Test Loss: 0.428 Test Acc: 0.887
Validation loss decreased (-0.800827 --> -0.887182).  Saving model ...
Epoch: 3 cost time: 2.742464780807495
Epoch: 3, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
Validation loss decreased (-0.887182 --> -0.900414).  Saving model ...
Epoch: 4 cost time: 3.371236562728882
Epoch: 4, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.319 Vali Acc: 0.893 Test Loss: 0.319 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8237643241882324
Epoch: 5, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.222 Vali Acc: 0.939 Test Loss: 0.222 Test Acc: 0.939
Validation loss decreased (-0.900414 --> -0.939413).  Saving model ...
Epoch: 6 cost time: 3.7716867923736572
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
Validation loss decreased (-0.939413 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 2.8423023223876953
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.721446990966797
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.324779510498047
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.962394).  Saving model ...
Epoch: 10 cost time: 2.9090735912323
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3641884326934814
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.962394 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 2.719489574432373
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3557004928588867
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6673834323883057
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9328110218048096
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.727121114730835
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.4197025299072266
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.6453542709350586
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.930049419403076
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.5032870769500732
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.261 Vali Acc: 0.951 Test Loss: 0.261 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.860765218734741
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 78068
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8768510818481445
Epoch: 1, Steps: 89 | Train Loss: 2.102 Vali Loss: 0.938 Vali Acc: 0.795 Test Loss: 0.938 Test Acc: 0.795
Validation loss decreased (inf --> -0.794559).  Saving model ...
Epoch: 2 cost time: 3.162731885910034
Epoch: 2, Steps: 89 | Train Loss: 0.687 Vali Loss: 0.477 Vali Acc: 0.862 Test Loss: 0.477 Test Acc: 0.862
Validation loss decreased (-0.794559 --> -0.862112).  Saving model ...
Epoch: 3 cost time: 2.88450288772583
Epoch: 3, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.316 Vali Acc: 0.910 Test Loss: 0.316 Test Acc: 0.910
Validation loss decreased (-0.862112 --> -0.910164).  Saving model ...
Epoch: 4 cost time: 3.379596710205078
Epoch: 4, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.910164 --> -0.944287).  Saving model ...
Epoch: 5 cost time: 3.188811779022217
Epoch: 5, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.219 Vali Acc: 0.932 Test Loss: 0.219 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8176567554473877
Epoch: 6, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.944287 --> -0.966572).  Saving model ...
Epoch: 7 cost time: 2.9574804306030273
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.855191946029663
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.909808397293091
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.124 Vali Acc: 0.961 Test Loss: 0.124 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.623934268951416
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.023219108581543
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.966572 --> -0.977018).  Saving model ...
Epoch: 12 cost time: 3.212005138397217
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.368752956390381
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.905888080596924
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.4101033210754395
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.115 Vali Acc: 0.961 Test Loss: 0.115 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2509679794311523
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.385180950164795
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.480025291442871
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.685248374938965
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.591701030731201
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.9645204544067383
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 58996
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.101842641830444
Epoch: 1, Steps: 89 | Train Loss: 2.390 Vali Loss: 1.246 Vali Acc: 0.735 Test Loss: 1.246 Test Acc: 0.735
Validation loss decreased (inf --> -0.734667).  Saving model ...
Epoch: 2 cost time: 2.9701499938964844
Epoch: 2, Steps: 89 | Train Loss: 0.888 Vali Loss: 0.589 Vali Acc: 0.847 Test Loss: 0.589 Test Acc: 0.847
Validation loss decreased (-0.734667 --> -0.846791).  Saving model ...
Epoch: 3 cost time: 3.3166749477386475
Epoch: 3, Steps: 89 | Train Loss: 0.485 Vali Loss: 0.375 Vali Acc: 0.898 Test Loss: 0.375 Test Acc: 0.898
Validation loss decreased (-0.846791 --> -0.897629).  Saving model ...
Epoch: 4 cost time: 2.66636323928833
Epoch: 4, Steps: 89 | Train Loss: 0.310 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
Validation loss decreased (-0.897629 --> -0.929663).  Saving model ...
Epoch: 5 cost time: 2.132045030593872
Epoch: 5, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
Validation loss decreased (-0.929663 --> -0.952644).  Saving model ...
Epoch: 6 cost time: 2.0350773334503174
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3698387145996094
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.952644 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 2.1092722415924072
Epoch: 8, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.329383611679077
Epoch: 9, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 2.7176151275634766
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.146 Vali Acc: 0.955 Test Loss: 0.146 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3793227672576904
Epoch: 11, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.340174913406372
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.724010944366455
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.137 Vali Acc: 0.952 Test Loss: 0.137 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.406435251235962
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.6676976680755615
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971448).  Saving model ...
Epoch: 16 cost time: 3.441894054412842
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
Validation loss decreased (-0.971448 --> -0.972144).  Saving model ...
Epoch: 17 cost time: 2.71039080619812
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 18 cost time: 3.2425906658172607
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 19 cost time: 2.7566585540771484
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.61026930809021
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.520275831222534
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5491809844970703
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.504413604736328
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.3365113735198975
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1749942302703857
Epoch: 25, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.2370877265930176
Epoch: 26, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.214744806289673
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.931640625
Epoch: 28, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 43796
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.239351749420166
Epoch: 1, Steps: 89 | Train Loss: 2.478 Vali Loss: 1.479 Vali Acc: 0.710 Test Loss: 1.479 Test Acc: 0.710
Validation loss decreased (inf --> -0.709595).  Saving model ...
Epoch: 2 cost time: 2.9187257289886475
Epoch: 2, Steps: 89 | Train Loss: 1.052 Vali Loss: 0.667 Vali Acc: 0.843 Test Loss: 0.667 Test Acc: 0.843
Validation loss decreased (-0.709595 --> -0.842612).  Saving model ...
Epoch: 3 cost time: 2.6423180103302
Epoch: 3, Steps: 89 | Train Loss: 0.562 Vali Loss: 0.450 Vali Acc: 0.885 Test Loss: 0.450 Test Acc: 0.885
Validation loss decreased (-0.842612 --> -0.885093).  Saving model ...
Epoch: 4 cost time: 2.626011610031128
Epoch: 4, Steps: 89 | Train Loss: 0.362 Vali Loss: 0.296 Vali Acc: 0.928 Test Loss: 0.296 Test Acc: 0.928
Validation loss decreased (-0.885093 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 2.3460710048675537
Epoch: 5, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.223 Vali Acc: 0.945 Test Loss: 0.223 Test Acc: 0.945
Validation loss decreased (-0.928270 --> -0.944984).  Saving model ...
Epoch: 6 cost time: 2.441037654876709
Epoch: 6, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
Validation loss decreased (-0.944984 --> -0.953341).  Saving model ...
Epoch: 7 cost time: 2.8903660774230957
Epoch: 7, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6387813091278076
Epoch: 8, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
Validation loss decreased (-0.953341 --> -0.958912).  Saving model ...
Epoch: 9 cost time: 2.6941161155700684
Epoch: 9, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
Validation loss decreased (-0.958912 --> -0.965876).  Saving model ...
Epoch: 10 cost time: 2.9716382026672363
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.965876 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 2.7006261348724365
Epoch: 11, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6528232097625732
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 2.8064653873443604
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 14 cost time: 2.511556386947632
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1269195079803467
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1775965690612793
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3126776218414307
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.17885160446167
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 19 cost time: 2.4605658054351807
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 20 cost time: 2.530421733856201
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6713786125183105
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 22 cost time: 2.396043300628662
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2903850078582764
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.119067668914795
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.8229613304138184
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.8081881999969482
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.006436586380005
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.8928520679473877
Epoch: 28, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.951364517211914
Epoch: 29, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 30 cost time: 2.4957969188690186
Epoch: 30, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.4815332889556885
Epoch: 31, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.3275973796844482
Epoch: 32, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3176000118255615
Epoch: 33, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.2752065658569336
Epoch: 34, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.6456916332244873
Epoch: 35, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.583054780960083
Epoch: 36, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.4354188442230225
Epoch: 37, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.630265474319458
Epoch: 38, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.899479866027832
Epoch: 39, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 34484
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.003350019454956
Epoch: 1, Steps: 89 | Train Loss: 2.539 Vali Loss: 1.627 Vali Acc: 0.707 Test Loss: 1.627 Test Acc: 0.707
Validation loss decreased (inf --> -0.706808).  Saving model ...
Epoch: 2 cost time: 2.7653822898864746
Epoch: 2, Steps: 89 | Train Loss: 1.209 Vali Loss: 0.758 Vali Acc: 0.841 Test Loss: 0.758 Test Acc: 0.841
Validation loss decreased (-0.706808 --> -0.841218).  Saving model ...
Epoch: 3 cost time: 3.4447455406188965
Epoch: 3, Steps: 89 | Train Loss: 0.658 Vali Loss: 0.498 Vali Acc: 0.881 Test Loss: 0.498 Test Acc: 0.881
Validation loss decreased (-0.841218 --> -0.880914).  Saving model ...
Epoch: 4 cost time: 2.9421815872192383
Epoch: 4, Steps: 89 | Train Loss: 0.442 Vali Loss: 0.386 Vali Acc: 0.899 Test Loss: 0.386 Test Acc: 0.899
Validation loss decreased (-0.880914 --> -0.899021).  Saving model ...
Epoch: 5 cost time: 3.4137043952941895
Epoch: 5, Steps: 89 | Train Loss: 0.310 Vali Loss: 0.266 Vali Acc: 0.934 Test Loss: 0.266 Test Acc: 0.934
Validation loss decreased (-0.899021 --> -0.933841).  Saving model ...
Epoch: 6 cost time: 3.3964357376098633
Epoch: 6, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
Validation loss decreased (-0.933841 --> -0.948466).  Saving model ...
Epoch: 7 cost time: 2.9365122318267822
Epoch: 7, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
Validation loss decreased (-0.948466 --> -0.949162).  Saving model ...
Epoch: 8 cost time: 3.4329750537872314
Epoch: 8, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
Validation loss decreased (-0.949162 --> -0.965876).  Saving model ...
Epoch: 9 cost time: 2.97982120513916
Epoch: 9, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
Validation loss decreased (-0.965876 --> -0.965876).  Saving model ...
Epoch: 10 cost time: 3.210700750350952
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9137330055236816
Epoch: 11, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.965876 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 3.4777801036834717
Epoch: 12, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.204820156097412
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 14 cost time: 2.580301284790039
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 15 cost time: 2.9474294185638428
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5766186714172363
Epoch: 16, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 17 cost time: 2.722135305404663
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.976322 --> -0.982590).  Saving model ...
Epoch: 18 cost time: 2.970931053161621
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3469088077545166
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.86185622215271
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.334139585494995
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1172845363616943
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8933355808258057
Epoch: 23, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1775033473968506
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.1343982219696045
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.7203662395477295
Epoch: 26, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.3115651607513428
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 27092
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.833594083786011
Epoch: 1, Steps: 89 | Train Loss: 2.588 Vali Loss: 1.772 Vali Acc: 0.606 Test Loss: 1.772 Test Acc: 0.606
Validation loss decreased (inf --> -0.605832).  Saving model ...
Epoch: 2 cost time: 3.4149084091186523
Epoch: 2, Steps: 89 | Train Loss: 1.360 Vali Loss: 0.865 Vali Acc: 0.799 Test Loss: 0.865 Test Acc: 0.799
Validation loss decreased (-0.605832 --> -0.798738).  Saving model ...
Epoch: 3 cost time: 3.256527900695801
Epoch: 3, Steps: 89 | Train Loss: 0.722 Vali Loss: 0.549 Vali Acc: 0.868 Test Loss: 0.549 Test Acc: 0.868
Validation loss decreased (-0.798738 --> -0.868379).  Saving model ...
Epoch: 4 cost time: 3.2526040077209473
Epoch: 4, Steps: 89 | Train Loss: 0.484 Vali Loss: 0.379 Vali Acc: 0.902 Test Loss: 0.379 Test Acc: 0.902
Validation loss decreased (-0.868379 --> -0.901807).  Saving model ...
Epoch: 5 cost time: 2.8864424228668213
Epoch: 5, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
Validation loss decreased (-0.901807 --> -0.930359).  Saving model ...
Epoch: 6 cost time: 2.903982162475586
Epoch: 6, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.362518072128296
Epoch: 7, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
Validation loss decreased (-0.930359 --> -0.949859).  Saving model ...
Epoch: 8 cost time: 2.6175668239593506
Epoch: 8, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
Validation loss decreased (-0.949859 --> -0.959608).  Saving model ...
Epoch: 9 cost time: 2.4236457347869873
Epoch: 9, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
Validation loss decreased (-0.959608 --> -0.966572).  Saving model ...
Epoch: 10 cost time: 2.205498218536377
Epoch: 10, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3379557132720947
Epoch: 11, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.359052896499634
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.966572 --> -0.967965).  Saving model ...
Epoch: 13 cost time: 2.4618217945098877
Epoch: 13, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.007391929626465
Epoch: 14, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.967965 --> -0.974929).  Saving model ...
Epoch: 15 cost time: 3.1054673194885254
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5138907432556152
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 17 cost time: 2.8548104763031006
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 18 cost time: 3.014583110809326
Epoch: 18, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.603131055831909
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.699800729751587
Epoch: 20, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 21 cost time: 2.9858005046844482
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 22 cost time: 2.5830769538879395
Epoch: 22, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0471065044403076
Epoch: 23, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.981197).  Saving model ...
Epoch: 24 cost time: 2.1711041927337646
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.240868330001831
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7300283908843994
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3681883811950684
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 28 cost time: 2.9117488861083984
Epoch: 28, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.143421173095703
Epoch: 29, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.0227975845336914
Epoch: 30, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 31 cost time: 2.3283114433288574
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.91372013092041
Epoch: 32, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.196857213973999
Epoch: 33, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.667649745941162
Epoch: 34, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.0735480785369873
Epoch: 35, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.800642490386963
Epoch: 36, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.0145576000213623
Epoch: 37, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.6054224967956543
Epoch: 38, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.8301846981048584
Epoch: 39, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.961 Test Loss: 0.125 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.430931806564331
Epoch: 40, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm32_nh4_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 23540
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7865192890167236
Epoch: 1, Steps: 89 | Train Loss: 2.062 Vali Loss: 0.893 Vali Acc: 0.765 Test Loss: 0.893 Test Acc: 0.765
Validation loss decreased (inf --> -0.765311).  Saving model ...
Epoch: 2 cost time: 2.884448766708374
Epoch: 2, Steps: 89 | Train Loss: 0.639 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
Validation loss decreased (-0.765311 --> -0.859327).  Saving model ...
Epoch: 3 cost time: 2.493055820465088
Epoch: 3, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.295 Vali Acc: 0.923 Test Loss: 0.295 Test Acc: 0.923
Validation loss decreased (-0.859327 --> -0.922699).  Saving model ...
Epoch: 4 cost time: 2.836865186691284
Epoch: 4, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.265 Vali Acc: 0.920 Test Loss: 0.265 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5968503952026367
Epoch: 5, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.922699 --> -0.947770).  Saving model ...
Epoch: 6 cost time: 2.565967559814453
Epoch: 6, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
Validation loss decreased (-0.947770 --> -0.953341).  Saving model ...
Epoch: 7 cost time: 2.7020115852355957
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5088024139404297
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
Validation loss decreased (-0.953341 --> -0.963091).  Saving model ...
Epoch: 9 cost time: 3.0497539043426514
Epoch: 9, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6983277797698975
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5990569591522217
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.445974588394165
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.464240312576294
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
Validation loss decreased (-0.963091 --> -0.968662).  Saving model ...
Epoch: 14 cost time: 2.5681488513946533
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 15 cost time: 2.7720484733581543
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0363993644714355
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5927348136901855
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4126148223876953
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.191 Vali Acc: 0.955 Test Loss: 0.191 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.426361560821533
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5562527179718018
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2910428047180176
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.227 Vali Acc: 0.947 Test Loss: 0.227 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6243362426757812
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.5458590984344482
Epoch: 23, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.222 Vali Acc: 0.962 Test Loss: 0.222 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2873759269714355
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.961 Test Loss: 0.201 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 68308
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8150763511657715
Epoch: 1, Steps: 89 | Train Loss: 2.364 Vali Loss: 1.217 Vali Acc: 0.728 Test Loss: 1.217 Test Acc: 0.728
Validation loss decreased (inf --> -0.728400).  Saving model ...
Epoch: 2 cost time: 2.052213191986084
Epoch: 2, Steps: 89 | Train Loss: 0.864 Vali Loss: 0.599 Vali Acc: 0.847 Test Loss: 0.599 Test Acc: 0.847
Validation loss decreased (-0.728400 --> -0.847487).  Saving model ...
Epoch: 3 cost time: 2.741299867630005
Epoch: 3, Steps: 89 | Train Loss: 0.469 Vali Loss: 0.367 Vali Acc: 0.896 Test Loss: 0.367 Test Acc: 0.896
Validation loss decreased (-0.847487 --> -0.895540).  Saving model ...
Epoch: 4 cost time: 2.3668406009674072
Epoch: 4, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.273 Vali Acc: 0.928 Test Loss: 0.273 Test Acc: 0.928
Validation loss decreased (-0.895540 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 2.5903255939483643
Epoch: 5, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.928270 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 2.8643500804901123
Epoch: 6, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.205 Vali Acc: 0.938 Test Loss: 0.205 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.284560441970825
Epoch: 7, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.948466 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 2.276561737060547
Epoch: 8, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.950555 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 2.4007601737976074
Epoch: 9, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6239919662475586
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.814271926879883
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.967269 --> -0.967269).  Saving model ...
Epoch: 12 cost time: 2.810948371887207
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7859578132629395
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5885355472564697
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3901121616363525
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.374995470046997
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
Validation loss decreased (-0.967269 --> -0.970751).  Saving model ...
Epoch: 17 cost time: 2.263857841491699
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.509408473968506
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3448660373687744
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.613617181777954
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2298104763031006
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.0215048789978027
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.551961898803711
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 24 cost time: 3.130316734313965
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.2790942192077637
Epoch: 25, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7399823665618896
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.521111249923706
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.298346519470215
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 29 cost time: 3.4049270153045654
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.574904680252075
Epoch: 30, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.1614203453063965
Epoch: 31, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.9782087802886963
Epoch: 32, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.4693188667297363
Epoch: 33, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.3158676624298096
Epoch: 34, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.2779808044433594
Epoch: 35, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.716085195541382
Epoch: 36, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.0993492603302
Epoch: 37, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.663198947906494
Epoch: 38, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 44388
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.744619369506836
Epoch: 1, Steps: 89 | Train Loss: 2.519 Vali Loss: 1.522 Vali Acc: 0.680 Test Loss: 1.522 Test Acc: 0.680
Validation loss decreased (inf --> -0.679651).  Saving model ...
Epoch: 2 cost time: 2.4092469215393066
Epoch: 2, Steps: 89 | Train Loss: 1.050 Vali Loss: 0.662 Vali Acc: 0.828 Test Loss: 0.662 Test Acc: 0.828
Validation loss decreased (-0.679651 --> -0.827988).  Saving model ...
Epoch: 3 cost time: 2.951336622238159
Epoch: 3, Steps: 89 | Train Loss: 0.528 Vali Loss: 0.397 Vali Acc: 0.898 Test Loss: 0.397 Test Acc: 0.898
Validation loss decreased (-0.827988 --> -0.897628).  Saving model ...
Epoch: 4 cost time: 3.231926918029785
Epoch: 4, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.305 Vali Acc: 0.920 Test Loss: 0.305 Test Acc: 0.920
Validation loss decreased (-0.897628 --> -0.919913).  Saving model ...
Epoch: 5 cost time: 3.082317590713501
Epoch: 5, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
Validation loss decreased (-0.919913 --> -0.929663).  Saving model ...
Epoch: 6 cost time: 2.8085267543792725
Epoch: 6, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
Validation loss decreased (-0.929663 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 2.585407257080078
Epoch: 7, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.952644 --> -0.962394).  Saving model ...
Epoch: 8 cost time: 2.4689762592315674
Epoch: 8, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8594398498535156
Epoch: 9, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.962394 --> -0.965180).  Saving model ...
Epoch: 10 cost time: 3.261187791824341
Epoch: 10, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0404722690582275
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 2.7491748332977295
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.726858615875244
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 14 cost time: 2.728407859802246
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.195437431335449
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.156184673309326
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.137 Vali Acc: 0.958 Test Loss: 0.137 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.791775941848755
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.636876106262207
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 19 cost time: 2.4183006286621094
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974233).  Saving model ...
Epoch: 20 cost time: 2.3112096786499023
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 21 cost time: 2.2951810359954834
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.100 Vali Acc: 0.964 Test Loss: 0.100 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3835854530334473
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.284468173980713
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7067835330963135
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.2943804264068604
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.7588627338409424
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.370123863220215
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.8181893825531006
Epoch: 28, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 29 cost time: 2.487271785736084
Epoch: 29, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.170719623565674
Epoch: 30, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.177428960800171
Epoch: 31, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.044210433959961
Epoch: 32, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.1452677249908447
Epoch: 33, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.1409053802490234
Epoch: 34, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.8163692951202393
Epoch: 35, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.587949514389038
Epoch: 36, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.907646894454956
Epoch: 37, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.4742319583892822
Epoch: 38, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 34852
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.47715425491333
Epoch: 1, Steps: 89 | Train Loss: 2.589 Vali Loss: 1.709 Vali Acc: 0.653 Test Loss: 1.709 Test Acc: 0.653
Validation loss decreased (inf --> -0.653186).  Saving model ...
Epoch: 2 cost time: 2.369893789291382
Epoch: 2, Steps: 89 | Train Loss: 1.211 Vali Loss: 0.750 Vali Acc: 0.830 Test Loss: 0.750 Test Acc: 0.830
Validation loss decreased (-0.653186 --> -0.830076).  Saving model ...
Epoch: 3 cost time: 2.7787797451019287
Epoch: 3, Steps: 89 | Train Loss: 0.631 Vali Loss: 0.479 Vali Acc: 0.874 Test Loss: 0.479 Test Acc: 0.874
Validation loss decreased (-0.830076 --> -0.873951).  Saving model ...
Epoch: 4 cost time: 2.4316461086273193
Epoch: 4, Steps: 89 | Train Loss: 0.405 Vali Loss: 0.339 Vali Acc: 0.912 Test Loss: 0.339 Test Acc: 0.912
Validation loss decreased (-0.873951 --> -0.912253).  Saving model ...
Epoch: 5 cost time: 2.2589190006256104
Epoch: 5, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.912253 --> -0.917128).  Saving model ...
Epoch: 6 cost time: 2.165741443634033
Epoch: 6, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.219 Vali Acc: 0.942 Test Loss: 0.219 Test Acc: 0.942
Validation loss decreased (-0.917128 --> -0.941502).  Saving model ...
Epoch: 7 cost time: 2.336622953414917
Epoch: 7, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.941502 --> -0.948466).  Saving model ...
Epoch: 8 cost time: 2.1725053787231445
Epoch: 8, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.948466 --> -0.958216).  Saving model ...
Epoch: 9 cost time: 2.4134514331817627
Epoch: 9, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
Validation loss decreased (-0.958216 --> -0.958912).  Saving model ...
Epoch: 10 cost time: 2.4857535362243652
Epoch: 10, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.475275993347168
Epoch: 11, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.958912 --> -0.961698).  Saving model ...
Epoch: 12 cost time: 2.5296289920806885
Epoch: 12, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
Validation loss decreased (-0.961698 --> -0.965876).  Saving model ...
Epoch: 13 cost time: 2.689692497253418
Epoch: 13, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.765751838684082
Epoch: 14, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.133 Vali Acc: 0.961 Test Loss: 0.133 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6591620445251465
Epoch: 15, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6820762157440186
Epoch: 16, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
Validation loss decreased (-0.965876 --> -0.972144).  Saving model ...
Epoch: 17 cost time: 2.362149715423584
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8768341541290283
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.109 Vali Acc: 0.964 Test Loss: 0.109 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1570284366607666
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1444218158721924
Epoch: 20, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0840983390808105
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2232167720794678
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4848792552948
Epoch: 23, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2677524089813232
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.1707563400268555
Epoch: 25, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.117 Vali Acc: 0.960 Test Loss: 0.117 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.5414323806762695
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 27 cost time: 2.1852681636810303
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.118239164352417
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.309526205062866
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.977019).  Saving model ...
Epoch: 30 cost time: 1.954594373703003
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.432030200958252
Epoch: 31, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.429776906967163
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.47459077835083
Epoch: 33, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.2650790214538574
Epoch: 34, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.2967400550842285
Epoch: 35, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.5964467525482178
Epoch: 36, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.6664083003997803
Epoch: 37, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.6601762771606445
Epoch: 38, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.664438009262085
Epoch: 39, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 27252
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9719910621643066
Epoch: 1, Steps: 89 | Train Loss: 2.752 Vali Loss: 2.041 Vali Acc: 0.575 Test Loss: 2.041 Test Acc: 0.575
Validation loss decreased (inf --> -0.575189).  Saving model ...
Epoch: 2 cost time: 2.461108922958374
Epoch: 2, Steps: 89 | Train Loss: 1.546 Vali Loss: 0.973 Vali Acc: 0.790 Test Loss: 0.973 Test Acc: 0.790
Validation loss decreased (-0.575189 --> -0.790380).  Saving model ...
Epoch: 3 cost time: 2.4503915309906006
Epoch: 3, Steps: 89 | Train Loss: 0.793 Vali Loss: 0.581 Vali Acc: 0.867 Test Loss: 0.581 Test Acc: 0.867
Validation loss decreased (-0.790380 --> -0.866986).  Saving model ...
Epoch: 4 cost time: 2.4726455211639404
Epoch: 4, Steps: 89 | Train Loss: 0.512 Vali Loss: 0.430 Vali Acc: 0.896 Test Loss: 0.430 Test Acc: 0.896
Validation loss decreased (-0.866986 --> -0.896235).  Saving model ...
Epoch: 5 cost time: 2.3886327743530273
Epoch: 5, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.330 Vali Acc: 0.918 Test Loss: 0.330 Test Acc: 0.918
Validation loss decreased (-0.896235 --> -0.917824).  Saving model ...
Epoch: 6 cost time: 2.416273355484009
Epoch: 6, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.256 Vali Acc: 0.935 Test Loss: 0.256 Test Acc: 0.935
Validation loss decreased (-0.917824 --> -0.934538).  Saving model ...
Epoch: 7 cost time: 2.690598487854004
Epoch: 7, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.211 Vali Acc: 0.953 Test Loss: 0.211 Test Acc: 0.953
Validation loss decreased (-0.934538 --> -0.953341).  Saving model ...
Epoch: 8 cost time: 3.381410837173462
Epoch: 8, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
Validation loss decreased (-0.953341 --> -0.954733).  Saving model ...
Epoch: 9 cost time: 3.4128382205963135
Epoch: 9, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.871873617172241
Epoch: 10, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.954733 --> -0.961698).  Saving model ...
Epoch: 11 cost time: 3.278390645980835
Epoch: 11, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9828100204467773
Epoch: 12, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.132 Vali Acc: 0.960 Test Loss: 0.132 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7629122734069824
Epoch: 13, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.968662).  Saving model ...
Epoch: 14 cost time: 2.7146153450012207
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 15 cost time: 3.0452146530151367
Epoch: 15, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 16 cost time: 2.700916290283203
Epoch: 16, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.606663465499878
Epoch: 17, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0585854053497314
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.869752883911133
Epoch: 19, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.544774055480957
Epoch: 20, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 21 cost time: 2.959845542907715
Epoch: 21, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 22 cost time: 3.039299249649048
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.672313690185547
Epoch: 23, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.980501).  Saving model ...
Epoch: 24 cost time: 2.3698363304138184
Epoch: 24, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4453482627868652
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.353574275970459
Epoch: 26, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.8349413871765137
Epoch: 27, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.578676223754883
Epoch: 28, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.981197).  Saving model ...
Epoch: 29 cost time: 2.7948551177978516
Epoch: 29, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.0658459663391113
Epoch: 30, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.8939590454101562
Epoch: 31, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.637256622314453
Epoch: 32, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.5545151233673096
Epoch: 33, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.957791566848755
Epoch: 34, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.990565776824951
Epoch: 35, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.055168867111206
Epoch: 36, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.943617582321167
Epoch: 37, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.7641170024871826
Epoch: 38, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 39 cost time: 2.6845250129699707
Epoch: 39, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.6431713104248047
Epoch: 40, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.4501793384552
Epoch: 41, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.781954050064087
Epoch: 42, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.9658725261688232
Epoch: 43, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.990029811859131
Epoch: 44, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.846195936203003
Epoch: 45, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.8208465576171875
Epoch: 46, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.581824779510498
Epoch: 47, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.7916038036346436
Epoch: 48, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 22596
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.744668483734131
Epoch: 1, Steps: 89 | Train Loss: 2.818 Vali Loss: 2.232 Vali Acc: 0.485 Test Loss: 2.232 Test Acc: 0.485
Validation loss decreased (inf --> -0.484657).  Saving model ...
Epoch: 2 cost time: 2.425701379776001
Epoch: 2, Steps: 89 | Train Loss: 1.807 Vali Loss: 1.244 Vali Acc: 0.721 Test Loss: 1.244 Test Acc: 0.721
Validation loss decreased (-0.484657 --> -0.720740).  Saving model ...
Epoch: 3 cost time: 2.2785115242004395
Epoch: 3, Steps: 89 | Train Loss: 1.022 Vali Loss: 0.771 Vali Acc: 0.831 Test Loss: 0.771 Test Acc: 0.831
Validation loss decreased (-0.720740 --> -0.831469).  Saving model ...
Epoch: 4 cost time: 2.1548802852630615
Epoch: 4, Steps: 89 | Train Loss: 0.688 Vali Loss: 0.566 Vali Acc: 0.862 Test Loss: 0.566 Test Acc: 0.862
Validation loss decreased (-0.831469 --> -0.862111).  Saving model ...
Epoch: 5 cost time: 2.073213815689087
Epoch: 5, Steps: 89 | Train Loss: 0.515 Vali Loss: 0.443 Vali Acc: 0.884 Test Loss: 0.443 Test Acc: 0.884
Validation loss decreased (-0.862111 --> -0.884397).  Saving model ...
Epoch: 6 cost time: 2.2450921535491943
Epoch: 6, Steps: 89 | Train Loss: 0.403 Vali Loss: 0.341 Vali Acc: 0.920 Test Loss: 0.341 Test Acc: 0.920
Validation loss decreased (-0.884397 --> -0.919913).  Saving model ...
Epoch: 7 cost time: 2.404043197631836
Epoch: 7, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.278 Vali Acc: 0.934 Test Loss: 0.278 Test Acc: 0.934
Validation loss decreased (-0.919913 --> -0.933841).  Saving model ...
Epoch: 8 cost time: 2.4200315475463867
Epoch: 8, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.249 Vali Acc: 0.940 Test Loss: 0.249 Test Acc: 0.940
Validation loss decreased (-0.933841 --> -0.940109).  Saving model ...
Epoch: 9 cost time: 1.9811439514160156
Epoch: 9, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.221 Vali Acc: 0.951 Test Loss: 0.221 Test Acc: 0.951
Validation loss decreased (-0.940109 --> -0.950555).  Saving model ...
Epoch: 10 cost time: 2.137605667114258
Epoch: 10, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.950555 --> -0.956126).  Saving model ...
Epoch: 11 cost time: 2.7293083667755127
Epoch: 11, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.956126 --> -0.958216).  Saving model ...
Epoch: 12 cost time: 2.358346462249756
Epoch: 12, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.958216 --> -0.965180).  Saving model ...
Epoch: 13 cost time: 2.3933823108673096
Epoch: 13, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5731751918792725
Epoch: 14, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 2.184220552444458
Epoch: 15, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1697261333465576
Epoch: 16, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.152315616607666
Epoch: 17, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.973536).  Saving model ...
Epoch: 18 cost time: 2.224515676498413
Epoch: 18, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7164878845214844
Epoch: 19, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.973536 --> -0.974929).  Saving model ...
Epoch: 20 cost time: 2.6916019916534424
Epoch: 20, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.326019763946533
Epoch: 21, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 22 cost time: 2.4122891426086426
Epoch: 22, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.119 Vali Acc: 0.966 Test Loss: 0.119 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6574692726135254
Epoch: 23, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.37317156791687
Epoch: 24, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2449429035186768
Epoch: 25, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 26 cost time: 3.4934942722320557
Epoch: 26, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.238431692123413
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 28 cost time: 2.904428720474243
Epoch: 28, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.8154797554016113
Epoch: 29, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.814757823944092
Epoch: 30, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.8070335388183594
Epoch: 31, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.054434061050415
Epoch: 32, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.0219526290893555
Epoch: 33, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.289503574371338
Epoch: 34, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.261176347732544
Epoch: 35, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.8265299797058105
Epoch: 36, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.8530144691467285
Epoch: 37, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 18900
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.096406936645508
Epoch: 1, Steps: 89 | Train Loss: 2.977 Vali Loss: 2.421 Vali Acc: 0.379 Test Loss: 2.421 Test Acc: 0.379
Validation loss decreased (inf --> -0.378806).  Saving model ...
Epoch: 2 cost time: 2.7782812118530273
Epoch: 2, Steps: 89 | Train Loss: 2.044 Vali Loss: 1.419 Vali Acc: 0.666 Test Loss: 1.419 Test Acc: 0.666
Validation loss decreased (-0.378806 --> -0.666420).  Saving model ...
Epoch: 3 cost time: 3.0255966186523438
Epoch: 3, Steps: 89 | Train Loss: 1.179 Vali Loss: 0.848 Vali Acc: 0.833 Test Loss: 0.848 Test Acc: 0.833
Validation loss decreased (-0.666420 --> -0.832861).  Saving model ...
Epoch: 4 cost time: 2.737724781036377
Epoch: 4, Steps: 89 | Train Loss: 0.770 Vali Loss: 0.618 Vali Acc: 0.866 Test Loss: 0.618 Test Acc: 0.866
Validation loss decreased (-0.832861 --> -0.866289).  Saving model ...
Epoch: 5 cost time: 2.7583115100860596
Epoch: 5, Steps: 89 | Train Loss: 0.581 Vali Loss: 0.489 Vali Acc: 0.880 Test Loss: 0.489 Test Acc: 0.880
Validation loss decreased (-0.866289 --> -0.880218).  Saving model ...
Epoch: 6 cost time: 2.7020318508148193
Epoch: 6, Steps: 89 | Train Loss: 0.458 Vali Loss: 0.396 Vali Acc: 0.906 Test Loss: 0.396 Test Acc: 0.906
Validation loss decreased (-0.880218 --> -0.905985).  Saving model ...
Epoch: 7 cost time: 3.0878114700317383
Epoch: 7, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.322 Vali Acc: 0.927 Test Loss: 0.322 Test Acc: 0.927
Validation loss decreased (-0.905985 --> -0.926877).  Saving model ...
Epoch: 8 cost time: 3.1566882133483887
Epoch: 8, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.281 Vali Acc: 0.935 Test Loss: 0.281 Test Acc: 0.935
Validation loss decreased (-0.926877 --> -0.935234).  Saving model ...
Epoch: 9 cost time: 2.601924419403076
Epoch: 9, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.935234 --> -0.940805).  Saving model ...
Epoch: 10 cost time: 2.7611136436462402
Epoch: 10, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.940805 --> -0.941502).  Saving model ...
Epoch: 11 cost time: 3.096658229827881
Epoch: 11, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
Validation loss decreased (-0.941502 --> -0.953341).  Saving model ...
Epoch: 12 cost time: 2.940812110900879
Epoch: 12, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.953341 --> -0.958912).  Saving model ...
Epoch: 13 cost time: 3.0193660259246826
Epoch: 13, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.959608).  Saving model ...
Epoch: 14 cost time: 2.8849072456359863
Epoch: 14, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
Validation loss decreased (-0.959608 --> -0.963787).  Saving model ...
Epoch: 15 cost time: 2.8045315742492676
Epoch: 15, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.968662).  Saving model ...
Epoch: 16 cost time: 3.1469881534576416
Epoch: 16, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.973536).  Saving model ...
Epoch: 17 cost time: 3.345198392868042
Epoch: 17, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8997533321380615
Epoch: 18, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.976322).  Saving model ...
Epoch: 19 cost time: 2.9050793647766113
Epoch: 19, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9448206424713135
Epoch: 20, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 21 cost time: 3.316817045211792
Epoch: 21, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.148303747177124
Epoch: 22, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.84656023979187
Epoch: 23, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.977018 --> -0.977018).  Saving model ...
Epoch: 24 cost time: 2.8132872581481934
Epoch: 24, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 25 cost time: 3.719897985458374
Epoch: 25, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.037844181060791
Epoch: 26, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.681443452835083
Epoch: 27, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.781752586364746
Epoch: 28, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.63539981842041
Epoch: 29, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.796435594558716
Epoch: 30, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 31 cost time: 3.2332634925842285
Epoch: 31, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.1637067794799805
Epoch: 32, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
Validation loss decreased (-0.978411 --> -0.983982).  Saving model ...
Epoch: 33 cost time: 3.2737808227539062
Epoch: 33, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.5796587467193604
Epoch: 34, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.9961514472961426
Epoch: 35, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.005416631698608
Epoch: 36, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.4038329124450684
Epoch: 37, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.062269449234009
Epoch: 38, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.948948383331299
Epoch: 39, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.9822680950164795
Epoch: 40, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.187840700149536
Epoch: 41, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.7440319061279297
Epoch: 42, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df256_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 17124
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.891080141067505
Epoch: 1, Steps: 89 | Train Loss: 2.021 Vali Loss: 0.885 Vali Acc: 0.799 Test Loss: 0.885 Test Acc: 0.799
Validation loss decreased (inf --> -0.798738).  Saving model ...
Epoch: 2 cost time: 3.162060260772705
Epoch: 2, Steps: 89 | Train Loss: 0.635 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
Validation loss decreased (-0.798738 --> -0.888575).  Saving model ...
Epoch: 3 cost time: 2.636730432510376
Epoch: 3, Steps: 89 | Train Loss: 0.347 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.888575 --> -0.917128).  Saving model ...
Epoch: 4 cost time: 3.4575998783111572
Epoch: 4, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
Validation loss decreased (-0.917128 --> -0.929663).  Saving model ...
Epoch: 5 cost time: 3.4717044830322266
Epoch: 5, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
Validation loss decreased (-0.929663 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 3.0322020053863525
Epoch: 6, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.942895 --> -0.944288).  Saving model ...
Epoch: 7 cost time: 3.238396167755127
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.944288 --> -0.951948).  Saving model ...
Epoch: 8 cost time: 2.993711233139038
Epoch: 8, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.951948 --> -0.951948).  Saving model ...
Epoch: 9 cost time: 3.0466864109039307
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.951948 --> -0.957519).  Saving model ...
Epoch: 10 cost time: 3.6693241596221924
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
Validation loss decreased (-0.957519 --> -0.967965).  Saving model ...
Epoch: 11 cost time: 3.068493127822876
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.472878932952881
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 13 cost time: 3.265897750854492
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9997761249542236
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9961047172546387
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.0520753860473633
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 17 cost time: 3.140211343765259
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4004781246185303
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 19 cost time: 3.539771795272827
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2938954830169678
Epoch: 20, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
Validation loss decreased (-0.969358 --> -0.969358).  Saving model ...
Epoch: 21 cost time: 3.253326892852783
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1087653636932373
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9205005168914795
Epoch: 23, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.260 Vali Acc: 0.946 Test Loss: 0.260 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.768824338912964
Epoch: 24, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.8412604331970215
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.198 Vali Acc: 0.964 Test Loss: 0.198 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.0472569465637207
Epoch: 26, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.169 Vali Acc: 0.965 Test Loss: 0.169 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.5228729248046875
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.233 Vali Acc: 0.962 Test Loss: 0.233 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.501523971557617
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.276 Vali Acc: 0.946 Test Loss: 0.276 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.609248161315918
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.255 Vali Acc: 0.958 Test Loss: 0.255 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.374039649963379
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.966 Test Loss: 0.190 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 64084
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.466767311096191
Epoch: 1, Steps: 89 | Train Loss: 2.371 Vali Loss: 1.271 Vali Acc: 0.741 Test Loss: 1.271 Test Acc: 0.741
Validation loss decreased (inf --> -0.740934).  Saving model ...
Epoch: 2 cost time: 3.0249123573303223
Epoch: 2, Steps: 89 | Train Loss: 0.896 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
Validation loss decreased (-0.740934 --> -0.844005).  Saving model ...
Epoch: 3 cost time: 2.675875425338745
Epoch: 3, Steps: 89 | Train Loss: 0.479 Vali Loss: 0.377 Vali Acc: 0.894 Test Loss: 0.377 Test Acc: 0.894
Validation loss decreased (-0.844005 --> -0.894147).  Saving model ...
Epoch: 4 cost time: 2.7323224544525146
Epoch: 4, Steps: 89 | Train Loss: 0.318 Vali Loss: 0.294 Vali Acc: 0.912 Test Loss: 0.294 Test Acc: 0.912
Validation loss decreased (-0.894147 --> -0.911557).  Saving model ...
Epoch: 5 cost time: 3.410191535949707
Epoch: 5, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.224 Vali Acc: 0.942 Test Loss: 0.224 Test Acc: 0.942
Validation loss decreased (-0.911557 --> -0.942198).  Saving model ...
Epoch: 6 cost time: 3.3510005474090576
Epoch: 6, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.184 Vali Acc: 0.945 Test Loss: 0.184 Test Acc: 0.945
Validation loss decreased (-0.942198 --> -0.944984).  Saving model ...
Epoch: 7 cost time: 2.7830417156219482
Epoch: 7, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
Validation loss decreased (-0.944984 --> -0.946377).  Saving model ...
Epoch: 8 cost time: 2.533599376678467
Epoch: 8, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.946377 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 3.1800780296325684
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9500980377197266
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3076956272125244
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966572).  Saving model ...
Epoch: 12 cost time: 2.507570266723633
Epoch: 12, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.968662).  Saving model ...
Epoch: 13 cost time: 3.047757863998413
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.343769073486328
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 2.5563712120056152
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 16 cost time: 2.620908737182617
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.994229555130005
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.175992012023926
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.966008186340332
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.618379831314087
Epoch: 20, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.13226580619812
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 22 cost time: 2.7275679111480713
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 23 cost time: 1.9612948894500732
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.058302402496338
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2628235816955566
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.966517448425293
Epoch: 26, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.974597454071045
Epoch: 27, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9751157760620117
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9971251487731934
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.185 Vali Acc: 0.960 Test Loss: 0.185 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.0023770332336426
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9489266872406006
Epoch: 31, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.125727653503418
Epoch: 32, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 40164
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.623100757598877
Epoch: 1, Steps: 89 | Train Loss: 2.509 Vali Loss: 1.526 Vali Acc: 0.678 Test Loss: 1.526 Test Acc: 0.678
Validation loss decreased (inf --> -0.677561).  Saving model ...
Epoch: 2 cost time: 2.919952869415283
Epoch: 2, Steps: 89 | Train Loss: 1.052 Vali Loss: 0.689 Vali Acc: 0.822 Test Loss: 0.689 Test Acc: 0.822
Validation loss decreased (-0.677561 --> -0.822417).  Saving model ...
Epoch: 3 cost time: 2.7409582138061523
Epoch: 3, Steps: 89 | Train Loss: 0.552 Vali Loss: 0.443 Vali Acc: 0.870 Test Loss: 0.443 Test Acc: 0.870
Validation loss decreased (-0.822417 --> -0.869773).  Saving model ...
Epoch: 4 cost time: 3.309926748275757
Epoch: 4, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.316 Vali Acc: 0.916 Test Loss: 0.316 Test Acc: 0.916
Validation loss decreased (-0.869773 --> -0.916431).  Saving model ...
Epoch: 5 cost time: 3.5610806941986084
Epoch: 5, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.239 Vali Acc: 0.932 Test Loss: 0.239 Test Acc: 0.932
Validation loss decreased (-0.916431 --> -0.932449).  Saving model ...
Epoch: 6 cost time: 3.2534613609313965
Epoch: 6, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.932449 --> -0.951948).  Saving model ...
Epoch: 7 cost time: 3.1031477451324463
Epoch: 7, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.468449115753174
Epoch: 8, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.951948 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 3.1578190326690674
Epoch: 9, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.962394 --> -0.967269).  Saving model ...
Epoch: 10 cost time: 3.6062963008880615
Epoch: 10, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.581958532333374
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8087260723114014
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972144).  Saving model ...
Epoch: 13 cost time: 3.6970605850219727
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.9486725330352783
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.031245946884155
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1292481422424316
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 17 cost time: 2.851184606552124
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976322).  Saving model ...
Epoch: 18 cost time: 2.9794719219207764
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5663604736328125
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6496407985687256
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.6059298515319824
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.347223997116089
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.735935926437378
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.5031869411468506
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.1697397232055664
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.9694087505340576
Epoch: 26, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.9304280281066895
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 30628
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.672500133514404
Epoch: 1, Steps: 89 | Train Loss: 2.582 Vali Loss: 1.730 Vali Acc: 0.643 Test Loss: 1.730 Test Acc: 0.643
Validation loss decreased (inf --> -0.642740).  Saving model ...
Epoch: 2 cost time: 3.242480993270874
Epoch: 2, Steps: 89 | Train Loss: 1.246 Vali Loss: 0.765 Vali Acc: 0.829 Test Loss: 0.765 Test Acc: 0.829
Validation loss decreased (-0.642740 --> -0.829380).  Saving model ...
Epoch: 3 cost time: 3.149413585662842
Epoch: 3, Steps: 89 | Train Loss: 0.606 Vali Loss: 0.488 Vali Acc: 0.880 Test Loss: 0.488 Test Acc: 0.880
Validation loss decreased (-0.829380 --> -0.880218).  Saving model ...
Epoch: 4 cost time: 3.2597689628601074
Epoch: 4, Steps: 89 | Train Loss: 0.407 Vali Loss: 0.352 Vali Acc: 0.907 Test Loss: 0.352 Test Acc: 0.907
Validation loss decreased (-0.880218 --> -0.906682).  Saving model ...
Epoch: 5 cost time: 2.9878125190734863
Epoch: 5, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.283 Vali Acc: 0.921 Test Loss: 0.283 Test Acc: 0.921
Validation loss decreased (-0.906682 --> -0.920610).  Saving model ...
Epoch: 6 cost time: 2.984330892562866
Epoch: 6, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.217 Vali Acc: 0.942 Test Loss: 0.217 Test Acc: 0.942
Validation loss decreased (-0.920610 --> -0.941502).  Saving model ...
Epoch: 7 cost time: 2.745971918106079
Epoch: 7, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.205 Vali Acc: 0.945 Test Loss: 0.205 Test Acc: 0.945
Validation loss decreased (-0.941502 --> -0.944984).  Saving model ...
Epoch: 8 cost time: 3.036530017852783
Epoch: 8, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
Validation loss decreased (-0.944984 --> -0.950555).  Saving model ...
Epoch: 9 cost time: 3.00055193901062
Epoch: 9, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.950555 --> -0.956823).  Saving model ...
Epoch: 10 cost time: 3.307055950164795
Epoch: 10, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4132182598114014
Epoch: 11, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
Validation loss decreased (-0.956823 --> -0.963091).  Saving model ...
Epoch: 12 cost time: 3.262481451034546
Epoch: 12, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
Validation loss decreased (-0.963091 --> -0.963091).  Saving model ...
Epoch: 13 cost time: 3.1118993759155273
Epoch: 13, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
Validation loss decreased (-0.963091 --> -0.963091).  Saving model ...
Epoch: 14 cost time: 2.9544594287872314
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.963787).  Saving model ...
Epoch: 15 cost time: 3.0066189765930176
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.116 Vali Acc: 0.963 Test Loss: 0.116 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7418951988220215
Epoch: 16, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.111 Vali Acc: 0.963 Test Loss: 0.111 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7090909481048584
Epoch: 17, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.964483).  Saving model ...
Epoch: 18 cost time: 2.924715757369995
Epoch: 18, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965876).  Saving model ...
Epoch: 19 cost time: 3.2695188522338867
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.965876 --> -0.972840).  Saving model ...
Epoch: 20 cost time: 2.9746222496032715
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9411656856536865
Epoch: 21, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.2247047424316406
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0620009899139404
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.8628087043762207
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.9090700149536133
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.1552016735076904
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.8108327388763428
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.102 Vali Acc: 0.966 Test Loss: 0.102 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.1026298999786377
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.176619052886963
Epoch: 29, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 23028
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.340963840484619
Epoch: 1, Steps: 89 | Train Loss: 2.678 Vali Loss: 2.019 Vali Acc: 0.574 Test Loss: 2.019 Test Acc: 0.574
Validation loss decreased (inf --> -0.573796).  Saving model ...
Epoch: 2 cost time: 2.9191877841949463
Epoch: 2, Steps: 89 | Train Loss: 1.554 Vali Loss: 0.973 Vali Acc: 0.815 Test Loss: 0.973 Test Acc: 0.815
Validation loss decreased (-0.573796 --> -0.814753).  Saving model ...
Epoch: 3 cost time: 2.7472565174102783
Epoch: 3, Steps: 89 | Train Loss: 0.794 Vali Loss: 0.593 Vali Acc: 0.859 Test Loss: 0.593 Test Acc: 0.859
Validation loss decreased (-0.814753 --> -0.858629).  Saving model ...
Epoch: 4 cost time: 2.8788862228393555
Epoch: 4, Steps: 89 | Train Loss: 0.515 Vali Loss: 0.424 Vali Acc: 0.896 Test Loss: 0.424 Test Acc: 0.896
Validation loss decreased (-0.858629 --> -0.895539).  Saving model ...
Epoch: 5 cost time: 3.1285240650177
Epoch: 5, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.327 Vali Acc: 0.907 Test Loss: 0.327 Test Acc: 0.907
Validation loss decreased (-0.895539 --> -0.906682).  Saving model ...
Epoch: 6 cost time: 3.217956304550171
Epoch: 6, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
Validation loss decreased (-0.906682 --> -0.934538).  Saving model ...
Epoch: 7 cost time: 2.9429144859313965
Epoch: 7, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.213 Vali Acc: 0.949 Test Loss: 0.213 Test Acc: 0.949
Validation loss decreased (-0.934538 --> -0.949162).  Saving model ...
Epoch: 8 cost time: 3.015028715133667
Epoch: 8, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
Validation loss decreased (-0.949162 --> -0.956823).  Saving model ...
Epoch: 9 cost time: 2.9760212898254395
Epoch: 9, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.960305).  Saving model ...
Epoch: 10 cost time: 3.0118072032928467
Epoch: 10, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 2.831146001815796
Epoch: 11, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.964446544647217
Epoch: 12, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.482813596725464
Epoch: 13, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968662).  Saving model ...
Epoch: 14 cost time: 3.6051855087280273
Epoch: 14, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 3.523373603820801
Epoch: 15, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.975626).  Saving model ...
Epoch: 16 cost time: 3.3630735874176025
Epoch: 16, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.10697078704834
Epoch: 17, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2927968502044678
Epoch: 18, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5538463592529297
Epoch: 19, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 20 cost time: 3.3475985527038574
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 21 cost time: 3.1464271545410156
Epoch: 21, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3507492542266846
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.980501).  Saving model ...
Epoch: 23 cost time: 2.986631393432617
Epoch: 23, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6296935081481934
Epoch: 24, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.7969956398010254
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.0815634727478027
Epoch: 26, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.215052366256714
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.8522846698760986
Epoch: 28, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.741586923599243
Epoch: 29, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.724618911743164
Epoch: 30, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.911201000213623
Epoch: 31, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.013373374938965
Epoch: 32, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 18372
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.3846094608306885
Epoch: 1, Steps: 89 | Train Loss: 2.786 Vali Loss: 2.238 Vali Acc: 0.479 Test Loss: 2.238 Test Acc: 0.479
Validation loss decreased (inf --> -0.479086).  Saving model ...
Epoch: 2 cost time: 3.2596535682678223
Epoch: 2, Steps: 89 | Train Loss: 1.785 Vali Loss: 1.210 Vali Acc: 0.788 Test Loss: 1.210 Test Acc: 0.788
Validation loss decreased (-0.479086 --> -0.788289).  Saving model ...
Epoch: 3 cost time: 2.8814046382904053
Epoch: 3, Steps: 89 | Train Loss: 0.985 Vali Loss: 0.724 Vali Acc: 0.836 Test Loss: 0.724 Test Acc: 0.836
Validation loss decreased (-0.788289 --> -0.836344).  Saving model ...
Epoch: 4 cost time: 3.096025228500366
Epoch: 4, Steps: 89 | Train Loss: 0.652 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
Validation loss decreased (-0.836344 --> -0.871861).  Saving model ...
Epoch: 5 cost time: 2.993821859359741
Epoch: 5, Steps: 89 | Train Loss: 0.487 Vali Loss: 0.397 Vali Acc: 0.909 Test Loss: 0.397 Test Acc: 0.909
Validation loss decreased (-0.871861 --> -0.908770).  Saving model ...
Epoch: 6 cost time: 3.055410861968994
Epoch: 6, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.314 Vali Acc: 0.928 Test Loss: 0.314 Test Acc: 0.928
Validation loss decreased (-0.908770 --> -0.927573).  Saving model ...
Epoch: 7 cost time: 3.135354995727539
Epoch: 7, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.256 Vali Acc: 0.942 Test Loss: 0.256 Test Acc: 0.942
Validation loss decreased (-0.927573 --> -0.942198).  Saving model ...
Epoch: 8 cost time: 3.1160061359405518
Epoch: 8, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.225 Vali Acc: 0.947 Test Loss: 0.225 Test Acc: 0.947
Validation loss decreased (-0.942198 --> -0.947073).  Saving model ...
Epoch: 9 cost time: 3.325774908065796
Epoch: 9, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.214 Vali Acc: 0.940 Test Loss: 0.214 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.947118043899536
Epoch: 10, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
Validation loss decreased (-0.947073 --> -0.949162).  Saving model ...
Epoch: 11 cost time: 3.211392402648926
Epoch: 11, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.949162 --> -0.958912).  Saving model ...
Epoch: 12 cost time: 2.878692150115967
Epoch: 12, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.958912 --> -0.962394).  Saving model ...
Epoch: 13 cost time: 3.3100264072418213
Epoch: 13, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.968662).  Saving model ...
Epoch: 14 cost time: 3.276102066040039
Epoch: 14, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6830832958221436
Epoch: 15, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6186139583587646
Epoch: 16, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.9394755363464355
Epoch: 17, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0470569133758545
Epoch: 18, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970751).  Saving model ...
Epoch: 19 cost time: 3.0888707637786865
Epoch: 19, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.970751 --> -0.977018).  Saving model ...
Epoch: 20 cost time: 2.9138097763061523
Epoch: 20, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9087119102478027
Epoch: 21, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.771238088607788
Epoch: 22, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.890073537826538
Epoch: 23, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.0398192405700684
Epoch: 24, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.73392915725708
Epoch: 25, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.8342130184173584
Epoch: 26, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.184818744659424
Epoch: 27, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.9013195037841797
Epoch: 28, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.977018 --> -0.977019).  Saving model ...
Epoch: 29 cost time: 2.7204649448394775
Epoch: 29, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 30 cost time: 3.0106453895568848
Epoch: 30, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4180781841278076
Epoch: 31, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.2700626850128174
Epoch: 32, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.2661547660827637
Epoch: 33, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.1315765380859375
Epoch: 34, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 35 cost time: 3.0524187088012695
Epoch: 35, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.571316957473755
Epoch: 36, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 37 cost time: 3.270336151123047
Epoch: 37, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.8577218055725098
Epoch: 38, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.3894803524017334
Epoch: 39, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.1220171451568604
Epoch: 40, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.1029980182647705
Epoch: 41, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.2435810565948486
Epoch: 42, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.259172201156616
Epoch: 43, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.07072114944458
Epoch: 44, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 45 cost time: 2.9296014308929443
Epoch: 45, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.124166250228882
Epoch: 46, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.857342004776001
Epoch: 47, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.8195583820343018
Epoch: 48, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.196223497390747
Epoch: 49, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.208303451538086
Epoch: 50, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.0669407844543457
Epoch: 51, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.2066309452056885
Epoch: 52, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.0953431129455566
Epoch: 53, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.382503032684326
Epoch: 54, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 14676
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.482293367385864
Epoch: 1, Steps: 89 | Train Loss: 2.819 Vali Loss: 2.285 Vali Acc: 0.497 Test Loss: 2.285 Test Acc: 0.497
Validation loss decreased (inf --> -0.497192).  Saving model ...
Epoch: 2 cost time: 2.8437411785125732
Epoch: 2, Steps: 89 | Train Loss: 1.941 Vali Loss: 1.351 Vali Acc: 0.717 Test Loss: 1.351 Test Acc: 0.717
Validation loss decreased (-0.497192 --> -0.717257).  Saving model ...
Epoch: 3 cost time: 2.9079833030700684
Epoch: 3, Steps: 89 | Train Loss: 1.166 Vali Loss: 0.861 Vali Acc: 0.817 Test Loss: 0.861 Test Acc: 0.817
Validation loss decreased (-0.717257 --> -0.816844).  Saving model ...
Epoch: 4 cost time: 3.2083418369293213
Epoch: 4, Steps: 89 | Train Loss: 0.788 Vali Loss: 0.632 Vali Acc: 0.847 Test Loss: 0.632 Test Acc: 0.847
Validation loss decreased (-0.816844 --> -0.847487).  Saving model ...
Epoch: 5 cost time: 3.167405128479004
Epoch: 5, Steps: 89 | Train Loss: 0.595 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
Validation loss decreased (-0.847487 --> -0.871861).  Saving model ...
Epoch: 6 cost time: 3.167736768722534
Epoch: 6, Steps: 89 | Train Loss: 0.475 Vali Loss: 0.414 Vali Acc: 0.896 Test Loss: 0.414 Test Acc: 0.896
Validation loss decreased (-0.871861 --> -0.895539).  Saving model ...
Epoch: 7 cost time: 3.2721385955810547
Epoch: 7, Steps: 89 | Train Loss: 0.394 Vali Loss: 0.346 Vali Acc: 0.912 Test Loss: 0.346 Test Acc: 0.912
Validation loss decreased (-0.895539 --> -0.912253).  Saving model ...
Epoch: 8 cost time: 3.112046241760254
Epoch: 8, Steps: 89 | Train Loss: 0.328 Vali Loss: 0.297 Vali Acc: 0.924 Test Loss: 0.297 Test Acc: 0.924
Validation loss decreased (-0.912253 --> -0.924092).  Saving model ...
Epoch: 9 cost time: 3.037930965423584
Epoch: 9, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.258 Vali Acc: 0.932 Test Loss: 0.258 Test Acc: 0.932
Validation loss decreased (-0.924092 --> -0.932449).  Saving model ...
Epoch: 10 cost time: 2.8688461780548096
Epoch: 10, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.232 Vali Acc: 0.939 Test Loss: 0.232 Test Acc: 0.939
Validation loss decreased (-0.932449 --> -0.939413).  Saving model ...
Epoch: 11 cost time: 2.8667876720428467
Epoch: 11, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.939413 --> -0.949859).  Saving model ...
Epoch: 12 cost time: 2.9213812351226807
Epoch: 12, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0612921714782715
Epoch: 13, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
Validation loss decreased (-0.949859 --> -0.959608).  Saving model ...
Epoch: 14 cost time: 3.0498249530792236
Epoch: 14, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.162 Vali Acc: 0.955 Test Loss: 0.162 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.097407817840576
Epoch: 15, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
Validation loss decreased (-0.959608 --> -0.969358).  Saving model ...
Epoch: 16 cost time: 2.9837539196014404
Epoch: 16, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970054).  Saving model ...
Epoch: 17 cost time: 2.751667022705078
Epoch: 17, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.970751).  Saving model ...
Epoch: 18 cost time: 2.928450107574463
Epoch: 18, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 19 cost time: 2.824413299560547
Epoch: 19, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9916739463806152
Epoch: 20, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.970751 --> -0.974929).  Saving model ...
Epoch: 21 cost time: 3.0471577644348145
Epoch: 21, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 22 cost time: 2.9588983058929443
Epoch: 22, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.415853977203369
Epoch: 23, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0848898887634277
Epoch: 24, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.7271440029144287
Epoch: 25, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 26 cost time: 4.054963827133179
Epoch: 26, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.408207893371582
Epoch: 27, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3061516284942627
Epoch: 28, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.661893606185913
Epoch: 29, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.964240312576294
Epoch: 30, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.3834471702575684
Epoch: 31, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.283761739730835
Epoch: 32, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 33 cost time: 3.732032537460327
Epoch: 33, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.6184985637664795
Epoch: 34, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.0132105350494385
Epoch: 35, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 36 cost time: 3.993014335632324
Epoch: 36, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.8280069828033447
Epoch: 37, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.024488210678101
Epoch: 38, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.654529094696045
Epoch: 39, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.100757837295532
Epoch: 40, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.585116386413574
Epoch: 41, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.178847312927246
Epoch: 42, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.1328303813934326
Epoch: 43, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.8865699768066406
Epoch: 44, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 45 cost time: 3.8527848720550537
Epoch: 45, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.4381461143493652
Epoch: 46, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.417452096939087
Epoch: 47, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.68723464012146
Epoch: 48, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.398066520690918
Epoch: 49, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.536215305328369
Epoch: 50, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 51 cost time: 3.685532808303833
Epoch: 51, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.118563652038574
Epoch: 52, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.379270076751709
Epoch: 53, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.6833739280700684
Epoch: 54, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.834364414215088
Epoch: 55, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.0006165504455566
Epoch: 56, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.090254068374634
Epoch: 57, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 3.1649134159088135
Epoch: 58, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 3.337667942047119
Epoch: 59, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 2.7840640544891357
Epoch: 60, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df128_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 12900
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.0277259349823
Epoch: 1, Steps: 89 | Train Loss: 2.015 Vali Loss: 0.902 Vali Acc: 0.817 Test Loss: 0.902 Test Acc: 0.817
Validation loss decreased (inf --> -0.816843).  Saving model ...
Epoch: 2 cost time: 3.197145938873291
Epoch: 2, Steps: 89 | Train Loss: 0.665 Vali Loss: 0.485 Vali Acc: 0.857 Test Loss: 0.485 Test Acc: 0.857
Validation loss decreased (-0.816843 --> -0.856541).  Saving model ...
Epoch: 3 cost time: 3.3547303676605225
Epoch: 3, Steps: 89 | Train Loss: 0.393 Vali Loss: 0.308 Vali Acc: 0.907 Test Loss: 0.308 Test Acc: 0.907
Validation loss decreased (-0.856541 --> -0.906682).  Saving model ...
Epoch: 4 cost time: 2.6564767360687256
Epoch: 4, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.274 Vali Acc: 0.914 Test Loss: 0.274 Test Acc: 0.914
Validation loss decreased (-0.906682 --> -0.913646).  Saving model ...
Epoch: 5 cost time: 2.601884603500366
Epoch: 5, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.224 Vali Acc: 0.942 Test Loss: 0.224 Test Acc: 0.942
Validation loss decreased (-0.913646 --> -0.941502).  Saving model ...
Epoch: 6 cost time: 2.7759532928466797
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.941502 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 3.0415854454040527
Epoch: 7, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.962893009185791
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.178 Vali Acc: 0.947 Test Loss: 0.178 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.352155923843384
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.954037 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 3.367623805999756
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.565368175506592
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.964483).  Saving model ...
Epoch: 12 cost time: 3.478026866912842
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4747085571289062
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.961 Test Loss: 0.138 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8325960636138916
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.59902286529541
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.128657102584839
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
Validation loss decreased (-0.964483 --> -0.971447).  Saving model ...
Epoch: 17 cost time: 2.868014335632324
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2964344024658203
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8651862144470215
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0873122215270996
Epoch: 20, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.247 Vali Acc: 0.939 Test Loss: 0.247 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.183903932571411
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.0078463554382324
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.190476894378662
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.251 Vali Acc: 0.951 Test Loss: 0.251 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.057870626449585
Epoch: 24, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.2549846172332764
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.240379571914673
Epoch: 26, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.332 Vali Acc: 0.945 Test Loss: 0.332 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 61972
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.883449554443359
Epoch: 1, Steps: 89 | Train Loss: 2.390 Vali Loss: 1.339 Vali Acc: 0.693 Test Loss: 1.339 Test Acc: 0.693
Validation loss decreased (inf --> -0.692884).  Saving model ...
Epoch: 2 cost time: 3.0795652866363525
Epoch: 2, Steps: 89 | Train Loss: 0.915 Vali Loss: 0.589 Vali Acc: 0.853 Test Loss: 0.589 Test Acc: 0.853
Validation loss decreased (-0.692884 --> -0.853058).  Saving model ...
Epoch: 3 cost time: 2.9864120483398438
Epoch: 3, Steps: 89 | Train Loss: 0.490 Vali Loss: 0.426 Vali Acc: 0.892 Test Loss: 0.426 Test Acc: 0.892
Validation loss decreased (-0.853058 --> -0.892057).  Saving model ...
Epoch: 4 cost time: 3.0247256755828857
Epoch: 4, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.331 Vali Acc: 0.910 Test Loss: 0.331 Test Acc: 0.910
Validation loss decreased (-0.892057 --> -0.910164).  Saving model ...
Epoch: 5 cost time: 2.9619319438934326
Epoch: 5, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.224 Vali Acc: 0.940 Test Loss: 0.224 Test Acc: 0.940
Validation loss decreased (-0.910164 --> -0.940109).  Saving model ...
Epoch: 6 cost time: 3.0462307929992676
Epoch: 6, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (-0.940109 --> -0.950555).  Saving model ...
Epoch: 7 cost time: 3.3206069469451904
Epoch: 7, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.180 Vali Acc: 0.947 Test Loss: 0.180 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6840054988861084
Epoch: 8, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
Validation loss decreased (-0.950555 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 2.9256997108459473
Epoch: 9, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2107107639312744
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.145 Vali Acc: 0.956 Test Loss: 0.145 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0957322120666504
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.982966423034668
Epoch: 12, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.962394).  Saving model ...
Epoch: 13 cost time: 2.9380531311035156
Epoch: 13, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.137 Vali Acc: 0.958 Test Loss: 0.137 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1887452602386475
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.971447).  Saving model ...
Epoch: 15 cost time: 3.3417444229125977
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7310686111450195
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.902012825012207
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1893627643585205
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 19 cost time: 3.0429160594940186
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1211843490600586
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5269768238067627
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.704522132873535
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.016085386276245
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.473378896713257
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.284377098083496
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.5119829177856445
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.236908674240112
Epoch: 27, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.6196749210357666
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 38052
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.0327136516571045
Epoch: 1, Steps: 89 | Train Loss: 2.481 Vali Loss: 1.521 Vali Acc: 0.767 Test Loss: 1.521 Test Acc: 0.767
Validation loss decreased (inf --> -0.767394).  Saving model ...
Epoch: 2 cost time: 3.4588420391082764
Epoch: 2, Steps: 89 | Train Loss: 1.079 Vali Loss: 0.686 Vali Acc: 0.809 Test Loss: 0.686 Test Acc: 0.809
Validation loss decreased (-0.767394 --> -0.809185).  Saving model ...
Epoch: 3 cost time: 3.3467190265655518
Epoch: 3, Steps: 89 | Train Loss: 0.568 Vali Loss: 0.442 Vali Acc: 0.868 Test Loss: 0.442 Test Acc: 0.868
Validation loss decreased (-0.809185 --> -0.867684).  Saving model ...
Epoch: 4 cost time: 3.6814935207366943
Epoch: 4, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.867684 --> -0.903200).  Saving model ...
Epoch: 5 cost time: 3.906639337539673
Epoch: 5, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
Validation loss decreased (-0.903200 --> -0.935234).  Saving model ...
Epoch: 6 cost time: 2.9033164978027344
Epoch: 6, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.204 Vali Acc: 0.947 Test Loss: 0.204 Test Acc: 0.947
Validation loss decreased (-0.935234 --> -0.947073).  Saving model ...
Epoch: 7 cost time: 2.9135444164276123
Epoch: 7, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
Validation loss decreased (-0.947073 --> -0.949162).  Saving model ...
Epoch: 8 cost time: 2.7713847160339355
Epoch: 8, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
Validation loss decreased (-0.949162 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 3.6038284301757812
Epoch: 9, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.145927667617798
Epoch: 10, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0233564376831055
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.146 Vali Acc: 0.955 Test Loss: 0.146 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3311283588409424
Epoch: 12, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
Validation loss decreased (-0.961001 --> -0.965876).  Saving model ...
Epoch: 13 cost time: 3.4704785346984863
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.965876 --> -0.967965).  Saving model ...
Epoch: 14 cost time: 3.4774439334869385
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 15 cost time: 3.3659324645996094
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 16 cost time: 3.004962921142578
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.371572732925415
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.121511697769165
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.056114912033081
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.972144 --> -0.974929).  Saving model ...
Epoch: 20 cost time: 2.8863649368286133
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 21 cost time: 2.7487332820892334
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0881991386413574
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.050581693649292
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.2292423248291016
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.053635835647583
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.352670907974243
Epoch: 26, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.072126865386963
Epoch: 27, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.243067741394043
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.8697493076324463
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.060776710510254
Epoch: 30, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.153 Vali Acc: 0.956 Test Loss: 0.153 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 28516
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.159150838851929
Epoch: 1, Steps: 89 | Train Loss: 2.723 Vali Loss: 1.890 Vali Acc: 0.632 Test Loss: 1.890 Test Acc: 0.632
Validation loss decreased (inf --> -0.632293).  Saving model ...
Epoch: 2 cost time: 3.106853723526001
Epoch: 2, Steps: 89 | Train Loss: 1.356 Vali Loss: 0.801 Vali Acc: 0.827 Test Loss: 0.801 Test Acc: 0.827
Validation loss decreased (-0.632293 --> -0.827290).  Saving model ...
Epoch: 3 cost time: 3.1814393997192383
Epoch: 3, Steps: 89 | Train Loss: 0.678 Vali Loss: 0.508 Vali Acc: 0.876 Test Loss: 0.508 Test Acc: 0.876
Validation loss decreased (-0.827290 --> -0.876039).  Saving model ...
Epoch: 4 cost time: 3.6040844917297363
Epoch: 4, Steps: 89 | Train Loss: 0.432 Vali Loss: 0.375 Vali Acc: 0.892 Test Loss: 0.375 Test Acc: 0.892
Validation loss decreased (-0.876039 --> -0.892058).  Saving model ...
Epoch: 5 cost time: 3.3574981689453125
Epoch: 5, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.288 Vali Acc: 0.918 Test Loss: 0.288 Test Acc: 0.918
Validation loss decreased (-0.892058 --> -0.917824).  Saving model ...
Epoch: 6 cost time: 3.2332632541656494
Epoch: 6, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.917824 --> -0.936627).  Saving model ...
Epoch: 7 cost time: 3.276343822479248
Epoch: 7, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.201 Vali Acc: 0.943 Test Loss: 0.201 Test Acc: 0.943
Validation loss decreased (-0.936627 --> -0.942895).  Saving model ...
Epoch: 8 cost time: 3.607950448989868
Epoch: 8, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
Validation loss decreased (-0.942895 --> -0.953341).  Saving model ...
Epoch: 9 cost time: 3.9744601249694824
Epoch: 9, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
Validation loss decreased (-0.953341 --> -0.960305).  Saving model ...
Epoch: 10 cost time: 3.8881430625915527
Epoch: 10, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
Validation loss decreased (-0.960305 --> -0.965876).  Saving model ...
Epoch: 11 cost time: 3.713087797164917
Epoch: 11, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0457286834716797
Epoch: 12, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.131119728088379
Epoch: 13, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.133 Vali Acc: 0.961 Test Loss: 0.133 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.4664156436920166
Epoch: 14, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.965876 --> -0.967965).  Saving model ...
Epoch: 15 cost time: 3.195119619369507
Epoch: 15, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0097949504852295
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1914243698120117
Epoch: 17, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.963 Test Loss: 0.119 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.073887348175049
Epoch: 18, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 19 cost time: 3.2532269954681396
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.973537).  Saving model ...
Epoch: 20 cost time: 3.0929489135742188
Epoch: 20, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1445810794830322
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976322).  Saving model ...
Epoch: 22 cost time: 3.378466844558716
Epoch: 22, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9918901920318604
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.9378602504730225
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.8015027046203613
Epoch: 25, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.005432605743408
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.37715220451355
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.036954164505005
Epoch: 28, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.2144296169281006
Epoch: 29, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.0495035648345947
Epoch: 30, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.2257561683654785
Epoch: 31, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 20916
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps28_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.47104549407959
Epoch: 1, Steps: 89 | Train Loss: 2.780 Vali Loss: 2.066 Vali Acc: 0.558 Test Loss: 2.066 Test Acc: 0.558
Validation loss decreased (inf --> -0.558475).  Saving model ...
Epoch: 2 cost time: 3.504810333251953
Epoch: 2, Steps: 89 | Train Loss: 1.625 Vali Loss: 1.022 Vali Acc: 0.808 Test Loss: 1.022 Test Acc: 0.808
Validation loss decreased (-0.558475 --> -0.808486).  Saving model ...
Epoch: 3 cost time: 2.985983371734619
Epoch: 3, Steps: 89 | Train Loss: 0.855 Vali Loss: 0.637 Vali Acc: 0.849 Test Loss: 0.637 Test Acc: 0.849
Validation loss decreased (-0.808486 --> -0.848879).  Saving model ...
Epoch: 4 cost time: 3.603196144104004
Epoch: 4, Steps: 89 | Train Loss: 0.566 Vali Loss: 0.477 Vali Acc: 0.882 Test Loss: 0.477 Test Acc: 0.882
Validation loss decreased (-0.848879 --> -0.882307).  Saving model ...
Epoch: 5 cost time: 3.7873449325561523
Epoch: 5, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.363 Vali Acc: 0.914 Test Loss: 0.363 Test Acc: 0.914
Validation loss decreased (-0.882307 --> -0.914342).  Saving model ...
Epoch: 6 cost time: 2.913137912750244
Epoch: 6, Steps: 89 | Train Loss: 0.339 Vali Loss: 0.302 Vali Acc: 0.916 Test Loss: 0.302 Test Acc: 0.916
Validation loss decreased (-0.914342 --> -0.916432).  Saving model ...
Epoch: 7 cost time: 3.3757147789001465
Epoch: 7, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.248 Vali Acc: 0.932 Test Loss: 0.248 Test Acc: 0.932
Validation loss decreased (-0.916432 --> -0.932449).  Saving model ...
Epoch: 8 cost time: 3.4322521686553955
Epoch: 8, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.199 Vali Acc: 0.954 Test Loss: 0.199 Test Acc: 0.954
Validation loss decreased (-0.932449 --> -0.954037).  Saving model ...
Epoch: 9 cost time: 3.2187139987945557
Epoch: 9, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.188 Vali Acc: 0.955 Test Loss: 0.188 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.954733).  Saving model ...
Epoch: 10 cost time: 3.412222385406494
Epoch: 10, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.954733 --> -0.959608).  Saving model ...
Epoch: 11 cost time: 2.912553310394287
Epoch: 11, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.959608 --> -0.964483).  Saving model ...
Epoch: 12 cost time: 2.8335089683532715
Epoch: 12, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
Validation loss decreased (-0.964483 --> -0.964483).  Saving model ...
Epoch: 13 cost time: 3.0027120113372803
Epoch: 13, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965876).  Saving model ...
Epoch: 14 cost time: 3.10101318359375
Epoch: 14, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.965876 --> -0.971447).  Saving model ...
Epoch: 15 cost time: 3.156956672668457
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2854695320129395
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2863962650299072
Epoch: 17, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.974233).  Saving model ...
Epoch: 18 cost time: 3.1169350147247314
Epoch: 18, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 19 cost time: 3.298769950866699
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 3.2092905044555664
Epoch: 20, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1665115356445312
Epoch: 21, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.285691976547241
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.49924635887146
Epoch: 23, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.6830155849456787
Epoch: 24, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 25 cost time: 3.3501229286193848
Epoch: 25, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4321742057800293
Epoch: 26, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9160592555999756
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.6689982414245605
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.9006102085113525
Epoch: 29, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.259594440460205
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.2457659244537354
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.1511294841766357
Epoch: 32, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.1135246753692627
Epoch: 33, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.903350591659546
Epoch: 34, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps28_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 16260
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.846643447875977
Epoch: 1, Steps: 89 | Train Loss: 2.862 Vali Loss: 2.317 Vali Acc: 0.431 Test Loss: 2.317 Test Acc: 0.431
Validation loss decreased (inf --> -0.431035).  Saving model ...
Epoch: 2 cost time: 3.2696359157562256
Epoch: 2, Steps: 89 | Train Loss: 1.910 Vali Loss: 1.344 Vali Acc: 0.673 Test Loss: 1.344 Test Acc: 0.673
Validation loss decreased (-0.431035 --> -0.672689).  Saving model ...
Epoch: 3 cost time: 3.670910596847534
Epoch: 3, Steps: 89 | Train Loss: 1.122 Vali Loss: 0.845 Vali Acc: 0.788 Test Loss: 0.845 Test Acc: 0.788
Validation loss decreased (-0.672689 --> -0.787596).  Saving model ...
Epoch: 4 cost time: 3.2987072467803955
Epoch: 4, Steps: 89 | Train Loss: 0.747 Vali Loss: 0.619 Vali Acc: 0.838 Test Loss: 0.619 Test Acc: 0.838
Validation loss decreased (-0.787596 --> -0.838434).  Saving model ...
Epoch: 5 cost time: 2.9243314266204834
Epoch: 5, Steps: 89 | Train Loss: 0.552 Vali Loss: 0.468 Vali Acc: 0.896 Test Loss: 0.468 Test Acc: 0.896
Validation loss decreased (-0.838434 --> -0.895538).  Saving model ...
Epoch: 6 cost time: 2.6503078937530518
Epoch: 6, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.383 Vali Acc: 0.909 Test Loss: 0.383 Test Acc: 0.909
Validation loss decreased (-0.895538 --> -0.908771).  Saving model ...
Epoch: 7 cost time: 3.1761255264282227
Epoch: 7, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.302 Vali Acc: 0.931 Test Loss: 0.302 Test Acc: 0.931
Validation loss decreased (-0.908771 --> -0.931055).  Saving model ...
Epoch: 8 cost time: 2.8039910793304443
Epoch: 8, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.253 Vali Acc: 0.942 Test Loss: 0.253 Test Acc: 0.942
Validation loss decreased (-0.931055 --> -0.942198).  Saving model ...
Epoch: 9 cost time: 2.927375555038452
Epoch: 9, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
Validation loss decreased (-0.942198 --> -0.942198).  Saving model ...
Epoch: 10 cost time: 3.0296876430511475
Epoch: 10, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.199 Vali Acc: 0.947 Test Loss: 0.199 Test Acc: 0.947
Validation loss decreased (-0.942198 --> -0.947073).  Saving model ...
Epoch: 11 cost time: 2.7428548336029053
Epoch: 11, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
Validation loss decreased (-0.947073 --> -0.955430).  Saving model ...
Epoch: 12 cost time: 2.793403148651123
Epoch: 12, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.165 Vali Acc: 0.953 Test Loss: 0.165 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7514870166778564
Epoch: 13, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
Validation loss decreased (-0.955430 --> -0.964483).  Saving model ...
Epoch: 14 cost time: 2.1901705265045166
Epoch: 14, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.111351251602173
Epoch: 15, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968662).  Saving model ...
Epoch: 16 cost time: 2.995891571044922
Epoch: 16, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 17 cost time: 2.750736951828003
Epoch: 17, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 18 cost time: 3.1620893478393555
Epoch: 18, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8477354049682617
Epoch: 19, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.682114362716675
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 21 cost time: 2.812124729156494
Epoch: 21, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.824834108352661
Epoch: 22, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976322).  Saving model ...
Epoch: 23 cost time: 2.888746738433838
Epoch: 23, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.8314177989959717
Epoch: 24, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.832944393157959
Epoch: 25, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.6994731426239014
Epoch: 26, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.953672409057617
Epoch: 27, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 28 cost time: 2.9590213298797607
Epoch: 28, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.8723578453063965
Epoch: 29, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.8510184288024902
Epoch: 30, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.8064656257629395
Epoch: 31, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.787879467010498
Epoch: 32, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.7863965034484863
Epoch: 33, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.0245583057403564
Epoch: 34, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 35 cost time: 3.073988676071167
Epoch: 35, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.1928508281707764
Epoch: 36, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.2712879180908203
Epoch: 37, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.2672674655914307
Epoch: 38, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.21968150138855
Epoch: 39, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.8636627197265625
Epoch: 40, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.8451955318450928
Epoch: 41, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.885622262954712
Epoch: 42, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.0361878871917725
Epoch: 43, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.9785406589508057
Epoch: 44, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 12564
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps46_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.582271337509155
Epoch: 1, Steps: 89 | Train Loss: 2.861 Vali Loss: 2.354 Vali Acc: 0.392 Test Loss: 2.354 Test Acc: 0.392
Validation loss decreased (inf --> -0.392038).  Saving model ...
Epoch: 2 cost time: 3.06242036819458
Epoch: 2, Steps: 89 | Train Loss: 2.005 Vali Loss: 1.419 Vali Acc: 0.698 Test Loss: 1.419 Test Acc: 0.698
Validation loss decreased (-0.392038 --> -0.697757).  Saving model ...
Epoch: 3 cost time: 3.2274179458618164
Epoch: 3, Steps: 89 | Train Loss: 1.217 Vali Loss: 0.882 Vali Acc: 0.808 Test Loss: 0.882 Test Acc: 0.808
Validation loss decreased (-0.697757 --> -0.808487).  Saving model ...
Epoch: 4 cost time: 3.087129831314087
Epoch: 4, Steps: 89 | Train Loss: 0.805 Vali Loss: 0.652 Vali Acc: 0.849 Test Loss: 0.652 Test Acc: 0.849
Validation loss decreased (-0.808487 --> -0.848879).  Saving model ...
Epoch: 5 cost time: 3.150056838989258
Epoch: 5, Steps: 89 | Train Loss: 0.615 Vali Loss: 0.506 Vali Acc: 0.884 Test Loss: 0.506 Test Acc: 0.884
Validation loss decreased (-0.848879 --> -0.883700).  Saving model ...
Epoch: 6 cost time: 3.0535075664520264
Epoch: 6, Steps: 89 | Train Loss: 0.475 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
Validation loss decreased (-0.883700 --> -0.899717).  Saving model ...
Epoch: 7 cost time: 2.8472096920013428
Epoch: 7, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.348 Vali Acc: 0.913 Test Loss: 0.348 Test Acc: 0.913
Validation loss decreased (-0.899717 --> -0.912949).  Saving model ...
Epoch: 8 cost time: 2.8026537895202637
Epoch: 8, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.294 Vali Acc: 0.928 Test Loss: 0.294 Test Acc: 0.928
Validation loss decreased (-0.912949 --> -0.928270).  Saving model ...
Epoch: 9 cost time: 2.8814995288848877
Epoch: 9, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.249 Vali Acc: 0.939 Test Loss: 0.249 Test Acc: 0.939
Validation loss decreased (-0.928270 --> -0.939413).  Saving model ...
Epoch: 10 cost time: 2.806036949157715
Epoch: 10, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
Validation loss decreased (-0.939413 --> -0.948466).  Saving model ...
Epoch: 11 cost time: 3.132831573486328
Epoch: 11, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
Validation loss decreased (-0.948466 --> -0.952644).  Saving model ...
Epoch: 12 cost time: 2.9231667518615723
Epoch: 12, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.952644 --> -0.958215).  Saving model ...
Epoch: 13 cost time: 2.932337760925293
Epoch: 13, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0096395015716553
Epoch: 14, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.958215 --> -0.960305).  Saving model ...
Epoch: 15 cost time: 4.012613296508789
Epoch: 15, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.960305 --> -0.970054).  Saving model ...
Epoch: 16 cost time: 3.6952261924743652
Epoch: 16, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.863234043121338
Epoch: 17, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.970751).  Saving model ...
Epoch: 18 cost time: 4.306149482727051
Epoch: 18, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.377005100250244
Epoch: 19, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 20 cost time: 3.8726718425750732
Epoch: 20, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 21 cost time: 3.9535903930664062
Epoch: 21, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 22 cost time: 4.2285497188568115
Epoch: 22, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 23 cost time: 4.043489456176758
Epoch: 23, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.5039753913879395
Epoch: 24, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.174208879470825
Epoch: 25, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.128296136856079
Epoch: 26, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 27 cost time: 3.3254528045654297
Epoch: 27, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8958544731140137
Epoch: 28, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.8576579093933105
Epoch: 29, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.564257860183716
Epoch: 30, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.6504015922546387
Epoch: 31, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 32 cost time: 3.971557855606079
Epoch: 32, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.577747344970703
Epoch: 33, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.512838363647461
Epoch: 34, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 35 cost time: 3.947646141052246
Epoch: 35, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.1061391830444336
Epoch: 36, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.0513789653778076
Epoch: 37, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.053744077682495
Epoch: 38, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 39 cost time: 3.169131278991699
Epoch: 39, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.883065700531006
Epoch: 40, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.914125442504883
Epoch: 41, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980501).  Saving model ...
Epoch: 42 cost time: 3.373830795288086
Epoch: 42, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.1881625652313232
Epoch: 43, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.4202442169189453
Epoch: 44, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.75439190864563
Epoch: 45, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.6055054664611816
Epoch: 46, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.982126235961914
Epoch: 47, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.6343295574188232
Epoch: 48, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.5382750034332275
Epoch: 49, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.5005013942718506
Epoch: 50, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.936934471130371
Epoch: 51, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_PatchTST_UEA_ftM_sl182_ll0_pl0_el1_dm16_nh4_df64_ps46_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 10788
model size : 0.36MB
